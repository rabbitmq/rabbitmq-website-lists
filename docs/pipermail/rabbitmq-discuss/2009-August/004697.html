<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] direct queue throughput
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20direct%20queue%20throughput&In-Reply-To=15FDFBBA-B8E0-4FBD-BBA1-7BC516A46CD4%40mac.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004696.html">
   <LINK REL="Next"  HREF="004699.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] direct queue throughput</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20direct%20queue%20throughput&In-Reply-To=15FDFBBA-B8E0-4FBD-BBA1-7BC516A46CD4%40mac.com"
       TITLE="[rabbitmq-discuss] direct queue throughput">matthew at lshift.net
       </A><BR>
    <I>Sat Aug 29 00:01:09 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004696.html">[rabbitmq-discuss] direct queue throughput
</A></li>
        <LI>Next message: <A HREF="004699.html">[rabbitmq-discuss] direct queue throughput
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4697">[ date ]</a>
              <a href="thread.html#4697">[ thread ]</a>
              <a href="subject.html#4697">[ subject ]</a>
              <a href="author.html#4697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Aug 28, 2009 at 05:38:58PM -0500, Chuck Remes wrote:
&gt;<i> &gt; So far, so good.  But it's starting to look like this configuration
</I>&gt;<i> &gt; isn't fast enough to let me test SSDs.  Rabbitmq appears to top out at
</I>&gt;<i> &gt; a throughput rate of around 7k msgs/sec for the two queues.  Does that
</I>&gt;<i> &gt; number sound right?  The rate is the same whether I'm running on an 8
</I>&gt;<i> &gt; core box with 32 gigs of memory or a 4 core with 4 gigs.
</I>
I can crank 27kHz on my Q9450 with 4GB RAM. However, numbers like this
are utterly meaningless, without further qualification. In my case,
0-bytes message payload, and auto-ack consumer. Thus, we realy need far
more details about your setup, the nature of your exchanges, queues,
publishers and consumers before being able to suggest whether or not the
performance you're getting &quot;sounds about right&quot; ;)

With hardware like yours, I'd expect you to be able to push the envelope
a fair bit!

&gt;<i> I don't have an answer for you but I do have a few things to point out.
</I>&gt;<i> 
</I>&gt;<i> 1. RabbitMQ is written in Erlang. I am pretty sure the latest stable  
</I>&gt;<i> releases are still a single-threaded process (though internally the  
</I>&gt;<i> application uses hundreds or thousands of &quot;green&quot; threads). Therefore  
</I>&gt;<i> you won't get much throughput increase by running on a larger multi- 
</I>&gt;<i> core box.
</I>
Erlang has supported SMP for several releases, I believe first gaining
support about 4 years ago. Initially, yes, we found that very early
versions of Rabbit ran slower with the SMP support turned on that off.
However, Erlang's support for SMP has improved substantially over the
years and Rabbit benefits substantially from Erlang's SMP support.

man erl, and a quick search for SMP reveals that by default, and in
absence of any conflicting parameters, and on a supported platform, SMP
support will be enabled.

As with all non-&quot;trivially parallisable&quot; applications, you get
diminishing returns from going more and more parallel. That said, in
Rabbit, it's very plausible to have sockets, channels and queues running
in entirely separate processes. In short, if you structure things
correctly, you should be able to get very substantial benefits from
additional parallel hardware.

The rest of Chuck's points are absolutely valid though - we really need
a fair bit more information - which clients are you using, what is the
sustain network load, are the consumers, auto-acking, manually acking,
is qos being used?

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004696.html">[rabbitmq-discuss] direct queue throughput
</A></li>
	<LI>Next message: <A HREF="004699.html">[rabbitmq-discuss] direct queue throughput
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4697">[ date ]</a>
              <a href="thread.html#4697">[ thread ]</a>
              <a href="subject.html#4697">[ subject ]</a>
              <a href="author.html#4697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
