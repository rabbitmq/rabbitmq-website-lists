<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Weird Crash (91MB message over STOMP)	[Reproducible]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Weird%20Crash%20%2891MB%20message%20over%20STOMP%29%0A%09%5BReproducible%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004470.html">
   <LINK REL="Next"  HREF="004439.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Weird Crash (91MB message over STOMP)	[Reproducible]</H1>
    <B>Darien Kindlund</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Weird%20Crash%20%2891MB%20message%20over%20STOMP%29%0A%09%5BReproducible%5D&In-Reply-To="
       TITLE="[rabbitmq-discuss] Weird Crash (91MB message over STOMP)	[Reproducible]">darien at kindlund.com
       </A><BR>
    <I>Sat Aug  8 07:04:20 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004470.html">[rabbitmq-discuss] Rabbitmq+Ubuntu+TIMEOUT
</A></li>
        <LI>Next message: <A HREF="004439.html">[rabbitmq-discuss] Weird Crash (91MB message over STOMP)	[Reproducible]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4438">[ date ]</a>
              <a href="thread.html#4438">[ thread ]</a>
              <a href="subject.html#4438">[ subject ]</a>
              <a href="author.html#4438">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matthias,

Okay, so after enabling verbose logging, I was able to replicate the
error, reliably.

Specifically, I have a message that is approximately 91 MB in size.  A
perl process using Net::Stomp sends the persistent message to an
exchange which routes the message to a durable queue.  As soon as the
perl process finishes sending the message, RabbitMQ v1.6.0 completely
dies with _zero_ warning or logging.

I've got a copy of the perl code which generates the message as a
scalar variable ($VAR1); from that point, you can feed the contents of
that scalar into any test perl code (such as the example code Tony has
authored) in order to generate the crash.

I don't believe my message format matters -- just the size of the
message.  However, I will send the 91 MB example message in an email
directly to you, since I don't think everyone on the list wants to get
such a large attachment.  If you don't get the email containing the
attachment (perhaps your mailserver blocks large attachments), then
let me know what the best method for sending you the attachment.

Also, I will include the rabbit.log, rabbit-sasl.log, and the entire
mnesia directory immediately after the crash.  Additionally, I'll
provide the erl_crash.dump which RabbitMQ generates upon crashing.

Let me know when you get the attachment as well as if you need any
additional information.  Also, I'd appreciate it if you can confirm
these findings on your own deployment.

Thanks again,
-- Darien


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004470.html">[rabbitmq-discuss] Rabbitmq+Ubuntu+TIMEOUT
</A></li>
	<LI>Next message: <A HREF="004439.html">[rabbitmq-discuss] Weird Crash (91MB message over STOMP)	[Reproducible]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4438">[ date ]</a>
              <a href="thread.html#4438">[ thread ]</a>
              <a href="subject.html#4438">[ subject ]</a>
              <a href="author.html#4438">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
