<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Working with Java Client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Working%20with%20Java%20Client&In-Reply-To=29598b610908201107g3de20ee6geaebf88a8a11eee1%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004617.html">
   <LINK REL="Next"  HREF="004633.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Working with Java Client</H1>
    <B>Ram Muthiah</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Working%20with%20Java%20Client&In-Reply-To=29598b610908201107g3de20ee6geaebf88a8a11eee1%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Working with Java Client">ram.muthiah at yahoo.com
       </A><BR>
    <I>Fri Aug 21 20:31:46 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004617.html">[rabbitmq-discuss] Working with Java Client
</A></li>
        <LI>Next message: <A HREF="004633.html">[rabbitmq-discuss] Working with Java Client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4632">[ date ]</a>
              <a href="thread.html#4632">[ thread ]</a>
              <a href="subject.html#4632">[ subject ]</a>
              <a href="author.html#4632">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Paul,

I am not running the client in the same machine as the server. I installed rabbitmq in our server. I am testing the PC clients that communicate with rabbitmq server. I left the username and password as it is, so their values are still &quot;guest&quot;. However, the hostname is changed, so I am not able to use TestMain out of the box. The documentation should clearly state that runjava.bat com.rabbitmq.examples.TestMain would work only if the broker is installed in the same machine as the client. 

Going to the &quot;stuck&quot; part of my development effort -- I have the following code that is supposed to connect the consumer to the broker. 

package rabbitmq;

import com.rabbitmq.client.AMQP;
import com.rabbitmq.client.Channel;
import com.rabbitmq.client.Connection;
import com.rabbitmq.client.ConnectionFactory;
import com.rabbitmq.client.QueueingConsumer;

public class SimpleConsumer {
    public static void main(String[] args) {
        try {
            String hostName = (args.length &gt; 0) ? args[0] : &quot;dev.rabbitmq.com&quot;;
            int portNumber = (args.length &gt; 1) ? Integer.parseInt(args[1]) : AMQP.PROTOCOL.PORT;
            String queueName = (args.length &gt; 2) ? args[2] : &quot;SimpleQueue&quot;;

            ConnectionFactory connFactory = new ConnectionFactory();
            Connection conn = connFactory.newConnection(hostName, portNumber);

            final Channel ch = conn.createChannel();

            ch.queueDeclare(queueName);

            QueueingConsumer consumer = new QueueingConsumer(ch);
            ch.basicConsume(queueName, consumer);
            while (true) {
                QueueingConsumer.Delivery delivery = consumer.nextDelivery();
                System.out.println(&quot;Message: &quot; + new String(delivery.getBody()));
                ch.basicAck(delivery.getEnvelope().getDeliveryTag(), false);
            }
        } catch (Exception ex) {
            System.err.println(&quot;Main thread caught exception: &quot; + ex);
            ex.printStackTrace();
            System.exit(1);
        }
    }
}

When I run the above code, I get the following error message: 

Main thread caught exception: java.io.IOException
java.io.IOException
        at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:121)
        at com.rabbitmq.client.impl.AMQConnection.open(AMQConnection.java:363)
        at com.rabbitmq.client.impl.AMQConnection.&lt;init&gt;(AMQConnection.java:208)
        at com.rabbitmq.client.impl.AMQConnection.&lt;init&gt;(AMQConnection.java:178)
        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:165)
        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:213)
        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:227)
        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:238)
        at rabbitmq.SimpleConsumer.main(SimpleConsumer.java:48)
Caused by: com.rabbitmq.client.ShutdownSignalException: connection error; reason: java.lang.NoClassDefFoundError: org/apache/commons/io/input/ProxyInputStream
        at com.rabbitmq.client.impl.AMQConnection.shutdown(AMQConnection.java:599)
        at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:465)
Caused by: java.lang.NoClassDefFoundError: org/apache/commons/io/input/ProxyInputStream
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:621)
        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)
        at java.net.URLClassLoader.defineClass(URLClassLoader.java:260)
        at java.net.URLClassLoader.access$000(URLClassLoader.java:56)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:195)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
        at com.rabbitmq.client.impl.MethodArgumentReader.&lt;init&gt;(MethodArgumentReader.java:70)
        at com.rabbitmq.client.impl.AMQImpl.readMethodFrom(AMQImpl.java:5710)
        at com.rabbitmq.client.impl.AMQCommand$Assembler.handleFrame(AMQCommand.java:275)
        at com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:107)
        at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:439)
Caused by: java.lang.ClassNotFoundException: org.apache.commons.io.input.ProxyInputStream
        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)


What I am looking for is complete working example of java code for the client. Simple example like just connecting to the broker and receiving the message (on the consumer side) from the producer. 

Thanks
Ram





________________________________
From: Paul Jones &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pauljones23 at gmail.com</A>&gt;
To: Ram Muthiah &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram.muthiah at yahoo.com</A>&gt;
Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Sent: Thursday, August 20, 2009 11:07:42 AM
Subject: Re: [rabbitmq-discuss] Working with Java Client

Ram,


On Thu, Aug 20, 2009 at 6:40 PM, Ram Muthiah &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram.muthiah at yahoo.com</A>&gt; wrote:

I feel the examples document needs to be more detailed. Examples page instructs to run runjava.bat com.rabbitmq.examples.TestMain to run the TestMain class. But, don't we need to change hostname, guest, password, etc before running these classes? 
&gt;<i>
</I>
As far as I can see, the scripts default to using localhost and guest/guest. A broker running on the same machine should accept these credentials out of the box.
 

&gt;<i>I setup the server, I ran some basic python scripts to
</I>&gt;<i> send/receive messages, they work well. I am stuck while using java client. Any help is much appreciated.
</I>&gt;<i>
</I>
Unfortunately you're going to need to tell us how you're stuck before we can provide any useful assistance.

Paul.



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090821/9aef9eec/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090821/9aef9eec/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004617.html">[rabbitmq-discuss] Working with Java Client
</A></li>
	<LI>Next message: <A HREF="004633.html">[rabbitmq-discuss] Working with Java Client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4632">[ date ]</a>
              <a href="thread.html#4632">[ thread ]</a>
              <a href="subject.html#4632">[ subject ]</a>
              <a href="author.html#4632">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
