<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Working with Java Client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Working%20with%20Java%20Client&In-Reply-To=29598b610908211324x67f9c032ndca1e8e866856706%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004633.html">
   <LINK REL="Next"  HREF="004593.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Working with Java Client</H1>
    <B>Ram Muthiah</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Working%20with%20Java%20Client&In-Reply-To=29598b610908211324x67f9c032ndca1e8e866856706%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Working with Java Client">ram.muthiah at yahoo.com
       </A><BR>
    <I>Fri Aug 21 23:03:10 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004633.html">[rabbitmq-discuss] Working with Java Client
</A></li>
        <LI>Next message: <A HREF="004593.html">[rabbitmq-discuss] Searching the list archive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4634">[ date ]</a>
              <a href="thread.html#4634">[ thread ]</a>
              <a href="subject.html#4634">[ subject ]</a>
              <a href="author.html#4634">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Paul,

I added commons-io library, it worked well! I tested on both consumer and producer sides, the messages are going from producer to consumer. I assume that to make a chat function work between two clients (client A and B), we need to make both clients to act as consumer as well as producer. There is still a lot more to learn! Thanks for your help.

Ram




________________________________
From: Paul Jones &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pauljones23 at gmail.com</A>&gt;
To: Ram Muthiah &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram.muthiah at yahoo.com</A>&gt;
Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Sent: Friday, August 21, 2009 1:24:34 PM
Subject: Re: [rabbitmq-discuss] Working with Java Client

Ram,


On Fri, Aug 21, 2009 at 8:31 PM, Ram Muthiah &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram.muthiah at yahoo.com</A>&gt; wrote:

I am not running the client in the same machine as the server. I installed rabbitmq in our server. I am testing the PC clients that communicate with rabbitmq server. I left the username and password as it is, so their values are still &quot;guest&quot;. However, the hostname is changed, so I am not able to use TestMain out of the box. The documentation should clearly state that runjava.bat com.rabbitmq.examples.TestMain would work only if the broker is installed in the same machine as the client. 
&gt;<i>
</I>
A quick perusal of the source code for TestMain indicates quite quickly (and in my opinion, relatively clearly) that the optional first command line parameter is the target host to connect to. Specifying this will change the host that the application connects to.

The below failure, as indicated by the NoClassFoundError, indicates that you're missing apache commons-io, a dependency of the library. You'll need to add that into your classpath in order for the library to work. Alternatively, you could just run the examples with dev.rabbitmq.com as the first parameter.

Paul.
 

&gt;<i>Going to the &quot;stuck&quot; part of my development effort -- I have the following code that is supposed to connect the consumer to the broker. 
</I>&gt;<i>
</I>&gt;<i>package rabbitmq;
</I>&gt;<i>
</I>&gt;<i>import com.rabbitmq.client.AMQP;
</I>&gt;&gt;<i>import com.rabbitmq.client.Channel;
</I>&gt;<i>import
</I>&gt;<i> com.rabbitmq.client.Connection;
</I>&gt;<i>import com.rabbitmq.client.ConnectionFactory;
</I>&gt;<i>import com.rabbitmq.client.QueueingConsumer;
</I>&gt;<i>
</I>&gt;<i>public class SimpleConsumer {
</I>&gt;<i>    public static void main(String[] args) {
</I>&gt;<i>        try {
</I>&gt;&gt;<i>            String hostName = (args.length &gt; 0) ? args[0] : &quot;dev.rabbitmq.com&quot;;
</I>&gt;<i>            int portNumber = (args.length &gt; 1) ? Integer.parseInt(args[1]) : AMQP.PROTOCOL.PORT;
</I>&gt;&gt;<i>            String queueName = (args.length &gt; 2) ? args[2] : &quot;SimpleQueue&quot;;
</I>&gt;<i>
</I>&gt;<i>            ConnectionFactory connFactory = new ConnectionFactory();
</I>&gt;<i>           
</I>&gt;<i> Connection conn = connFactory.newConnection(hostName, portNumber);
</I>&gt;<i>
</I>&gt;<i>            final Channel ch = conn.createChannel();
</I>&gt;<i>
</I>&gt;<i>            ch.queueDeclare(queueName);
</I>&gt;<i>
</I>&gt;<i>            QueueingConsumer consumer = new QueueingConsumer(ch);
</I>&gt;&gt;<i>            ch.basicConsume(queueName, consumer);
</I>&gt;<i>            while (true) {
</I>&gt;<i>                QueueingConsumer.Delivery delivery = consumer.nextDelivery();
</I>&gt;<i>                System.out.println(&quot;Message: &quot; + new
</I>&gt;<i> String(delivery.getBody()));
</I>&gt;<i>                ch.basicAck(delivery.getEnvelope().getDeliveryTag(), false);
</I>&gt;<i>            }
</I>&gt;<i>        } catch (Exception ex) {
</I>&gt;<i>            System.err.println(&quot;Main thread caught exception: &quot; + ex);
</I>&gt;&gt;<i>            ex.printStackTrace();
</I>&gt;<i>            System.exit(1);
</I>&gt;<i>        }
</I>&gt;<i>    }
</I>&gt;<i>}
</I>&gt;<i>
</I>&gt;<i>When I run the above code, I get the following error message: 
</I>&gt;<i>
</I>&gt;<i>Main thread caught exception: java.io.IOException
</I>&gt;&gt;<i>java.io.IOException
</I>&gt;<i>        at
</I>&gt;<i> com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:121)
</I>&gt;<i>        at com.rabbitmq.client.impl.AMQConnection.open(AMQConnection.java:363)
</I>&gt;<i>        at com.rabbitmq.client.impl.AMQConnection.&lt;init&gt;(AMQConnection.java:208)
</I>&gt;&gt;<i>        at com.rabbitmq.client.impl.AMQConnection.&lt;init&gt;(AMQConnection.java:178)
</I>&gt;<i>        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:165)
</I>&gt;<i>        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:213)
</I>&gt;&gt;<i>        at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:227)
</I>&gt;<i>        at
</I>&gt;<i> com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:238)
</I>&gt;<i>        at rabbitmq.SimpleConsumer.main(SimpleConsumer.java:48)
</I>&gt;<i>Caused by: com.rabbitmq.client.ShutdownSignalException: connection error; reason: java.lang.NoClassDefFoundError: org/apache/commons/io/input/ProxyInputStream
</I>&gt;&gt;<i>        at com.rabbitmq.client.impl.AMQConnection.shutdown(AMQConnection.java:599)
</I>&gt;<i>        at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:465)
</I>&gt;<i>Caused by: java.lang.NoClassDefFoundError: org/apache/commons/io/input/ProxyInputStream
</I>&gt;&gt;<i>        at java.lang.ClassLoader.defineClass1(Native Method)
</I>&gt;<i>        at java.lang.ClassLoader.defineClass(ClassLoader.java:621)
</I>&gt;<i>        at
</I>&gt;<i> java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)
</I>&gt;<i>        at java.net.URLClassLoader.defineClass(URLClassLoader.java:260)
</I>&gt;<i>        at java.net.URLClassLoader.access$000(URLClassLoader.java:56)
</I>&gt;&gt;<i>        at java.net.URLClassLoader$1.run(URLClassLoader.java:195)
</I>&gt;<i>        at java.security.AccessController.doPrivileged(Native Method)
</I>&gt;<i>        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
</I>&gt;<i>        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
</I>&gt;&gt;<i>        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
</I>&gt;<i>        at
</I>&gt;<i> java.lang.ClassLoader.loadClass(ClassLoader.java:252)
</I>&gt;<i>        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
</I>&gt;<i>        at com.rabbitmq.client.impl.MethodArgumentReader.&lt;init&gt;(MethodArgumentReader.java:70)
</I>&gt;&gt;<i>        at com.rabbitmq.client.impl.AMQImpl.readMethodFrom(AMQImpl.java:5710)
</I>&gt;<i>        at com.rabbitmq.client.impl.AMQCommand$Assembler.handleFrame(AMQCommand.java:275)
</I>&gt;<i>        at com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:107)
</I>&gt;&gt;<i>        at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:439)
</I>&gt;<i>Caused by: java.lang.ClassNotFoundException: org.apache.commons.io.input.ProxyInputStream
</I>&gt;<i>        at
</I>&gt;<i> java.net.URLClassLoader$1.run(URLClassLoader.java:200)
</I>&gt;<i>        at java.security.AccessController.doPrivileged(Native Method)
</I>&gt;<i>        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
</I>&gt;<i>        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
</I>&gt;&gt;<i>        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
</I>&gt;<i>        at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
</I>&gt;<i>        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>What I am looking for is complete working example of java code for the client. Simple example like just connecting to the broker and receiving the message (on the consumer side) from the producer. 
</I>&gt;<i>
</I>&gt;<i>Thanks
</I>&gt;<i>Ram
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>________________________________
From: Paul Jones &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pauljones23 at gmail.com</A>&gt;
&gt;<i>To: Ram Muthiah &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram.muthiah at yahoo.com</A>&gt;
</I>&gt;<i>Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>Sent: Thursday, August 20, 2009 11:07:42 AM
</I>&gt;<i>
</I>&gt;<i>Subject: Re: [rabbitmq-discuss] Working with Java Client
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Ram,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On Thu, Aug 20, 2009 at 6:40 PM, Ram Muthiah &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram.muthiah at yahoo.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>I feel the examples document needs to be more detailed. Examples page instructs to run runjava.bat com.rabbitmq.examples.TestMain to run the TestMain class. But, don't we need to change hostname, guest, password, etc before running these classes? 
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>As far as I can see, the scripts default to using localhost and guest/guest. A broker running on the same machine should accept these credentials out of the box.
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;&gt;<i>I setup the server, I ran some basic python scripts to
</I>&gt;&gt;<i> send/receive messages, they work well. I am stuck while using java client. Any help is much appreciated.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Unfortunately you're going to need to tell us how you're stuck before we can provide any useful assistance.
</I>&gt;<i>
</I>&gt;<i>Paul.
</I>&gt;<i>
</I>&gt;<i>
</I>


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090821/a721a5da/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090821/a721a5da/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004633.html">[rabbitmq-discuss] Working with Java Client
</A></li>
	<LI>Next message: <A HREF="004593.html">[rabbitmq-discuss] Searching the list archive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4634">[ date ]</a>
              <a href="thread.html#4634">[ thread ]</a>
              <a href="subject.html#4634">[ subject ]</a>
              <a href="author.html#4634">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
