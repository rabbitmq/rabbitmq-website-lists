<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Weird Crash (1M to 10M messages over STOMP?)	- Recovery logic for durable messages/queues/exchanges?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Weird%20Crash%20%281M%20to%2010M%20messages%20over%20STOMP%3F%29%0A%09-%20Recovery%20logic%20for%20durable%20messages/queues/exchanges%3F&In-Reply-To=4A7CAA37.8050700%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004435.html">
   <LINK REL="Next"  HREF="004437.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Weird Crash (1M to 10M messages over STOMP?)	- Recovery logic for durable messages/queues/exchanges?</H1>
    <B>Darien Kindlund</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Weird%20Crash%20%281M%20to%2010M%20messages%20over%20STOMP%3F%29%0A%09-%20Recovery%20logic%20for%20durable%20messages/queues/exchanges%3F&In-Reply-To=4A7CAA37.8050700%40lshift.net"
       TITLE="[rabbitmq-discuss] Weird Crash (1M to 10M messages over STOMP?)	- Recovery logic for durable messages/queues/exchanges?">darien at kindlund.com
       </A><BR>
    <I>Fri Aug  7 23:43:19 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004435.html">[rabbitmq-discuss] Weird Crash (1M to 10M messages over STOMP?) -	Recovery logic for durable messages/queues/exchanges?
</A></li>
        <LI>Next message: <A HREF="004437.html">[rabbitmq-discuss] Rabbitmq+Ubuntu+TIMEOUT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4436">[ date ]</a>
              <a href="thread.html#4436">[ thread ]</a>
              <a href="subject.html#4436">[ subject ]</a>
              <a href="author.html#4436">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matthias,

&gt;&gt;&gt;<i> Can you send me a copy of the rabbit.log?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yup, will do in a separate email to you.
</I>&gt;<i>
</I>&gt;<i> What's interesting here is that within one second of the TCP listener
</I>&gt;<i> starting there are three AMQP (not STOMP) connections. STOMP connections get
</I>&gt;<i> established ~80 seconds later.
</I>&gt;<i>
</I>&gt;<i> Could it be possible that the three initial AMQP connections consume from
</I>&gt;<i> the queues? That would explain why you are seeing unacknowledged messages in
</I>&gt;<i> the counts.
</I>
Those three AMQP connections don't subscribe to the same queue as all
the STOMP connections.  In fact, all three AMQP connections just
subscribe to their own, independent queues.  To be clear all the STOMP
connections share the same queue, which is the one that usually has
the un-ack'd messages.

At this point, I'm thinking you probably need more information to
replace the message un-ack'd issue.  Perhaps if we can nail down the
original culprit for the weird crash, then we can replicate the
un-ack'd issue.  If I can construct the original message sent via
STOMP which caused RabbitMQ to die unexpectedly... I'm thinking that
would be enough to replicate... right?  In any event, I'm working on
this and it will probably take 1-2 hours to complete.

&gt;&gt;<i> Have you guys done any sort of unit testing with various message
</I>&gt;&gt;<i> sizes? &#160;I'm guessing for AMQP, you have, but I'm wondering if you've
</I>&gt;&gt;<i> done the same for all the different protocols you guys support with
</I>&gt;&gt;<i> extensions (e.g., HTTP, STOMP ...).
</I>&gt;<i>
</I>&gt;<i> Tony may know the answer to that one... but one reason why the STOMP
</I>&gt;<i> extension still has experimental status is that we haven't done any
</I>&gt;<i> extensive testing.
</I>
Yeah, that makes sense.  Okay, I'll try to get the example message I'm using...

-- Darien


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004435.html">[rabbitmq-discuss] Weird Crash (1M to 10M messages over STOMP?) -	Recovery logic for durable messages/queues/exchanges?
</A></li>
	<LI>Next message: <A HREF="004437.html">[rabbitmq-discuss] Rabbitmq+Ubuntu+TIMEOUT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4436">[ date ]</a>
              <a href="thread.html#4436">[ thread ]</a>
              <a href="subject.html#4436">[ subject ]</a>
              <a href="author.html#4436">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
