<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Setting up WAN cluster vs using Shovel
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Setting%20up%20WAN%20cluster%20vs%20using%20Shovel&In-Reply-To=25204733.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004710.html">
   <LINK REL="Next"  HREF="004716.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Setting up WAN cluster vs using Shovel</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Setting%20up%20WAN%20cluster%20vs%20using%20Shovel&In-Reply-To=25204733.post%40talk.nabble.com"
       TITLE="[rabbitmq-discuss] Setting up WAN cluster vs using Shovel">0x6e6562 at gmail.com
       </A><BR>
    <I>Sun Aug 30 10:18:18 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004710.html">[rabbitmq-discuss]  Setting up WAN cluster vs using Shovel
</A></li>
        <LI>Next message: <A HREF="004716.html">[rabbitmq-discuss] beginners question about RabbitMQ over HTTP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4714">[ date ]</a>
              <a href="thread.html#4714">[ thread ]</a>
              <a href="subject.html#4714">[ subject ]</a>
              <a href="author.html#4714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Anuj,

On Sat, Aug 29, 2009 at 6:24 PM, Anuj Agarwal&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aagarwal at yellowpages.com</A>&gt; wrote:
&gt;<i> We plan to use RabbitMQ in 2 of our data centers. We're thinking of
</I>&gt;<i> setting up a local cluster in each data center and a 'WAN cluster' which
</I>&gt;<i> includes 2 nodes from each data center for applications that need to
</I>&gt;<i> publish msgs that should be retrievable from either data center.
</I>&gt;<i> Private address space is the same across the 2 co-los (same domain) so
</I>&gt;<i> configuring such a cluster is not an issue. Does this solution have
</I>&gt;<i> drawbacks as opposed to using the Shovel addon? This seems much simpler
</I>&gt;<i> to use than Shovel, but are how robust is the cluster against data
</I>&gt;<i> connection hiccups between the nodes?
</I>
Interesting. I don't know if anybody has run a Rabbit cluster split
across a WAN, and whilst it can be done, my first thought would be
that there is little sophistication for handling network partitions in
Rabbit. (Having said that, I don't know if running a Rabbit cluster on
EC2 counts as running over a WAN)

One attraction in splitting the cluster to make messages available to
consumers in both data centers is that when a client creates a queue,
it is local to the node that it connected to and hence you could keep
most of your network traffic local because the Rabbit handles the
intra-node communication on a per-message basis, i.e. it will only
ship one copy of a message between nodes even if you have multiple
bound queues.

This obviously leads to the downside of queues not reachable due to
partitioning and hence you will miss messages.

In this scenario, shovel *may* be less afflicted by partitioning due
to the fact that it could just queue up messages in the event of a
split brain and then replay them once coherency has been restored.
However there are probably some downsides to it such as the extra
configuration you'd have to do yourself. Also, I wouldn't say that the
original shovel implementation is of (dare I say) production quality.
Furthermore, I'm not aware of anybody that has actually used it in
anger in a WAN (although maybe there are some adaptations).

Another alternative to both of these schemes is to run Rabbit in one
data center and just have consumers connect over the WAN.

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004710.html">[rabbitmq-discuss]  Setting up WAN cluster vs using Shovel
</A></li>
	<LI>Next message: <A HREF="004716.html">[rabbitmq-discuss] beginners question about RabbitMQ over HTTP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4714">[ date ]</a>
              <a href="thread.html#4714">[ thread ]</a>
              <a href="subject.html#4714">[ subject ]</a>
              <a href="author.html#4714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
