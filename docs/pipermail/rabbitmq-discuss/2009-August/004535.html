<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to sanely bind one queue to many	exchanges?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20How%20to%20sanely%20bind%20one%20queue%20to%20many%0A%09exchanges%3F&In-Reply-To=65a6e3960908141029k214d6e8bkc4b3ab5c51219ecb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004533.html">
   <LINK REL="Next"  HREF="004536.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to sanely bind one queue to many	exchanges?</H1>
    <B>Paul Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20How%20to%20sanely%20bind%20one%20queue%20to%20many%0A%09exchanges%3F&In-Reply-To=65a6e3960908141029k214d6e8bkc4b3ab5c51219ecb%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] How to sanely bind one queue to many	exchanges?">pauljones23 at gmail.com
       </A><BR>
    <I>Fri Aug 14 18:53:36 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004533.html">[rabbitmq-discuss] How to sanely bind one queue to many	exchanges?
</A></li>
        <LI>Next message: <A HREF="004536.html">[rabbitmq-discuss] How to sanely bind one queue to many	exchanges?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4535">[ date ]</a>
              <a href="thread.html#4535">[ thread ]</a>
              <a href="subject.html#4535">[ subject ]</a>
              <a href="author.html#4535">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Nathan,


On Fri, Aug 14, 2009 at 6:29 PM, Nathan Gray &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">n8gray at n8gray.org</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> Maybe, maybe not.  I've written a multiplayer boardgame.  I used
</I>&gt;<i> Google App Engine for the server, which works fine but requires that
</I>&gt;<i> the client poll the server to detect when someone has made a move,
</I>&gt;<i> sent a chat, or otherwise generated an event.  (GAE doesn't allow
</I>&gt;<i> long-lived connections or raw socket access.)  I'm hoping to use
</I>&gt;<i> rabbitmq as an &quot;event server&quot; to get real-time updates to clients
</I>&gt;<i> without pounding GAE with HTTP requests.  When an event is generated
</I>&gt;<i> for a game, GAE publishes to the event server, which tells any
</I>&gt;<i> connected clients of the game to ask GAE for an update.
</I>&gt;<i>
</I>&gt;<i> There will be many games running, and each game has 2-4 players.  The
</I>&gt;<i> natural mapping (IMHO) to AMQP is to have one fanout exchange per
</I>&gt;<i> game.  The server on GAE creates this (durable) exchange when a new
</I>&gt;<i> game starts.  When the game ends there will be no more events from it,
</I>&gt;<i> so the exchange is deleted.  It's possible for a game to end before
</I>&gt;<i> the client connects (the last player can play while the client is
</I>&gt;<i> offline).  Each player can play multiple games, thus the requirement
</I>&gt;<i> to connect to multiple exchanges.  Clients connect with auto-delete
</I>&gt;<i> queues, since message content is uninteresting -- it's only the timing
</I>&gt;<i> they care about.
</I>&gt;<i>
</I>&gt;<i> If there's a better way to do this I'm happy to hear it.  I could use
</I>&gt;<i> one big direct exchange with player names as routing keys, but that
</I>&gt;<i> would require my publisher to send multiple messages for each game
</I>&gt;<i> event, one for each player in the game.  I could use one big topic
</I>&gt;<i> exchange with routing keys like &quot;joe.sally.bob&quot; and subscribe with
</I>&gt;<i> patterns like &quot;#.bob.#&quot;, but putting all the messages through one
</I>&gt;<i> topic exchange doesn't seem like it would scale well.
</I>&gt;<i>
</I>
Assuming that there is a known identifier for each game (database id, guid,
or equivalent), what about using a single direct exchange, with the routing
key being set to the game id each time. When a player connects, they
subscribe to the exchange with all of the routing keys for the games that
they are interested in.

As far as scalability is concerned, using a direct exchange with many
routing keys should hopefully be no worse than many fanout exchanges with no
routing keys. If you're considering the clustering scenario, exchange
information is replicated to all nodes - so it isn't like there is a single
point that all messages need to go through.

Thanks,
Paul.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090814/0d729d01/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090814/0d729d01/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004533.html">[rabbitmq-discuss] How to sanely bind one queue to many	exchanges?
</A></li>
	<LI>Next message: <A HREF="004536.html">[rabbitmq-discuss] How to sanely bind one queue to many	exchanges?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4535">[ date ]</a>
              <a href="thread.html#4535">[ thread ]</a>
              <a href="subject.html#4535">[ subject ]</a>
              <a href="author.html#4535">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
