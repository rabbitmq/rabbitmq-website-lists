<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Receiving Undelivered Persistent Messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Receiving%20Undelivered%20Persistent%20Messages&In-Reply-To=4A7FD751.1030408%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004458.html">
   <LINK REL="Next"  HREF="004465.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Receiving Undelivered Persistent Messages</H1>
    <B>Vidit Drolia</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Receiving%20Undelivered%20Persistent%20Messages&In-Reply-To=4A7FD751.1030408%40lshift.net"
       TITLE="[rabbitmq-discuss] Receiving Undelivered Persistent Messages">viditdrolia at gmail.com
       </A><BR>
    <I>Mon Aug 10 15:32:47 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004458.html">[rabbitmq-discuss] Receiving Undelivered Persistent Messages
</A></li>
        <LI>Next message: <A HREF="004465.html">[rabbitmq-discuss] Receiving Undelivered Persistent Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4460">[ date ]</a>
              <a href="thread.html#4460">[ thread ]</a>
              <a href="subject.html#4460">[ subject ]</a>
              <a href="author.html#4460">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

I am using RabbitMQ Java AMQP library ver. 1.6.0. PFA the scratch code
for the Consumer and Producer. You will have to pass in the username
and password as command line arguments.

On Mon, Aug 10, 2009 at 4:16 AM, Matthias Radestock&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>&gt; wrote:
&gt;<i> Vidit,
</I>&gt;<i>
</I>&gt;<i> Vidit Drolia wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> When a consumer's channel is closed, then all unacknowledged messages
</I>&gt;&gt;<i> are still available in the queue for subsequent consumers. If there
</I>&gt;&gt;<i> are N messages in the queue when the last consumer died, then when a
</I>&gt;&gt;<i> new consumer fires up, 1 message is delivered when the consumer
</I>&gt;&gt;<i> requests for a message by subscription. That is to say, executing:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> while(true){
</I>&gt;&gt;<i> &#160;delivery = consumer.nextDelivery();
</I>&gt;&gt;<i> //do something...
</I>&gt;&gt;<i> //acknowledge for delivery
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> will deliver 1 message leaving N-1 messages in the queue. However,
</I>&gt;&gt;<i> after one execution of the above loop, the consumer keeps waiting for
</I>&gt;&gt;<i> the next delivery, even though there are N-1 messages in the queue. My
</I>&gt;&gt;<i> question was, is this supposed to happen by design of a subscription.
</I>&gt;<i>
</I>&gt;<i> No, that is not supposed to happen. If there are N messages in the queue and
</I>&gt;<i> you have one consumer connecting to it and consuming messages as you
</I>&gt;<i> describe then that consumer should receive all the messages.
</I>&gt;<i>
</I>&gt;<i> What client are you using? Can you post all the code to reproduce this?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>


-- 
Vidit Drolia
-------------- next part --------------
A non-text attachment was scrubbed...
Name: QueueConsumer.java
Type: text/x-java
Size: 2305 bytes
Desc: not available
Url : <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090810/74b54d4a/attachment.java">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090810/74b54d4a/attachment.java</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: QueueProducer.java
Type: text/x-java
Size: 1690 bytes
Desc: not available
Url : <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090810/74b54d4a/attachment-0001.java">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090810/74b54d4a/attachment-0001.java</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004458.html">[rabbitmq-discuss] Receiving Undelivered Persistent Messages
</A></li>
	<LI>Next message: <A HREF="004465.html">[rabbitmq-discuss] Receiving Undelivered Persistent Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4460">[ date ]</a>
              <a href="thread.html#4460">[ thread ]</a>
              <a href="subject.html#4460">[ subject ]</a>
              <a href="author.html#4460">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
