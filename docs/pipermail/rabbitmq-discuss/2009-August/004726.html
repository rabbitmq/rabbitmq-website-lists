<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error: RabbitMQ.Client.ConnectionFactory.cs -	&quot;Only one usage of each socket address (protocol/network	address/port) is normally permitted&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Error%3A%20RabbitMQ.Client.ConnectionFactory.cs%20-%0A%09%22Only%20one%20usage%20of%20each%20socket%20address%20%28protocol/network%0A%09address/port%29%20is%20normally%20permitted%22&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004725.html">
   <LINK REL="Next"  HREF="004727.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error: RabbitMQ.Client.ConnectionFactory.cs -	&quot;Only one usage of each socket address (protocol/network	address/port) is normally permitted&quot;</H1>
    <B>Patrick Kenney</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Error%3A%20RabbitMQ.Client.ConnectionFactory.cs%20-%0A%09%22Only%20one%20usage%20of%20each%20socket%20address%20%28protocol/network%0A%09address/port%29%20is%20normally%20permitted%22&In-Reply-To="
       TITLE="[rabbitmq-discuss] Error: RabbitMQ.Client.ConnectionFactory.cs -	&quot;Only one usage of each socket address (protocol/network	address/port) is normally permitted&quot;">pekenney at gmail.com
       </A><BR>
    <I>Mon Aug 31 17:40:24 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004725.html">[rabbitmq-discuss] Problem with multiple subscribers on the	same queue
</A></li>
        <LI>Next message: <A HREF="004727.html">[rabbitmq-discuss] Transaction management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4726">[ date ]</a>
              <a href="thread.html#4726">[ thread ]</a>
              <a href="subject.html#4726">[ subject ]</a>
              <a href="author.html#4726">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As far as I can tell at the moment; this error is being thrown by the call
to &quot;&quot;FollowRedirectChain&quot; in RabbitMQ.Client.ConnectionFactory.cs ...

its being caught in the exception2 catch in FollowRedirectChain...

I have not been able to find anything specific to rabbitmq with others
having this particular error thus far but; I found the following ...
<A HREF="http://blogs.msdn.com/dgorti/archive/2005/09/18/470766.aspx">http://blogs.msdn.com/dgorti/archive/2005/09/18/470766.aspx</A> ( tried the
various suggestions and it made no difference)

seemed to closely resemble the condition, as I am sending 4000 copies of the
same message to the following method...

        public void PublishMessage(string pstrExchangeName, string
pstrReturnKey, string pstrXml)
        {
            try
            {
                using (IConnection conn = new
ConnectionFactory().CreateConnection(this.rabbitmqHost))
                {
                    using (IModel ch = conn.CreateModel())
                    {
                        IBasicProperties props = ch.CreateBasicProperties();
                        IStreamMessageBuilder b = new
StreamMessageBuilder(ch);

                        byte[] bytes = Encoding.UTF8.GetBytes(pstrXml);
                        b.WriteBytes(bytes);
                        ch.BasicPublish(pstrExchangeName, pstrReturnKey,
null, bytes);
                    }
                }
            }

            catch (Exception ex)
            {
                throw ex;
            }
        }

it consistently fails pretty close to the 4000' th... iteration 3959 etc...

I am thinking I am hitting some kind of configurable threshold in the
RabbitMQ Client  and or RabbitMQ ServiceModel... but have been unable thus
far to pin it down...

Another interesting thing is that this exact code works unchanged on a much
older, slower Pentium IV 2ghz, 2gig ram on windows xp pro vs. windows server
2003 enterprise  sp2... quad core xeon, 4gig, etc...

and each individual message size is about 400k

thanks in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090831/c7446426/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090831/c7446426/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004725.html">[rabbitmq-discuss] Problem with multiple subscribers on the	same queue
</A></li>
	<LI>Next message: <A HREF="004727.html">[rabbitmq-discuss] Transaction management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4726">[ date ]</a>
              <a href="thread.html#4726">[ thread ]</a>
              <a href="subject.html#4726">[ subject ]</a>
              <a href="author.html#4726">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
