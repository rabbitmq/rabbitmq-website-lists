<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq dying
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbitmq%20dying&In-Reply-To=269388e30806240418x784691cdh5095f312de98e156%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000960.html">
   <LINK REL="Next"  HREF="000963.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq dying</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbitmq%20dying&In-Reply-To=269388e30806240418x784691cdh5095f312de98e156%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] rabbitmq dying">0x6e6562 at gmail.com
       </A><BR>
    <I>Tue Jun 24 12:18:27 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000960.html">[rabbitmq-discuss] RabbitMQ odd behaviour
</A></li>
        <LI>Next message: <A HREF="000963.html">[rabbitmq-discuss] Hg Repo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#962">[ date ]</a>
              <a href="thread.html#962">[ thread ]</a>
              <a href="subject.html#962">[ subject ]</a>
              <a href="author.html#962">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dave,

On Tue, Jun 24, 2008 at 10:58 AM,  &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">David.Corcoran at edftrading.com</A>&gt; wrote:
&gt;<i> Unfortunately we're still able to crash it quite regularly.
</I>
When you say you are able to crash it regularly, are you saying the
rabbit process dies?

&gt;<i> I changed the
</I>&gt;<i> message handlers to use only a single reply queue and now it's more stable
</I>&gt;<i> but not perfect.
</I>
Have you noticed any difference in performance by doing that?

&gt;<i> The only thing that still looks suspicious is that the
</I>&gt;<i> producers are sometimes run in threads. We only have one connection, which
</I>&gt;<i> is apparently thread safe (from the javadocs), and we create a channel for
</I>&gt;<i> each thread but maybe this is causing problems? We're going to make them
</I>&gt;<i> single threaded and keep testing.
</I>
You need to make sure you correctly differentiating between
connections and channels.

The connection and channel manager are threadsafe, but each actual
channel should not be shared between threads.

In the AMQP model, the channel is the smallest unit of parallelism.

Hence on the client side, you should use one channel per application thread.

&gt;<i> I'm also going to upgrade everywhere to erlang 12b-3 to see if that helps.
</I>
I think you'll definitely get milage out of this, apart from having
many other bug fixes that have been made since 11b-5 was released.

&gt;<i> I'll also apply the connection disconnect patch whenever it's available.
</I>
I don't think that's going to change much for you, it'll just make the
log files look nicer :-)

&gt;<i> We're disconnecting nicely most of the time now but if you're debugging
</I>&gt;<i> then stopping the debugger causes a forced disconnect which causes an error
</I>&gt;<i> in the rabbitmq logs.
</I>
I wouldn't worry too much about that, although it is unsightly.
I am more concerned about the symptoms you were describing last week
about Rabbit becoming unavailable for some periods.


HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000960.html">[rabbitmq-discuss] RabbitMQ odd behaviour
</A></li>
	<LI>Next message: <A HREF="000963.html">[rabbitmq-discuss] Hg Repo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#962">[ date ]</a>
              <a href="thread.html#962">[ thread ]</a>
              <a href="subject.html#962">[ subject ]</a>
              <a href="author.html#962">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
