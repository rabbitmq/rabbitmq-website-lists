<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Suggestion: add start/4 to amqp_connection	in Erlang client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Suggestion%3A%20add%20start/4%20to%20amqp_connection%0A%09in%20Erlang%20client&In-Reply-To=269388e30806172210n2a98df7drc60ff54fdc2301b9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000956.html">
   <LINK REL="Next"  HREF="000930.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Suggestion: add start/4 to amqp_connection	in Erlang client</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Suggestion%3A%20add%20start/4%20to%20amqp_connection%0A%09in%20Erlang%20client&In-Reply-To=269388e30806172210n2a98df7drc60ff54fdc2301b9%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Suggestion: add start/4 to amqp_connection	in Erlang client">0x6e6562 at gmail.com
       </A><BR>
    <I>Wed Jun 18 07:12:11 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000956.html">[rabbitmq-discuss] Dialyzer errors in RabbitMQ Erlang client
</A></li>
        <LI>Next message: <A HREF="000930.html">[rabbitmq-discuss] rabbitmq dying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#929">[ date ]</a>
              <a href="thread.html#929">[ thread ]</a>
              <a href="subject.html#929">[ subject ]</a>
              <a href="author.html#929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Edwin,

On Wed, Jun 18, 2008 at 12:19 AM, Edwin Fine
&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss_efine at usa.net</A>&gt; wrote:
&gt;<i> There's no way to start a connection on a given vhost in the current version
</I>&gt;<i> of the Erlang client. amqp_connection only has start/2 and start/3
</I>&gt;<i> functions.
</I>&gt;<i>
</I>&gt;<i> I propose adding start/4 to amqp_connection by modifying it as follows:
</I>&gt;<i>
</I>&gt;<i> %% Starts a networked conection to a remote AMQP server.
</I>&gt;<i> start(User, Password, Host) -&gt;
</I>&gt;<i>     start(User, Password, Host, &lt;&lt;&quot;/&quot;&gt;&gt;).
</I>&gt;<i>
</I>&gt;<i> start(User, Password, Host, Vhost) when is_binary(Vhost) -&gt;
</I>&gt;<i>     Handshake = fun amqp_network_driver:handshake/1,
</I>&gt;<i>     InitialState = #connection_state{username = User,
</I>&gt;<i>                                      password = Password,
</I>&gt;<i>                                      serverhost = Host,
</I>&gt;<i>                                      vhostpath = Vhost},
</I>&gt;<i>     {ok, Pid} = gen_server:start_link(?MODULE, [InitialState, Handshake],
</I>&gt;<i> []),
</I>&gt;<i>     {Pid, network}.
</I>&gt;<i>
</I>&gt;<i> This does work, as I have been using the modified code for some months now.
</I>&gt;<i>
</I>&gt;<i> Any takers?
</I>

I've already applied this patch as part of a previous discussion on
the list, so it's in the latest version of the Erlang client. The
Erlang client has been migrated from monotone to hg, we are just
waiting on some infrastructure changes to go through to make the
Erlang client public again. Let me know if you want me to send you a
zipped image of the latest version for the meantime.

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000956.html">[rabbitmq-discuss] Dialyzer errors in RabbitMQ Erlang client
</A></li>
	<LI>Next message: <A HREF="000930.html">[rabbitmq-discuss] rabbitmq dying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#929">[ date ]</a>
              <a href="thread.html#929">[ thread ]</a>
              <a href="subject.html#929">[ subject ]</a>
              <a href="author.html#929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
