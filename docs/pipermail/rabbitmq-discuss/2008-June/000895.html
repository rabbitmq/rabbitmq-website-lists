<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Durable queues for STOMP broker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Durable%20queues%20for%20STOMP%20broker&In-Reply-To=EC24AD2C-7F4C-4B63-8C0A-E5687F237BA3%40soundcloud.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000894.html">
   <LINK REL="Next"  HREF="000905.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Durable queues for STOMP broker</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Durable%20queues%20for%20STOMP%20broker&In-Reply-To=EC24AD2C-7F4C-4B63-8C0A-E5687F237BA3%40soundcloud.com"
       TITLE="[rabbitmq-discuss] Durable queues for STOMP broker">tonyg at lshift.net
       </A><BR>
    <I>Sun Jun  1 11:05:58 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000894.html">[rabbitmq-discuss] Unknown message in the SASL log
</A></li>
        <LI>Next message: <A HREF="000905.html">[rabbitmq-discuss] Durable queues for STOMP broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#895">[ date ]</a>
              <a href="thread.html#895">[ thread ]</a>
              <a href="subject.html#895">[ subject ]</a>
              <a href="author.html#895">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Sean,

Sean Treadway wrote:
&gt;<i> Attached are 2 patches from my findings on how to expose some of the 
</I>&gt;<i> method parameters as STOMP headers.  They include the following changes:
</I>
Thanks very much for these. They look good. I'll apply them.

&gt;<i>  * expose 'passive', 'durable', 'auto-delete', 'exclusive' parameters of 
</I>&gt;<i> the AMQP 'queue.declare' method as STOMP headers in SUBSCRIBE
</I>
Hmm, naming and interoperability. While we're still in &quot;experimental&quot; 
status we can use any names we like, of course, but I'd be interested to 
compare and contrast the names we choose for things like this with the 
names other STOMP-supporting brokers use for similar features.

Does anyone on the list have any comments around this area?

On a related note, what do you think about trying to more generally 
expose more of the AMQP functionality over STOMP? We could look at ways 
of using the AMQP protocol definition to autogenerate the necessary 
marshalling code, just as we do for other transport and protocol bindings.

&gt;<i> I also found a bug in message persistence over server restarts in 
</I>&gt;<i> rabbitmq-1.3.0.
</I>
Well spotted. As you mention, this doesn't affect the core broker, or 
any AMQP-speaking clients; it's limited to other transports. Your patch 
will no doubt make life easier for future other-transport writers :-)

&gt;<i> Big thanks to you all at LShift for building this beautiful code.
</I>
You're welcome! I take it you're using Ruby to interact with the broker 
- have you tried any of the available Ruby AMQP clients out there? Can 
you share with us what kind of thing you're doing with RabbitMQ?

&gt;<i> Points I am unsure about are - the role 
</I>&gt;<i> of the 'passive' parameter to queue.declare,
</I>
&quot;passive&quot; essentially checks that the queue exists without creating it. 
If it doesn't exist, an error is signalled. I'll check to make sure the 
behaviour of the STOMP adapter in this case is sensible.

&gt;<i> whether or not to expose 
</I>&gt;<i> the 'nowait' parameter,
</I>
Probably best not. Well, not until we run into a case where it's needed, 
anyway - it's a bit of a nasty hack to work around the lack of 
pipelining in AMQP.

&gt;<i> whether or not to try and match ActiveMQ's STOMP 
</I>&gt;<i> header names or stick with the AMQP naming,
</I>
This is a great question. I'd love to hear your thoughts on the subject, 
not being familiar myself with any other broker-specific options and 
headers.

&gt;<i> interoperability of the 
</I>&gt;<i> properties patch for brokers such as HTTP and regression of the 
</I>&gt;<i> properties patch against AMQP messages with binary properties.
</I>
It seems safe to me, since less information is discarded after your 
patch than before.

&gt;<i> Also, 
</I>&gt;<i> the STOMP spec gives no insight for queue deletion when a durable queue 
</I>&gt;<i> is no longer needed.  Any ideas for that one?
</I>
Good point. I think we're probably pretty free to implement extensions 
of our own in this area - how about a &quot;DELETE&quot; command? This touches on 
my question above of how best to expose more of AMQP.

Thanks again for the contribution,
   Tony



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000894.html">[rabbitmq-discuss] Unknown message in the SASL log
</A></li>
	<LI>Next message: <A HREF="000905.html">[rabbitmq-discuss] Durable queues for STOMP broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#895">[ date ]</a>
              <a href="thread.html#895">[ thread ]</a>
              <a href="subject.html#895">[ subject ]</a>
              <a href="author.html#895">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
