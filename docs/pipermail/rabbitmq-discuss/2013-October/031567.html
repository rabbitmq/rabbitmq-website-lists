<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] messages stuck using shovel
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20messages%20stuck%20using%20shovel&In-Reply-To=%3Cfdb1d592867044d290aa57bbc45bf33f%40BN1PR07MB199.namprd07.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031565.html">
   <LINK REL="Next"  HREF="031569.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] messages stuck using shovel</H1>
    <B>Andy Gram</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20messages%20stuck%20using%20shovel&In-Reply-To=%3Cfdb1d592867044d290aa57bbc45bf33f%40BN1PR07MB199.namprd07.prod.outlook.com%3E"
       TITLE="[rabbitmq-discuss] messages stuck using shovel">agram at blackridge.us
       </A><BR>
    <I>Thu Oct 31 18:10:23 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031565.html">[rabbitmq-discuss] How do you handle recovering from a faulty	connection using RabbitMQ java client library?
</A></li>
        <LI>Next message: <A HREF="031569.html">[rabbitmq-discuss] messages stuck using shovel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31567">[ date ]</a>
              <a href="thread.html#31567">[ thread ]</a>
              <a href="subject.html#31567">[ subject ]</a>
              <a href="author.html#31567">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a configuration of 3 RabbitMQ nodes; devtop, devmid, devbot. I am implementing a star configuration with devtop as the center of the start. This is a pubsub application over a WAN. Any node can submit a new item to devtop and my publisher application will publish to all nodes, including itself. I am using shovel to instantiate a queue for each node that is bound to a fanout exchange on devtop. The published messages are stuck on devtop as below;

+-------+--------------------------------+-------------+-----------+---------+------------------------+---------------------+--------+----------+----------------+-------------------------+---------------+--------+---------+
|<i> vhost |              name              | auto_delete | consumers | durable | exclusive_consumer_tag |     idle_since      | memory | messages | messages_ready | messages_unacknowledged |     node      | policy | status  |
</I>+-------+--------------------------------+-------------+-----------+---------+------------------------+---------------------+--------+----------+----------------+-------------------------+---------------+--------+---------+
|<i> /     | amq.gen-QXyScDVGCoTv8bhcbrMOrA | False       | 1         | False   |                        | 2013-10-31 10:32:25 | 9456   | 1        | 0              | 1                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devtop</A> |        | running |
</I>|<i> /     | amq.gen-Ya03CVYcY-CEVKOYcSt0Xw | False       | 1         | False   |                        | 2013-10-31 10:32:25 | 9456   | 1        | 0              | 1                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devtop</A> |        | running |
</I>|<i> /     | new_ident_queue                | False       | 1         | True    |                        | 2013-10-31 10:32:28 | 14312  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devtop</A> |        | running |
</I>|<i> /     | pub_idents                     | False       | 0         | True    |                        | 2013-10-31 10:15:52 | 13760  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devtop</A> |        | running |
</I>|<i> /     | refresh_idents                 | False       | 2         | True    |                        | 2013-10-31 10:32:18 | 14192  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devtop</A> |        | running |
</I>|<i> /     | refresh_queue                  | False       | 1         | True    |                        | 2013-10-31 10:32:18 | 13976  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devtop</A> |        | running |
</I>+-------+--------------------------------+-------------+-----------+---------+------------------------+---------------------+--------+----------+----------------+-------------------------+---------------+--------+---------+

The status on devmid is as follows;

+-------+-----------------+-------------+-----------+---------+------------------------+---------------------+--------+----------+----------------+-------------------------+---------------+--------+---------+
|<i> vhost |      name       | auto_delete | consumers | durable | exclusive_consumer_tag |     idle_since      | memory | messages | messages_ready | messages_unacknowledged |     node      | policy | status  |
</I>+-------+-----------------+-------------+-----------+---------+------------------------+---------------------+--------+----------+----------------+-------------------------+---------------+--------+---------+
|<i> /     | ident_updates   | False       | 0         | True    |                        | 2013-10-31 17:32:03 | 21696  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devmid</A> |        | running |
</I>|<i> /     | new_ident_queue | False       | 1         | True    |                        | 2013-10-31 17:32:03 | 21912  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devmid</A> |        | running |
</I>|<i> /     | refresh_idents  | False       | 0         | True    |                        | 2013-10-31 17:32:03 | 21696  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devmid</A> |        | running |
</I>|<i> /     | refresh_queue   | False       | 1         | True    |                        | 2013-10-31 17:32:03 | 21912  | 0        | 0              | 0                       | <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at devmid</A> |        | running |
</I>+-------+-----------------+-------------+-----------+---------+------------------------+---------------------+--------+----------+----------------+-------------------------+---------------+--------+---------+

I am expecting shovel from devmid to move the messages from devtop queue to ident_updates queue on devmid. My shovel configuration follows:
{rabbitmq_shovel,
    [ {shovels, [ {ident_pub,
                    [ {sources, [ {broker, &quot;<A HREF="amqp://&quot;}">amqp://&quot;}</A>
                        , {declarations, [
                                 {'queue.declare',
                                        [{queue, &lt;&lt;&quot;new_ident_queue&quot;&gt;&gt; }
                                        , durable
                                        ]}
                                ]}
                        ]}
                    , {destinations, [ {broker, &quot;<A HREF="amqp://192.168.168.212&quot;}">amqp://192.168.168.212&quot;}</A>
                        , {declarations, [
                                 {'queue.declare',
                                        [{queue, &lt;&lt;&quot;new_ident_queue&quot;&gt;&gt; }
                                        , durable
                                        ]}
                                ]}
                        ]}
                    , {queue, &lt;&lt;&quot;new_ident_queue&quot;&gt;&gt;}
                    , {prefetch_count, 1}
                    , {ack_mode, on_confirm}
                    , {publish_properties, [ {delivery_mode, 2} ]}
                    , {reconnect_delay, 5}
                    ]},
                  {ident_sub,
                    [ {destinations, [ {broker, &quot;<A HREF="amqp://&quot;}">amqp://&quot;}</A>
                        , {declarations, [
                                {'queue.declare',
                                        [{queue, &lt;&lt;&quot;ident_updates&quot;&gt;&gt; }
                                        , durable
                                        ]}
                                ]}
                        ]}
                    , {sources, [ {broker, &quot;<A HREF="amqp://192.168.168.212&quot;}">amqp://192.168.168.212&quot;}</A>
                        , {declarations, [ {'exchange.declare',
                                [ {exchange, &lt;&lt;&quot;pub_idents&quot;&gt;&gt;}
                                        , {type, &lt;&lt;&quot;fanout&quot;&gt;&gt;}
                                        ]}
                                , {'queue.declare',
                                        [{queue, &lt;&lt;&gt;&gt; }
                                        , exclusive
                                        ]}
                                , {'queue.bind',
                                        [ {exchange, &lt;&lt;&quot;pub_idents&quot;&gt;&gt;}
                                        , {queue,    &lt;&lt;&gt;&gt;}
                                        ]}
                                ]}
                        ]}
                    , {queue, &lt;&lt;&gt;&gt;}
                    , {prefetch_count, 1}
                    , {ack_mode, on_confirm}
                    , {publish_properties, [ {delivery_mode, 2} ]}
                    , {reconnect_delay, 5}
                    ]},
...

My shovel is stuck!! Any help would be appreciated.

Thanks,
Andy


This email message is for the sole use of the intended recipient(s) and may contain confidential and privileged information. Any unauthorized review, use, disclosure or distribution is prohibited. If you are not the intended recipient, please contact the sender by reply email and destroy all copies of the original message. If you are the intended recipient, please be advised that the content of this message is subject to access, review and disclosure by the sender's Email System Administrator.


Andy Gram
BlackRidge Technology Inc.
www.blackridge.us&lt;<A HREF="http://www.blackridge.us/">http://www.blackridge.us/</A>&gt;
408-892-4044

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131031/fef5d567/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131031/fef5d567/attachment.htm</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031565.html">[rabbitmq-discuss] How do you handle recovering from a faulty	connection using RabbitMQ java client library?
</A></li>
	<LI>Next message: <A HREF="031569.html">[rabbitmq-discuss] messages stuck using shovel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31567">[ date ]</a>
              <a href="thread.html#31567">[ thread ]</a>
              <a href="subject.html#31567">[ subject ]</a>
              <a href="author.html#31567">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
