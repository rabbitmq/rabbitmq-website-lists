<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Long timeout if server host becomes	unreachable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Long%20timeout%20if%20server%20host%20becomes%0A%09unreachable&In-Reply-To=%3CB70411E0-85B1-4142-B9FC-5ADC5254778C%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030840.html">
   <LINK REL="Next"  HREF="030848.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Long timeout if server host becomes	unreachable</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Long%20timeout%20if%20server%20host%20becomes%0A%09unreachable&In-Reply-To=%3CB70411E0-85B1-4142-B9FC-5ADC5254778C%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Long timeout if server host becomes	unreachable">michael at rabbitmq.com
       </A><BR>
    <I>Tue Oct  8 15:05:03 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030840.html">[rabbitmq-discuss] Long timeout if server host becomes	unreachable
</A></li>
        <LI>Next message: <A HREF="030848.html">[rabbitmq-discuss] Long timeout if server host becomes	unreachable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30842">[ date ]</a>
              <a href="thread.html#30842">[ thread ]</a>
              <a href="subject.html#30842">[ subject ]</a>
              <a href="author.html#30842">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On oct 8, 2013, at 5:48 p.m., Oleg Lyalikov &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">oleg.lyalikov at gmail.com</A>&gt; wrote:

&gt;<i> If &quot;_socket&quot; field is not private in SocketFrameHandler I could try overriding &quot;close&quot; method and invoke just _socket.close() - maybe that would help. But the field is private (maybe we can copy/paste the class and instantiate our new one but it does not look good - it would be better to just enhance existing functionality not to replace - there could be some problems with compatibility with newer versions of RabbitMQ client lib, RabbitMQ tests should be run regularly as our own tests, etc).
</I>
I understand the desire to avoid deploying a fork. However, it's already clear that the client
needs to be modified somehow and you have a way to reliably reproduce the problem (is this correct?)

Perhaps the fastest turnaround time would be for you to make some changes and try them out.
Once a solution that works is found, we will see if it can be incorporated into the mainline.

&gt;<i> By the way do you know why SocketFrameHandler#close method invokes &quot;flush&quot; first before making socket.close()?
</I>
Closing a connection on the application side involves sending connection.close to RabbitMQ.

&gt;<i> Is it ok in case of write timeout just do socket.close() without flush?
</I>
In case of a write timeout, it is (we won't be using the connection once that happens anyway, right?)

&gt;<i> As for modifying SocketFrameHandler so that it will use locks with timeouts - that could be possible but with the same drawbacks as the solution above.
</I>
(nods)

&gt;<i> Both workarounds require careful testing and time, we will think about it. But I'm hoping RabbitMQ library will provide functionality to set socket write timeout in the future.
</I>
You can help with that. Contributing does involve submitting a CLA but digital ones
are accepted.

&gt;<i> Could you provide some ticket link so that we can monitor its status?
</I>
rabbitmq bug tracker is not public but we accept issues that are filed on github, so I filed
one you can watch:

<A HREF="https://github.com/rabbitmq/rabbitmq-java-client/issues/11">https://github.com/rabbitmq/rabbitmq-java-client/issues/11</A>

MK



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131008/92c359bf/attachment.pgp">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131008/92c359bf/attachment.pgp</A>&gt;
</PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030840.html">[rabbitmq-discuss] Long timeout if server host becomes	unreachable
</A></li>
	<LI>Next message: <A HREF="030848.html">[rabbitmq-discuss] Long timeout if server host becomes	unreachable
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30842">[ date ]</a>
              <a href="thread.html#30842">[ thread ]</a>
              <a href="subject.html#30842">[ subject ]</a>
              <a href="author.html#30842">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
