<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Wrong number of messages_ready shown in queue when using message-ttl with federation.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Wrong%20number%20of%20messages_ready%20shown%20in%20queue%0A%20when%20using%20message-ttl%20with%20federation.&In-Reply-To=%3C620281c7-b720-4a23-906c-1a49f93148a0%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030898.html">
   <LINK REL="Next"  HREF="030900.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Wrong number of messages_ready shown in queue when using message-ttl with federation.</H1>
    <B>Malte Hurrelmann</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Wrong%20number%20of%20messages_ready%20shown%20in%20queue%0A%20when%20using%20message-ttl%20with%20federation.&In-Reply-To=%3C620281c7-b720-4a23-906c-1a49f93148a0%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Wrong number of messages_ready shown in queue when using message-ttl with federation.">huitrouge at googlemail.com
       </A><BR>
    <I>Thu Oct 10 14:51:46 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030898.html">[rabbitmq-discuss] RabbitMQ cluster - why policy is appearing in all the nodes?
</A></li>
        <LI>Next message: <A HREF="030900.html">[rabbitmq-discuss] Wrong number of messages_ready shown in queue when using message-ttl with federation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30899">[ date ]</a>
              <a href="thread.html#30899">[ thread ]</a>
              <a href="subject.html#30899">[ subject ]</a>
              <a href="author.html#30899">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

we're using a two broker setup, connected by the federation-plugin to 
ensure the consumers have a broker to fail over to, if the primary broker 
should become unreachable.
Messages are published to an exchange in the master-broker with a 
message-ttl on them, so that they don't pile up endlessly on the main and 
backup broker.

I noticed in some rare cases the number of &quot;messages_ready&quot; in a queue as 
shown in management_plugin / REST-API / &quot;rabbitmqctl list_queues&quot; is not 
correct and increases to grow until I do a GET on that queue.
For example it shows 1000 messages and after I get 1 message of that queue 
next time it shows 500 messages remaining. After that the message-count is 
correct again.

I'm planning to do some monitoring on that info, so it would be nice to 
have reliable info on the number of message left in the queues.

Any ideas on how to fix this issue or where to get the correct amount of 
messages_ready elsewhere?

Best regards,
Malte.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131010/a7e43484/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131010/a7e43484/attachment.htm</A>&gt;
</PRE>


































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030898.html">[rabbitmq-discuss] RabbitMQ cluster - why policy is appearing in all the nodes?
</A></li>
	<LI>Next message: <A HREF="030900.html">[rabbitmq-discuss] Wrong number of messages_ready shown in queue when using message-ttl with federation.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30899">[ date ]</a>
              <a href="thread.html#30899">[ thread ]</a>
              <a href="subject.html#30899">[ subject ]</a>
              <a href="author.html#30899">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
