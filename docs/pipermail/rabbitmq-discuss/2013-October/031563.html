<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Weird error on 3.2.0 causing failures
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Weird%20error%20on%203.2.0%20causing%20failures&In-Reply-To=%3C527291D7.1050403%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031561.html">
   <LINK REL="Next"  HREF="031571.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Weird error on 3.2.0 causing failures</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Weird%20error%20on%203.2.0%20causing%20failures&In-Reply-To=%3C527291D7.1050403%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Weird error on 3.2.0 causing failures">simon at rabbitmq.com
       </A><BR>
    <I>Thu Oct 31 17:22:31 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031561.html">[rabbitmq-discuss] Weird error on 3.2.0 causing failures
</A></li>
        <LI>Next message: <A HREF="031571.html">[rabbitmq-discuss] Weird error on 3.2.0 causing failures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31563">[ date ]</a>
              <a href="thread.html#31563">[ thread ]</a>
              <a href="subject.html#31563">[ subject ]</a>
              <a href="author.html#31563">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Just to add to what I said before: you said that the message was 
published through management - how sure are you of that? I ask because 
you say you're also using the Erlang client.

If you use the Erlang client in direct mode then no validation is 
performed of any properties you pass in and you could provoke exactly 
this sort of breakage when subsequently reading in network mode.

Cheers, Simon

On 31/10/13 16:47, Jason McIntosh wrote:
&gt;<i> We have a consumer process that's just dying repeatedly throwing low
</I>&gt;<i> level channel errors.  This is using amqp-client 3.2.0.  We've tried
</I>&gt;<i> with an earlier version as well.  We die as soon as we try and do a
</I>&gt;<i> basicConsume on the channel.  On the server, I found the below logs.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Just wanted to see if anyone had any ideas?  We deleted the messages,
</I>&gt;<i> published them again and our consumer works fine.  This has us pretty
</I>&gt;<i> confused.  The ONLY guess I have right now is some sort of funky
</I>&gt;<i> character or a blank tag somehow got in, but I can't imagine what that
</I>&gt;<i> would be - nothing here seems out of place.  Note, the original problem
</I>&gt;<i> message was published through the management GUI.
</I>&gt;<i>
</I>&gt;<i> Thanks for any advice!
</I>&gt;<i>
</I>&gt;<i> Jason
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 31-Oct-2013::11:30:42 ===
</I>&gt;<i>
</I>&gt;<i>       Supervisor: {&lt;0.1276.61&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i>       Context: child_terminated
</I>&gt;<i>
</I>&gt;<i>       Reason: badarg
</I>&gt;<i>
</I>&gt;<i>       Offender:   [{pid,&lt;0.1275.61&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfargs,
</I>&gt;<i>
</I>&gt;<i> {rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.347665&gt;,2,131072,rabbit_framing_amqp_0_9_1,
</I>&gt;<i>
</I>&gt;<i> &lt;0.1278.61&gt;,true]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 31-Oct-2013::11:30:42 ===
</I>&gt;<i>
</I>&gt;<i>       Supervisor: {&lt;0.1276.61&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i>       Context:    shutdown
</I>&gt;<i>
</I>&gt;<i>       Reason: reached_max_restart_intensity
</I>&gt;<i>
</I>&gt;<i>       Offender: [{pid,&lt;0.1275.61&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfargs,
</I>&gt;<i>
</I>&gt;<i> {rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.347665&gt;,2,131072,rabbit_framing_amqp_0_9_1,
</I>&gt;<i>
</I>&gt;<i> &lt;0.1278.61&gt;,true]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i> =CRASH REPORT==== 31-Oct-2013::11:30:43 ===
</I>&gt;<i>
</I>&gt;<i>    crasher:
</I>&gt;<i>
</I>&gt;<i>      initial call: rabbit_writer:mainloop/2
</I>&gt;<i>
</I>&gt;<i>      pid: &lt;0.1299.61&gt;
</I>&gt;<i>
</I>&gt;<i>      registered_name: []
</I>&gt;<i>
</I>&gt;<i>      exception error: bad argument
</I>&gt;<i>
</I>&gt;<i>        in function rabbit_framing_amqp_0_9_1:encode_properties/1
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_binary_generator:ensure_content_encoded/2
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_binary_generator:build_simple_content_frames/4
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:assemble_frames/5
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:internal_send_command_async/3
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:handle_message/2
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:handle_message/3
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:mainloop1/2
</I>&gt;<i>
</I>&gt;<i>      ancestors: [&lt;0.1300.61&gt;,&lt;0.1303.61&gt;,&lt;0.1272.61&gt;,&lt;0.1273.61&gt;,
</I>&gt;<i>
</I>&gt;<i> rabbit_tcp_client_sup,rabbit_sup,&lt;0.165.0&gt;]
</I>&gt;<i>
</I>&gt;<i>      messages: [{send_command_and_notify,&lt;0.14808.16&gt;,&lt;0.1293.61&gt;,
</I>&gt;<i>
</I>&gt;<i> {'basic.deliver',&lt;&lt;&quot;amq.ctag-y_Tr2BuZFgx7A3XAmXxzSg&quot;&gt;&gt;,
</I>&gt;<i>
</I>&gt;<i> 2,true,&lt;&lt;&gt;&gt;,&lt;&lt;&quot;extractions.summarizer&quot;&gt;&gt;},
</I>&gt;<i>
</I>&gt;<i>                       {content,60,
</I>&gt;<i>
</I>&gt;<i> {'P_basic',&lt;&lt;&quot;text/plain&quot;&gt;&gt;,&lt;&lt;&quot;UTF-8&quot;&gt;&gt;,[],1,
</I>&gt;<i>
</I>&gt;<i> &lt;&lt;&quot;0&quot;&gt;&gt;,undefined,undefined,undefined,undefined,
</I>&gt;<i>
</I>&gt;<i> undefined,undefined,undefined,undefined,
</I>&gt;<i>
</I>&gt;<i> undefined},
</I>&gt;<i>
</I>&gt;<i> none,none,
</I>&gt;<i>
</I>&gt;<i> [&lt;&lt;&quot;{\&quot;jobName\&quot;:\&quot;BIGFauxTest2\&quot;,\&quot;creationTime\&quot;:\&quot;10-03-2013
</I>&gt;<i> 14:36:10\&quot;}&quot;&gt;&gt;]}}]
</I>&gt;<i>
</I>&gt;<i>      links: [&lt;0.1300.61&gt;]
</I>&gt;<i>
</I>&gt;<i>      dictionary: []
</I>&gt;<i>
</I>&gt;<i>      trap_exit: false
</I>&gt;<i>
</I>&gt;<i>      status: running
</I>&gt;<i>
</I>&gt;<i>      heap_size: 376
</I>&gt;<i>
</I>&gt;<i>      stack_size: 27
</I>&gt;<i>
</I>&gt;<i>      reductions: 423
</I>&gt;<i>
</I>&gt;<i>    neighbours:
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 31-Oct-2013::11:30:43 ===
</I>&gt;<i>
</I>&gt;<i>       Supervisor: {&lt;0.1300.61&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i>       Context: child_terminated
</I>&gt;<i>
</I>&gt;<i>       Reason: badarg
</I>&gt;<i>
</I>&gt;<i>       Offender: [{pid,&lt;0.1299.61&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfargs,
</I>&gt;<i>
</I>&gt;<i> {rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.347666&gt;,2,131072,rabbit_framing_amqp_0_9_1,
</I>&gt;<i>
</I>&gt;<i> &lt;0.1271.61&gt;,true]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 31-Oct-2013::11:30:43 ===
</I>&gt;<i>
</I>&gt;<i>       Supervisor: {&lt;0.1300.61&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i>       Context:    shutdown
</I>&gt;<i>
</I>&gt;<i>       Reason: reached_max_restart_intensity
</I>&gt;<i>
</I>&gt;<i>       Offender: [{pid,&lt;0.1299.61&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfargs,
</I>&gt;<i>
</I>&gt;<i> {rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.347666&gt;,2,131072,rabbit_framing_amqp_0_9_1,
</I>&gt;<i>
</I>&gt;<i> &lt;0.1271.61&gt;,true]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i> =CRASH REPORT==== 31-Oct-2013::11:30:43 ===
</I>&gt;<i>
</I>&gt;<i>    crasher:
</I>&gt;<i>
</I>&gt;<i>      initial call: rabbit_writer:mainloop/2
</I>&gt;<i>
</I>&gt;<i>      pid: &lt;0.1325.61&gt;
</I>&gt;<i>
</I>&gt;<i>      registered_name: []
</I>&gt;<i>
</I>&gt;<i>      exception error: bad argument
</I>&gt;<i>
</I>&gt;<i>        in function rabbit_framing_amqp_0_9_1:encode_properties/1
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_binary_generator:ensure_content_encoded/2
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_binary_generator:build_simple_content_frames/4
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:assemble_frames/5
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:internal_send_command_async/3
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:handle_message/2
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:handle_message/3
</I>&gt;<i>
</I>&gt;<i>        in call from rabbit_writer:mainloop1/2
</I>&gt;<i>
</I>&gt;<i>      ancestors: [&lt;0.1323.61&gt;,&lt;0.1317.61&gt;,&lt;0.1296.61&gt;,&lt;0.1297.61&gt;,
</I>&gt;<i>
</I>&gt;<i> rabbit_tcp_client_sup,rabbit_sup,&lt;0.165.0&gt;]
</I>&gt;<i>
</I>&gt;<i>      messages: [{send_command_and_notify,&lt;0.14808.16&gt;,&lt;0.1322.61&gt;,
</I>&gt;<i>
</I>&gt;<i> {'basic.deliver',&lt;&lt;&quot;amq.ctag-ACPfvFFpUNKEw1WOwN9IbQ&quot;&gt;&gt;,
</I>&gt;<i>
</I>&gt;<i> 2,true,&lt;&lt;&gt;&gt;,&lt;&lt;&quot;extractions.summarizer&quot;&gt;&gt;},
</I>&gt;<i>
</I>&gt;<i> {content,60,
</I>&gt;<i>
</I>&gt;<i> {'P_basic',&lt;&lt;&quot;text/plain&quot;&gt;&gt;,&lt;&lt;&quot;UTF-8&quot;&gt;&gt;,[],1,
</I>&gt;<i>
</I>&gt;<i> &lt;&lt;&quot;0&quot;&gt;&gt;,undefined,undefined,undefined,undefined,
</I>&gt;<i>
</I>&gt;<i> undefined,undefined,undefined,undefined,
</I>&gt;<i>
</I>&gt;<i> undefined},
</I>&gt;<i>
</I>&gt;<i> none,none,
</I>&gt;<i>
</I>&gt;<i> [&lt;&lt;&quot;{\&quot;jobName\&quot;:\&quot;BIGFauxTest2\&quot;,\&quot;creationTime\&quot;:\&quot;10-03-2013
</I>&gt;<i> 14:36:10\&quot;}&quot;&gt;&gt;]}}]
</I>&gt;<i>
</I>&gt;<i>      links: [&lt;0.1323.61&gt;]
</I>&gt;<i>
</I>&gt;<i>      dictionary: []
</I>&gt;<i>
</I>&gt;<i>      trap_exit: false
</I>&gt;<i>
</I>&gt;<i>      status: running
</I>&gt;<i>
</I>&gt;<i>      heap_size: 376
</I>&gt;<i>
</I>&gt;<i>      stack_size: 27
</I>&gt;<i>
</I>&gt;<i>      reductions: 438
</I>&gt;<i>
</I>&gt;<i>    neighbours:
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 31-Oct-2013::11:30:43 ===
</I>&gt;<i>
</I>&gt;<i>       Supervisor: {&lt;0.1323.61&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i>       Context: child_terminated
</I>&gt;<i>
</I>&gt;<i>       Reason: badarg
</I>&gt;<i>
</I>&gt;<i>       Offender: [{pid,&lt;0.1325.61&gt;},
</I>&gt;<i>
</I>&gt;<i>              {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfargs,
</I>&gt;<i>
</I>&gt;<i> {rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.347667&gt;,2,131072,rabbit_framing_amqp_0_9_1,
</I>&gt;<i>
</I>&gt;<i> &lt;0.1295.61&gt;,true]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 31-Oct-2013::11:30:43 ===
</I>&gt;<i>
</I>&gt;<i>       Supervisor: {&lt;0.1323.61&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i>       Context:    shutdown
</I>&gt;<i>
</I>&gt;<i>       Reason: reached_max_restart_intensity
</I>&gt;<i>
</I>&gt;<i>       Offender: [{pid,&lt;0.1325.61&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfargs,
</I>&gt;<i>
</I>&gt;<i> {rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.347667&gt;,2,131072,rabbit_framing_amqp_0_9_1,
</I>&gt;<i>
</I>&gt;<i> &lt;0.1295.61&gt;,true]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Jason McIntosh
</I>&gt;<i> <A HREF="https://github.com/jasonmcintosh/">https://github.com/jasonmcintosh/</A>
</I>&gt;<i> 573-424-7612
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031561.html">[rabbitmq-discuss] Weird error on 3.2.0 causing failures
</A></li>
	<LI>Next message: <A HREF="031571.html">[rabbitmq-discuss] Weird error on 3.2.0 causing failures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31563">[ date ]</a>
              <a href="thread.html#31563">[ thread ]</a>
              <a href="subject.html#31563">[ subject ]</a>
              <a href="author.html#31563">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
