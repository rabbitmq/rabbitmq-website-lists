<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-server dies from out of memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-server%20dies%20from%20out%20of%20memory&In-Reply-To=%3CCAMcAHLWy0-EJswxCWO45zJZxPTcbSGT3qdMj0t-B8u-N5MPXVg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031475.html">
   <LINK REL="Next"  HREF="031492.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-server dies from out of memory</H1>
    <B>Alvaro Videla</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-server%20dies%20from%20out%20of%20memory&In-Reply-To=%3CCAMcAHLWy0-EJswxCWO45zJZxPTcbSGT3qdMj0t-B8u-N5MPXVg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-server dies from out of memory">videlalvaro at gmail.com
       </A><BR>
    <I>Tue Oct 29 21:15:30 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031475.html">[rabbitmq-discuss] rabbitmq-server dies from out of memory
</A></li>
        <LI>Next message: <A HREF="031492.html">[rabbitmq-discuss] rabbitmq-server dies from out of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31476">[ date ]</a>
              <a href="thread.html#31476">[ thread ]</a>
              <a href="subject.html#31476">[ subject ]</a>
              <a href="author.html#31476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Which version of Erlang are you using? 32 bits or 64 bits?

What's the OS?

I've seen this error on 32 bits Erlang on Mac.

Regards,

Alvaro


On Tue, Oct 29, 2013 at 10:10 PM, Fran&#231;ois Beausoleil &lt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">francois.beausoleil at gmail.com</A>&gt; wrote:

&gt;<i> Hi all!
</I>&gt;<i>
</I>&gt;<i> I have a bare metal server with 32 GiB of RAM. I installed RabbitMQ 3.2.0,
</I>&gt;<i> Erlang R16B02.
</I>&gt;<i>
</I>&gt;<i> When load increases (publishing over 4000 msgs/s), RabbitMQ dies with
</I>&gt;<i> &quot;Could not allocate memory&quot; errors:
</I>&gt;<i>
</I>&gt;<i> Crash dump was written to: erl_crash.dump
</I>&gt;<i> eheap_alloc: Cannot allocate 529782288 bytes of memory (of type &quot;heap&quot;).
</I>&gt;<i>
</I>&gt;<i> The messages which are published are about 4 KiB of XML. The persistent
</I>&gt;<i> option is set to true, to ensure persistence across reboots.
</I>&gt;<i>
</I>&gt;<i> The host has configuration for overcommit:
</I>&gt;<i>
</I>&gt;<i> # cat /proc/sys/vm/overcommit_ratio
</I>&gt;<i> 50
</I>&gt;<i> # cat /proc/sys/vm/overcommit_memory
</I>&gt;<i> 2
</I>&gt;<i>
</I>&gt;<i> On start, RabbitMQ correctly identifies the total amount of memory:
</I>&gt;<i>
</I>&gt;<i> =INFO REPORT==== 29-Oct-2013::20:58:03 ===
</I>&gt;<i> node           : <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at skyler</A>
</I>&gt;<i> home dir       : /var/lib/rabbitmq
</I>&gt;<i> config file(s) : (none)
</I>&gt;<i> cookie hash    : mV5+4OI0hTEXkDPMtOzVdQ==
</I>&gt;<i> log            : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at skyler.log</A>
</I>&gt;<i> sasl log       : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at skyler-sasl.log</A>
</I>&gt;<i> database dir   : /var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at skyler</A>
</I>&gt;<i>
</I>&gt;<i> =INFO REPORT==== 29-Oct-2013::20:58:04 ===
</I>&gt;<i> Limiting to approx 3996 file handles (3594 sockets)
</I>&gt;<i>
</I>&gt;<i> =INFO REPORT==== 29-Oct-2013::20:58:04 ===
</I>&gt;<i> Memory limit set to 12826MB of 32066MB total.
</I>&gt;<i>
</I>&gt;<i> =INFO REPORT==== 29-Oct-2013::20:58:04 ===
</I>&gt;<i> Disk free limit set to 50MB
</I>&gt;<i>
</I>&gt;<i> On the same host, I'm also running a Java application. The Java
</I>&gt;<i> application's max heap is set to 6 GiB, through -Xmx6g.
</I>&gt;<i>
</I>&gt;<i> Google and StackOverflow aren't very helpful: there are a few mentions,
</I>&gt;<i> but not many apply to RabbitMQ, and the other ones don't seem to apply or
</I>&gt;<i> are very old.
</I>&gt;<i>
</I>&gt;<i> What can I do to troubleshoot the problem?
</I>&gt;<i>
</I>&gt;<i> Thanks!
</I>&gt;<i> Fran&#231;ois
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131029/a5bab8eb/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131029/a5bab8eb/attachment.htm</A>&gt;
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031475.html">[rabbitmq-discuss] rabbitmq-server dies from out of memory
</A></li>
	<LI>Next message: <A HREF="031492.html">[rabbitmq-discuss] rabbitmq-server dies from out of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31476">[ date ]</a>
              <a href="thread.html#31476">[ thread ]</a>
              <a href="subject.html#31476">[ subject ]</a>
              <a href="author.html#31476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
