<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Limitations with RabbitMQ Java Client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Limitations%20with%20RabbitMQ%20Java%20Client&In-Reply-To=%3C42104957-9225-4527-9877-C52979C84BF0%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031270.html">
   <LINK REL="Next"  HREF="031241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Limitations with RabbitMQ Java Client</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Limitations%20with%20RabbitMQ%20Java%20Client&In-Reply-To=%3C42104957-9225-4527-9877-C52979C84BF0%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Limitations with RabbitMQ Java Client">steve at rabbitmq.com
       </A><BR>
    <I>Wed Oct 23 14:51:33 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031270.html">[rabbitmq-discuss] Limitations with RabbitMQ Java Client
</A></li>
        <LI>Next message: <A HREF="031241.html">[rabbitmq-discuss] RabbitMQ / Erlang not running on all cores?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31278">[ date ]</a>
              <a href="thread.html#31278">[ thread ]</a>
              <a href="subject.html#31278">[ subject ]</a>
              <a href="author.html#31278">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>One more point.

As is usual for ThreadPoolExecutor (Java) objects, the threads 
in the pool are created on demand.  So it is not correct to say that all 
connections will have 6 threads created. If you don't use Consumer 
callbacks at all, there will only be one connection thread created (for 
async communication).  Even if you have callbacks, you will have at 
most one extra thread per channel.

The default ExecutorService we generate uses a fixed pool of size 5, 
which means once 5 are created no more are allocated (requests beyond
this are queued until a thread is free).  These threads persist until
the ExecutorService is stopped. This happens automatically when the 
connection is closed.

If an ExecutorService is supplied by the application it is never explicitly 
stopped by the client.

Steve Powell  [Cell: +44-7815-838-558] [RabbitMQ, Pivotal]
&#8220;L&#8217;enfer, c&#8217;est les autres.&#8221; Sartre

On 23 Oct 2013, at 11:47, Steve Powell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt; wrote:

&gt;<i> It is not dangerous to share executors between connections.
</I>&gt;<i> 
</I>&gt;<i> If you supply your own Executor (which you must do if you want to share them), then the client will not shutdown the executor when the connection closes.  If you rely on the default, then the (private) executor is closed for you when the connection closes.
</I>&gt;<i> 
</I>&gt;<i> Sharing the executor between multiple connections by default means we would have to have a more complex rule for tidying up the (shared) executor, and possibly some option for setting it off? If the user needs this they can achieve it explicitly at present.
</I>&gt;<i> 
</I>&gt;<i> Steve Powell  [Cell: +44-7815-838-558] [RabbitMQ, Pivotal]
</I>&gt;<i> &#8220;L&#8217;enfer, c&#8217;est les autres.&#8221; Sartre
</I>&gt;<i> 
</I>&gt;<i> On 23 Oct 2013, at 10:45, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On 23 Oct 2013, at 13:36, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Actually I don't see why we shouldn't do this by default. I will file a bug...
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Note that executors cannot be restated and Connection#close shuts down the executor
</I>&gt;&gt;<i> it uses. So sharing executors between connections is quite dangerous.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> MK
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>







































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031270.html">[rabbitmq-discuss] Limitations with RabbitMQ Java Client
</A></li>
	<LI>Next message: <A HREF="031241.html">[rabbitmq-discuss] RabbitMQ / Erlang not running on all cores?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31278">[ date ]</a>
              <a href="thread.html#31278">[ thread ]</a>
              <a href="subject.html#31278">[ subject ]</a>
              <a href="author.html#31278">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
