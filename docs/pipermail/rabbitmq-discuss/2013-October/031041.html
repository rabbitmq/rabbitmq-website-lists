<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] mirrored queue cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20mirrored%20queue%20cluster&In-Reply-To=%3C263D8F04-724A-470B-A8CA-4F6987F87030%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030787.html">
   <LINK REL="Next"  HREF="031042.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] mirrored queue cluster</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20mirrored%20queue%20cluster&In-Reply-To=%3C263D8F04-724A-470B-A8CA-4F6987F87030%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] mirrored queue cluster">tim at rabbitmq.com
       </A><BR>
    <I>Wed Oct 16 15:01:31 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030787.html">[rabbitmq-discuss] mirrored queue cluster
</A></li>
        <LI>Next message: <A HREF="031042.html">[rabbitmq-discuss] mirrored queue cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31041">[ date ]</a>
              <a href="thread.html#31041">[ thread ]</a>
              <a href="subject.html#31041">[ subject ]</a>
              <a href="author.html#31041">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On 5 Oct 2013, at 16:48, PATAR, SAGAR wrote:
&gt;<i> The requirement we have is a simple JMS topic with failover and persistency.. 
</I>&gt;<i> Where multiple client subscribe for the messages and when a new client is introduced NO changes in framework as  the Topic is already configured for failover and persistence ..the new client will just make a connection and start consuming ..
</I>&gt;<i> 
</I>
You are conflating queues and topics here, which is hardly surprising given that you're coming at this from a JMS perspective, but still. In AMQP, there is no such thing as a topic, however there is such a thing as a topic exchange, which routes to specific queues based on matching between a message routing key and the pattern that was used to bind a queue to an exchange. A topic exchange then, will route the same message to multiple queues, if the bindings in question match the routing key.

&gt;<i> With RabbitMQ my understanding is we need to configure a new queue and mirror it and then ask the new client to consume the message ...??
</I>&gt;<i> 
</I>
You need to bear in mind that mirroring only applies to queues, and topics do not exist as an entity that holds messages. So you're right in one sense, because you can only mirror queues and in order to filter subscriptions based on routing key, you will need multiple queues bound to a topic exchange.

&gt;<i> Pl. check slide 3 and  4 in the attachment ... For new client do we need to configure a new mirrored queue ... All the queues should get all the messages from the exchange ...
</I>&gt;<i> 
</I>
If that client wishes to get a copy of each message, then yes, you will need to add another queue. If you did not, messages in a single queue would be delivered to clients in a round-robbin fashion, so not all clients would see all messages.

&gt;<i> On oct 5, 2013, at 12:54 a.m., &quot;PATAR, SAGAR&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sp345s at att.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> But still we have to manage all the mirror configurations of all the separate queues per client .. and also when a new client is introduced we have to change our configuration to create a new queue and then mirror it etc ....right
</I>&gt;<i> 
</I>
Yes and no. When you declare a queue using AMQP, it will only be created if it does not already exist, so your client can simply declare the queue whenever it starts up. Mirroring for queues is controlled by policy, so you can ensure that whenever your queue is first created, an HA/Mirroring policy will be automatically applied to it.

On 7 Oct 2013, at 15:11, PATAR, SAGAR wrote:
&gt;<i> 1)The consumer can simply subscribe BUT there is NO way the dynamic queue is mirrored and also if the consumer has a downtime then the messages published during the downtime will be lost as the dynamic queue will be deleted .. Even if there is a feature where the dynamic queue is not deleted when the connection fails .. Can we mirror that queue and also how can we make sure when the client reconnects will it be using the same queue or will create a NEW queue...
</I>&gt;<i> 
</I>
As I said, mirroring can happen automatically if an administrator configures the relevant policies on the broker.

&gt;<i> 2)If we need to mirror the queue the new consumer is going to consume from then we might have to do some confutation changes ..right??
</I>&gt;<i> 
</I>
No, the policy will be applied automatically when the queue is first created.

&gt;<i> &quot; Note that I was explaining things in AMQP 0-9-1 terms, and now you've revealed that your
</I>&gt;<i> requirements are framed in JMS terms, which are not exactly the same.&quot; ..
</I>&gt;<i> Can we use Rabbit to achieve the JMS based requirements ??
</I>
Yes, I should think so, however...

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] On Behalf Of Michael Klishin
</I>&gt;<i> Sent: Monday, October 07, 2013 9:41 AM
</I>&gt;<i> To: Discussions about RabbitMQ
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] mirrored queue cluster
</I>&gt;<i> 
</I>&gt;<i> Unfortunately, I'm not familiar with how vFabric Rabbit's JMS client maps RabbitMQ protocol
</I>&gt;<i> to JMS.
</I>

I must admit that I haven't looked at how the RabbitMQ JMS client maps queues and exchanges to Topics. However the entities we've discussed thus far are all AMQP based, so some kind of mapping ought to be possible.

HTH

Cheers,
Tim


</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030787.html">[rabbitmq-discuss] mirrored queue cluster
</A></li>
	<LI>Next message: <A HREF="031042.html">[rabbitmq-discuss] mirrored queue cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31041">[ date ]</a>
              <a href="thread.html#31041">[ thread ]</a>
              <a href="subject.html#31041">[ subject ]</a>
              <a href="author.html#31041">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
