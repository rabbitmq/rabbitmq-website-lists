<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit connections dying from protected	enviornment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20connections%20dying%20from%20protected%0A%09enviornment&In-Reply-To=%3CCAD6m6fEDqdx8QgbHymKywTXAJJTUM4Qk%2B4dqxZwcOJsC4f0Fvw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031054.html">
   <LINK REL="Next"  HREF="031358.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit connections dying from protected	enviornment</H1>
    <B>Jason McIntosh</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20connections%20dying%20from%20protected%0A%09enviornment&In-Reply-To=%3CCAD6m6fEDqdx8QgbHymKywTXAJJTUM4Qk%2B4dqxZwcOJsC4f0Fvw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbit connections dying from protected	enviornment">mcintoshj at gmail.com
       </A><BR>
    <I>Fri Oct 25 14:54:11 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031054.html">[rabbitmq-discuss] Rabbit connections dying from protected enviornment
</A></li>
        <LI>Next message: <A HREF="031358.html">[rabbitmq-discuss] Rabbit connections dying from protected	enviornment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31356">[ date ]</a>
              <a href="thread.html#31356">[ thread ]</a>
              <a href="subject.html#31356">[ subject ]</a>
              <a href="author.html#31356">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We hit the same kinda things with the F5's.  The F5's work more as a proxy
and not a router so the basic TCP FastL4 connection profile does a reset on
an idle connection at a default of 5 minutes.  We added a new F5 FastL4
profile for 10 minute resets and upgraded to the rabbit 3 release that
added heartbeat support, and a lot of our issues went away.  Note you'd
only see the issue if there was 0 traffic going through, e.g. no messages
being published.  We have a lot of servers set to shovel to a centralized
location and some of our remote nodes weren't publishing regularly - turns
out we saw very regular (5 minute intervals) disconnects on the log files.

I would recommend tweaking your connection settings.  For example, the f5's
don't have a default protocol handler for AMQP, so we had  to use TCP
handling.

Jason


On Wed, Oct 16, 2013 at 10:21 AM, Ganann, Kale &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">KGanann at kroll.com</A>&gt; wrote:

&gt;<i> They hadn't had their heartbeats set correctly.  We've updated the broker
</I>&gt;<i> to push a heartbeat every four minutes from our end of the connection.
</I>&gt;<i>  Thanks for your help!
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Kale
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Emile Joubert [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>]
</I>&gt;<i> Sent: Friday, October 11, 2013 11:11 AM
</I>&gt;<i> To: Discussions about RabbitMQ
</I>&gt;<i> Cc: Ganann, Kale
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] Rabbit connections dying from protected
</I>&gt;<i> enviornment
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi Kale,
</I>&gt;<i>
</I>&gt;<i> On 11/10/13 16:54, Ganann, Kale wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; If we try to go past the VIP straight to a node, it fails outright
</I>&gt;<i>
</I>&gt;<i> In what way exactly does it fail? What do the broker logfiles say?
</I>&gt;<i>
</I>&gt;<i> What happens if you shut down all but one of the broker nodes?
</I>&gt;<i>
</I>&gt;<i> &gt; Thus the main issue is what is the client seeing that causing it to
</I>&gt;<i> &gt; restart the connection.
</I>&gt;<i>
</I>&gt;<i> That's hard to guess without knowing the logic of the client or it's
</I>&gt;<i> network input.
</I>&gt;<i>
</I>&gt;<i> &gt; Any ideas on what in that sequence could be hosing us up?
</I>&gt;<i>
</I>&gt;<i> It should be possible to provide better feedback if you can supply the
</I>&gt;<i> output of connecting the client via the tracer:
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/javadoc/com/rabbitmq/tools/Tracer.html">http://www.rabbitmq.com/javadoc/com/rabbitmq/tools/Tracer.html</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This communication contains information that is confidential,
</I>&gt;<i> proprietary in nature, and may also be attorney-client privileged
</I>&gt;<i> and/or work product privileged. It is for the exclusive use of the
</I>&gt;<i> intended recipient(s). If you are not the intended recipient(s) or
</I>&gt;<i> the person responsible for delivering it to the intended
</I>&gt;<i> recipient(s), please note that any form of dissemination,
</I>&gt;<i> distribution or copying of this communication is strictly
</I>&gt;<i> prohibited and may be unlawful. If you have received this
</I>&gt;<i> communication in error, please immediately notify the sender by replying
</I>&gt;<i> to this message and delete this email immediately. Thank you for your
</I>&gt;<i> cooperation.
</I>&gt;<i>
</I>&gt;<i> Please be advised that neither Altegrity, its affiliates, its employees
</I>&gt;<i> or agents accept liability for any errors, omissions or damages
</I>&gt;<i> caused by delays of receipt or by any virus infection in this
</I>&gt;<i> message or its attachments, or which may otherwise arise as a
</I>&gt;<i> result of this e-mail transmission.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
Jason McIntosh
<A HREF="https://github.com/jasonmcintosh/">https://github.com/jasonmcintosh/</A>
573-424-7612
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131025/e202de46/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131025/e202de46/attachment.htm</A>&gt;
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031054.html">[rabbitmq-discuss] Rabbit connections dying from protected enviornment
</A></li>
	<LI>Next message: <A HREF="031358.html">[rabbitmq-discuss] Rabbit connections dying from protected	enviornment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31356">[ date ]</a>
              <a href="thread.html#31356">[ thread ]</a>
              <a href="subject.html#31356">[ subject ]</a>
              <a href="author.html#31356">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
