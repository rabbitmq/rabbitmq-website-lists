<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] High availability questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20High%20availability%20questions&In-Reply-To=%3C8781D194-67D8-4162-BA59-BB396FC605A8%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024362.html">
   <LINK REL="Next"  HREF="024374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] High availability questions</H1>
    <B>McIntosh Jason</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20High%20availability%20questions&In-Reply-To=%3C8781D194-67D8-4162-BA59-BB396FC605A8%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] High availability questions">mcintoshj at gmail.com
       </A><BR>
    <I>Thu Dec  6 03:19:43 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024362.html">[rabbitmq-discuss] High availability questions
</A></li>
        <LI>Next message: <A HREF="024374.html">[rabbitmq-discuss] High availability questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24363">[ date ]</a>
              <a href="thread.html#24363">[ thread ]</a>
              <a href="subject.html#24363">[ subject ]</a>
              <a href="author.html#24363">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Design we use:

Shovel to a virtual ip rabbit cluster.
Rabbit consumers on that cluster.
Start new cluster.  
Can point consumers to hard coded cluster.
Shift shovel and/or change VIP to point to new cluster.
When all messages on old consumers cleaned, shut them down point em to new cluster.

Our consumers are java apps built into rpms we deploy, so updates are just a restart/new rpm deploy

This is pretty rough but hope it helps!
Jason

Sent from my iPhone

On Dec 5, 2012, at 9:00 PM, Chris Toomey &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ctoomey at gmail.com</A>&gt; wrote:

&gt;<i> Belated follow-up on this thread.  Can you talk more about how you manage
</I>&gt;<i> this?  E.g., how do you ensure that clients continue consuming from the old
</I>&gt;<i> cluster until all the messages published to it have been consumed?  And
</I>&gt;<i> during the transition time, consuming clients consume from both old and new
</I>&gt;<i> cluster, right?  What hardware/software do you use to gradually shift
</I>&gt;<i> publishing from old to new cluster?
</I>&gt;<i> 
</I>&gt;<i> We're just now designing and implementing our infrastructure and apps so
</I>&gt;<i> would like to get it as right as possible from the beginning.  Anyone else
</I>&gt;<i> using/recommend other approaches to this problem?
</I>&gt;<i> 
</I>&gt;<i> thx,
</I>&gt;<i> Chris
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Laing, Michael P. wrote
</I>&gt;&gt;<i> We bring up parallel infrastructure with a complete new cluster and
</I>&gt;&gt;<i> gradually shift load to it using weighted routing.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This won't work for everybody, but we have designed our apps with this in
</I>&gt;&gt;<i> mind.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Michael
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> From: Chris Toomey &amp;lt;
</I>&gt;<i> 
</I>&gt;&gt;<i> ctoomey@
</I>&gt;<i> 
</I>&gt;&gt;<i> &amp;lt;mailto:
</I>&gt;<i> 
</I>&gt;&gt;<i> ctoomey@
</I>&gt;<i> 
</I>&gt;&gt;<i> &amp;gt;&gt;
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i> That's unfortunate about having to shut down the whole cluster to upgrade
</I>&gt;&gt;<i> it -- it means that our applications will need to have some additional HA
</I>&gt;&gt;<i> queueing mechanism upstream to buffer up the messages to be published
</I>&gt;&gt;<i> during the downtime :-(.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> What kinds of solutions are people using for that problem?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/High-availability-questions-tp23690p23889.html">http://rabbitmq.1065348.n5.nabble.com/High-availability-questions-tp23690p23889.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>













































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024362.html">[rabbitmq-discuss] High availability questions
</A></li>
	<LI>Next message: <A HREF="024374.html">[rabbitmq-discuss] High availability questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24363">[ date ]</a>
              <a href="thread.html#24363">[ thread ]</a>
              <a href="subject.html#24363">[ subject ]</a>
              <a href="author.html#24363">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
