<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] AMQP protocol header mismatch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AMQP%20protocol%20header%20mismatch&In-Reply-To=%3C3D2571742EC3BD49BE55473100CF8F95080941AF%40EXUAU020HWT111.oceania.corp.anz.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024406.html">
   <LINK REL="Next"  HREF="024402.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] AMQP protocol header mismatch</H1>
    <B>Earp, Clem</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AMQP%20protocol%20header%20mismatch&In-Reply-To=%3C3D2571742EC3BD49BE55473100CF8F95080941AF%40EXUAU020HWT111.oceania.corp.anz.com%3E"
       TITLE="[rabbitmq-discuss] AMQP protocol header mismatch">Clem.Earp at anz.com
       </A><BR>
    <I>Mon Dec 10 03:54:48 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024406.html">[rabbitmq-discuss] Stomp topic perl
</A></li>
        <LI>Next message: <A HREF="024402.html">[rabbitmq-discuss] AMQP protocol header mismatch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24401">[ date ]</a>
              <a href="thread.html#24401">[ thread ]</a>
              <a href="subject.html#24401">[ subject ]</a>
              <a href="author.html#24401">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I have just installed the latest .NET and Java RabbitMQ clients on
Windows XP to test against a socket program on a Solaris box. The socket
program simply echoes back what it received. My reading of the AMQP
standards is that the first TCP packet received after the socket
connects is the AMQP protocol header, and if the &quot;server&quot; accepts the
AMQP connection then it should echo back the same AMQP protocol header
as a sign that it can support the protocol version. And this is what I
see with a tcpdump (taken at the Windows end i.e. WinDump):

14:47:41.377235 IP mywindows.4828 &gt; sol1.1430: P 1:9(8) ack 1 win 65535
	0x0000:  0000 0c07 ac00 5c26 0a17 22b6 0800 4500
......\&amp;..&quot;...E.
	0x0010:  0030 ed44 4000 8006 0519 967a 6828 cf29
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">.0.D at ......zh</A>(.)
	0x0020:  3a9e 12dc 0596 3ca6 e554 29de a04e 5018
:<i>.....&lt;..T)..NP.
</I>	0x0030:  ffff 0722 0000 414d 5150 0000 0901       ...&quot;..AMQP....
14:47:41.380038 IP sol1.1430 &gt; mywindows.4828: . ack 9 win 49640
	0x0000:  5c26 0a17 22b6 00d0 00fb 4bfc 0800 4500
\&amp;..&quot;.....K...E.
	0x0010:  0028 b226 4000 3906 873f cf29 3a9e 967a
.(.&amp;@.9..?.):..z
	0x0020:  6828 0596 12dc 29de a04e 3ca6 e55c 5010
h(....)..N&lt;..\P.
	0x0030:  c1e8 e0df 0000 0000 0000 0000            ............
14:47:41.380974 IP sol1.1430 &gt; mywindows.4828: P 1:9(8) ack 9 win 49640
	0x0000:  5c26 0a17 22b6 00d0 00fb 4bfc 0800 4500
\&amp;..&quot;.....K...E.
	0x0010:  0030 b227 4000 3906 8736 cf29 3a9e 967a
.0.'@.9..6.):..z
	0x0020:  6828 0596 12dc 29de a04e 3ca6 e55c 5018
h(....)..N&lt;..\P.
	0x0030:  c1e8 4531 0000 414d 5150 0000 0901       ..E1..AMQP....
14:47:41.382807 IP mywindows.4828 &gt; sol1.1430: F 9:9(0) ack 9 win 65527
	0x0000:  0000 0c07 ac00 5c26 0a17 22b6 0800 4500
......\&amp;..&quot;...E.
	0x0010:  0028 ed45 4000 8006 0520 967a 6828 cf29
.(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">.E at ......zh</A>(.)
	0x0020:  3a9e 12dc 0596 3ca6 e55c 29de a056 5011
:<i>.....&lt;..\)..VP.
</I>	0x0030:  fff7 a2c7 0000                           ......
14:47:41.384136 IP sol1.1430 &gt; mywindows.4828: . ack 10 win 49640
	0x0000:  5c26 0a17 22b6 00d0 00fb 4bfc 0800 4500
\&amp;..&quot;.....K...E.
	0x0010:  0028 b229 4000 3906 873c cf29 3a9e 967a
.(.)@.9..&lt;.):..z
	0x0020:  6828 0596 12dc 29de a056 3ca6 e55d 5010
h(....)..V&lt;..]P.
	0x0030:  c1e8 e0d6 0000 0000 0000 0000            ............

The problem is that the client is not accepting what it gets back. For
example, with the java client (runjava.bat
com.rabbitmq.examples.HelloServer sol1 1430) I get:
com.rabbitmq.client.ShutdownSignalException: connection error; reason:
com.rabbitmq.client.MalformedFrameException: AMQP protocol version
mismatch; we are version 0-9-1, server sent signature 0,0,9,1

What is wrong with this setup? Thanks ...

&quot;This e-mail and any attachments to it (the &quot;Communication&quot;) is, unless otherwise stated, confidential,  may contain copyright material and is for the use only of the intended recipient. If you receive the Communication in error, please notify the sender immediately by return e-mail, delete the Communication and the return e-mail, and do not read, copy, retransmit or otherwise deal with it. Any views expressed in the Communication are those of the individual sender only, unless expressly stated to be those of Australia and New Zealand Banking Group Limited ABN 11 005 357 522, or any of its related entities including ANZ Bank New Zealand Limited (together &quot;ANZ&quot;). ANZ does not accept liability in connection with the integrity of or errors in the Communication, computer virus, data corruption, interference or delay arising from or in respect of the Communication.&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121210/dfb161e4/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121210/dfb161e4/attachment.htm</A>&gt;
</PRE>






























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024406.html">[rabbitmq-discuss] Stomp topic perl
</A></li>
	<LI>Next message: <A HREF="024402.html">[rabbitmq-discuss] AMQP protocol header mismatch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24401">[ date ]</a>
              <a href="thread.html#24401">[ thread ]</a>
              <a href="subject.html#24401">[ subject ]</a>
              <a href="author.html#24401">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
