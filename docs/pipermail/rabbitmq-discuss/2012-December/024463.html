<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Producing an amqp message using python and consuming that same message using java
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Producing%20an%20amqp%20message%20using%20python%20and%0A%20consuming%20that%20same%20message%20using%20java&In-Reply-To=%3CCA%2Buk_pJWLVsGHmzg1dzd6UE9J0%3DCWYtsW6Sm-qqgM7gqku6w9Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024470.html">
   <LINK REL="Next"  HREF="024464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Producing an amqp message using python and consuming that same message using java</H1>
    <B>Julien Martin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Producing%20an%20amqp%20message%20using%20python%20and%0A%20consuming%20that%20same%20message%20using%20java&In-Reply-To=%3CCA%2Buk_pJWLVsGHmzg1dzd6UE9J0%3DCWYtsW6Sm-qqgM7gqku6w9Q%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Producing an amqp message using python and consuming that same message using java">balteo at gmail.com
       </A><BR>
    <I>Wed Dec 12 12:01:22 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024470.html">[rabbitmq-discuss] &quot;rabbitmqctl status&quot; hangs
</A></li>
        <LI>Next message: <A HREF="024464.html">[rabbitmq-discuss] Producing an amqp message using python and consuming that same message using java
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24463">[ date ]</a>
              <a href="thread.html#24463">[ thread ]</a>
              <a href="subject.html#24463">[ subject ]</a>
              <a href="author.html#24463">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

*I am trying to produce an amqp message from python and consume that same
message from java/spring.*

Here is my *producer* code (python):

import pika, sys, pickle

sys.path.append(&quot;trc/suivi/amqp&quot;)
from Person import Person

connection = pika.BlockingConnection()
channel = connection.channel()
me = Person(&quot;Juliano&quot;, 38)
pickled_me = pickle.dumps(me)
channel.basic_publish(exchange='',
                      routing_key=&quot;myqueue&quot;,
                      body=pickled_me,
                      properties=pika.BasicProperties(delivery_mode=1))

Here is my *consumer* code (java):

ApplicationContext context = new
GenericXmlApplicationContext(&quot;classpath:/applicationContext.xml&quot;);AmqpTemplate
template = context.getBean(AmqpTemplate.class);Person me = (Person)
template.receiveAndConvert(&quot;myqueue&quot;);System.out.println(&quot;Me: &quot; +
me.getName() + &quot;:&quot; + me.getAge());

Here is the java class for Person:

package trc.suivi.amqp;

import java.io.Serializable;
public class Person implements Serializable {
    private static final long serialVersionUID = 1L;
    private String name;
    private int age;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }
}

and the corresponding python class:

class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age

(located in *trc/suivi/amqp* directory structure)

I get a *class cast exception*. I am pretty sure this has to do either with
the package/module name or with some serialization issue...

Can anyone please help?

Regards,

Julien.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121212/f0e34d0a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121212/f0e34d0a/attachment.htm</A>&gt;
</PRE>






















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024470.html">[rabbitmq-discuss] &quot;rabbitmqctl status&quot; hangs
</A></li>
	<LI>Next message: <A HREF="024464.html">[rabbitmq-discuss] Producing an amqp message using python and consuming that same message using java
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24463">[ date ]</a>
              <a href="thread.html#24463">[ thread ]</a>
              <a href="subject.html#24463">[ subject ]</a>
              <a href="author.html#24463">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
