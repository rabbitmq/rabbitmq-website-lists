<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] custom plugin causing problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20plugin%20causing%20problems&In-Reply-To=%3CDA2FCBA8-0E3E-4785-8B1A-4851BA795C83%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024565.html">
   <LINK REL="Next"  HREF="024567.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] custom plugin causing problems</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20plugin%20causing%20problems&In-Reply-To=%3CDA2FCBA8-0E3E-4785-8B1A-4851BA795C83%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] custom plugin causing problems">tim at rabbitmq.com
       </A><BR>
    <I>Tue Dec 18 08:39:54 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024565.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
        <LI>Next message: <A HREF="024567.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24566">[ date ]</a>
              <a href="thread.html#24566">[ thread ]</a>
              <a href="subject.html#24566">[ subject ]</a>
              <a href="author.html#24566">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Did you restart your broker after running `rabbitmqctl disable &lt;plugin&gt;` at all? That's necessary, as the output of rabbitmq-plugins states.

Cheers,
Tim

On 18 Dec 2012, at 07:53, Prabodh Upreti wrote:

&gt;<i> Hello
</I>&gt;<i> 
</I>&gt;<i> I am not sure what is going on with my system.
</I>&gt;<i> 
</I>&gt;<i> I created a custom plugin for authentication which is working fine.  As part
</I>&gt;<i> of that setup, I had to delete the guest user to make it secure.  
</I>&gt;<i> 
</I>&gt;<i> Now I need to use the rabbitmqadmin command to create an exchange because
</I>&gt;<i> the original one was not created as durable=true, hence I disabled my plugin
</I>&gt;<i> and enabled rabbitmq_management.  When I execute 
</I>&gt;<i> 
</I>&gt;<i> rabbitmqadmin -f long -d 3 list queues
</I>&gt;<i> 
</I>&gt;<i> I see
</I>&gt;<i> 
</I>&gt;<i> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">root at fm11deploy02</A> rabbitmq]# rabbitmqadmin -f long -d 3 list queues
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i>  File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 828, in &lt;module&gt;
</I>&gt;<i>    main()
</I>&gt;<i>  File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 325, in main
</I>&gt;<i>    method()
</I>&gt;<i>  File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 456, in invoke_list
</I>&gt;<i>    format_list(self.get(uri), cols, self.options)
</I>&gt;<i>  File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 348, in get
</I>&gt;<i>    return self.http(&quot;GET&quot;, path, &quot;&quot;)
</I>&gt;<i>  File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 377, in http
</I>&gt;<i>    resp = conn.getresponse()
</I>&gt;<i>  File &quot;/usr/lib64/python2.6/httplib.py&quot;, line 990, in getresponse
</I>&gt;<i>    response.begin()
</I>&gt;<i>  File &quot;/usr/lib64/python2.6/httplib.py&quot;, line 391, in begin
</I>&gt;<i>    version, status, reason = self._read_status()
</I>&gt;<i>  File &quot;/usr/lib64/python2.6/httplib.py&quot;, line 355, in _read_status
</I>&gt;<i>    raise BadStatusLine(line)
</I>&gt;<i> httplib.BadStatusLine
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> In the log file I see
</I>&gt;<i> 
</I>&gt;<i> ASH REPORT==== 18-Dec-2012::08:36:03 ===
</I>&gt;<i>  crasher:
</I>&gt;<i>    initial call: mochiweb_acceptor:init/3
</I>&gt;<i>    pid: &lt;0.3908.0&gt;
</I>&gt;<i>    registered_name: []
</I>&gt;<i>    exception error: undefined function
</I>&gt;<i> rabbitmq_cas_authen:check_user_login/2
</I>&gt;<i>      in function  rabbit_access_control:'-check_user_login/2-fun-0-'/4
</I>&gt;<i>      in call from lists:foldl/3 (lists.erl, line 1197)
</I>&gt;<i>      in call from rabbit_mgmt_app:'-make_loop/0-fun-0-'/4
</I>&gt;<i>      in call from mochiweb_http:headers/5
</I>&gt;<i>    ancestors: [rabbit_mochiweb_web_mgmt,rabbit_mochiweb_sup,&lt;0.127.0&gt;]
</I>&gt;<i>    messages: []
</I>&gt;<i>    links: [&lt;0.228.0&gt;,#Port&lt;0.12917&gt;]
</I>&gt;<i>    dictionary: []
</I>&gt;<i>    trap_exit: false
</I>&gt;<i>    status: running
</I>&gt;<i>    heap_size: 4181
</I>&gt;<i>    stack_size: 24
</I>&gt;<i>    reductions: 3638
</I>&gt;<i>  neighbours:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> looks like the management plugin is trying to use my custom plugin
</I>&gt;<i> rabbitmq_cas_plugin even though I have disabled it.
</I>&gt;<i> 
</I>&gt;<i> part of my custom plugin setup I had something like this in rabbitmq.config
</I>&gt;<i> which I took out for management plugin:
</I>&gt;<i> 
</I>&gt;<i>        {rabbit,
</I>&gt;<i>                [{auth_backends, [rabbitmq_cas_authen,
</I>&gt;<i> rabbit_auth_backend_inter
</I>&gt;<i> nal]},
</I>&gt;<i>                 {vm_memory_high_watermark, 0.1}
</I>&gt;<i>                ]
</I>&gt;<i>        },
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I would appreciate any insight. thank you.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/custom-plugin-causing-problems-tp24091.html">http://rabbitmq.1065348.n5.nabble.com/custom-plugin-causing-problems-tp24091.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>







































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024565.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
	<LI>Next message: <A HREF="024567.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24566">[ date ]</a>
              <a href="thread.html#24566">[ thread ]</a>
              <a href="subject.html#24566">[ subject ]</a>
              <a href="author.html#24566">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
