<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Federation and upstream cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20and%20upstream%20cluster&In-Reply-To=%3CCAE8ERywXEgUoSyn7a2f5rj9eOwLzr5RWz2vYFY%2BNV05af8SHXA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024690.html">
   <LINK REL="Next"  HREF="024693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Federation and upstream cluster</H1>
    <B>Vladislav Pernin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20and%20upstream%20cluster&In-Reply-To=%3CCAE8ERywXEgUoSyn7a2f5rj9eOwLzr5RWz2vYFY%2BNV05af8SHXA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Federation and upstream cluster">vladislav.pernin at gmail.com
       </A><BR>
    <I>Fri Dec 28 11:09:03 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024690.html">[rabbitmq-discuss] Federation and upstream cluster
</A></li>
        <LI>Next message: <A HREF="024693.html">[rabbitmq-discuss] Federation and upstream cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24691">[ date ]</a>
              <a href="thread.html#24691">[ thread ]</a>
              <a href="subject.html#24691">[ subject ]</a>
              <a href="author.html#24691">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tim,

Yes it is a durable exchange.

Vlad

2012/12/28 Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt;

&gt;<i> Vladislav,
</I>&gt;<i>
</I>&gt;<i> Is the upstream exchange you're federating durable? If not, it's going to
</I>&gt;<i> be deleted when you shut the broker down, which would explain the NOT_FOUND
</I>&gt;<i> error.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Tim
</I>&gt;<i>
</I>&gt;<i> On 28 Dec 2012, at 09:32, Vladislav Pernin wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm running RabbitMQ 3.0.1 on two cluster of Linux servers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Let's name the two clusters :
</I>&gt;<i> &gt; - downstream cluster running a federation to get messages from upstream
</I>&gt;<i> &gt; cluster
</I>&gt;<i> &gt; - upstream cluster
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The documentation explains well if a node fails, links to upstream
</I>&gt;<i> &gt; exchanges will be recreated on a surviving node.
</I>&gt;<i> &gt; There is no problem for the &quot;client&quot; side of the federation.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I cannot use a load balancer if fail over mode to have high avaibility
</I>&gt;<i> &gt; of the upstream cluster.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What would be the recommended solution in this case ?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm struggling to understand what the question is here Vladislav. The
</I>&gt;<i> 'failover' that is being described in the federation plugin documentation
</I>&gt;<i> is applied when using federation in a cluster, so if the node on which the
</I>&gt;<i> downstream link is running dies, then another downstream node will take
</I>&gt;<i> over (i.e., re-establish the links). There is a choice between clustering
</I>&gt;<i> (i.e., ha/mirror queues) and federation - you do not get 'ha of the
</I>&gt;<i> upstream cluster' in the same sense that mirror queues in a cluster are
</I>&gt;<i> 'ha'. You have federated exchanges which copy data using AMQP (with ACKs
</I>&gt;<i> enabled and some other guarantees) and the ability to try and re-establish
</I>&gt;<i> links and so. Federation however, provides only the Availability and
</I>&gt;<i> Partition tolerance parts of the CAP theorem, not the same Consistency
</I>&gt;<i> guarantees as clustering/ha.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I did get that, no problem for the downstream side who hold the
</I>&gt;<i> federation, it works well.
</I>&gt;<i> &gt; Question is really : I have two nodes in the &quot;remote&quot; or upstream
</I>&gt;<i> cluster, I want to get messages of one exchange in a reliable way and the
</I>&gt;<i> network stream has to be establish by the downstream cluster ; how can I be
</I>&gt;<i> tolerant to failure of one remote node ? That is what I have called high
</I>&gt;<i> avaibility on the upstream cluster, but only regarding the transmission of
</I>&gt;<i> the exchange messages to the downstream cluster.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have tried to set up two upstream and group them in a upstream set,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Can you post the configuration you're using to do that?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The configuration has been done using the HTTP API.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; curl -i -w %{http_code} -k -u &quot;XXX:XXXX&quot; -XPUT -H
</I>&gt;<i> &quot;content-type:application/json&quot; -d '{
</I>&gt;<i> &gt;
</I>&gt;<i> &quot;pattern&quot;:&quot;downstream-exchange&quot;,&quot;definition&quot;:{&quot;federation-upstream-set&quot;:&quot;upstreamset-test&quot;}
</I>&gt;<i> &gt; }' <A HREF="https://localhost:15671/api/policies/%2f/federate-me">https://localhost:15671/api/policies/%2f/federate-me</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; curl -i -w %{http_code} -k -u &quot;XXX:XXXX&quot; -XPUT -H
</I>&gt;<i> &quot;content-type:application/json&quot; -d '{
</I>&gt;<i> &gt; &quot;name&quot;:&quot;local-nodename&quot;,&quot;value&quot;:&quot;federation-local&quot;
</I>&gt;<i> &gt; }' <A HREF="https://localhost:15671/api/parameters/federation/%2f/local-nodename">https://localhost:15671/api/parameters/federation/%2f/local-nodename</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; curl -i -w %{http_code} -u &quot;XXX:XXXX&quot; -k -s -XPUT -H
</I>&gt;<i> &quot;content-type:application/json&quot; -d &quot;{
</I>&gt;<i> &gt;         &quot;value&quot;:{
</I>&gt;<i> &gt;             &quot;uri&quot;:\&quot;<A HREF="amqps://XXX:XXX@remote-server1">amqps://XXX:XXX@remote-server1</A>
</I>&gt;<i> ?certfile=XXXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false&quot;
</I>&gt;<i> &gt;         }
</I>&gt;<i> &gt;     }&quot;
</I>&gt;<i> <A HREF="https://localhost:15671/api/parameters/federation-upstream/%2f/upstream1">https://localhost:15671/api/parameters/federation-upstream/%2f/upstream1</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; curl -i -w %{http_code} -u &quot;XXX:XXXX&quot; -k -s -XPUT -H
</I>&gt;<i> &quot;content-type:application/json&quot; -d &quot;{
</I>&gt;<i> &gt;         &quot;value&quot;:{
</I>&gt;<i> &gt;             &quot;uri&quot;:\&quot;<A HREF="amqps://XXX:XXX@remote-server2">amqps://XXX:XXX@remote-server2</A>
</I>&gt;<i> ?certfile=XXXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false&quot;
</I>&gt;<i> &gt;         }
</I>&gt;<i> &gt;     }&quot;
</I>&gt;<i> <A HREF="https://localhost:15671/api/parameters/federation-upstream/%2f/upstream2">https://localhost:15671/api/parameters/federation-upstream/%2f/upstream2</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; curl -i -w %{http_code} -k -u &quot;XXX:XXXX&quot; -XPUT -H
</I>&gt;<i> &quot;content-type:application/json&quot; -d '{
</I>&gt;<i> &gt;
</I>&gt;<i> &quot;value&quot;:[{&quot;upstream&quot;:&quot;upstream1&quot;,&quot;exchange&quot;:&quot;upstream-exchange&quot;},{&quot;upstream&quot;:&quot;upstream2&quot;,&quot;exchange&quot;:&quot;upstream-exchange&quot;}]
</I>&gt;<i> &gt; }'
</I>&gt;<i> <A HREF="https://localhost:15671/api/parameters/federation-upstream-set/%2f/upstreamset-test">https://localhost:15671/api/parameters/federation-upstream-set/%2f/upstreamset-test</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; but I have the following problem :
</I>&gt;<i> &gt; - when I shut down one the node, the federation status shows the
</I>&gt;<i> &gt; matching upstream down as expected but after having restarted the first
</I>&gt;<i> &gt; one, if I shut down the other one, both the federation status shows both
</I>&gt;<i> &gt; upstream down
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Just to confirm: you're saying that
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1. you shut down one of the two upstream nodes
</I>&gt;<i> &gt; 2. that node shows up dead in the web interface
</I>&gt;<i> &gt; 3. you re-start that node
</I>&gt;<i> &gt; 4. that node shows up alive in the web interface
</I>&gt;<i> &gt; 5. you shut down the other upstream node
</I>&gt;<i> &gt; 6. both nodes show up as dead in the web interface *but*
</I>&gt;<i> &gt; 7. one of the upstream nodes *is* alive despite what the web admin says
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Have I understood that correctly?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Absolutely, you can find an extract of the downstream node log
</I>&gt;<i> (<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at XXXX.log</A>) at the end of the mail.
</I>&gt;<i> &gt; That is not that easy to read but I think there might be an explanation
</I>&gt;<i> in the logs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Case 2 :
</I>&gt;<i> &gt; web admin says :
</I>&gt;<i> &gt; - upstream1 : running
</I>&gt;<i> &gt; - upstream 2 : error (econnrefused)
</I>&gt;<i> &gt; Everything is OK
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Case 6 :
</I>&gt;<i> &gt; web admin says :
</I>&gt;<i> &gt; - upstream1 : error (econnrefused)
</I>&gt;<i> &gt; - upstream 2 : shutdown (server_initiated_code,404,&lt;&lt;&quot;NOT_FOUND ...
</I>&gt;<i> &gt; the upstream1 (remote-server1) has been shutdown, but not the upstream2
</I>&gt;<i> (remote-server2).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - so, I tried to add a ha-mode policy to all on the federated queue, it
</I>&gt;<i> &gt; is now possible to shutdown either one or the other node,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm not sure I understand this at all. Are you saying it was not
</I>&gt;<i> possible to shut down one or both of the upstream nodes before? That seems
</I>&gt;<i> different from your earlier comment.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; My bad ! It is not explained properly. When I was saying &quot;not possible
</I>&gt;<i> to shutdown&quot;, I meant shutting down the remote node and having the proper
</I>&gt;<i> status in the federation.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; but it seems that I'm losing some messages.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; When you say 'the federated queue' do you mean the queue created in the
</I>&gt;<i> upstream exchange's broker? Why would you want to add ha-mode policy that?
</I>&gt;<i> The upstream queue is internal to the federation mechanism so you should be
</I>&gt;<i> binding to the downstream exchange only. Or are you saying that you've
</I>&gt;<i> bound a queue to the downstream exchange and made that ha-enabled? Because
</I>&gt;<i> in the latter case, that will make no difference to reliability: if both
</I>&gt;<i> upstream nodes go down before messages are delivered and ack'ed by the
</I>&gt;<i> downstream for example.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yes, &quot;federated queue&quot; is the queue created in the upstream exchange's
</I>&gt;<i> broker. So, yes, it does not really make sense to add a ha policy, that was
</I>&gt;<i> just an attempt in order to investigate a little bit further.
</I>&gt;<i> &gt; And yes I did bound a ha queue to the downstream exchange, but I agree,
</I>&gt;<i> it has nothing to do with the subject.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'd be interested to hear how you've set this ha-mode policy and why and
</I>&gt;<i> also how you've determined that there was message loss? I suspect that you
</I>&gt;<i> have assumed expectations about the reliability of federation (in the face
</I>&gt;<i> of node failures) that do not hold. If your messages sat in an exchange on
</I>&gt;<i> an upstream node (or pair of exchanges/nodes, etc) and both nodes die
</I>&gt;<i> before successfully transmitting the messages, then they will not arrive at
</I>&gt;<i> the downstream exchange. The guarantees about message delivery for
</I>&gt;<i> ha/mirror queues apply to nodes in *that* cluster only. The federation
</I>&gt;<i> guarantees are different and orthogonal to ha/clustering.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I understand, I just want to make sure that the messages will arrive at
</I>&gt;<i> the downstream exchange, not duplicated and without loss :
</I>&gt;<i> &gt; - if one upstream node dies
</I>&gt;<i> &gt; - if there is network failure between downstream and upstream nodes
</I>&gt;<i> &gt; - if upstream nodes fail and come back again
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks.
</I>&gt;<i> &gt; Vlad
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Extract of logs for case 2 :
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt; Connection (&lt;0.14803.351&gt;) closing: received hard error
</I>&gt;<i> {'connection.close',
</I>&gt;<i> &gt;                                                          320,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;CONNECTION_FORCED - broker forced connection closure with reason
</I>&gt;<i> 'shutdown'&quot;&gt;&gt;,
</I>&gt;<i> &gt;                                                          0,0} from server
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =ERROR REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt; ** Generic server &lt;0.14803.351&gt; terminating
</I>&gt;<i> &gt; ** Last message in was {#Ref&lt;0.0.127.4786&gt;,{error,closed}}
</I>&gt;<i> &gt; ** When Server state == {state,amqp_network_connection,
</I>&gt;<i> &gt;                             {state,
</I>&gt;<i> &gt;                                 {ssl_socket,#Port&lt;0.46383&gt;,
</I>&gt;<i> &gt;                                     {sslsocket,new_ssl,&lt;0.14806.351&gt;}},
</I>&gt;<i> &gt;                                 600,&lt;0.14808.351&gt;,131072,
</I>&gt;<i> &gt;                                 {server_initiated_close,320,
</I>&gt;<i> &gt;                                     &lt;&lt;&quot;CONNECTION_FORCED - broker forced
</I>&gt;<i> connection closure with reason 'shutdown'&quot;&gt;&gt;},
</I>&gt;<i> &gt;                                 false},
</I>&gt;<i> &gt;                             &lt;0.14802.351&gt;,&lt;0.14805.351&gt;,
</I>&gt;<i> &gt;                             {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i> &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server2&quot;,5671,0,
</I>&gt;<i> &gt;                                 0,0,infinity,
</I>&gt;<i> &gt;                                 [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                                  {verify,verify_none},
</I>&gt;<i> &gt;                                  {keyfile,
</I>&gt;<i> &gt;                                      &quot;XXXX&quot;},
</I>&gt;<i> &gt;                                  {certfile,
</I>&gt;<i> &gt;                                      &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                                 [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                                  #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                                 [],[]},
</I>&gt;<i> &gt;                             0,
</I>&gt;<i> &gt;                             [{&lt;&lt;&quot;capabilities&quot;&gt;&gt;,table,
</I>&gt;<i> &gt;                               [{&lt;&lt;&quot;publisher_confirms&quot;&gt;&gt;,bool,true},
</I>&gt;<i> &gt;
</I>&gt;<i>  {&lt;&lt;&quot;exchange_exchange_bindings&quot;&gt;&gt;,bool,true},
</I>&gt;<i> &gt;                                {&lt;&lt;&quot;basic.nack&quot;&gt;&gt;,bool,true},
</I>&gt;<i> &gt;
</I>&gt;<i>  {&lt;&lt;&quot;consumer_cancel_notify&quot;&gt;&gt;,bool,true}]},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;copyright&quot;&gt;&gt;,longstr,
</I>&gt;<i> &gt;                               &lt;&lt;&quot;Copyright (C) 2007-2012 VMware,
</I>&gt;<i> Inc.&quot;&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;information&quot;&gt;&gt;,longstr,
</I>&gt;<i> &gt;                               &lt;&lt;&quot;Licensed under the MPL.  See
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/&quot;">http://www.rabbitmq.com/&quot;</A>&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;platform&quot;&gt;&gt;,longstr,&lt;&lt;&quot;Erlang/OTP&quot;&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;product&quot;&gt;&gt;,longstr,&lt;&lt;&quot;RabbitMQ&quot;&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;version&quot;&gt;&gt;,longstr,&lt;&lt;&quot;3.0.1&quot;&gt;&gt;}],
</I>&gt;<i> &gt;                             #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i> &gt;                             #Fun&lt;amqp_connection_sup.2.54430129&gt;,
</I>&gt;<i> &gt;                             {closing,server_initiated_close,
</I>&gt;<i> &gt;                                 {'connection.close',320,
</I>&gt;<i> &gt;                                     &lt;&lt;&quot;CONNECTION_FORCED - broker forced
</I>&gt;<i> connection closure with reason 'shutdown'&quot;&gt;&gt;,
</I>&gt;<i> &gt;                                     0,0},
</I>&gt;<i> &gt;                                 none}}
</I>&gt;<i> &gt; ** Reason for termination ==
</I>&gt;<i> &gt; ** socket_closed_unexpectedly
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =INFO REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' disconnected from
</I>&gt;<i> exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server2">amqps://XXXX:XXXX@remote-server2</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {upstream_channel_down,
</I>&gt;<i> &gt;     {connection_closing,
</I>&gt;<i> &gt;         {server_initiated_close,320,
</I>&gt;<i> &gt;             &lt;&lt;&quot;CONNECTION_FORCED - broker forced connection closure with
</I>&gt;<i> reason 'shutdown'&quot;&gt;&gt;}}}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' did not connect
</I>&gt;<i> to exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server2">amqps://XXXX:XXXX@remote-server2</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {error,econnrefused}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ==&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at XXXX-sasl.log</A> &lt;==
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =CRASH REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt;   crasher:
</I>&gt;<i> &gt;     initial call: amqp_gen_connection:init/1
</I>&gt;<i> &gt;     pid: &lt;0.14803.351&gt;
</I>&gt;<i> &gt;     registered_name: []
</I>&gt;<i> &gt;     exception exit: socket_closed_unexpectedly
</I>&gt;<i> &gt;       in function  gen_server:terminate/6 (gen_server.erl, line 747)
</I>&gt;<i> &gt;     ancestors: [&lt;0.14802.351&gt;,amqp_sup,&lt;0.49.0&gt;]
</I>&gt;<i> &gt;     messages: []
</I>&gt;<i> &gt;     links: [&lt;0.14802.351&gt;]
</I>&gt;<i> &gt;     dictionary: []
</I>&gt;<i> &gt;     trap_exit: true
</I>&gt;<i> &gt;     status: running
</I>&gt;<i> &gt;     heap_size: 2584
</I>&gt;<i> &gt;     stack_size: 24
</I>&gt;<i> &gt;     reductions: 1786
</I>&gt;<i> &gt;   neighbours:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =SUPERVISOR REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt;      Supervisor: {&lt;0.14802.351&gt;,amqp_connection_sup}
</I>&gt;<i> &gt;      Context:    child_terminated
</I>&gt;<i> &gt;      Reason:     socket_closed_unexpectedly
</I>&gt;<i> &gt;      Offender:   [{pid,&lt;0.14803.351&gt;},
</I>&gt;<i> &gt;                   {name,connection},
</I>&gt;<i> &gt;                   {mfa,
</I>&gt;<i> &gt;                       {amqp_gen_connection,start_link,
</I>&gt;<i> &gt;                           [amqp_network_connection,
</I>&gt;<i> &gt;                            {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server2&quot;,5671,0,0,
</I>&gt;<i> &gt;                                0,infinity,
</I>&gt;<i> &gt;                                [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                                 {verify,verify_none},
</I>&gt;<i> &gt;                                 {keyfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;},
</I>&gt;<i> &gt;                                 {certfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                                [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                                 #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                                [],[]},
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.2.54430129&gt;,[]]}},
</I>&gt;<i> &gt;                   {restart_type,intrinsic},
</I>&gt;<i> &gt;                   {shutdown,brutal_kill},
</I>&gt;<i> &gt;                   {child_type,worker}]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =SUPERVISOR REPORT==== 28-Dec-2012::10:27:08 ===
</I>&gt;<i> &gt;      Supervisor: {&lt;0.14802.351&gt;,amqp_connection_sup}
</I>&gt;<i> &gt;      Context:    shutdown
</I>&gt;<i> &gt;      Reason:     reached_max_restart_intensity
</I>&gt;<i> &gt;      Offender:   [{pid,&lt;0.14803.351&gt;},
</I>&gt;<i> &gt;                   {name,connection},
</I>&gt;<i> &gt;                   {mfa,
</I>&gt;<i> &gt;                       {amqp_gen_connection,start_link,
</I>&gt;<i> &gt;                           [amqp_network_connection,
</I>&gt;<i> &gt;                            {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server2&quot;,5671,0,0,
</I>&gt;<i> &gt;                                0,infinity,
</I>&gt;<i> &gt;                                [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                                 {verify,verify_none},
</I>&gt;<i> &gt;                                 {keyfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;},
</I>&gt;<i> &gt;                                 {certfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                                [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                                 #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                                [],[]},
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.2.54430129&gt;,[]]}},
</I>&gt;<i> &gt;                   {restart_type,intrinsic},
</I>&gt;<i> &gt;                   {shutdown,brutal_kill},
</I>&gt;<i> &gt;                   {child_type,worker}]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ==&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at XXXX.log</A> &lt;==
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:27:10 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' did not connect
</I>&gt;<i> to exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server2">amqps://XXXX:XXXX@remote-server2</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {error,econnrefused}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Extract of logs for case 6 :
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt; Connection (&lt;0.32151.341&gt;) closing: received hard error
</I>&gt;<i> {'connection.close',
</I>&gt;<i> &gt;                                                          320,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;CONNECTION_FORCED - broker forced connection closure with reason
</I>&gt;<i> 'shutdown'&quot;&gt;&gt;,
</I>&gt;<i> &gt;                                                          0,0} from server
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =ERROR REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt; ** Generic server &lt;0.32151.341&gt; terminating
</I>&gt;<i> &gt; ** Last message in was {#Ref&lt;0.0.123.217100&gt;,{error,closed}}
</I>&gt;<i> &gt; ** When Server state == {state,amqp_network_connection,
</I>&gt;<i> &gt;                             {state,
</I>&gt;<i> &gt;                                 {ssl_socket,#Port&lt;0.45661&gt;,
</I>&gt;<i> &gt;                                     {sslsocket,new_ssl,&lt;0.32161.341&gt;}},
</I>&gt;<i> &gt;                                 600,&lt;0.32170.341&gt;,131072,
</I>&gt;<i> &gt;                                 {server_initiated_close,320,
</I>&gt;<i> &gt;                                     &lt;&lt;&quot;CONNECTION_FORCED - broker forced
</I>&gt;<i> connection closure with reason 'shutdown'&quot;&gt;&gt;},
</I>&gt;<i> &gt;                                 false},
</I>&gt;<i> &gt;                             &lt;0.32149.341&gt;,&lt;0.32154.341&gt;,
</I>&gt;<i> &gt;                             {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i> &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server1&quot;,5671,0,
</I>&gt;<i> &gt;                                 0,0,infinity,
</I>&gt;<i> &gt;                                 [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                                  {verify,verify_none},
</I>&gt;<i> &gt;                                  {keyfile,
</I>&gt;<i> &gt;                                      &quot;XXXX&quot;},
</I>&gt;<i> &gt;                                  {certfile,
</I>&gt;<i> &gt;                                      &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                                 [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                                  #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                                 [],[]},
</I>&gt;<i> &gt;                             0,
</I>&gt;<i> &gt;                             [{&lt;&lt;&quot;capabilities&quot;&gt;&gt;,table,
</I>&gt;<i> &gt;                               [{&lt;&lt;&quot;publisher_confirms&quot;&gt;&gt;,bool,true},
</I>&gt;<i> &gt;
</I>&gt;<i>  {&lt;&lt;&quot;exchange_exchange_bindings&quot;&gt;&gt;,bool,true},
</I>&gt;<i> &gt;                                {&lt;&lt;&quot;basic.nack&quot;&gt;&gt;,bool,true},
</I>&gt;<i> &gt;
</I>&gt;<i>  {&lt;&lt;&quot;consumer_cancel_notify&quot;&gt;&gt;,bool,true}]},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;copyright&quot;&gt;&gt;,longstr,
</I>&gt;<i> &gt;                               &lt;&lt;&quot;Copyright (C) 2007-2012 VMware,
</I>&gt;<i> Inc.&quot;&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;information&quot;&gt;&gt;,longstr,
</I>&gt;<i> &gt;                               &lt;&lt;&quot;Licensed under the MPL.  See
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/&quot;">http://www.rabbitmq.com/&quot;</A>&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;platform&quot;&gt;&gt;,longstr,&lt;&lt;&quot;Erlang/OTP&quot;&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;product&quot;&gt;&gt;,longstr,&lt;&lt;&quot;RabbitMQ&quot;&gt;&gt;},
</I>&gt;<i> &gt;                              {&lt;&lt;&quot;version&quot;&gt;&gt;,longstr,&lt;&lt;&quot;3.0.1&quot;&gt;&gt;}],
</I>&gt;<i> &gt;                             #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i> &gt;                             #Fun&lt;amqp_connection_sup.2.54430129&gt;,
</I>&gt;<i> &gt;                             {closing,server_initiated_close,
</I>&gt;<i> &gt;                                 {'connection.close',320,
</I>&gt;<i> &gt;                                     &lt;&lt;&quot;CONNECTION_FORCED - broker forced
</I>&gt;<i> connection closure with reason 'shutdown'&quot;&gt;&gt;,
</I>&gt;<i> &gt;                                     0,0},
</I>&gt;<i> &gt;                                 none}}
</I>&gt;<i> &gt; ** Reason for termination ==
</I>&gt;<i> &gt; ** socket_closed_unexpectedly
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =ERROR REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt; ** Generic server &lt;0.32126.341&gt; terminating
</I>&gt;<i> &gt; ** Last message in was
</I>&gt;<i> {'DOWN',#Ref&lt;0.0.123.217187&gt;,process,&lt;0.32193.341&gt;,
</I>&gt;<i> &gt;                                shutdown}
</I>&gt;<i> &gt; ** When Server state == {state,
</I>&gt;<i> &gt;                          {upstream,
</I>&gt;<i> &gt;                           {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server1&quot;,undefined,0,
</I>&gt;<i> &gt;                            0,0,infinity,
</I>&gt;<i> &gt;                            [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                             {verify,verify_none},
</I>&gt;<i> &gt;                             {keyfile,
</I>&gt;<i> &gt;                              &quot;XXXX&quot;},
</I>&gt;<i> &gt;                             {certfile,
</I>&gt;<i> &gt;                              &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                            [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                             #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                            [],[]},
</I>&gt;<i> &gt;                           &lt;&lt;&quot;<A HREF="amqps://XXXX:XXXX@remote-server1">amqps://XXXX:XXXX@remote-server1</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false&quot;&gt;&gt;,
</I>&gt;<i> &gt;                           {exchange,
</I>&gt;<i> &gt;
</I>&gt;<i>  {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;upstream-exchange&quot;&gt;&gt;},
</I>&gt;<i> &gt;                            direct,true,false,false,[],undefined,
</I>&gt;<i> &gt;                            [{vhost,&lt;&lt;&quot;/&quot;&gt;&gt;},
</I>&gt;<i> &gt;                             {name,&lt;&lt;&quot;federate-me&quot;&gt;&gt;},
</I>&gt;<i> &gt;                             {pattern,&lt;&lt;&quot;downstream-exchange&quot;&gt;&gt;},
</I>&gt;<i> &gt;                             {definition,
</I>&gt;<i> &gt;                              [{&lt;&lt;&quot;federation-upstream-set&quot;&gt;&gt;,
</I>&gt;<i> &gt;                                &lt;&lt;&quot;upstreamset-test&quot;&gt;&gt;}]},
</I>&gt;<i> &gt;                             {priority,0}]},
</I>&gt;<i> &gt;                           1000,1,1,none,none,false,none,&lt;&lt;&quot;upstream1&quot;&gt;&gt;},
</I>&gt;<i> &gt;                          &lt;0.32151.341&gt;,&lt;0.32193.341&gt;,
</I>&gt;<i> &gt;                          &lt;&lt;&quot;amq.ctag-iCWCgBnLBU7S3cWTi06V1A&quot;&gt;&gt;,
</I>&gt;<i> &gt;                          &lt;&lt;&quot;federation: upstream-exchange -&gt;
</I>&gt;<i> federation-local:downstream-exchange&quot;&gt;&gt;,
</I>&gt;<i> &gt;                          &lt;&lt;&quot;federation: upstream-exchange -&gt;
</I>&gt;<i> federation-local:downstream-exchange B&quot;&gt;&gt;,
</I>&gt;<i> &gt;                          {0,nil},
</I>&gt;<i> &gt;                          1,
</I>&gt;<i> &gt;                          {dict,1,16,16,8,80,48,
</I>&gt;<i> &gt;
</I>&gt;<i> {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
</I>&gt;<i> &gt;                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i> &gt;                             [[{&lt;&lt;&quot;test&quot;&gt;&gt;,[]}|
</I>&gt;<i> &gt;                               {set,1,16,16,8,80,48,
</I>&gt;<i> &gt;
</I>&gt;<i>  {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i> &gt;                                 []},
</I>&gt;<i> &gt;                                {{[],[],[],[],
</I>&gt;<i> &gt;                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
</I>&gt;<i> &gt;                                    &lt;&lt;&quot;downstream-queue&quot;&gt;&gt;}],
</I>&gt;<i> &gt;
</I>&gt;<i>  [],[],[],[],[],[],[],[],[],[],[]}}}]]}}},
</I>&gt;<i> &gt;                          &lt;0.32129.341&gt;,&lt;0.32141.341&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i>  {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;downstream-exchange&quot;&gt;&gt;},
</I>&gt;<i> &gt;                          {0,nil}}
</I>&gt;<i> &gt; ** Reason for termination ==
</I>&gt;<i> &gt; ** {upstream_channel_down,shutdown}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =INFO REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' received
</I>&gt;<i> 'basic.cancel'
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' did not connect
</I>&gt;<i> to exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server1">amqps://XXXX:XXXX@remote-server1</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {error,econnrefused}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ==&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at XXXX-sasl.log</A> &lt;==
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =CRASH REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt;   crasher:
</I>&gt;<i> &gt;     initial call: amqp_gen_connection:init/1
</I>&gt;<i> &gt;     pid: &lt;0.32151.341&gt;
</I>&gt;<i> &gt;     registered_name: []
</I>&gt;<i> &gt;     exception exit: socket_closed_unexpectedly
</I>&gt;<i> &gt;       in function  gen_server:terminate/6 (gen_server.erl, line 747)
</I>&gt;<i> &gt;     ancestors: [&lt;0.32149.341&gt;,amqp_sup,&lt;0.49.0&gt;]
</I>&gt;<i> &gt;     messages: [socket_closed]
</I>&gt;<i> &gt;     links: [&lt;0.32149.341&gt;]
</I>&gt;<i> &gt;     dictionary: []
</I>&gt;<i> &gt;     trap_exit: true
</I>&gt;<i> &gt;     status: running
</I>&gt;<i> &gt;     heap_size: 2584
</I>&gt;<i> &gt;     stack_size: 24
</I>&gt;<i> &gt;     reductions: 1794
</I>&gt;<i> &gt;   neighbours:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =SUPERVISOR REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt;      Supervisor: {&lt;0.32149.341&gt;,amqp_connection_sup}
</I>&gt;<i> &gt;      Context:    child_terminated
</I>&gt;<i> &gt;      Reason:     socket_closed_unexpectedly
</I>&gt;<i> &gt;      Offender:   [{pid,&lt;0.32151.341&gt;},
</I>&gt;<i> &gt;                   {name,connection},
</I>&gt;<i> &gt;                   {mfa,
</I>&gt;<i> &gt;                       {amqp_gen_connection,start_link,
</I>&gt;<i> &gt;                           [amqp_network_connection,
</I>&gt;<i> &gt;                            {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server1&quot;,5671,0,0,
</I>&gt;<i> &gt;                                0,infinity,
</I>&gt;<i> &gt;                                [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                                 {verify,verify_none},
</I>&gt;<i> &gt;                                 {keyfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;},
</I>&gt;<i> &gt;                                 {certfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                                [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                                 #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                                [],[]},
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.2.54430129&gt;,[]]}},
</I>&gt;<i> &gt;                   {restart_type,intrinsic},
</I>&gt;<i> &gt;                   {shutdown,brutal_kill},
</I>&gt;<i> &gt;                   {child_type,worker}]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =SUPERVISOR REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt;      Supervisor: {&lt;0.32149.341&gt;,amqp_connection_sup}
</I>&gt;<i> &gt;      Context:    shutdown
</I>&gt;<i> &gt;      Reason:     reached_max_restart_intensity
</I>&gt;<i> &gt;      Offender:   [{pid,&lt;0.32151.341&gt;},
</I>&gt;<i> &gt;                   {name,connection},
</I>&gt;<i> &gt;                   {mfa,
</I>&gt;<i> &gt;                       {amqp_gen_connection,start_link,
</I>&gt;<i> &gt;                           [amqp_network_connection,
</I>&gt;<i> &gt;                            {amqp_params_network,&lt;&lt;&quot;XXXX&quot;&gt;&gt;,
</I>&gt;<i> &gt;
</I>&gt;<i>  &lt;&lt;&quot;XXXX&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,&quot;remote-server1&quot;,5671,0,0,
</I>&gt;<i> &gt;                                0,infinity,
</I>&gt;<i> &gt;                                [{fail_if_no_peer_cert,false},
</I>&gt;<i> &gt;                                 {verify,verify_none},
</I>&gt;<i> &gt;                                 {keyfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;},
</I>&gt;<i> &gt;                                 {certfile,
</I>&gt;<i> &gt;                                     &quot;XXXX&quot;}],
</I>&gt;<i> &gt;                                [#Fun&lt;amqp_uri.7.123484526&gt;,
</I>&gt;<i> &gt;                                 #Fun&lt;amqp_uri.7.123484526&gt;],
</I>&gt;<i> &gt;                                [],[]},
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i> &gt;                            #Fun&lt;amqp_connection_sup.2.54430129&gt;,[]]}},
</I>&gt;<i> &gt;                   {restart_type,intrinsic},
</I>&gt;<i> &gt;                   {shutdown,brutal_kill},
</I>&gt;<i> &gt;                   {child_type,worker}]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =CRASH REPORT==== 28-Dec-2012::10:16:42 ===
</I>&gt;<i> &gt;   crasher:
</I>&gt;<i> &gt;     initial call: gen:init_it/6
</I>&gt;<i> &gt;     pid: &lt;0.32126.341&gt;
</I>&gt;<i> &gt;     registered_name: []
</I>&gt;<i> &gt;     exception exit: {upstream_channel_down,shutdown}
</I>&gt;<i> &gt;       in function  gen_server2:terminate/3
</I>&gt;<i> &gt;     ancestors: [&lt;0.32125.341&gt;,&lt;0.218.0&gt;,rabbit_federation_link_sup_sup,
</I>&gt;<i> &gt;                   rabbit_federation_sup,rabbit_sup,&lt;0.165.0&gt;]
</I>&gt;<i> &gt;     messages:
</I>&gt;<i> [{'DOWN',#Ref&lt;0.0.123.217038&gt;,process,&lt;0.32141.341&gt;,normal}]
</I>&gt;<i> &gt;     links: [&lt;0.32125.341&gt;]
</I>&gt;<i> &gt;     dictionary: []
</I>&gt;<i> &gt;     trap_exit: true
</I>&gt;<i> &gt;     status: running
</I>&gt;<i> &gt;     heap_size: 1597
</I>&gt;<i> &gt;     stack_size: 24
</I>&gt;<i> &gt;     reductions: 2291192
</I>&gt;<i> &gt;   neighbours:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ==&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at XXXX.log</A> &lt;==
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:16:44 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' did not connect
</I>&gt;<i> to exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server1">amqps://XXXX:XXXX@remote-server1</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {error,econnrefused}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:16:46 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' did not connect
</I>&gt;<i> to exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server2">amqps://XXXX:XXXX@remote-server2</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {{shutdown,{server_initiated_close,404,
</I>&gt;<i> &gt;                                    &lt;&lt;&quot;NOT_FOUND - home node
</I>&gt;<i> '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at remote-server1</A>' of durable queue 'federation: upstream-exchange
</I>&gt;<i> -&gt; federation-local:downstream-exchange' in vhost '/' is down or
</I>&gt;<i> inaccessible&quot;&gt;&gt;}},
</I>&gt;<i> &gt;  {gen_server,call,
</I>&gt;<i> &gt;              [&lt;0.7847.351&gt;,
</I>&gt;<i> &gt;               {call,{'queue.declare',0,
</I>&gt;<i> &gt;                                      &lt;&lt;&quot;federation: upstream-exchange -&gt;
</I>&gt;<i> federation-local:downstream-exchange&quot;&gt;&gt;,
</I>&gt;<i> &gt;                                      false,true,false,false,false,[]},
</I>&gt;<i> &gt;                     none,&lt;0.7815.351&gt;},
</I>&gt;<i> &gt;               infinity]}}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =WARNING REPORT==== 28-Dec-2012::10:16:48 ===
</I>&gt;<i> &gt; Federation exchange 'downstream-exchange' in vhost '/' did not connect
</I>&gt;<i> to exchange 'upstream-exchange' in vhost '/' on
</I>&gt;<i> <A HREF="amqps://XXXX:XXXX@remote-server1">amqps://XXXX:XXXX@remote-server1</A>
</I>&gt;<i> ?certfile=XXXX&amp;keyfile=XXXX&amp;verify=verify_none&amp;fail_if_no_peer_cert=false
</I>&gt;<i> &gt; {error,econnrefused}
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121228/59629303/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121228/59629303/attachment.htm</A>&gt;
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024690.html">[rabbitmq-discuss] Federation and upstream cluster
</A></li>
	<LI>Next message: <A HREF="024693.html">[rabbitmq-discuss] Federation and upstream cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24691">[ date ]</a>
              <a href="thread.html#24691">[ thread ]</a>
              <a href="subject.html#24691">[ subject ]</a>
              <a href="author.html#24691">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
