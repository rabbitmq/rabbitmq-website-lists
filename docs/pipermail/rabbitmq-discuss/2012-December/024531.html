<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] crash in a two node RabbitMQ cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20crash%20in%20a%20two%20node%20RabbitMQ%20cluster&In-Reply-To=%3C5501b8bb-06f0-44a4-bde9-673525540668%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024525.html">
   <LINK REL="Next"  HREF="024543.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] crash in a two node RabbitMQ cluster</H1>
    <B>Aravindh S</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20crash%20in%20a%20two%20node%20RabbitMQ%20cluster&In-Reply-To=%3C5501b8bb-06f0-44a4-bde9-673525540668%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] crash in a two node RabbitMQ cluster">aravindh86 at gmail.com
       </A><BR>
    <I>Sat Dec 15 20:22:05 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024525.html">[rabbitmq-discuss] Crash when purging or deleting a queue with	10k messages
</A></li>
        <LI>Next message: <A HREF="024543.html">[rabbitmq-discuss] crash in a two node RabbitMQ cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24531">[ date ]</a>
              <a href="thread.html#24531">[ thread ]</a>
              <a href="subject.html#24531">[ subject ]</a>
              <a href="author.html#24531">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi 

we are running RabbitMQ v 2.8.4 in a two node cluster configuration.

we had an unplanned power outage and both the servers went down. when we 
tried to restart the rabbitmq servers, only rabbit2 node starts up and the 
node rabbit1 crashes on start.
we are running several mirrored queues between these nodes.one such queue 
&quot;Aiken&quot; contained more than 65K messages before the outage.Now rabbit1 wont 
start and rabbit2 starts fine but shows that there are only 109 old 
messages in the &quot;Aiken&quot; Queue.We are afraid if we have lost the messages 
from the rabbit1 crash.

Rabbit1 node crashes on startup on both conditions where rabbit2 was down 
and also when rabbit2 was up.

we could see the following message in the startup log,

BOOT FAILED
===========

Error description:
  
 {badmatch,{error,{&quot;/var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1</A>/queues/1NGZF3JZJR0SU2C0VE2S25JRP/clean.dot&quot;,
                     eacces}}}

but could not understand what it actually means. But I am guessing rabbit1 
and rabbit2 went out of sync.

rabbitmqctl status would yield the following message.
[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">root at rabbit1</A> ~]# rabbitmqctl status
Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1</A> ...
Error: unable to connect to node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1</A>: nodedown

DIAGNOSTICS
===========

nodes in question: [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1</A>]

hosts, their running nodes and ports:
- rabbit1: [{rabbitmqctl7856,46808}]

current node details:
- node name: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmqctl7856 at rabbit1</A>
- home dir: /var/lib/rabbitmq
- cookie hash: WYsTAr/DZ8KD7QQhMu5SSg==


logs are available here: 
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1-sasl.log</A> --&gt; 
 <A HREF="https://docs.google.com/open?id=0B2mCr6qtz2xOS01YZndfTy1DWms">https://docs.google.com/open?id=0B2mCr6qtz2xOS01YZndfTy1DWms</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1.log</A> --&gt; 
 <A HREF="https://docs.google.com/open?id=0B2mCr6qtz2xOcEYwcWl2RDV3YTg">https://docs.google.com/open?id=0B2mCr6qtz2xOcEYwcWl2RDV3YTg</A>
startup_log --&gt; <A HREF="https://docs.google.com/open?id=0B2mCr6qtz2xOOHI2bXQ5OWw4TUE">https://docs.google.com/open?id=0B2mCr6qtz2xOOHI2bXQ5OWw4TUE</A>

Can anyone help me with ideas to recover rabbit1 ??
Is there a way to tweak the startup of Rabbit1 so that it would start as an 
independent node ? 

The data in stake is really important. I would appreciate any help.

- Aravindh
 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121215/1cf67dbd/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121215/1cf67dbd/attachment.htm</A>&gt;
</PRE>















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024525.html">[rabbitmq-discuss] Crash when purging or deleting a queue with	10k messages
</A></li>
	<LI>Next message: <A HREF="024543.html">[rabbitmq-discuss] crash in a two node RabbitMQ cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24531">[ date ]</a>
              <a href="thread.html#24531">[ thread ]</a>
              <a href="subject.html#24531">[ subject ]</a>
              <a href="author.html#24531">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
