<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Crash Report
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Crash%20Report&In-Reply-To=%3C50D04F92.5060602%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024563.html">
   <LINK REL="Next"  HREF="024564.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Crash Report</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Crash%20Report&In-Reply-To=%3C50D04F92.5060602%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Crash Report">simon at rabbitmq.com
       </A><BR>
    <I>Tue Dec 18 11:12:18 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024563.html">[rabbitmq-discuss] Crash Report
</A></li>
        <LI>Next message: <A HREF="024564.html">[rabbitmq-discuss] rabbitmqctl status terminates all Web-STOMP	client connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24576">[ date ]</a>
              <a href="thread.html#24576">[ thread ]</a>
              <a href="subject.html#24576">[ subject ]</a>
              <a href="author.html#24576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hmm. So the logs make it fairly clear that Mnesia shut down due to an 
error. Mnesia is the distributed database RabbitMQ uses to store 
metadata, so when it is down all sorts of things will fail. 
Unfortunately it's not very clear why it shut down. This is, needless to 
say, an unusual occurrence - I found one similar report from 2009 and 
that's it.

So I'm not sure what to recommend. It may be worth upgrading your Erlang 
installation (the debs from 
<A HREF="https://www.erlang-solutions.com/downloads/download-erlang-otp">https://www.erlang-solutions.com/downloads/download-erlang-otp</A> should 
help here). If this happens again then the output of

  rabbitmqctl eval 'ets:tab2list(mnesia_gvar).'

might prove useful.

Sorry I can't give you something more concrete.

Cheers, Simon

On 17/12/12 23:09, Matt Long wrote:
&gt;<i> Using RabbitMQ v2.8.5 on Ubuntu 11.10. Yes, I'm aware that version 3.0+
</I>&gt;<i> is now available...I'm just a bit behind in staying up to date :-)
</I>&gt;<i>
</I>&gt;<i> RabbitMQ suddenly became unreachable by my clients. In particular, the
</I>&gt;<i> amqp Python package raised ConnectionError: 541: (INTERNAL_ERROR, (0,
</I>&gt;<i> 0), None). First thing I did was attempting to list the queues:
</I>&gt;<i>
</I>&gt;<i> $ sudo rabbitmqctl list_queues
</I>&gt;<i> Listing queues ...
</I>&gt;<i> Error: {aborted,{no_exists,[rabbit_queue,
</I>&gt;<i>                              {amqqueue,{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,'_'},
</I>&gt;<i>                                        '_','_','_','_','_','_','_'}]}}
</I>&gt;<i>
</I>&gt;<i> This was fairly cryptic to me since I'm not too familiar with the
</I>&gt;<i> innards of RabbitMQ. Next I checked the status:
</I>&gt;<i>
</I>&gt;<i> $ sudo service rabbitmq-server status
</I>&gt;<i> Status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-100-105-118</A>' ...
</I>&gt;<i> [{pid,879},
</I>&gt;<i>   {running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;2.8.5&quot;},
</I>&gt;<i>                          {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.5&quot;},
</I>&gt;<i>                          {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.9.3&quot;},
</I>&gt;<i>                          {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.3&quot;},
</I>&gt;<i>                          {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.3&quot;}]},
</I>&gt;<i>   {os,{unix,linux}},
</I>&gt;<i>   {erlang_version,&quot;Erlang R14B02 (erts-5.8.3) [source] [64-bit]
</I>&gt;<i> [smp:8:8] [rq:8] [async-threads:30] [kernel-poll:true]\n&quot;},
</I>&gt;<i>   {memory,[{total,128970944},
</I>&gt;<i>            {processes,49035088},
</I>&gt;<i>            {processes_used,36245608},
</I>&gt;<i>            {system,79935856},
</I>&gt;<i>            {atom,1182377},
</I>&gt;<i>            {atom_used,1157674},
</I>&gt;<i>            {binary,17554600},
</I>&gt;<i>            {code,11329658},
</I>&gt;<i>            {ets,47162232}]},
</I>&gt;<i>   {vm_memory_high_watermark,0.4},
</I>&gt;<i>   {vm_memory_limit,2920456192},
</I>&gt;<i>   {disk_free_limit,1000000000},
</I>&gt;<i>   {disk_free,6324633600},
</I>&gt;<i>   {file_descriptors,[{total_limit,924},
</I>&gt;<i>                      {total_used,186},
</I>&gt;<i>                      {sockets_limit,829},
</I>&gt;<i>                      {sockets_used,128}]},
</I>&gt;<i>   {processes,[{limit,1048576},{used,1235}]},
</I>&gt;<i>   {run_queue,0},
</I>&gt;<i>   {uptime,4829636}]
</I>&gt;<i> ...done.
</I>&gt;<i>
</I>&gt;<i> The error logs contain quite a bit of information related to the crash.
</I>&gt;<i> Here are links to excerpts from the main RabbitMQ log and the sasl log:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at myhostname.log</A>: <A HREF="http://pastebin.com/1CBjmbGb">http://pastebin.com/1CBjmbGb</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at myhostname-sasl.log</A>: <A HREF="http://pastebin.com/8qZas7hA">http://pastebin.com/8qZas7hA</A>
</I>&gt;<i>
</I>&gt;<i> Stopping and then starting the rabbitmq-server daemon luckily fixed the
</I>&gt;<i> problem and seemed to maintain at least most of Rabbit's state. Can
</I>&gt;<i> someone help me interpret what happened and what I can do to prevent
</I>&gt;<i> this in the future?
</I>&gt;<i>
</I>&gt;<i> Many thanks in advance!
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Matt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024563.html">[rabbitmq-discuss] Crash Report
</A></li>
	<LI>Next message: <A HREF="024564.html">[rabbitmq-discuss] rabbitmqctl status terminates all Web-STOMP	client connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24576">[ date ]</a>
              <a href="thread.html#24576">[ thread ]</a>
              <a href="subject.html#24576">[ subject ]</a>
              <a href="author.html#24576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
