<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] custom plugin causing problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20plugin%20causing%20problems&In-Reply-To=%3CEFC9320E-6DD0-4A46-9E2C-B3E4275D7439%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024566.html">
   <LINK REL="Next"  HREF="024571.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] custom plugin causing problems</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20plugin%20causing%20problems&In-Reply-To=%3CEFC9320E-6DD0-4A46-9E2C-B3E4275D7439%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] custom plugin causing problems">tim at rabbitmq.com
       </A><BR>
    <I>Tue Dec 18 08:43:19 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024566.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
        <LI>Next message: <A HREF="024571.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24567">[ date ]</a>
              <a href="thread.html#24567">[ thread ]</a>
              <a href="subject.html#24567">[ subject ]</a>
              <a href="author.html#24567">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>  after running `rabbitmqctl disable &lt;plugin&gt;`
</I>
Of course I mean `rabbitmq-plugins disable`. 

&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Tim
</I>&gt;<i> 
</I>&gt;<i> On 18 Dec 2012, at 07:53, Prabodh Upreti wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hello
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I am not sure what is going on with my system.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I created a custom plugin for authentication which is working fine.  As part
</I>&gt;&gt;<i> of that setup, I had to delete the guest user to make it secure.  
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Now I need to use the rabbitmqadmin command to create an exchange because
</I>&gt;&gt;<i> the original one was not created as durable=true, hence I disabled my plugin
</I>&gt;&gt;<i> and enabled rabbitmq_management.  When I execute 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> rabbitmqadmin -f long -d 3 list queues
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I see
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">root at fm11deploy02</A> rabbitmq]# rabbitmqadmin -f long -d 3 list queues
</I>&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;<i> File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 828, in &lt;module&gt;
</I>&gt;&gt;<i>   main()
</I>&gt;&gt;<i> File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 325, in main
</I>&gt;&gt;<i>   method()
</I>&gt;&gt;<i> File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 456, in invoke_list
</I>&gt;&gt;<i>   format_list(self.get(uri), cols, self.options)
</I>&gt;&gt;<i> File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 348, in get
</I>&gt;&gt;<i>   return self.http(&quot;GET&quot;, path, &quot;&quot;)
</I>&gt;&gt;<i> File &quot;/usr/local/bin/rabbitmqadmin&quot;, line 377, in http
</I>&gt;&gt;<i>   resp = conn.getresponse()
</I>&gt;&gt;<i> File &quot;/usr/lib64/python2.6/httplib.py&quot;, line 990, in getresponse
</I>&gt;&gt;<i>   response.begin()
</I>&gt;&gt;<i> File &quot;/usr/lib64/python2.6/httplib.py&quot;, line 391, in begin
</I>&gt;&gt;<i>   version, status, reason = self._read_status()
</I>&gt;&gt;<i> File &quot;/usr/lib64/python2.6/httplib.py&quot;, line 355, in _read_status
</I>&gt;&gt;<i>   raise BadStatusLine(line)
</I>&gt;&gt;<i> httplib.BadStatusLine
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> In the log file I see
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> ASH REPORT==== 18-Dec-2012::08:36:03 ===
</I>&gt;&gt;<i> crasher:
</I>&gt;&gt;<i>   initial call: mochiweb_acceptor:init/3
</I>&gt;&gt;<i>   pid: &lt;0.3908.0&gt;
</I>&gt;&gt;<i>   registered_name: []
</I>&gt;&gt;<i>   exception error: undefined function
</I>&gt;&gt;<i> rabbitmq_cas_authen:check_user_login/2
</I>&gt;&gt;<i>     in function  rabbit_access_control:'-check_user_login/2-fun-0-'/4
</I>&gt;&gt;<i>     in call from lists:foldl/3 (lists.erl, line 1197)
</I>&gt;&gt;<i>     in call from rabbit_mgmt_app:'-make_loop/0-fun-0-'/4
</I>&gt;&gt;<i>     in call from mochiweb_http:headers/5
</I>&gt;&gt;<i>   ancestors: [rabbit_mochiweb_web_mgmt,rabbit_mochiweb_sup,&lt;0.127.0&gt;]
</I>&gt;&gt;<i>   messages: []
</I>&gt;&gt;<i>   links: [&lt;0.228.0&gt;,#Port&lt;0.12917&gt;]
</I>&gt;&gt;<i>   dictionary: []
</I>&gt;&gt;<i>   trap_exit: false
</I>&gt;&gt;<i>   status: running
</I>&gt;&gt;<i>   heap_size: 4181
</I>&gt;&gt;<i>   stack_size: 24
</I>&gt;&gt;<i>   reductions: 3638
</I>&gt;&gt;<i> neighbours:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> looks like the management plugin is trying to use my custom plugin
</I>&gt;&gt;<i> rabbitmq_cas_plugin even though I have disabled it.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> part of my custom plugin setup I had something like this in rabbitmq.config
</I>&gt;&gt;<i> which I took out for management plugin:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>       {rabbit,
</I>&gt;&gt;<i>               [{auth_backends, [rabbitmq_cas_authen,
</I>&gt;&gt;<i> rabbit_auth_backend_inter
</I>&gt;&gt;<i> nal]},
</I>&gt;&gt;<i>                {vm_memory_high_watermark, 0.1}
</I>&gt;&gt;<i>               ]
</I>&gt;&gt;<i>       },
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I would appreciate any insight. thank you.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/custom-plugin-causing-problems-tp24091.html">http://rabbitmq.1065348.n5.nabble.com/custom-plugin-causing-problems-tp24091.html</A>
</I>&gt;&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024566.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
	<LI>Next message: <A HREF="024571.html">[rabbitmq-discuss] custom plugin causing problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24567">[ date ]</a>
              <a href="thread.html#24567">[ thread ]</a>
              <a href="subject.html#24567">[ subject ]</a>
              <a href="author.html#24567">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
