<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel restart options
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20restart%20options&In-Reply-To=%3CE2FF5354-7FAF-4F4E-BA56-9392BEC2CFD8%40dushin.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024666.html">
   <LINK REL="Next"  HREF="024501.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel restart options</H1>
    <B>Dushin Fred</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20restart%20options&In-Reply-To=%3CE2FF5354-7FAF-4F4E-BA56-9392BEC2CFD8%40dushin.net%3E"
       TITLE="[rabbitmq-discuss] Shovel restart options">fred at dushin.net
       </A><BR>
    <I>Thu Dec 13 12:54:21 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024666.html">[rabbitmq-discuss] RabbitMQ 2.8.2 crashing with VMWare
</A></li>
        <LI>Next message: <A HREF="024501.html">[rabbitmq-discuss] Shovel restart options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24488">[ date ]</a>
              <a href="thread.html#24488">[ thread ]</a>
              <a href="subject.html#24488">[ subject ]</a>
              <a href="author.html#24488">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I am using the shovel plugin to move messages from several queues on one broker to corresponding exchanges on another, and for the most part this works beautifully.

I would like to be able to reconfigure the shovel plugin without restarting the message broker, however, as I want as high uptime on the broker as possible (and in some scenarios I do not want to mandate use of persistent messages (performance, I/O subsystem already under pressure, etc.).

Semantically, on the broker, I want to be able to do the following (given a set of terms bound to Shovel):

application:stop(rabbitmq_shovel).
application:set_env(rabbitmq_shovel, shovels, Shovels).
application:start(rabbitmq_shovel).

(I can also persist the changes in rabbitmq.config for subsequent restarts)

As far as I can see, my options are to:

1. Invoke the above commands through rabbitctl eval 'term', or a sequence thereof;
2. Implement a plugin which invokes the above, and communicate to the plugin through some mechanism (mochiweb, AMQP, etc).
3. Deploy the shovel plugin in a separate abstract machine (beam) and simply restart that VM. 

The first option has obvious drawbacks and is almost a non-starter (though of course it is the first thing I have prototyped :) -- the default limit on a command line argument on most of the platforms I am using is something like 250k, and I have no control over the size of the Shovels term.

The second is better, as the plumbing is all there to do it, and it seems like the most robust solution.

The third is viable, but it requires a separate point of management.

Have others on this list come up with any alternatives?

Thanks,

Fred Dushin
</PRE>
























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024666.html">[rabbitmq-discuss] RabbitMQ 2.8.2 crashing with VMWare
</A></li>
	<LI>Next message: <A HREF="024501.html">[rabbitmq-discuss] Shovel restart options
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24488">[ date ]</a>
              <a href="thread.html#24488">[ thread ]</a>
              <a href="subject.html#24488">[ subject ]</a>
              <a href="author.html#24488">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
