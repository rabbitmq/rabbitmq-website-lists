<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] no connection established
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20no%20connection%20established&In-Reply-To=660757.12172.qm%40web30006.mail.mud.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000839.html">
   <LINK REL="Next"  HREF="000837.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] no connection established</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20no%20connection%20established&In-Reply-To=660757.12172.qm%40web30006.mail.mud.yahoo.com"
       TITLE="[rabbitmq-discuss] no connection established">alexis.richardson at cohesiveft.com
       </A><BR>
    <I>Thu May 15 15:02:21 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000839.html">[rabbitmq-discuss] no connection established
</A></li>
        <LI>Next message: <A HREF="000837.html">[rabbitmq-discuss] no connection established
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#849">[ date ]</a>
              <a href="thread.html#849">[ thread ]</a>
              <a href="subject.html#849">[ subject ]</a>
              <a href="author.html#849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Geoffrey

How are you getting on?  Have all your questions been answered
satisfactorily?  Let people know :-)

One thing - you asked about how we tested against different AMQP spec
versions.   To quote from <A HREF="http://www.rabbitmq.com/dotnet.html">http://www.rabbitmq.com/dotnet.html</A> -

&quot;The client library implements AMQP specifications version 0-8, 0-8bis
(0-8 as modified by QPid for their M2 release) and 0-9 (omitting
sections of the specification marked &quot;work in progress&quot;, i.e. the
Message content-class). A single binary copy of the library contains
support for all three protocol variants, and code can select a variant
to use at runtime. The library has been tested against

    * RabbitMQ 1.2.x (AMQP 0-8)
    * QPid M2 (AMQP 0-8bis, 0-9 (in the M2.1 branch))
    * OpenAMQ 1.2c4 (AMQP 0-9)&quot;

alexis





On Tue, May 13, 2008 at 8:16 PM, Geoffrey Anderson &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mrcoder at yahoo.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> --- Ben Hood &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Geoffrey,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sorry to hear that you have run into difficulties.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 13 May 2008, at 17:53, Geoffrey Anderson wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; The rabbitmq server runs, it seems, but no connections are being
</I>&gt;&gt;<i> &gt; accepted by it,
</I>&gt;&gt;<i> &gt; from the java samples or dotnet sample programs or my own programs.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can you try with a simple TCP client, e.g.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> nc 0.0.0.0 5672
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What shows up in the server log when you do this?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> C:\rabbitmq\rabbitmq-dotnet-1.2.8025.1832-net-2.0\bin&gt;nc
</I>&gt;<i> 'nc' is not recognized as an internal or external command,
</I>&gt;<i> operable program or batch file.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> C:\Documents and Settings\ga&gt;telnet 0.0.0.0 5672
</I>&gt;<i> Connecting To 0.0.0.0...Could not open connection to the host, on port 5672: Connect
</I>&gt;<i> failed
</I>&gt;<i>
</I>&gt;<i> Thank you for the interesting suggestion.  I imagine telnet is just as good as 'nc'
</I>&gt;<i> for this purpose although I don't know what 'nc' is.
</I>&gt;<i>
</I>&gt;<i> Seems like no process is listening on port 5672 doesn't it?
</I>&gt;<i>
</I>&gt;<i> OTOH netstat suggests there really IS a process listening there, if I am reading it
</I>&gt;<i> correctly:
</I>&gt;<i>
</I>&gt;<i> C:\Documents and Settings\ga&gt;netstat -a
</I>&gt;<i>
</I>&gt;<i> Active Connections
</I>&gt;<i>
</I>&gt;<i>  Proto  Local Address          Foreign Address        State
</I>&gt;<i>  TCP    alpeduez:epmap         alpeduez:0             LISTENING
</I>&gt;<i>  TCP    alpeduez:microsoft-ds  alpeduez:0             LISTENING
</I>&gt;<i>  TCP    alpeduez:1227          alpeduez:0             LISTENING
</I>&gt;<i>  TCP    alpeduez:4369          alpeduez:0             LISTENING
</I>&gt;<i>  TCP    alpeduez:5672          alpeduez:0             LISTENING
</I>&gt;<i>  TCP    alpeduez:1229          localhost:4369         ESTABLISHED
</I>&gt;<i>  TCP    alpeduez:4369          localhost:1229         ESTABLISHED
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; For three days I have been trying everything imaginable to me to get
</I>&gt;&gt;<i> &gt; any client
</I>&gt;&gt;<i> &gt; program to connect to the rabbitmq server.  For example I disabled
</I>&gt;&gt;<i> &gt; tcpv6 on my
</I>&gt;&gt;<i> &gt; system and tried all manner of user permissions in the rabbitmq
</I>&gt;&gt;<i> &gt; server for 'guest'
</I>&gt;&gt;<i> &gt; and my custom account 'ga' which I gave all same permissions as
</I>&gt;&gt;<i> &gt; 'guest'.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> By default Rabbit ships with the user/pass combination guest/guest, so
</I>&gt;&gt;<i> without further ado that should work.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I agree.  Unfortunately guest/guest really does not work at the moment if the sample
</I>&gt;<i> programs are an indication.  I shall remove the guest account's permissions for host
</I>&gt;<i> security purposes later after this problem is resoloved.  Default accounts that ship
</I>&gt;<i> with server programs are typical attack targets for malware and script kiddies.
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; The web site asks users to send a note to <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">legitimateconcern at rabbitmq.com</A>
</I>&gt;&gt;<i> &gt;  if it takes
</I>&gt;&gt;<i> &gt; more than 2 minutes to connect.  Si I have sent a detailed note.
</I>&gt;&gt;<i> &gt; There has been no
</I>&gt;&gt;<i> &gt; response to it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Don't want to split hairs but the address is <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">legitimategrievance at rabbitmq.com</A>
</I>&gt;&gt;<i> , so you probably sent a message to a non-existent mailbox.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> What I didn't tell you until now -- your answer is actually reasonable given what
</I>&gt;<i> you knew -- was that I pulled that email address from (human) memory as I was
</I>&gt;<i> writing, really only meant as an approximation to get the idea across of what I had
</I>&gt;<i> done.  It's not the email address I really used, which was copied from the web page
</I>&gt;<i> at rabbitmq.com into the clipboard memory and then pasted into the mail program
</I>&gt;<i> verbatim.  And lo, just a few minutes ago, another person has confirmed receipt of
</I>&gt;<i> the original email message, so it's known to be the correct address which I had used
</I>&gt;<i> the other day.
</I>&gt;<i>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; The web site says  Please join our mailing list or send questions to
</I>&gt;&gt;<i> &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">info at rabbitmq.com.</A> We'd love to hear from you.   I've subscribed and
</I>&gt;&gt;<i> &gt; sent a detailed
</I>&gt;&gt;<i> &gt; message to the mailing list.  My email did not appear in the mailing
</I>&gt;&gt;<i> &gt; list, and no
</I>&gt;&gt;<i> &gt; responses came back.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here's one :-)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Very much appreciated.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; C:\rabbitmq\rabbitmq-dotnet-1.2.8025.1832-
</I>&gt;&gt;<i> &gt; net-2.0\bin&gt;DeclareQueue.exe alpeduez
</I>&gt;&gt;<i> &gt; testqueue
</I>&gt;&gt;<i> &gt; None of the specified endpoints were reachable
</I>&gt;&gt;<i> &gt; Endpoints attempted:
</I>&gt;&gt;<i> &gt;  endpoint=amqp-0-<A HREF="9://alpeduez:5672,">9://alpeduez:5672,</A> attempts=1, outcome=AMQP server
</I>&gt;&gt;<i> &gt; protocol
</I>&gt;&gt;<i> &gt; negotiation failure: server version 0-8, t
</I>&gt;&gt;<i> &gt; ransport parameters -1:-1
</I>&gt;&gt;<i> &gt; Stack trace:
</I>&gt;&gt;<i> &gt;   at RabbitMQ.Client.ConnectionFactory.CreateConnection(Int32
</I>&gt;&gt;<i> &gt; maxRedirects,
</I>&gt;&gt;<i> &gt; AmqpTcpEndpoint[] endpoints)
</I>&gt;&gt;<i> &gt;   at
</I>&gt;&gt;<i> &gt; RabbitMQ.Client.ConnectionFactory.CreateConnection(AmqpTcpEndpoint[]
</I>&gt;&gt;<i> &gt; endpoints)
</I>&gt;&gt;<i> &gt;   at RabbitMQ.Client.ConnectionFactory.CreateConnection(String
</I>&gt;&gt;<i> &gt; address)
</I>&gt;&gt;<i> &gt;   at RabbitMQ.Client.Examples.DeclareQueue.Main(String[] args)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You need to specify the protocol version in your config file (refer to
</I>&gt;&gt;<i> the .NET client manual).
</I>&gt;&gt;<i> This client is defaulting to AMQP 0-9 whereas Rabbit currently speaks
</I>&gt;&gt;<i> 0-8.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Your idea is intriguing... I have a good expectation about it.
</I>&gt;<i>
</I>&gt;<i> You may well be correct.  It's interesting though, that the .Net client would be
</I>&gt;<i> defaulting to a version of the protocol which is more advanced than the RabbitMQ
</I>&gt;<i> server.  I wonder how the author developed the .Net client libs in advance of the
</I>&gt;<i> server.  He's a pretty advanced developer. ;)
</I>&gt;<i>
</I>&gt;<i> More specifically, in my own programs, I had been trying to use a construct like
</I>&gt;<i> this:
</I>&gt;<i>
</I>&gt;<i> IProtocol protocol = Protocols.FromEnvironment();
</I>&gt;<i> IConnection conn = factory.CreateConnection(protocol, hostName);
</I>&gt;<i>
</I>&gt;<i> To my surprise it didn't work.  Now, I am looking at the .NET client user guide
</I>&gt;<i> sections 2.2 and 2.3.
</I>&gt;<i>
</I>&gt;<i> It says there is (or expected to be) an environment variable where it gets its
</I>&gt;<i> information:
</I>&gt;<i>
</I>&gt;<i> &quot;If no argument is passed to FromEnvironment() or FromConfiguration(), the value of
</I>&gt;<i> Protocols.DefaultAppSettingsKey is used. (At the time of writing, the default
</I>&gt;<i> appSettings key is
</I>&gt;<i> AMQP_PROTOCOL, the same as the name of the shell environment variable scanned.)&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well the reality is that my system is telling me there really isn't any such shell
</I>&gt;<i> environment variable defined:
</I>&gt;<i>
</I>&gt;<i> C:\rabbitmq\librabbitmq-java-1.3.0&gt;echo %AMQP_PROTOCOL%
</I>&gt;<i> %AMQP_PROTOCOL%
</I>&gt;<i>
</I>&gt;<i> Maybe this missing envoronment variable is why Protocols.FromEnvironment() is not
</I>&gt;<i> useful on my system.
</I>&gt;<i>
</I>&gt;<i> Tyring to follow along with your suggestion, I guess there are two ways to get the
</I>&gt;<i> sample .NET programs working with the 0.8 protocol rather than 0.9 protocol.
</I>&gt;<i>
</I>&gt;<i> 1 - Change the environment variable AMQP_PROTOCOL.  However, my system is reporting
</I>&gt;<i> that I don't have this environment variable defined anywhere, so I don't know for
</I>&gt;<i> sure what to do.  Should I define one now?  I guess I could try to create one and
</I>&gt;<i> see what happens.  I guess I will set AMQP_PROTOCOL to the value &quot;AMQP_0_8&quot;.
</I>&gt;<i>
</I>&gt;<i> 2 - Change the .config file for every client application. Seeing as they don't have
</I>&gt;<i> config files out of the box, I would need to create config files for each one I
</I>&gt;<i> guess.
</I>&gt;<i>
</I>&gt;<i> 3 - If I am programming my own code, rather than working with the sample programs, I
</I>&gt;<i> could also specify my client to use just the desired protocol in a line of code like
</I>&gt;<i> this, per User Guide section 2.2:
</I>&gt;<i>
</I>&gt;<i> Given the following App.config snippet,
</I>&gt;<i>
</I>&gt;<i> &lt;appSettings&gt;
</I>&gt;<i>  &lt;add key=&quot;my-protocol&quot; value=&quot;AMQP_0_8&quot;/&gt;
</I>&gt;<i> &lt;/appSettings&gt;
</I>&gt;<i>
</I>&gt;<i> the following code will also bind p to the 0-8 IProtocol implementation:
</I>&gt;<i>
</I>&gt;<i> ConnectionFactory factory = new ConnectionFactory();
</I>&gt;<i> //IProtocol protocol = Protocols.FromEnvironment();
</I>&gt;<i> IProtocol p = Protocols.FromConfiguration(&quot;my-protocol&quot;);
</I>&gt;<i> IConnection conn = factory.CreateConnection(p, hostName);
</I>&gt;<i>
</I>&gt;<i> Hopefully my own code will run if I write something like the above.  And I can try
</I>&gt;<i> to get the sample programs working later if I have time.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I guess I would ask you to cut to the chase if that's OK.  What did you or other
</I>&gt;<i> people actually do specifically on your own systems to get the .NET sample programs
</I>&gt;<i> working?   Did you manually create the environment variable AMQP_PROTOCOL and set it
</I>&gt;<i> to the value &quot;AMQP_0_8&quot;?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; 4.  Go look again to see if Tracer saw any traffic:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; C:\rabbitmq\librabbitmq-java-1.3.0&gt;runjava.bat
</I>&gt;&gt;<i> &gt; com.rabbitmq.tools.Tracer
</I>&gt;&gt;<i> &gt; Usage: Tracer [&lt;listenport&gt; [&lt;connecthost&gt; [&lt;connectport&gt;]]]
</I>&gt;&gt;<i> &gt; Invoked as: Tracer 5673 localhost 5672
</I>&gt;&gt;<i> &gt; com.rabbitmq.tools.Tracer.WITHHOLD_INBOUND_HEARTBEATS = false
</I>&gt;&gt;<i> &gt; com.rabbitmq.tools.Tracer.WITHHOLD_OUTBOUND_HEARTBEATS = false
</I>&gt;&gt;<i> &gt; com.rabbitmq.tools.Tracer.NO_ASSEMBLE_FRAMES = false
</I>&gt;&gt;<i> &gt; com.rabbitmq.tools.Tracer.NO_DECODE_FRAMES = false
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; It seems no traffic was detected during the dotnet sample program
</I>&gt;&gt;<i> &gt; execution.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Your client will need to connect to the listen port of the tracer,
</I>&gt;&gt;<i> i.e. 5673. By default AMQP clients connect to 5672.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> HTH,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ben
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> OK that makes some sense.  Tracer is a simple proxy server then.
</I>&gt;<i>
</I>&gt;<i> Thank you for the insightful responses.
</I>&gt;<i>
</I>&gt;<i> Geoffrey
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000839.html">[rabbitmq-discuss] no connection established
</A></li>
	<LI>Next message: <A HREF="000837.html">[rabbitmq-discuss] no connection established
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#849">[ date ]</a>
              <a href="thread.html#849">[ thread ]</a>
              <a href="subject.html#849">[ subject ]</a>
              <a href="author.html#849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
