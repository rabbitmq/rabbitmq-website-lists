<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] persistence
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20persistence&In-Reply-To=4835381C.7060809%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000884.html">
   <LINK REL="Next"  HREF="000888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] persistence</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20persistence&In-Reply-To=4835381C.7060809%40lshift.net"
       TITLE="[rabbitmq-discuss] persistence">matthias at lshift.net
       </A><BR>
    <I>Thu May 22 13:49:42 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000884.html">[rabbitmq-discuss] persistence
</A></li>
        <LI>Next message: <A HREF="000888.html">[rabbitmq-discuss] persistence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#885">[ date ]</a>
              <a href="thread.html#885">[ thread ]</a>
              <a href="subject.html#885">[ subject ]</a>
              <a href="author.html#885">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Lars,

Matthias Radestock wrote:
&gt;<i> Lars Bachmann wrote:
</I>&gt;&gt;<i> In our company we comparing different messaging solutions and rabbitmq 
</I>&gt;&gt;<i> seemed to be a good one, but the problems with the presistent messages 
</I>&gt;&gt;<i> are unfortunatelly a big minus.
</I>&gt;<i> 
</I>&gt;<i> The problem actually isn't with persistent messaging, but with sending 
</I>&gt;<i> lots of messages at a rate greater than the broker can process, and 
</I>&gt;<i> building up backlogs of 10th of thousands of messages in doing do. 
</I>&gt;<i> Persistence increases the workload and thus lowers the processing rate, 
</I>&gt;<i> which makes the problem more noticeable when persistence is enabled.
</I>&gt;<i> 
</I>&gt;<i> The bug is not causing any difficulties in practice unless *all* of the 
</I>&gt;<i> following are true of your clients:
</I>&gt;<i> - they publish messages to the broker at a rate that significantly 
</I>&gt;<i> exceeds the brokers processing capacity
</I>&gt;<i> - they sustain such a rate for a significant period of time (i.e. not 
</I>&gt;<i> just a few second blip)
</I>&gt;<i> - they disconnect shortly after sending all these messages
</I>
I forgot to mention that this is actually a grey area in the AMQP spec. 
What RabbitMQ is doing is perfectly compliant. We have initiated a 
discussion in the the AMQP working group to get the spec clarified. 
Independently of that, as I mentioned, we will fix the the problem in 
the next release.

I should also point out that AMQP's basic.publish is fundamentally 
asynchronous and thus limited in the guarantees it provides. You get 
stronger guarantees when wrapping your publish requests in transactions 
(see channel.tx{Select,Commit,Rollback}() in the Java API). The server 
guarantees that persistent messages have been written to disk by the 
time it returns tx.commit-ok, though obviously this carries a 
performance penalty.


Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000884.html">[rabbitmq-discuss] persistence
</A></li>
	<LI>Next message: <A HREF="000888.html">[rabbitmq-discuss] persistence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#885">[ date ]</a>
              <a href="thread.html#885">[ thread ]</a>
              <a href="subject.html#885">[ subject ]</a>
              <a href="author.html#885">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
