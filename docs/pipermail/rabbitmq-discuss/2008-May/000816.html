<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] More RabbitMQ Erlang client woes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20More%20RabbitMQ%20Erlang%20client%20woes&In-Reply-To=48242E0E.1070706%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000815.html">
   <LINK REL="Next"  HREF="000817.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] More RabbitMQ Erlang client woes</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20More%20RabbitMQ%20Erlang%20client%20woes&In-Reply-To=48242E0E.1070706%40lshift.net"
       TITLE="[rabbitmq-discuss] More RabbitMQ Erlang client woes">0x6e6562 at gmail.com
       </A><BR>
    <I>Fri May  9 12:10:51 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000815.html">[rabbitmq-discuss] More RabbitMQ Erlang client woes
</A></li>
        <LI>Next message: <A HREF="000817.html">[rabbitmq-discuss] More RabbitMQ Erlang client woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#816">[ date ]</a>
              <a href="thread.html#816">[ thread ]</a>
              <a href="subject.html#816">[ subject ]</a>
              <a href="author.html#816">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

On 9 May 2008, at 11:57, Matthias Radestock wrote:
&gt;<i> Ben Hood wrote:
</I>&gt;&gt;<i> To achieve this I think the cleanup should be contained within the  
</I>&gt;&gt;<i> network driver either as a callback to allow the network driver to  
</I>&gt;&gt;<i> stop the channel writer process or even linking the channel process  
</I>&gt;&gt;<i> with the writer process so that when the channel exits, the writer  
</I>&gt;&gt;<i> process receives a signal as well. I think I prefer the latter, but  
</I>&gt;&gt;<i> this would mean changing the writer module, which is core module of  
</I>&gt;&gt;<i> the server and we'd need to look at the implications of this.
</I>&gt;<i>
</I>&gt;<i> The server is already linking the writer and the channel, though the  
</I>&gt;<i> way that is done may not be immediately obvious.
</I>
Are you talking about start_link/4 in rabbit_channel? If I'm not  
mistaken, this is linking the writing and the channel in the direct  
case, but not in the network case.

In the network driver, the writer is started in the start_writer/2  
function on a per channel basis:

start_writer(Sock, Channel) -&gt;
     rabbit_writer:start(Sock, Channel, ?FRAME_MIN_SIZE).

This then starts a new process to translate Erlang messages into AMQP  
frames.

But this loop process is not linked to anything as far as I can see,  
which is the behaviour that Edwin is reporting.

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000815.html">[rabbitmq-discuss] More RabbitMQ Erlang client woes
</A></li>
	<LI>Next message: <A HREF="000817.html">[rabbitmq-discuss] More RabbitMQ Erlang client woes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#816">[ date ]</a>
              <a href="thread.html#816">[ thread ]</a>
              <a href="subject.html#816">[ subject ]</a>
              <a href="author.html#816">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
