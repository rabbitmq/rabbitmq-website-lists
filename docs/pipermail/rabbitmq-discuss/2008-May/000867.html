<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] possible bug starting rabbit with NODENAME set?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20possible%20bug%20starting%20rabbit%20with%20NODENAME%0A%20set%3F&In-Reply-To=6c2563b20805161436r6fd173c0g3f3d1f86cd0e76%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000866.html">
   <LINK REL="Next"  HREF="000868.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] possible bug starting rabbit with NODENAME set?</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20possible%20bug%20starting%20rabbit%20with%20NODENAME%0A%20set%3F&In-Reply-To=6c2563b20805161436r6fd173c0g3f3d1f86cd0e76%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] possible bug starting rabbit with NODENAME set?">matthias at lshift.net
       </A><BR>
    <I>Fri May 16 23:22:03 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000866.html">[rabbitmq-discuss] possible bug starting rabbit with NODENAME	set?
</A></li>
        <LI>Next message: <A HREF="000868.html">[rabbitmq-discuss] possible bug starting rabbit with NODENAME	set?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#867">[ date ]</a>
              <a href="thread.html#867">[ thread ]</a>
              <a href="subject.html#867">[ subject ]</a>
              <a href="author.html#867">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Edwin,

Edwin Fine wrote:
&gt;<i> I can also successfully run /usr/sbin/rabbitmq-server from the command 
</I>&gt;<i> line if I change -sname to -name. I just have to make sure that I change 
</I>&gt;<i> the actual mnesia dir to match the NODENAME.
</I>
By default the mnesia dir is based on the NODENAME. By &quot;change&quot; do you 
mean &quot;rename&quot;, so you retain the existing data across the move? That 
wouldn't be a good idea - mnesia can get very confused if you its dirs 
between nodes.

&gt;<i> But I think that in addition to the rabbit_multi script, 
</I>&gt;<i> rabbit_multi.erl will need some serious tweaking. I think it was written 
</I>&gt;<i> with local clustering in mind and did not adequately consider the effect 
</I>&gt;<i> of using fully-qualified domain names with -name.
</I>
Correct.

As a bit of background, rabbitmq-multi was introduced to give people a 
quick and easy way to set up a cluster on their local machine. It was 
never intended to cope with more complex set ups. There is all kinds of 
tweaking a user may want to do to their cluster and the rabbit start up 
in general. The scripts can only ever cater for a subset of that.

It's usually not that hard to construct your own scripts to start up 
rabbit in the particular way that suits your environment, so we would 
expect users to do just that.

&gt;<i> Firstly, rabbit_multi.erl hard-codes the node name &quot;rabbit&quot;:
</I>
I filed a bug for that a few days ago.

&gt;<i> localnode would strip off everything after the &quot;@&quot; anyway. Now if
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at myexample.com</A> &lt;mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at myexample.com</A>&gt; were running
</I>&gt;<i> locally, but using -name, the rpc call would fail because erlang
</I>&gt;<i> would want the full node name.
</I>
As I said above, the scripts and supporting code were designed for 
-sname, not -name. However, they can probably be adjusted to cope with 
the latter. We will look into that.

&gt;<i> Just prior to this, to add insult to injury, the code blasts any 
</I>&gt;<i> environment values that might have existed.
</I>
Indeed. I filed a bug for that a few days ago too.

&gt;<i> I respectfully suggest that some more thought needs to go into 
</I>&gt;<i> rabbit_multi.erl and perhaps the startup/node name architecture.
</I>
Thanks for your analysis. Most of the points you raised should be 
addressed in the next RabbitMQ release.


Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000866.html">[rabbitmq-discuss] possible bug starting rabbit with NODENAME	set?
</A></li>
	<LI>Next message: <A HREF="000868.html">[rabbitmq-discuss] possible bug starting rabbit with NODENAME	set?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#867">[ date ]</a>
              <a href="thread.html#867">[ thread ]</a>
              <a href="subject.html#867">[ subject ]</a>
              <a href="author.html#867">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
