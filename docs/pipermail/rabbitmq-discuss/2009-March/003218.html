<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] High cpu usage for Java RabbitMQ client?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20High%20cpu%20usage%20for%20Java%20RabbitMQ%20client%3F&In-Reply-To=49C94CD2.8010002%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003217.html">
   <LINK REL="Next"  HREF="003219.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] High cpu usage for Java RabbitMQ client?</H1>
    <B>Elsner, Robert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20High%20cpu%20usage%20for%20Java%20RabbitMQ%20client%3F&In-Reply-To=49C94CD2.8010002%40lshift.net"
       TITLE="[rabbitmq-discuss] High cpu usage for Java RabbitMQ client?">Robert.Elsner at echostar.com
       </A><BR>
    <I>Tue Mar 24 23:08:36 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003217.html">[rabbitmq-discuss] High cpu usage for Java RabbitMQ client?
</A></li>
        <LI>Next message: <A HREF="003219.html">[rabbitmq-discuss] High cpu usage for Java RabbitMQ client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3218">[ date ]</a>
              <a href="thread.html#3218">[ thread ]</a>
              <a href="subject.html#3218">[ subject ]</a>
              <a href="author.html#3218">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

I have implemented the Basic.Qos to limit to 10 the prefetch size.  All
of my messages are marked as immediate, so that if a client gets backed
up, my understanding is that the message will be silently dropped for
that queue.  This seems to be the case, if I add a queue but do not
consume messages, the broker does not continually consume extra memory.

The broker is from the mercurial repository, the last status that hg
info reports is this:

changeset:   922:e4c723649145
branch:      bug19356
tag:         tip
parent:      921:1f4653fa63c9
parent:      853:1c307e454a52
user:        Essien Ita Essien &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">essiene at gmail.com</A>&gt;
date:        Thu Feb 19 08:46:15 2009 +0100
summary:     Merge with upstream default

The java client is from the same pull, on the same day.

All of these are running on Linux, generally Ubuntu (my development box)
but I setup the broker to run on Debian 5.0.  JVM version build
1.6.0_10-b33

I can reduce the code to a simple example.  The outline is basically I
have a few runnable's that open a channel, perform QoS, open an
exchange, and bind a queue.  They then sit in a loop using
.nextDelivery() from the QueueingConsumer.

&gt;<i> Also, do the stack traces you get from sending the JVM a QUIT 
</I>&gt;<i> signal offer any clues? Feel free to post them here.
</I>
Attached.

I will follow up with some equivalent code samples later, I'm just
trying to narrow down where the problem is, and prefer to not waste too
much time from other people if no one has seen this issue but me.

Rob
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: stack_traces.txt
Url: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090324/373d653f/attachment.txt">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090324/373d653f/attachment.txt</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003217.html">[rabbitmq-discuss] High cpu usage for Java RabbitMQ client?
</A></li>
	<LI>Next message: <A HREF="003219.html">[rabbitmq-discuss] High cpu usage for Java RabbitMQ client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3218">[ date ]</a>
              <a href="thread.html#3218">[ thread ]</a>
              <a href="subject.html#3218">[ subject ]</a>
              <a href="author.html#3218">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
