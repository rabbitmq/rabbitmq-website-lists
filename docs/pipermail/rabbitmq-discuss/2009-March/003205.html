<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] txAMQP with RabbitMQ Cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20txAMQP%20with%20RabbitMQ%20Cluster&In-Reply-To=d272f0690903181524t67d0daecwe2fbb8e4bbdf3b7f%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003197.html">
   <LINK REL="Next"  HREF="003206.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] txAMQP with RabbitMQ Cluster</H1>
    <B>Esteve Fernandez</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20txAMQP%20with%20RabbitMQ%20Cluster&In-Reply-To=d272f0690903181524t67d0daecwe2fbb8e4bbdf3b7f%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] txAMQP with RabbitMQ Cluster">esteve at sindominio.net
       </A><BR>
    <I>Thu Mar 19 19:42:47 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003197.html">[rabbitmq-discuss] txAMQP with RabbitMQ Cluster
</A></li>
        <LI>Next message: <A HREF="003206.html">[rabbitmq-discuss] txAMQP with RabbitMQ Cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3205">[ date ]</a>
              <a href="thread.html#3205">[ thread ]</a>
              <a href="subject.html#3205">[ subject ]</a>
              <a href="author.html#3205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wednesday 18 March 2009 23:24:09 Alex Clemesha wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Can anyone who is using txAMQP (or the author, hi Esteve!) answer a
</I>&gt;<i> couple of client related questions?
</I>
Hi Alex :-)

&gt;<i> First, does txAMQP support the &quot;insist&quot; flag?
</I>&gt;<i> With py-amqplib, I can do:
</I>&gt;<i> conn = amqp.Connection(host=&quot;localhost:5672 &quot;, userid=&quot;guest&quot;,
</I>&gt;<i> password=&quot;guest&quot;, virtual_host=&quot;/&quot;, insist=True),
</I>&gt;<i> can the same be done with txAMPQ?  I've search around + looked in the
</I>&gt;<i> source, and haven't found how to yet.
</I>
It should, as long as you pass the standard AMQP spec. txAMQP generates all 
the AMQP structures on the fly, it reads the XML spec and creates the 
appropiate methods and classes thanks to Qpid, from which txAMQP is based 
off.

I've never used the insist option, but I think this should work:

@defer.inlineCallbacks
def func(client):
    channel0 = yield client.channel(0)
    response = yield channel0.connection_open(vhost=&quot;/&quot;, insist=True)

&gt;<i> Secondly, and this is where I'm a bit more lost (i.e, the problem may
</I>&gt;<i> or may not lie in the client),
</I>&gt;<i> can txAMQP handle redirects from brokers?
</I>
Not yet, but I think it wouldn't be very hard to implement it. Here's some 
pseudo untested python code:

@defer.inlineCallbacks
def func(client):
    channel0 = yield client.channel(0)
    response = yield channel0.connection_open(vhost=&quot;/&quot;, insist=True)
    if response == OPEN-OK: # I don't remember the actual fields for a 
response, sorry
        # do as usual
    elif response == &quot;redirect&quot;:
        yield channel0.connection_close() # close the current connection
        reactor.connectTCP(host=response.host,...) # create a connection to 
another broker using the standard Twisted methods

Sorry for being so imprecise, I'll try to add more details tomorrow. In any 
case, let me know if you need anything else.

Cheers.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003197.html">[rabbitmq-discuss] txAMQP with RabbitMQ Cluster
</A></li>
	<LI>Next message: <A HREF="003206.html">[rabbitmq-discuss] txAMQP with RabbitMQ Cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3205">[ date ]</a>
              <a href="thread.html#3205">[ thread ]</a>
              <a href="subject.html#3205">[ subject ]</a>
              <a href="author.html#3205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
