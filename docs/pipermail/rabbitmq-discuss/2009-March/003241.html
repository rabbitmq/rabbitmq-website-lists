<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] GPB and AMQP/RabbitMQ
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20GPB%20and%20AMQP/RabbitMQ&In-Reply-To=81df5590903251246l76b87001r34d42ae1a2ebd107%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003239.html">
   <LINK REL="Next"  HREF="003242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] GPB and AMQP/RabbitMQ</H1>
    <B>Elsner, Robert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20GPB%20and%20AMQP/RabbitMQ&In-Reply-To=81df5590903251246l76b87001r34d42ae1a2ebd107%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] GPB and AMQP/RabbitMQ">Robert.Elsner at echostar.com
       </A><BR>
    <I>Wed Mar 25 21:32:17 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003239.html">[rabbitmq-discuss] GPB and AMQP/RabbitMQ
</A></li>
        <LI>Next message: <A HREF="003242.html">[rabbitmq-discuss] GPB and AMQP/RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3241">[ date ]</a>
              <a href="thread.html#3241">[ thread ]</a>
              <a href="subject.html#3241">[ subject ]</a>
              <a href="author.html#3241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Kirk,

&gt;<i> Ignore my previous email. This thread is updating too fast 
</I>&gt;<i> for my old fingers to keep up. :-)
</I>
Luckily for me there is no ordering in SMTP, and I received that after
this one, for whatever reason. :)

&gt;<i> Interestingly, when GPB came out, ActiveMQ did this precise 
</I>&gt;<i> thing (to have a parallel wire protocol beyond the existing 
</I>&gt;<i> ones that was based on using GPB as the wire representation), 
</I>&gt;<i> and they said that it worked quite well. That being said, it 
</I>&gt;<i> definitely wouldn't work for AMQP given that it is designed 
</I>&gt;<i> as a completely neutral wire representation, but it might be 
</I>&gt;<i> useful for members of the WG to know that many people find 
</I>&gt;<i> the current wire encoding a bit too high-overhead.
</I>
I did not know ActiveMQ had that, very interesting.  The part I have
enjoyed the most about GPB is that the languages we use (C#, Java,
Erlang, C) have generated source, operate very similarly, and work
incredibly well.  GPB versus our current packet format adds a little
overhead, but the flexibility and extensibility far exceeds what we've
done thus far.  I know there are other libraries out there, do you know
if anyone has done anything similar with AMQP and the other formats?

I've looked over some of the AMQPWG posts and they do seem to have the
idea that the overhead can be a little bit extreme.  Perhaps a push from
the RabbitMQ team to help work this out would be beneficial.  Hopefully
some good things will come out of their next meeting.

&gt;<i> The problem I've personally always had with GPB in this case 
</I>&gt;<i> is that you still need to have some type of message 
</I>&gt;<i> termination encoding, or some type of prefix to let you know 
</I>&gt;<i> the size, as otherwise GPB will just consume data from the 
</I>&gt;<i> inbound stream. So GPB in and of itself would still need some 
</I>&gt;<i> other type of framing going on to say &quot;the next thing should 
</I>&gt;<i> be interpreted as per this .proto, and by the way, it's going 
</I>&gt;<i> to be 1024 bytes&quot; or something. How would you think of 
</I>&gt;<i> working around that?
</I>
Luckily that problem is currently handled by AMQP.  The general solution
I've seen is to prefix everything with the size of the protobuf message.
Of course if you start listening to a stream mid-message (for whatever
reason) you first have to synchronize to the messages.

I think if I was to go to GPB as a wireformat for AMQP, I would probably
wait until multicast udp/unicast udp support were added, and use the
datagram concept of UDP as the message delimiter.  This might be
beneficial for my use, but adds a higher workload for the brokers.

The one factor I don't like about GPB is that it isn't self-describing,
to really understand a message one needs the .proto or the code
generated from it.  For something like AMQP it might be more useful to
the community to pick a binary wireformat that encodes well, which also
self-describes its message.  

Rob


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003239.html">[rabbitmq-discuss] GPB and AMQP/RabbitMQ
</A></li>
	<LI>Next message: <A HREF="003242.html">[rabbitmq-discuss] GPB and AMQP/RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3241">[ date ]</a>
              <a href="thread.html#3241">[ thread ]</a>
              <a href="subject.html#3241">[ subject ]</a>
              <a href="author.html#3241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
