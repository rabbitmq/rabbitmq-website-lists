<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error compiling erlang client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Error%20compiling%20erlang%20client&In-Reply-To=44035.193.253.216.132.1259944314.squirrel%40mail1.webfaction.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005605.html">
   <LINK REL="Next"  HREF="005609.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error compiling erlang client</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Error%20compiling%20erlang%20client&In-Reply-To=44035.193.253.216.132.1259944314.squirrel%40mail1.webfaction.com"
       TITLE="[rabbitmq-discuss] Error compiling erlang client">matthew at lshift.net
       </A><BR>
    <I>Fri Dec  4 17:09:42 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005605.html">[rabbitmq-discuss] Error compiling erlang client
</A></li>
        <LI>Next message: <A HREF="005609.html">[rabbitmq-discuss] Error compiling erlang client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5606">[ date ]</a>
              <a href="thread.html#5606">[ thread ]</a>
              <a href="subject.html#5606">[ subject ]</a>
              <a href="author.html#5606">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Sylvian,

On Fri, Dec 04, 2009 at 05:31:54PM +0100, Sylvain Hellegouarch wrote:
&gt;<i> ERL_LIBS=deps:dist: erlc -I include -o ebin -Wall -v +debug_info 
</I>&gt;<i> src/amqp_channel.erl
</I>&gt;<i> {error_logger,{{2009,12,4},{16,28,36}},&quot;~s~n&quot;,[&quot;Error in process &lt;0.11.0&gt;
</I>&gt;<i> with exit value:
</I>&gt;<i> {{badmatch,error},[{code_server,get_user_lib_dirs_1,1},{code_server,get_user_lib_dirs_1,1},{code_server,init,3}]}\n&quot;]}
</I>&gt;<i> 
</I>&gt;<i> I'm using R12b3 so perhaps it doesn't support that version (Debian Lenny).
</I>
Diffing R12B3 with R13B01 on code_server reveals:

108,112c116,124
&lt;     {ok, Dirs} = erl_prim_loader:list_dir(Dir),
&lt;     {Paths,_Libs} = make_path(Dir, Dirs),
&lt;     %% Only add paths trailing with ./ebin.
&lt;     [P || P &lt;- Paths, filename:basename(P) =:= &quot;ebin&quot;] ++
&lt;       get_user_lib_dirs_1(DirList);
---
&gt;<i>     case erl_prim_loader:list_dir(Dir) of
</I>&gt;<i>       {ok, Dirs} -&gt;
</I>&gt;<i>           {Paths,_Libs} = make_path(Dir, Dirs),
</I>&gt;<i>           %% Only add paths trailing with ./ebin.
</I>&gt;<i>           [P || P &lt;- Paths, filename:basename(P) =:= &quot;ebin&quot;] ++
</I>&gt;<i>               get_user_lib_dirs_1(DirList);
</I>&gt;<i>       error -&gt;
</I>&gt;<i>           get_user_lib_dirs_1(DirList)
</I>&gt;<i>     end;
</I>
I.e. it was changed so that if it encounters an error, it just skips
onto the next element in the list.

My suspicion is it's upset about the trailing colon on the ERL_LIBS.
This is really a bug in the makefile that I introduced about a week ago
and have just fixed - please pull and try again.

If it still doesn't work do let us know. However, R12B03 is rather
ancient and whilst rabbit itself should work fine, other things like the
erlang client and the plugins may not work with such an old version of
Erlang - if you run into trouble, we'd recommend upgrading to a more
recent version of Erlang.

Best wishes,

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005605.html">[rabbitmq-discuss] Error compiling erlang client
</A></li>
	<LI>Next message: <A HREF="005609.html">[rabbitmq-discuss] Error compiling erlang client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5606">[ date ]</a>
              <a href="thread.html#5606">[ thread ]</a>
              <a href="subject.html#5606">[ subject ]</a>
              <a href="author.html#5606">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
