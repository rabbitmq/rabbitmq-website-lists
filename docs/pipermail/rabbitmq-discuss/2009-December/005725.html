<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] adjusting timeout for non-acked messages to	be requeued
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20adjusting%20timeout%20for%20non-acked%20messages%20to%0A%09be%20requeued&In-Reply-To=167204d20912291504h121bb51bob14a97af735d8d2b%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005722.html">
   <LINK REL="Next"  HREF="005723.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] adjusting timeout for non-acked messages to	be requeued</H1>
    <B>vishnu</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20adjusting%20timeout%20for%20non-acked%20messages%20to%0A%09be%20requeued&In-Reply-To=167204d20912291504h121bb51bob14a97af735d8d2b%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] adjusting timeout for non-acked messages to	be requeued">pathsny at gmail.com
       </A><BR>
    <I>Wed Dec 30 03:37:53 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005722.html">[rabbitmq-discuss] adjusting timeout for non-acked messages to	be requeued
</A></li>
        <LI>Next message: <A HREF="005723.html">[rabbitmq-discuss] .Net client foreground threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5725">[ date ]</a>
              <a href="thread.html#5725">[ thread ]</a>
              <a href="subject.html#5725">[ subject ]</a>
              <a href="author.html#5725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alexis
   thanks, I think Im getting a better understanding now. Initially I wanted
to look at auto requeueing for circumstances when my client subscribing to
events went down or got disconnected. Now my understanding is that in those
cases, messages get auto requeued.
    However, if I choose not to autoack, then it looks like the
responsibility of requeuing a client, forcing a time delay on the delivery
and also maybe forcing a limit on the number of passes through the queue is
going to have to become subscriber responsibility. I was hoping to handle
that as a configuration on the queue itself outside of code, but I guess
that isn't possible.

(the use case we have requires us to make sure that every message is
processed as far as possible. Meaning actual failures and successes are sent
onward, but failures for technical reasons require us to try again later, by
which time the technical issue might have been resolved).

Im taking a look now at the task management systems now.

Please do describe the other ways of forcing a requeue, I'd love to know
what my options are.

On Wed, Dec 30, 2009 at 4:34 AM, Alexis Richardson &lt;
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>&gt; wrote:

&gt;<i> Vishnu
</I>&gt;<i>
</I>&gt;<i> I am not the best person to answer this question, but I can tell you
</I>&gt;<i> that your behaviour can be achieved without requiring timers.
</I>&gt;<i>
</I>&gt;<i> Assuming you are unwilling to simply close the channel and force the
</I>&gt;<i> requeue, then:
</I>&gt;<i>
</I>&gt;<i> 1. You could explicitly requeue by re-publishing the message.  No need
</I>&gt;<i> to use acks here.
</I>&gt;<i>
</I>&gt;<i> 2. You could look at what one of the many task management systems do.
</I>&gt;<i> For example celery or quebert.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://ask.github.com/celery/introduction.html">http://ask.github.com/celery/introduction.html</A>
</I>&gt;<i> <A HREF="http://bytebucket.org/adroll/quebert/">http://bytebucket.org/adroll/quebert/</A>
</I>&gt;<i>
</I>&gt;<i> Or look at the list here:
</I>&gt;<i> <A HREF="http://delicious.com/alexisrichardson/rabbitmq+work">http://delicious.com/alexisrichardson/rabbitmq+work</A>
</I>&gt;<i>
</I>&gt;<i> 3. Other ways to force a requeue.  I am not going to try and describe
</I>&gt;<i> these yet, in case I say something misleading.
</I>&gt;<i>
</I>&gt;<i> Let me know what you think.
</I>&gt;<i>
</I>&gt;<i> alexis
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, Dec 29, 2009 at 8:34 PM, vishnu &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pathsny at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Adding back to the list, sorry stupid email client.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; would anyone know how this decision is made? When unacked messages get
</I>&gt;<i> &gt; requeued to be sent? I know it happens if the client disconnects, but
</I>&gt;<i> does
</I>&gt;<i> &gt; it also happen on rollback?
</I>&gt;<i> &gt; Im trying to setup a system whereby if my subscriber picks up an item
</I>&gt;<i> from
</I>&gt;<i> &gt; the queue and for some reason is unable to handle it, the item gets
</I>&gt;<i> readded
</I>&gt;<i> &gt; to the queue
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Tue, Dec 29, 2009 at 8:36 PM, Alexis Richardson
</I>&gt;<i> &gt; &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Vishnu
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On Tue, Dec 29, 2009 at 2:57 PM, vishnu &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pathsny at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt; hi, sorry Im a bit confused. But the behavior of moving the message
</I>&gt;<i> from
</I>&gt;<i> &gt;&gt; &gt; the
</I>&gt;<i> &gt;&gt; &gt; unacknowledge queue to the ready queue is already a part of rabbitmq.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; In what way?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; There
</I>&gt;<i> &gt;&gt; &gt; must be some magic constant somewhere which governs this musn't there?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If there were then it need not be time-based.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; alexis
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; On Tue, Dec 29, 2009 at 7:18 PM, Alexis Richardson
</I>&gt;<i> &gt;&gt; &gt; &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Vishnu
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; On Tue, Dec 29, 2009 at 4:37 AM, vishnu &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pathsny at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; Hi
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;     I'm trying to use rabbitmq for an web application thats close
</I>&gt;<i> to
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; synchronous. The main reason I'm looking at rabbitmq is for the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; reliability
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; and transactionality. The idea is for the webapplication to pump
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; messages
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; into the queue and for a down stream application to subscribe in
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; acknowledgement mode and for each message start a transaction,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; attempt
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; to
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; process the message and if it fails for technical reasons, to
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; rollback
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; transaction.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; OK.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; However, I would like to be able to configure the time for
</I>&gt;<i> non-acked
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; messages to get requeued to be picked up. Where can this be done?
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; This and other 'time based' behaviours are frequently requested, but
</I>&gt;<i> &gt;&gt; &gt;&gt; *alas* are not yet built-in to RabbitMQ.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; However, don't give up.  You could create a consumer (in any
</I>&gt;<i> language)
</I>&gt;<i> &gt;&gt; &gt;&gt; which managed this for you, eg enforcing a disconnect after some time
</I>&gt;<i> &gt;&gt; &gt;&gt; has passed.  Or, if you are feeling brave you could create a plugin
</I>&gt;<i> to
</I>&gt;<i> &gt;&gt; &gt;&gt; do this 'inside the broker'.  Plugins have to be written in erlang.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; I hope that helps.  Perhaps the list will have more immediately
</I>&gt;<i> useful
</I>&gt;<i> &gt;&gt; &gt;&gt; suggestions.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Cheers,
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; alexis
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; thanks
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; Vishnu
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/f0a4464a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/f0a4464a/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005722.html">[rabbitmq-discuss] adjusting timeout for non-acked messages to	be requeued
</A></li>
	<LI>Next message: <A HREF="005723.html">[rabbitmq-discuss] .Net client foreground threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5725">[ date ]</a>
              <a href="thread.html#5725">[ thread ]</a>
              <a href="subject.html#5725">[ subject ]</a>
              <a href="author.html#5725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
