<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Scheduling algorithms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Scheduling%20algorithms&In-Reply-To=4B3496F6.5090301%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005707.html">
   <LINK REL="Next"  HREF="005709.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Scheduling algorithms</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Scheduling%20algorithms&In-Reply-To=4B3496F6.5090301%40gmail.com"
       TITLE="[rabbitmq-discuss] Scheduling algorithms">matthew at lshift.net
       </A><BR>
    <I>Sat Dec 26 11:37:47 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005707.html">[rabbitmq-discuss] Scheduling algorithms
</A></li>
        <LI>Next message: <A HREF="005709.html">[rabbitmq-discuss] Scheduling algorithms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5708">[ date ]</a>
              <a href="thread.html#5708">[ thread ]</a>
              <a href="subject.html#5708">[ subject ]</a>
              <a href="author.html#5708">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Dragan,

On Fri, Dec 25, 2009 at 11:41:58AM +0100, Dragan Zubac wrote:
&gt;<i> There are processes A,B and C that insert messages into RabbitMQ.
</I>&gt;<i> All this messages should reach point D.
</I>
Right, so you have one exchange, and one queue, and you have D
consuming from that queue, and you have A, B and C publishing to the
exchange to which the queue is bound.

&gt;<i> If A,B and C insert various number of messages into RabbitMQ,what
</I>&gt;<i> algorithms will RMQ use to deliver those messages to D ?
</I>
Delivery order is not defined except for messages from a single
publisher.

&gt;<i> Examples :
</I>&gt;<i> 
</I>&gt;<i> A inserts 100 messages
</I>&gt;<i> B inserts 100 messages
</I>&gt;<i> C inserts 100 messages
</I>
What, in parallel? Sequentially? Interleaved? In Rabbit, within a
one-node cluster, order is only determined once the message gets to the
queue. The exchange is a passive entity and can be used in parallel by
several channels.

&gt;<i> Will RMQ send all messages toward D in round-robin fashion or the
</I>&gt;<i> delivery order will be undermined ? Or maybe in some other fashion ?
</I>
Once the messages are in the queue, they are delivered round-robin to
the consumers (with certain caveats). But in your case, you only have
one consumer so this doesn't affect you.

&gt;<i>From your terminology, I suspect you're thinking in a JMS-style way. You
</I>may wish to read some of the introductions to AMQP.

&gt;<i> A inserts 100 messages
</I>&gt;<i> B inserts 100 messages
</I>&gt;<i> C inserts 1000 messages
</I>&gt;<i> 
</I>&gt;<i> What mechanisms one might have to deliver all this messages to D in
</I>&gt;<i> desired fashion ? Somebody would like to deliver them in round-robin
</I>&gt;<i> fashion (send 1 A's message,send 1 B's message,send 1 C's
</I>&gt;<i> message),others might want to give higher priority to C's messages
</I>&gt;<i> or so (example : send 10 A's messages,send 10 B's messages,send 100
</I>&gt;<i> C's messages),or some other model of delivery that business model
</I>&gt;<i> could desire ?
</I>
In AMQP, you never ever know to whom you're sending a message. You
publish a message to an exchange. After that, the publisher has (almost)
no idea what happens to the message. This is by design.

If, in the queue, you have A's 100 messages at the start, then B's 100
messages, then C's 1000 messages at the end, then that's the order
they'll come out in. You can't alter that. Also, Rabbit doesn't yet
implement message priorities.

What you could do instead, is to have A, B and C publish in such a way
that their messages get routed to three different queues. Then D can
consume from those queues as it wants - if it just wants all of A's
messages, it can just consume from that, and if it wants to force
round-robin, then by setting QoS prefetch count to 1, and careful use of
acking, it can consume from all three queues in a round robin manner.

Best wishes,

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005707.html">[rabbitmq-discuss] Scheduling algorithms
</A></li>
	<LI>Next message: <A HREF="005709.html">[rabbitmq-discuss] Scheduling algorithms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5708">[ date ]</a>
              <a href="thread.html#5708">[ thread ]</a>
              <a href="subject.html#5708">[ subject ]</a>
              <a href="author.html#5708">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
