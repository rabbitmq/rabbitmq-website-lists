<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Reliable way to get number of messages in a	queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Reliable%20way%20to%20get%20number%20of%20messages%20in%20a%0A%09queue&In-Reply-To=4AE21B80.7080607%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005499.html">
   <LINK REL="Next"  HREF="005473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Reliable way to get number of messages in a	queue</H1>
    <B>Michael Nacos</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Reliable%20way%20to%20get%20number%20of%20messages%20in%20a%0A%09queue&In-Reply-To=4AE21B80.7080607%40lshift.net"
       TITLE="[rabbitmq-discuss] Reliable way to get number of messages in a	queue">m.nacos at gmail.com
       </A><BR>
    <I>Wed Nov 18 16:58:43 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005499.html">[rabbitmq-discuss] channel limits
</A></li>
        <LI>Next message: <A HREF="005473.html">[rabbitmq-discuss] Reliable way to get number of messages in a queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5472">[ date ]</a>
              <a href="thread.html#5472">[ thread ]</a>
              <a href="subject.html#5472">[ subject ]</a>
              <a href="author.html#5472">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,

I know there is nothing in the protocol supporting book-keeping information
such as queue lengths etc.
However, basic get ok returns a message count which is more or less correct,
except when consumers are
still attached to the queue (there's no connection closing until the very
end of the experiment, we are reusing
a few connections). I have been using rabbitmqctl to check to the queue
lengths and according to rabbitmqctl
the consumer processes do not keep up with the message generation rate but
the external poller process gets
a message count of zero. As soon as the consumers disconnect, message count
reports the right number of
unhandled messages again.

Is this something that you have seen before/would expect? My polling
strategy is: consume a single message
from a queue with no_ack=false, read the message count, send no ack and
disconnect.

regards, Michael
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091118/cf226472/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091118/cf226472/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005499.html">[rabbitmq-discuss] channel limits
</A></li>
	<LI>Next message: <A HREF="005473.html">[rabbitmq-discuss] Reliable way to get number of messages in a queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5472">[ date ]</a>
              <a href="thread.html#5472">[ thread ]</a>
              <a href="subject.html#5472">[ subject ]</a>
              <a href="author.html#5472">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
