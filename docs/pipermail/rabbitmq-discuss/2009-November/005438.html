<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit-MQ crashing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Rabbit-MQ%20crashing&In-Reply-To=4ece5be60911100944y696030e9ga2ba6d153d0c19b6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005413.html">
   <LINK REL="Next"  HREF="005423.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit-MQ crashing</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Rabbit-MQ%20crashing&In-Reply-To=4ece5be60911100944y696030e9ga2ba6d153d0c19b6%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Rabbit-MQ crashing">tonyg at lshift.net
       </A><BR>
    <I>Thu Nov 12 14:25:55 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005413.html">[rabbitmq-discuss] Rabbit-MQ crashing
</A></li>
        <LI>Next message: <A HREF="005423.html">[rabbitmq-discuss] connection/channel pooling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5438">[ date ]</a>
              <a href="thread.html#5438">[ thread ]</a>
              <a href="subject.html#5438">[ subject ]</a>
              <a href="author.html#5438">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Derek,

(Replying here as well for the archive)

Derek Burdick wrote:
&gt;<i> I have a durable, fanout exchange and queue.  I post persistent messages
</I>&gt;<i> to the exchange.  After sending messages for some time, the ERL process
</I>&gt;<i> stops and I can not restart RabbitMQ without deleting the contents of
</I>&gt;<i> the Database.  Here is the log from startup:
</I>&gt;<i> [...]
</I>&gt;<i>                               {{{badmatch,eof},
</I>&gt;<i> [{rabbit_persister,internal_load_snapshot,2},
</I>&gt;<i> [...]
</I>
RabbitMQ has become overfull, and crashed during persister log rollover
as a result. You probably have a zero-byte-long rabbit_persister.LOG,
and a large rabbit_persister.LOG.previous. Make a backup of the
.previous file somewhere else, just in case, and then copy it over top
of the rabbit_persister.LOG file and start the broker. You shouldn't
need to delete the whole database.

We're working on fixing the underlying cause, but for now, you must not
store more messages than (some proportion of) your available RAM can
hold. If you are simply buffering things without trying to consume them,
then you will probably need to introduce some consumers of some kind :-)
and if you do have consumers running, but Rabbit is running out of
memory anyway, you should probably check that you are acknowledging
deliveries from the broker properly.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] <A HREF="http://www.lshift.net/">http://www.lshift.net/</A> | Email: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005413.html">[rabbitmq-discuss] Rabbit-MQ crashing
</A></li>
	<LI>Next message: <A HREF="005423.html">[rabbitmq-discuss] connection/channel pooling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5438">[ date ]</a>
              <a href="thread.html#5438">[ thread ]</a>
              <a href="subject.html#5438">[ subject ]</a>
              <a href="author.html#5438">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
