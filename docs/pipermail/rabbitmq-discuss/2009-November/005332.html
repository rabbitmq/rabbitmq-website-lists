<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] intermittent erl.exe crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20intermittent%20erl.exe%20crash&In-Reply-To=4AF31241.1040203%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005331.html">
   <LINK REL="Next"  HREF="005333.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] intermittent erl.exe crash</H1>
    <B>JD Conley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20intermittent%20erl.exe%20crash&In-Reply-To=4AF31241.1040203%40lshift.net"
       TITLE="[rabbitmq-discuss] intermittent erl.exe crash">jdc at hive7.com
       </A><BR>
    <I>Thu Nov  5 18:40:10 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005331.html">[rabbitmq-discuss] intermittent erl.exe crash
</A></li>
        <LI>Next message: <A HREF="005333.html">[rabbitmq-discuss] intermittent erl.exe crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5332">[ date ]</a>
              <a href="thread.html#5332">[ thread ]</a>
              <a href="subject.html#5332">[ subject ]</a>
              <a href="author.html#5332">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Why are your clients trying to unbind non-existing bindings?
</I>
They don't know the bindings are non-existent since the queues/exchange in
question aren't durable and, say, a server might crash and restart. A client
created a binding, then some time went by and it was time to remove the
binding, probably by a different client, that maybe wasn't connected yet and
doesn't know the binding was destroyed. There is a web farm with long
running connections/sessions to the Rabbitmq cluster.

I'm using this as a message passing system for a web application written
using the official .NET client. I have a Fanout exchange and a queue per
user session. Sort of like a chat room, when a user 'joins' her queue is
bound to the routing key for that 'room'. Users are long polling my web app,
which is doing a BasicConsume through a shared EventingBasicConsumer during
the 60 second polling period, and a BasicCancel when the poll is completed.
I persist the list of currently bound routing keys in a database and a
binding will usually last a few minutes before it is unbound. There is a
background cleanup process that runs and removes bindings and destroys
queues after users haven't polled in a while.

If there's a better way to do something like this, I'm open to suggestion.
:<i>)
</I>
&gt;<i> The AMQP spec requires that this results in an error.
</I>
That's fine, but that doesn't seem critical enough for the connection to
have to drop. As a newcomer in the space, it's ironic to me that I can
declare duplicate queues and exchanges without any errors but not silently
remove a binding that doesn't exist. It would be great if it were an option
to behave like the .NET generic Dictionary that returns 'true' on remove if
there was actually something there, or silently ignores the call and returns
'false' if not. Is there a DoesBindingExist method I can use to do things
cleanly today? I didn't see one.

&gt;<i> &gt;&gt; Is there anything in the sasl log?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; No. It's using guest only.
</I>&gt;<i> 
</I>&gt;<i> I mean the rabbit-sasl.log; &quot;SASL&quot; in this case stands for Erlang's
</I>&gt;<i> &quot;System Architecture Support Libraries&quot; - nothing to do with
</I>&gt;<i> authentication.
</I>
Hah! Oops. Too much network protocol background in my past. The answer is
the same, even without the part of me looking like an idiot. The log is
empty.

-JD



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005331.html">[rabbitmq-discuss] intermittent erl.exe crash
</A></li>
	<LI>Next message: <A HREF="005333.html">[rabbitmq-discuss] intermittent erl.exe crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5332">[ date ]</a>
              <a href="thread.html#5332">[ thread ]</a>
              <a href="subject.html#5332">[ subject ]</a>
              <a href="author.html#5332">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
