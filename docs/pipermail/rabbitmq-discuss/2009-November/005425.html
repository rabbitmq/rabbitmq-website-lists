<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] connection/channel pooling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20connection/channel%20pooling&In-Reply-To=4AFA0B05.80708%40gojko.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005423.html">
   <LINK REL="Next"  HREF="005429.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] connection/channel pooling</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20connection/channel%20pooling&In-Reply-To=4AFA0B05.80708%40gojko.com"
       TITLE="[rabbitmq-discuss] connection/channel pooling">matthew at lshift.net
       </A><BR>
    <I>Wed Nov 11 11:49:33 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005423.html">[rabbitmq-discuss] connection/channel pooling
</A></li>
        <LI>Next message: <A HREF="005429.html">[rabbitmq-discuss] rabbitmq vs qpid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5425">[ date ]</a>
              <a href="thread.html#5425">[ thread ]</a>
              <a href="subject.html#5425">[ subject ]</a>
              <a href="author.html#5425">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On Wed, Nov 11, 2009 at 12:53:25AM +0000, Gojko Adzic wrote:
&gt;<i> a connection can be cached and shared but channels should be 
</I>&gt;<i> thread-local. For the purpose of improving throughput, does it make 
</I>&gt;<i> sense to create a pool of channels or is there no penalty in opening and 
</I>&gt;<i> closing channel for every message sent?
</I>
Opening a channel takes some client side and server side resources. If
you are able to use a pool of channels and reuse them then yes, that
would be a better solution to creating endless fresh channels.

&gt;<i> Also, does multi-threaded 
</I>&gt;<i> posting through channels belonging to a single connection cause 
</I>&gt;<i> contention on the same socket? What's the best practice for throughput - 
</I>&gt;<i> should I have a number of connections open to post messages and then 
</I>&gt;<i> allocate several channels per connection, or is this an overkill?
</I>
There will be contention - at the end of the day, the kernel must
serialise writes to the socket. One can certainly over supply the kernel
with data to write from a single thread, let alone several threads. I
would suggest that you start with the simple thing - use one connection
- and see if that's enough for you. Don't forget premature optimization
is the root of all evil!

With something like Rabbit, it's so flexible and can be configured in
so many different ways that we can't really write extensive &quot;best
practises&quot; because with just a few small differences in the setup, they
may very well cease to be &quot;best&quot;. Thus we would always recommend that
you test and benchmark yourself and then make decisions based on what
you see is happening for you.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005423.html">[rabbitmq-discuss] connection/channel pooling
</A></li>
	<LI>Next message: <A HREF="005429.html">[rabbitmq-discuss] rabbitmq vs qpid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5425">[ date ]</a>
              <a href="thread.html#5425">[ thread ]</a>
              <a href="subject.html#5425">[ subject ]</a>
              <a href="author.html#5425">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
