<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Reliable way to get number of messages in a queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Reliable%20way%20to%20get%20number%20of%20messages%20in%20a%0A%20queue&In-Reply-To=20091118171853.GB27828%40mrnibble.lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005473.html">
   <LINK REL="Next"  HREF="005477.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Reliable way to get number of messages in a queue</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Reliable%20way%20to%20get%20number%20of%20messages%20in%20a%0A%20queue&In-Reply-To=20091118171853.GB27828%40mrnibble.lshift.net"
       TITLE="[rabbitmq-discuss] Reliable way to get number of messages in a queue">matthew at lshift.net
       </A><BR>
    <I>Wed Nov 18 17:52:06 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005473.html">[rabbitmq-discuss] Reliable way to get number of messages in a queue
</A></li>
        <LI>Next message: <A HREF="005477.html">[rabbitmq-discuss] Reliable way to get number of messages in a	queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5476">[ date ]</a>
              <a href="thread.html#5476">[ thread ]</a>
              <a href="subject.html#5476">[ subject ]</a>
              <a href="author.html#5476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Nov 18, 2009 at 05:18:53PM +0000, Matthew Sackman wrote:
&gt;<i> That's odd. However, you're really much much better off using
</I>&gt;<i> queue.declare to redeclare the existing queue - the declare-ok that you
</I>&gt;<i> get back contains the number of messages in the queue. This is a much
</I>&gt;<i> neater strategy than below. I would recommend you switch to using this
</I>&gt;<i> and repeat your test.
</I>
What's actually wrong with what you were doing is that the rabbitmqctl
list_queues contains both the ready messages and the unack'd msgs (as
well as uncommitted msgs). Thus if your consumers aren't acking msgs
quickly enough (and have an unbounded qos setting) then it will appear
that they're not keeping up. Use:

rabbitmqctl list_queues name messages_ready messages_unacknowledged

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005473.html">[rabbitmq-discuss] Reliable way to get number of messages in a queue
</A></li>
	<LI>Next message: <A HREF="005477.html">[rabbitmq-discuss] Reliable way to get number of messages in a	queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5476">[ date ]</a>
              <a href="thread.html#5476">[ thread ]</a>
              <a href="subject.html#5476">[ subject ]</a>
              <a href="author.html#5476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
