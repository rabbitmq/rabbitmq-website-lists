<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ persistence and multi producers- multi consumers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20persistence%20and%20multi%20producers-%0A%20multi%20consumers&In-Reply-To=%3C4C370E82.8090208%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007915.html">
   <LINK REL="Next"  HREF="007943.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ persistence and multi producers- multi consumers</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20persistence%20and%20multi%20producers-%0A%20multi%20consumers&In-Reply-To=%3C4C370E82.8090208%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ persistence and multi producers- multi consumers">simon at rabbitmq.com
       </A><BR>
    <I>Fri Jul  9 12:56:50 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007915.html">[rabbitmq-discuss] RabbitMQ persistence and multi producers-	multi consumers
</A></li>
        <LI>Next message: <A HREF="007943.html">[rabbitmq-discuss] RabbitMQ persistence and multi producers- multi consumers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7916">[ date ]</a>
              <a href="thread.html#7916">[ thread ]</a>
              <a href="subject.html#7916">[ subject ]</a>
              <a href="author.html#7916">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/07/10 12:49, Francisco Gonzalez-Blanch wrote:
&gt;<i> Thanks for the answers!  But If the producer is launched first and then
</I>&gt;<i> the consumer, i'm losing all the initial messages until the consumer is
</I>&gt;<i> created. I attach you the code snippets with the test.
</I>
I think contrary to what Andreas said, in your case you should have the 
producer create a queue with a well known name when it starts up, which 
the consumer can connect to. ATM with your code no queue exists until a 
consumer creates it, so all messages before that point are dropped.

&lt;code snipped&gt;

&gt;<i> In addition i have another question , is it possible to make that not
</I>&gt;<i> all the consumers get all the messages  with a fanout exchange, i mean
</I>&gt;<i> is it possible to balance the messages in between the consumers. Thanks
</I>&gt;<i> a lot. regards!
</I>
If each consumer creates its own queue, each consumer will get all the 
messages.

If each consumer connects to the same queue, the messages will be 
balanced among the consumers.

NB this balancing will not be very fair if the consumers connect to a 
preexisting queue with a bunch of messages, unless you set the prefetch 
count using basic.qos. Once the existing messages are drained and the 
queue is empty it will round-robin subsequent messages.

Cheers, Simon
&gt;<i>
</I>&gt;<i> Francisco Gonz&#225;lez-Blanch Rodr&#237;guez
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Jul 9, 2010 at 1:39 PM, Ovidiu Deac &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ovidiudeac at gmail.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ovidiudeac at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     If nobody extracts the message from the queue the message won't be lost.
</I>&gt;<i>
</I>&gt;<i>     On Fri, Jul 9, 2010 at 1:09 PM, Francisco Gonzalez-Blanch
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">fblanch at gmail.com</A> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">fblanch at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i>      &gt; Hi all,
</I>&gt;<i>      &gt; I'm a newbie in rabbitmq and i'm working on a distributed data
</I>&gt;<i>     processing
</I>&gt;<i>      &gt; application using rabbitmq as distributed task queue. I want to
</I>&gt;<i>     ask you
</I>&gt;<i>      &gt; about where can i find information about how to make persistent
</I>&gt;<i>     queues, and
</I>&gt;<i>      &gt; how to make that, if a producer sends messages to queue and no
</I>&gt;<i>     one is listen
</I>&gt;<i>      &gt; to it and then a consumer is attached , the consumer gets all the
</I>&gt;<i>     messages,
</I>&gt;<i>      &gt; even the ones that were produced before the consumer was
</I>&gt;<i>     attached. Thank you
</I>&gt;<i>      &gt; very much.
</I>&gt;<i>      &gt;
</I>&gt;<i>      &gt;
</I>&gt;<i>      &gt;
</I>&gt;<i>      &gt; _______________________________________________
</I>&gt;<i>      &gt; rabbitmq-discuss mailing list
</I>&gt;<i>      &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>      &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>      &gt;
</I>&gt;<i>      &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
Staff Engineer, RabbitMQ
SpringSource, a division of VMware

</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007915.html">[rabbitmq-discuss] RabbitMQ persistence and multi producers-	multi consumers
</A></li>
	<LI>Next message: <A HREF="007943.html">[rabbitmq-discuss] RabbitMQ persistence and multi producers- multi consumers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7916">[ date ]</a>
              <a href="thread.html#7916">[ thread ]</a>
              <a href="subject.html#7916">[ subject ]</a>
              <a href="author.html#7916">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
