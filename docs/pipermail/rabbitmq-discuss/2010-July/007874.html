<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] ssl certificate to client lookup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20ssl%20certificate%20to%20client%20lookup&In-Reply-To=%3C4C32E467.8040401%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007873.html">
   <LINK REL="Next"  HREF="007876.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] ssl certificate to client lookup</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20ssl%20certificate%20to%20client%20lookup&In-Reply-To=%3C4C32E467.8040401%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] ssl certificate to client lookup">matthias at rabbitmq.com
       </A><BR>
    <I>Tue Jul  6 09:08:07 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007873.html">[rabbitmq-discuss] ssl certificate to client lookup
</A></li>
        <LI>Next message: <A HREF="007876.html">[rabbitmq-discuss] ssl certificate to client lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7874">[ date ]</a>
              <a href="thread.html#7874">[ thread ]</a>
              <a href="subject.html#7874">[ subject ]</a>
              <a href="author.html#7874">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Lionel,

Lionel Cons wrote:
&gt;<i> ActiveMQ has it: <A HREF="http://activemq.apache.org/jmsxuserid.html.">http://activemq.apache.org/jmsxuserid.html.</A>
</I>
...and AMQP 0-8/9/9-1 has the user-id basic content property. Alas it 
has no defined semantics.

&gt;<i>  &gt; - How do consumers establish sufficient trust into the server (to supply 
</I>&gt;<i>  &gt; the correct information)?
</I>&gt;<i> 
</I>&gt;<i> They have no choice: a broker is by definition a trusted entity. For
</I>&gt;<i> instance, consumers expect brokers to deliver message bodies unaltered.
</I>
There are messaging scenarios where the broker cannot be trusted 
sufficiently. Imagine your bank communicating with another bank over a 
public AMQP server. Standard crypto techniques at the end points, opaque 
to the broker, work in that setup.

What we are looking at here is something different: systems where apps 
*do* trust the broker and want manifestations of that trust, such as 
identities of authenticated users, to be reflected into the messaging world.

&gt;<i>  &gt; - How do producers establish sufficient trust into the server (to not 
</I>&gt;<i>  &gt; pass on information about their identity when they do not intent to, to 
</I>&gt;<i>  &gt; not fake such information, etc)?
</I>&gt;<i> 
</I>&gt;<i> Idem. Producers already trust the brokers, for instance to deliver the
</I>&gt;<i> messages to the right consumers. For the &quot;information about their
</I>&gt;<i> identity&quot;, if this may be a concern, it would be easy to have a broker
</I>&gt;<i> flag specifying whether authentication information is passed or not.
</I>
I don't think a broker flag is enough here. Step outside the enterprise 
world and consider a public AMQP messaging service. I can envisage cases 
where the sender will want to control whether its identity is revealed 
to consumers. Much like it tells the broker whether the message should 
be persisted.

&gt;<i>  &gt; - How does one deal with proxies/shovels, i.e. entities that relay 
</I>&gt;<i>  &gt; information? Do messages passing through them have their original sender 
</I>&gt;<i>  &gt; info replaced? Or does the proxy/shovel identity get appended somehow?
</I>&gt;<i> 
</I>&gt;<i> This is a very good question.
</I>&gt;<i> 
</I>&gt;<i> I've worked on a very simple model with boolean trust. Either the
</I>&gt;<i> sender of the message (this could be a shovel) is trusted or it is
</I>&gt;<i> not.
</I>
What distinguishes a trusted sender from an untrusted sender?

&gt;<i>  - if it is trusted, the broker accepts authentication information as
</I>&gt;<i>    provided by the sender and simply appends what it knows, i.e. the
</I>&gt;<i>    identity of the sender
</I>
So in a hypothetical scenario where
1) sender authenticates with broker X as user A and sends message
2) proxy authenticates with broker X as user B and consumes message
3) proxy authenticates with broker Y as user C and sends the consumed 
message
4) consumer authenticates with broker Y as user D and consumes message

what sender identity information ends up in the message sent to the 
final consumer? It seems to me that if the consumer is interested in the 
identity of the original sender it needs to trust broker Y - let's take 
that as a given - as well as the proxy and broker X. How can it 
establish that trust, since it's not directly interacting with either of 
them? Furthermore, the identity with which user A authenticates to 
broker X may be completely meaningless to the one the consumer.

This conflation of application level identities with broker 
authentication identities is problematic.

One analogy is authenticated smtp. When I send a message to an SMTP 
server that requires authentication, the identity I supply is usually 
meaningless outside the administrative domain of that server.

&gt;<i> AFAIK, AMQP 1.0 has two different things (I hope the terminology is right):
</I>&gt;<i>  - the bare message, with properties
</I>&gt;<i>  - the annotated, with extra header and footer
</I>
In AMQP 0-8/9/9-1 there is just one set of properties/headers. 
basic.deliver and basic.get-ok contain additional information, such as 
the exchange to which the message was published and the routing key, but 
that is not extensible.


Regards,

Matthias.
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007873.html">[rabbitmq-discuss] ssl certificate to client lookup
</A></li>
	<LI>Next message: <A HREF="007876.html">[rabbitmq-discuss] ssl certificate to client lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7874">[ date ]</a>
              <a href="thread.html#7874">[ thread ]</a>
              <a href="subject.html#7874">[ subject ]</a>
              <a href="author.html#7874">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
