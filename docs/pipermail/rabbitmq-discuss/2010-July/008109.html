<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Newbie question: How to listen for a certain	message content ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Newbie%20question%3A%20How%20to%20listen%20for%20a%20certain%0A%09message%20content%20%3F&In-Reply-To=%3Cyrv4cbpa0jxtk.fsf%40dwragg.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008104.html">
   <LINK REL="Next"  HREF="008106.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Newbie question: How to listen for a certain	message content ?</H1>
    <B>David Wragg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Newbie%20question%3A%20How%20to%20listen%20for%20a%20certain%0A%09message%20content%20%3F&In-Reply-To=%3Cyrv4cbpa0jxtk.fsf%40dwragg.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Newbie question: How to listen for a certain	message content ?">david at rabbitmq.com
       </A><BR>
    <I>Wed Jul 21 23:04:55 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008104.html">[rabbitmq-discuss] Newbie question: How to listen for a certain	message content ?
</A></li>
        <LI>Next message: <A HREF="008106.html">[rabbitmq-discuss] RabbitMQ production setup questions around	clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8109">[ date ]</a>
              <a href="thread.html#8109">[ thread ]</a>
              <a href="subject.html#8109">[ subject ]</a>
              <a href="author.html#8109">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Frank,

Frank G&#246;nninger &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">frank.goenninger at consequor.de</A>&gt; writes:
&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> being an old Tibco &quot;user&quot; (Tibco Rendezvous) I am looking for a way to
</I>&gt;<i> listen for a &quot;subject&quot; while not having to create separate queues for
</I>&gt;<i> each subject.
</I>&gt;<i>
</I>&gt;<i> I have event messages where I need to have always the same event
</I>&gt;<i> message structure and have different event classes. Is there a way to
</I>&gt;<i> not have queues like
</I>&gt;<i>
</I>&gt;<i> event.application.start
</I>&gt;<i> event.application.abort
</I>&gt;<i> event.application.shutdown
</I>&gt;<i> event.application.terminated
</I>&gt;<i>
</I>&gt;<i> etc et  but rather
</I>&gt;<i>
</I>&gt;<i> have one queue
</I>&gt;<i>
</I>&gt;<i> events
</I>&gt;<i>
</I>&gt;<i> with subjects
</I>&gt;<i>
</I>&gt;<i> application.start etc being part of the message...
</I>&gt;<i>
</I>&gt;<i> I only want my consumer to be awakened when the &quot;right&quot; message is
</I>&gt;<i> arriving ... Yeah, pubsub is it, but how to do this with RabbitMQ ?
</I>
The short answer is: using routing keys and a direct or topic exchange.

You ask about how to do this with only a single queue.  With AMQP, You
will need one queue for each consumer, because queues are explicit,
unlike in tibrv.  However, you don't need an exchange per subject.

One way to think of it, from a tibrv point of view, is that AMQP allows
many distinct subject namespaces, which are called exchanges.

So your application could work as follows:

- Declare a single direct exchange, which you might call &quot;events&quot;

- A publishing component publishes to the &quot;events&quot; exchange specifying a
  routing key, which might be &quot;application.start&quot;, &quot;application.stop&quot;,
  etc.  The routing key accompanies the message on its journey from the
  publisher to consumers.

- A consuming component declares a queue, and binds it to the exchange,
  with the binding key to specify which event type it is interested in.
  With a direct exchange, messages will be delivered to the consumer
  when its binding key matches the routing key under which the message
  was published.  You can bind the queue multiple times, with different
  binding keys, to subscribe to multiple event types.

The need to have each consumer declare a queue might seem like
unnecessary work.  But it is quite straightforward: If you declare with
an unspecified (i.e. empty) name, the server will automatically give the
queue a unique name.  And you can specify the &quot;exclusive&quot; flag for the
queue, so that it will automatically be deleted (along with its
bindings) when you close the connection.

By using a topic exchange, you can also reproduce the hierarchical
nature of tibrv subjects.  For example, if you declare &quot;events&quot; as a
topic exchange, a consumer could bind with a binding key like
&quot;application.*&quot; to subscribe to all application events.

David

-- 
David Wragg
Staff Engineer, RabbitMQ
SpringSource, a division of VMware
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008104.html">[rabbitmq-discuss] Newbie question: How to listen for a certain	message content ?
</A></li>
	<LI>Next message: <A HREF="008106.html">[rabbitmq-discuss] RabbitMQ production setup questions around	clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8109">[ date ]</a>
              <a href="thread.html#8109">[ thread ]</a>
              <a href="subject.html#8109">[ subject ]</a>
              <a href="author.html#8109">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
