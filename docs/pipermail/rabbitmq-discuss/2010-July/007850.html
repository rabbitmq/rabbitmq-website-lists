<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Integrating Pika into Tornado
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Integrating%20Pika%20into%20Tornado&In-Reply-To=%3CAANLkTinI-WPkY2z5Xo0OqXRulgMXDlbaMNfym-DcimN6%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007834.html">
   <LINK REL="Next"  HREF="007835.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Integrating Pika into Tornado</H1>
    <B>Marek Majkowski</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Integrating%20Pika%20into%20Tornado&In-Reply-To=%3CAANLkTinI-WPkY2z5Xo0OqXRulgMXDlbaMNfym-DcimN6%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Integrating Pika into Tornado">majek04 at gmail.com
       </A><BR>
    <I>Fri Jul  2 15:06:03 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007834.html">[rabbitmq-discuss] Integrating Pika into Tornado
</A></li>
        <LI>Next message: <A HREF="007835.html">[rabbitmq-discuss] chaining gateways via Java client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7850">[ date ]</a>
              <a href="thread.html#7850">[ thread ]</a>
              <a href="subject.html#7850">[ subject ]</a>
              <a href="author.html#7850">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrea,

Thanks for the code, it's pretty interesting.

1. Could you publish the code on github?
2. The meat is in client.py, but I don't really get it. Is it an
object that shares interface with connection.py/Connection?
3. AMQPClient.connect is still blocking, right?
4. for example in send_method, aren't you afraid that
self._stream.write() can fail to write all the data to the buffer?
5. I love the &quot;abc&quot; line in close() :)

I'm very much interested in getting something like that working!

Cheers,
  Marek Majkowski


On Thu, Jul 1, 2010 at 15:10, Andrea Corbellini
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">corbellini.andrea at gmail.com</A>&gt; wrote:
&gt;<i> Hello everybody,
</I>&gt;<i>
</I>&gt;<i> Recently I've started to work on a project to make Pika work with the
</I>&gt;<i> Tornado web server, and I would like receive some feedback from you
</I>&gt;<i> before proposing something for merging. The approach I've used
</I>&gt;<i> consists of making Pika more event-based. Since code is better that
</I>&gt;<i> words, I've attached what I've done so far (there's also a test
</I>&gt;<i> script). As you will see, I haven't touched Pika itself yet, instead
</I>&gt;<i> I've written a quick and dirty hack based on the library, rewriting
</I>&gt;<i> just the relevant parts.
</I>&gt;<i>
</I>&gt;<i> There are two main steps that needs to be done in order to have
</I>&gt;<i> something ready to land into the development mainline. First of all,
</I>&gt;<i> the `Connection` and `ChannelHandler` classes should be partially
</I>&gt;<i> rewritten in order to make them event-oriented. Then, the asyncore and
</I>&gt;<i> the blocking adapters needs to be rewritten in order to make them work
</I>&gt;<i> with the new code.
</I>&gt;<i>
</I>&gt;<i> The first step is easy: I've already done most of the work. The only
</I>&gt;<i> thing that should be done is to replace the calls to
</I>&gt;<i> IOStream.read_bytes() and IOStream.write() with two new functions that
</I>&gt;<i> should be overridden by the various adapters. Also, it'd be useful to
</I>&gt;<i> add a `callback` argument to methods such as `send_frame`,
</I>&gt;<i> `wait_for_open` and so on.
</I>&gt;<i>
</I>&gt;<i> The second step instead requires a bit more work. The things to do
</I>&gt;<i> are: make the current adapters more event-based and let them use the
</I>&gt;<i> two new functions.
</I>&gt;<i>
</I>&gt;<i> So, basically, the current flow:
</I>&gt;<i>
</I>&gt;<i> connect -&gt; drain_events() -&gt; handle frame
</I>&gt;<i>
</I>&gt;<i> will be changed in order to become:
</I>&gt;<i>
</I>&gt;<i> connect -&gt; [wait for data] -&gt; callback1 -&gt; [wait for data] -&gt; callback2 -&gt; ...
</I>&gt;<i>
</I>&gt;<i> where &quot;[wait for data]&quot; depends on the adapter (e.g.: the Tornado's
</I>&gt;<i> adapter will use IOLoop, the blocking adapter will read directly from
</I>&gt;<i> the socket).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> So, that's my propose. I'd happy to answer any of your questions and
</I>&gt;<i> to receive any feedback from you.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Andrea
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007834.html">[rabbitmq-discuss] Integrating Pika into Tornado
</A></li>
	<LI>Next message: <A HREF="007835.html">[rabbitmq-discuss] chaining gateways via Java client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7850">[ date ]</a>
              <a href="thread.html#7850">[ thread ]</a>
              <a href="subject.html#7850">[ subject ]</a>
              <a href="author.html#7850">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
