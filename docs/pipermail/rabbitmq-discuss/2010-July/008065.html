<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumers stopped consuming messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumers%20stopped%20consuming%20messages&In-Reply-To=%3C4C456BC8.3020705%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008063.html">
   <LINK REL="Next"  HREF="008067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumers stopped consuming messages</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumers%20stopped%20consuming%20messages&In-Reply-To=%3C4C456BC8.3020705%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Consumers stopped consuming messages">simon at rabbitmq.com
       </A><BR>
    <I>Tue Jul 20 10:26:32 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008063.html">[rabbitmq-discuss] Consumers stopped consuming messages
</A></li>
        <LI>Next message: <A HREF="008067.html">[rabbitmq-discuss] Disaster Recovery / Disaster tolerance Features
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8065">[ date ]</a>
              <a href="thread.html#8065">[ thread ]</a>
              <a href="subject.html#8065">[ subject ]</a>
              <a href="author.html#8065">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 20/07/10 09:55, Florence Chabanois wrote:
&lt;snip&gt;
&gt;<i> We noticed that /*sometimes*/, consumers hang (well, they are not
</I>&gt;<i> blocked, but they dont consume messages anymore). We can see that
</I>&gt;<i> because each consumer save around 100 msg/sec in database, so when one
</I>&gt;<i> is stopping consumming, the overall messages saved per seconds in DB
</I>&gt;<i> fall down with the same ratio (if let say 3 consumers stop, we fall
</I>&gt;<i> around 600 msg/sec to 300 msg/sec).
</I>&lt;snip&gt;
&gt;<i> FYI there has been a similar issue here, but it wasn't resolved :
</I>&gt;<i> <A HREF="http://old.nabble.com/Consumer-stop-to-receive-messages-but-continue-listening-queue-problem.-td27872888.html">http://old.nabble.com/Consumer-stop-to-receive-messages-but-continue-listening-queue-problem.-td27872888.html</A>
</I>
Hi Florence. One possibility that was considered in the linked thread 
was that all the messages were being sent to some consumers due to 
basic.qos not being set (in the absence of basic.qos, Rabbit is allowed 
to do that).

So:

* Are you setting the basic.qos prefetch count?
* What does rabbitmqctl lists_queues say about he queue when the system 
is in this state?
* Are you able to post your spike code anywhere?

Cheers, Simon

-- 
Simon MacMullen
Staff Engineer, RabbitMQ
SpringSource, a division of VMware

</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008063.html">[rabbitmq-discuss] Consumers stopped consuming messages
</A></li>
	<LI>Next message: <A HREF="008067.html">[rabbitmq-discuss] Disaster Recovery / Disaster tolerance Features
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8065">[ date ]</a>
              <a href="thread.html#8065">[ thread ]</a>
              <a href="subject.html#8065">[ subject ]</a>
              <a href="author.html#8065">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
