<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumers stopped consuming messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumers%20stopped%20consuming%20messages&In-Reply-To=%3C281503.55292.qm%40web26001.mail.ukl.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008066.html">
   <LINK REL="Next"  HREF="008065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumers stopped consuming messages</H1>
    <B>Florence Chabanois</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumers%20stopped%20consuming%20messages&In-Reply-To=%3C281503.55292.qm%40web26001.mail.ukl.yahoo.com%3E"
       TITLE="[rabbitmq-discuss] Consumers stopped consuming messages">flocha2000-agile at yahoo.fr
       </A><BR>
    <I>Tue Jul 20 09:55:30 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008066.html">[rabbitmq-discuss] Rabbitmq v. 1.8.1 - Bug report - Could not	start a node as RAM node in cluster
</A></li>
        <LI>Next message: <A HREF="008065.html">[rabbitmq-discuss] Consumers stopped consuming messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8063">[ date ]</a>
              <a href="thread.html#8063">[ thread ]</a>
              <a href="subject.html#8063">[ subject ]</a>
              <a href="author.html#8063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

                Hello list,


Our team is in a spike sprint to choose between ActiveMQ or RabbitMQ.
 We made 2 little producer/consumer spikes sending an object message 
with an array of 16 strings, a timestamp, and 2 integers. The spikes are
 ok on our devs machines (messages are well consumed).


Then came the benchs. We first noticed that somtimes, on our 
machines, when we were sending a lot of messages the consumer was 
sometimes hanging. It was there, but the messsages were accumulating in 
the queue.

When we went on the bench plateform :

cluster of 2 rabbitmq machines 4 cores/3.2Ghz, 4Gb RAM, load 
balanced by a VIPone to 6 consumers running on the rabbitmq machines, saving the 
messages in a mysql DB (same type of machine for the DB)12 producers running on 12 AS machines (tomcat), attacked with 
jmeter running on another machine. The load is about 600 to 700 http 
request per second, on the servlets that produces the same load of 
RabbitMQ messages.

We noticed that sometimes, consumers hang (well, they 
are not blocked, but they dont consume messages anymore). We can see 
that because each consumer save around 100 msg/sec in database, so when 
one is stopping consumming, the overall messages saved per seconds in DB
 fall down with the same ratio (if let say 3 consumers stop, we fall 
around 600 msg/sec to 300 msg/sec).


During that time, the producers are ok, and still produce at the 
jmeter rate (around 600 msg/sec). The messages are in the queues and 
taken by the consumers still &quot;alive&quot;. 


We load all the servlets with the producers first, then launch all 
the consumers one by one, checking if the connexions are ok, then run 
jmeter.


We are sending messages to one direct exchange. All consumers are 
listening to one persistent queue bounded to the exchange. 


That point is major for our choice. Have you seen this with rabbitmq,
 do you have an idea of what is going on ?
FYI there has been a similar issue here, but it wasn't resolved : <A HREF="http://old.nabble.com/Consumer-stop-to-receive-messages-but-continue-listening-queue-problem.-td27872888.html">http://old.nabble.com/Consumer-stop-to-receive-messages-but-continue-listening-queue-problem.-td27872888.html</A>



Thank you for your answers.

            
Florence.



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100720/a35bb4b4/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100720/a35bb4b4/attachment-0001.htm</A>&gt;
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008066.html">[rabbitmq-discuss] Rabbitmq v. 1.8.1 - Bug report - Could not	start a node as RAM node in cluster
</A></li>
	<LI>Next message: <A HREF="008065.html">[rabbitmq-discuss] Consumers stopped consuming messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8063">[ date ]</a>
              <a href="thread.html#8063">[ thread ]</a>
              <a href="subject.html#8063">[ subject ]</a>
              <a href="author.html#8063">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
