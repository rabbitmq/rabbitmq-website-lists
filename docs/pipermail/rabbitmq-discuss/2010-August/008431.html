<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Producers%20hanging%20when%20reaching%20high%20memory%0A%20watermark%20on%201.8.1&In-Reply-To=%3C4C68B781.3090707%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008430.html">
   <LINK REL="Next"  HREF="008434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Producers%20hanging%20when%20reaching%20high%20memory%0A%20watermark%20on%201.8.1&In-Reply-To=%3C4C68B781.3090707%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1">matthias at rabbitmq.com
       </A><BR>
    <I>Mon Aug 16 04:58:57 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008430.html">[rabbitmq-discuss] Producers hanging when reaching high memory	watermark on 1.8.1
</A></li>
        <LI>Next message: <A HREF="008434.html">[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8431">[ date ]</a>
              <a href="thread.html#8431">[ thread ]</a>
              <a href="subject.html#8431">[ subject ]</a>
              <a href="author.html#8431">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dave,

Dave Greggory wrote:
&gt;<i> What I'm trying to achieve is to get my client apps to be unaffected
</I>&gt;<i> if RabbitMQ goes down. In this case, from hitting high memory
</I>&gt;<i> watermark. Right now, when Rabbit hits that watermark, the clients
</I>&gt;<i> hang or slow down to a crawl. Maybe that is caused by the threads
</I>&gt;<i> being blocked by flow control, there by making it appear to be hung.
</I>&gt;<i> 
</I>&gt;<i> I don't want that. I want sends to throw an exception or some other
</I>&gt;<i> event I can respond to so that the client apps don't break down or
</I>&gt;<i> suffer a performance hit just because they lose messaging
</I>&gt;<i> functionality. How do I do that?
</I>
There can be many conditions that cause a service to slow down - network 
congestion and outages, load on the server machine, etc. 
Server-initiated flow control is just one of them, i.e. to a client 
application it will simply appear as (sometimes very) slow service.

So this then becomes a question of deciding when publishing is &quot;too 
slow&quot;, and being able to continue (w/o publishing) when it is.

One way to do that would be to have a single publishing thread that is 
fed publishes via a thread-safe queue from other threads. The app 
threads can then decide whether to enqueue another publish based on the 
queue's length. Or the publishing thread could record the time the 
currently underway publish (if there is one) was started and app threads 
would use that information to make the publish/not-publish decision 
instead. Or you could come up with yet more elaborate schemes.

Regards,

Matthias.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008430.html">[rabbitmq-discuss] Producers hanging when reaching high memory	watermark on 1.8.1
</A></li>
	<LI>Next message: <A HREF="008434.html">[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8431">[ date ]</a>
              <a href="thread.html#8431">[ thread ]</a>
              <a href="subject.html#8431">[ subject ]</a>
              <a href="author.html#8431">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
