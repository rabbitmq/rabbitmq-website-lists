<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] problem with new persiter with 1000 topics/queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20problem%20with%20new%20persiter%20with%201000%20topics/queues&In-Reply-To=%3C95833.58711.qm%40web31801.mail.mud.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008452.html">
   <LINK REL="Next"  HREF="008421.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] problem with new persiter with 1000 topics/queues</H1>
    <B>alex chen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20problem%20with%20new%20persiter%20with%201000%20topics/queues&In-Reply-To=%3C95833.58711.qm%40web31801.mail.mud.yahoo.com%3E"
       TITLE="[rabbitmq-discuss] problem with new persiter with 1000 topics/queues">chen650 at yahoo.com
       </A><BR>
    <I>Sat Aug 14 03:00:21 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008452.html">[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1
</A></li>
        <LI>Next message: <A HREF="008421.html">[rabbitmq-discuss] problem with new persiter with 1000	topics/queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8420">[ date ]</a>
              <a href="thread.html#8420">[ thread ]</a>
              <a href="subject.html#8420">[ subject ]</a>
              <a href="author.html#8420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

we are testing the new persiter (built from last week's default branch). when 
there are 1000 queues with backed up messages, starting the consumers would 
cause some queues to disappear.  here are the steps to reproduce the problem:

1) create 1000 queues for 1000 topics.
2) publish messages to these topics.  each message size is 20 KB.
3) when total number of queued messages bytes reaches 10GB, start 1000 consumers 
with 1000 processes.

The broker would start having problem when several consumers start consuming 
messages very fast, which causes other consumers error in login or 
basic_consume.  then some queues would disappear and the publishers would get 
no_route errors.

there was no problem if the num of topics/queues is less than 100. our machine 
has 8GB mem and 4 disks RAID.  we could get around 50MB/sec publish rate and 30 
MB/sec consume rate.
 
Could someone help to look into this problem? 
thanks.

-alex



      
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008452.html">[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1
</A></li>
	<LI>Next message: <A HREF="008421.html">[rabbitmq-discuss] problem with new persiter with 1000	topics/queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8420">[ date ]</a>
              <a href="thread.html#8420">[ thread ]</a>
              <a href="subject.html#8420">[ subject ]</a>
              <a href="author.html#8420">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
