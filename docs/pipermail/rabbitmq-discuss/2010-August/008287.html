<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Disk node vs ram node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disk%20node%20vs%20ram%20node&In-Reply-To=%3CAEC6A2084B89EA49B99F71108C2E53EB846A25%40ign-msg-06.hq.ign.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008286.html">
   <LINK REL="Next"  HREF="008289.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Disk node vs ram node</H1>
    <B>Vince Chang</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disk%20node%20vs%20ram%20node&In-Reply-To=%3CAEC6A2084B89EA49B99F71108C2E53EB846A25%40ign-msg-06.hq.ign.com%3E"
       TITLE="[rabbitmq-discuss] Disk node vs ram node">vchang at ign.com
       </A><BR>
    <I>Thu Aug  5 21:49:51 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008286.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
        <LI>Next message: <A HREF="008289.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8287">[ date ]</a>
              <a href="thread.html#8287">[ thread ]</a>
              <a href="subject.html#8287">[ subject ]</a>
              <a href="author.html#8287">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for your response Alex, 

1. So if I start node A by itself, and then cluster B against A, then A becomes a disk node because I specified A in the rabbitmqctl command? Here are the steps

Node1: 
start_app
add_vhost host1
add_user user pass

Node2:
stop_app
reset
cluster node1 &lt;--- (is this the step that makes node A a disk node?)
start_app

Node3:
stop_app
reset
cluster node1 
start_app

2. To be clear, if I send a message that creates the queue Q1 in node A in a cluster with node A, node B, and node C and node A goes down, then I will lose those messages on node A. Node A is down, but B and C should still be alive. If I send the same message to be queued on Q1, will Q1 be created on node B and node C? For me so far, that is not the case. When I send a message to be queued on Q1 (where the messages on Q1 on node A are now lost because node A is down) I do not see the queue getting created on either node B or node C. Is there something wrong with my steps?

3. I am using RabbitMQ 1.7.2. Just to be clear there is _no way_ on 1.7.2 to determine whether or not a node is a disk node or ram node? 

-----Original Message-----
From: Alexandru Scvor&#355;ov [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">scvalex at gmail.com</A>] On Behalf Of Alexandru Scvortov
Sent: Thursday, August 05, 2010 12:43 PM
To: Vince Chang
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Disk node vs ram node

&gt;<i> 1.  Assuming I have 3 nodes, node A, B, and C. Does node A become a disk
</I>&gt;<i> node by default when I set up the vhosts/users/permissions?
</I>
The disk nodes are the ones explicitly listed in the &quot;rabbitmqctl
cluster&quot; command.

So,
% rabbitmqctl cluster <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at A</A> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at B</A>
results in a cluster where A and B are disk nodes.  If that command is
run on either A or B,  the cluster has just the two nodes.
If, on the other hand, that command is run on C, you get a cluster with
A and B disc nodes (same as above) and C as a ram node.

&gt;<i> 2. With the same node arrangement listed above.... I set up A(created vhost,
</I>&gt;<i> users, set permissions etc) and then clustered B against A,B (rabbitmqctl
</I>&gt;<i> cluster nodeA nodeB). I took down A and my messages did not persist even
</I>&gt;<i> though B should be a disk node. Is there something wrong with my steps?
</I>
Queues exist physically only on the node on which they were declared.
Clustering just makes them (and exchanges) accesible transparently on
all of the nodes.

Thus, if the queue was declared on A, and A was taken down, the messages
stored on the queue would become inaccesible.

If you want to never lose messages, have a look at our high-availability
clustering guide in the documentation section of the website.

&gt;<i> 3. What is the conventional/non-conventional way to determine whether or not
</I>&gt;<i> individual nodes in a cluster are a disk or ram nodes?
</I>
To find out whether nodes are disc or ram, run
% rabbitmqctl status
on any node in the cluster.

Unfortunately, due to a bug, that command will not report the correct
node type, so it's not of much help to you now.  This problem has been
fixed in our default branch and will be in the release.

Cheers,
Alex

</PRE>















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008286.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
	<LI>Next message: <A HREF="008289.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8287">[ date ]</a>
              <a href="thread.html#8287">[ thread ]</a>
              <a href="subject.html#8287">[ subject ]</a>
              <a href="author.html#8287">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
