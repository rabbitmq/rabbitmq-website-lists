<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Exactly Once Delivery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exactly%20Once%20Delivery&In-Reply-To=%3CB268CF12349471459840DDE70D308B9DB0E9E63A33%40EUSAACMS0702.eamcs.ericsson.se%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008291.html">
   <LINK REL="Next"  HREF="008271.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Exactly Once Delivery</H1>
    <B>Mike Petrusis</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exactly%20Once%20Delivery&In-Reply-To=%3CB268CF12349471459840DDE70D308B9DB0E9E63A33%40EUSAACMS0702.eamcs.ericsson.se%3E"
       TITLE="[rabbitmq-discuss] Exactly Once Delivery">mike.petrusis at ericsson.com
       </A><BR>
    <I>Tue Aug  3 09:43:56 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008291.html">[rabbitmq-discuss] rabbitmqctl not reporting anything
</A></li>
        <LI>Next message: <A HREF="008271.html">[rabbitmq-discuss] Exactly Once Delivery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8252">[ date ]</a>
              <a href="thread.html#8252">[ thread ]</a>
              <a href="subject.html#8252">[ subject ]</a>
              <a href="author.html#8252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings,

In reviewing the mailing list archives, I see various threads which state that ensuring &quot;exactly once&quot; delivery requires deduplication by the consumer.  For example the following:

&quot;Exactly-once requires coordination between consumers, or idempotency,
even when there is just a single queue. The consumer, broker or network
may die during the transmission of the ack for a message, thus causing
retransmission of the message (which the consumer has already seen and
processed) at a later point.&quot;  <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2009-July/004237.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2009-July/004237.html</A>

In the case of competing consumers which pull messages from the same queue, this will require some sort of shared state between consumers to de-duplicate messages (assuming the consumers are not idempotent).   

Our application is using RabbitMQ to distribute tasks across multiple workers residing on different servers, this adds to the cost of sharing state between the workers. 

Another message in the email archive mentions that &quot;You can guarantee exactly-once delivery if you use transactions, durable queues and exchanges, and persistent messages, but only as long as any failing node eventually recovers.&quot;

&gt;<i>From the way I understand it, the transaction only affects the publishing of the message into RabbitMQ and prevents the message from being queued until the transaction is committed.  If this is correct, I don't understand how the transaction will prevent a duplicate message in the previously mentioned scenarios that will cause a retransmission.  Can anybody clarify?  
</I>
On a more practical level:

What's the recommended way to deal with the potential of duplicate messages?  
What do people generally do? 
Is this a rare enough edge case that most people just ignore it?


Thanks,

Mike
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008291.html">[rabbitmq-discuss] rabbitmqctl not reporting anything
</A></li>
	<LI>Next message: <A HREF="008271.html">[rabbitmq-discuss] Exactly Once Delivery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8252">[ date ]</a>
              <a href="thread.html#8252">[ thread ]</a>
              <a href="subject.html#8252">[ subject ]</a>
              <a href="author.html#8252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
