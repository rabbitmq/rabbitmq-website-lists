<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Disk node vs ram node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disk%20node%20vs%20ram%20node&In-Reply-To=%3C59CCC341-3A68-4C0D-8C7C-686FE1E0AAD6%40yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008290.html">
   <LINK REL="Next"  HREF="008389.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Disk node vs ram node</H1>
    <B>Dave Greggory</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disk%20node%20vs%20ram%20node&In-Reply-To=%3C59CCC341-3A68-4C0D-8C7C-686FE1E0AAD6%40yahoo.com%3E"
       TITLE="[rabbitmq-discuss] Disk node vs ram node">davegreggory at yahoo.com
       </A><BR>
    <I>Wed Aug 11 14:17:40 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008290.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
        <LI>Next message: <A HREF="008389.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8363">[ date ]</a>
              <a href="thread.html#8363">[ thread ]</a>
              <a href="subject.html#8363">[ subject ]</a>
              <a href="author.html#8363">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm a little concerned regarding what happens when a node that contains a certain queue in a cluster goes down. 

On Aug 5, 2010, at 5:38 PM, Alexandru Scvortov &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexandru at rabbitmq.com</A>&gt; wrote:

&gt;<i> If you declare a queue Q1 on node A with queue.declare, then Q1 will
</I>&gt;<i> reside on node A.  If node A goes down, all the messages on its queues
</I>&gt;<i> (including Q1) will become inaccessible.  If Q1 was declared as durable,
</I>&gt;<i> then the messages published as persistent on it will become available
</I>&gt;<i> when node A comes back online.
</I>&gt;<i> 
</I>&gt;<i> In a cluster, when a node goes down, its queues become inaccesbile.
</I>&gt;<i> They are *not* automatically created on other nodes.
</I>
I'm using the java client (1.8.1) and I automatically reconnect my producers/consumers to another node when a node goes down. I do this by    setting up a shutdown listener hook on the connection.

When a node with a queue goes down, can I write something using the java client that re-declares all known queues on the other node. May be have all the queue names(and params) registered somewhere in the app and upon reconnect, passively re-declare them. If passive declaration throws an exception, catch that and do an actual declaration. Would that work?

If that works, then what happens if we bring up the node that went down that had the queue originally? Would it play nice?

I'd like to find a solution without resorting to using the pacemaker approach.

This is important not just for node failures but for other things as upgrading or reconfiguring rabbit without affecting any clients. (our rabbits sit behind a round-robin load balancer). 
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008290.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
	<LI>Next message: <A HREF="008389.html">[rabbitmq-discuss] Disk node vs ram node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8363">[ date ]</a>
              <a href="thread.html#8363">[ thread ]</a>
              <a href="subject.html#8363">[ subject ]</a>
              <a href="author.html#8363">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
