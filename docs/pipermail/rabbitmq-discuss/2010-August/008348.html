<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Single point of failure in a clustered environment with a durable exchange and durable queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Single%20point%20of%20failure%20in%20a%20clustered%0A%20environment%20with%20a%20durable%20exchange%20and%20durable%20queues&In-Reply-To=%3C20100811083858.GA3573%40dakota.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008295.html">
   <LINK REL="Next"  HREF="008299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Single point of failure in a clustered environment with a durable exchange and durable queues</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Single%20point%20of%20failure%20in%20a%20clustered%0A%20environment%20with%20a%20durable%20exchange%20and%20durable%20queues&In-Reply-To=%3C20100811083858.GA3573%40dakota.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Single point of failure in a clustered environment with a durable exchange and durable queues">alexandru at rabbitmq.com
       </A><BR>
    <I>Wed Aug 11 09:38:58 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008295.html">[rabbitmq-discuss] Single point of failure in a clustered	environment with a durable exchange and durable queues
</A></li>
        <LI>Next message: <A HREF="008299.html">[rabbitmq-discuss] Node scheduling with RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8348">[ date ]</a>
              <a href="thread.html#8348">[ thread ]</a>
              <a href="subject.html#8348">[ subject ]</a>
              <a href="author.html#8348">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Vince,

Sorry for the late reply.

&gt;<i> I have an clustered environment with 3 nodes having the following set
</I>&gt;<i> up:
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> Exchange name:  TestExchange (1 durable exchange)
</I>&gt;<i> 
</I>&gt;<i> Queues: Q1, Q2, Q3 (3 durable queues)
</I>&gt;<i> 
</I>&gt;<i> Nodes: N1, N2, N3
</I>&gt;<i> 
</I>&gt;<i> Cluster: N2 and N3 are clustered against N1.   
</I>&gt;<i> 
</I>
Clustering isn't doing quite what you're expecting it to do.

Because the 3 nodes are clustered, they can see each other's queues,
exchanges and binding.  Moreover, connecting to any one of them gives
you access to all of the queues, exchanges, etc.

&gt;<i> The problem that I have is that N1 is a single point of failure.  When I
</I>&gt;<i> stop RabbitMQ service on N1, all the queues stop working.  Publishers
</I>&gt;<i> can no longer connect to any queues and messages cannot be enqueued.  
</I>
But, even when clustered, the queues reside only on the node they were
declared on.  In your case, I'm guessing you connect to node N1 and
declare the 3 queues on it.  Unfortunately, this means that if N1 goes
down, its queues become unusable and the messages on them are
temporarily unavailable (persistent ones are anyway, transient ones are
lost).

Put another way, clustering only makes the nodes' resources logically
available to each other.  It doesn't actually replicate queues across
the cluster.

If you really need to always have access to the messages, you could
try following our HA with Rabbit guide (it's in the documentation
section of the website); this explains how to set up a active/passive
rabbit system.

Hope this helps.

Cheers,
Alex

</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008295.html">[rabbitmq-discuss] Single point of failure in a clustered	environment with a durable exchange and durable queues
</A></li>
	<LI>Next message: <A HREF="008299.html">[rabbitmq-discuss] Node scheduling with RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8348">[ date ]</a>
              <a href="thread.html#8348">[ thread ]</a>
              <a href="subject.html#8348">[ subject ]</a>
              <a href="author.html#8348">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
