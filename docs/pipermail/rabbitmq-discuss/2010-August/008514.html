<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] STOMP and transactions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20and%20transactions&In-Reply-To=%3C4C6EC1D3.1080107%40krampe.se%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008512.html">
   <LINK REL="Next"  HREF="008515.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] STOMP and transactions</H1>
    <B>G&#246;ran Krampe</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20and%20transactions&In-Reply-To=%3C4C6EC1D3.1080107%40krampe.se%3E"
       TITLE="[rabbitmq-discuss] STOMP and transactions">goran at krampe.se
       </A><BR>
    <I>Fri Aug 20 18:56:35 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008512.html">[rabbitmq-discuss] STOMP and transactions
</A></li>
        <LI>Next message: <A HREF="008515.html">[rabbitmq-discuss] STOMP and transactions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8514">[ date ]</a>
              <a href="thread.html#8514">[ thread ]</a>
              <a href="subject.html#8514">[ subject ]</a>
              <a href="author.html#8514">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hej!

On 08/20/2010 06:55 PM, Tony Garnock-Jones wrote:
&gt;<i> Hej G&#246;ran,
</I>
Swedish! :)

&gt;<i> I spotted your library over on squeak-dev - very cool. I'm pleased you're
</I>&gt;<i> trying it out against RabbitMQ.
</I>
Hehe, yeah, I started with CoilMQ but I realized it doesn't even do 
receipts. I must say that getting Rabbit up and running was NOT trivial. 
You guys need to put out a Howto for that.

But disregarding that, Rabbit seems nice. And yeah, I noticed your AMQP 
lib on SS, and funny enough searching for &quot;STOMP&quot; gives a hit on your 
private repo I think ;)

&gt;<i> Transactions in AMQP (and STOMP, though STOMP's semantics are pretty loose) are
</I>&gt;<i> not quite what you'd expect given what they mean in the DB world. They are used
</I>&gt;<i> to *group* sets of messages (&quot;SEND&quot;s) together (atomically, more or less) so
</I>&gt;<i> that either all or none are published. An additional wrinkle is the treatment
</I>&gt;<i> of acknowledgements (&quot;ACK&quot;s) of messages delivered to the transacting client
</I>&gt;<i> from the server: acknowledgements can be included in a transaction along with
</I>&gt;<i> new publications.
</I>&gt;<i>
</I>&gt;<i> This lets e.g. an RPC server receive a request, process it, and then
</I>&gt;<i> transactionally both acknowledge the request and send the reply message. If the
</I>&gt;<i> transaction commits, the request is deleted from the server's queue, and the
</I>&gt;<i> reply is enqueued for the RPC client; if the transaction aborts, the request
</I>&gt;<i> remains enqueued waiting for another (or perhaps the same) RPC server instance
</I>&gt;<i> to pick it up and work on it, and the reply message is not sent.
</I>
Right, this was my guess. But then I tried making a sunit test and... 
well, I start two sessions, let the first set up a subscription to 
'wonderland', then let the second session do BEGIN and send two messages 
to 'wonderland', now, my naive understanding was that session one should 
not receive any message until session2 does COMMIT.

But perhaps what is happening is that the messages are not *removed* 
from the queue until COMMIT? Hmmm. Ok. &lt;scratching head&gt; wonder how to 
rig a unit test for that.

&gt;<i> With regard to hitting disk: persistence of messages is orthogonal to their
</I>&gt;<i> transactionality in messaging systems like AMQP and STOMP.
</I>
Right, kinda guessed.

&gt;<i> I hope this helps. I read squeak-dev, too, so feel free to get in touch in
</I>&gt;<i> either place if you have further questions.
</I>
Sure!

&gt;<i> Regards,
</I>&gt;<i>    Tony
</I>
regards, G&#246;ran
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008512.html">[rabbitmq-discuss] STOMP and transactions
</A></li>
	<LI>Next message: <A HREF="008515.html">[rabbitmq-discuss] STOMP and transactions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8514">[ date ]</a>
              <a href="thread.html#8514">[ thread ]</a>
              <a href="subject.html#8514">[ subject ]</a>
              <a href="author.html#8514">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
