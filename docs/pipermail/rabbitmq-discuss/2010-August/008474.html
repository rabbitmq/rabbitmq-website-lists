<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue supervisor and queue recovery&quot; after system went down (using new persister)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20hanging%20on%20%22starting%20queue%0A%20supervisor%20and%20queue%20recovery%22%20after%20system%20went%20down%20%28using%20new%20persister%29&In-Reply-To=%3C20100818111038.GB26111%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008457.html">
   <LINK REL="Next"  HREF="008484.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue supervisor and queue recovery&quot; after system went down (using new persister)</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20hanging%20on%20%22starting%20queue%0A%20supervisor%20and%20queue%20recovery%22%20after%20system%20went%20down%20%28using%20new%20persister%29&In-Reply-To=%3C20100818111038.GB26111%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue supervisor and queue recovery&quot; after system went down (using new persister)">matthew at rabbitmq.com
       </A><BR>
    <I>Wed Aug 18 12:10:38 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008457.html">[rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue supervisor	and queue recovery&quot; after system went down (using new persister)
</A></li>
        <LI>Next message: <A HREF="008484.html">[rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue	supervisor and queue recovery&quot; after system went down (using	new persister)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8474">[ date ]</a>
              <a href="thread.html#8474">[ thread ]</a>
              <a href="subject.html#8474">[ subject ]</a>
              <a href="author.html#8474">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christian,

On Mon, Aug 16, 2010 at 03:18:57PM -0700, Christian Legnitto wrote:
&gt;<i> I've been running default with the new persister. I went away for the weekend and saw that my RabbitMQ instance died (not sure what happened, doesn't look to be in logs). In any case, I went to restart the server and it was hanging at &quot;starting queue supervisor and queue recovery&quot;. The VM this on isn't speedy but I let it go for ~30 mins. I moved the mnesia db out of the way, tried again,  and it started instantly.
</I>
Hmm. Any idea what it was doing - was the disk thrashing or CPU very
busy? In the event of a crash, rabbit has to do various checks on start
up, which can be time consuming, in order to validate the state of the
messages in the queues. However, I think last time I benchmarked this,
it was of the order of 100s of thousands per second. Otoh, that's on an
8-core machine with oodles of RAM and decent hard drives.

I'd be curious as to what it was doing.

&gt;<i> I can send the mnesia db, but it is very large. I didn't have many queues (3?) but each probably had thousands (or even 100k+ messages) queued up.
</I>
That might be useful though the startup/recovery process is at various
points pruning, so the data you have may very well now be different to
the data that was there when you restarted Rabbit. You didn't happen to
take a backup *before* restarting Rabbit did you?

Matthew
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008457.html">[rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue supervisor	and queue recovery&quot; after system went down (using new persister)
</A></li>
	<LI>Next message: <A HREF="008484.html">[rabbitmq-discuss] RabbitMQ hanging on &quot;starting queue	supervisor and queue recovery&quot; after system went down (using	new persister)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8474">[ date ]</a>
              <a href="thread.html#8474">[ thread ]</a>
              <a href="subject.html#8474">[ subject ]</a>
              <a href="author.html#8474">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
