<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Producers%20hanging%20when%20reaching%20high%20memory%0A%20watermark%20on%201.8.1&In-Reply-To=%3CAANLkTin11YuNS-44xEQu4PboSMs7wF9ijivsxg%3D_eqtN%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008417.html">
   <LINK REL="Next"  HREF="008419.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1</H1>
    <B>Aaron Westendorf</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Producers%20hanging%20when%20reaching%20high%20memory%0A%20watermark%20on%201.8.1&In-Reply-To=%3CAANLkTin11YuNS-44xEQu4PboSMs7wF9ijivsxg%3D_eqtN%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Producers hanging when reaching high memory watermark on 1.8.1">aaron at agoragames.com
       </A><BR>
    <I>Fri Aug 13 20:16:45 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008417.html">[rabbitmq-discuss] Producers hanging when reaching high memory	watermark on 1.8.1
</A></li>
        <LI>Next message: <A HREF="008419.html">[rabbitmq-discuss] Producers hanging when reaching high memory	watermark on 1.8.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8418">[ date ]</a>
              <a href="thread.html#8418">[ thread ]</a>
              <a href="subject.html#8418">[ subject ]</a>
              <a href="author.html#8418">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dave,

It's likely that flow control kicked in.  I don't know how that's
implemented in Spring, as each client is welcome to implement it as
they see fit.  You can turn it off at the broker thusly:

<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">bofh at host</A>:~$ cat /etc/rabbitmq/rabbitmq.config
[{rabbit, [{vm_memory_high_watermark, 0}]}].

If you have enough monitoring tools in place to keep tabs on Rabbit
and deal with your infrastructure / apps in advance of catastrophe, I
don't personally see a need for flow control.

cheers,
Aaron

On Fri, Aug 13, 2010 at 1:04 PM, Dave Greggory &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">davegreggory at yahoo.com</A>&gt; wrote:
&gt;<i> In one of our load tests, we found that RabbitMQ causes producers to hang when it reaches the high memory watermark. We expected RabbitMQ to hang and but not the producers. How can we work around it?
</I>&gt;<i>
</I>&gt;<i> Is there a way to configure RabbitMQ to close the connection or throw an exception from the client API when that happens so the producers can respond. Or maybe there's a timeout I can specify for sends? If there's no timeout can that thread be interrupted when it hangs?
</I>&gt;<i>
</I>&gt;<i> It's imperative that our client apps remain unaffected if RabbitMQ blows up in any way.
</I>&gt;<i>
</I>&gt;<i> We're connecting to RabbitMQ 1.8.1 nodes using 1.8.1 java client running under Spring-AMQP 1.0M1.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
Aaron Westendorf
Senior Software Engineer
Agora Games
359 Broadway
Troy, NY 12180
Phone: 518.268.1000
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aaron at agoragames.com</A>
www.agoragames.com
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008417.html">[rabbitmq-discuss] Producers hanging when reaching high memory	watermark on 1.8.1
</A></li>
	<LI>Next message: <A HREF="008419.html">[rabbitmq-discuss] Producers hanging when reaching high memory	watermark on 1.8.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8418">[ date ]</a>
              <a href="thread.html#8418">[ thread ]</a>
              <a href="subject.html#8418">[ subject ]</a>
              <a href="author.html#8418">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
