<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ - live upgrade
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20-%20live%20upgrade&In-Reply-To=%3CB6FF1263-7C50-4058-94E6-44DF70723E6F%40yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008364.html">
   <LINK REL="Next"  HREF="008367.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ - live upgrade</H1>
    <B>Dave Greggory</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20-%20live%20upgrade&In-Reply-To=%3CB6FF1263-7C50-4058-94E6-44DF70723E6F%40yahoo.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ - live upgrade">davegreggory at yahoo.com
       </A><BR>
    <I>Wed Aug 11 15:01:20 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008364.html">[rabbitmq-discuss] Error: invalid command
</A></li>
        <LI>Next message: <A HREF="008367.html">[rabbitmq-discuss] RabbitMQ - live upgrade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8366">[ date ]</a>
              <a href="thread.html#8366">[ thread ]</a>
              <a href="subject.html#8366">[ subject ]</a>
              <a href="author.html#8366">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm curious as to how we can perform a live upgrade of clustered rabbitmq setup, like when you release the new persister :-) 

Our rabbit nodes sit behind a load balancer and client will connect through this load balancer to another node if the connection is lost. 

We have two nodes in the cluster and they can talk to each other directly (obviously). They're both 1.8.1 and say we want to upgrade them one at a time to 1.new version without affecting clients. If we take down 1 node out of the load balancer then clients will connect to the other node when they detect the connection loss. Now we can shutdown this first node and upgrade it.

Will we lose any of the persisted messages in the downed node due to the new persister and/or mnesia differences?

when we bring up the newly upgraded node, it will attempt to cluster itself with the still up second node with old version? Can only very bad things happen in this situation?

Other than being very quick on the trigger finger and downing the second node as we're bringing up the first node, are there any other solutions?

Or will the new version just not work without having to upgrade client API (java) and restsrting clients?
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008364.html">[rabbitmq-discuss] Error: invalid command
</A></li>
	<LI>Next message: <A HREF="008367.html">[rabbitmq-discuss] RabbitMQ - live upgrade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8366">[ date ]</a>
              <a href="thread.html#8366">[ thread ]</a>
              <a href="subject.html#8366">[ subject ]</a>
              <a href="author.html#8366">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
