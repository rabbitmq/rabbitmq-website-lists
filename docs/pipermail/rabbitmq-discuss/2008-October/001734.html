<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Catching channel disconnect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Catching%20channel%20disconnect&In-Reply-To=269388e30810150108s5819c474pc1f96748763d1a5c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001733.html">
   <LINK REL="Next"  HREF="001735.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Catching channel disconnect</H1>
    <B>Valentino Volonghi</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Catching%20channel%20disconnect&In-Reply-To=269388e30810150108s5819c474pc1f96748763d1a5c%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Catching channel disconnect">dialtone at gmail.com
       </A><BR>
    <I>Wed Oct 15 09:53:40 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001733.html">[rabbitmq-discuss] Catching channel disconnect
</A></li>
        <LI>Next message: <A HREF="001735.html">[rabbitmq-discuss] Catching channel disconnect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1734">[ date ]</a>
              <a href="thread.html#1734">[ thread ]</a>
              <a href="subject.html#1734">[ subject ]</a>
              <a href="author.html#1734">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Oct 15, 2008, at 1:08 AM, Ben Hood wrote:

&gt;<i> That patch addresses the issue of the connection to the other peer's
</I>&gt;<i> socket being lost.
</I>&gt;<i>
</I>&gt;<i> I don't quite know what you mean with the failure of a tx_select
</I>&gt;<i> command. How does this differ from anything any other pending RPC
</I>&gt;<i> whose bottom half doesn't arrive because the underlying socket
</I>&gt;<i> connection has died?
</I>
It doesn't, the tx_select just happens to be the one call that  
triggers the crash and restart
for my code which still doesn't include the patch.

&gt;<i> Sorry, I don't follow this either - are you saying that the socket
</I>&gt;<i> abstraction in Erlang should try to reconnect a few times before
</I>&gt;<i> telling higher level code that the underlying TCP connection has died?
</I>
No, I used erlang in the wrong way, scratch that. I meant the  
supervisor doesn't
provide a mechanism to restart the application using an exponential  
backoff
rather than simply as fast as possible as it's currently with the 3  
strategies.

Clearly I don't need to implement backoff myself if erlang restarts a  
dying process
increasing the interval at each retry.

&gt;<i> If I you are meaning to say that retries are a concern of the client
</I>&gt;<i> app rather than the client itself, then yes.
</I>&gt;<i>
</I>&gt;<i> From an architectural perspective, the role of the client is to
</I>&gt;<i> provide a transparent and correct propagation of events between a
</I>&gt;<i> client app and the broker. It should not try to address the problems
</I>&gt;<i> of application flow that are best left to higher level code.
</I>

Yes, I fully understand that, I don't claim that the client API should  
provide a
mechanism to do exponential backoff. :). I was simply asking myself  
if, without
rewriting the supervisor behavior to include this new feature, there  
was another
way to achieve the same results. As a matter of fact it's possible and  
it's relatively
easy. I'm starting to learn to rely on supervisor restarts as part of  
the application
logic, it wouldn't surprise me if this is actually part of the erlang  
kool-aid.

thanks again.

- --
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: <A HREF="http://www.twisted.it">http://www.twisted.it</A>
<A HREF="http://www.adroll.com">http://www.adroll.com</A>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)

iEYEARECAAYFAkj1r5QACgkQ9Llz28widGV2HQCfbpwVJMCWC1iwjDgKOQhaZGQo
KjIAn1koAww376Mj9xbPM6Vvw35mVHdQ
=vKfQ
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001733.html">[rabbitmq-discuss] Catching channel disconnect
</A></li>
	<LI>Next message: <A HREF="001735.html">[rabbitmq-discuss] Catching channel disconnect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1734">[ date ]</a>
              <a href="thread.html#1734">[ thread ]</a>
              <a href="subject.html#1734">[ subject ]</a>
              <a href="author.html#1734">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
