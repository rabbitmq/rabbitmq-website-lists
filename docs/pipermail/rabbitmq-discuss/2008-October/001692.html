<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Sent and received message counts don't match
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Sent%20and%20received%20message%20counts%20don%27t%20match&In-Reply-To=5DF69AD0-B4AB-4013-8C4C-7060263251D5%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001691.html">
   <LINK REL="Next"  HREF="001694.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Sent and received message counts don't match</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Sent%20and%20received%20message%20counts%20don%27t%20match&In-Reply-To=5DF69AD0-B4AB-4013-8C4C-7060263251D5%40gmail.com"
       TITLE="[rabbitmq-discuss] Sent and received message counts don't match">matthias at lshift.net
       </A><BR>
    <I>Sun Oct  5 17:58:50 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001691.html">[rabbitmq-discuss] Sent and received message counts don't match
</A></li>
        <LI>Next message: <A HREF="001694.html">[rabbitmq-discuss] RabbitMQ C# client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1692">[ date ]</a>
              <a href="thread.html#1692">[ thread ]</a>
              <a href="subject.html#1692">[ subject ]</a>
              <a href="author.html#1692">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Haldun,

Haldun Bayhantopcu wrote:
&gt;<i> There is a producer script which produces 1000 messages containing
</I>&gt;<i> random phrases and sends them to a fanout exchange.[1] It prints the
</I>&gt;<i> number of sent messages as 1000, which I think that 1000 messages
</I>&gt;<i> delivered successfully to rabbitmq.
</I>&gt;<i> 
</I>&gt;<i> There are two consumer scripts[2,3] The first one just tries to
</I>&gt;<i> get messages one by one with channel.basic_get(queue_name) resulting
</I>&gt;<i> saying that it gets 998 messages. The second one uses a callback
</I>&gt;<i> technique which I copied from the demo code. It prints ~500
</I>&gt;<i> messages to the screen and seems to be stalled. And for one
</I>&gt;<i> reason that I don't understand yet, the second consumer script
</I>&gt;<i> fetches messages very fast than the first one.
</I>
Are you starting the consumer programs *after* the producer? If so then 
any messages published before the consumer programs create &amp; bind their 
queues will be lost since the 'myfan' exchange has no place to route 
them to.

Also, the producer does not close the connection properly with 
conn.close. This too may result in messages getting dropped.

As for the comparative speed of the two consumer scripts - basic.consume 
is a more efficient way of consuming messages than basic.get, since the 
latter retrieves messages one at a time.

HTH.

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001691.html">[rabbitmq-discuss] Sent and received message counts don't match
</A></li>
	<LI>Next message: <A HREF="001694.html">[rabbitmq-discuss] RabbitMQ C# client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1692">[ date ]</a>
              <a href="thread.html#1692">[ thread ]</a>
              <a href="subject.html#1692">[ subject ]</a>
              <a href="author.html#1692">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
