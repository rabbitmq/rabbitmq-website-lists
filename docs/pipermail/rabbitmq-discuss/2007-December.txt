From jeter at aitc.com.tw  Sat Dec  1 07:22:57 2007
From: jeter at aitc.com.tw (Jeter Chen)
Date: Sat, 1 Dec 2007 15:22:57 +0800
Subject: [rabbitmq-discuss] any c client support??
Message-ID: <4e4aa87b0711302322s18768a2m525745b4115fd3da@mail.gmail.com>

hi, is there any c client support for RabbitMQ?? Thanks...

-- 
Jeter Chen.
Azure Information Technology Co., Ltd.
Tel: +886-2-2392-1558.
Fax: +886-2-2322-4217.
Email: jeter at aitc.com.tw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071201/d3b5d902/attachment.htm 

From liquidchen at gmail.com  Sat Dec  1 07:23:56 2007
From: liquidchen at gmail.com (Jeter Chen)
Date: Sat, 1 Dec 2007 15:23:56 +0800
Subject: [rabbitmq-discuss] c client??
Message-ID: <4e4aa87b0711302323i4245ca79g1384975ade1ed84@mail.gmail.com>

hi, is there any c client support for RabbitMQ?? Thanks...

-- 
Jeter Chen.
Azure Information Technology Co., Ltd.
Tel: +886-2-2392-1558.
Fax: +886-2-2322-4217.
Email: jeter at aitc.com.tw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071201/85b59d8d/attachment.htm 

From 0x6e6562 at gmail.com  Sat Dec  1 09:52:01 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Sat, 1 Dec 2007 09:52:01 +0000
Subject: [rabbitmq-discuss] c client??
In-Reply-To: <4e4aa87b0711302323i4245ca79g1384975ade1ed84@mail.gmail.com>
References: <4e4aa87b0711302323i4245ca79g1384975ade1ed84@mail.gmail.com>
Message-ID: <BE04C6E8-06C5-42F8-A3C2-FB54BB9195CD@gmail.com>


On 1 Dec 2007, at 07:23, Jeter Chen wrote:

> hi, is there any c client support for RabbitMQ?? Thanks...

I've haven't tried this with rabbit but openamq have got an c client  
for AMQP. I don't what exactly what version of the AMQP spec it  
implements either (Rabbit implements 0.8).

HTH,

Ben



From ndl at ravenbrook.com  Sat Dec  1 09:58:00 2007
From: ndl at ravenbrook.com (Nick Levine)
Date: Sat, 1 Dec 2007 09:58:00 GMT
Subject: [rabbitmq-discuss] c client??
In-Reply-To: <BE04C6E8-06C5-42F8-A3C2-FB54BB9195CD@gmail.com> (message from
	Ben Hood on Sat, 1 Dec 2007 09:52:01 +0000)
References: <4e4aa87b0711302323i4245ca79g1384975ade1ed84@mail.gmail.com>
	<BE04C6E8-06C5-42F8-A3C2-FB54BB9195CD@gmail.com>
Message-ID: <200712010958.lB19w0pg042683@raven.ravenbrook.com>

   I've haven't tried this with rabbit but openamq have got an c
   client for AMQP. I don't what exactly what version of the AMQP spec
   it implements either (Rabbit implements 0.8).

0.9

- nick



From 0x6e6562 at gmail.com  Sat Dec  1 10:06:14 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Sat, 1 Dec 2007 10:06:14 +0000
Subject: [rabbitmq-discuss] c client??
In-Reply-To: <200712010958.lB19w0pg042683@raven.ravenbrook.com>
References: <4e4aa87b0711302323i4245ca79g1384975ade1ed84@mail.gmail.com>
	<BE04C6E8-06C5-42F8-A3C2-FB54BB9195CD@gmail.com>
	<200712010958.lB19w0pg042683@raven.ravenbrook.com>
Message-ID: <37CA95B4-E012-4FF3-BA7B-82C20EF16B8A@gmail.com>

Jeter,

On 1 Dec 2007, at 09:58, Nick Levine wrote:

>   I've haven't tried this with rabbit but openamq have got an c
>   client for AMQP. I don't what exactly what version of the AMQP spec
>   it implements either (Rabbit implements 0.8).
>
> 0.9

This thread may be relevant to answer your question:

http://www.nabble.com/Differences-between-0-8-and-0-9-t4613145.html

Ben



From alexis.richardson at cohesiveft.com  Sat Dec  1 10:26:46 2007
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Sat, 1 Dec 2007 10:26:46 +0000
Subject: [rabbitmq-discuss] rabbitmq performance
Message-ID: <167204d20712010226i612f2a1xe30ac12856e045c5@mail.gmail.com>

Hi everyone,

Recently we did some load testing of RabbitMQ, working with Intel.
Their press release is reported here:

http://www.intelfasterfs.com/trading/articles/071128-intellowlatency.aspx

The use case was a simulated OPRA data feed using combination of:

- Pantor FAST client (essentially a codec) combined with an AMQP
client written in C (yes we are hoping to get this into the community)
- RabbitMQ AMQP broker version 1.2 on the server

Please don't read too much into the latency numbers here: the timed
path included two network hops as well as message processing at the
broker; also, somewhat annoyingly, the numbers are averaged over
multiple scenarios.  We wanted to look at throughput because OPRA
feeds are heading to 1 million ticks per second and it's a good load
testing case.

We shall publish more info soon but the numbers are as follows:

1. Ingress of about 1.3 million OPRA messages per second
2. Replicated out to four clients at once (unicast pub/sub not multicast)
3. So simultaneously, egress of about 5 million OPRA messages per second

The broker cluster was on one multicore box with 16 cores.  The network
was a full TCP/IP stack, and a standard 1GigE network (= the bottleneck).

The set up was:

1 Client Box --> 1 Server Box --> 1 Client Box

We used Intel's 16 core Caneland box for the server and the FAST/AMQP
client was delivered by Pantor, working with us.

How come the numbers are so high?  Well, one reason is that we used
FAST, which is a codec.  Each OPRA message was FAST-compressed
and batched into a block or 'datagram' of 16 compressed OPRA messages.
This is gradually becoming normal practice in the world of market data
feeds because the loads are high and people do not have enough
bandwidth to cope.

So in our test, each datagram contained 16 OPRA messages, and was
sent as one 256 byte AMQP message.

So the throughput can also be seen as:

1. Ingress of 80,000 AMQP messages per second (256b per message)
2. Replicated out to four clients at once (unicast pub/sub)
3. So simultaneously, egress of 320,000 AMQP messages per second (256b
per message)

I.e the real load is about 400,000 mps.

There are several ways to get these numbers higher:

- tune RabbitMQ for speed
- use multicast
- use Infiniband
- use faster cores

We just did some more tests using Intel's 45nm cores which look
promising in this regard.

The point is: for most use cases you can get good performance using
COTS hardware.  This means you can spend your valuable project
investment dollars on making the user experience better instead of
messing about with deep tech.

We think scalability, stability and ease of use are more important than
raw speed.  If you try to run RabbitMQ and do not see what you
expect along any of these metrics, please let us know and we'll help you.

alexis


-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From 0x6e6562 at gmail.com  Mon Dec  3 00:26:15 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Mon, 3 Dec 2007 00:26:15 +0000
Subject: [rabbitmq-discuss] Message routing
In-Reply-To: <474E8BC6.2090901@imatix.com>
References: <85FA03E6BB6F0340B5A117013571A9B70FDD2E@exchange3.ad.sis.tv><474AF786.70207@lshift.net><85FA03E6BB6F0340B5A117013571A9B70FDD6C@exchange3.ad.sis.tv>
	<474D4BD6.3060108@imatix.com>
	<85FA03E6BB6F0340B5A117013571A9B70FDD70@exchange3.ad.sis.tv>
	<474D5602.70100@imatix.com>
	<85FA03E6BB6F0340B5A117013571A9B70FDD7B@exchange3.ad.sis.tv>
	<474DA9D4.7020300@imatix.com>
	<85FA03E6BB6F0340B5A117013571A9B768464E@exchange3.ad.sis.tv>
	<474E8BC6.2090901@imatix.com>
Message-ID: <DAFA712E-220B-40B8-8779-2AFC18FE832E@gmail.com>

> Yup. The point is that AMQP knows nothing about administration -  
> it's a
> simple client/server wire-level protocol. However, the commands it
> provides allows you to implement the admin tool in any way you want.  
> The
> admin tool from AMQP's point of view will be just another client
> applcation. I suppose RabbitMQ already has some kind of admin tool
> available.

As Matthias pointed out earlier, you can use the rabbitmqctl script  
which invokes the API defined in the rabbit_access_control module.

Currently I'm working on exposing this via by RPC over AMQP. I have  
defined a Java interface that is proxied by the RpcClient in the  
Rabbit Java library. The data binding is achieved by using Hessian 2.0.

This is essentially a poor man's version of SCA - using AMQP and  
Hessian as bindings to orchestrate a service contract.

The source code for the proxy and the tests are in the mtn repository  
for the rabbit erlang-client.

This is still work in progress, but the basic flows work.

HTH,

Ben 
  



From feeder.of.the.bears at gmail.com  Mon Dec  3 01:01:34 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Sun, 2 Dec 2007 17:01:34 -0800
Subject: [rabbitmq-discuss] Wild Rabbits
Message-ID: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>

Guys,

I'm thinking about building an with RabbitMQ and the upcoming lift (
http://liftweb.net) support for RabbitMQ.

The application would have a public instance of RabbitMQ.  What are the
security ramifications of a RabbitMQ instance in the wild being able to
receive messages from any old client and routing those messages.   Is it
possible to filter the routing so malicious messages do not get sent from
one client to another?

Also, can the clients connect to RabbitMQ through an HTTP connection as an
alternative to the standard AMPQ port?  Some corporate firewalls make it
challenging to connect to anything other than an HTTP server.

Thanks,

David

-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071202/cbaa1253/attachment.htm 

From tonyg at lshift.net  Mon Dec  3 10:33:11 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 03 Dec 2007 10:33:11 +0000
Subject: [rabbitmq-discuss] Wild Rabbits
In-Reply-To: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>
References: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>
Message-ID: <4753DB67.4060502@lshift.net>

Hi David,

David Pollak wrote:
> What are the
> security ramifications of a RabbitMQ instance in the wild being able to
> receive messages from any old client and routing those messages.   Is it
> possible to filter the routing so malicious messages do not get sent
> from one client to another?

Interesting. You'd have to do that on an application level at present -
extracting messages from some intermediate queue, filtering, and
submitting again targetted at the ultimate recipients - but with a bit
of hacking on the erlang, you could send any delivered message through
an erlang-language filtering routine.

AMQP doesn't have any notion of global addressing or federation at
0-8/0-9 level, so there's no possibility of ending up with an SMTP-style
spam relay.

> Also, can the clients connect to RabbitMQ through an HTTP connection as
> an alternative to the standard AMPQ port?  Some corporate firewalls make
> it challenging to connect to anything other than an HTTP server.

If you like, you can set up the broker to listen on a non-standard port
as well as or instead of the default. Set the NODE_PORT environment
variable to 80 before starting the broker, or edit the rabbitmq-server
script to add extra TCP endpoints to the "-rabbit tcp_listeners ..." line.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From 0x6e6562 at gmail.com  Mon Dec  3 10:48:31 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Mon, 3 Dec 2007 10:48:31 +0000
Subject: [rabbitmq-discuss] Patch to the Java RPC client
Message-ID: <32EF75A5-962A-4D4A-8BD6-4924D4EE3DA6@gmail.com>

Hi,

I am suggesting the following change to the RPC client.

This allows the caller to set their own properties onto the publish  
call and still pass in a byte array, rather than having to accept the  
defaults.

The use case that I envisaged is being able to set the content-type  
field, which the current set up would not allow you to do.

HTH,

Ben


-------------- next part --------------
A non-text attachment was scrubbed...
Name: primitive_call.patch
Type: application/octet-stream
Size: 1936 bytes
Desc: not available
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071203/c0613e06/attachment.obj 
-------------- next part --------------


From tonyg at lshift.net  Mon Dec  3 10:57:59 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 03 Dec 2007 10:57:59 +0000
Subject: [rabbitmq-discuss] Patch to the Java RPC client
In-Reply-To: <32EF75A5-962A-4D4A-8BD6-4924D4EE3DA6@gmail.com>
References: <32EF75A5-962A-4D4A-8BD6-4924D4EE3DA6@gmail.com>
Message-ID: <4753E137.8090008@lshift.net>

Hi Ben,

Thanks for the patch. I've applied it to the trunk - it'll appear in the
next release.

Regards,
  Tony


Ben Hood wrote:
> Hi,
> 
> I am suggesting the following change to the RPC client.
> 
> This allows the caller to set their own properties onto the publish call
> and still pass in a byte array, rather than having to accept the defaults.
> 
> The use case that I envisaged is being able to set the content-type
> field, which the current set up would not allow you to do.
> 
> HTH,
> 
> Ben
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss


-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From feeder.of.the.bears at gmail.com  Mon Dec  3 14:44:09 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Mon, 3 Dec 2007 06:44:09 -0800
Subject: [rabbitmq-discuss] Wild Rabbits
In-Reply-To: <4753DB67.4060502@lshift.net>
References: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>
	<4753DB67.4060502@lshift.net>
Message-ID: <cdbebedf0712030644g538bdb9dkd607a132bd079b00@mail.gmail.com>

Tony,

On Dec 3, 2007 2:33 AM, Tony Garnock-Jones <tonyg at lshift.net> wrote:

> Hi David,
>
> David Pollak wrote:
> > What are the
> > security ramifications of a RabbitMQ instance in the wild being able to
> > receive messages from any old client and routing those messages.   Is it
> > possible to filter the routing so malicious messages do not get sent
> > from one client to another?
>
> Interesting. You'd have to do that on an application level at present -
> extracting messages from some intermediate queue, filtering, and
> submitting again targetted at the ultimate recipients - but with a bit
> of hacking on the erlang, you could send any delivered message through
> an erlang-language filtering routine.
>
> AMQP doesn't have any notion of global addressing or federation at
> 0-8/0-9 level, so there's no possibility of ending up with an SMTP-style
> spam relay.


There will be cases when the system will distribute  the "address" of one
client to another so that they may send each other messages directly.
Perhaps I should set this up so that they have temporary (conversation
specific) address to communicate and the address is destroyed when the
conversation ends.

>
>
> > Also, can the clients connect to RabbitMQ through an HTTP connection as
> > an alternative to the standard AMPQ port?  Some corporate firewalls make
> > it challenging to connect to anything other than an HTTP server.
>
> If you like, you can set up the broker to listen on a non-standard port
> as well as or instead of the default. Set the NODE_PORT environment
> variable to 80 before starting the broker, or edit the rabbitmq-server
> script to add extra TCP endpoints to the "-rabbit tcp_listeners ..." line.


I'm not sure that works so well.  Many corporate firewalls have HTTP
proxies.  They expect well formed HTTP.

I'll noodle on this issue a little bit and maybe come up with a solution.

Thanks,

David


>
>
> Regards,
>  Tony
> --
>  [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
>  []  [] http://www.lshift.net/ | Email: tonyg at lshift.net
>



-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071203/dbf0019a/attachment.htm 

From 0x6e6562 at gmail.com  Mon Dec  3 15:03:41 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Mon, 3 Dec 2007 15:03:41 +0000
Subject: [rabbitmq-discuss] Wild Rabbits
In-Reply-To: <cdbebedf0712030644g538bdb9dkd607a132bd079b00@mail.gmail.com>
References: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>
	<4753DB67.4060502@lshift.net>
	<cdbebedf0712030644g538bdb9dkd607a132bd079b00@mail.gmail.com>
Message-ID: <F0493202-648E-4315-8FC1-1BA7424E5B94@gmail.com>

> I'm not sure that works so well.  Many corporate firewalls have HTTP  
> proxies.  They expect well formed HTTP.

What about the http transport (http://dev.rabbitmq.com/snapshots/rabbitmq-http/)? 
  I haven't used it myself, but as far as I understand it proxies http  
into amqp methods.

HTH,

Ben



From tonyg at lshift.net  Mon Dec  3 15:04:53 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 03 Dec 2007 15:04:53 +0000
Subject: [rabbitmq-discuss] HTTP (was Re:  Wild Rabbits)
In-Reply-To: <cdbebedf0712030644g538bdb9dkd607a132bd079b00@mail.gmail.com>
References: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>	
	<4753DB67.4060502@lshift.net>
	<cdbebedf0712030644g538bdb9dkd607a132bd079b00@mail.gmail.com>
Message-ID: <47541B15.9060009@lshift.net>

David Pollak wrote:
> I'm not sure that works so well.  Many corporate firewalls have HTTP
> proxies.  They expect well formed HTTP. 

One thing I've been thinking about for a little while now is use of
HTTP/1.1's "Upgrade" header - cf. http://www.ietf.org/rfc/rfc2817.txt.

A normal HTTP/1.1 request could arrive at an HTTP-speaking port, and
through use of the "Upgrade" header, we could switch to AMQP.

Would the proxies filter out the "Upgrade" header, do you think?

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From 0x6e6562 at gmail.com  Mon Dec  3 15:07:39 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Mon, 3 Dec 2007 15:07:39 +0000
Subject: [rabbitmq-discuss] Patch to the Java RPC client
In-Reply-To: <4753E137.8090008@lshift.net>
References: <32EF75A5-962A-4D4A-8BD6-4924D4EE3DA6@gmail.com>
	<4753E137.8090008@lshift.net>
Message-ID: <50635F4D-19F8-49D1-9341-7F1EF56C626F@gmail.com>

> Thanks for the patch. I've applied it to the trunk - it'll appear in  
> the
> next release.

Great. You know what else would be really useful for many Java  
consumers - to have librabbitmq published as a mvn artifact. It  
wouldn't have to be produced by an mvn script, just publishing it to a  
publicly available mvn repository would do the trick.

Also, are there any plans to expose the source code repo to the public  
at all?

Ben




From tonyg at lshift.net  Mon Dec  3 15:10:31 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 03 Dec 2007 15:10:31 +0000
Subject: [rabbitmq-discuss] Patch to the Java RPC client
In-Reply-To: <50635F4D-19F8-49D1-9341-7F1EF56C626F@gmail.com>
References: <32EF75A5-962A-4D4A-8BD6-4924D4EE3DA6@gmail.com>	<4753E137.8090008@lshift.net>
	<50635F4D-19F8-49D1-9341-7F1EF56C626F@gmail.com>
Message-ID: <47541C67.9050204@lshift.net>

Ben Hood wrote:
> Great. You know what else would be really useful for many Java  
> consumers - to have librabbitmq published as a mvn artifact.

I think that's in progress...

> Also, are there any plans to expose the source code repo to the public  
> at all?

... and this is certainly on the cards. I'm sorry it's not already
happened, actually! I'll see what I can do.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From bp at barryp.org  Mon Dec  3 21:50:35 2007
From: bp at barryp.org (Barry Pederson)
Date: Mon, 03 Dec 2007 15:50:35 -0600
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
Message-ID: <47547A2B.5040007@barryp.org>

I've seen a few Python users on this list, so I thought I'd mention that 
I've been working on a Python AMQP client library as an alternative to 
Qpid, and have a Mercurial repository and initial tarball available at:

   http://barryp.org/software/py-amqplib/

The library is a bit rough, but I've been using it with RabbitMQ for a 
while now.

It differs from Qpid in that it doesn't require a spec file (although 
one was used to generate the initial skeleton), and it doesn't rely on 
threading (making it a bit easier to debug and use with a Python 
interpreter embedded in another app).

	Barry



From feeder.of.the.bears at gmail.com  Mon Dec  3 23:36:52 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Mon, 3 Dec 2007 15:36:52 -0800
Subject: [rabbitmq-discuss] HTTP (was Re:  Wild Rabbits)
In-Reply-To: <47541B15.9060009@lshift.net>
References: <cdbebedf0712021701q22bcc2dehe7dc4f20d5729fed@mail.gmail.com>
	<4753DB67.4060502@lshift.net>
	<cdbebedf0712030644g538bdb9dkd607a132bd079b00@mail.gmail.com>
	<47541B15.9060009@lshift.net>
Message-ID: <cdbebedf0712031536u766a8352nd2284fb7aabe9c71@mail.gmail.com>

On 12/3/07, Tony Garnock-Jones <tonyg at lshift.net> wrote:
>
> David Pollak wrote:
> > I'm not sure that works so well.  Many corporate firewalls have HTTP
> > proxies.  They expect well formed HTTP.
>
> One thing I've been thinking about for a little while now is use of
> HTTP/1.1's "Upgrade" header - cf. http://www.ietf.org/rfc/rfc2817.txt.
>
> A normal HTTP/1.1 request could arrive at an HTTP-speaking port, and
> through use of the "Upgrade" header, we could switch to AMQP.
>
> Would the proxies filter out the "Upgrade" header, do you think?


Probably not.  That's interesting.

Regards,
>   Tony
> --
> [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>    [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
> []  [] http://www.lshift.net/ | Email: tonyg at lshift.net
>



-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071203/6784af3d/attachment.htm 

From dmitriy.samovskiy at cohesiveft.com  Tue Dec  4 18:29:43 2007
From: dmitriy.samovskiy at cohesiveft.com (Dmitriy Samovskiy)
Date: Tue, 04 Dec 2007 12:29:43 -0600
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <47547A2B.5040007@barryp.org>
References: <47547A2B.5040007@barryp.org>
Message-ID: <47559C97.7030301@cohesiveft.com>

Hi Barry,

Barry Pederson wrote:
> I've seen a few Python users on this list, so I thought I'd mention that 
> I've been working on a Python AMQP client library as an alternative to 
> Qpid, and have a Mercurial repository and initial tarball available at:
> 
>    http://barryp.org/software/py-amqplib/
> 
> The library is a bit rough, but I've been using it with RabbitMQ for a 
> while now.

Great stuff, and thanks for releasing it under a public license!

Is there a way to get a non-blocking consumer event loop using your library?

Thanks,
Dmitriy



From ellisonbg.net at gmail.com  Tue Dec  4 19:15:02 2007
From: ellisonbg.net at gmail.com (Brian Granger)
Date: Tue, 4 Dec 2007 12:15:02 -0700
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <47559C97.7030301@cohesiveft.com>
References: <47547A2B.5040007@barryp.org> <47559C97.7030301@cohesiveft.com>
Message-ID: <6ce0ac130712041115n75573423t8ac7236dea6e53b5@mail.gmail.com>

>
> Barry Pederson wrote:
> > I've seen a few Python users on this list, so I thought I'd mention that
> > I've been working on a Python AMQP client library as an alternative to
> > Qpid, and have a Mercurial repository and initial tarball available at:
> >
> >    http://barryp.org/software/py-amqplib/
> >
> > The library is a bit rough, but I've been using it with RabbitMQ for a
> > while now.
>
> Great stuff, and thanks for releasing it under a public license!
>
> Is there a way to get a non-blocking consumer event loop using your library?

Twisted would be the way to go for this.

Brian

> Thanks,
> Dmitriy
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From bp at barryp.org  Tue Dec  4 20:48:48 2007
From: bp at barryp.org (Barry Pederson)
Date: Tue, 04 Dec 2007 14:48:48 -0600
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <47559C97.7030301@cohesiveft.com>
References: <47547A2B.5040007@barryp.org> <47559C97.7030301@cohesiveft.com>
Message-ID: <4755BD30.3010408@barryp.org>

Dmitriy Samovskiy wrote:

> Is there a way to get a non-blocking consumer event loop using your 
> library?

Channel.basic_get() doesn't block, it just returns None if the queue is 
empty.  So you could poll that occasionally in your own loop - but the 
downside would be more network traffic back and forth.

	Barry



From alexis.richardson at cohesiveft.com  Wed Dec  5 02:00:21 2007
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Tue, 4 Dec 2007 21:00:21 -0500
Subject: [rabbitmq-discuss] erlang on EC2
Message-ID: <167204d20712041800q68d2d6bcv3baf6c55afcf7247@mail.gmail.com>

Hi all,

This is a bit OT for the rabbitmq list but struck me as topical..

http://weblog.plexobject.com/?p=1592

It's about starting a cluster of Erlang nodes on EC2.  Obviously from
a product point of view, people like us would like to make this kind
of thing a one-click operation, but technologists might be interested
in what this guy has to say.

alexis


-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From 0x6e6562 at gmail.com  Wed Dec  5 07:31:21 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Wed, 5 Dec 2007 07:31:21 +0000
Subject: [rabbitmq-discuss] RPC Client side timeout
Message-ID: <79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC@gmail.com>

Hi,

I was wondering what the best way is to do a client side time out when  
waiting for the bottom half of an RPC.

When you send the top half you can specify an expiration property, but  
I can't see how this gets processed on the server side (from looking  
at the processing code). Furthermore this is a string value and I  
haven't seen an example of it or an explanation in the spec.

On the client, one easy to way to do this would be just to add a get()  
method on the blocking cell that passes in a timeout value, but I'm  
not sure what should happen once it times out. Should the consume be  
cancelled or should an appropriate property be set during the  
initialization of the consume that indicates to the server that it  
should clean unattended queues up after a while?

Thx,

Ben



From feeder.of.the.bears at gmail.com  Thu Dec  6 05:48:42 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Wed, 5 Dec 2007 21:48:42 -0800
Subject: [rabbitmq-discuss] Fwd: [lift] Announcing AMQP support in liftweb
In-Reply-To: <81d74c280712052135o125421cen565811ac16ac44cb@mail.gmail.com>
References: <81d74c280712052135o125421cen565811ac16ac44cb@mail.gmail.com>
Message-ID: <cdbebedf0712052148x1fc2c98bw3ed2b23dcf6d27e3@mail.gmail.com>

FYI

---------- Forwarded message ----------
From: Steve Jenson <stevej at gmail.com>
Date: Dec 5, 2007 9:35 PM
Subject: [lift] Announcing AMQP support in liftweb
To: liftweb <liftweb at googlegroups.com>



I just checked in support for AMQP publish/subscribe to lift SVN. I've
wrapped the RabbitMQ client libraries in an Actor-style API that
allows you to easily send and receive messages from an AMQP broker.

It does require you to run an instance of an AMQP broker in order to
work. We recommend RabbitMQ, a high-performance AMQP broker written in
Erlang. The included examples will work with a default install of the
latest RabbitMQ running on localhost.

The package is net.liftweb.amqp. There is copious Scaladoc and
examples in the amqp package. Hopefully you should be able to get up
and running quickly. If you have any questions, please don't hesitate
to ask.

Above all, have fun!

Best,
Steve

--~--~---------~--~----~------------~-------~--~----~
You received this message because you are subscribed to the Google Groups
"liftweb" group.
To post to this group, send email to liftweb at googlegroups.com
To unsubscribe from this group, send email to
liftweb-unsubscribe at googlegroups.com
For more options, visit this group at
http://groups.google.com/group/liftweb?hl=en
-~----------~----~----~----~------~----~------~--~---




-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071205/b8e38c7b/attachment.htm 

From alexis.richardson at cohesiveft.com  Thu Dec  6 11:31:47 2007
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Thu, 6 Dec 2007 06:31:47 -0500
Subject: [rabbitmq-discuss] Fwd: [lift] Announcing AMQP support in
	liftweb
In-Reply-To: <cdbebedf0712052148x1fc2c98bw3ed2b23dcf6d27e3@mail.gmail.com>
References: <81d74c280712052135o125421cen565811ac16ac44cb@mail.gmail.com>
	<cdbebedf0712052148x1fc2c98bw3ed2b23dcf6d27e3@mail.gmail.com>
Message-ID: <167204d20712060331p546b992ua35481ad1e384275@mail.gmail.com>

David, Steve,

Thank-you very much for this.  It is very cool of you.  For others on
this list who are not yet familiar with Lift, would it be possible for
you to sketch a couple of use cases please?

alexis



On Dec 6, 2007 12:48 AM, David Pollak <feeder.of.the.bears at gmail.com> wrote:
> FYI
>
> ---------- Forwarded message ----------
> From: Steve Jenson <stevej at gmail.com>
> Date: Dec 5, 2007 9:35 PM
>  Subject: [lift] Announcing AMQP support in liftweb
> To: liftweb <liftweb at googlegroups.com>
>
>
>
> I just checked in support for AMQP publish/subscribe to lift SVN. I've
> wrapped the RabbitMQ client libraries in an Actor-style API that
> allows you to easily send and receive messages from an AMQP broker.
>
> It does require you to run an instance of an AMQP broker in order to
> work. We recommend RabbitMQ, a high-performance AMQP broker written in
> Erlang. The included examples will work with a default install of the
> latest RabbitMQ running on localhost.
>
> The package is net.liftweb.amqp. There is copious Scaladoc and
> examples in the amqp package. Hopefully you should be able to get up
> and running quickly. If you have any questions, please don't hesitate
> to ask.
>
> Above all, have fun!
>
> Best,
> Steve
>
> --~--~---------~--~----~------------~-------~--~----~
> You received this message because you are subscribed to the Google Groups
> "liftweb" group.
> To post to this group, send email to liftweb at googlegroups.com
> To unsubscribe from this group, send email to
> liftweb-unsubscribe at googlegroups.com
> For more options, visit this group at
> http://groups.google.com/group/liftweb?hl=en
> -~----------~----~----~----~------~----~------~--~---
>
>
>
>
> --
> lift, the secure, simple, powerful web framework http://liftweb.net
> Collaborative Task Management http://much4.us
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From stevej at gmail.com  Thu Dec  6 17:17:57 2007
From: stevej at gmail.com (Steve Jenson)
Date: Thu, 6 Dec 2007 09:17:57 -0800
Subject: [rabbitmq-discuss] Fwd: [lift] Announcing AMQP support in
	liftweb
In-Reply-To: <167204d20712060331p546b992ua35481ad1e384275@mail.gmail.com>
References: <81d74c280712052135o125421cen565811ac16ac44cb@mail.gmail.com>
	<cdbebedf0712052148x1fc2c98bw3ed2b23dcf6d27e3@mail.gmail.com>
	<167204d20712060331p546b992ua35481ad1e384275@mail.gmail.com>
Message-ID: <81d74c280712060917nfdccd4bo1161cb5a3348f394@mail.gmail.com>

For those not familiar, lift is a web framework built in Scala that
features world-class ajax and comet support.

One example that I'm working on is having multiple machines pipe their
logfiles into a rabbitmq queue and having a lift frontend display them
to the browser via comet.

Another example could be using lift as a frontend for trading data.
This is why David was asking if you knew of any free trading data amqp
feeds out there. :-)

Steve

On Dec 6, 2007 3:31 AM, Alexis Richardson
<alexis.richardson at cohesiveft.com> wrote:
> David, Steve,
>
> Thank-you very much for this.  It is very cool of you.  For others on
> this list who are not yet familiar with Lift, would it be possible for
> you to sketch a couple of use cases please?
>
> alexis
>
>
>
>
> On Dec 6, 2007 12:48 AM, David Pollak <feeder.of.the.bears at gmail.com> wrote:
> > FYI
> >
> > ---------- Forwarded message ----------
> > From: Steve Jenson <stevej at gmail.com>
> > Date: Dec 5, 2007 9:35 PM
> >  Subject: [lift] Announcing AMQP support in liftweb
> > To: liftweb <liftweb at googlegroups.com>
> >
> >
> >
> > I just checked in support for AMQP publish/subscribe to lift SVN. I've
> > wrapped the RabbitMQ client libraries in an Actor-style API that
> > allows you to easily send and receive messages from an AMQP broker.
> >
> > It does require you to run an instance of an AMQP broker in order to
> > work. We recommend RabbitMQ, a high-performance AMQP broker written in
> > Erlang. The included examples will work with a default install of the
> > latest RabbitMQ running on localhost.
> >
> > The package is net.liftweb.amqp. There is copious Scaladoc and
> > examples in the amqp package. Hopefully you should be able to get up
> > and running quickly. If you have any questions, please don't hesitate
> > to ask.
> >
> > Above all, have fun!
> >
> > Best,
> > Steve
> >
> > --~--~---------~--~----~------------~-------~--~----~
> > You received this message because you are subscribed to the Google Groups
> > "liftweb" group.
> > To post to this group, send email to liftweb at googlegroups.com
> > To unsubscribe from this group, send email to
> > liftweb-unsubscribe at googlegroups.com
> > For more options, visit this group at
> > http://groups.google.com/group/liftweb?hl=en
> > -~----------~----~----~----~------~----~------~--~---
> >
> >
> >
> >
> > --
> > lift, the secure, simple, powerful web framework http://liftweb.net
> > Collaborative Task Management http://much4.us
> > _______________________________________________
> > rabbitmq-discuss mailing list
> > rabbitmq-discuss at lists.rabbitmq.com
> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >
> >
>
>
>
> --
> Alexis Richardson
> +44 20 7617 7339 (UK)
> +44 77 9865 2911 (cell)
> +1 650 206 2517 (US)
>



From feeder.of.the.bears at gmail.com  Sat Dec  8 00:37:48 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Fri, 7 Dec 2007 16:37:48 -0800
Subject: [rabbitmq-discuss] [ANN] lift 0.3.0
Message-ID: <cdbebedf0712071637s417b3b07k21bb4d450e0519d9@mail.gmail.com>

Folks,

I'm am very pleased to announce that the lift web framework version 0.3.0 is
now available.

lift is a secure, simple, powerful web framework for building real-time
collaborative applications.  lift is written in Scala, the functional/OO
hybrid language that runs on the JVM and is completely interoperable with
Java and Java libraries.  lift applications deploy as WAR files on servlet
engines supporting Servlet 2.4 and greater including Jetty and Tomcat.

First... some thanks... then the new features... then some goodies...

I'd like to thank the amazingly awesome lift committers... a growing team of
extraordinary people.  Since 0.2.0, lift has gone from being a near solo
effort to being a group effort.  David Bernard has done an awesome job of
adding process, mainly in the form of Maven, to lift.  Steve Jenson, Jorge
Ortiz Hinojosa, and Viktor Klang have committed new features and
enhancements into the code base.  And Daniel Green, the lift outreach guy,
has kept us excited and started the drum-beat to tell the world about the
benefits of using lift.  I'd also like to thank Gregory Brown of Ruport fame
for showing me how to build an open source community.

New features:

   - Ajax support including jQuery integration
   - Radically improved Comet support
   - Facebook API support
   - AMQP (RabbitMQ) support
   - Built in traits (mixins) for Users and Tags
   - Support for new O-R mapped field types including Country, Locale,
   Time Zone, Postal Code, etc.
   - Lots of new example code including a real-time blog
   - Improved XHTML support for modern browsers
   - Support for multiple database instances
   - Improved regular expression support including regex -> object
   creation for simple parsers
   - A new and improved Textile parser
   - Much more documentation, both in the form of ScalaDocs and in the
   form of an wiki with lots of excellent code

While the new feature list is impressive, what is more important is that the
lift APIs are settling and lift is becoming ready to build real
applications.

There are half a dozen projects currently being built on lift and
http://much4.us has been up and running and helping me organize my life.

So... the good stuff:

   - There's a new Scala Blog: http://scala-blogs.org  It's a central
   point for lift and Scala related blogging including an excellent example of
   building Digg in < 140 lines of code
   - The "Programming in Scala" book will be available in draft version
   very soon
   - A video of me presenting on lift to the Seattle Java Users Group is
   available at http://liftweb.net/index.php/SeaJUG
   - The lift wiki http://liftweb.net has lots of budding tutorials,
   documentation, and frequently asked questions, etc.
   - The lift mailing list hit 600 posts last month and is now a "medium
   volume" Google Group http://groups.google.com/group/liftweb
   - And... Daniel Green is the lift outreach guy (yeah, I said it
   already... but it's worth saying again.)

Please download Maven and Java... that's all you need to build a lift
application.  Type:
mvn archetype:create -U                                    \
-DarchetypeGroupId=net.liftweb                             \
-DarchetypeArtifactId=lift-archetype-blank                 \
-DarchetypeVersion=0.3.0                                   \
-DremoteRepositories=http://scala-tools.org/repo-releases  \
-DgroupId=com.test -DartifactId=ilikeit

And that's all there is to starting out with lift.  If you like it... join
the mailing list, ask questions, give feedback...  If you don't like it...
give feedback.

Thanks,

David


-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071207/231b73c0/attachment.htm 

From alexis.richardson at cohesiveft.com  Mon Dec 10 11:17:07 2007
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Mon, 10 Dec 2007 11:17:07 +0000
Subject: [rabbitmq-discuss] Fwd: [lift] Announcing AMQP support in
	liftweb
In-Reply-To: <81d74c280712060917nfdccd4bo1161cb5a3348f394@mail.gmail.com>
References: <81d74c280712052135o125421cen565811ac16ac44cb@mail.gmail.com>
	<cdbebedf0712052148x1fc2c98bw3ed2b23dcf6d27e3@mail.gmail.com>
	<167204d20712060331p546b992ua35481ad1e384275@mail.gmail.com>
	<81d74c280712060917nfdccd4bo1161cb5a3348f394@mail.gmail.com>
Message-ID: <167204d20712100317i6a9d45bav29a81935b535cf16@mail.gmail.com>

Steve

Thank-you.

I'm sure it would be great to run some canned examples showing Lift
working with RabbitMQ.  Do point them out once you have something we
can all download and run.

We're working on the feeds situation ;-)

alexis


On Dec 6, 2007 5:17 PM, Steve Jenson <stevej at gmail.com> wrote:
> For those not familiar, lift is a web framework built in Scala that
> features world-class ajax and comet support.
>
> One example that I'm working on is having multiple machines pipe their
> logfiles into a rabbitmq queue and having a lift frontend display them
> to the browser via comet.
>
> Another example could be using lift as a frontend for trading data.
> This is why David was asking if you knew of any free trading data amqp
> feeds out there. :-)
>
> Steve
>
> On Dec 6, 2007 3:31 AM, Alexis Richardson
>
> <alexis.richardson at cohesiveft.com> wrote:
> > David, Steve,
> >
> > Thank-you very much for this.  It is very cool of you.  For others on
> > this list who are not yet familiar with Lift, would it be possible for
> > you to sketch a couple of use cases please?
> >
> > alexis
> >
> >
> >
> >
> > On Dec 6, 2007 12:48 AM, David Pollak <feeder.of.the.bears at gmail.com> wrote:
> > > FYI
> > >
> > > ---------- Forwarded message ----------
> > > From: Steve Jenson <stevej at gmail.com>
> > > Date: Dec 5, 2007 9:35 PM
> > >  Subject: [lift] Announcing AMQP support in liftweb
> > > To: liftweb <liftweb at googlegroups.com>
> > >
> > >
> > >
> > > I just checked in support for AMQP publish/subscribe to lift SVN. I've
> > > wrapped the RabbitMQ client libraries in an Actor-style API that
> > > allows you to easily send and receive messages from an AMQP broker.
> > >
> > > It does require you to run an instance of an AMQP broker in order to
> > > work. We recommend RabbitMQ, a high-performance AMQP broker written in
> > > Erlang. The included examples will work with a default install of the
> > > latest RabbitMQ running on localhost.
> > >
> > > The package is net.liftweb.amqp. There is copious Scaladoc and
> > > examples in the amqp package. Hopefully you should be able to get up
> > > and running quickly. If you have any questions, please don't hesitate
> > > to ask.
> > >
> > > Above all, have fun!
> > >
> > > Best,
> > > Steve
> > >
> > > --~--~---------~--~----~------------~-------~--~----~
> > > You received this message because you are subscribed to the Google Groups
> > > "liftweb" group.
> > > To post to this group, send email to liftweb at googlegroups.com
> > > To unsubscribe from this group, send email to
> > > liftweb-unsubscribe at googlegroups.com
> > > For more options, visit this group at
> > > http://groups.google.com/group/liftweb?hl=en
> > > -~----------~----~----~----~------~----~------~--~---
> > >
> > >
> > >
> > >
> > > --
> > > lift, the secure, simple, powerful web framework http://liftweb.net
> > > Collaborative Task Management http://much4.us
> > > _______________________________________________
> > > rabbitmq-discuss mailing list
> > > rabbitmq-discuss at lists.rabbitmq.com
> > > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> > >
> > >
> >
> >
> >
> > --
> > Alexis Richardson
> > +44 20 7617 7339 (UK)
> > +44 77 9865 2911 (cell)
> > +1 650 206 2517 (US)
> >
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From 0x6e6562 at gmail.com  Tue Dec 11 22:28:43 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Tue, 11 Dec 2007 22:28:43 +0000
Subject: [rabbitmq-discuss] RPC Client side timeout
References: <79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC@gmail.com>
Message-ID: <088BBE24-E2D8-4DA5-9120-26E6604AB4E2@gmail.com>

Hi,

To get around situations where an RPC handler dies completely and this  
wasn't recovered on the server side, I applied the following patch to  
the Java to allow it time out when invoking an RPC.

HTH,

Ben



Begin forwarded message:

> From: Ben Hood <0x6e6562 at gmail.com>
> Date: 5 December 2007 07:31:21 GMT
> To: rabbitmq-discuss at lists.rabbitmq.com
> Subject: RPC Client side timeout
>
> Hi,
>
> I was wondering what the best way is to do a client side time out  
> when waiting for the bottom half of an RPC.
>
> When you send the top half you can specify an expiration property,  
> but I can't see how this gets processed on the server side (from  
> looking at the processing code). Furthermore this is a string value  
> and I haven't seen an example of it or an explanation in the spec.
>
> On the client, one easy to way to do this would be just to add a  
> get() method on the blocking cell that passes in a timeout value,  
> but I'm not sure what should happen once it times out. Should the  
> consume be cancelled or should an appropriate property be set during  
> the initialization of the consume that indicates to the server that  
> it should clean unattended queues up after a while?
>
> Thx,
>
> Ben

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071211/88665132/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: blocking_timeout.patch
Type: application/applefile
Size: 82 bytes
Desc: not available
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071211/88665132/attachment.bin 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071211/88665132/attachment-0001.htm 

From feeder.of.the.bears at gmail.com  Thu Dec 13 14:25:17 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Thu, 13 Dec 2007 06:25:17 -0800
Subject: [rabbitmq-discuss] AMQP client for flex/flash
Message-ID: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>

Folks,

I've been talking to some folks about a flex front-end to lift.  It makes a
lot of sense to me to do the client/server communications as messages sent
over AMQP.  So... is there a flex client?

Thanks,

David

-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071213/bb8eae81/attachment.htm 

From tonyg at lshift.net  Thu Dec 13 14:48:41 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 13 Dec 2007 14:48:41 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
Message-ID: <47614649.5020901@lshift.net>

Hi David,

David Pollak wrote:
> I've been talking to some folks about a flex front-end to lift.  It
> makes a lot of sense to me to do the client/server communications as
> messages sent over AMQP.  So... is there a flex client?

No, not yet. Does flex offer plain-old-TCP sockets? If so, one could be
built; otherwise, XmlHttpRequest could maybe be used just as it's used
in our HTTP adapter for in-browser Javascript support. Essentially, a
JSON-RPC object proxies for AMQP service, so that Javascript can publish
to and consume from queues on a RabbitMQ broker. It's still a bit rough,
but you can take a look at it by following links from
http://www.rabbitmq.com/download.html#rabbitmq-http.

Regards,
  Tony




From alexis.richardson at cohesiveft.com  Thu Dec 13 14:52:16 2007
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Thu, 13 Dec 2007 14:52:16 +0000
Subject: [rabbitmq-discuss] London based Erlang event tonight
Message-ID: <167204d20712130652t3d0c9676w7341c0c26ed16837@mail.gmail.com>

Hi all,

I have received the following email from our friends at Erlang Training
and Consulting.  Please take a look.  There is a kick-off talk tonight...

alexis



Please pass this on to anyone you might think is interested: As you
might have read from the Erlang mailing list,  we have started a user
group for Erlang enthusiasts based in and around London. The aim is to
have regular meetings allowing users to network and brainstorm, newbies
to get their questions answered and enthusiasts to vent their ideas and
frustrations. Presentations will be a regular occurrence, followed by
the mandatory erllounges.

The user group is initiated by Erlang Training and Consulting as an
attempt to formalize the presentations which are regularly held in its
offices and Skills Matter, a company specializing in training around
Open Source technologies.

To sign up and receive future event notifications and local notices, visit
http://uk.groups.yahoo.com/group/erlang-london/

We willl be kicking off the user group on December 13th with a generic
presentation on Erlang for Five Nines. Looking at the history of Erlang,
its features, community research and commercial use. The talk will also
go into why Erlang, originally invented to handle the next generation
of  Telecom products, has been successful in a much wider range of
sectors including banking and e-commerce. Attendance is free, but you
need to register with the hosts of the presentation, Skills Matter Ltd..
For their address and to register, visit
http://skillsmatter.com/erlang-session-concurrent-programming/pcd/1502

The above presentation should last 1.5 hours including a 30 minute
question session and is the perfect introductory presentation to Erlang,
past, present and future. Feel free to pass it on to anyone you might
think might be interested in attending.

See you there!

Francesco
--
http://www.erlang-consulting.com

-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From feeder.of.the.bears at gmail.com  Thu Dec 13 15:16:02 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Thu, 13 Dec 2007 07:16:02 -0800
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <47614649.5020901@lshift.net>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
	<47614649.5020901@lshift.net>
Message-ID: <cdbebedf0712130716r55acd5f4x611200d07d40cbeb@mail.gmail.com>

On Dec 13, 2007 6:48 AM, Tony Garnock-Jones <tonyg at lshift.net> wrote:

> Hi David,
>
> David Pollak wrote:
> > I've been talking to some folks about a flex front-end to lift.  It
> > makes a lot of sense to me to do the client/server communications as
> > messages sent over AMQP.  So... is there a flex client?
>
> No, not yet. Does flex offer plain-old-TCP sockets?


Yes and the security restrictions are less nasty than browser/JavaScript,


> If so, one could be
> built; otherwise, XmlHttpRequest could maybe be used just as it's used
> in our HTTP adapter for in-browser Javascript support. Essentially, a
> JSON-RPC object proxies for AMQP service, so that Javascript can publish
> to and consume from queues on a RabbitMQ broker. It's still a bit rough,
> but you can take a look at it by following links from
> http://www.rabbitmq.com/download.html#rabbitmq-http.
>
> Regards,
>  Tony
>
>


-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071213/896f996f/attachment.htm 

From 0x6e6562 at gmail.com  Thu Dec 13 15:55:52 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Thu, 13 Dec 2007 15:55:52 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
Message-ID: <05593966-031B-4671-A87A-703916FD65E5@gmail.com>

> I've been talking to some folks about a flex front-end to lift.  It  
> makes a lot of sense to me to do the client/server communications as  
> messages sent over AMQP.  So... is there a flex client?

Yes, I've written one for AMQP 0-8 that I've haven't published due to  
lack of interest. Should this not be the case, we could discuss  
publishing this.

HTH,

Ben



From vis2 at cornell.edu  Thu Dec 13 23:49:48 2007
From: vis2 at cornell.edu (Varun Samuel)
Date: Thu, 13 Dec 2007 18:49:48 -0500
Subject: [rabbitmq-discuss] Durable Queues
Message-ID: <D578480C-F912-4FD1-AF1F-45F001FE9AF4@cornell.edu>

Hi,

I think someone posted about this earlier, but I'm still a little  
stuck. I want to save messages in a queue to disk. I made the queue  
durable like so:

channel.queueDeclare(ticket, queueName, false, true, true, false, null)

where the first true indicates the queue is durable. My messages are  
tagged as persistent like this:

new AMQP.BasicProperties("", "", null, 2, 0, "", "", "", "", new Date 
(), "", userName, "", "")

when setting the BasicProperties object.

I assume if you want to read messages from a durable cue you would  
use channel.basicGet. I'm not sure where I'm going wrong
with these steps, so any help would be appreciated.

Thanks,
Varun



From alexis.richardson at cohesiveft.com  Fri Dec 14 08:47:12 2007
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Fri, 14 Dec 2007 08:47:12 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <05593966-031B-4671-A87A-703916FD65E5@gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
	<05593966-031B-4671-A87A-703916FD65E5@gmail.com>
Message-ID: <167204d20712140047g3c5e91ffje75a563ceb874ead@mail.gmail.com>

Ben,

On Dec 13, 2007 3:55 PM, Ben Hood <0x6e6562 at gmail.com> wrote:
> > I've been talking to some folks about a flex front-end to lift.  It
> > makes a lot of sense to me to do the client/server communications as
> > messages sent over AMQP.  So... is there a flex client?
>
> Yes, I've written one for AMQP 0-8 that I've haven't published due to
> lack of interest. Should this not be the case, we could discuss
> publishing this.

I think a flex client would be of interest.  We especially like use
cases that make RabbitMQ more tangible to web developers and other
normal human beings, and web client or GUI tools are great for this
:-)

alexis


-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From tonyg at lshift.net  Fri Dec 14 13:54:19 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Fri, 14 Dec 2007 13:54:19 +0000
Subject: [rabbitmq-discuss] Durable Queues
In-Reply-To: <D578480C-F912-4FD1-AF1F-45F001FE9AF4@cornell.edu>
References: <D578480C-F912-4FD1-AF1F-45F001FE9AF4@cornell.edu>
Message-ID: <47628B0B.4050407@lshift.net>

Hi Varun,

You're on the right track. Messages published in persistent mode to
durable queues will survive server restarts. You may wish to consider
using TX mode (txSelect, txCommit etc) to get some acknowledgement of
publication.

You can consume such messages just as if they were transient, that is
with basicGet() or basicConsume(), at your option.

What is the problem you are experiencing?

Regards,
  Tony


Varun Samuel wrote:
> I think someone posted about this earlier, but I'm still a little  
> stuck. I want to save messages in a queue to disk. I made the queue  
> durable like so:
> 
> channel.queueDeclare(ticket, queueName, false, true, true, false, null)
> 
> where the first true indicates the queue is durable. My messages are  
> tagged as persistent like this:
> 
> new AMQP.BasicProperties("", "", null, 2, 0, "", "", "", "", new Date 
> (), "", userName, "", "")
> 
> when setting the BasicProperties object.
> 
> I assume if you want to read messages from a durable cue you would  
> use channel.basicGet. I'm not sure where I'm going wrong
> with these steps, so any help would be appreciated.
> 
> Thanks,
> Varun
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 


-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From eokyere at gmail.com  Fri Dec 14 16:08:50 2007
From: eokyere at gmail.com (Emmanuel Okyere)
Date: Fri, 14 Dec 2007 16:08:50 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <05593966-031B-4671-A87A-703916FD65E5@gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
	<05593966-031B-4671-A87A-703916FD65E5@gmail.com>
Message-ID: <F3FC1539-5ED1-436D-B7C9-B772BE2FC230@gmail.com>


On 13 Dec 2007, at 15:55, Ben Hood wrote:

> Yes, I've written one for AMQP 0-8 that I've haven't published due to
> lack of interest.

Cool! 1 interested person here :)

Cheers,
Emmanuel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071214/0e239c0e/attachment.htm 

From vis2 at cornell.edu  Fri Dec 14 22:16:25 2007
From: vis2 at cornell.edu (Varun Samuel)
Date: Fri, 14 Dec 2007 17:16:25 -0500
Subject: [rabbitmq-discuss] Persisting Data
Message-ID: <B3F2CD8D-B862-496C-ACBD-504CDC8D675A@cornell.edu>

Hi,

Sorry, I'm a little new to this mailing list thing. I posted  
previously about durable queues, and I will
try to make my problem more precise.

I create a durable exchange/queue and send the queue persistent  
messages. Then I restart my broker. How would I retrieve
those messages? I am trying to read the messages with  
channel.basicGet, but they aren't in the queue. Is there
anything I'm missing? Mnesia or administrative stuff? I am connecting  
to the same channel, I try passively declaring
the queue and exchange, but still there is nothing to read. I hope I  
am not missing anything basic.

Thanks,
Varun



From tonyg at lshift.net  Mon Dec 17 15:16:50 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 17 Dec 2007 15:16:50 +0000
Subject: [rabbitmq-discuss] Persisting Data
In-Reply-To: <B3F2CD8D-B862-496C-ACBD-504CDC8D675A@cornell.edu>
References: <B3F2CD8D-B862-496C-ACBD-504CDC8D675A@cornell.edu>
Message-ID: <476692E2.60703@lshift.net>

Hi Varun,

Varun Samuel wrote:
> Sorry, I'm a little new to this mailing list thing. I posted  
> previously about durable queues, and I will
> try to make my problem more precise.

Sorry for the delay in responding. I got half-way through replying to
your other mail on Friday and arrived this morning to find an open,
half-full mail composition window :-)

> I create a durable exchange/queue and send the queue persistent  
> messages. Then I restart my broker. How would I retrieve
> those messages? I am trying to read the messages with  
> channel.basicGet, but they aren't in the queue.

This is very strange - strange enough for me to double-check that the
scenario works for me.

 1. create "durable" queue
 2. post messages to it with deliveryMode = 2
 3. restart broker
 4. consume or basicGet from queue
 5. messages (should, and do for me) arrive

If that basic scenario isn't working for you, there's something wrong -
perhaps you could email your code to me privately? I'd be happy to cast
an eye over it.

I'll reply to your other email separately - please do feel free to
forward my reply to the mailing list if you feel that's appropriate.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From 0x6e6562 at gmail.com  Mon Dec 17 17:56:13 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Mon, 17 Dec 2007 17:56:13 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <167204d20712140047g3c5e91ffje75a563ceb874ead@mail.gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
	<05593966-031B-4671-A87A-703916FD65E5@gmail.com>
	<167204d20712140047g3c5e91ffje75a563ceb874ead@mail.gmail.com>
Message-ID: <F2891857-3F28-4FA9-83DB-AC492D0C6415@gmail.com>

> I think a flex client would be of interest.  We especially like use
> cases that make RabbitMQ more tangible to web developers and other
> normal human beings, and web client or GUI tools are great for this

Fine. I'll have to separate out the AMQP specific code and introduce  
this as a binary dependency for that project, and then I can add this  
to a repo (e.g. the mtn repo). This may take a week or two as I am on  
holiday now and don't have any time to hack.

BTW, what's the current state of thinking on the repo situation? Is  
the mainline source tree going to appear in mtn, or this is still  
being decided?

Ben



From bp at barryp.org  Thu Dec 20 15:49:11 2007
From: bp at barryp.org (Barry Pederson)
Date: Thu, 20 Dec 2007 09:49:11 -0600
Subject: [rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
Message-ID: <476A8EF7.2040503@barryp.org>

I've been experimenting with RabbitMQ 1.2.0 on a FreeBSD 6.2 box, 
installed using the Generic Unix instructions from 
http://www.rabbitmq.com/install.html - (not doing any clustering), and 
am seeing my memory and disk usage growing pretty steadily as I'm 
starting to make use of persistent messages and durable queues.  I 
should also mention I'm using my alternate Python client library.

In my mnesia/rabbit directory, rabbit_persister.LOG has grown to 23Mb, 
and "top" shows the SIZE of the process to be 113M, up from about 18M 
when the daemon first starts.

I found some earlier messages in Google about rabbit memory usage, for 
example:

http://www.nabble.com/beam-instances-and-growing-memory-usage-td13805341.html

and used

	rabbit_amqqueue:stat_all().

To look at the queues, and just see

	[{ok,{resource,<<"/">>,queue,<<"syslog_interpret">>},0,1}]

Which I take to mean just one queue named 'syslog_interpret' with zero 
messages and 1 consumer?

Does having a large and growing rabbit_persister.LOG file indicate 
messages are piling up somewhere?  Are there any other Erlang commands 
for examining the system to see where any logjams may be?

Would publishing persistent messages to a durable exchange with no 
queues bound to it at all (yet) cause the messages to stick around?

Do persistent messages require some kind of acknowledgment I'm perhaps 
missing out on?

Thanks for any suggestions.

	Barry



From matthias at lshift.net  Fri Dec 21 20:28:12 2007
From: matthias at lshift.net (Matthias Radestock)
Date: Fri, 21 Dec 2007 20:28:12 +0000
Subject: [rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
In-Reply-To: <476A8EF7.2040503@barryp.org>
References: <476A8EF7.2040503@barryp.org>
Message-ID: <476C21DC.7050502@lshift.net>

Barry,

Barry Pederson wrote:
> I've been experimenting with RabbitMQ 1.2.0 on a FreeBSD 6.2 box, 
> installed using the Generic Unix instructions from 
> http://www.rabbitmq.com/install.html - (not doing any clustering), and 
> am seeing my memory and disk usage growing pretty steadily as I'm 
> starting to make use of persistent messages and durable queues.  I 
> should also mention I'm using my alternate Python client library.
> 
> In my mnesia/rabbit directory, rabbit_persister.LOG has grown to 23Mb, 
> and "top" shows the SIZE of the process to be 113M, up from about 18M 
> when the daemon first starts.

How are you consuming messages from the queues? Delivered messages 
(persistent or not) need to be acknowledged explicitly with basic.ack 
unless the noAck flag for basic.get/basic.consume was set to true.

Also, what happens when you do one of the following:
- close and re-open the channel on which messages have been consumed
- close and re-open the connection on which messages have been consumed
- restart the server
and then start consuming messages from the same queues? Do you get 
messages back that you have received before? If so that would be an 
indication that you are not sending acknowledgments.

> I found some earlier messages in Google about rabbit memory usage, for 
> example:
> 
> http://www.nabble.com/beam-instances-and-growing-memory-usage-td13805341.html
> 
> and used
> 
> 	rabbit_amqqueue:stat_all().
> 
> To look at the queues, and just see
> 
> 	[{ok,{resource,<<"/">>,queue,<<"syslog_interpret">>},0,1}]
> 
> Which I take to mean just one queue named 'syslog_interpret' with zero 
> messages and 1 consumer?

Correct, though the message count does not include unacknowledged 
delivered messages.

> Does having a large and growing rabbit_persister.LOG file indicate 
> messages are piling up somewhere?

Yes.

> Are there any other Erlang commands for examining the system to see
> where any logjams may be?

Try

[process_info(P) || P <- processes(),
                     process_info(P, memory) > {memory, 100000}].

which will list the details of all processes with a memory consumption 
greater than 100000 bytes.

> Would publishing persistent messages to a durable exchange with no 
> queues bound to it at all (yet) cause the messages to stick around?

You might be on to something there. My own testing shows a surprising 
growth in memory and the persister log in this scenario. I will do some 
more digging.


Matthias.



From feeder.of.the.bears at gmail.com  Mon Dec 24 14:42:37 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Mon, 24 Dec 2007 06:42:37 -0800
Subject: [rabbitmq-discuss] RabbitMQ & SSL
Message-ID: <cdbebedf0712240642x4396ff91jef4cac3cc3940fb4@mail.gmail.com>

Howdy,

A few months ago, you all posted about a development version of RabbitMQ
with SSL.

Is this going to be a reality in the next few weeks?

If not and I use stunnel, will there be an stunnel process forked for each
TCP/IP connection to the server?

How difficult would it be to have the ConnectionParameters/Connection
classes to include an SSL flag?  If it's hard, do you know if the Apache
Qpid classes work against RabbitMQ (I know they're supposed to, but is there
any verification)?

Thanks,

David (who will let you know about his Rabbit-based project in mid-January)


-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071224/2927990a/attachment.htm 

From vis2 at cornell.edu  Tue Dec 25 05:24:47 2007
From: vis2 at cornell.edu (Varun Samuel)
Date: Tue, 25 Dec 2007 00:24:47 -0500
Subject: [rabbitmq-discuss] Persisting Data
In-Reply-To: <476692E2.60703@lshift.net>
References: <B3F2CD8D-B862-496C-ACBD-504CDC8D675A@cornell.edu>
	<476692E2.60703@lshift.net>
Message-ID: <2674C3FB-434E-46FB-BD95-8A3B884B54DA@cornell.edu>

Tony,

I posted a little while back about persisting data with durable  
queues, which was giving me some problems.
I've got it working now, and I think the basic problem lay in my  
approach.

I wrote a small program to create and send persistent messages to a  
durable queue. Once it had sent the
messages it would try to read them immediately using basicGet. This  
seems to be the problem. Once I had a separate
client try to read the messages, everything was fine. But one program  
sending messages to the queue then
immediately trying to read them doesn't work. Just thought I'd post  
in case anyone else was trying the same thing.
Thanks very much for your offer to read over my code though. If you'd  
still like to see it, I can send it. Sorry it took a while
to post the resolution of my problem- me and my partner had to change  
direction a bit for our project.

With regards to the other issue- reading the last n messages in a  
queue, you wrote:

---

I see - it looks like you're interested in something more like a "last
value cache" than a queue.

The way durable queues are designed in AMQP is simply that the messages
in the queues are stored to disk, and so survive server restarts. They
are still consumed in the same way as non-persistent/non-durable
messages: that is, for each *queue*, a single message is delivered to a
single consumer, and if that consumer acknowledges the message, it will
not be delivered to other consumers.

To simulate a last-value cache, you could write a simple "replay"
service that keeps a log of recent chat messages, and sends them out
when asked by a new chat participant.

---

I wasn't sure if you meant this was done inside rabbitmq. I just  
settled on sticking every sent message in a LIFO data
structure, outside of rabbitmq. Any client connecting to rabbitmq  
would first get the messages from that

This is a very basic way to do it. I read a bit of the AMQP spec and  
didn't see anything about doing it in there. Does the
method you describe make use of rabbitmq to log recent chat messages?

Thanks, and Happy Holidays!
Varun





> Hi Varun,
>
> Varun Samuel wrote:
>> Sorry, I'm a little new to this mailing list thing. I posted
>> previously about durable queues, and I will
>> try to make my problem more precise.
>
> Sorry for the delay in responding. I got half-way through replying to
> your other mail on Friday and arrived this morning to find an open,
> half-full mail composition window :-)
>
>> I create a durable exchange/queue and send the queue persistent
>> messages. Then I restart my broker. How would I retrieve
>> those messages? I am trying to read the messages with
>> channel.basicGet, but they aren't in the queue.
>
> This is very strange - strange enough for me to double-check that the
> scenario works for me.
>
>  1. create "durable" queue
>  2. post messages to it with deliveryMode = 2
>  3. restart broker
>  4. consume or basicGet from queue
>  5. messages (should, and do for me) arrive
>
> If that basic scenario isn't working for you, there's something  
> wrong -
> perhaps you could email your code to me privately? I'd be happy to  
> cast
> an eye over it.
>
> I'll reply to your other email separately - please do feel free to
> forward my reply to the mailing list if you feel that's appropriate.
>
> Regards,
>   Tony
> -- 
>  [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>    [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
>  []  [] http://www.lshift.net/ | Email: tonyg at lshift.net




From matthias at lshift.net  Tue Dec 25 10:54:03 2007
From: matthias at lshift.net (Matthias Radestock)
Date: Tue, 25 Dec 2007 10:54:03 +0000
Subject: [rabbitmq-discuss] Persisting Data
In-Reply-To: <2674C3FB-434E-46FB-BD95-8A3B884B54DA@cornell.edu>
References: <B3F2CD8D-B862-496C-ACBD-504CDC8D675A@cornell.edu>	<476692E2.60703@lshift.net>
	<2674C3FB-434E-46FB-BD95-8A3B884B54DA@cornell.edu>
Message-ID: <4770E14B.30109@lshift.net>

Varun,

Varun Samuel wrote:
> I wrote a small program to create and send persistent messages to a
> durable queue. Once it had sent the messages it would try to read
> them immediately using basicGet. This seems to be the problem. Once I
> had a separate client try to read the messages, everything was fine.
> But one program sending messages to the queue then immediately trying
> to read them doesn't work.

basic.publish is an asynchronous operation. There is no way to tell when 
the messages thus published will be available via basic.get. Whether you 
perform the publish and get on the same or different connections does 
not change that, but it does alter the timing, which means you can (but 
are not guaranteed to) get different results.

> With regards to the other issue- reading the last n messages in a  
> queue, you wrote:
> 
> ---
> To simulate a last-value cache, you could write a simple "replay"
> service that keeps a log of recent chat messages, and sends them out
> when asked by a new chat participant.
> ---
> 
> I wasn't sure if you meant this was done inside rabbitmq. I just  
> settled on sticking every sent message in a LIFO data
> structure, outside of rabbitmq. Any client connecting to rabbitmq  
> would first get the messages from that
> 
> This is a very basic way to do it. I read a bit of the AMQP spec and  
> didn't see anything about doing it in there. Does the
> method you describe make use of rabbitmq to log recent chat messages?

What you implemented is exactly what Tony suggested. There is no way to 
do this inside AMQP 0-8/9. AMQP 0-10 will offer queue browsing, allowing 
clients to read messages from a queue without consuming them. There have 
also been some discussions in the working group about supporting last 
value caches more directly.

> Thanks, and Happy Holidays!

Thank you, and the same to you.


Matthias.



From feeder.of.the.bears at gmail.com  Thu Dec 27 01:14:54 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Wed, 26 Dec 2007 17:14:54 -0800
Subject: [rabbitmq-discuss] File transfers
Message-ID: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>

Folks,

I've been looking through the Rabbit documentation and examples.  I have not
found a way send a File.  Sure... I can send chunks of bytes, but I haven't
found the way to Stage a File.  Can someone lend me a clue as to how to do
this?

Thanks,

David

-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071226/c43d90a9/attachment.htm 

From tonyg at lshift.net  Thu Dec 27 14:07:36 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 14:07:36 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <F2891857-3F28-4FA9-83DB-AC492D0C6415@gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>	<05593966-031B-4671-A87A-703916FD65E5@gmail.com>	<167204d20712140047g3c5e91ffje75a563ceb874ead@mail.gmail.com>
	<F2891857-3F28-4FA9-83DB-AC492D0C6415@gmail.com>
Message-ID: <4773B1A8.5030205@lshift.net>

Hi Ben,

Ben Hood wrote:
> BTW, what's the current state of thinking on the repo situation? Is  
> the mainline source tree going to appear in mtn, or this is still  
> being decided?

It's unlikely to be monotone - while the problems we had with mtn were
superable, it's not the friendliest system in the world - but the server
code will appear externally at some point, possibly as a mercurial
repository. We haven't decided when, yet.

Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Thu Dec 27 14:25:16 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 14:25:16 +0000
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <47547A2B.5040007@barryp.org>
References: <47547A2B.5040007@barryp.org>
Message-ID: <4773B5CC.2050601@lshift.net>

Hi Barry,

Barry Pederson wrote:
>    http://barryp.org/software/py-amqplib/
> The library is a bit rough, but I've been using it with RabbitMQ for a 
> while now.

It looks great. The code is straightforward and easy-to-read. I like the
way the docstrings have been built from the specification and included
directly in the source.

I see there's SSL support in there. How have you been experimenting with
this? Using stunnel to proxy the rabbitmq server?

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Thu Dec 27 14:32:58 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 14:32:58 +0000
Subject: [rabbitmq-discuss] RPC Client side timeout
In-Reply-To: <79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC@gmail.com>
References: <79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC@gmail.com>
Message-ID: <4773B79A.8030400@lshift.net>

Hi Ben,

Ben Hood wrote:
> When you send the top half you can specify an expiration property, but  
> I can't see how this gets processed on the server side (from looking  
> at the processing code). Furthermore this is a string value and I  
> haven't seen an example of it or an explanation in the spec.

It isn't processed at all in the server at the moment, precisely because
the spec doesn't define it properly. A future release of the spec will
fix the problem.

> On the client, one easy to way to do this would be just to add a get()  
> method on the blocking cell that passes in a timeout value, but I'm  
> not sure what should happen once it times out. Should the consume be  
> cancelled or should an appropriate property be set during the  
> initialization of the consume that indicates to the server that it  
> should clean unattended queues up after a while?

I'd suggest supplying, at RPC tophalf time, a default reply value as
well as the timeout, and then starting a timer task that, when it
expires, uses setIfUnset(defaultReplyValue) to release the RPC caller.
Also, the current use of set(receivedValue) in the consumer should be
replaced by setIfUnset(receivedValue).

At the moment, RpcClient itself doesn't queueDelete. Maybe it should
have the option of doing so, at the application's discretion. Then the
application can use the defaultReplyValue to decide what to do, and can
choose to delete the RpcClient and possibly the RpcClient's queue, at
its option.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Thu Dec 27 14:33:25 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 14:33:25 +0000
Subject: [rabbitmq-discuss] RPC Client side timeout
In-Reply-To: <088BBE24-E2D8-4DA5-9120-26E6604AB4E2@gmail.com>
References: <79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC@gmail.com>
	<088BBE24-E2D8-4DA5-9120-26E6604AB4E2@gmail.com>
Message-ID: <4773B7B5.2060709@lshift.net>

Hi Ben,

Ben Hood wrote:
> To get around situations where an RPC handler dies completely and this
> wasn't recovered on the server side, I applied the following patch to
> the Java to allow it time out when invoking an RPC.

Unfortunately the patch didn't make it through - could you resend it?

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From 0x6e6562 at gmail.com  Thu Dec 27 14:42:08 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Thu, 27 Dec 2007 14:42:08 +0000
Subject: [rabbitmq-discuss] RPC Client side timeout
In-Reply-To: <4773B7B5.2060709@lshift.net>
References: <79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC@gmail.com>
	<088BBE24-E2D8-4DA5-9120-26E6604AB4E2@gmail.com>
	<4773B7B5.2060709@lshift.net>
Message-ID: <6C514EE6-8F32-48EB-80CA-6113D35ACD4B@gmail.com>

Tony,

On 27 Dec 2007, at 14:33, Tony Garnock-Jones wrote:
>
>> To get around situations where an RPC handler dies completely and  
>> this
>> wasn't recovered on the server side, I applied the following patch to
>> the Java to allow it time out when invoking an RPC.
>
> Unfortunately the patch didn't make it through - could you resend it?


Here it is.

HTH,

Ben

-------------- next part --------------
A non-text attachment was scrubbed...
Name: blocking_timeout.patch
Type: application/octet-stream
Size: 4902 bytes
Desc: not available
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071227/8483383b/attachment.obj 
-------------- next part --------------


From bp at barryp.org  Thu Dec 27 14:56:09 2007
From: bp at barryp.org (Barry Pederson)
Date: Thu, 27 Dec 2007 08:56:09 -0600
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <4773B5CC.2050601@lshift.net>
References: <47547A2B.5040007@barryp.org> <4773B5CC.2050601@lshift.net>
Message-ID: <4773BD09.9030206@barryp.org>

Tony Garnock-Jones wrote:
> Hi Barry,
> 
> Barry Pederson wrote:
>>    http://barryp.org/software/py-amqplib/
>> The library is a bit rough, but I've been using it with RabbitMQ for a 
>> while now.
> 
> It looks great. The code is straightforward and easy-to-read. I like the
> way the docstrings have been built from the specification and included
> directly in the source.
> 
> I see there's SSL support in there. How have you been experimenting with
> this? Using stunnel to proxy the rabbitmq server?

Thanks.

Yes, I've been using stunnel 4.21, I think the only thing I had to tweak 
in the stunnel.conf was to set

	sslVersion = all

instead of the default (at least default on the FreeBSD stunnel port)

	sslVersion = SSLv3

since it seemed that the Python 2.5 SSL support was for SSLv2 only.

	Barry



From tonyg at lshift.net  Thu Dec 27 14:58:13 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 14:58:13 +0000
Subject: [rabbitmq-discuss] RabbitMQ & SSL
In-Reply-To: <cdbebedf0712240642x4396ff91jef4cac3cc3940fb4@mail.gmail.com>
References: <cdbebedf0712240642x4396ff91jef4cac3cc3940fb4@mail.gmail.com>
Message-ID: <4773BD85.4080205@lshift.net>

Hi David,

David Pollak wrote:
> A few months ago, you all posted about a development version of RabbitMQ
> with SSL.

Yes. The changes were all in the client. We haven't implemented SSL
support in the server yet - instead, just as a temporary hack, I was
using stunnel4.

(As an aside, SSL support in erlang seems relatively straightforward,
but it was more than the hour I had available. SSL support in Java fit
nicely into the available time, however :-) )

> Is this going to be a reality in the next few weeks?

Yes, we hope to have an official release ready within the next month,
but until then, you could use the Java client code from one of our
unsupported, unofficial snapshots, available at
http://dev.rabbitmq.com/snapshots/rabbitmq/

The most recent one definitely has the SSL changes. (I checked.)

> If not and I use stunnel, will there be an stunnel process forked for
> each TCP/IP connection to the server?

I'm afraid I haven't investigated the details of how stunnel4 works.

Well, I've just had a look :-) and I think stunnel4 can either fork() or
use pthreads, depending on how you build it. I'm not sure which strategy
it was using when I was doing my experiments.

BTW, I had the following entry in my stunnel.conf:

[amqps]
accept = 6035
connect = 5672

I can't remember where I got 6035 from.

> How difficult would it be to have the ConnectionParameters/Connection
> classes to include an SSL flag?

That's almost exactly what we've implemented. Essentially, do the following:

  ConnectionFactory connFactory = (however you build and configure one);
  connFactory.useSslProtocol();

and it should work.

> If it's hard, do you know if the Apache
> Qpid classes work against RabbitMQ (I know they're supposed to, but is
> there any verification)?

The non-SSL QPid client works against RabbitMQ, up to the point where
QPid's implementation of the protocol diverges from the spec, or
RabbitMQ's implementation of the protocol doesn't implement some of the
JMS-specific pieces.

> David (who will let you know about his Rabbit-based project in mid-January)

Very exciting, I'm looking forward to it :-)

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Thu Dec 27 14:59:38 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 14:59:38 +0000
Subject: [rabbitmq-discuss] RabbitMQ & SSL
In-Reply-To: <4773BD85.4080205@lshift.net>
References: <cdbebedf0712240642x4396ff91jef4cac3cc3940fb4@mail.gmail.com>
	<4773BD85.4080205@lshift.net>
Message-ID: <4773BDDA.3010809@lshift.net>

Tony Garnock-Jones wrote:
> The non-SSL QPid client works against RabbitMQ, [...]

I guess I should clarify, and state that I haven't tried QPid's SSL
support at all :-)

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Thu Dec 27 15:15:44 2007
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 27 Dec 2007 15:15:44 +0000
Subject: [rabbitmq-discuss] File transfers
In-Reply-To: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>
References: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>
Message-ID: <4773C1A0.6090408@lshift.net>

Hi David,

David Pollak wrote:
> I've been looking through the Rabbit documentation and examples.  I have
> not found a way send a File.  Sure... I can send chunks of bytes, but I
> haven't found the way to Stage a File.  Can someone lend me a clue as to
> how to do this?

We haven't implemented the File.* class yet.

Alternatively, although it's a bit of work, what about using Basic.* to
encode the file transfer?

At
https://wiki.108.redhat.com/wiki/index.php/AMQP:Alternative_File_Transfer,
some months ago, I experimented with what this might look like. I'm not
sure if the specific proposal is acceptable as a file transfer service,
of course, but in my opinion layering functionality such as file
transfer over top of Basic.*, in a standard way, seems like the right
thing to do, rather than having it part of the core messaging protocol.

(Actually, 108.redhat.com needs a login; I've put the same text up on
our dev wiki, at https://dev.rabbitmq.com/wiki/AlternativeFileTransfer)

Comments on the proposal are welcome.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From feeder.of.the.bears at gmail.com  Thu Dec 27 16:35:50 2007
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Thu, 27 Dec 2007 08:35:50 -0800
Subject: [rabbitmq-discuss] File transfers
In-Reply-To: <4773C1A0.6090408@lshift.net>
References: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>
	<4773C1A0.6090408@lshift.net>
Message-ID: <cdbebedf0712270835k38e1f0ffm31ca897d818aeebb@mail.gmail.com>

On Dec 27, 2007 7:15 AM, Tony Garnock-Jones <tonyg at lshift.net> wrote:

> Hi David,
>
> David Pollak wrote:
> > I've been looking through the Rabbit documentation and examples.  I have
> > not found a way send a File.  Sure... I can send chunks of bytes, but I
> > haven't found the way to Stage a File.  Can someone lend me a clue as to
> > how to do this?
>
> We haven't implemented the File.* class yet.
>
> Alternatively, although it's a bit of work, what about using Basic.* to
> encode the file transfer?


It's not my first choice, but given my time-frames, I guess that's what I'll
have to do.

Thanks,

David

PS -- I'm currently implementing an encrypted session mechanism that does a
handshake with authentication and all the subsequent messages are encrypted
using the secret shared during the handshake.  It solves the "using Rabbit
in the Wild" problem without SSL.  I should have some code posted in a few
days.


>
>
> At
> https://wiki.108.redhat.com/wiki/index.php/AMQP:Alternative_File_Transfer,
> some months ago, I experimented with what this might look like. I'm not
> sure if the specific proposal is acceptable as a file transfer service,
> of course, but in my opinion layering functionality such as file
> transfer over top of Basic.*, in a standard way, seems like the right
> thing to do, rather than having it part of the core messaging protocol.
>
> (Actually, 108.redhat.com needs a login; I've put the same text up on
> our dev wiki, at https://dev.rabbitmq.com/wiki/AlternativeFileTransfer)
>
> Comments on the proposal are welcome.
>
> Regards,
>  Tony
> --
>  [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
>  []  [] http://www.lshift.net/ | Email: tonyg at lshift.net
>



-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071227/b166c20a/attachment.htm 

From bp at barryp.org  Thu Dec 27 21:29:24 2007
From: bp at barryp.org (Barry Pederson)
Date: Thu, 27 Dec 2007 15:29:24 -0600
Subject: [rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
In-Reply-To: <476C21DC.7050502@lshift.net>
References: <476A8EF7.2040503@barryp.org> <476C21DC.7050502@lshift.net>
Message-ID: <47741934.8000506@barryp.org>

Matthias Radestock wrote:

> How are you consuming messages from the queues? Delivered messages 
> (persistent or not) need to be acknowledged explicitly with basic.ack 
> unless the noAck flag for basic.get/basic.consume was set to true.

Yes, I've been trying both basic.ack and the noAck flag - so that part 
sounds OK.




> Also, what happens when you do one of the following:
> - close and re-open the channel on which messages have been consumed
> - close and re-open the connection on which messages have been consumed
> - restart the server
> and then start consuming messages from the same queues? Do you get 
> messages back that you have received before? If so that would be an 
> indication that you are not sending acknowledgments.

Haven't seen any repeated messages, so I guess that messages that were 
consumed were acked.  For the most part though, I don't have any queues 
at all bound to the exchange to which the persistent messages are being 
published.

After restarting the server just now, memory usage was back down, and 
the rabbit_persister.LOG file was fairly small (62k), where the 
rabbit_persister.LOG.previous is about 2.1mb

I'm fairly certain though that on another occasion a week or so ago, a 
restarted server came back up with large memory usage and a big 
rabbit_persister.LOG - I ended up wiping out the mnesia directory to get 
things back to square one.




>> Are there any other Erlang commands for examining the system to see
>> where any logjams may be?
> 
> Try
> 
> [process_info(P) || P <- processes(),
>                     process_info(P, memory) > {memory, 100000}].
> 
> which will list the details of all processes with a memory consumption 
> greater than 100000 bytes.


On first startup, the above bit just returns []

trying again after things grow for a while results in

------------------
[[{registered_name,rabbit_gc_persist},
   {current_function,{gen_server,loop,6}},
   {initial_call,{proc_lib,init_p,5}},
   {status,waiting},
   {message_queue_len,0},
   {messages,[]},
   {links,[<0.168.0>]},
   {dictionary,[{'$ancestors',[<0.168.0>,rabbit_sup,<0.103.0>]},
                {'$initial_call',{gen,init_it,
                                      [gen_server,
                                       <0.168.0>,
                                       <0.168.0>,
                                       {local,rabbit_gc_persist},
                                       rabbit_gc_persist,
                                       [],
                                       []]}}]},
   {trap_exit,false},
   {error_handler,error_handler},
   {priority,normal},
   {group_leader,<0.102.0>},
   {heap_size,121393},
   {stack_size,12},
   {reductions,74294},
   {garbage_collection,[{fullsweep_after,65535}]}]]
-------------------

And somewhat later on

--------------------
[[{registered_name,rabbit_gc_persist},
   {current_function,{gen_server,loop,6}},
   {initial_call,{proc_lib,init_p,5}},
   {status,waiting},
   {message_queue_len,0},
   {messages,[]},
   {links,[<0.168.0>]},
   {dictionary,[{'$ancestors',[<0.168.0>,rabbit_sup,<0.103.0>]},
                {'$initial_call',{gen,init_it,
                                      [gen_server,
                                       <0.168.0>,
                                       <0.168.0>,
                                       {local,rabbit_gc_persist},
                                       rabbit_gc_persist,
                                       [],
                                       []]}}]},
   {trap_exit,false},
   {error_handler,error_handler},
   {priority,normal},
   {group_leader,<0.102.0>},
   {heap_size,514229},
   {stack_size,12},
   {reductions,118305},
   {garbage_collection,[{fullsweep_after,65535}]}]]
----------------------

Looks like "heap_size" and "reductions" are growing.




>> Would publishing persistent messages to a durable exchange with no 
>> queues bound to it at all (yet) cause the messages to stick around?
> 
> You might be on to something there. My own testing shows a surprising 
> growth in memory and the persister log in this scenario. I will do some 
> more digging.

Ah good, I'm glad it's not just me.  Not knowing much Erlang I'm at a 
bit of a loss when it comes to troubleshooting this.

	Barry




From matthias at lshift.net  Fri Dec 28 14:26:46 2007
From: matthias at lshift.net (Matthias Radestock)
Date: Fri, 28 Dec 2007 14:26:46 +0000
Subject: [rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
In-Reply-To: <47741934.8000506@barryp.org>
References: <476A8EF7.2040503@barryp.org> <476C21DC.7050502@lshift.net>
	<47741934.8000506@barryp.org>
Message-ID: <477507A6.7020505@lshift.net>

Barry,

Barry Pederson wrote:

> After restarting the server just now, memory usage was back down, and 
> the rabbit_persister.LOG file was fairly small (62k), where the 
> rabbit_persister.LOG.previous is about 2.1mb

Good. That's what I expected see.

> I'm fairly certain though that on another occasion a week or so ago, a 
> restarted server came back up with large memory usage and a big 
> rabbit_persister.LOG - I ended up wiping out the mnesia directory to get 
> things back to square one.

When RabbitMQ restarts it goes through the persister log and figures out 
which messages need (re)delivering. When the persister log is large this 
can take some time and can also eat up a lot of memory. Once that's done 
though, and assuming there aren't lots of undelivered messages, the 
memory usage should drop significantly and a new, shorter persister log 
should be written.

>> Try
>>
>> [process_info(P) || P <- processes(),
>>                     process_info(P, memory) > {memory, 100000}].
>>
>> which will list the details of all processes with a memory consumption 
>> greater than 100000 bytes.
> [...]
> Looks like "heap_size" and "reductions" are growing.

...of the rabbit_gc_persist process, which keeps track of undelivered 
persistent messages. I get the same results on my system, so I I am 
pretty confident that I have reproduced the problem you are seeing.

>>> Would publishing persistent messages to a durable exchange with no 
>>> queues bound to it at all (yet) cause the messages to stick around?
>>
>> You might be on to something there. My own testing shows a surprising 
>> growth in memory and the persister log in this scenario. I will do 
>> some more digging.
> 
> Ah good, I'm glad it's not just me.

The problem turns out to be that undeliverable persistent messages stick 
around in the rabbit_gc_persist process memory and the persister log 
until the node restart.

The fix for this will be in the next RabbitMQ release. If you don't want 
to wait that long, and are feeling adventurous, you can try the most 
recent snapshot from http://dev.rabbitmq.com/snapshots/rabbitmq/


Thanks for reporting and helping me track down this problem.


Matthias.



From 0x6e6562 at gmail.com  Sat Dec 29 23:17:31 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Sat, 29 Dec 2007 23:17:31 +0000
Subject: [rabbitmq-discuss] Debugger crashes
Message-ID: <AE8CE74F-7AA0-4046-A881-D3F34B6DEB44@gmail.com>

Hi,

I've recently upgraded to R12 and the debugger has become unstable.

It is not easy to reproduce the error - it seems to occur after having  
stepped through a lot of code.

Upon googling this, I found a old post that referred to R115 (http://www.erlang.org/pipermail/erlang-questions/2007-June/026932.html 
) which describes this problem with the same trace as I have appended  
below.

Has anybody seen this with R12?

I am using OSX 1.5.1 with R12B-0 and it doesn't seem to make a  
difference if I use tcl/tk 8.4.9 or 8.5.

Thx,

Ben

----------------------------------------------------------------------------

GS frontend. Last mgs in was:{<0.3260.0>,{destroy,750}}
exit:{<0.3260.0>,{destroy,750}}
Reason: {'EXIT',
             {function_clause,
                 [{gs_frontend,remove_objs,
                      [193,
                       {error,
                           {{badmatch,[]},
                            [{gstk_db,opt,3},
                             {gstk_gridline,delete,2},
                             {gstk,delete_only_this_widget,2},
                             {gstk,destroy_impl,2},
                             {gstk,doit,2},
                             {gstk,loop,1}]}}]},
                  {gs_frontend,doit,2},
                  {gs_frontend,loop,1}]}}

=ERROR REPORT==== 13-Dec-2007::09:34:11 ===
Error in process <0.3212.0> with exit value: {{badmatch,[]}, 
[{gstk_db,opt,3},{gstk_gridline,delete,2}, 
{gstk,delete_only_this_widget,2},{gstk,destroy_impl,2},{gstk,doit,2}, 
{gstk,loop,1}]}



From 0x6e6562 at gmail.com  Sun Dec 30 09:30:27 2007
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Sun, 30 Dec 2007 09:30:27 +0000
Subject: [rabbitmq-discuss] Debugger crashes
References: <AE8CE74F-7AA0-4046-A881-D3F34B6DEB44@gmail.com>
Message-ID: <552CBFED-8EAE-4552-A7EA-12A439D726A7@gmail.com>

Hi,

This message was posted to the wrong list. Sorry for the confusion.

Ben

Begin forwarded message:

> From: Ben Hood <0x6e6562 at gmail.com>
> Date: 29 December 2007 23:17:31 GMT
> To: rabbitmq-discuss at lists.rabbitmq.com
> Subject: Debugger crashes
>
> Hi,
>
> I've recently upgraded to R12 and the debugger has become unstable.
>
> It is not easy to reproduce the error - it seems to occur after  
> having stepped through a lot of code.
>
> Upon googling this, I found a old post that referred to R115 (http://www.erlang.org/pipermail/erlang-questions/2007-June/026932.html 
> ) which describes this problem with the same trace as I have  
> appended below.
>
> Has anybody seen this with R12?
>
> I am using OSX 1.5.1 with R12B-0 and it doesn't seem to make a  
> difference if I use tcl/tk 8.4.9 or 8.5.
>
> Thx,
>
> Ben
>
> ----------------------------------------------------------------------------
>
> GS frontend. Last mgs in was:{<0.3260.0>,{destroy,750}}
> exit:{<0.3260.0>,{destroy,750}}
> Reason: {'EXIT',
>            {function_clause,
>                [{gs_frontend,remove_objs,
>                     [193,
>                      {error,
>                          {{badmatch,[]},
>                           [{gstk_db,opt,3},
>                            {gstk_gridline,delete,2},
>                            {gstk,delete_only_this_widget,2},
>                            {gstk,destroy_impl,2},
>                            {gstk,doit,2},
>                            {gstk,loop,1}]}}]},
>                 {gs_frontend,doit,2},
>                 {gs_frontend,loop,1}]}}
>
> =ERROR REPORT==== 13-Dec-2007::09:34:11 ===
> Error in process <0.3212.0> with exit value: {{badmatch,[]}, 
> [{gstk_db,opt,3},{gstk_gridline,delete,2}, 
> {gstk,delete_only_this_widget,2},{gstk,destroy_impl,2},{gstk,doit,2}, 
> {gstk,loop,1}]}

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20071230/7be49772/attachment.htm 

From bp at barryp.org  Mon Dec 31 03:27:26 2007
From: bp at barryp.org (Barry Pederson)
Date: Sun, 30 Dec 2007 21:27:26 -0600
Subject: [rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
In-Reply-To: <477507A6.7020505@lshift.net>
References: <476A8EF7.2040503@barryp.org> <476C21DC.7050502@lshift.net>
	<47741934.8000506@barryp.org> <477507A6.7020505@lshift.net>
Message-ID: <4778619E.3060907@barryp.org>

Matthias Radestock wrote:

> 
> The problem turns out to be that undeliverable persistent messages stick 
> around in the rabbit_gc_persist process memory and the persister log 
> until the node restart.
> 
> The fix for this will be in the next RabbitMQ release. If you don't want 
> to wait that long, and are feeling adventurous, you can try the most 
> recent snapshot from http://dev.rabbitmq.com/snapshots/rabbitmq/

I've been running the rabbitmq-200712231455.tar.gz snapshot for the last 
couple days, and the memory usage has barely budged at all during that 
time - so I think it's good now.

Thanks for working on that.

	Barry



