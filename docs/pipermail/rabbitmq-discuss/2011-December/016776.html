<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Need help to interpret performance results
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Need%20help%20to%20interpret%20performance%20results&In-Reply-To=%3C4EDF10C0.1010900%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016775.html">
   <LINK REL="Next"  HREF="016761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Need help to interpret performance results</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Need%20help%20to%20interpret%20performance%20results&In-Reply-To=%3C4EDF10C0.1010900%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Need help to interpret performance results">matthias at rabbitmq.com
       </A><BR>
    <I>Wed Dec  7 07:07:44 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016775.html">[rabbitmq-discuss] Need help to interpret performance results
</A></li>
        <LI>Next message: <A HREF="016761.html">[rabbitmq-discuss] Can't get rabbitMQ to restart after switching	machines -- some kind of DB error...?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16776">[ date ]</a>
              <a href="thread.html#16776">[ thread ]</a>
              <a href="subject.html#16776">[ subject ]</a>
              <a href="author.html#16776">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/12/11 03:18, tang qingxiong wrote:
&gt;<i> <A HREF="http://img522.imageshack.us/img522/4746/queuesrabbitmq1.jpg">http://img522.imageshack.us/img522/4746/queuesrabbitmq1.jpg</A>
</I>&gt;<i>
</I>&gt;<i> I noticed that the messages in 1 queue is increasing despite the
</I>&gt;<i> fact that the incoming is still &lt;= get/deliver.
</I>
Take a look at the details page for that queue. It may contain some
clues as to why you are seeing the above. In particular there should be
some (rather cryptic) information about the backing_queue_status that
contains the queue's internal rate calculations.

&gt;<i> one message could be up to 300kb as thats what I set the frame size
</I>&gt;<i> to be (I assume that is the message size).
</I>
No, the frame_max setting controls the size of a single frame; messages 
automatically get fragmented across multiple frames when they exceed 
that size. And note that the frame_max includes the framing overhead. So 
if you set it to exactly your message size you'll actually be short of a 
few octets and the messages get split over two frames.

See 
<A HREF="http://www.rabbitmq.com/amqp-0-9-1-reference.html#connection.tune.frame-max">http://www.rabbitmq.com/amqp-0-9-1-reference.html#connection.tune.frame-max</A> 
for more info.

&gt;<i> Was wondering if it is a problem with the way I implement the
</I>&gt;<i> clustering or code.
</I>&gt;<i>
</I>&gt;<i> my cluster config is as follows server 1 [
</I>&gt;<i> {rabbit,[{vm_memory_high_watermark, 1.0},{frame_max,
</I>&gt;<i> 0},{cluster_nodes,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at SERVER1</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at SERVER2</A>']}]} ]. server 2
</I>&gt;<i>  [ {rabbit,[{vm_memory_high_watermark, 1.0},{frame_max,
</I>&gt;<i> 0},{cluster_nodes,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at SERVER2</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at SERVER1</A>']}]} ]. . . . .
</I>
Nothing wrong with that except that setting the vm_memory_high_watermark 
to 1.0 is usually a bad idea. That's why your broker ran out of memory 
and crashed rather than paging messages to disk.

See <A HREF="http://www.rabbitmq.com/memory.html">http://www.rabbitmq.com/memory.html</A> for more info.


Matthias.
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016775.html">[rabbitmq-discuss] Need help to interpret performance results
</A></li>
	<LI>Next message: <A HREF="016761.html">[rabbitmq-discuss] Can't get rabbitMQ to restart after switching	machines -- some kind of DB error...?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16776">[ date ]</a>
              <a href="thread.html#16776">[ thread ]</a>
              <a href="subject.html#16776">[ subject ]</a>
              <a href="author.html#16776">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
