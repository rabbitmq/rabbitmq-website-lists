<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Network failures recovery with RabbitMQ	Javaclient
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Network%20failures%20recovery%20with%20RabbitMQ%0A%09Javaclient&In-Reply-To=%3CCAOn7oW-F6vw-w1XHaTRZbOXU1osZk5Zaij5goK7pVcyK73TRrA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016819.html">
   <LINK REL="Next"  HREF="016820.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Network failures recovery with RabbitMQ	Javaclient</H1>
    <B>Simone Busoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Network%20failures%20recovery%20with%20RabbitMQ%0A%09Javaclient&In-Reply-To=%3CCAOn7oW-F6vw-w1XHaTRZbOXU1osZk5Zaij5goK7pVcyK73TRrA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Network failures recovery with RabbitMQ	Javaclient">simone.busoli at gmail.com
       </A><BR>
    <I>Fri Dec  9 21:16:11 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016819.html">[rabbitmq-discuss] Network failures recovery with RabbitMQ	Javaclient
</A></li>
        <LI>Next message: <A HREF="016820.html">[rabbitmq-discuss] maximum number of amqp connections to a rabbitmq broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16822">[ date ]</a>
              <a href="thread.html#16822">[ thread ]</a>
              <a href="subject.html#16822">[ subject ]</a>
              <a href="author.html#16822">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Dec 9, 2011 at 17:13, Michael Klishin
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.s.klishin at gmail.com</A>&gt;wrote:

&gt;<i> Le 09/dic/2011 &#224; 19:41, Busoli, Simone a &#233;crit :
</I>&gt;<i>
</I>&gt;<i> &gt; I'm dealing with this by having a single channel with one consumer which
</I>&gt;<i> consumes from all the queues the application needs to read data from. What
</I>&gt;<i> kind of limitation do you see in keeping it single threaded?
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> I think it's fine for many cases, however, I am designing a solution that
</I>&gt;<i> library will use and there are definitely problems that can be naturally
</I>&gt;<i> split into many concurrent tasks.
</I>&gt;<i>
</I>&gt;<i> Currently both Langohr and Hot Bunnies use an executor (basically, submit
</I>&gt;<i> message handlers to a thread pool) which is single threaded by default but
</I>&gt;<i> can be swapped with any other. So my thinking is influenced by this
</I>&gt;<i> scenario, probably too much.
</I>&gt;<i>
</I>
I'm not familiar with the executor you mention, but with &quot;submit message
handlers to a thread pool&quot; what do you mean exactly? What I mentioned above
is just how the library consumes messages from rabbit, how it marshals them
to the application code is a different matter. Currently I'm doing the
marshaling in the same thread as that which consumes from the rabbit queue,
which has the disadvantage of being as blocking as the application code
which consumes the message, but also the advantage of being able to
intercept exceptions being thrown by the application consuming the message
and thus enable policies to retry the consume, for instance. Anyway I'm not
sure I understand what you specifically refer to and I'be glad if you could
expand as it is something interesting for me too, as I didn't take much
time to look into how other libraries are handling that.


&gt;<i>
</I>&gt;<i> &gt;&gt; 3. How do I detect that reconnection has succeeded?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In the .NET client when you Open the connection and no exception is
</I>&gt;<i> thrown I think you can safely assume that the connection has been
</I>&gt;<i> established.
</I>&gt;<i>
</I>&gt;<i> This is true for the Java client, too. Does this mean that you open all
</I>&gt;<i> channels in one place in the code? (I find this is a good idea)
</I>&gt;<i>
</I>
I actually have an IPublishingModule and an IComsumingModule, which are
independent of each other. They both subscribe to events fired by a
ReliableConnection class I implemented which takes care of spotting
connection issues and schedule reconnection the broker when it shuts down,
notifying observers about these events. The modules carry out what is
sensible for them in response to connection status events. For instance the
publishing module stops trying to publish and enqueues publishes requested
by the application code (which is thus unaware, to a certain extent, of the
temporary connection failure), and then as soon as the connection is
restored recreates the channel and resumes publishing. On the other hand
the consuming module will just stop receiving and will recreate the amqp
entities when the connection is restored.


&gt;<i>
</I>&gt;<i> MK
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
</I>&gt;<i> <A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111209/92dcad2f/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111209/92dcad2f/attachment.htm</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016819.html">[rabbitmq-discuss] Network failures recovery with RabbitMQ	Javaclient
</A></li>
	<LI>Next message: <A HREF="016820.html">[rabbitmq-discuss] maximum number of amqp connections to a rabbitmq broker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16822">[ date ]</a>
              <a href="thread.html#16822">[ thread ]</a>
              <a href="subject.html#16822">[ subject ]</a>
              <a href="author.html#16822">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
