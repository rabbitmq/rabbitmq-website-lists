<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ and Camel not working?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20and%20Camel%20not%20working%3F&In-Reply-To=%3CCAKdGheMMh2ipsExZSCT_8HQ1h2h7tDx%3DKg03YVg46_FkS0MxCw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016858.html">
   <LINK REL="Next"  HREF="016863.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ and Camel not working?</H1>
    <B>David Harrigan</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20and%20Camel%20not%20working%3F&In-Reply-To=%3CCAKdGheMMh2ipsExZSCT_8HQ1h2h7tDx%3DKg03YVg46_FkS0MxCw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ and Camel not working?">dharrigan at gmail.com
       </A><BR>
    <I>Wed Dec 14 14:49:47 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016858.html">[rabbitmq-discuss] Will AMQP 1.0 break current RabbitMQ api
</A></li>
        <LI>Next message: <A HREF="016863.html">[rabbitmq-discuss] RabbitMQ and Camel not working?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16862">[ date ]</a>
              <a href="thread.html#16862">[ thread ]</a>
              <a href="subject.html#16862">[ subject ]</a>
              <a href="author.html#16862">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

RabbitMQ 2.7.0 on Debian Testing.
Camel 2.8.3
Camel AMQP 2.8.3 (but pulled down Qpid 0.12 manually and jar included
on classpath).

Booted up a simple Camel context and I'm getting this:

    [java] 14:21:50.566 [mol-router] INFO
[org.apache.qpid.client.state.StateWaiter] [63  ] - New StateWaiter
:<i>AMQState: id = 1 name: CONNECTION_NOT_STARTED:[AMQState: id = 4 name:
</I>CONNECTION_OPEN, AMQState: id = 6 name: CONNECTION_CLOSED]
     [java] 14:21:50.576 [mol-router] INFO
[o.a.q.c.t.SocketTransportConnection     ] [62  ] - Using
SimpleByteBufferAllocator
     [java] 14:21:50.577 [mol-router] INFO
[o.a.q.c.transport.TransportConnection   ] [130 ] - Using Mina NIO
     [java] 14:21:50.577 [mol-router] INFO
[o.a.q.c.t.SocketTransportConnection     ] [76  ] - Attempting
connection to localhost/127.0.0.1:5672
     [java] 14:21:50.585 [mol-router] INFO
[o.a.q.client.protocol.AMQProtocolSession] [398 ] - Setting
ProtocolVersion to :0-91
     [java] 14:21:50.586 [mol-router] INFO
[o.a.q.c.h.ClientMethodDispatcherImpl    ] [99  ] - New Method
Dispatcher:AMQProtocolSession[AMQConnection:
     [java] Host: localhost
     [java] Port: 5672
     [java] Virtual Host:
     [java] Client ID: frodo1323872488113
     [java] Active session count: 0]
     [java] 14:21:50.590 [mol-router] INFO
[org.apache.qpid.client.AMQConnection    ] [475 ] - Connected with
ProtocolHandler Version:0-91
     [java] 14:21:50.591 [mol-router] INFO
[c.c.j.DefaultJmsMessageListenerContainer] [863 ] - Successfully
refreshed JMS Connection
     [java] 14:21:50.591 [mol-router] INFO
[org.apache.qpid.client.AMQSession       ] [537 ] - Created
session:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">org.apache.qpid.client.AMQSession_0_8 at 23d100f2</A>
     [java] 14:21:50.595 [mol-router] INFO
[org.apache.qpid.client.AMQSession       ] [722 ] - Closing session:
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">org.apache.qpid.client.AMQSession_0_8 at 23d100f2</A>
     [java] 14:21:50.596 [mol-router] INFO
[o.a.q.c.h.ChannelCloseOkMethodHandler   ] [45  ] - Received
channel-close-ok for channel-id 1

     [java] 14:21:55.597 [mol-router] WARN
[c.c.j.DefaultJmsMessageListenerContainer] [822 ] - Setup of JMS
message listener invoker failed for destination 'banFlushQueue' -
trying to recover. Cause: The new addressing based sytanx is not
supported for AMQP 0-8/0-9 versions

     [java] 14:21:55.599 [mol-router] INFO
[org.apache.qpid.client.AMQConnection    ] [350 ] -
Connection:<A HREF="amqp://guest:********@frodo1323872488113/?brokerlist='tcp://localhost:5672'">amqp://guest:********@frodo1323872488113/?brokerlist='tcp://localhost:5672'</A>
     [java] 14:21:55.599 [mol-router] INFO
[o.a.q.client.protocol.AMQProtocolSession] [110 ] - Using
ProtocolVersion for Session:0-10
     [java] 14:21:55.600 [mol-router] INFO
[o.a.q.c.h.ClientMethodDispatcherImpl    ] [99  ] - New Method
Dispatcher:AMQProtocolSession[null]
     [java] 14:21:55.600 [mol-router] INFO
[org.apache.qpid.client.AMQConnection    ] [384 ] - Connecting with
ProtocolHandler Version:0-10
     [java] 14:21:55.602 [mol-router] INFO
[org.apache.qpid.client.AMQConnection    ] [502 ] - Looking up
delegate 'org.apache.qpid.client.AMQConnectionDelegate_9_1' Based on
PE:9-1
     [java] 14:21:55.602 [mol-router] INFO
[o.a.q.client.protocol.AMQProtocolSession] [398 ] - Setting
ProtocolVersion to :0-91
     [java] 14:21:55.602 [mol-router] INFO
[o.a.q.c.h.ClientMethodDispatcherImpl    ] [99  ] - New Method
Dispatcher:AMQProtocolSession[AMQConnection:

I'm watching my client connect to RabbitMQ (using the lovely web
interface) then after 5 seconds the connection is terminated, this
repeats ad-infinitum. The RabbitMQ logs simply report:

=ERROR REPORT==== 14-Dec-2011::14:21:55 ===
exception on TCP connection &lt;0.1141.0&gt; from 127.0.0.1:45985
{bad_version,1,1,0,10}

=INFO REPORT==== 14-Dec-2011::14:21:55 ===
closing TCP connection &lt;0.1141.0&gt; from 127.0.0.1:45985

=INFO REPORT==== 14-Dec-2011::14:21:55 ===
accepted TCP connection on [::]:5672 from 127.0.0.1:45986

=INFO REPORT==== 14-Dec-2011::14:21:55 ===
starting TCP connection &lt;0.1145.0&gt; from 127.0.0.1:45986

=INFO REPORT==== 14-Dec-2011::14:22:00 ===
closing TCP connection &lt;0.1145.0&gt; from 127.0.0.1:45986

I notice the WARN message in the Camel logs re:  Setup of JMS message
listener...

I'm at a loss as here, I'm just learning about RabbitMQ and can't
understand why the connection is failing. Can anyone offer any helpful
insights?

Thank you.

-=david=-

-- 
I prefer encrypted and signed messages. KeyID: B20A22F9
Fingerprint: 110A F423 3647 54E2 880F ADAD 1C52 85BF B20A 22F9

&quot;It is not usually until you've built and used a version of the
program that you understand the issues well enough to get the design
right.&quot; - Rob Pike, Brian Kernighan.

No trees were harmed in the sending of this message, however, a number
of electrons were inconvenienced.
</PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016858.html">[rabbitmq-discuss] Will AMQP 1.0 break current RabbitMQ api
</A></li>
	<LI>Next message: <A HREF="016863.html">[rabbitmq-discuss] RabbitMQ and Camel not working?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16862">[ date ]</a>
              <a href="thread.html#16862">[ thread ]</a>
              <a href="subject.html#16862">[ subject ]</a>
              <a href="author.html#16862">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
