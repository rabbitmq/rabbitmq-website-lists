<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Federation help
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20help&In-Reply-To=%3C4EE4E45A.4010909%402600hz.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016832.html">
   <LINK REL="Next"  HREF="016833.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Federation help</H1>
    <B>James Aimonetti</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20help&In-Reply-To=%3C4EE4E45A.4010909%402600hz.com%3E"
       TITLE="[rabbitmq-discuss] Federation help">james at 2600hz.com
       </A><BR>
    <I>Sun Dec 11 17:11:54 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016832.html">[rabbitmq-discuss] 505 UNEXPECTED_FRAME when publishing in a	consume handler using pika
</A></li>
        <LI>Next message: <A HREF="016833.html">[rabbitmq-discuss] Federation help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16827">[ date ]</a>
              <a href="thread.html#16827">[ thread ]</a>
              <a href="subject.html#16827">[ subject ]</a>
              <a href="author.html#16827">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Simon,

Not to be a bother or anything, but have you thought more about how to
handle the case where an application won't necessarily know if the
broker is using federation or not, and how the application can properly
declare the exchange?

We unfortunately can't ensure the exchanges are properly declared on
startup, so the application makes a point to declare them on init. If I
can declare it as federated and have the broker kick back an easily
parse-able error indicating to not use the federation exchange type, and
redeclare using the vanilla declaration, that would get me most of the
way there.

Happy holidays,

James


On 11/29/2011 03:01 AM, Simon MacMullen wrote:
&gt;<i> On 28/11/11 19:17, James Aimonetti wrote:
</I>&gt;&gt;<i> My app will be running in environments that aren't necessarily
</I>&gt;&gt;<i> federated, which is why I have my app declaring the exchanges on
</I>&gt;&gt;<i> startup. Do you have recommendations for how to handle this? If
</I>&gt;&gt;<i> federation is not enabled, and i declare the exchange as
</I>&gt;&gt;<i> 'x-federation' with type='direct' in the args, will RabbitMQ know to
</I>&gt;&gt;<i> declare the exchange as direct and not federated?
</I>&gt;<i> 
</I>&gt;<i> Ah, no.
</I>&gt;<i> 
</I>&gt;<i> Probably the best thing to do is require the federation plugin to always
</I>&gt;<i> be installed, and in the non-federated environments declare your
</I>&gt;<i> upstream_set(s) empty. This does require a bit of configuration on the
</I>&gt;<i> non-federated environments though. I'll have a think about whether this
</I>&gt;<i> can be improved.
</I>&gt;<i> 
</I>&gt;&gt;<i> As for the amqp_client/ERL_LIBS issue, I installed via tarball. Not
</I>&gt;&gt;<i> sure why starting up didn't have plugins/ in the code path. I'll
</I>&gt;&gt;<i> check the installed Erlang lib and see if a conflicting version made
</I>&gt;&gt;<i> it in there.
</I>&gt;<i> 
</I>&gt;<i> Thanks.
</I>&gt;<i> 
</I>&gt;<i> Cheers, Simon
</I>&gt;<i> 
</I>

- -- 
James Aimonetti
Distributed Systems Engineer / DJ MC_

2600hz | <A HREF="http://2600hz.com">http://2600hz.com</A>
sip:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">james at 2600hz.com</A>
tel: 415.886.7905
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org/">http://enigmail.mozdev.org/</A>

iQEcBAEBAgAGBQJO5ORaAAoJENc77s1OYoGgVdIH/1IEHp7dZNQ73BF31tL86Iw3
b507jpGkBajr4l2tizTVyF1j93FRl75bI2WDgSyb52DRXJs4eQcuJy7Csu2olM9l
873T60tHSa0t0ID7PI4xJ55X6YdkL63sf4h6zUgq6jQMCbNl2GA2x6aBLNNA06YE
WqiKoOM2Lyh2p9zPZs63h9zbl4aLdeITESvCzDTh7YiVXXYMeV6mgeYX5by+LonQ
vhc8O8xoGH3cMYzKWDMcuxTFsEe6urMFevEIxIKNWsj7G9s/pH7YgfjoRiQmmkZS
FyFrsK+mcYDsHRB5P/nJtiMc9C34Qp+wdW/y/vAlrtEAmZ4Bj2qYwCCw0Ov7dj8=
=GyBb
-----END PGP SIGNATURE-----
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016832.html">[rabbitmq-discuss] 505 UNEXPECTED_FRAME when publishing in a	consume handler using pika
</A></li>
	<LI>Next message: <A HREF="016833.html">[rabbitmq-discuss] Federation help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16827">[ date ]</a>
              <a href="thread.html#16827">[ thread ]</a>
              <a href="subject.html#16827">[ subject ]</a>
              <a href="author.html#16827">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
