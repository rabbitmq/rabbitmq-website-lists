<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ hangs, does not accept connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20hangs%2C%20does%20not%20accept%20connections&In-Reply-To=%3C4EFDC47D.7060204%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017066.html">
   <LINK REL="Next"  HREF="017069.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ hangs, does not accept connections</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20hangs%2C%20does%20not%20accept%20connections&In-Reply-To=%3C4EFDC47D.7060204%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ hangs, does not accept connections">matthias at rabbitmq.com
       </A><BR>
    <I>Fri Dec 30 14:02:37 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="017066.html">[rabbitmq-discuss] RabbitMQ hangs, does not accept connections
</A></li>
        <LI>Next message: <A HREF="017069.html">[rabbitmq-discuss] RabbitMQ hangs, does not accept connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17067">[ date ]</a>
              <a href="thread.html#17067">[ thread ]</a>
              <a href="subject.html#17067">[ subject ]</a>
              <a href="author.html#17067">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dmitri,

On 30/12/11 12:11, Matthias Radestock wrote:
&gt;<i> When the tcp stack notifies the acceptor of an error
</I>&gt;<i> other than 'closed', the acceptor carries on but does not invoke
</I>&gt;<i> prim_inet:async_accept/2 to be notified of the next connection attempt.
</I>&gt;<i>
</I>&gt;<i> I will file a bug for this. Should be easy to fix, though we cannot be
</I>&gt;<i> certain that this is definitely the problem.
</I>
Here's a proposed fix:

<A HREF="http://hg.rabbitmq.com/rabbitmq-server/rev/ca0392ca0fc1">http://hg.rabbitmq.com/rabbitmq-server/rev/ca0392ca0fc1</A>

I am attaching a tcp_acceptor.beam with that fix, compiled for R15, that 
you can drop in place of the existing file. I'd be interested a) if that 
solves the problem for you, and b) what error gets logged - watch out 
for s.t. like

=ERROR REPORT==== 30-Dec-2011::13:45:01 ===
failed to accept TCP connection on [::]:5672: some_error

in the logs.


Regards,

Matthias.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tcp_acceptor.beam
Type: application/octet-stream
Size: 4920 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111230/382db03a/attachment.obj">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111230/382db03a/attachment.obj</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017066.html">[rabbitmq-discuss] RabbitMQ hangs, does not accept connections
</A></li>
	<LI>Next message: <A HREF="017069.html">[rabbitmq-discuss] RabbitMQ hangs, does not accept connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17067">[ date ]</a>
              <a href="thread.html#17067">[ thread ]</a>
              <a href="subject.html#17067">[ subject ]</a>
              <a href="author.html#17067">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
