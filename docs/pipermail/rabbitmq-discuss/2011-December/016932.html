<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Running RabbitMQ as a different user
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Running%20RabbitMQ%20as%20a%20different%20user&In-Reply-To=%3CCB14FC86.23AD8%25mpietrek%40skytap.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016930.html">
   <LINK REL="Next"  HREF="016936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Running RabbitMQ as a different user</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Running%20RabbitMQ%20as%20a%20different%20user&In-Reply-To=%3CCB14FC86.23AD8%25mpietrek%40skytap.com%3E"
       TITLE="[rabbitmq-discuss] Running RabbitMQ as a different user">mpietrek at skytap.com
       </A><BR>
    <I>Mon Dec 19 22:47:18 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016930.html">[rabbitmq-discuss] Running RabbitMQ as a different user
</A></li>
        <LI>Next message: <A HREF="016936.html">[rabbitmq-discuss] Running RabbitMQ as a different user
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16932">[ date ]</a>
              <a href="thread.html#16932">[ thread ]</a>
              <a href="subject.html#16932">[ subject ]</a>
              <a href="author.html#16932">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Jason.

That's helpful, but in my admittedly limited knowledge, I don't believe that
it's as simple as that. In particular I don't understand how handle files
being installed with rabbitmq as the owner.

A little more context that I forgot to mention earlier:
* I need to cluster multiple nodes so explicitly specifying the cookie is
necessary so they're synced. Also, specifying the cookie via an environment
variable is preferred to having an additional cookie file that I need to
copy to multiple machines.
* I need to be able to launch everything from scratch via my own script file
(which will be on all nodes.)
My current thinking is that my startup script will set some RABBITMQ
environment variables (RABBITMQ_CONFIG_FILE, RABBITMQ_SERVER_START_ARGS,
RABBITMQ_CTL_ERL_ARGS,). The script will then directly run rabbit-server in
/usr/lib/rabbitmq/bin. Also, RABBITMQ_CONFIG_FILE will point to the
rabbitmq.config file that I've dropped on all nodes to set up auto
clustering.)

Thanks again,

Matt

On 12/19/11 2:31 PM, &quot;Jason J. W. Williams&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt;
wrote:

&gt;<i> Hi Matt,
</I>&gt;<i> 
</I>&gt;<i> This should do it on Ubuntu:
</I>&gt;<i> 
</I>&gt;<i> sudo -H -u &lt;user&gt; /opt/rabbitmq-server/sbin/rabbitmq-server
</I>&gt;<i> 
</I>&gt;<i> The Erlang process needs to find the Erlang cookie and will check the
</I>&gt;<i> home directory of the executing user. You can also specify the
</I>&gt;<i> explicit location of the Erlang cookie in the RabbitMQ arguments, but
</I>&gt;<i> we find using the HOME environment simpler.
</I>&gt;<i> 
</I>&gt;<i> -J
</I>&gt;<i> 
</I>&gt;<i> On Mon, Dec 19, 2011 at 2:58 PM, Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at skytap.com</A>&gt; wrote:
</I>&gt;&gt;<i>  We have a production environment where all of our services run in a special,
</I>&gt;&gt;<i>  non-root account an an Ubuntu 10.04 environment. I'm experimenting with how
</I>&gt;&gt;<i>  to make RabbitMQ 2.7 run in this special account, rather than as the
</I>&gt;&gt;<i>  &quot;rabbitmq&quot; user, and not having much luck.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  Extensive searching of the mailing list makes me think I'm close, but I
</I>&gt;&gt;<i>  suspect I'm missing something fundamental.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  I believe part of the answer involves explicitly setting the &quot;-cookie&quot;
</I>&gt;&gt;<i>  option in RABBITMQ_SERVER_START_ARGS and RABBITMQ_CTL_ERL_ARGS environment
</I>&gt;&gt;<i>  variables.
</I>&gt;&gt;<i>  I also suspect that the answer also involves running the &quot;low level&quot; scripts
</I>&gt;&gt;<i>  in /usr/lib/rabbitmq/bin/, rather than the scripts in /usr/sbin/.
</I>&gt;&gt;<i>  Further, I suspect that some directories may need to have their ownership
</I>&gt;&gt;<i>  and/or attributes changed to something other than &quot;rabbitmq&quot;.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  So what I'm looking for is a list of what exactly I need to do, both at
</I>&gt;&gt;<i>  launch time, as well as possibly at install time.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  FWIW, we need to launch rabbitmq-server ourselves, rather than having it
</I>&gt;&gt;<i>  auto start on boot. I know how to accomplish this, but it might be useful
</I>&gt;&gt;<i>  context when deciding how to approach the above.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  Thanks much,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  Matt
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  _______________________________________________
</I>&gt;&gt;<i>  rabbitmq-discuss mailing list
</I>&gt;&gt;<i>  <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i>  <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111219/cf348cc8/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111219/cf348cc8/attachment.htm</A>&gt;
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016930.html">[rabbitmq-discuss] Running RabbitMQ as a different user
</A></li>
	<LI>Next message: <A HREF="016936.html">[rabbitmq-discuss] Running RabbitMQ as a different user
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16932">[ date ]</a>
              <a href="thread.html#16932">[ thread ]</a>
              <a href="subject.html#16932">[ subject ]</a>
              <a href="author.html#16932">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
