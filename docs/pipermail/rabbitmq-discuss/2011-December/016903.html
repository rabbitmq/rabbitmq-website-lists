<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] dotnet client background thread
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20dotnet%20client%20background%20thread&In-Reply-To=%3C4EEB4751.3010108%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016898.html">
   <LINK REL="Next"  HREF="016905.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] dotnet client background thread</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20dotnet%20client%20background%20thread&In-Reply-To=%3C4EEB4751.3010108%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] dotnet client background thread">simon at rabbitmq.com
       </A><BR>
    <I>Fri Dec 16 13:27:45 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016898.html">[rabbitmq-discuss] dotnet client background thread
</A></li>
        <LI>Next message: <A HREF="016905.html">[rabbitmq-discuss] dotnet client background thread
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16903">[ date ]</a>
              <a href="thread.html#16903">[ thread ]</a>
              <a href="subject.html#16903">[ subject ]</a>
              <a href="author.html#16903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We've had this argument back and forth a bit for both the Java and .NET 
clients. The reason why we've been reluctant to do this is that by 
making connections use daemon / background threads we encourage a 
situation where connections don't get properly closed when your 
application shuts down.

So for example if your application publishes a load of messages and then 
exits, if we used background threads then things would appear to work 
but there would be no guarantee that all the messages would reach the 
broker.

So really the right thing to do is explicitly close connections at shut 
down - then you know that everything you thought the connections were 
doing is actually done.

Cheers, Simon

On 15/12/11 20:53, Eyal Post wrote:
&gt;<i> We have an issue with a .net client application that creates a
</I>&gt;<i> connection in order to publish message and caches this connection in a
</I>&gt;<i> variable. The problem is that when the program exits, it gets stuck in
</I>&gt;<i> memory because there is an AMQP thread that doesn&#8217;t exit.
</I>&gt;<i>
</I>&gt;<i> I&#8217;m not sure how the RabbitMQ threads are created but in .net there is
</I>&gt;<i> an option to set a thread as a background thread and in this case when
</I>&gt;<i> the application closes it will not wait for background threads to stop.
</I>&gt;<i> Is the .net client setting the background threads it creates background?
</I>&gt;<i> If not, can you change that?
</I>&gt;<i>
</I>&gt;<i> See here for more details:
</I>&gt;<i> <A HREF="http://msdn.microsoft.com/en-us/library/system.threading.thread.isbackground.aspx">http://msdn.microsoft.com/en-us/library/system.threading.thread.isbackground.aspx</A>
</I>&gt;<i>
</I>&gt;<i> Eyal Post
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ______________________________________________________________________
</I>&gt;<i> This email has been scanned by the Symantec Email Security.cloud service.
</I>&gt;<i> For more information please visit <A HREF="http://www.symanteccloud.com">http://www.symanteccloud.com</A>
</I>&gt;<i> ______________________________________________________________________
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016898.html">[rabbitmq-discuss] dotnet client background thread
</A></li>
	<LI>Next message: <A HREF="016905.html">[rabbitmq-discuss] dotnet client background thread
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16903">[ date ]</a>
              <a href="thread.html#16903">[ thread ]</a>
              <a href="subject.html#16903">[ subject ]</a>
              <a href="author.html#16903">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
