<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] using client from different threads
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20using%20client%20from%20different%20threads&In-Reply-To=%3C0C6DF4F4-01ED-43BF-87F5-347F8A8F5143%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016744.html">
   <LINK REL="Next"  HREF="016746.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] using client from different threads</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20using%20client%20from%20different%20threads&In-Reply-To=%3C0C6DF4F4-01ED-43BF-87F5-347F8A8F5143%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] using client from different threads">steve at rabbitmq.com
       </A><BR>
    <I>Mon Dec  5 17:35:58 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016744.html">[rabbitmq-discuss] using client from different threads
</A></li>
        <LI>Next message: <A HREF="016746.html">[rabbitmq-discuss] using client from different threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16745">[ date ]</a>
              <a href="thread.html#16745">[ thread ]</a>
              <a href="subject.html#16745">[ subject ]</a>
              <a href="author.html#16745">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>John,
Thanks for that -- I didn't understand your requirement properly.

I would tackle this by having an intermediate rpcServer which farms out the
requests (acting as a client) (to your shards) -- each of which is a single rpc
-- and accumulates the responses for the ultimate response to the original
request.  The original requestor makes a single request and gets back a single
response.

I now see where the added flexibility requirement in the RpcClient came from.

Of course, with routing doing the 'managing the shards' bit we have a lot of
messages arriving back in the same reply-to queue, so someone has to do the
accumulations, I can see that.  However, it wouldn't be hard to rewrite the
rpcClient for this particular case, provided you can decide how to accumulate in
the face of arbitrary numbers of responses.  The consumer would need to be more
intelligent, but what criteria you use for deciding you've had enough replies
and how to 'package' them up as a single response to the original request is
very application-specific, I think.

I don't see a way around you having to code the accumulation explicitly, unless
you know of a generally accepted multi-response scheme we should adopt?

Steve Powell  (a dazed bunny)
----------some more definitions from the SPD----------
avoirdupois (phr.) 'Would you like peas with that?'
distribute (v.) To denigrate an award ceremony.
definite (phr.) 'It's hard of hearing, I think.'
modest (n.) The most mod.

On 5 Dec 2011, at 16:38, john doe wrote:
&gt;<i> 
</I>&gt;<i> Dear Steve,
</I>&gt;<i>  
</I>&gt;<i> Actually I am dealing with a distributed database (kind of), and I am doing
</I>&gt;<i> things like sending the same request to different shards, every shard
</I>&gt;<i> processes it and replies to the sender, which will merge results. It is
</I>&gt;<i> pretty much like a map reduce job.
</I>&gt;<i>  
</I>&gt;<i> I found out that routing offers nice ways for handling this kind of
</I>&gt;<i> request/response schemes (for example, I can send one request to one
</I>&gt;<i> instance of each shard of my computing grid with only one publish).
</I>&gt;<i>  
</I>&gt;<i> So I think you misunderstood my point, it is nothing like concatenating
</I>&gt;<i> multiple response messaging, but like a more generic rpc.
</I>&gt;<i>  
</I>&gt;<i> John
</I></PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016744.html">[rabbitmq-discuss] using client from different threads
</A></li>
	<LI>Next message: <A HREF="016746.html">[rabbitmq-discuss] using client from different threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16745">[ date ]</a>
              <a href="thread.html#16745">[ thread ]</a>
              <a href="subject.html#16745">[ subject ]</a>
              <a href="author.html#16745">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
