<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-ha-test setup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-ha-test%20setup&In-Reply-To=%3C7E6BFF53-9AA9-4B02-9283-6FB4663478EB%40ihiji.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014872.html">
   <LINK REL="Next"  HREF="014874.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-ha-test setup</H1>
    <B>Brad Knowles</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-ha-test%20setup&In-Reply-To=%3C7E6BFF53-9AA9-4B02-9283-6FB4663478EB%40ihiji.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-ha-test setup">bknowles at ihiji.com
       </A><BR>
    <I>Fri Sep  2 19:29:15 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014872.html">[rabbitmq-discuss] rabbitmq-ha-test setup
</A></li>
        <LI>Next message: <A HREF="014874.html">[rabbitmq-discuss] rabbitmq-ha-test setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14873">[ date ]</a>
              <a href="thread.html#14873">[ thread ]</a>
              <a href="subject.html#14873">[ subject ]</a>
              <a href="author.html#14873">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sep 2, 2011, at 1:23 PM, Alexis Richardson wrote:

&gt;<i> Are you saying that mirror-queue management should be exposed
</I>&gt;<i> differently?  If so it might be worth commenting on the thread this
</I>&gt;<i> week where Jason and Matthew and Michael talk about that.
</I>
Well, according to the documentation at &lt;<A HREF="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</A>&gt;, mirrored queues have to be created explicitly within the code:

&gt;<i> Creating a mirrored-queue
</I>&gt;<i> 
</I>&gt;<i> A mirrored-queue must be created as a mirrored-queue. It is not possible to convert a non-mirrored-queue to a mirrored-queue at some later point. It is perfectly acceptable to create a mirrored-queue with no slaves initially, though be aware of the behaviour of adding nodes to a cluster.
</I>&gt;<i> 
</I>&gt;<i> To create a mirrored-queue, you provide an x-ha-policy entry in the argument table presented to queue.declare. The value of this entry is a long string which gives the name of the policy you wish to use for this queue. There are currently two policies available:        
</I>&gt;<i> 
</I>&gt;<i> 	&#8226; all: This policy ensures that a mirror of the queue will exist on every node in the cluster. When a new node joins the cluster, a mirror of the queue will be created on the new node. The queue's initial master will be on the node to which the client issuing the queue declare is connected.
</I>&gt;<i> 	&#8226; nodes: This policy allows you to specify the exact nodes on which you wish mirrors to exist. To do this, you provide an additional entry in the arguments table, with a key of x-ha-policy-params, and a value which is an array of long strings, each of which is a node name. The queue's initial master will be the first node in the list (and thus this node must exist and be reachable, even if it is not the node to which the client is connected), and slaves are created on the remaining nodes in the list. With this policy, you may declare a mirrored-queue with mirrors on a subset of the nodes in a cluster. You may also declare a mirrored-queue with slaves on nodes which are not currently members of the cluster: when such nodes join the cluster, a slave will automatically be created of the queue on that node. Note however that the mirror on the newly joined node will behave as a new slave. Also note that it is the node-names that must be provided, not host-name or IP address. It is an error to supply an empty array as the value of the x-ha-policy-params entry: the array must contain at least one element.
</I>
Personally, I don't want my programmers to have to know anything about the underlying implementation of how HA is provided, all they need to know is that I'm making sure that it's there.  The pacemaker solution is a bit of a kludgey way to do that, IMO.  And I definitely want our failover to be active/active and not active/passive.

If you can point me at the appropriate thread, I will definitely try to make some suitable comments over there.  Thanks!

&gt;<i> That aside, I would urge you to write a round robin exchange ;-)
</I>
In the DevOps field, I'm much more of an Ops type than a Dev type.  I can hope to understand some of the underlying infrastructure concepts and how things are logically put together, but I don't hold out much hope that I'll be able to write actual code to do that.

-- 
Brad Knowles &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">bknowles at ihiji.com</A>&gt;

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014872.html">[rabbitmq-discuss] rabbitmq-ha-test setup
</A></li>
	<LI>Next message: <A HREF="014874.html">[rabbitmq-discuss] rabbitmq-ha-test setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14873">[ date ]</a>
              <a href="thread.html#14873">[ thread ]</a>
              <a href="subject.html#14873">[ subject ]</a>
              <a href="author.html#14873">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
