<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] No IOException from basicPublish when connection	is lost
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20No%20IOException%20from%20basicPublish%20when%20connection%0A%09is%20lost&In-Reply-To=%3COF66564312.1A0944EC-ONC1257919.0045C0F7-C1257919.004CE23A%40Schneider-Electric.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015310.html">
   <LINK REL="Next"  HREF="015329.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] No IOException from basicPublish when connection	is lost</H1>
    <B>mikael.beauvois at non.schneider-electric.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20No%20IOException%20from%20basicPublish%20when%20connection%0A%09is%20lost&In-Reply-To=%3COF66564312.1A0944EC-ONC1257919.0045C0F7-C1257919.004CE23A%40Schneider-Electric.com%3E"
       TITLE="[rabbitmq-discuss] No IOException from basicPublish when connection	is lost">mikael.beauvois at non.schneider-electric.com
       </A><BR>
    <I>Wed Sep 28 14:59:46 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015310.html">[rabbitmq-discuss] Publisher acks/confirm select with amqp0.8 spec
</A></li>
        <LI>Next message: <A HREF="015329.html">[rabbitmq-discuss] No IOException from basicPublish when connection is lost
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15312">[ date ]</a>
              <a href="thread.html#15312">[ thread ]</a>
              <a href="subject.html#15312">[ subject ]</a>
              <a href="author.html#15312">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Hi,

I have a problem when I call the basicPublish method defined in the Channel
interface.

In my client, I create a Connection using the ConnectionFactory (
com.rabbitmq.client.ConnectionFactory) to the broker running on a remote
host (connected in the local network). Then I create a Channel from this
Connection.
I call the basicPublish method in a loop (waiting 10s between each
publish). During the test, I unplug the network cable from the client
running on the local host.
The basicPublish method doesn't throw any exception (I expected at least
IOException because the network connection is lost). All calls to
basicPublish method in the loop never raise the IOException exception (or
any other exception). Obviously, the broker never received the messages
sent after loosing the network connection.

A ShutdownListener has been implemented but the shutdownCompleted method
is called by the RabbitMQ java client stack around 15 minutes after
unplugging the network cable.

I also tested the disconnection using the command line in a terminal. The
results are the same.

I am running RabbitMQ broker 2.6.1 with the RabbitMQ java client , Linux
Ubuntu 11.04 with kernel 2.6.38-11 (x86) and I tested my code with 2 JVM
(OpenJDK and Java HotSpot 1.6.0 (build 1.6.0_27-b07)).

Please, could you help me?

Best regards

Mikael
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110928/77a365e6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110928/77a365e6/attachment.htm</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015310.html">[rabbitmq-discuss] Publisher acks/confirm select with amqp0.8 spec
</A></li>
	<LI>Next message: <A HREF="015329.html">[rabbitmq-discuss] No IOException from basicPublish when connection is lost
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15312">[ date ]</a>
              <a href="thread.html#15312">[ thread ]</a>
              <a href="subject.html#15312">[ subject ]</a>
              <a href="author.html#15312">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
