<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Stomp: after deleting a durable subscription,	message is still available
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Stomp%3A%20after%20deleting%20a%20durable%20subscription%2C%0A%09message%20is%20still%20available&In-Reply-To=%3Cj45oon%242fn%241%40dough.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014917.html">
   <LINK REL="Next"  HREF="014995.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Stomp: after deleting a durable subscription,	message is still available</H1>
    <B>Michael Justin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Stomp%3A%20after%20deleting%20a%20durable%20subscription%2C%0A%09message%20is%20still%20available&In-Reply-To=%3Cj45oon%242fn%241%40dough.gmane.org%3E"
       TITLE="[rabbitmq-discuss] Stomp: after deleting a durable subscription,	message is still available">michael.justin at gmx.net
       </A><BR>
    <I>Tue Sep  6 19:28:35 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014917.html">[rabbitmq-discuss] /api/aliveness-test broken on 2.6.0?
</A></li>
        <LI>Next message: <A HREF="014995.html">[rabbitmq-discuss] Stomp: after deleting a durable subscription,	message is still available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14915">[ date ]</a>
              <a href="thread.html#14915">[ thread ]</a>
              <a href="subject.html#14915">[ subject ]</a>
              <a href="author.html#14915">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In a test case, the Stomp client is able to receive messages from a 
topic after sending the &quot;delete durable subscription&quot; command as shown 
in <A HREF="http://www.rabbitmq.com/stomp.html">http://www.rabbitmq.com/stomp.html</A>

Is this a misunderstanding? I have used a unit test based on the similar 
feature in ActiveMQ which tries to read a message from a topic after the 
durable subscription has been removed. If a message can be read, the 
test fails. With RabbitMQ, this is the case, a message is still in the 
topic.

Many thanks in advance


Stomp log:

---- Create a durable subscription ------------------------------------
send:
CONNECT
login:guest
passcode:guest
client-id:durable-client-id



received:
CONNECTED
session:session-myExSC/0WqaZM9E+SF9hjQ==
heart-beat:0,0
version:1.0


send:
SUBSCRIBE
destination:/topic/TOOL.DEFAULT
receipt:yes
ack:auto
id:durable-subscription-name
persistent:true



received:
RECEIPT
receipt-id:yes


send:
DISCONNECT
client-id:durable-client-id



---- Send a Message that should be added to the durable sub -----------
send:
CONNECT
login:guest
passcode:guest
client-id:non-durable



received:
CONNECTED
session:session-IavksOGOZGIQFBvcAw5Sag==
heart-beat:0,0
version:1.0


send:
SEND
destination:/topic/TOOL.DEFAULT
content-length:9
persistent:true
content-type:text/plain

Message 1

send:
DISCONNECT
client-id:non-durable



---- Delete the subscription ------------------------------------------
send:
CONNECT
login:guest
passcode:guest
client-id:durable-client-id



received:
CONNECTED
session:session-P0Fetnb8moyqkmkRpYWCRA==
heart-beat:0,0
version:1.0


send:
UNSUBSCRIBE
id:durable-subscription-name
persistent:true



send:
DISCONNECT
client-id:durable-client-id



----- Activate the durable sub now and try to receive the message. -----
send:
CONNECT
login:guest
passcode:guest
client-id:durable-client-id



received:
CONNECTED
session:session-gRlqZ17pFswb2y3DJI/vsA==
heart-beat:0,0
version:1.0


send:
SUBSCRIBE
destination:/topic/TOOL.DEFAULT
receipt:yes
ack:auto
id:durable-subscription-name
persistent:true



received:
RECEIPT
receipt-id:yes


received:
MESSAGE
persistent:true
content-type:text/plain
subscription:durable-subscription-name
destination:/topic/TOOL.DEFAULT
message-id:T_durable-subscription-name@@session-gRlqZ17pFswb2y3DJI/vsA==@@1
content-length:9


send:
DISCONNECT
client-id:durable-client-id




</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014917.html">[rabbitmq-discuss] /api/aliveness-test broken on 2.6.0?
</A></li>
	<LI>Next message: <A HREF="014995.html">[rabbitmq-discuss] Stomp: after deleting a durable subscription,	message is still available
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14915">[ date ]</a>
              <a href="thread.html#14915">[ thread ]</a>
              <a href="subject.html#14915">[ subject ]</a>
              <a href="author.html#14915">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
