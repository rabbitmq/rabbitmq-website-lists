<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Issue: user is able to publish to queue that he does not have write permission to
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%3A%20user%20is%20able%20to%20publish%20to%20queue%20that%20he%0A%20does%20not%20have%20write%20permission%20to&In-Reply-To=%3C4E60F2C9.3030800%40nffs.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014861.html">
   <LINK REL="Next"  HREF="014880.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Issue: user is able to publish to queue that he does not have write permission to</H1>
    <B>Bill Gerrard</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%3A%20user%20is%20able%20to%20publish%20to%20queue%20that%20he%0A%20does%20not%20have%20write%20permission%20to&In-Reply-To=%3C4E60F2C9.3030800%40nffs.com%3E"
       TITLE="[rabbitmq-discuss] Issue: user is able to publish to queue that he does not have write permission to">billg at nffs.com
       </A><BR>
    <I>Fri Sep  2 16:14:17 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014861.html">[rabbitmq-discuss] Unable to manage Service after log off
</A></li>
        <LI>Next message: <A HREF="014880.html">[rabbitmq-discuss] Issue: user is able to publish to queue that he does not have write permission to
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14863">[ date ]</a>
              <a href="thread.html#14863">[ thread ]</a>
              <a href="subject.html#14863">[ subject ]</a>
              <a href="author.html#14863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Testing permissions and discovered user is able to publish to queue that 
he does not have write permission to.

Can anyone else duplicate?  If so, is this fixed on 2.6.0?

Running RabbitMQ 2.5.1 on debian

Permissions on /:
user    configure    write                read
nf    .*    ^nf_to_da.*|amq\\.default|test_.*    ^da_to_nf.*|test_.*

testing as user nf:
1) publish to nf_to_da queue -&gt; publish successful (correct)
2) read from da_to_nf queue -&gt; read successful (correct)
3) publish to da_to_nf queue -&gt; publish successful! (should be denied) &lt;====
4) read from nf_to_da queue -&gt; read denied (correct)


Client is written in perl using Net::RabbitMQ (same results when using 
python examples from tutorial)
Logged in as user 'nf'
publish to nf_to_da
...success
publish to da_to_nf (should fail)
...success
consume from da_to_nf
...success
consume from nf_to_da (should fail)
Get failure for queue 'nf_to_da': Consume queue: server channel error 
403, message: ACCESS_REFUSED - access to queue 'nf_to_da' in vhost '/' 
refused for user 'nf'



Log from RabbitMQ message broker:

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
accepted TCP connection on [::]:5672 from 10.1.0.27:43796

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
starting TCP connection &lt;0.11704.25&gt; from 10.1.0.27:43796

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
closing TCP connection &lt;0.11704.25&gt; from 10.1.0.27:43796


=INFO REPORT==== 2-Sep-2011::09:01:58 ===
accepted TCP connection on [::]:5672 from 10.1.0.27:43797

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
starting TCP connection &lt;0.11711.25&gt; from 10.1.0.27:43797

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
closing TCP connection &lt;0.11711.25&gt; from 10.1.0.27:43797


=INFO REPORT==== 2-Sep-2011::09:01:58 ===
accepted TCP connection on [::]:5672 from 10.1.0.27:43798

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
starting TCP connection &lt;0.11719.25&gt; from 10.1.0.27:43798

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
closing TCP connection &lt;0.11719.25&gt; from 10.1.0.27:43798


=INFO REPORT==== 2-Sep-2011::09:01:58 ===
accepted TCP connection on [::]:5672 from 10.1.0.27:43799

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
starting TCP connection &lt;0.11733.25&gt; from 10.1.0.27:43799

=ERROR REPORT==== 2-Sep-2011::09:01:58 ===
connection &lt;0.11733.25&gt;, channel 1 - error:
{amqp_error,access_refused,
             &quot;access to queue 'nf_to_da' in vhost '/' refused for user 
'nf'&quot;,
             'basic.consume'}

=INFO REPORT==== 2-Sep-2011::09:01:58 ===
closing TCP connection &lt;0.11733.25&gt; from 10.1.0.27:43799

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014861.html">[rabbitmq-discuss] Unable to manage Service after log off
</A></li>
	<LI>Next message: <A HREF="014880.html">[rabbitmq-discuss] Issue: user is able to publish to queue that he does not have write permission to
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14863">[ date ]</a>
              <a href="thread.html#14863">[ thread ]</a>
              <a href="subject.html#14863">[ subject ]</a>
              <a href="author.html#14863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
