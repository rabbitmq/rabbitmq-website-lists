<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] .NET Client - IModel.Close completes but the model is never actually shut down.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20.NET%20Client%20-%20IModel.Close%20completes%20but%20the%0A%20model%20is%20never%20actually%20shut%20down.&In-Reply-To=%3CCANVKUrWyc10%2B8EXNPQ5Z8D__uhW5GZenWjGWgf7%2Bx88jxmF4zA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015182.html">
   <LINK REL="Next"  HREF="015168.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] .NET Client - IModel.Close completes but the model is never actually shut down.</H1>
    <B>Eugene Kirpichov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20.NET%20Client%20-%20IModel.Close%20completes%20but%20the%0A%20model%20is%20never%20actually%20shut%20down.&In-Reply-To=%3CCANVKUrWyc10%2B8EXNPQ5Z8D__uhW5GZenWjGWgf7%2Bx88jxmF4zA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] .NET Client - IModel.Close completes but the model is never actually shut down.">ekirpichov at gmail.com
       </A><BR>
    <I>Mon Sep 19 18:44:10 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015182.html">[rabbitmq-discuss] JSON-RPC channel plugin crash	on	tuple_to_list(Props)
</A></li>
        <LI>Next message: <A HREF="015168.html">[rabbitmq-discuss] .NET Client - IModel.Close completes but the model is never actually shut down.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15165">[ date ]</a>
              <a href="thread.html#15165">[ thread ]</a>
              <a href="subject.html#15165">[ subject ]</a>
              <a href="author.html#15165">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a piece of code that consumes a queue.

Then the following happens:
* A message arrives to the consumer (HandleBasicDeliver)
* At the same time (up to fractions of a millisecond) I'm doing
IModel.Close() on this model, which completes ok.
* I open another channel on this connection, which works fine.
* That one consumer never gets a HandleModelShutdown() or OnCancel()
event, and in fact the consumer remains visible in the management
interface for many hours after these events, holding the
unacknowledged message.

I'm using RabbitMQ 2.6.1 and the .NET client 2.6.0.0.

What can I do to diagnose this?
Can this be a bug in the .NET client, or am I misusing it?
I have a RabbitMQ log, I have a memory dump of my .NET client process.

-- 
Eugene Kirpichov
Principal Engineer, Mirantis Inc. <A HREF="http://www.mirantis.com/">http://www.mirantis.com/</A>
Editor, <A HREF="http://fprog.ru/">http://fprog.ru/</A>
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015182.html">[rabbitmq-discuss] JSON-RPC channel plugin crash	on	tuple_to_list(Props)
</A></li>
	<LI>Next message: <A HREF="015168.html">[rabbitmq-discuss] .NET Client - IModel.Close completes but the model is never actually shut down.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15165">[ date ]</a>
              <a href="thread.html#15165">[ thread ]</a>
              <a href="subject.html#15165">[ subject ]</a>
              <a href="author.html#15165">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
