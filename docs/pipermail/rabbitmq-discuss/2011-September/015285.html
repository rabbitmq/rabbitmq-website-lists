<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Clustering and data partitioning - how best to implement
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20and%20data%20partitioning%20-%20how%20best%0A%20to%20implement&In-Reply-To=%3CBDE140BF4C952041931EF8CAAC83341D026B6B8E31%40exch-mbx-111.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015281.html">
   <LINK REL="Next"  HREF="015287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Clustering and data partitioning - how best to implement</H1>
    <B>Helena Edelson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20and%20data%20partitioning%20-%20how%20best%0A%20to%20implement&In-Reply-To=%3CBDE140BF4C952041931EF8CAAC83341D026B6B8E31%40exch-mbx-111.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Clustering and data partitioning - how best to implement">hedelson at vmware.com
       </A><BR>
    <I>Tue Sep 27 01:06:14 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015281.html">[rabbitmq-discuss] Clustering and data partitioning - how best	to implement
</A></li>
        <LI>Next message: <A HREF="015287.html">[rabbitmq-discuss] Clustering and data partitioning - how best	to implement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15285">[ date ]</a>
              <a href="thread.html#15285">[ thread ]</a>
              <a href="subject.html#15285">[ subject ]</a>
              <a href="author.html#15285">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Justin,

Luckily, things are much simpler than what your questions lead to :-)

I think you're looking for is the round robin/competing consumers. I had a typo on that blog post which is now fixed that may have caused confusion.
Queue -&gt; multiple consumers  <A HREF="http://www.rabbitmq.com/tutorials/tutorial-two-python.html">http://www.rabbitmq.com/tutorials/tutorial-two-python.html</A>
Your producer simply publishes to exchanges. The RabbitMQ server knows where to route the messages (via bindings between queues and exchanges), the Producer is decoupled completely from any endpoint awareness. This decoupling is key.
 
Do look at <A HREF="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</A> also talks about queues in a cluster. It will answer a lot of your questions. 

You definitely want more than one queue...particularly if you are in any kind of scalable heavy load situation. Generally you have many queues, often partitioned logically. Do take note the performance issues to watch for in the post.

I hope that helps a bit, 
Helena  
________________________________________
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>] On Behalf Of Alexis Richardson [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>]
Sent: Monday, September 26, 2011 2:10 PM
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">justin.adam.miller at gmail.com</A>
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Clustering and data partitioning - how best to implement

Does this help?

<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-September/015263.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-September/015263.html</A>




On Mon, Sep 26, 2011 at 9:05 PM, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">justin.adam.miller at gmail.com</A>
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">justin.adam.miller at gmail.com</A>&gt; wrote:
&gt;<i> I'm trying to implement some of the ideas from this article:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://blog.springsource.com/2011/04/01/routing-topologies-for-performance-and-scalability-with-rabbitmq/">http://blog.springsource.com/2011/04/01/routing-topologies-for-performance-and-scalability-with-rabbitmq/</A>
</I>&gt;<i>
</I>&gt;<i> Our situation is that we have two rabbit instances, not clustered, so
</I>&gt;<i> that we can spread out load. In our current setup, it's still possible
</I>&gt;<i> for us to hit one broker harder than the other, so ideally we'd like
</I>&gt;<i> to setup these nodes in a cluster. That way, we can have consumers
</I>&gt;<i> evenly distributed across brokers.
</I>&gt;<i>
</I>&gt;<i> We could create one queue that all consumers consume from, but I'm not
</I>&gt;<i> sure that would solve our problems since that queue (and the broker it
</I>&gt;<i> was created on) would become a hotspot. Right?
</I>&gt;<i>
</I>&gt;<i> So from that article, I like the idea of each node creating a queue,
</I>&gt;<i> e.g. myQueue.1, myQueue.2, etc. and having the producer round robin
</I>&gt;<i> them. What I don't know, is how the producer knows how many queues/
</I>&gt;<i> nodes there are. The producers could send to an exchange and just set
</I>&gt;<i> the routingKey, but still, I think the problem is the same.
</I>&gt;<i>
</I>&gt;<i> I guess I could use the management plugin, but I'm trying to figure
</I>&gt;<i> out how to do that without issuing a request for every message I
</I>&gt;<i> produce.
</I>&gt;<i>
</I>&gt;<i> I could imagine some kind of handshake when a producer comes online,
</I>&gt;<i> he sends a &quot;who's-alive&quot; message to a topic exchange and waits for
</I>&gt;<i> responses from consumers. Also, when a consumer comes online, he
</I>&gt;<i> immediately sends out a &quot;I'm-alive&quot; message. In a direct exchange
</I>&gt;<i> (either the default or one that I create), is a routingKey assumed to
</I>&gt;<i> be a queue name? If I made the queues auto_delete, what would happen
</I>&gt;<i> when the producer tries to send a message to a queue that no longer
</I>&gt;<i> exists? Would I get an exception such that I can catch it and send the
</I>&gt;<i> message to the next guy in the list?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Justin
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I></PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015281.html">[rabbitmq-discuss] Clustering and data partitioning - how best	to implement
</A></li>
	<LI>Next message: <A HREF="015287.html">[rabbitmq-discuss] Clustering and data partitioning - how best	to implement
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15285">[ date ]</a>
              <a href="thread.html#15285">[ thread ]</a>
              <a href="subject.html#15285">[ subject ]</a>
              <a href="author.html#15285">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
