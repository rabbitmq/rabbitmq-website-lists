<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Streaming Lightweight Publisher Confirms ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Streaming%20Lightweight%20Publisher%20Confirms%20%3F&In-Reply-To=%3C20110923101816.GB10396%40southbank.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015209.html">
   <LINK REL="Next"  HREF="015211.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Streaming Lightweight Publisher Confirms ?</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Streaming%20Lightweight%20Publisher%20Confirms%20%3F&In-Reply-To=%3C20110923101816.GB10396%40southbank.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Streaming Lightweight Publisher Confirms ?">alexandru at rabbitmq.com
       </A><BR>
    <I>Fri Sep 23 11:18:16 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015209.html">[rabbitmq-discuss]  Streaming Lightweight Publisher Confirms ?
</A></li>
        <LI>Next message: <A HREF="015211.html">[rabbitmq-discuss] check if queue is empty?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15239">[ date ]</a>
              <a href="thread.html#15239">[ thread ]</a>
              <a href="subject.html#15239">[ subject ]</a>
              <a href="author.html#15239">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i>  1.if publish send message from queue and consumer doesn't return any 
</I>&gt;<i>  acknowledgement in this case broker what to do?
</I>
On the broker: if the consumer doesn't acknowledge a message, the
message is kept until the consumer disconnects; at that point the
message is re-inserted on the queue.  The message is not considered
delivered until the consumer acknowledges it, so it will not cause a
publisher confirm to be issued.  Of course, while the broker is waiting
for the consumer to acknowledge the message, it may write it to disk, in
which case, the publisher confirm is issued immediately.

&gt;<i>  2. if broker is restart or crash in this period,it can store the 
</I>&gt;<i>  unacknowledged message and resend to consumer.
</I>
Maybe.  If the publisher confirm was issued, and the broker crashes,
when it comes back up, it will attempt to re-deliver the message.  If
the publisher confirm was *not* issued, the message was probably
lost and the publisher will need to re-publish the message.

&gt;<i>  3. Is there is method to check all Publisher Confirmation.
</I>
What the publisher should probably do is this:
  1. confirmSelect the channel;
  2. publish some messages;
  3. call waitForConfirmsOrDie;
    3.1 if an exception was raised, the messages were probably lost and
    they need to be re-published;
    3.2 if no exception was raised, the broker has either written the
    messages to disk (and they will survive a broker restart) or it has
    delivered the messages to all consumers (and they have ack'd), so
    everything is fine and you can start publishing other messages.

Hope this clears things up.

Cheers,
Alex

On Wed, Sep 21, 2011 at 04:19:14AM -0700, sameekmishra wrote:
&gt;<i> 
</I>&gt;<i> Hi
</I>&gt;<i>  
</I>&gt;<i>  I want to make sure using channel confirmation.i have following 
</I>&gt;<i>  question using Streaming Lightweight Publisher Confirms:
</I>&gt;<i>  
</I>&gt;<i>  1.if publish send message from queue and consumer doesn't return any 
</I>&gt;<i>  acknowledgement in this case broker what to do?
</I>&gt;<i>  
</I>&gt;<i>  2. if broker is restart or crash in this period,it can store the 
</I>&gt;<i>  unacknowledged message and resend to consumer.
</I>&gt;<i> 
</I>&gt;<i>  3. Is there is method to check all Publisher Confirmation.
</I>&gt;<i> 
</I>&gt;<i>  Thanks
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> View this message in context: <A HREF="http://old.nabble.com/Streaming-Lightweight-Publisher-Confirms---tp32503738p32503738.html">http://old.nabble.com/Streaming-Lightweight-Publisher-Confirms---tp32503738p32503738.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015209.html">[rabbitmq-discuss]  Streaming Lightweight Publisher Confirms ?
</A></li>
	<LI>Next message: <A HREF="015211.html">[rabbitmq-discuss] check if queue is empty?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15239">[ date ]</a>
              <a href="thread.html#15239">[ thread ]</a>
              <a href="subject.html#15239">[ subject ]</a>
              <a href="author.html#15239">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
