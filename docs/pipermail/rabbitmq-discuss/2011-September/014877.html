<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Librabbitmq-c API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Librabbitmq-c%20API&In-Reply-To=%3Cyrv4c8vq67hi2.fsf%40dwragg.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014868.html">
   <LINK REL="Next"  HREF="014851.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Librabbitmq-c API</H1>
    <B>David Wragg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Librabbitmq-c%20API&In-Reply-To=%3Cyrv4c8vq67hi2.fsf%40dwragg.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Librabbitmq-c API">david at rabbitmq.com
       </A><BR>
    <I>Fri Sep  2 22:37:41 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014868.html">[rabbitmq-discuss] Librabbitmq-c API
</A></li>
        <LI>Next message: <A HREF="014851.html">[rabbitmq-discuss] Unable to manage Service after log off
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14877">[ date ]</a>
              <a href="thread.html#14877">[ thread ]</a>
              <a href="subject.html#14877">[ subject ]</a>
              <a href="author.html#14877">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alex P &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">oleksandr.petrov at gmail.com</A>&gt; writes:
&gt;<i> As far as I understood, that even though Librabbitmq is event-driven, it
</I>&gt;<i> doesn't mean it's non-blocking, right?
</I>
Correct.  librabbitmq does not really support non-blocking use.

&gt;<i> For instance, wait_frame_inner is blocking until we recv() is responding
</I>&gt;<i> with something useful.
</I>&gt;<i>
</I>&gt;<i> Are there ways to work it around? We actually need some non-blocking
</I>&gt;<i> approach, since we want to be able to send heartbeats and do many other
</I>&gt;<i> things in same thread, while we have no data available.
</I>&gt;<i>
</I>&gt;<i> Actually, just changing that function would change many things. As far as I
</I>&gt;<i> can tell, Send() calls are currently blocking as well, even though they're
</I>&gt;<i> unlikely to block cycle for long time.
</I>&gt;<i>
</I>&gt;<i> Should we just use several threads and create a connection per thread, or
</I>&gt;<i> there are better approaches that were built into the lib?
</I>
It's better to use threads that to try to persuade librabbitmq to do
non-blocking operation.

&gt;<i> Thanks for the help, again.
</I>&gt;<i> It seems that something is causing basic_get to eat out memory when ran in
</I>&gt;<i> cycle. If i manage to reproduce it without app itself and have more info,
</I>&gt;<i> i'll file a bug-report. For now it may very well be my mistake(
</I>
Make sure you call amqp_maybe_release_buffers when you are finished with
each message, as shown at
&lt;<A HREF="https://github.com/rabbitmq/rabbitmq-c/blob/master/tools/consume.c#L149">https://github.com/rabbitmq/rabbitmq-c/blob/master/tools/consume.c#L149</A>&gt;.

-- 
David Wragg
Staff Engineer, RabbitMQ
VMware, Inc.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014868.html">[rabbitmq-discuss] Librabbitmq-c API
</A></li>
	<LI>Next message: <A HREF="014851.html">[rabbitmq-discuss] Unable to manage Service after log off
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14877">[ date ]</a>
              <a href="thread.html#14877">[ thread ]</a>
              <a href="subject.html#14877">[ subject ]</a>
              <a href="author.html#14877">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
