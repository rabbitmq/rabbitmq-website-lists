<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Thread locked
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Thread%20locked&In-Reply-To=%3C4541_1315496193_4E68E101_4541_78283_2_4E68E101.9060307%40orange-ftgroup.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014977.html">
   <LINK REL="Next"  HREF="014984.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Thread locked</H1>
    <B>jeanphilippe1.caruana at orange-ftgroup.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Thread%20locked&In-Reply-To=%3C4541_1315496193_4E68E101_4541_78283_2_4E68E101.9060307%40orange-ftgroup.com%3E"
       TITLE="[rabbitmq-discuss] Thread locked">jeanphilippe1.caruana at orange-ftgroup.com
       </A><BR>
    <I>Thu Sep  8 16:36:33 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014977.html">[rabbitmq-discuss] Compatibility AMQP 0.9.1/1.0.0
</A></li>
        <LI>Next message: <A HREF="014984.html">[rabbitmq-discuss] Thread locked
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14981">[ date ]</a>
              <a href="thread.html#14981">[ thread ]</a>
              <a href="subject.html#14981">[ subject ]</a>
              <a href="author.html#14981">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We use RabbitMQ 2.2.0 broker with the 1.8.0 java client.
Producers (direct exhange) are inside webapps (tomcat 6) that go to out 
of memory error and we can't explain why. When we do a thread dump, we 
can see we have a locked thread here :

&quot;TP-Processor5744&quot; daemon prio=1 tid=0x1b974760 nid=0x7687 runnable 
[0x1430b000..0x1430be40]
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)
- locked &lt;0x2eb153f8&gt; (a java.io.BufferedOutputStream)
at java.io.DataOutputStream.flush(DataOutputStream.java:106)
at 
com.rabbitmq.client.impl.SocketFrameHandler.writeFrame(SocketFrameHandler.java:146)
- locked &lt;0x2eb152d0&gt; (a java.io.DataOutputStream)
at com.rabbitmq.client.impl.AMQConnection.writeFrame(AMQConnection.java:425)
at com.rabbitmq.client.impl.AMQCommand.transmit(AMQCommand.java:182)
at 
com.rabbitmq.client.impl.AMQChannel.quiescingTransmit(AMQChannel.java:315)
- locked &lt;0x2eb1dc10&gt; (a java.lang.Object)
at com.rabbitmq.client.impl.AMQChannel.transmit(AMQChannel.java:291)
- locked &lt;0x2eb1dc10&gt; (a java.lang.Object)
at com.rabbitmq.client.impl.ChannelN.basicPublish(ChannelN.java:403)
at com.rabbitmq.client.impl.ChannelN.basicPublish(ChannelN.java:390)


What is going wrong ?
How can java.net.SocketOutputStream.socketWrite be locking everything else ?
How much asynchronous is publishing ?

thanks

-- 
Jean-Philippe Caruana
























********************************************************************************
IMPORTANT.Les informations contenues dans ce message electronique y compris les fichiers attaches sont strictement confidentielles
et peuvent etre protegees par la loi.
Ce message electronique est destine exclusivement au(x) destinataire(s) mentionne(s) ci-dessus.
Si vous avez recu ce message par erreur ou s il ne vous est pas destine, veuillez immediatement le signaler  a l expediteur et effacer ce message 
et tous les fichiers eventuellement attaches.
Toute lecture, exploitation ou transmission des informations contenues dans ce message est interdite.
Tout message electronique est susceptible d alteration.
A ce titre, le Groupe France Telecom decline toute responsabilite notamment s il a ete altere, deforme ou falsifie.
De meme, il appartient au destinataire de s assurer de l absence de tout virus.

IMPORTANT.This e-mail message and any attachments are strictly confidential and may be protected by law. This message is
intended only for the named recipient(s) above.
If you have received this message in error, or are not the named recipient(s), please immediately notify the sender and delete this e-mail message.
Any unauthorized view, usage or disclosure ofthis message is prohibited.
Since e-mail messages may not be reliable, France Telecom Group shall not be liable for any message if modified, changed or falsified.
Additionally the recipient should ensure they are actually virus free.
********************************************************************************

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014977.html">[rabbitmq-discuss] Compatibility AMQP 0.9.1/1.0.0
</A></li>
	<LI>Next message: <A HREF="014984.html">[rabbitmq-discuss] Thread locked
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14981">[ date ]</a>
              <a href="thread.html#14981">[ thread ]</a>
              <a href="subject.html#14981">[ subject ]</a>
              <a href="author.html#14981">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
