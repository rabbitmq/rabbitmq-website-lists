<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] listnening on two queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20listnening%20on%20two%20queues&In-Reply-To=%3C1393066539.43883.YahooMailNeo%40web121704.mail.ne1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034059.html">
   <LINK REL="Next"  HREF="034039.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] listnening on two queues</H1>
    <B>Jano Kianicka</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20listnening%20on%20two%20queues&In-Reply-To=%3C1393066539.43883.YahooMailNeo%40web121704.mail.ne1.yahoo.com%3E"
       TITLE="[rabbitmq-discuss] listnening on two queues">kianicka123jano at yahoo.com
       </A><BR>
    <I>Sat Feb 22 10:55:39 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034059.html">[rabbitmq-discuss] ACKs getting lost
</A></li>
        <LI>Next message: <A HREF="034039.html">[rabbitmq-discuss] listnening on two queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34038">[ date ]</a>
              <a href="thread.html#34038">[ thread ]</a>
              <a href="subject.html#34038">[ subject ]</a>
              <a href="author.html#34038">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear RabbitMQ users and developers,
We are starting now implementation of one project for an enterprise system where we replace Oracle Tuxedo by an open source solution. There are implemented more Tuxedo servers in C, which can receive signals and messages from Tuxedo queues and direct calls as well. The servers are also monitored and controlled by Tuxedo. We are implementing proof-of-concept by migrating original code and replacing original Tuxedo calls with RabbitMQ functionality. We use librabbitmq (rabbitmq-c client library of AMQP). 

And I have several questions:
1. When we use routing messages through a custom exchange and bindings, and if there is some error, for instance wrong queue name or wrong routing key given, is it possible to obtain some error response from RabbitMQ server? Up to now what I did testing, the messages were just silently lost.

2. We are thinking about having clients and producers controlled by special set of queues. So one component will listen on two or more queues. One will deliver business process messages which carry data processing information, but other queue will carry control commands. This control queue must have higher priority even when main business process queue is full of messages. I did the following test:

/* Initialization of consuming properties - consumer priority */
&#160; amqp_table_t queue_table;
&#160; amqp_table_entry_t&#160; entry;
&#160; entry.key = amqp_cstring_bytes(&quot;x-priority&quot;);
&#160; entry.value.kind =&#160; AMQP_FIELD_KIND_U32;
&#160; entry.value.value.u32 = 1;
&#160; queue_table.num_entries = 1;
&#160; queue_table.entries = &entry;

/* Start listening on two queues */
&#160; while (1) {
&#160;&#160;&#160; &#160; &#160;&#160;&#160; amqp_basic_consume(conn, 1, amqp_cstring_bytes(queuename1), amqp_empty_bytes, 0, 0, 0, amqp_empty_table);
&#160;&#160;&#160; &#160;&#160;&#160; die_on_amqp_error(amqp_get_rpc_reply(conn), &quot;Consuming&quot;);

&#160;&#160;&#160; &#160; &#160;&#160;&#160; amqp_basic_consume(conn, 1, amqp_cstring_bytes(queuename2), amqp_empty_bytes, 0, 0, 0, queue_table);
&#160;&#160;&#160; &#160;&#160;&#160; die_on_amqp_error(amqp_get_rpc_reply(conn), &quot;Consuming&quot;);

But when this consumer test was executed, the following error occured:
queue2 x-priority: 1 
Consuming: a socket error occurred

When there was amqp_empty_table for both, it was consuming messages from both queues but in a random manner, sometimes even 4 messages from one and then three messages from the other. We need to have higher priority on the control queue.

Don't you have some experience or idea what should be changed to call the basic_consume correctly?

3. We appreciate very much that there is more verbose documentation of methods in rabbitmq-c. But I miss a little documentation of possible options for various structures, for instance the structure amqp_basic_properties_t, what are possible options for content_type, content_encoding etc. Where is most proper place to seek for this input arguments options?

Thank you very much for any advise. 

Kind regards
Jan Kianicka
AWST, Wien
Austria
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140222/3b70c29e/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140222/3b70c29e/attachment.html</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034059.html">[rabbitmq-discuss] ACKs getting lost
</A></li>
	<LI>Next message: <A HREF="034039.html">[rabbitmq-discuss] listnening on two queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34038">[ date ]</a>
              <a href="thread.html#34038">[ thread ]</a>
              <a href="subject.html#34038">[ subject ]</a>
              <a href="author.html#34038">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
