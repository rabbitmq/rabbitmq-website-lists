<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [rabbitmq-c-master] memory leakinkg while	reconnect.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Brabbitmq-c-master%5D%20memory%20leakinkg%20while%0A%09reconnect.&In-Reply-To=%3C27E054594442884E9A46DBCF9AE7408164FCD4%40BSDMSATMBX001.mahindrasatyam.ad%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033751.html">
   <LINK REL="Next"  HREF="033749.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [rabbitmq-c-master] memory leakinkg while	reconnect.</H1>
    <B>Rohit Patle</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Brabbitmq-c-master%5D%20memory%20leakinkg%20while%0A%09reconnect.&In-Reply-To=%3C27E054594442884E9A46DBCF9AE7408164FCD4%40BSDMSATMBX001.mahindrasatyam.ad%3E"
       TITLE="[rabbitmq-discuss] [rabbitmq-c-master] memory leakinkg while	reconnect.">Rohit.Patle at techmahindra.com
       </A><BR>
    <I>Wed Feb 12 06:02:27 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033751.html">[rabbitmq-discuss] Performance Observations and Interesting	Behavior
</A></li>
        <LI>Next message: <A HREF="033749.html">[rabbitmq-discuss] [rabbitmq-c-master] memory leakinkg while	reconnect.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33734">[ date ]</a>
              <a href="thread.html#33734">[ thread ]</a>
              <a href="subject.html#33734">[ subject ]</a>
              <a href="author.html#33734">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alan,

Thank you for your reply. Sure I will take care of addressing my mail to rabbitmq-discuss only.

Here is our observation.
1. Network cable is pulled off from my system.
2. The listener program is in a while loop trying to reconnect to RMQ broker.
3. Following are the set of APIs called in this while loop.

while(1)
{
   conn = amqp_new_connection();

  socket = amqp_ssl_socket_new(conn);
  if (!socket) {
    printf(&quot;creating SSL/TLS socket&quot;);
    exit (0);
  }

  if (argc &gt; 5) {
    status = amqp_ssl_socket_set_cacert(socket, argv[5]);
    if (status) {
      printf(&quot;setting CA certificate&quot;);
      exit (0);
    }
  }

  if (argc &gt; 7) {
    status = amqp_ssl_socket_set_key(socket, argv[7], argv[6]);
    if (status) {
      printf(&quot;setting client cert&quot;);
      exit (0);
    }
  }
  amqp_ssl_socket_set_verify(socket, 0);
  status = amqp_socket_open(socket, hostname, port);
  if (status) {
    printf(&quot;opening SSL/TLS connection&quot;);
    amqp_destroy_connection(conn);
 }
else
    break;
}

4. As network cable is removed from my system before running this test program, I getting &quot;opening SSL/TLS connection&quot; which is a valid error (status value -9). However amqp_destroy_connection() API is not releasing the resources allocated during amqp_new_connection() API call. Could you please confirm the behaviour of amqp_destroy_connection() API when there is no network cable attached to the system? There is memory leak happening due to this API.

How to destroy the amqp_connection_state_t object created during amqp_new_connection()?

Please suggest.

Thanks &amp; Regards,
Rohit

________________________________

DISCLAIMER:
This email (including any attachments) is intended for the sole use of the intended recipient/s and may contain material that is CONFIDENTIAL AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or copying or distribution or forwarding of any or all of the contents in this message is STRICTLY PROHIBITED. If you are not the intended recipient, please contact the sender by email and delete all copies; your cooperation in this regard is appreciated.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140212/6ee223ec/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140212/6ee223ec/attachment.html</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033751.html">[rabbitmq-discuss] Performance Observations and Interesting	Behavior
</A></li>
	<LI>Next message: <A HREF="033749.html">[rabbitmq-discuss] [rabbitmq-c-master] memory leakinkg while	reconnect.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33734">[ date ]</a>
              <a href="thread.html#33734">[ thread ]</a>
              <a href="subject.html#33734">[ subject ]</a>
              <a href="author.html#33734">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
