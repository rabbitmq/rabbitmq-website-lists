<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Autoheal failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Autoheal%20failure&In-Reply-To=%3CB0651F6D-873E-4DDF-A9A0-5DB5D7051205%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033703.html">
   <LINK REL="Next"  HREF="033705.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Autoheal failure</H1>
    <B>Ron</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Autoheal%20failure&In-Reply-To=%3CB0651F6D-873E-4DDF-A9A0-5DB5D7051205%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Autoheal failure">ron.cordell at gmail.com
       </A><BR>
    <I>Tue Feb 11 02:45:33 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033703.html">[rabbitmq-discuss] Autoheal failure
</A></li>
        <LI>Next message: <A HREF="033705.html">[rabbitmq-discuss] Autoheal failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33704">[ date ]</a>
              <a href="thread.html#33704">[ thread ]</a>
              <a href="subject.html#33704">[ subject ]</a>
              <a href="author.html#33704">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have seen the same behavior but don't have a fix for it. In a 3 node HA cluster we sometimes see node 1 out as seen by node 2, node 2 out as seen by node 1, and node 3 thinks everything is ok. Pivotal Labs was working with us at one point and they didn't have an explanation, either. 

That being said we have had numerous issues getting a stable and reliable 3 node cluster working on Windows Server 2008R2. We don't see the stability issues in our tests with Linux but we won't be running production on Linux rabbit nodes for a couple more weeks. 

Cheers,

Ron

Sent from my iPad

&gt;<i> On Feb 10, 2014, at 5:33 PM, Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at skytap.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Recently we started running a two node HA cluster of Rabbit 3.2.2, with autoheal enabled.
</I>&gt;<i> 
</I>&gt;<i> After a network partition, I noticed that autoheal didn't appear to work, although the logs indicate it was tried. The first time it happened, the UI in both brokers indicated the other broker was missing from the cluster.
</I>&gt;<i> 
</I>&gt;<i> The second time this happened, the management plugin seemed to not function afterwards. Most of the Web UI was unusable, i.e it wouldn't tell me which nodes were running, what queues were declared, and so forth.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I'm wondering if what I'm seeing below is a known issue rings any bells. Also, is their any other log output I should look at to determine success/failure?
</I>&gt;<i> 
</I>&gt;<i> On the &quot;winning&quot; side, the logs look like this. The &quot;ignoring&quot; part in particular is suspicious.
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> =ERROR REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>): ** ERROR ** mnesia_event got {inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>}
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A> when in state {winner_waiting,
</I>&gt;<i> 
</I>&gt;<i>                                                                [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>],
</I>&gt;<i> 
</I>&gt;<i>                                                                [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]}; ignoring
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> global: Name conflict terminating {rabbit_mgmt_db,&lt;2783.10073.5&gt;}
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On the &quot;losing&quot; side, the logs look like this:
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> 
</I>&gt;<i> =ERROR REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>): ** ERROR ** mnesia_event got {inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>}
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =WARNING REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> Federation exchange 'skytap' in vhost '/' did not connect to exchange 'skytap' in vhost '/' on <A HREF="amqp://something">amqp://something</A> else.foo.bar.com:5672
</I>&gt;<i> 
</I>&gt;<i> {error,unknown_host}
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 3-Feb-2014::09:48:56 ===
</I>&gt;<i> 
</I>&gt;<i> Statistics database started.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =WARNING REPORT==== 3-Feb-2014::09:48:58 ===
</I>&gt;<i> 
</I>&gt;<i> Federation exchange 'skytap' in vhost '/' did not connect to exchange 'skytap' in vhost '/' on <A HREF="amqp://somethingelse.foo.bar.com:5672">amqp://somethingelse.foo.bar.com:5672</A>
</I>&gt;<i> 
</I>&gt;<i> {error,unknown_host}
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140210/49e65e05/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140210/49e65e05/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033703.html">[rabbitmq-discuss] Autoheal failure
</A></li>
	<LI>Next message: <A HREF="033705.html">[rabbitmq-discuss] Autoheal failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33704">[ date ]</a>
              <a href="thread.html#33704">[ thread ]</a>
              <a href="subject.html#33704">[ subject ]</a>
              <a href="author.html#33704">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
