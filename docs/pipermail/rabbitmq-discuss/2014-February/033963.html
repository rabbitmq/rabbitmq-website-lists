<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] System.ObjectDisposedException
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20System.ObjectDisposedException&In-Reply-To=%3CCAEeb6ArpVgO-Dv4AvwDHqcbcNv-_tnQbk-3PaAOO0zqron7Ktw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033958.html">
   <LINK REL="Next"  HREF="033965.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] System.ObjectDisposedException</H1>
    <B>Derek Johnston</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20System.ObjectDisposedException&In-Reply-To=%3CCAEeb6ArpVgO-Dv4AvwDHqcbcNv-_tnQbk-3PaAOO0zqron7Ktw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] System.ObjectDisposedException">derekejohnston at gmail.com
       </A><BR>
    <I>Wed Feb 19 15:21:51 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033958.html">[rabbitmq-discuss] Queues declared with &quot;x-ha-policy&quot;, &quot;all&quot; but not mirrored
</A></li>
        <LI>Next message: <A HREF="033965.html">[rabbitmq-discuss] System.ObjectDisposedException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33963">[ date ]</a>
              <a href="thread.html#33963">[ thread ]</a>
              <a href="subject.html#33963">[ subject ]</a>
              <a href="author.html#33963">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

keep getting this error
System.ObjectDisposedException was unhandled
Message: An unhandled exception of type 'System.ObjectDisposedException'
occurred in System.dll


here is my code taken from here
<A HREF="http://freshbrewedcode.com/davidneal/2011/11/30/scale-windows-services-with-rabbitmq/">http://freshbrewedcode.com/davidneal/2011/11/30/scale-windows-services-with-rabbitmq/</A>

static void Main()
{
// Set up the RabbitMQ connection and channel
var connectionFactory = new ConnectionFactory
{
HostName = &quot;localhost&quot;,
Port = 5672,
UserName = &quot;guest&quot;,
Password = &quot;guest&quot;,
Protocol = Protocols.AMQP_0_9_1,
RequestedFrameMax = UInt32.MaxValue,
RequestedHeartbeat = UInt16.MaxValue
};

using (var connection = connectionFactory.CreateConnection())
using (var channel = connection.CreateModel())
{
// This instructs the channel not to prefetch more than one message
channel.BasicQos(0, 1, false);

// Create a new, durable exchange
channel.ExchangeDeclare(&quot;sample-ex&quot;, ExchangeType.Direct, true, false,
null);
// Create a new, durable queue
channel.QueueDeclare(&quot;sample-queue&quot;, true, false, false, null);
// Bind the queue to the exchange
channel.QueueBind(&quot;sample-queue&quot;, &quot;sample-ex&quot;, &quot;optional-routing-key&quot;);

using (var subscription = new Subscription(channel, &quot;sample-queue&quot;, false))
{
Console.WriteLine(&quot;Waiting for messages...&quot;);
var encoding = new UTF8Encoding();
while (channel.IsOpen)
{
BasicDeliverEventArgs eventArgs;
var success = subscription.Next(2000, out eventArgs);
if (success == false) continue;
var msgBytes = eventArgs.Body;
var message = encoding.GetString(msgBytes);
Console.WriteLine(message);
channel.BasicAck(eventArgs.DeliveryTag, false);
}
}
}
}

/++++++++++++++++++++++++++++++++++++++++++++++++/

private static void Main()
{
// Set up the RabbitMQ connection and channel
var connectionFactory = new ConnectionFactory
                         {
                         HostName = &quot;localhost&quot;,
                         Port = 5672,
                         UserName = &quot;guest&quot;,
                         Password = &quot;guest&quot;,
                         Protocol = Protocols.AMQP_0_9_1,
                         RequestedFrameMax = UInt32.MaxValue,
                         RequestedHeartbeat = UInt16.MaxValue
                         };

using (var connection = connectionFactory.CreateConnection())
using (var channel = connection.CreateModel())
{
// Create a new, durable exchange
channel.ExchangeDeclare(&quot;sample-ex&quot;, ExchangeType.Direct, true, false,
null);
// Create a new, durable queue
channel.QueueDeclare(&quot;sample-queue&quot;, true, false, false, null);
// Bind the queue to the exchange
channel.QueueBind(&quot;sample-queue&quot;, &quot;sample-ex&quot;, &quot;optional-routing-key&quot;);

// Set up message properties
var properties = channel.CreateBasicProperties();
properties.DeliveryMode = 2; // Messages are persistent and will survive a
server restart

// Ready to start publishing
// The message to publish can be anything that can be serialized to a byte
array,
// such as a serializable object, an ID for an entity, or simply a string
var encoding = new UTF8Encoding();
for (var i = 0; i &lt; 10; i++)
{
var msg = string.Format(&quot;This is message derek #{0}?&quot;, i+1);
var msgBytes = encoding.GetBytes(msg);
channel.BasicPublish(&quot;sample-ex&quot;, &quot;optional-routing-key&quot;, false, false,
properties, msgBytes);

}
channel.Close();
}
Console.WriteLine(&quot;Messages published&quot;);
    Console.ReadKey(true);
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140219/373fedba/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140219/373fedba/attachment.html</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033958.html">[rabbitmq-discuss] Queues declared with &quot;x-ha-policy&quot;, &quot;all&quot; but not mirrored
</A></li>
	<LI>Next message: <A HREF="033965.html">[rabbitmq-discuss] System.ObjectDisposedException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33963">[ date ]</a>
              <a href="thread.html#33963">[ thread ]</a>
              <a href="subject.html#33963">[ subject ]</a>
              <a href="author.html#33963">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
