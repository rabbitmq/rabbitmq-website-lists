<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Autoheal failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Autoheal%20failure&In-Reply-To=%3CCACLE7ixyRMh0apHYs9ms_jo0cAH05H0XcQpjsux8dmnxepHY5g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033711.html">
   <LINK REL="Next"  HREF="033706.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Autoheal failure</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Autoheal%20failure&In-Reply-To=%3CCACLE7ixyRMh0apHYs9ms_jo0cAH05H0XcQpjsux8dmnxepHY5g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Autoheal failure">mpietrek at skytap.com
       </A><BR>
    <I>Tue Feb 11 17:30:55 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033711.html">[rabbitmq-discuss] Autoheal failure
</A></li>
        <LI>Next message: <A HREF="033706.html">[rabbitmq-discuss] [rabbitmq-c-master] memory leakink while	reconnect.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33720">[ date ]</a>
              <a href="thread.html#33720">[ thread ]</a>
              <a href="subject.html#33720">[ subject ]</a>
              <a href="author.html#33720">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Simon,

Glad you were able to repro mgmt database thing.

As for the prior Autoheal activity, here's a sanitized version of what I've
got by grepping for &quot;Autoheal&quot;, with a little bit of extra context (-C 10).
Let me know if you need something else in particular.

On the &quot;winning&quot; side (&quot;goodnessmq1&quot;)

---------------------------------

=INFO REPORT==== 2-Feb-2014::07:28:18 ===

closing AMQP connection &lt;0.25083.0&gt; (goodness2mq1.foo.bar.com:36360 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=WARNING REPORT==== 2-Feb-2014::07:28:18 ===

closing AMQP connection &lt;0.19158.0&gt; (goodnessawsd1.foo.bar.com:52133 -&gt;
goodnessmqvip1.foo.bar.com:5672):

connection_closed_abruptly


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>


=ERROR REPORT==== 2-Feb-2014::07:28:20 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>}


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal decision

  * Partitions: [[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>],[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>]]

  * Winner:     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>

  * Losers:     [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal: I am the winner, waiting for [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>] to stop


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A> when in state
{winner_waiting,


[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>],


[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]}; ignoring


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

accepting AMQP connection &lt;0.25103.0&gt; (goodness1mq1.foo.bar.com:57781 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=ERROR REPORT==== 2-Feb-2014::07:28:20 ===

connection &lt;0.25103.0&gt;, channel 1 - soft error:

{amqp_error,not_found,

            &quot;home node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>' of durable queue 'federation:
skytap -&gt; mq_prod/goodness1' in vhost '/' is down or inaccessible&quot;,

--

            &quot;home node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>' of durable queue 'federation:
skytap -&gt; mq_prod/goodness2' in vhost '/' is down or inaccessible&quot;,

            'queue.declare'}


=INFO REPORT==== 2-Feb-2014::07:28:24 ===

closing AMQP connection &lt;0.25176.0&gt; (goodness2mq1.foo.bar.com:59858 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=INFO REPORT==== 2-Feb-2014::07:28:25 ===

rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A> down


=INFO REPORT==== 2-Feb-2014::07:28:25 ===

Autoheal: final node has stopped, starting...


=INFO REPORT==== 2-Feb-2014::07:28:25 ===

rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A> up


=INFO REPORT==== 2-Feb-2014::07:28:25 ===

accepting AMQP connection &lt;0.25238.0&gt; (goodnessawsd1.foo.bar.com:52215 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=INFO REPORT==== 2-Feb-2014::07:28:26 ===

accepting AMQP connection &lt;0.25266.0&gt; (goodness1mq1.foo.bar.com:36928 -&gt;
goodnessmqvip1.foo.bar.com:5672)


--

=INFO REPORT==== 2-Feb-2014::08:55:06 ===

rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A> down


=ERROR REPORT==== 2-Feb-2014::08:55:06 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>}


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

closing AMQP connection &lt;0.530.4&gt; (goodnessawsd2.foo.bar.com:37902 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

closing AMQP connection &lt;0.777.4&gt; (goodnessawsd2.foo.bar.com:37917 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'ConfigurationManager' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.297.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11858.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'accounting' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.292.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11848.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'awsdriver_cron' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.289.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11842.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'mqcmd' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.290.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11844.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal decision

  * Partitions: [[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>],[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]]

  * Winner:     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>

  * Losers:     [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'system_test' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.298.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11860.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'atropos' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.293.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11850.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'cmcmd' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.296.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11856.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'greenbox' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.295.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11854.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'web-tasks-prod' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.291.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11846.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'quota_inspector' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.294.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11852.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal decision

  * Partitions: [[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>],[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]]

  * Winner:     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>

  * Losers:     [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal: I am the winner, waiting for [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>] to stop


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal: I am the winner, waiting additionally for [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>] to
stop


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'awsdriver' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.288.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11840.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

closing AMQP connection &lt;0.998.4&gt; (goodnessawsd2.foo.bar.com:37932 -&gt;
goodnessmqvip1.foo.bar.com:5672)


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

accepting AMQP connection &lt;0.1025.4&gt; (goodnessawsd2.foo.bar.com:37933 -&gt;
goodnessmqvip1.foo.bar.com:5672)


--

{error,unknown_host}


=ERROR REPORT==== 3-Feb-2014::09:48:55 ===

closing AMQP connection &lt;0.25414.14&gt; (goodnesswfe2.foo.bar.com:37330 -&gt;
goodnessmqvip1.foo.bar.com:5672):

{heartbeat_timeout,running}


=ERROR REPORT==== 3-Feb-2014::09:48:56 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>}


=INFO REPORT==== 3-Feb-2014::09:48:56 ===

Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A> when in state
{winner_waiting,


[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>],


[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]}; ignoring


=INFO REPORT==== 3-Feb-2014::09:48:56 ===

global: Name conflict terminating {rabbit_mgmt_db,&lt;2783.10073.5&gt;}


=WARNING REPORT==== 3-Feb-2014::09:48:56 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodness1mqvip1.foo.bar.com:5672">amqp://goodness1mqvip1.foo.bar.com:5672</A>

{error,unknown_host}


--

{error,unknown_host}


=WARNING REPORT==== 3-Feb-2014::13:14:20 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodness1mqvip1.foo.bar.com:5672">amqp://goodness1mqvip1.foo.bar.com:5672</A>

{error,unknown_host}


=ERROR REPORT==== 3-Feb-2014::13:14:24 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>}


=INFO REPORT==== 3-Feb-2014::13:14:24 ===

Autoheal request received from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A> when in state
{winner_waiting,


[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>],


[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>]}; ignoring


=WARNING REPORT==== 3-Feb-2014::13:14:25 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodness2mqvip1.foo.bar.com:5672">amqp://goodness2mqvip1.foo.bar.com:5672</A>

{error,unknown_host}


=WARNING REPORT==== 3-Feb-2014::13:14:25 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://sgp1r1mqvip1.foo.bar.com:5672">amqp://sgp1r1mqvip1.foo.bar.com:5672</A>

{error,unknown_host}

17:19 PROD <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">highland at goodnessmq1</A>:~/logs/goodnessmq1.foo.bar.com$
---------------------------------

And on the losing side (&quot;goodnessmq2&quot;):

---------------------------------

=WARNING REPORT==== 2-Feb-2014::07:28:08 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://sgp1r1mqvip1.foo.bar.com:5672">amqp://sgp1r1mqvip1.foo.bar.com:5672</A>

{error,unknown_host}


=ERROR REPORT==== 2-Feb-2014::07:28:20 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>}


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=WARNING REPORT==== 2-Feb-2014::07:28:20 ===

Autoheal: we were selected to restart; winner is <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

Stopping RabbitMQ


=INFO REPORT==== 2-Feb-2014::07:28:20 ===

stopped TCP Listener on 0.0.0.0:5672


=WARNING REPORT==== 2-Feb-2014::07:28:21 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://sgp1r1mqvip1.foo.bar.com:5672">amqp://sgp1r1mqvip1.foo.bar.com:5672</A>

{error,unknown_host}

--

=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'ConfigurationManager' in vhost '/'): Slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11858.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.297.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'ConfigurationManager' in vhost '/'): Promoting slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11858.0</A>&gt; to master


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Statistics database started.


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'awsdriver_cron' in vhost '/'): Slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11842.0</A>&gt; saw deaths of mirrors
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1.2.289.0</A>&gt;


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Mirrored-queue (queue 'awsdriver_cron' in vhost '/'): Promoting slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2.1.11842.0</A>&gt; to master


=WARNING REPORT==== 2-Feb-2014::08:55:06 ===

Autoheal: we were selected to restart; winner is <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Stopping RabbitMQ


=INFO REPORT==== 2-Feb-2014::08:55:06 ===

Federation exchange 'skytap' in vhost '/' connected to exchange 'skytap' in
vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>


=INFO REPORT==== 2-Feb-2014::08:55:07 ===

Federation exchange 'skytap' in vhost '/' connected to exchange 'skytap' in
vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>


--

{error,unknown_host}


=WARNING REPORT==== 3-Feb-2014::09:48:55 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>

{error,unknown_host}


=ERROR REPORT==== 3-Feb-2014::09:48:56 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>}


=INFO REPORT==== 3-Feb-2014::09:48:56 ===

Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=WARNING REPORT==== 3-Feb-2014::09:48:56 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>

{error,unknown_host}


=INFO REPORT==== 3-Feb-2014::09:48:56 ===

Statistics database started.


=WARNING REPORT==== 3-Feb-2014::09:48:58 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>

--

{error,unknown_host}


=WARNING REPORT==== 3-Feb-2014::13:14:24 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>

{error,ehostunreach}


=ERROR REPORT==== 3-Feb-2014::13:14:24 ===

Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq2</A>): ** ERROR ** mnesia_event got
{inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>}


=INFO REPORT==== 3-Feb-2014::13:14:24 ===

Autoheal request sent to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at goodnessmq1</A>


=WARNING REPORT==== 3-Feb-2014::13:14:25 ===

Federation exchange 'skytap' in vhost '/' did not connect to exchange
'skytap' in vhost '/' on <A HREF="amqp://goodnessmqvip1.foo.bar.com:5672">amqp://goodnessmqvip1.foo.bar.com:5672</A>

{{shutdown,

     {server_initiated_close,404,

         &lt;&lt;&quot;NOT_FOUND - no exchange 'federation: skytap -&gt; mq_prod B' in
vhost '/'&quot;&gt;&gt;}},

 {gen_server,call,

     [&lt;0.6585.1&gt;,

      {call,

          {'exchange.bind',0,&lt;&lt;&quot;federation: skytap -&gt; mq_prod B&quot;&gt;&gt;,
---------------------------------





On Tue, Feb 11, 2014 at 2:15 AM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:

&gt;<i> On 11/02/14 01:33, Matt Pietrek wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Recently we started running a two node HA cluster of Rabbit 3.2.2, with
</I>&gt;&gt;<i> autoheal enabled.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> After a network partition, I noticed that autoheal didn't appear to
</I>&gt;&gt;<i> work, although the logs indicate it was tried. The first time it
</I>&gt;&gt;<i> happened, the UI in both brokers indicated the other broker was missing
</I>&gt;&gt;<i> from the cluster.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> So the log indicates that the winning node ignored a request to start
</I>&gt;<i> autohealing because it was already autohealing.
</I>&gt;<i>
</I>&gt;<i> It's possible that there is a problem if a network partition occurs while
</I>&gt;<i> autoheal is already happening. I'll file a bug to look into this, but it
</I>&gt;<i> would help if you can show me any previous logs from this node - I assume
</I>&gt;<i> that earlier (probably not much earlier) in the logs there were some more
</I>&gt;<i> partition warnings and autoheal events?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  The second time this happened, the management plugin seemed to not
</I>&gt;&gt;<i> function afterwards. Most of the Web UI was unusable, i.e it wouldn't
</I>&gt;&gt;<i> tell me which nodes were running, what queues were declared, and so forth.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Separately there is an issue where the management database might fail to
</I>&gt;<i> recover after a network partition. I just replicated that yesterday; note
</I>&gt;<i> that it's not connected to autoheal.
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, Pivotal
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140211/b740334a/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140211/b740334a/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033711.html">[rabbitmq-discuss] Autoheal failure
</A></li>
	<LI>Next message: <A HREF="033706.html">[rabbitmq-discuss] [rabbitmq-c-master] memory leakink while	reconnect.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33720">[ date ]</a>
              <a href="thread.html#33720">[ thread ]</a>
              <a href="subject.html#33720">[ subject ]</a>
              <a href="author.html#33720">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
