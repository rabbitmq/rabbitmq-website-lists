<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%20with%20RabbitMQ%202-way%20federation%20setup&In-Reply-To=%3C52F4B318.5090104%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033648.html">
   <LINK REL="Next"  HREF="033668.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%20with%20RabbitMQ%202-way%20federation%20setup&In-Reply-To=%3C52F4B318.5090104%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup">simon at rabbitmq.com
       </A><BR>
    <I>Fri Feb  7 10:19:04 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033648.html">[rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup
</A></li>
        <LI>Next message: <A HREF="033668.html">[rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33659">[ date ]</a>
              <a href="thread.html#33659">[ thread ]</a>
              <a href="subject.html#33659">[ subject ]</a>
              <a href="author.html#33659">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So with the configuration you have described, you will be federating 
both your exchange and queue. That might not be what you want.

Federated exchanges *copy* messages across the network, one per binding.

Federated queues *move* messages to where the consumers are.

It's possible that what you've done is created a federated exchange and 
a federated queue, and only bound them together at one of the nodes?

If you want messages to end up on both nodes then you want to only 
federate the exchange, not the queue; create queues at each node and 
bind them to the federated exchange.

Also as Arun said, the config you've given references an upstream-set 
&quot;test&quot; which doesn't appear to exist - create it or use &quot;all&quot;.

And yes, federation works for all exchange types.

Checking federation status 
(<A HREF="http://www.rabbitmq.com/federation-reference.html#status">http://www.rabbitmq.com/federation-reference.html#status</A>) is likely to 
prove illuminating.

Cheers, Simon

On 06/02/2014 11:07PM, Rahul Jain wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've been trying to setup a 2-way federation for my 2 nodes A and B.
</I>&gt;<i>
</I>&gt;<i> I ran the following commands on Node A:
</I>&gt;<i>
</I>&gt;<i> |sudo rabbitmqctl set_parameter federation-upstream rabbit2 '{&quot;uri&quot;:&quot;<A HREF="amqp://&lt;Node">amqp://&lt;Node</A> B IP&gt;&quot;}'
</I>&gt;<i> sudo rabbitmqctl set_parameter federation local-nodename '&quot;rabbit1&quot;'
</I>&gt;<i> sudo rabbitmqctl set_policy federate-me &quot;^test\.&quot; '{&quot;federation-upstream-set&quot;:&quot;test&quot;}'|
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> commands on Node B:
</I>&gt;<i>
</I>&gt;<i> |sudo rabbitmqctl set_parameter federation-upstream rabbit2 '{&quot;uri&quot;:&quot;<A HREF="amqp://&lt;Node">amqp://&lt;Node</A> A IP&gt;&quot;}'
</I>&gt;<i> sudo rabbitmqctl set_parameter federation local-nodename '&quot;rabbit2&quot;'
</I>&gt;<i> sudo rabbitmqctl set_policy federate-me &quot;^test\.&quot; '{&quot;federation-upstream-set&quot;:&quot;test&quot;}'|
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Now I created a fanout exchange and queue on Node A, namely
</I>&gt;<i> test.fanout-Exchange and test.fanout-Queue, using the RabbitMQ console.
</I>&gt;<i>
</I>&gt;<i> When I publish a message using RabbitMQ console of Node A, I see the
</I>&gt;<i> message reaches the queue on Node A alone, and not on Node B.
</I>&gt;<i>
</I>&gt;<i> Any clues?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>
-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033648.html">[rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup
</A></li>
	<LI>Next message: <A HREF="033668.html">[rabbitmq-discuss] Issue with RabbitMQ 2-way federation setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33659">[ date ]</a>
              <a href="thread.html#33659">[ thread ]</a>
              <a href="subject.html#33659">[ subject ]</a>
              <a href="author.html#33659">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
