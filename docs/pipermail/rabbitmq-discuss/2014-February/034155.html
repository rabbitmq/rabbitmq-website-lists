<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Unexaplainable behaviour with shovel plugin.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Unexaplainable%20behaviour%20with%20shovel%20plugin.&In-Reply-To=%3CCAK%2BmrqodJ2AXwsywejtxUHJtgtFy6KgdkY2GZbsLEc242etwRg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034220.html">
   <LINK REL="Next"  HREF="034199.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Unexaplainable behaviour with shovel plugin.</H1>
    <B>Claire Fautsch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Unexaplainable%20behaviour%20with%20shovel%20plugin.&In-Reply-To=%3CCAK%2BmrqodJ2AXwsywejtxUHJtgtFy6KgdkY2GZbsLEc242etwRg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Unexaplainable behaviour with shovel plugin.">cfautsch at goodgamestudios.com
       </A><BR>
    <I>Wed Feb 26 08:57:44 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034220.html">[rabbitmq-discuss] Monitoring application manager RabbitMQ	server with .NET
</A></li>
        <LI>Next message: <A HREF="034199.html">[rabbitmq-discuss] Unexaplainable behaviour with shovel plugin.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34155">[ date ]</a>
              <a href="thread.html#34155">[ thread ]</a>
              <a href="subject.html#34155">[ subject ]</a>
              <a href="author.html#34155">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

we are currently experiencing some (for us) unexaplainable behaviour with
shovel plugin.

Before, I enter into the details, let me first outline our setup.

We have a set of RabbitMQ Servers hosted in the cloud, where incoming
messages are queued. On those servers we then have the shovel plugin
running, which distributes the incoming messages to a set of RabbitMQ
Servers in our local datacenter.
The configuration of the shovel does not directly specifiy a RabbitMQ
Server as its destination, but a load balancer, which then distributes to
the servers in our local datacenter.

Since a few days we are now encountering the following Problem:
The queues on our cloud servers reach (and pass) the Memory watermarks,
because of Unacknowledged Messages. The queue size of ready messages is
almost constantly on 0 (i.e., messages are delivered as fast as published)
however the unacknowledged messages keep growing.
On the other side, at the same time the statistics on our local servers
show, that messages are confirmed almost as fast as published.

This leads to the fact, that we have on the destination servers a total of
two hanful of messages that are not yet confirmed, however on the source
servers we have millions of messages that are waiting for confirmation
(acknowledgement)

We would expect with some threshold that
delivery rate on source = publish rate on destination (which is the case)
confirm rate on destination = acknowledge rate on source (which shows
considerable difference)

Does anyone have an idea or suggestion what could be the reason for this?
Is it a bad idea to have load balancer as destination in the shovel, or
should that work fine? Network issue?

Here some more details on our shovel setup:
ack_mode=on_confirm
prefetch_count=0 (default)
reconnect_delay=5


Thanks for advance for any hint or discussion point,
Regards
Claire
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140226/48ccfd3e/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140226/48ccfd3e/attachment.html</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034220.html">[rabbitmq-discuss] Monitoring application manager RabbitMQ	server with .NET
</A></li>
	<LI>Next message: <A HREF="034199.html">[rabbitmq-discuss] Unexaplainable behaviour with shovel plugin.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34155">[ date ]</a>
              <a href="thread.html#34155">[ thread ]</a>
              <a href="subject.html#34155">[ subject ]</a>
              <a href="author.html#34155">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
