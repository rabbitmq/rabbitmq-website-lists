<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ periodic slowness
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20periodic%20slowness&In-Reply-To=%3CCAFtA53yBztT1XOYn8qZsETgSyaZCuXFTKAgzSU14M1Wx199o%3DQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033671.html">
   <LINK REL="Next"  HREF="033650.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ periodic slowness</H1>
    <B>Ron Cordell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20periodic%20slowness&In-Reply-To=%3CCAFtA53yBztT1XOYn8qZsETgSyaZCuXFTKAgzSU14M1Wx199o%3DQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ periodic slowness">ron.cordell at gmail.com
       </A><BR>
    <I>Fri Feb  7 03:34:24 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033671.html">[rabbitmq-discuss] Callback - handleDelivery
</A></li>
        <LI>Next message: <A HREF="033650.html">[rabbitmq-discuss] RabbitMQ periodic slowness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33649">[ date ]</a>
              <a href="thread.html#33649">[ thread ]</a>
              <a href="subject.html#33649">[ subject ]</a>
              <a href="author.html#33649">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone!

We are trying to understand RabbitMQ behavior that we see in a highly
available cluster and I'm hoping someone here can shed some light on it.

We have a 3-node cluster that is exposed to the application via an F5 load
balancer by a virtual IP. The majority of the queues that are created are
highly available queues in order to prevent message loss from happening in
the event of a catastrophic failure of a node.

The rabbit instances/nodes are 3.2.2 with Erlang 16B02.

The application consists of a series of REST HTTP interfaces which place
the incoming messages onto the rabbit queues.

When we load test the application we are seeing a periodic delay in writing
a message to Rabbit. The delay happens about once every few minutes and
lasts up to 30 seconds.

We have tested in several scenarios:
3 node load balanced cluster
single node, non ha-policy applied machine
on Windows Server 2008R2
on Linux (Oracle Linux)
on VMWare virtual machines on high speed SAN storage
on physical machines with SSD
direct connection with no LB to single node

We haven't tested every combination in this list but we've tried to isolate
I/O, operating system, machine characteristics, etc.

But in every test scenario under load we start to see the socket opened to
Rabbit on a write operation and no response for 20-30 seconds (with network
tracing tools).

Has anyone seen any behavior like this?

Our concern is that under load some REST interfaces will show periodic
slowness; we have SLAs of ~1 second on the interfaces.

Thanks for any input!

Cheers,

Ron Cordell
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140206/a51f9f70/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140206/a51f9f70/attachment.html</A>&gt;
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033671.html">[rabbitmq-discuss] Callback - handleDelivery
</A></li>
	<LI>Next message: <A HREF="033650.html">[rabbitmq-discuss] RabbitMQ periodic slowness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33649">[ date ]</a>
              <a href="thread.html#33649">[ thread ]</a>
              <a href="subject.html#33649">[ subject ]</a>
              <a href="author.html#33649">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
