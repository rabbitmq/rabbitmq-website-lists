<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Callback - handleDelivery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Callback%20-%20handleDelivery&In-Reply-To=%3CCAETr1H-M%2BQiQgfCXwbvEi51-h361XrDz9cAFaHSE67W4E0hEYw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033669.html">
   <LINK REL="Next"  HREF="033671.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Callback - handleDelivery</H1>
    <B>cw storm</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Callback%20-%20handleDelivery&In-Reply-To=%3CCAETr1H-M%2BQiQgfCXwbvEi51-h361XrDz9cAFaHSE67W4E0hEYw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Callback - handleDelivery">cwstorm at gmail.com
       </A><BR>
    <I>Fri Feb  7 17:28:25 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033669.html">[rabbitmq-discuss] Callback - handleDelivery
</A></li>
        <LI>Next message: <A HREF="033671.html">[rabbitmq-discuss] Callback - handleDelivery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33670">[ date ]</a>
              <a href="thread.html#33670">[ thread ]</a>
              <a href="subject.html#33670">[ subject ]</a>
              <a href="author.html#33670">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>MK,

Thank you so much for your response.  I'm the amqp java api and create my
service.  In my service, my main try/catch blockI establish the
ConnectionFactory and Channel.  Then I assigned an executor service:
 channel.queueDeclare(QueueName, true, false, false, null);
channel.basicConsume(strQueueName, false,
new DefaultConsumer(channel) {
@Override public void handleDelivery(String consumerTag,
Envelope envelope,
AMQP.BasicProperties props,
byte[] body)
throws IOException
{}

If I understand it correctly, is the &quot;handleDelivery&quot; is like a listener on
the queue.  Whenever a message arrives in the queue, everything inside the
&quot;handleDelivery&quot; gets executed.  So, I have an object which invokes another
service residing on the client application.  Based on your explaination, I
have to ensure that the object is threaded because that's how the message
is being dispatched to the client application.  The the object that I'm
using isn't thread supported, then that'll explain the
NPE(NullPointerException) within the &quot;handleDelivery&quot;, right?


On Fri, Feb 7, 2014 at 12:05 PM, Michael Klishin &lt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.s.klishin at gmail.com</A>&gt; wrote:

&gt;<i> 2014-02-07 17:55 GMT+04:00 cw storm &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">cwstorm at gmail.com</A>&gt;:
</I>&gt;<i>
</I>&gt;<i> Not sure I understand.  &quot;Make sure your code is prepared for that.&quot;  What
</I>&gt;&gt;<i> do you mean by that.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You instantiate Connection and Channel in one thread (often the main
</I>&gt;<i> thread) but incoming messages
</I>&gt;<i> are dispatched from a different thread (&quot;main loop&quot; or &quot;network I/O
</I>&gt;<i> thread&quot;) into a pool every connection
</I>&gt;<i> has.
</I>&gt;<i>
</I>&gt;<i> You need to make sure that the objects used in handleDelivery are
</I>&gt;<i> initialized in a thread safe
</I>&gt;<i> manner (e.g. not lazily). A null pointer exception coming from
</I>&gt;<i> handleDelivery suggests the problem
</I>&gt;<i> is with one of the objects you use there.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Also, if thread pool, will it close once the broker receive a &quot;basicAck&quot;?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If you did not provide a custom executor service to
</I>&gt;<i> ConnectionFactory#newConnection, it will be
</I>&gt;<i> shut down when connection is closed. Otherwise it's up to you to shut it
</I>&gt;<i> down on application
</I>&gt;<i> shutdown.
</I>&gt;<i> --
</I>&gt;<i> MK
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
</I>&gt;<i> <A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140207/45a6764a/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140207/45a6764a/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033669.html">[rabbitmq-discuss] Callback - handleDelivery
</A></li>
	<LI>Next message: <A HREF="033671.html">[rabbitmq-discuss] Callback - handleDelivery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33670">[ date ]</a>
              <a href="thread.html#33670">[ thread ]</a>
              <a href="subject.html#33670">[ subject ]</a>
              <a href="author.html#33670">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
