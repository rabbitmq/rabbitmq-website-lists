<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] /api/queue message_stats-&gt;deliver_get_details-&gt;last_event removed in 3.1?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20/api/queue%0A%20message_stats-%3Edeliver_get_details-%3Elast_event%20removed%20in%203.1%3F&In-Reply-To=%3C5305F0B4.3080106%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033975.html">
   <LINK REL="Next"  HREF="033976.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] /api/queue message_stats-&gt;deliver_get_details-&gt;last_event removed in 3.1?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20/api/queue%0A%20message_stats-%3Edeliver_get_details-%3Elast_event%20removed%20in%203.1%3F&In-Reply-To=%3C5305F0B4.3080106%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] /api/queue message_stats-&gt;deliver_get_details-&gt;last_event removed in 3.1?">simon at rabbitmq.com
       </A><BR>
    <I>Thu Feb 20 12:10:28 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033975.html">[rabbitmq-discuss] /api/queue message_stats-&gt;deliver_get_details-&gt;last_event removed in 3.1?
</A></li>
        <LI>Next message: <A HREF="033976.html">[rabbitmq-discuss] How consumer subscription to queue when you have	to client servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33991">[ date ]</a>
              <a href="thread.html#33991">[ thread ]</a>
              <a href="subject.html#33991">[ subject ]</a>
              <a href="author.html#33991">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/02/14 19:53, Jeff wrote:
&gt;<i> I use message_stats-&gt;deliver_get_details-&gt;last_event to keep track of
</I>&gt;<i> a queue that may have stalled consumers. some of our requests take
</I>&gt;<i> some time to process, so it normal to have some unack&#8217;d ones laying
</I>&gt;<i> around for a while.
</I>
So last_event was removed because it was really an implementation detail 
of how statistics used to work, before they got rewritten in 3.1.0. It's 
really the most recent time that the management DB received a statistics 
event from a channel - but various things you might not expect could 
wake up a channel and get it to sent statistics events.

For example, if someone somewhere wrote a script which polled 
&quot;rabbitmqmctl list_channels&quot;, then that would cause last_event to keep 
updating.

&gt;<i> is there a replacement for this? I see -&gt;rate, but I can&#8217;t figure out
</I>&gt;<i> what the rate is over? per second? what if some requests take many
</I>&gt;<i> seconds to run?
</I>
So rate is probably what you want. The rate key is just calculated over 
the last five seconds. If you want the rate over a longer period, you 
can set the msg_rates_age and msg_rates_incr query parameters, and as 
well as getting a bunch of samples back you will also get an avg_rate 
field giving you the average over the time period.

Note sure what you mean by &quot;what if some requests take many seconds to 
run?&quot; - as far as the management API is concerned it's just counting 
messages out and acks in; it doesn't make any attempt to correlate them.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033975.html">[rabbitmq-discuss] /api/queue message_stats-&gt;deliver_get_details-&gt;last_event removed in 3.1?
</A></li>
	<LI>Next message: <A HREF="033976.html">[rabbitmq-discuss] How consumer subscription to queue when you have	to client servers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33991">[ date ]</a>
              <a href="thread.html#33991">[ thread ]</a>
              <a href="subject.html#33991">[ subject ]</a>
              <a href="author.html#33991">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
