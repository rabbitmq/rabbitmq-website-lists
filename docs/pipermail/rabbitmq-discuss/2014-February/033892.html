<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to handle extremely large queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20handle%20extremely%20large%20queues&In-Reply-To=%3CCANpjuCvueyzKeyjQ%3DLWcQnXCcYqpC4jodQjtuDvSxu_9zOiJtw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033888.html">
   <LINK REL="Next"  HREF="033861.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to handle extremely large queues</H1>
    <B>Greg Poirier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20handle%20extremely%20large%20queues&In-Reply-To=%3CCANpjuCvueyzKeyjQ%3DLWcQnXCcYqpC4jodQjtuDvSxu_9zOiJtw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] How to handle extremely large queues">greg.poirier at opower.com
       </A><BR>
    <I>Mon Feb 17 09:23:07 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033888.html">[rabbitmq-discuss] How to handle extremely large queues
</A></li>
        <LI>Next message: <A HREF="033861.html">[rabbitmq-discuss] RabbitMQ .NET Client Can Hang with SSL	Connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33892">[ date ]</a>
              <a href="thread.html#33892">[ thread ]</a>
              <a href="subject.html#33892">[ subject ]</a>
              <a href="author.html#33892">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Monday, February 17, 2014, Matthias Radestock &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;
wrote:

&gt;<i> On 17/02/14 08:23, Michael Klishin wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> If you don't run out of RAM and your consumers can keep up even with 1
</I>&gt;&gt;<i> queue, what issues do you have?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> From the original post
</I>&gt;<i> &lt;quote&gt;
</I>&gt;<i> In periods of high utilization of the cluster, we are noticing frequent
</I>&gt;<i> partitioning. We have narrowed it down to this particular use case [i.e.
</I>&gt;<i> extremely large queues]
</I>&gt;<i> &lt;/quote&gt;
</I>&gt;<i>
</I>&gt;<i> Matthias
</I>&gt;<i>
</I>
Precisely.  Sorry for the tangent. I was obsessing over memory all week.

We are seeing multiple clusters both versions 3.2.3 and 3.1.5 partition
regularly. We haven't had these issues until we started seeing queues
larger than 1 million messages.

I realize this is... Not a good use of RabbitMQ but it is somewhat a
necessity.

We have a three node cluster (2 disk 1 ram). I have disabled paging
messages to disk and set vm high memory watermark at around .75. I've
chosen a three node configuration simply so I can use pause minority. I
have also configured an ha policy with mirroring to all nodes and automatic
synchronization.

We have a strong requirement for consistency and partition tolerance. This
seemed to be the best option. We can tolerate a full RabbitMQ outage but
data loss or inconsistency must be avoided.

This configuration seemed the safest but we are still experiencing
partitions and while they are easily healed, this now leads to queue in
availability for long periods of time while the queues sunchronize. If this
were attributable to network outages, I would understand, but the machines
are in adjacent racks with redundant links to top or rack switches.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140217/ddb228b5/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140217/ddb228b5/attachment.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033888.html">[rabbitmq-discuss] How to handle extremely large queues
</A></li>
	<LI>Next message: <A HREF="033861.html">[rabbitmq-discuss] RabbitMQ .NET Client Can Hang with SSL	Connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33892">[ date ]</a>
              <a href="thread.html#33892">[ thread ]</a>
              <a href="subject.html#33892">[ subject ]</a>
              <a href="author.html#33892">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
