<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Multiple enqueued RPC methods and	ShutdownSignalExceptions and simulating ConnectionTimeouts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Multiple%20enqueued%20RPC%20methods%20and%0A%09ShutdownSignalExceptions%20and%20simulating%20ConnectionTimeouts&In-Reply-To=%3CB82521CA-E344-408C-885E-3F95456A4D41%40redbite.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034102.html">
   <LINK REL="Next"  HREF="034085.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Multiple enqueued RPC methods and	ShutdownSignalExceptions and simulating ConnectionTimeouts</H1>
    <B>Daniel McGreal</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Multiple%20enqueued%20RPC%20methods%20and%0A%09ShutdownSignalExceptions%20and%20simulating%20ConnectionTimeouts&In-Reply-To=%3CB82521CA-E344-408C-885E-3F95456A4D41%40redbite.com%3E"
       TITLE="[rabbitmq-discuss] Multiple enqueued RPC methods and	ShutdownSignalExceptions and simulating ConnectionTimeouts">daniel at redbite.com
       </A><BR>
    <I>Mon Feb 24 22:32:43 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034102.html">[rabbitmq-discuss] Feature request: move messages using	management UI
</A></li>
        <LI>Next message: <A HREF="034085.html">[rabbitmq-discuss] Multiple enqueued RPC methods and	ShutdownSignalExceptions and simulating ConnectionTimeouts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34081">[ date ]</a>
              <a href="thread.html#34081">[ thread ]</a>
              <a href="subject.html#34081">[ subject ]</a>
              <a href="author.html#34081">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi RabbitMQ Discuss,

I have a problem with my client application, using the 3.2.2 Java library. 

Multiple calls made to 'RPC&#8217; methods, such as exchangeDeclare block (interminably) if the call is made while the connection is down, but before it times out.

From my basic understanding, it looks like AMQChannel blocks incoming &#8216;RPC&#8217; methods using .wait in enqueueRpc. When a ShutdownSignalException comes in via processShutdownSignal, it clears only one of the &#8216;next&#8217; RPC calls waiting because, even though notifyAll is used, the while loop containing the .wait will only be cleared by one of the incoming threads?

This situation is only apparent for my application during a ConnectionTimeout, which I haven&#8217;t been able to simulate in a controlled manner. For testing connection failures, I use a script which makes and breaks a proxy to the real server (mkfifo backpipe &amp;&amp; nc -l 5672 &lt; backpipe | nc realserver 5672 &gt; backpipe), but this results in immediate connection failure which is not (so) susceptible to this problem as the exchangeDeclares are rejected before blocking. I wonder if anyone has a method for simulating connection timeouts?

Very best, Dan.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140224/42a0a129/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140224/42a0a129/attachment.html</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034102.html">[rabbitmq-discuss] Feature request: move messages using	management UI
</A></li>
	<LI>Next message: <A HREF="034085.html">[rabbitmq-discuss] Multiple enqueued RPC methods and	ShutdownSignalExceptions and simulating ConnectionTimeouts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34081">[ date ]</a>
              <a href="thread.html#34081">[ thread ]</a>
              <a href="subject.html#34081">[ subject ]</a>
              <a href="author.html#34081">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
