<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Load%20balancing%20connections%20to%20a%20rabbitmq%0A%09cluster&In-Reply-To=%3CCAHhx-GLoTXZWcE9Yfs172S6rYPFeTNmb6OSaOUKATg8ed3E35w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034047.html">
   <LINK REL="Next"  HREF="034053.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster</H1>
    <B>Srinath C</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Load%20balancing%20connections%20to%20a%20rabbitmq%0A%09cluster&In-Reply-To=%3CCAHhx-GLoTXZWcE9Yfs172S6rYPFeTNmb6OSaOUKATg8ed3E35w%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster">srinath.c at gmail.com
       </A><BR>
    <I>Sun Feb 23 12:57:59 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034047.html">[rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster
</A></li>
        <LI>Next message: <A HREF="034053.html">[rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34048">[ date ]</a>
              <a href="thread.html#34048">[ thread ]</a>
              <a href="subject.html#34048">[ subject ]</a>
              <a href="author.html#34048">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks MK for the prompt reply.

I understand that haproxy load balances the incoming connections. But what
about the case where all the connections are established on only one node
(due to failure of the other node). Can it redistribute the connections
when the failed rabbitmq node comes up?


On Sun, Feb 23, 2014 at 6:16 PM, Michael Klishin &lt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.s.klishin at gmail.com</A>&gt; wrote:

&gt;<i> 2014-02-23 16:18 GMT+04:00 Srinath C &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">srinath.c at gmail.com</A>&gt;:
</I>&gt;<i>
</I>&gt;<i> when the failed node recovers it will remain up and running with no
</I>&gt;&gt;<i> connections established to it since all the clients are having persistent
</I>&gt;&gt;<i> connections to the other node. The load is now skewed and all the load is
</I>&gt;&gt;<i> thrust on one server with the other server lying idle. Are there common
</I>&gt;&gt;<i> solutions to this kind of load sharing problems? Please advice.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Stick HAproxy in front of the cluster and make clients connect to it. It
</I>&gt;<i> can load balance incoming
</I>&gt;<i> connections and keep track of the backend (node) states and won't send
</I>&gt;<i> connections to the backends
</I>&gt;<i> that are unavailable.
</I>&gt;<i> --
</I>&gt;<i> MK
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
</I>&gt;<i> <A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140223/b0d1c253/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140223/b0d1c253/attachment.html</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034047.html">[rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster
</A></li>
	<LI>Next message: <A HREF="034053.html">[rabbitmq-discuss] Load balancing connections to a rabbitmq	cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34048">[ date ]</a>
              <a href="thread.html#34048">[ thread ]</a>
              <a href="subject.html#34048">[ subject ]</a>
              <a href="author.html#34048">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
