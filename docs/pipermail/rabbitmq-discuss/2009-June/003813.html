<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20stomp-adapter%20behaviour&In-Reply-To=3bb0d9710906100529p712af8c7ue1c962acc0674d7c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003793.html">
   <LINK REL="Next"  HREF="003820.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour</H1>
    <B>Nicolas Echaniz</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20stomp-adapter%20behaviour&In-Reply-To=3bb0d9710906100529p712af8c7ue1c962acc0674d7c%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour">nico at rakar.com
       </A><BR>
    <I>Thu Jun 11 07:06:49 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003793.html">[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
</A></li>
        <LI>Next message: <A HREF="003820.html">[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3813">[ date ]</a>
              <a href="thread.html#3813">[ thread ]</a>
              <a href="subject.html#3813">[ subject ]</a>
              <a href="author.html#3813">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wednesday 10 June 2009 09:29:10 you wrote:
&gt;<i> On Mon, Jun 8, 2009 at 03:40, Nicolas Echaniz&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nico at rakar.com</A>&gt; wrote:
</I>&gt;<i> &gt; This lead me to re-read the STOMP Protocol spec[6] and judjing from the
</I>&gt;<i> &gt; different clients code I've looked at it looks like everyone else's
</I>&gt;<i> &gt; understanding of this paragraph:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ... is that if a client has subscribed to a destination, then it should
</I>&gt;<i> &gt; receive every message that is sent to that destination - what you call
</I>&gt;<i> &gt; &quot;broadcast&quot; behaviour in your docs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So now I'm writing here because it seems to me rather odd that every
</I>&gt;<i> &gt; STOMP client code should be modified to be able to send extra-headers to
</I>&gt;<i> &gt; RabbitMQ when they seem to be correctly implementing their STOMP Clients
</I>&gt;<i> &gt; according to the spec.
</I>&gt;<i>
</I>&gt;<i> As far as I understand, rabbit-stomp gateway implements
</I>&gt;<i> a subset of AMQP features - but over a STOMP protocol.
</I>&gt;<i>
</I>&gt;<i> For example a STOMP 'destination' is treated as an AMQP 'queue',
</I>&gt;<i> but this abstractions represent slightly different thing.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> As Matthias pointed out, STOMP spec doesn't give much information
</I>&gt;<i> of what the defaults should be. The problem is that even if changing
</I>&gt;<i> the defaults is easy, we must take care of all the other use cases.
</I>
I agree that it seems impossible to take care of every use case with one 
dafault behaviour. The problem I see with the RabbitMQ approach here is the 
need for extra headers in order to get the desired behaviour, because many 
STOMP client libraries do not contemplate the use of extra headers at all, 
which is really fine from the point of view of the (rather sucint) STOMP spec.

What I believe would be a good approach at the moment is to let the user 
select the desired &quot;defaults&quot; for the stomp-adapter in their rabbitmq.conf 
file somehow.

There could be settings for all the key questions that Matthias enumerated:
1) Should messages be routed to all subscribers or just one (round-robin)?
2) Should messages be queued when there are no subscribers?
3) When a client has multiple subscriptions to the same destination,
    should they receive one copy of a message or several?

For example:

1) MESSAGE_ROUTING = queue | topic   (or round-robin|broadcast)
2) ALWAYS_QUEUE = true | false
3) UNIQUE_SUBSCRIPTION = true | false


I really wouldn't mind what the &quot;factory defaults&quot; are as long as I can tweak 
them for my deployment through a conf file.


One other thing... there has been much discussion in the Orbited IRC channel 
about the flaws in the STOMP spec and Michael Carter (Orbited dev) has 
proposed the creation of a better protocol that should be as much backwards 
compatible with STOMP as possible but specifies things more precisely.

I believe this could be the only real solution to the STOMP interoperability 
problems... What do you guys think?


--
NicoEch&#225;niz



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003793.html">[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
</A></li>
	<LI>Next message: <A HREF="003820.html">[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3813">[ date ]</a>
              <a href="thread.html#3813">[ thread ]</a>
              <a href="subject.html#3813">[ subject ]</a>
              <a href="author.html#3813">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
