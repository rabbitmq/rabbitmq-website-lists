<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20.NET%20deadlock%20after%20calling%0A%09.CreateConnection&In-Reply-To=%21%26%21AAAAAAAAAAAYAAAAAAAAAGPzthVRDe9PgwIyDk6cGE/CgAAAEAAAAOT%2BKPvJpqVHkPHiM6qtoMkBAAAAAA%3D%3D%40oryo.lt">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003815.html">
   <LINK REL="Next"  HREF="003872.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20.NET%20deadlock%20after%20calling%0A%09.CreateConnection&In-Reply-To=%21%26%21AAAAAAAAAAAYAAAAAAAAAGPzthVRDe9PgwIyDk6cGE/CgAAAEAAAAOT%2BKPvJpqVHkPHiM6qtoMkBAAAAAA%3D%3D%40oryo.lt"
       TITLE="[rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection">alexis.richardson at gmail.com
       </A><BR>
    <I>Fri Jun 19 12:54:37 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003815.html">[rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection
</A></li>
        <LI>Next message: <A HREF="003872.html">[rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3868">[ date ]</a>
              <a href="thread.html#3868">[ thread ]</a>
              <a href="subject.html#3868">[ subject ]</a>
              <a href="author.html#3868">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrius

I just noticed nobody has replied to this thread.

Any thoughts on this anyone?

alexis


On Thu, Jun 11, 2009 at 4:18 PM, Andrius
Norkaitis&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">andrius.norkaitis at oryo.lt</A>&gt; wrote:
&gt;<i> Any thoughts why this deadlocks may occur? The most problematic is that this deadlocks occurs rarely and at client's site... (after long monitoring it occurred on our machine too).
</I>&gt;<i>
</I>&gt;<i> I have attached the source. Your help would be very appreciated.
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i> Andrius
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Ryan Davis [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ryan at acceleration.net</A>]
</I>&gt;<i> Sent: Monday, June 08, 2009 5:21 PM
</I>&gt;<i> To: Andrius Norkaitis
</I>&gt;<i> Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> Subject: Re: [Spam] [rabbitmq-discuss] RabbitMQ .NET Client sometimes hangs up
</I>&gt;<i>
</I>&gt;<i> Would it be possible to post your code? &#160;I use the .NET client in a similar way, spawning many threads each calling CreateConnection. &#160;I've simulated network problems by restarting my RabbitMQ server, and I see the .NET client throwing exceptions when it fails.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Ryan Davis
</I>&gt;<i> Acceleration.net
</I>&gt;<i> Director of Programming Services
</I>&gt;<i> 2831 NW 41st street, suite B
</I>&gt;<i> Gainesville, FL 32606
</I>&gt;<i>
</I>&gt;<i> Office: 352-335-6500 x 124
</I>&gt;<i> Fax: 352-335-6506
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Andrius Norkaitis wrote:
</I>&gt;&gt;<i> I think no. All rabbit code is in try/catch and nothing is logged in catch statement. Otherwise, if .net rabbit client method CreateConnection does some asynchronous stuff (haven't watch at a source deeply), errors may not be caught and in this case thread may halt, I think.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: Ryan Davis [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ryan at acceleration.net</A>]
</I>&gt;&gt;<i> Sent: Monday, June 08, 2009 4:06 PM
</I>&gt;&gt;<i> To: Andrius Norkaitis
</I>&gt;&gt;<i> Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> Subject: Re: [Spam] [rabbitmq-discuss] RabbitMQ .NET Client sometimes
</I>&gt;&gt;<i> hangs up
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is the thread throwing an exception before it halts?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ryan Davis
</I>&gt;&gt;<i> Acceleration.net
</I>&gt;&gt;<i> Director of Programming Services
</I>&gt;&gt;<i> 2831 NW 41st street, suite B
</I>&gt;&gt;<i> Gainesville, FL 32606
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Office: 352-335-6500 x 124
</I>&gt;&gt;<i> Fax: 352-335-6506
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Andrius Norkaitis wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hello,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I can&#8217;t find the problem and how to fix it so your help would be very appreciated.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Our .net client starts new thread which loops calling ConnectAndListen method (loop is for automatic reconnect). In ConnectAndListen method we create new connection and model, bind to queries and listen for messages (&quot;foreach (BasicDeliverEventArgs ee in subscription)&quot;).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Everything works like it has, but for sometimes unknown reason sometime client does not reconnect and hangs. It's not always and depends on network disturbances, so can&#8217;t easily debug. What I figured out, that thread halts after this statement is called:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> using (conn = cf.CreateConnection(serverAddress))
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Any thoughts what can cause it and how to fix it?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Best regards
</I>&gt;&gt;&gt;<i> Andrius
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003815.html">[rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection
</A></li>
	<LI>Next message: <A HREF="003872.html">[rabbitmq-discuss] RabbitMQ .NET deadlock after calling	.CreateConnection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3868">[ date ]</a>
              <a href="thread.html#3868">[ thread ]</a>
              <a href="subject.html#3868">[ subject ]</a>
              <a href="author.html#3868">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
