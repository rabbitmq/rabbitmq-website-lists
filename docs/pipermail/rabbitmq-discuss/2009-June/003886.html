<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Inconsistent results on nodes for rabbitmqctl	list_queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Inconsistent%20results%20on%20nodes%20for%20rabbitmqctl%0A%09list_queues&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003902.html">
   <LINK REL="Next"  HREF="003891.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Inconsistent results on nodes for rabbitmqctl	list_queues</H1>
    <B>Drew Smathers</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Inconsistent%20results%20on%20nodes%20for%20rabbitmqctl%0A%09list_queues&In-Reply-To="
       TITLE="[rabbitmq-discuss] Inconsistent results on nodes for rabbitmqctl	list_queues">drew.smathers at gmail.com
       </A><BR>
    <I>Mon Jun 22 20:44:34 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003902.html">[rabbitmq-discuss] my gen_fsm's supervisor getting channel	'DOWN' messages
</A></li>
        <LI>Next message: <A HREF="003891.html">[rabbitmq-discuss] Inconsistent results on nodes for rabbitmqctl list_queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3886">[ date ]</a>
              <a href="thread.html#3886">[ thread ]</a>
              <a href="subject.html#3886">[ subject ]</a>
              <a href="author.html#3886">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using rabbitmq (1.5.3) in a cluster of nodes and noticed that
rabbitmqctl will sometimes report inconsistent results for list_queues
from one to another.  &quot;status&quot; indicates the cluster is operating
normally, showing all nodes running:

  [{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;1.5.3&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.3&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.1.6&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.5.3&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.15.3&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.12.3&quot;}]},
 {nodes,[<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at hostB</A>,
         <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostC</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at hostD</A>]},
 {running_nodes,[<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at hostB</A>,
                 <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostC</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at hostD</A>]}]

Where hostA/B are disc nodes and hostC/D are ram nodes.  However,
running list_queues on hostC shows incosistent results from hostA,B,D.

list_queues on hostA:

  foo1  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0
  foo2  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0
  foo3  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0
  foo4  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0

list_queues on hostC:

  foo1  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0
  foo3  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0
  foo4  <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at hostA</A>  0

What kind of scenarios could cause this to occur?  This is of concern
to, me because upon testing declaration of foo2 from hostC,
unexpectedly the queue &quot;migrates&quot; from hostA to hostC (from the
perspective of all hosts) with consumers reset to 0; hence, consumers
on foo2 stop receiving messages.

-Drew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003902.html">[rabbitmq-discuss] my gen_fsm's supervisor getting channel	'DOWN' messages
</A></li>
	<LI>Next message: <A HREF="003891.html">[rabbitmq-discuss] Inconsistent results on nodes for rabbitmqctl list_queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3886">[ date ]</a>
              <a href="thread.html#3886">[ thread ]</a>
              <a href="subject.html#3886">[ subject ]</a>
              <a href="author.html#3886">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
