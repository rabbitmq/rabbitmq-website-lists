<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Many clients using .NET API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Many%20clients%20using%20.NET%20API&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003893.html">
   <LINK REL="Next"  HREF="003936.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Many clients using .NET API</H1>
    <B>Sam Owen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Many%20clients%20using%20.NET%20API&In-Reply-To="
       TITLE="[rabbitmq-discuss] Many clients using .NET API">sam.owen at gazprom-mt.com
       </A><BR>
    <I>Wed Jun 24 09:51:04 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003893.html">[rabbitmq-discuss] Error running rabbitmq-server on Mac OS X
</A></li>
        <LI>Next message: <A HREF="003936.html">[rabbitmq-discuss] Many clients using .NET API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3898">[ date ]</a>
              <a href="thread.html#3898">[ thread ]</a>
              <a href="subject.html#3898">[ subject ]</a>
              <a href="author.html#3898">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

 

I've just started to look at RabbitMQ. I'm wondering whether the
following would be an idiomatic use of RabbitMQ from the .NET API:

 

Routing.Listen(&quot;queue1&quot;, &quot;#&quot;, new ConsoleAlert());

Routing.Listen(&quot;queue1&quot;, &quot;news.#&quot;, new EmailAlert());

Routing.Listen(&quot;queue2&quot;, &quot;email.#&quot;, new ConsoleAlert());

 

Each call to Listen sets up a thread where the connection and channel
are maintained. 

 

public static void Listen(string queue, string routing, IRabbitListener
alert)

{

ThreadPool.QueueUserWorkItem(RunThis, new AlertState(queue, routing,
alert));

}

 

private static void RunThis(object state)

{

var alertState = state as AlertState;

      using (IConnection conn = new
ConnectionFactory().CreateConnection(&quot;localhost&quot;))

{

            using (IModel channel = conn.CreateModel())

            {

                  var sub = new Subscription(channel, alertState.Queue,
&quot;topic&quot;, alertState.Routing);

 

                  foreach (BasicDeliverEventArgs e in sub)

{

                        alertState.Alert.OnMessage(e.Exchange,
e.RoutingKey, Encoding.UTF8.GetString(e.Body));

                        sub.Ack(e);

                  }

            }

}

}

 

Given that .NET processes are more heavy weight than erlang's is this
the preferred way to set up many clients? 

Have I missed something in the .NET API for handling this type of case?

 

Thanks,

Sam



The information transmitted is the property of Gazprom Marketing &amp; Trading Ltd and is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Statements and opinions expressed in this e-mail may not represent those of the company. Any review, retransmission, dissemination and other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender immediately and delete the material from any computer. 

Registered office: Gazprom Marketing &amp; Trading Ltd, Gazprom House, 60 Marina Place, Hampton Wick, Kingston upon Thames, KT1 4BH. Registered in England No. 3768267


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090624/a0ac7fd4/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090624/a0ac7fd4/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003893.html">[rabbitmq-discuss] Error running rabbitmq-server on Mac OS X
</A></li>
	<LI>Next message: <A HREF="003936.html">[rabbitmq-discuss] Many clients using .NET API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3898">[ date ]</a>
              <a href="thread.html#3898">[ thread ]</a>
              <a href="subject.html#3898">[ subject ]</a>
              <a href="author.html#3898">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
