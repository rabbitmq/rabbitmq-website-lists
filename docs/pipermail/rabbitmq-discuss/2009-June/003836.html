<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Clustering in a changing network	environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20Clustering%20in%20a%20changing%20network%0A%09environment&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003835.html">
   <LINK REL="Next"  HREF="003838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Clustering in a changing network	environment</H1>
    <B>Anthony</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20Clustering%20in%20a%20changing%20network%0A%09environment&In-Reply-To="
       TITLE="[rabbitmq-discuss] RabbitMQ Clustering in a changing network	environment">anthony-rabbitmq at hogan.id.au
       </A><BR>
    <I>Wed Jun 17 08:10:25 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003835.html">[rabbitmq-discuss] extra basic.consume_ok
</A></li>
        <LI>Next message: <A HREF="003838.html">[rabbitmq-discuss] RabbitMQ Clustering in a changing network	environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3836">[ date ]</a>
              <a href="thread.html#3836">[ thread ]</a>
              <a href="subject.html#3836">[ subject ]</a>
              <a href="author.html#3836">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have several sites which run applications which hook into a
RabbitMQ implemented AMQP bus. At the moment, there's a single site
with a rabbit server, and everything connects into that, but obviously
as things grow and more apps request data etc., it seems like it might
be more efficient for each site to have its own RabbitMQ server to act
as somewhat of a concentrator and perform intelligent routing between
the sites as well as reduce the need for the transmission of duplicate
messages across the inter-site links.

What isn't quite so clear is how one might interconnect several sites
with respect to rabbit clustering when the link between one site and
others changes, if one site can only &quot;connect out&quot; and sites can't
connect back to it, and what happens if the node that contains a given
message queue dies

In our specific case, 3G wireless data links in Australia often have
internal, non-routable, pre-NAT'd addresses assigned to them, such
that when a site's primary ADSL or other connection fails and the
firewall router switches on the 3G link, other sites are no longer
able to connect in - this site is only able to connect out.

In the event of an inter-site link dropping, it's obviously important
to us that rabbit keep going and where alternate links come up, that
rabbit leverage those to keep the client network config simple and
keep everything running.

Reading through the rabbitmq docs, it seems the clustering is pretty
much all done by erlang - a language/environment I have little
experience with I admit..

When nodes join a cluster, do they then attempt to message one another
directly or go through the node they identified with specifically when
joining the cluster?
If they communicate via the specific node they identified to - can
they identify directly with several specific nodes?
Is this through a persistent connection, or something transient?
Are there any caveats with NAT (including the case where one can't map
a port back in) or dynamic IPs?
How does the whole nodename/hostname thing work/resolve?

It also sounded like each site, if it could be arguably cut off from
every other one, should be a disk node?

I guess I'm askin' a lot of questions here - reading the clustering
doc suggests it's primarily aimed for environments where each cluster
is located at a site with a single, pretty reliable connection with a
static IP and hostname which isn't always the case in our
environment...


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003835.html">[rabbitmq-discuss] extra basic.consume_ok
</A></li>
	<LI>Next message: <A HREF="003838.html">[rabbitmq-discuss] RabbitMQ Clustering in a changing network	environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3836">[ date ]</a>
              <a href="thread.html#3836">[ thread ]</a>
              <a href="subject.html#3836">[ subject ]</a>
              <a href="author.html#3836">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
