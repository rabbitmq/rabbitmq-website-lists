<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20stomp-adapter%20behaviour&In-Reply-To=200906072340.23972.nico%40rakar.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003738.html">
   <LINK REL="Next"  HREF="003774.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20stomp-adapter%20behaviour&In-Reply-To=200906072340.23972.nico%40rakar.com"
       TITLE="[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour">matthias at lshift.net
       </A><BR>
    <I>Tue Jun  9 06:09:17 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003738.html">[rabbitmq-discuss] [Spam] RabbitMQ .NET Client sometimes hangs up
</A></li>
        <LI>Next message: <A HREF="003774.html">[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3762">[ date ]</a>
              <a href="thread.html#3762">[ thread ]</a>
              <a href="subject.html#3762">[ subject ]</a>
              <a href="author.html#3762">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nicolas, Anders, and everybody else using the STOMP adapter,

Nicolas Echaniz wrote:

&gt;<i> it looks to me like non-STOMP extra-headers should not be required
</I>&gt;<i> from the client in order to achieve what seems to be a rather common
</I>&gt;<i> use case of a producer broadcasting to every subscribed consumer and
</I>&gt;<i> not just to any  of them (round-robinish behaviour).
</I>
Choosing the right default behaviour - i.e. what happens when SEND and 
SUBSCRIBE specify nothing but the 'destination' header - is tricky.

Here are some key questions that we need to answer:

1) Should messages be routed to all subscribers or just one (round-robin)?

2) Should messages be queued when there are no subscribers?

3) When a client has multiple subscriptions to the same destination,
    should they receive one copy of a message or several?

Pretty much any combination of answers is plausible here and the STOMP 
spec does not prescribe any particular one.

So, recognising that with extra headers we can, in principle, get any 
behaviour we want, what should the *default* behaviour be?


The default behaviour of the current implementation of the RabbitMQ 
STOMP adapter

1) routes messages to one consumer (round-robin) - this can be changed 
to 'all' by specifying appropriate 'exchange' and 'routing_key' headers

2) does not queue messages when there are no subscribers - this can be 
changed by specifying an 'auto-delete = false' header (though that does 
require at least one SUBSCRIBE to start with)

3) sends only one copy of a message to a client in the event the client 
has more than one subscription for the same destination - this can be 
changed by specifying  appropriate 'exchange' and 'routing_key' headers


Should the default behaviour be different? And why?


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003738.html">[rabbitmq-discuss] [Spam] RabbitMQ .NET Client sometimes hangs up
</A></li>
	<LI>Next message: <A HREF="003774.html">[rabbitmq-discuss] RabbitMQ stomp-adapter behaviour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3762">[ date ]</a>
              <a href="thread.html#3762">[ thread ]</a>
              <a href="subject.html#3762">[ subject ]</a>
              <a href="author.html#3762">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
