<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbit MQ high-through put stock quotes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbit%20MQ%20high-through%20put%20stock%20quotes&In-Reply-To=23876536.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003696.html">
   <LINK REL="Next"  HREF="003711.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbit MQ high-through put stock quotes</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbit%20MQ%20high-through%20put%20stock%20quotes&In-Reply-To=23876536.post%40talk.nabble.com"
       TITLE="[rabbitmq-discuss] rabbit MQ high-through put stock quotes">matthias at lshift.net
       </A><BR>
    <I>Fri Jun  5 14:39:14 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003696.html">[rabbitmq-discuss] rabbit MQ high-through put stock quotes
</A></li>
        <LI>Next message: <A HREF="003711.html">[rabbitmq-discuss] rabbit MQ high-through put stock quotes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3699">[ date ]</a>
              <a href="thread.html#3699">[ thread ]</a>
              <a href="subject.html#3699">[ subject ]</a>
              <a href="author.html#3699">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mark,

smittycb10 wrote:
&gt;<i> My idea for a future system is to have the same server simply push the
</I>&gt;<i> messages to a rabbit MQ Broker or Brokers and then have all clients simply
</I>&gt;<i> listen to whatever queues they need to get there jobs done. I need to design
</I>&gt;<i> for 100,000 (one hundred thousand) messages to made available for consuming
</I>&gt;<i> per second. Most consumers will only consume a fraction of these messages,
</I>&gt;<i> although some of our server pieces may need to subscribe to the whole
</I>&gt;<i> universe of incoming messages. Messages can and will be batched on the
</I>&gt;<i> publishing side.
</I>
I recommend treating the &quot;all messages to a few consumers&quot; and &quot;each
message to a small subset of lots of consumers&quot; cases separately.

If you don't mind, I'd like to focus on the first part, since that one
is easier to set up. Once you have that working we can then move on to
the second part.

To get a 100KHz stream of messages distributed to a handful of
consumers, I'd suggest batching them based on time, e.g. 1 millisecond's
worth of messages, and send each batch as a single message to a fanout
exchange to which all consumers have bound a queue.

On the consuming side, use a no-ack consumer (and, consequently, do not
explicitly acknowledge the messages) for best performance.

Also, let me just re-iterate that for meaningful benchmark results it is
important to throttle the producer, e.g. send messages at a fixed rate.
If you do the time-based batching above you'll have good control over
that. Then monitor the rate at which messages are received by consumers,
and slowly increase the producing rate until the consumption rate starts
falling behind, at which point you have found the limits of that
particular setup.

Also, make sure you run the producers and consumers on a different
machine to the broker, and monitor their CPU usage in case they are
maxing out the CPU (and thus skew the results).


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003696.html">[rabbitmq-discuss] rabbit MQ high-through put stock quotes
</A></li>
	<LI>Next message: <A HREF="003711.html">[rabbitmq-discuss] rabbit MQ high-through put stock quotes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3699">[ date ]</a>
              <a href="thread.html#3699">[ thread ]</a>
              <a href="subject.html#3699">[ subject ]</a>
              <a href="author.html#3699">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
