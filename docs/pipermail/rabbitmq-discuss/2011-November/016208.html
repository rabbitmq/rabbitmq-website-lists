<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Acknowledged Messages Requeued
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Acknowledged%20Messages%20Requeued&In-Reply-To=%3C4EC1113A.7020500%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016201.html">
   <LINK REL="Next"  HREF="016184.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Acknowledged Messages Requeued</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Acknowledged%20Messages%20Requeued&In-Reply-To=%3C4EC1113A.7020500%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Acknowledged Messages Requeued">emile at rabbitmq.com
       </A><BR>
    <I>Mon Nov 14 13:01:46 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016201.html">[rabbitmq-discuss] Acknowledged Messages Requeued
</A></li>
        <LI>Next message: <A HREF="016184.html">[rabbitmq-discuss] Blueprint Java Project
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16208">[ date ]</a>
              <a href="thread.html#16208">[ thread ]</a>
              <a href="subject.html#16208">[ subject ]</a>
              <a href="author.html#16208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ben,

On 14/11/11 10:46, Ben Lewis wrote:
&gt;<i> If I run the publisher, then once that has enqueued 100,000 items run
</I>&gt;<i> the consumer. If after it has consumed 20,000 and still consuming, I do
</I>&gt;<i> a graceful start of the RabbitMQ broker's OS (running on Windows Server
</I>&gt;<i> 2008, so Start, Shutdown/Restart), when the broker comes back online I
</I>&gt;<i> have 100,000 items in the queue (even though approx 20,000 are consumed
</I>&gt;<i> and acknowledged).
</I>
I'm only able to reproduce your result if I shut down the broker
forcefully. Stopping the the broker by using the service control manager
or using the rabbitmq-service.bat script does stop the broker
gracefully, allowing all acknowledgements to be written to disk. I can
only assume that hitting the Shutdown/Restart button on Windows does not
first stop all the running services.

If the broker is not stopped gracefully then clients must be prepared to
received duplicate messages for which acknowledgements were sent, but
not yet written to disk by the broker. That is the case regardless of
OS. That may be just a few messages, or tens of thousands.


-Emile

</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016201.html">[rabbitmq-discuss] Acknowledged Messages Requeued
</A></li>
	<LI>Next message: <A HREF="016184.html">[rabbitmq-discuss] Blueprint Java Project
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16208">[ date ]</a>
              <a href="thread.html#16208">[ thread ]</a>
              <a href="subject.html#16208">[ subject ]</a>
              <a href="author.html#16208">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
