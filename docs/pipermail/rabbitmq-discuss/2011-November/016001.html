<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbitmq message?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20message%3F&In-Reply-To=%3Caaac094b-4178-429e-8f22-baccfc2adc0c%40StrongMad.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016207.html">
   <LINK REL="Next"  HREF="016002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbitmq message?</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20message%3F&In-Reply-To=%3Caaac094b-4178-429e-8f22-baccfc2adc0c%40StrongMad.local%3E"
       TITLE="[rabbitmq-discuss] Rabbitmq message?">jerryk at vmware.com
       </A><BR>
    <I>Sun Nov  6 00:02:24 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016207.html">[rabbitmq-discuss] Architecture question
</A></li>
        <LI>Next message: <A HREF="016002.html">[rabbitmq-discuss] HA Client for RabbitMQ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16001">[ date ]</a>
              <a href="thread.html#16001">[ thread ]</a>
              <a href="subject.html#16001">[ subject ]</a>
              <a href="author.html#16001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, Nguyen...

&gt;<i> Hi Jerry, thanks millions for you reply.I will give you more details
</I>&gt;<i> so may be you can help me to solve my problem. What I actually do that
</I>&gt;<i> I want to send a java object to the queue. Two channels will be
</I>&gt;<i> registered and the java object will be delivered to them. In this
</I>&gt;<i> case,the message type is not a array of bytes.Take a look at my
</I>&gt;<i> example code, may be you will be more clear:
</I>
The AMQP protocol, and thus the RabbitMQ Java client, view the message
payload as a structure-less blob of bytes.  You can see this in the
Javadoc for the basicPublish's method signature:

void basicPublish(java.lang.String exchange,
                  java.lang.String routingKey,
                  AMQP.BasicProperties props,
                  byte[] body)   &lt;-- UNSTRUCTURED BLOB OF BYTES!
                  throws java.io.IOException

If we return to your pseudocode example...

&gt;<i> For the sender:
</I>&gt;<i>
</I>&gt;<i> Book message = new Book(&quot;A&quot;,&quot;Hoan&quot;);
</I>&gt;<i> channel.basicPublish(&quot;&quot;, QUEUE_NAME, null,message);
</I>
We see that the parameter in which you want to pass your Book object
is declared to be of type byte[].  Thus, what you write will never
compile.  You'd have to choose some way to convert your Book object into
an array of bytes and, correspondingly, to convert the transmitted array of
bytes at the receiving end back into a Book Java object.

Out of curiosity, have you worked with Java Serialization before?
Java Serialization may help you with this, but be warned:  although it
is very powerful, it has many subtleties and will impose some serious
inflexibilities on the system you're building.  Both sides of the
conversation are going to need to need suitably versioned, compatible
definitions of the Book class on their CLASSPATHs.  Also, things can
get complex when the object you're serializing isn't simple, since you
need to send over the entire object graph implied by what the sender
has.  If you look at chapter 11 of Josh Bloch's &quot;Effective Java,&quot;
second edition, you will get a sense for just how hairy Serialization,
which starts off seeming simple, can get in practice.

Another problem you'll have is that if the other side of your
communications channel isn't a Java program (or as above just isn't a
Java program which a perfectly suitable version of your Book class)
you won't be able to communicate at all, and you'll discover this with
ugly exceptions being thrown on the receiving end.  There are also
potential security pitfalls to be wary of.  This is counter to the
spirit of AMQP, which aims to provide easy interoperability between
programs potentially written in different languages, running on
different operating systems, etc.

If you're only concerned about some set of basic, structured data that
describes a book (e.g. each book has a title, author, and publication
date, or something like that), rather than the full semantics of a
Java object with all of its *callable methods* and *code*, as well as
the raw data it's carrying, you might consider serializing into XML,
or JSON, or the like, or using one of the other less exotic then Java
Serialization frameworks that have come into being, like Google's
ProtocolBuffers, or Facebook's Thrift.

Does that make sense?

Best regards,
Jerry
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016207.html">[rabbitmq-discuss] Architecture question
</A></li>
	<LI>Next message: <A HREF="016002.html">[rabbitmq-discuss] HA Client for RabbitMQ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16001">[ date ]</a>
              <a href="thread.html#16001">[ thread ]</a>
              <a href="subject.html#16001">[ subject ]</a>
              <a href="author.html#16001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
