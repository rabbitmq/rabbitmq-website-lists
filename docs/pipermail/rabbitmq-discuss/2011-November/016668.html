<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Socket leak in java client library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Socket%20leak%20in%20java%20client%20library&In-Reply-To=%3C89C2D4F0-7A2D-4F9C-9EF9-149DE17046F6%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016612.html">
   <LINK REL="Next"  HREF="016586.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Socket leak in java client library</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Socket%20leak%20in%20java%20client%20library&In-Reply-To=%3C89C2D4F0-7A2D-4F9C-9EF9-149DE17046F6%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Socket leak in java client library">steve at rabbitmq.com
       </A><BR>
    <I>Wed Nov 30 18:10:55 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016612.html">[rabbitmq-discuss] Socket leak in java client library
</A></li>
        <LI>Next message: <A HREF="016586.html">[rabbitmq-discuss] Viewing what applications are connected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16668">[ date ]</a>
              <a href="thread.html#16668">[ thread ]</a>
              <a href="subject.html#16668">[ subject ]</a>
              <a href="author.html#16668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Iain,

Looking at the newConnection() code in detail, I have chosen not to do connection cleanup in newConnection() (as in your patch) but in AMQConnection.start() where (most of) it belongs.   In other words, when AMQConnection.start() detects a problem, it cleans up any debris (threads, heartbeat executors and/or sockets) it may have created during socket setup and connection negotiations before throwing an exception.  This allows us to ignore errors (except for reporting) in the newConnection loop without leaking resources.

If this passes QA it should appear in the next release, and be documented in the JavaDoc. These fixes are presently under the bug24597 track.

Steve Powell  (a tired bunny)
----------some more definitions from the SPD----------
avoirdupois (phr.) 'Would you like peas with that?'
distribute (v.) To denigrate an award ceremony.
definite (phr.) 'It's hard of hearing, I think.'
modest (n.) The most mod.

On 28 Nov 2011, at 20:39, Iain Hull wrote:
&gt;<i> <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-November/016612.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-November/016612.html</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016612.html">[rabbitmq-discuss] Socket leak in java client library
</A></li>
	<LI>Next message: <A HREF="016586.html">[rabbitmq-discuss] Viewing what applications are connected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16668">[ date ]</a>
              <a href="thread.html#16668">[ thread ]</a>
              <a href="subject.html#16668">[ subject ]</a>
              <a href="author.html#16668">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
