<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Crash&In-Reply-To=%3C1321283831.68598.YahooMailNeo%40web111007.mail.gq1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016249.html">
   <LINK REL="Next"  HREF="016214.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Crash</H1>
    <B>Dave Greggory</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Crash&In-Reply-To=%3C1321283831.68598.YahooMailNeo%40web111007.mail.gq1.yahoo.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Crash">davegreggory at yahoo.com
       </A><BR>
    <I>Mon Nov 14 15:17:11 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016249.html">[rabbitmq-discuss] Create exchanges and queues beforehand
</A></li>
        <LI>Next message: <A HREF="016214.html">[rabbitmq-discuss] RabbitMQ Crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16212">[ date ]</a>
              <a href="thread.html#16212">[ thread ]</a>
              <a href="subject.html#16212">[ subject ]</a>
              <a href="author.html#16212">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We're running RabbitMQ 2.5.1 in production and it crashed last week. Crash = Dropped all connections and process died (i.e. rabbitmqctl status and ps -ef | grep rabbitmq both showed that the process itself was not running).&#160;

Setup -
2 non-clustered RabbitMQ nodes behind a load balancer with only 1 node being active in the load balancer (2nd one is there for failover in case situations like this).&#160;
No special config (All defaults)
Only Management plugin used.&#160;

CentOS Linux&#160;2.6.18-164.el5 x86_64
Erlang R13B04

Clients mostly Java-library 2.5.1 (some older apps with 2.3.1 and 2.0.0 clients).&#160;

I attached the logs (errors starting at 8-Nov-2011::18:13:02 mark). I also backed up mnesia in its error state and can provide if needed. There's an erl_crash.dump which I can provide if needed as well.&#160;No CPU or memory spikes.

I was able to start it up again no problem. Just saw the following in the logs at startup (which seemed unusual).

&#160; &#160;=WARNING REPORT==== 8-Nov-2011::18:42:03 ===

&#160; &#160;msg_store_persistent: recovery terms differ from present
&#160; &#160;rebuilding indices from scratch


We did not upgraded to 2.6.1 because it seemed to be a buggy release (purely based on this mailing list)... i.e. HA nodes config didn't work, etc. I will upgrade our QA environment to 2.7.0 shortly but probably will not go live with 2.7.0 for at least a month (to verify stability).&#160;In the mean time, we'd like to understand what happened.

We've been pretty happy with RabbitMQ so far, and it has been quite stable on the server side (the java client library is another issue, but that's for another topic). I'm excited to start using HA functionality in 2.7.0.&#160;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: incident-logs.tar.gz
Type: application/x-gzip
Size: 111956 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c0d57e3f/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c0d57e3f/attachment.bin</A>&gt;
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: report-minimal-post-restart.txt
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c0d57e3f/attachment.txt">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c0d57e3f/attachment.txt</A>&gt;
</PRE>






































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016249.html">[rabbitmq-discuss] Create exchanges and queues beforehand
</A></li>
	<LI>Next message: <A HREF="016214.html">[rabbitmq-discuss] RabbitMQ Crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16212">[ date ]</a>
              <a href="thread.html#16212">[ thread ]</a>
              <a href="subject.html#16212">[ subject ]</a>
              <a href="author.html#16212">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
