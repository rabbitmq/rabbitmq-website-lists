<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Breaking API changes in JAva API 2.7.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Breaking%20API%20changes%20in%20JAva%20API%202.7.0&In-Reply-To=%3CE743030D-082A-4D3D-96BE-14FCAE7AFE60%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016138.html">
   <LINK REL="Next"  HREF="016200.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Breaking API changes in JAva API 2.7.0</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Breaking%20API%20changes%20in%20JAva%20API%202.7.0&In-Reply-To=%3CE743030D-082A-4D3D-96BE-14FCAE7AFE60%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Breaking API changes in JAva API 2.7.0">steve at rabbitmq.com
       </A><BR>
    <I>Fri Nov 11 11:23:43 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016138.html">[rabbitmq-discuss] Breaking API changes in JAva API 2.7.0
</A></li>
        <LI>Next message: <A HREF="016200.html">[rabbitmq-discuss] Breaking API changes in JAva API 2.7.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16153">[ date ]</a>
              <a href="thread.html#16153">[ thread ]</a>
              <a href="subject.html#16153">[ subject ]</a>
              <a href="author.html#16153">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Irmo,

&gt;<i> It was useful since you only need one ConnectionFactory and one call
</I>&gt;<i> to connect to a cluster.
</I>&gt;<i> Now I would have to change the internals (host/port) for every try to
</I>&gt;<i> a node in a cluster (nasty imo, who likes these mutable objects anyway
</I>&gt;<i> ;-) ), or I would need a ConnectionFactory per connection I can make
</I>&gt;<i> but that seems a bit overkill too, since all of them would start
</I>&gt;<i> Executors etc.
</I>Well, no -- you would simply issue newConnection for each address in your
array -- an array you had to pass on the newConnection method before.
(The ExecutorService is not used if the connection is not made.)

I admit it's an extra loop, but no set*() calls are necessary.

&gt;<i> So I'd say I actually really liked the fact that I could create a
</I>&gt;<i> single 'immutable' ConnectionFactory for my cluster and then just
</I>&gt;<i> leave it and (re)use it.
</I>Since the array was never stored in the Factory, you could never do that.
A newConnection() call simply used the 'default' host and port set on 
the factory. It still does.

In general it might be quite a good idea to put a set of cluster
addresses somewhere where clients could not have to worry
about them when getting a connection.  It might be nice to 
put that in the ConnectionFactory (enhancement request?)
but on the other hand, you would probably want to implement
a more sophisticated algorithm than &quot;connect to the first one
that's up&quot;.   I guess you would know best what algorithm to use.
It's not likely we would consider putting that in the Factory object.

&gt;<i> It was breaking in the sense that the new client jar was not a direct
</I>&gt;<i> drop-in replacement for the previous one.
</I>&gt;<i> I would usually expect either an update where some api would get a
</I>&gt;<i> @deprecated annotation and would be removed in a next version, or that
</I>&gt;<i> there at least would be a notice of any breaking api changes in the
</I>&gt;<i> release notes (no matter how small the change is).
</I>&gt;<i> Especially if you maintain an api library it's really important to
</I>&gt;<i> keep the api as stable as possible and otherwise be super clear in
</I>&gt;<i> documentation about the changes and examples on how to migrate and
</I>&gt;<i> have deprecated backwards compatible phases. Otherwise a new update of
</I>&gt;<i> the library should (certainly since you have nice binary compatibility
</I>&gt;<i> in java) always be a drop in replacement so user can benefit from
</I>&gt;<i> improved implementation without any hassle.
</I>You are dead right, of course, and we could have handled this better.
Normally I would expect binary compatibility
if it was only a micro release update, but this was a minor release update,
so one might have expected some differences. Still, thanks for your
admonition: we'll try to flag api changes better in future.

Incidentally, we are interested if you see any anomalies in the
Java Client info on the rabbitmq documentation pages. Since
there have been some subtle threading changes in this release
we appreciate feedback on these issues.

&gt;<i> Other then the api changes I usually have no problems with any updates
</I>
&gt;<i> and they work flawlessly. :-)
</I>Thank you.

Steve Powell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>
[wrk: +44-2380-111-528] [mob: +44-7815-838-558]
</PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016138.html">[rabbitmq-discuss] Breaking API changes in JAva API 2.7.0
</A></li>
	<LI>Next message: <A HREF="016200.html">[rabbitmq-discuss] Breaking API changes in JAva API 2.7.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16153">[ date ]</a>
              <a href="thread.html#16153">[ thread ]</a>
              <a href="subject.html#16153">[ subject ]</a>
              <a href="author.html#16153">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
