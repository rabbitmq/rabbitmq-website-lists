<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Create exchanges and queues beforehand
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Create%20exchanges%20and%20queues%20beforehand&In-Reply-To=%3C4EC107FA.5080800%40eng.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016189.html">
   <LINK REL="Next"  HREF="016213.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Create exchanges and queues beforehand</H1>
    <B>Stefano Ghio</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Create%20exchanges%20and%20queues%20beforehand&In-Reply-To=%3C4EC107FA.5080800%40eng.it%3E"
       TITLE="[rabbitmq-discuss] Create exchanges and queues beforehand">steghio at eng.it
       </A><BR>
    <I>Mon Nov 14 12:22:18 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016189.html">[rabbitmq-discuss] Message durability and partition tolerence
</A></li>
        <LI>Next message: <A HREF="016213.html">[rabbitmq-discuss] Create exchanges and queues beforehand
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16205">[ date ]</a>
              <a href="thread.html#16205">[ thread ]</a>
              <a href="subject.html#16205">[ subject ]</a>
              <a href="author.html#16205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Cheers,

I was fiddling with the Topic examples and I ran into a problem. If I 
start the client &quot;ReceiveLogsTopic&quot; before the sender &quot;EmitLogTopic&quot; I 
see everything working fine. Sender sends and client receives and 
displays right.

However, if I start the sender before the client, the message gets sent 
but then nothing happens, the queue appears to be empty and the client 
keeps waiting for nothing.

I think that's correct since the queue is created at runtime and is 
destroyed when there's nothing more to do with it as explained in the 
documentation:

channel.exchangeDeclare(*exchangeName*,*&quot;direct&quot;*,*true*);
String*queueName*  = channel.queueDeclare().getQueue();
channel.queueBind(*queueName*,*exchangeName*,*routingKey*);

This will actively declare the following objects, both of which can be 
customised by using additional parameters. Here neither of them have any 
special arguments.

 1. a durable, non-autodelete exchange of &quot;direct&quot; type
 2. a non-durable, exclusive, autodelete queue with a generated name



What I would like to do instead is (example):

1)
create 3 exchanges: EXA, EXB and EXC
for every exchange, create 2 queues and bind them to it: Q1 and Q2. All 
queues have the same name but are not the same object (see attached PNG 
if needed)
2)
send a message to be queued in queue Q1 through EXA
send the same message to be queued in queue Q1 through EXB
message then is queued in two different queues which happen to have the 
same name but are binded to different exchanges
3)
poll Q1 through EXA to read messages and delete message
poll Q1 through EXB to read messages and leave message there
message then is no longer in EXA-Q1 but is still available through EXB-Q1

I don't and can't know if and when someone will try to send or read 
messages.

I guess it would require me to declare and bind a queue beforehand, 
maybe by using 3 classes: setUpExchangeAndQueues, sendMessage, 
pollMessages, but I'm a bit at loss here, could anyone point me in the 
right direction?

I read that:

If several clients want to share a queue with a well-known name, this 
code would be appropriate:

channel.exchangeDeclare(*exchangeName*,*&quot;direct&quot;*,*true*);
channel.queueDeclare(*queueName*,*true*,*false*,*false*,*null*);
channel.queueBind(*queueName*,*exchangeName*,*routingKey*);

This will actively declare:

 1. a durable, non-autodelete exchange of &quot;direct&quot; type
 2. a durable, non-exclusive, non-autodelete queue with a well-known name

Tried it but failed.

Please advise, I'm going crazy on this.

Thank you,

have a nice day
-- 
Dr. Stefano Ghio - ENG Engineering Italy

Website: <A HREF="http://groglogs.blogspot.com/">http://groglogs.blogspot.com/</A>

*If you received this message but you are not its recipient, please 
ignore it and warn me, thank you.*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c323acb7/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c323acb7/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: exq.PNG
Type: image/png
Size: 8402 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c323acb7/attachment.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111114/c323acb7/attachment.png</A>&gt;
</PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016189.html">[rabbitmq-discuss] Message durability and partition tolerence
</A></li>
	<LI>Next message: <A HREF="016213.html">[rabbitmq-discuss] Create exchanges and queues beforehand
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16205">[ date ]</a>
              <a href="thread.html#16205">[ thread ]</a>
              <a href="subject.html#16205">[ subject ]</a>
              <a href="author.html#16205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
