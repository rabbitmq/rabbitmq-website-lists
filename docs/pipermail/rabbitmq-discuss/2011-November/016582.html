<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-c%20%28librabbizmq%29%20works%20only%0A%09partially.&In-Reply-To=%3Cabedf3db-60b0-4369-9dce-676629672d02%40r28g2000yqj.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016576.html">
   <LINK REL="Next"  HREF="016585.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.</H1>
    <B>TZHA</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-c%20%28librabbizmq%29%20works%20only%0A%09partially.&In-Reply-To=%3Cabedf3db-60b0-4369-9dce-676629672d02%40r28g2000yqj.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.">sophiewenxizhang at googlemail.com
       </A><BR>
    <I>Mon Nov 28 13:13:57 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016576.html">[rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.
</A></li>
        <LI>Next message: <A HREF="016585.html">[rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16582">[ date ]</a>
              <a href="thread.html#16582">[ thread ]</a>
              <a href="subject.html#16582">[ subject ]</a>
              <a href="author.html#16582">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi David,

thanks for the reply.

The error I got with the latest version of rabbitmq-c was:

&quot;A buffer overrun has occurred in z_rabbitmq_client_consumer.exe which
has corrupted the program's internal state. Press Break to debug the
program or Continue to terminate the program.

For more details please see Help topic 'How to debug Buffer Overrun
Issues'.

Beaks point went to &quot;#if defined (_CRTBLD) &amp;&amp; !defined (_SYSCRT)
    DebuggerWasPresent = IsDebuggerPresent();
    _CRT_DEBUGGER_HOOK(_CRT_DEBUGGER_GSFAILURE);
#endif  /* defined (_CRTBLD) &amp;&amp; !defined (_SYSCRT) */&quot; in gs_report.c
from VS 2010.

I started VS 2010 debugging on a consumer project (c++) which uses the
rabbitmq-c c api.

I guess I finally found out at least the reason for my previous
error.  I used a c++ wrapper (amqpcpp  - modified) which calls
amqp_simple_rpc to implement the consumer, which then caused the error
(but runs correctly with DEBUG).

I modified the code to use amqp_basic_consume (following the
consumer.c), the c++ consumer  application works now.

However, I still have the buffer overrun problem with the latest
version. I used MinGW to build the package.  Do you whether there is a
guide/readme for cmake build?





On 28 Nov., 13:28, David Wragg &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">da... at rabbitmq.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> John &#160;&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tianning.zh... at zanox.com</A>&gt; writes:
</I>&gt;<i> &gt; I am using rabbitmq-c under windows (VS 2010). The basic get features
</I>&gt;<i> &gt; works just fine. However when I tested the &quot;consumer&quot; feature I
</I>&gt;<i> &gt; encountered the following problem.
</I>&gt;<i>
</I>&gt;<i> What approach to building rabbitmq-c under windows are you using? &#160;Are
</I>&gt;<i> you running the amqp_consumer example program, or your own consumer
</I>&gt;<i> code?
</I>&gt;<i>
</I>&gt;<i> If you are developing under Visual Studio, I recommend using the
</I>&gt;<i> cmake-based build, as that allows you to build librabbitmq and the
</I>&gt;<i> examples within VS.
</I>&gt;<i>
</I>&gt;<i> &gt; 1. Starting application debugging from VS 2010 (even without any break points
</I>&gt;<i> &gt; and in release configuration) everything looks ok (calling amqp_simple_rpc
</I>&gt;<i> &gt; returns AMQP_RESPONSE_NORMAL)!
</I>&gt;<i>
</I>&gt;<i> &gt; 2. Starting the application without debuging I got an error in calling
</I>&gt;<i> &gt; amqp_rpc_reply_t amqp_simple_rpc
</I>&gt;<i>
</I>&gt;<i> &gt; with amqp_response_type_enum reply_type = AMQP_RESPONSE_LIBRARY_EXCEPTION
</I>&gt;<i> &gt; and library_error = ERROR_BAD_AMQP_DATA
</I>&gt;<i>
</I>&gt;<i> &gt; I guess there is some &quot;DEBUG&quot; coding in source. Can anyone tell we
</I>&gt;<i> &gt; where I can make changes to solve this problem??
</I>&gt;<i>
</I>&gt;<i> There's nothing in the rabbitmq-c codebase ot make it behave differently
</I>&gt;<i> in debug builds.
</I>&gt;<i>
</I>&gt;<i> &gt; I have downloaded rabbitmq-c-default from 21.09.2011 and rebuild the
</I>&gt;<i> &gt; sources under windows. Rabbitmq servers have the version 2.4.1 and
</I>&gt;<i> &gt; 2.6.1.
</I>&gt;<i>
</I>&gt;<i> &gt; I also tried the newest version from the server (dated 25.11, default
</I>&gt;<i> &gt; and the version 7cecf64752fd) - there I got the buffer overrun error.
</I>&gt;<i>
</I>&gt;<i> There have not been significant changes to the rabbitmq-c code between
</I>&gt;<i> those two versions. &#160;I recommend that you use the latest version,
</I>&gt;<i> because it has cmake build support. &#160;Could you say more about the buffer
</I>&gt;<i> overrun you are seeing?
</I>&gt;<i>
</I>&gt;<i> David
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> David Wragg
</I>&gt;<i> Staff Engineer, RabbitMQ
</I>&gt;<i> VMware, Inc.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I></PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016576.html">[rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.
</A></li>
	<LI>Next message: <A HREF="016585.html">[rabbitmq-discuss] rabbitmq-c (librabbizmq) works only	partially.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16582">[ date ]</a>
              <a href="thread.html#16582">[ thread ]</a>
              <a href="subject.html#16582">[ subject ]</a>
              <a href="author.html#16582">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
