<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] asynchronous fetching messages from rabbitMQ queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20asynchronous%20fetching%20messages%20from%20rabbitMQ%0A%20queues&In-Reply-To=%3C4EBB9445.4060509%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016117.html">
   <LINK REL="Next"  HREF="016126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] asynchronous fetching messages from rabbitMQ queues</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20asynchronous%20fetching%20messages%20from%20rabbitMQ%0A%20queues&In-Reply-To=%3C4EBB9445.4060509%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] asynchronous fetching messages from rabbitMQ queues">matthias at rabbitmq.com
       </A><BR>
    <I>Thu Nov 10 09:07:17 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016117.html">[rabbitmq-discuss] asynchronous fetching messages from rabbitMQ queues
</A></li>
        <LI>Next message: <A HREF="016126.html">[rabbitmq-discuss] asynchronous fetching messages from rabbitMQ	queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16118">[ date ]</a>
              <a href="thread.html#16118">[ thread ]</a>
              <a href="subject.html#16118">[ subject ]</a>
              <a href="author.html#16118">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/11/11 08:51, pavuuu wrote:
&gt;&gt;<i> When using 'BasicConsume' without setting BasicQos on channel, it seems it
</I>&gt;&gt;<i> is connecting to RabbitMQ everytime I call 'consumer.Queue.Dequeue()'.
</I>
Dequeue *never* triggers an interaction with the server. Messages are 
sent by the server to the client (and buffered in the consumer.Queue) in 
the background. Basic.Qos controls the flow of these messages. Without a 
prefetch limit, the server sends messages to the client as soon as they 
become available in the queue. With a prefetch limit of N, the server 
will send at most N message and then send no more until it receives one 
or more acks.

&gt;&gt;&gt;&gt;<i> Btw, you do realise that the Dequeue() operation is client-side only,
</I>&gt;&gt;&gt;&gt;<i> right? i.e. it is simply manipulating a client side buffer which is
</I>&gt;&gt;&gt;&gt;<i> filled as and when the client receives a message from the server.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> yes, I understood that. When I set the prefetch to 1000, at client side a
</I>&gt;&gt;<i> buffer is being maintained which will contain a maximum of 1000 messages.
</I>&gt;&gt;<i> When I call dequeue, it is giving me the message from this buffer.
</I>
The buffer is there regardless of Basic.Qos. But without Basic.Qos it 
can grow unbounded if the client app isn't draining it fast enough. With 
Basic.Qos the size is bounded to the prefetch size.

&gt;&gt;<i> And if there are less than 1000 messages in buffer, it refills the buffer
</I>&gt;&gt;<i> if there are any messages in the queue bound to it.
</I>
The refilling is triggered by the client ack'ing messages.


Matthias.
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016117.html">[rabbitmq-discuss] asynchronous fetching messages from rabbitMQ queues
</A></li>
	<LI>Next message: <A HREF="016126.html">[rabbitmq-discuss] asynchronous fetching messages from rabbitMQ	queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16118">[ date ]</a>
              <a href="thread.html#16118">[ thread ]</a>
              <a href="subject.html#16118">[ subject ]</a>
              <a href="author.html#16118">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
