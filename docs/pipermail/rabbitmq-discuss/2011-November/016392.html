<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cluster Memory Usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20Memory%20Usage&In-Reply-To=%3C4EC901F3.4040500%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016307.html">
   <LINK REL="Next"  HREF="016395.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cluster Memory Usage</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20Memory%20Usage&In-Reply-To=%3C4EC901F3.4040500%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Cluster Memory Usage">matthias at rabbitmq.com
       </A><BR>
    <I>Sun Nov 20 13:34:43 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016307.html">[rabbitmq-discuss] Cluster Memory Usage
</A></li>
        <LI>Next message: <A HREF="016395.html">[rabbitmq-discuss] Cluster Memory Usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16392">[ date ]</a>
              <a href="thread.html#16392">[ thread ]</a>
              <a href="subject.html#16392">[ subject ]</a>
              <a href="author.html#16392">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Cameron,

On 16/11/11 20:06, Cameron Davison wrote:
&gt;<i> I have a cluster of 2 rabbitmq on 2 machines in the same datacenter.
</I>&gt;<i> I am sending messages to them at a rate of about 250 message a second
</I>&gt;<i> each message is about 2k in size on average. The software is able to
</I>&gt;<i> read them back out at about the same rate. Sometime slower usually
</I>&gt;<i> faster, which is why I am using a message queue. [...] There are
</I>&gt;<i> about 10 publishers channels/connections, and about 30 consumer
</I>&gt;<i> channels/connections. The prefetch is set to 1000 for each channel
</I>&gt;<i> of the consumers. [...] The cluster is using mirrored queue and
</I>&gt;<i> confirmations on the writes as well as batch acking on the consumes.
</I>
Do all the queue masters reside on the same machine? Or perhaps there is 
just one queue (in which case the answer obviously is 'yes').

Also, what machine do the publishers and consumers connect to?

Are the queues durable and the messages persistent?

&gt;<i> The master rabbitmq is reporting a memory usage by the erlang
</I>&gt;<i> processer of about 200MB and the slave rabbitmq is reporting around
</I>&gt;<i> 800MB but sometimes jumps back and forth between 400MB and 900MB
</I>&gt;<i> rapidly. Is there any reason that the memory usage is so different
</I>&gt;<i> between the master and the slave.
</I>
The workload of the master and slave are quite different, so a 
difference in the memory profile is not surprising.

Inspecting the memory details of the nodes with 'rabbitmqctl status', or 
with the management plug-in, might shed some light on where the memory 
is going.


Regards,

Matthias.
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016307.html">[rabbitmq-discuss] Cluster Memory Usage
</A></li>
	<LI>Next message: <A HREF="016395.html">[rabbitmq-discuss] Cluster Memory Usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16392">[ date ]</a>
              <a href="thread.html#16392">[ thread ]</a>
              <a href="subject.html#16392">[ subject ]</a>
              <a href="author.html#16392">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
