<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] performance with thousands of auto_delete	queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20performance%20with%20thousands%20of%20auto_delete%0A%09queues&In-Reply-To=%3CF39C2631-9F27-45DC-98C6-B31049B56F9C%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016331.html">
   <LINK REL="Next"  HREF="016334.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] performance with thousands of auto_delete	queues</H1>
    <B>Ask Solem</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20performance%20with%20thousands%20of%20auto_delete%0A%09queues&In-Reply-To=%3CF39C2631-9F27-45DC-98C6-B31049B56F9C%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] performance with thousands of auto_delete	queues">ask at rabbitmq.com
       </A><BR>
    <I>Thu Nov 17 13:35:59 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016331.html">[rabbitmq-discuss] performance with thousands of auto_delete	queues
</A></li>
        <LI>Next message: <A HREF="016334.html">[rabbitmq-discuss] performance with thousands of auto_delete queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16332">[ date ]</a>
              <a href="thread.html#16332">[ thread ]</a>
              <a href="subject.html#16332">[ subject ]</a>
              <a href="author.html#16332">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 17 Nov 2011, at 12:29, Muharem Hrnjadovic wrote:

&gt;<i> Hello there!
</I>&gt;<i> 
</I>&gt;<i> We are using rabbitmq rev. 2.3.1 with python-celery for large-scale
</I>&gt;<i> seismic calculations. Celery seems to create an auto_delete queue for
</I>&gt;<i> each task and I am observing a severe performance degradation once
</I>&gt;<i> approx. 15,000 queues have been created (this a tenth of the overall
</I>&gt;<i> calculation).
</I>&gt;<i> 
</I>&gt;<i> Most of these queues have served their purpose, however, and can be
</I>&gt;<i> &quot;garbage collected&quot;. Is there a way to request that auto_delete queues
</I>&gt;<i> be actually removed?
</I>

The queues you are seeing are the task's progress and results.
If you don't need them you should disable them.  You can do so
by upgrading to the latest version (where results are disabled
by default), or setting @task(ignore_result=True) for individual
tasks, or CELERY_IGNORE_RESULT=True globally.


An auto_delete queue is only deleted when it's empty,
so you have to collect the results.  Another option is to enable
expiration:
   CELERY_AMQP_TASK_RESULT_EXPIRES = 300
This can either be an unsigned integer, or a datetime.timedelta
object describing the number of seconds to pass before the queue
is expired (deleted) when unused. Expiration is also enabled by default
in the latest version, but the expire time is set to 1 day, which may be
too infrequent for your use.
</PRE>




































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016331.html">[rabbitmq-discuss] performance with thousands of auto_delete	queues
</A></li>
	<LI>Next message: <A HREF="016334.html">[rabbitmq-discuss] performance with thousands of auto_delete queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16332">[ date ]</a>
              <a href="thread.html#16332">[ thread ]</a>
              <a href="subject.html#16332">[ subject ]</a>
              <a href="author.html#16332">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
