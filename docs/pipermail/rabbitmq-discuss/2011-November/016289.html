<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumer connection closes abruptly after	one message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20connection%20closes%20abruptly%20after%0A%09one%20message&In-Reply-To=%3CCAE3HoVTCpe%3DdsKvdqDgM5StSr_GLa3xzvmMqRdryq6m7Lc8buQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016287.html">
   <LINK REL="Next"  HREF="016295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumer connection closes abruptly after	one message</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20connection%20closes%20abruptly%20after%0A%09one%20message&In-Reply-To=%3CCAE3HoVTCpe%3DdsKvdqDgM5StSr_GLa3xzvmMqRdryq6m7Lc8buQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Consumer connection closes abruptly after	one message">michael.s.klishin at gmail.com
       </A><BR>
    <I>Wed Nov 16 15:52:54 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016287.html">[rabbitmq-discuss] Consumer connection closes abruptly after	one message
</A></li>
        <LI>Next message: <A HREF="016295.html">[rabbitmq-discuss] Consumer connection closes abruptly after	one message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16289">[ date ]</a>
              <a href="thread.html#16289">[ thread ]</a>
              <a href="subject.html#16289">[ subject ]</a>
              <a href="author.html#16289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2011/11/16 p2w &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tpletch001 at gmail.com</A>&gt;

&gt;<i> I'm sure I'm doing something wrong in the initializer but can't figure
</I>&gt;<i> out what as its really pretty vanilla. Any help greatly appreciated...
</I>&gt;<i>
</I>
I apologize for not noticing that you are using Thin. One thing that may
cause abrupt TCP connection termination is uncaught exception on the
EventMachine
thread (in this case, your applications' main thread). In some cases it may
be swallowed by
various &quot;helpful&quot; libraries. Can you try removing more and more
code from your consumer handlers to see at what point connection becomes
stable?

Also, with at least a couple of most recent point amqp gem releases you can
simplify your initializer
a little bit by renaming config file to amqp.yml and using
AMQP::Integration::Rails:

<A HREF="https://gist.github.com/3d995824090df94558b0">https://gist.github.com/3d995824090df94558b0</A>

Sorry that it is undocumented yet.
-- 
MK

<A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
<A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111116/16aa403b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111116/16aa403b/attachment.htm</A>&gt;
</PRE>





































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016287.html">[rabbitmq-discuss] Consumer connection closes abruptly after	one message
</A></li>
	<LI>Next message: <A HREF="016295.html">[rabbitmq-discuss] Consumer connection closes abruptly after	one message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16289">[ date ]</a>
              <a href="thread.html#16289">[ thread ]</a>
              <a href="subject.html#16289">[ subject ]</a>
              <a href="author.html#16289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
