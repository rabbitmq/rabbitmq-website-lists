<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] active/active message persistence problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20active/active%20message%20persistence%20problem&In-Reply-To=%3CBLU149-W23E6119B58C2C429854031ABC80%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016431.html">
   <LINK REL="Next"  HREF="016440.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] active/active message persistence problem</H1>
    <B>Jeffrey Chen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20active/active%20message%20persistence%20problem&In-Reply-To=%3CBLU149-W23E6119B58C2C429854031ABC80%40phx.gbl%3E"
       TITLE="[rabbitmq-discuss] active/active message persistence problem">cpthk at hotmail.com
       </A><BR>
    <I>Tue Nov 22 01:14:51 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="016431.html">[rabbitmq-discuss] Rebilling Customers
</A></li>
        <LI>Next message: <A HREF="016440.html">[rabbitmq-discuss] active/active message persistence problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16436">[ date ]</a>
              <a href="thread.html#16436">[ thread ]</a>
              <a href="subject.html#16436">[ subject ]</a>
              <a href="author.html#16436">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi RabbitMQ community:

I am encounter this problem about message persistence. Here is my case, I have 2 server nodes with active/active setup, both are persisted to DISK. The queue declarations are defined as durable.
This is what I got when doing:

# rabbitmqctl cluster_status
Cluster status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at aaron-vm177</A>' ...
[{nodes,[{disc,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at vm1</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at vm2</A>']}]},
 {running_nodes,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at vm1</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at vm2</A>']}]
...done.

# rabbitmqctl list_queues
Listing queues ...
test    10
...done.


My vm1 is currently master node. When I stop RabbitMQ service in vm1, and start it back up. I check my messages in the queue, the messages are still there. This time when I stop RabbitMQ service in vm2. The messages will be gone. It seems like when I restart both server nodes, the data will be lost. Does anyone know the reason? Is there any way to work around this?

My goal is that any server nodes down, and when I bring it back up, no data will be lost.

Jeffrey.
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111121/1a3ee86a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111121/1a3ee86a/attachment.htm</A>&gt;
</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016431.html">[rabbitmq-discuss] Rebilling Customers
</A></li>
	<LI>Next message: <A HREF="016440.html">[rabbitmq-discuss] active/active message persistence problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16436">[ date ]</a>
              <a href="thread.html#16436">[ thread ]</a>
              <a href="subject.html#16436">[ subject ]</a>
              <a href="author.html#16436">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
