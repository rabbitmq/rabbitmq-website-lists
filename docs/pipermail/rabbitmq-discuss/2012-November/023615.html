<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Almost all statistics drop to 0 every hour
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Almost%20all%20statistics%20drop%20to%200%20every%20hour&In-Reply-To=%3CCAAcXTOaMuXYLBxGp7BtV1W91AYXmSdvj7TeP0At50%3Dwn2_DhAg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023673.html">
   <LINK REL="Next"  HREF="023619.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Almost all statistics drop to 0 every hour</H1>
    <B>Irmo Manie</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Almost%20all%20statistics%20drop%20to%200%20every%20hour&In-Reply-To=%3CCAAcXTOaMuXYLBxGp7BtV1W91AYXmSdvj7TeP0At50%3Dwn2_DhAg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Almost all statistics drop to 0 every hour">irmo.manie at gmail.com
       </A><BR>
    <I>Tue Nov  6 08:48:46 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023673.html">[rabbitmq-discuss] Memory leak with file_io_server, server_loop?
</A></li>
        <LI>Next message: <A HREF="023619.html">[rabbitmq-discuss] Almost all statistics drop to 0 every hour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23615">[ date ]</a>
              <a href="thread.html#23615">[ thread ]</a>
              <a href="subject.html#23615">[ subject ]</a>
              <a href="author.html#23615">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

(Running rabbit 2.8.0)

We're experiencing weird behavior from the statistics/management module.
Every x seconds, we take a snapshot of the statistics and send this to a
Graphite server, giving us the following data:

[image: Inline image 2]

As you can see, the delivery (no-ack) rate drops to 0 every hour for a
couple of minutes. Other statistics on message processing indicate that
actual delivery/consuming is continuing, so it looks like it's really only
the statistics that are wrong.

If I look at the json output during such a 'downtime' I can see that the
publish rate is always available, but the rest of the rates (acknowledge,
delivery, etc) are mostly 0.
I understand a bit from the sources that in this /api/overview call from
the management api, these statistics are gathered from different places,
both memory and database (with additional calculations executed on them
while fetching), correct?
Could it be that some of these values are 0 because of certain time-outs
while getting the data? In other words: do I have to start searching for
the problem at the database disk/IO level?

I couldn't see any IO waits on the machine indicating something else is
happening at the time. Also CPU load is normal.
Still the weird thing is that this also happens on a test machine at
roughly the same times.
Since both machines are VM's, this might indicate that it could be an
infrastructural problem, but I'd like to be sure before accusing 'others'.

Thanks for the analysis help.

- Irmo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121106/da67b57e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121106/da67b57e/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 181196 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121106/da67b57e/attachment.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121106/da67b57e/attachment.png</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023673.html">[rabbitmq-discuss] Memory leak with file_io_server, server_loop?
</A></li>
	<LI>Next message: <A HREF="023619.html">[rabbitmq-discuss] Almost all statistics drop to 0 every hour
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23615">[ date ]</a>
              <a href="thread.html#23615">[ thread ]</a>
              <a href="subject.html#23615">[ subject ]</a>
              <a href="author.html#23615">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
