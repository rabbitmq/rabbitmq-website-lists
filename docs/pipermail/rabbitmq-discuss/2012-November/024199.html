<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] The rabbitmq-server stop command hangs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20The%20rabbitmq-server%20stop%20command%20hangs&In-Reply-To=%3CE94F626F5C43D14F8B8479C5EBD79038A85EC687%40vmexchange02.seegrid.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024182.html">
   <LINK REL="Next"  HREF="024201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] The rabbitmq-server stop command hangs</H1>
    <B>Elizabeth Liao</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20The%20rabbitmq-server%20stop%20command%20hangs&In-Reply-To=%3CE94F626F5C43D14F8B8479C5EBD79038A85EC687%40vmexchange02.seegrid.local%3E"
       TITLE="[rabbitmq-discuss] The rabbitmq-server stop command hangs">eliao at seegrid.com
       </A><BR>
    <I>Wed Nov 28 19:45:12 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024182.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
        <LI>Next message: <A HREF="024201.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24199">[ date ]</a>
              <a href="thread.html#24199">[ thread ]</a>
              <a href="subject.html#24199">[ subject ]</a>
              <a href="author.html#24199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've attached the rabbitmq.config, rabbit.log, rabbit-sasl.log of the node that we're running.

&gt;<i> Are you clustered (I'm assuming yes) and have you got some mirrored queues set up (also assuming yes)?
</I>We don't have clustering set up so no mirrored queues either.

&gt;<i> And can you get the shovel status (&quot;rabbitmqctl eval
</I>'rabbit_shovel_status:status().'&quot;) at the time the shutdown is hanging?

# rabbitmqctl eval 'rabbit_shovel_status:status().'
[{shovelB_realtime,starting,{{2012,11,28},{14,9,20}}},
 {shovelB,starting,{{2012,11,28},{14,9,20}}},
 {shovelA,
     {running,
         {source,
             {amqp_params_direct,&lt;&lt;&quot;guest&quot;&gt;&gt;,none,&lt;&lt;&quot;/&quot;&gt;&gt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at TEST2</A>,
                 none,[]}},
         {destination,
             {amqp_params_network,&lt;&lt;&quot;user1&quot;&gt;&gt;,&lt;&lt;&quot;pass1&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,
                 &quot;server.local&quot;,undefined,0,0,5,infinity,none,
                 [#Fun&lt;amqp_uri.7.123484526&gt;,#Fun&lt;amqp_uri.7.123484526&gt;],
                 [],[]}}},
     {{2012,11,28},{14,9,25}}}]
...done.

________________________________________
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] on behalf of Tim Watson [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>]
Sent: Wednesday, November 28, 2012 6:54 AM
To: Matthias Radestock
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] The rabbitmq-server stop command hangs

On 28 Nov 2012, at 11:42, Matthias Radestock wrote:

&gt;<i> On 28/11/12 11:29, Tim Watson wrote:
</I>&gt;&gt;<i> Can you please confirm a couple of things for us: what plugins are
</I>&gt;&gt;<i> enabled in your setup?
</I>&gt;<i>
</I>&gt;<i> See Liz' earlier post:
</I>&gt;<i> &lt;quote&gt;
</I>&gt;<i> # rabbitmqctl eval 'app_utils:app_dependency_order([os_mon,
</I>&gt;<i> mnesia,rabbit] ++ rabbit_plugins:active(),true).'
</I>&gt;<i> [mnesia,mochiweb,amqp_client,webmachine,rabbitmq_mochiweb,os_mon,rabbit,
</I>&gt;<i> rabbitmq_management_agent,rabbitmq_shovel,rabbitmq_management]
</I>&gt;<i> &lt;/quote&gt;
</I>&gt;<i>
</I>&gt;<i> I asked for this since it wasn't obvious to me
</I>&gt;<i> that the shutdown was hanging in the rabbit application.
</I>&gt;<i>
</I>&gt;<i> If it isn't rabbit, then a prime candidate from the above list would be shovel.
</I>&gt;<i>
</I>
Sounds quite likely.

&gt;<i> rabbit_net:recv is the normal place for the reader to sit when nothing
</I>&gt;<i> is happening. It has a catch-all 'Other' clause.
</I>&gt;<i>
</I>
Right, so tcp events will come back that way too, got it.

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
Email Confidentiality Notice

The information contained in this transmission is confidential, proprietary or privileged and may be subject to protection under the law. This message is intended for the sole use of the individual or entity to whom it's addressed. If you are not the intended recipient, you are notified that any use, distribution or copying of the message is strictly prohibited and may subject you to criminal or civil penalties. If you received this transmission in error, please contact the sender immediately by replying to this email and delete the material from any computer.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rabbitHangingLogConfig.tgz
Type: application/x-compressed-tar
Size: 4944 bytes
Desc: rabbitHangingLogConfig.tgz
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121128/92594663/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121128/92594663/attachment.bin</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024182.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
	<LI>Next message: <A HREF="024201.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24199">[ date ]</a>
              <a href="thread.html#24199">[ thread ]</a>
              <a href="subject.html#24199">[ subject ]</a>
              <a href="author.html#24199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
