<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] unable to connect to node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20unable%20to%20connect%20to%20node&In-Reply-To=%3CCAKH7ZWwkiOFq2Uxk5dj5PUCRPNJ7a_tDqq5wFEQVTX_cGbYuxw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024200.html">
   <LINK REL="Next"  HREF="024214.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] unable to connect to node</H1>
    <B>John Cartwright - NOAA Federal</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20unable%20to%20connect%20to%20node&In-Reply-To=%3CCAKH7ZWwkiOFq2Uxk5dj5PUCRPNJ7a_tDqq5wFEQVTX_cGbYuxw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] unable to connect to node">john.c.cartwright at noaa.gov
       </A><BR>
    <I>Thu Nov 29 04:21:31 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024200.html">[rabbitmq-discuss] unable to connect to node
</A></li>
        <LI>Next message: <A HREF="024214.html">[rabbitmq-discuss] unable to connect to node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24206">[ date ]</a>
              <a href="thread.html#24206">[ thread ]</a>
              <a href="subject.html#24206">[ subject ]</a>
              <a href="author.html#24206">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks again Tim, I appreciate your interest.

the /var/run/rabbitmq problem is easy to reproduce:

1) mkdir /var/run/rabbitmq
2) start the server
3) stop the server
4) directory is gone

As for the plugins file, I'll go through and double-check my
installation steps.  I'd misunderstood from
<A HREF="http://www.rabbitmq.com/install-generic-unix.html">http://www.rabbitmq.com/install-generic-unix.html</A> that I was supposed
to use SYS_PREFIX to modify data directories.

--john


On Wed, Nov 28, 2012 at 3:35 PM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
&gt;<i> Hi John,
</I>&gt;<i>
</I>&gt;<i> On 28 Nov 2012, at 18:42, John Cartwright - NOAA Federal wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Thanks Tim.  There seem to be a couple of problems re: the RPM
</I>&gt;&gt;<i> install, but the &quot;unable to connect to node&quot; appears to be related to
</I>&gt;&gt;<i> relocating the SYS_PREFIX outside the install directory.  In other
</I>&gt;&gt;<i> words:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) I stopped the server started by the init.d script and killed the
</I>&gt;&gt;<i> epmd process manually to get a clean start
</I>&gt;&gt;<i> 2) install the rabbitmq-server-generic-unix-3.0.0.tar.gz, modifying
</I>&gt;&gt;<i> rabbitmq-defaults to set SYS_PREFIX to a directory other than the
</I>&gt;&gt;<i> install directory.
</I>&gt;&gt;<i> 3) started the server
</I>&gt;&gt;<i> 4) same problem with the status reporting &quot;unable to connect to node&quot;.
</I>&gt;&gt;<i> Also found that I was unable to install a plugin getting the error:
</I>&gt;&gt;<i>           Error: {cannot_read_enabled_plugins_file,
</I>&gt;&gt;<i>           &quot;/data/rabbitmq/etc/rabbitmq/enabled_plugins&quot;,eisdir}
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well that's very odd. This posix error seems to indicate that the location that RABBITMQ_ENABLED_PLUGINS_FILE is pointing to is in fact a directory. Does that mean anything to you?
</I>&gt;<i>
</I>&gt;&gt;<i> 5) stopped the server with &quot;rabbitmqctl stop&quot;
</I>&gt;&gt;<i> 6) unset the custom SYS_PREFIX in rabbitmq-defaults and restarted the server
</I>&gt;&gt;<i> 7) started the server and not status reports normally
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The init.d script packaged in the RPM is removing the
</I>&gt;&gt;<i> /var/run/rabbitmq directory on stopping and not re-creating it on
</I>&gt;&gt;<i> startup, but that's a different issue...
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hmn, that doesn't sound right. We'll take a look at that. Can you explain how you came across this behaviour, i.e., how it became apparent so that we can try to reproduce it?
</I>&gt;<i>
</I>&gt;&gt;<i> So, do you know of any reason why relocating the data (log, mnesia,
</I>&gt;&gt;<i> enabled_plugins) should be any different that simply changing the
</I>&gt;&gt;<i> SYS_PREFIX in rabbitmq-defaults?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You should 'relocate' things by following the instructions in <A HREF="http://www.rabbitmq.com/relocate.html">http://www.rabbitmq.com/relocate.html</A> rather than by changing SYS_PREFIX, which is an undocumented variable and therefore subject to change and could lead to undefined behaviour if altered. Although I'm not looking at the startup script right this second, iirc this variable is just used as a base so it *seems* like changing it should 'just work' (tm) but as it's not documented I'd recommend not doing that. You can set RABBITMQ_BASE instead, though the effect this will have depends on how you're installing. Again please see <A HREF="http://www.rabbitmq.com/relocate.html">http://www.rabbitmq.com/relocate.html</A> for all the gory details.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Tim
</I>&gt;<i>
</I>&gt;&gt;<i> --john
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Nov 28, 2012 at 11:21 AM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> I seem to remember having problems when using the init.d script directly rather than `/sbin/service rabbitmq-server start` although that may have been to do with the account from which I ran it the first time. Anyway, are you sure that the rabbitmq-server process is running? You should see an instance of 'beam.smp' when running `ps` if it is, or alternatively you can run `epmd -names` as any user to see which erlang nodes are up and running.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Cheers,
</I>&gt;&gt;&gt;<i> Tim
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 28 Nov 2012, at 16:55, John Cartwright - NOAA Federal wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Hello All,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I've installed the RPM ( from
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://www.rabbitmq.com/install-rpm.html">http://www.rabbitmq.com/install-rpm.html</A>) on a RHEL6 server and used
</I>&gt;&gt;&gt;&gt;<i> the init.d script &quot;rabbitmq-server&quot; to start the server.  However,
</I>&gt;&gt;&gt;&gt;<i> when I  run &quot;rabbitmqctl status&quot;, I get the following suggesting
</I>&gt;&gt;&gt;&gt;<i> there's a problem:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq at squall</A> rabbitmq]$ ./bin/rabbitmqctl status
</I>&gt;&gt;&gt;&gt;<i> Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at squall</A> ...
</I>&gt;&gt;&gt;&gt;<i> Error: unable to connect to node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at squall</A>: nodedown
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> DIAGNOSTICS
</I>&gt;&gt;&gt;&gt;<i> ===========
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> nodes in question: [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at squall</A>]
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> hosts, their running nodes and ports:
</I>&gt;&gt;&gt;&gt;<i> - squall: [{rabbitmqctl23373,52427}]
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> current node details:
</I>&gt;&gt;&gt;&gt;<i> - node name: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmqctl23373 at squall</A>
</I>&gt;&gt;&gt;&gt;<i> - home dir: /home/rabbitmq
</I>&gt;&gt;&gt;&gt;<i> - cookie hash: 0W8f6ODD6SgYDvLAojR/Zw==
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I've confirmed there's a .erlang.cookie in the home directory of the
</I>&gt;&gt;&gt;&gt;<i> process owner.  Can someone please help me understand what the problem
</I>&gt;&gt;&gt;&gt;<i> might be?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Thanks!
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> --john
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024200.html">[rabbitmq-discuss] unable to connect to node
</A></li>
	<LI>Next message: <A HREF="024214.html">[rabbitmq-discuss] unable to connect to node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24206">[ date ]</a>
              <a href="thread.html#24206">[ thread ]</a>
              <a href="subject.html#24206">[ subject ]</a>
              <a href="author.html#24206">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
