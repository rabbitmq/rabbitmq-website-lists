<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pub/Sub%20--%20block%20publisher%20until%20all%20acks%0A%20received%20from%20subscribers%3F&In-Reply-To=%3C509B911E.5030304%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023629.html">
   <LINK REL="Next"  HREF="023550.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pub/Sub%20--%20block%20publisher%20until%20all%20acks%0A%20received%20from%20subscribers%3F&In-Reply-To=%3C509B911E.5030304%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?">emile at rabbitmq.com
       </A><BR>
    <I>Thu Nov  8 11:01:50 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023629.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
</A></li>
        <LI>Next message: <A HREF="023550.html">[rabbitmq-discuss] RabbitMQ hangs, does not accept connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23678">[ date ]</a>
              <a href="thread.html#23678">[ thread ]</a>
              <a href="subject.html#23678">[ subject ]</a>
              <a href="author.html#23678">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On 06/11/12 19:17, Nick Martin wrote:
&gt;<i> Perhaps my wording wasn't clear. I do not want to lose the tasks that
</I>&gt;<i> are in the queue. I wish to pause work, not simply throw away work. One
</I>&gt;<i> way to achieve a pause effect is to empty the queue. This leads to the
</I>&gt;<i> problem of what to do with the remaining tasks that had been in the
</I>&gt;<i> queue. These still need to be stored somewhere and they need to be
</I>&gt;<i> stored reliably so that when we resume work we can re-queue them and
</I>&gt;<i> they can be handled by the workers.
</I>
By &quot;draining the queue&quot; I meant stop publishing any new work and wait 
until the last published work item has been completed. Then the work 
queue is empty and you can perform maintenance actions.

The problem becomes more difficult if you want in-progess work to be 
interrupted or if you can't wait for the work queue to drain. The best 
approach will depend on the specific features and requirements of your 
system.

The publisher could passively redeclare the work queue to obtain the 
number of active consumers and use this to wait for the same number of 
acknowledgements to a &quot;pause&quot; message sent to a dedicated control queue 
that all workers monitor. The publisher could also retain all work 
messages that are in flights to be able to resend them after &quot;resume&quot;. 
It is a difficult problem and there is no one best answer.


-Emile





</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023629.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
</A></li>
	<LI>Next message: <A HREF="023550.html">[rabbitmq-discuss] RabbitMQ hangs, does not accept connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23678">[ date ]</a>
              <a href="thread.html#23678">[ thread ]</a>
              <a href="subject.html#23678">[ subject ]</a>
              <a href="author.html#23678">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
