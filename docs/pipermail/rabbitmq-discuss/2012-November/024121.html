<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Publishing: Connection timeout issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publishing%3A%20Connection%20timeout%20issue&In-Reply-To=%3C9bbd3954-7428-44ef-aa61-c1ed220af273%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024184.html">
   <LINK REL="Next"  HREF="024122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Publishing: Connection timeout issue</H1>
    <B>Borman Squirrel</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publishing%3A%20Connection%20timeout%20issue&In-Reply-To=%3C9bbd3954-7428-44ef-aa61-c1ed220af273%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Publishing: Connection timeout issue">triton.genocide at gmail.com
       </A><BR>
    <I>Sat Nov 24 21:35:42 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024184.html">[rabbitmq-discuss] Management Plugin
</A></li>
        <LI>Next message: <A HREF="024122.html">[rabbitmq-discuss] Publishing: Connection timeout issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24121">[ date ]</a>
              <a href="thread.html#24121">[ thread ]</a>
              <a href="subject.html#24121">[ subject ]</a>
              <a href="author.html#24121">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everybody, carrot eaters! :)

I am using rabbitmq-c driver.

Sometimes when I try to publish a message (using basic publish method) from 
a thread that is acting like worker for sending messages, I am geting an 
error due to connection time out. 

When I try to close channel and connection to restablishing connection, I 
get broken pipe exception and consecuently I can not close the connection. 
After that, the worker enters in a new loop iteration and create a new 
socket, a new channel, a new connection ... It seems that the server, due 
to exists two connections, does not send the messages to clients through 
the right connection and the messages never reaches the clients.

This is the pseudocode :

worker_sender()
{
    while(1)
    {
         opening_socket
         logging_in
         opening_channel

         while(1)
         {
              if(error(basic_publish()) //here connection timeout error
                  break;
         }

         closing_channel //here broken pipe exception
         closing_connection //here broken pipe exception
         destroy_connection
    }
    
    return
}

It would be possible to solve this issue with other approach or some 
adjustment to the showed solution?

Thanks in advance!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121124/a1028c6a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121124/a1028c6a/attachment.htm</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024184.html">[rabbitmq-discuss] Management Plugin
</A></li>
	<LI>Next message: <A HREF="024122.html">[rabbitmq-discuss] Publishing: Connection timeout issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24121">[ date ]</a>
              <a href="thread.html#24121">[ thread ]</a>
              <a href="subject.html#24121">[ subject ]</a>
              <a href="author.html#24121">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
