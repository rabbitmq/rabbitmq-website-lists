<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Upgrading%20erlang%2C%20rabbitmq%20in%20a%20cluster.&In-Reply-To=%3CCACLE7iym%3D6GDipNjAUH44E16kh3%2BHAit-F0hEya1iNsoOBPvtQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023783.html">
   <LINK REL="Next"  HREF="023794.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Upgrading%20erlang%2C%20rabbitmq%20in%20a%20cluster.&In-Reply-To=%3CCACLE7iym%3D6GDipNjAUH44E16kh3%2BHAit-F0hEya1iNsoOBPvtQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.">mpietrek at skytap.com
       </A><BR>
    <I>Mon Nov 12 18:17:14 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023783.html">[rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.
</A></li>
        <LI>Next message: <A HREF="023794.html">[rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23793">[ date ]</a>
              <a href="thread.html#23793">[ thread ]</a>
              <a href="subject.html#23793">[ subject ]</a>
              <a href="author.html#23793">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>For what it's worth, we have a system here that allows us to upgrade
clusters without downtime. It works for us, but may or may not be workable
for other teams.

Short synopsis is that our cluster is behind a VIP. When we want to upgrade
a cluster, we spin up an alternate cluster and switch the VIP over to the
alternate cluster. Meanwhile, we have tooling that moves messages between
clusters. When the 'master' cluster's update is done, we reverse the
process.

This does require that your clients be tolerant to dropped connections.
There's a lot of details not covered in the above description but it gives
the basic gist of it.


On Mon, Nov 12, 2012 at 5:46 AM, Jean Paul Galea &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ninuhadida at gmail.com</A>&gt;wrote:

&gt;<i> On 11/12/2012 01:38 PM, Emile Joubert wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 12/11/12 11:32, Jean Paul Galea wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The question is, how do we keep these two nodes up to date with the
</I>&gt;&gt;&gt;<i> latest versions, without suffering downtime?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Details on how to upgrade a cluster are relevant in your case:
</I>&gt;&gt;<i> <A HREF="http://www.rabbitmq.com/**clustering.html#upgrading&lt;http://www.rabbitmq.com/clustering.html#upgrading">http://www.rabbitmq.com/**clustering.html#upgrading&lt;http://www.rabbitmq.com/clustering.html#upgrading</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It is not possible to upgrade a cluster without downtime, since all
</I>&gt;&gt;<i> nodes need to run the same version of RabbitMQ. All the nodes in the
</I>&gt;&gt;<i> cluster have to be shut down during upgrade, implying downtime.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The interruptions can be as short as a server reboot. The impact of the
</I>&gt;&gt;<i> broker downtime can also be minimised by having publishers and consumers
</I>&gt;&gt;<i> automatically retry failed connections to the broker. Persistent
</I>&gt;&gt;<i> messages that exist in queues are preserved when the broker is upgraded,
</I>&gt;&gt;<i> so messages won't be lost due to upgrades.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Emile
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> OK, thanks for clarifying!
</I>&gt;<i>
</I>&gt;<i> ______________________________**_________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.</A>**rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121112/ed3d43d6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121112/ed3d43d6/attachment.htm</A>&gt;
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023783.html">[rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.
</A></li>
	<LI>Next message: <A HREF="023794.html">[rabbitmq-discuss] Upgrading erlang, rabbitmq in a cluster.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23793">[ date ]</a>
              <a href="thread.html#23793">[ thread ]</a>
              <a href="subject.html#23793">[ subject ]</a>
              <a href="author.html#23793">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
