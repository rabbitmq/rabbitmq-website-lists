<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pub/Sub%20--%20block%20publisher%20until%20all%20acks%0A%20received%20from%20subscribers%3F&In-Reply-To=%3CCAFedJMiUCYoihYgjTcRHtY%2B3GEtkG-f%2BygXVFdLZhBmoXEN81g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023575.html">
   <LINK REL="Next"  HREF="023618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?</H1>
    <B>Nick Martin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pub/Sub%20--%20block%20publisher%20until%20all%20acks%0A%20received%20from%20subscribers%3F&In-Reply-To=%3CCAFedJMiUCYoihYgjTcRHtY%2B3GEtkG-f%2BygXVFdLZhBmoXEN81g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?">nick at faceture.com
       </A><BR>
    <I>Mon Nov  5 18:59:44 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023575.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
</A></li>
        <LI>Next message: <A HREF="023618.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23597">[ date ]</a>
              <a href="thread.html#23597">[ thread ]</a>
              <a href="subject.html#23597">[ subject ]</a>
              <a href="author.html#23597">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Emile,
Yes, you understand my situation correctly.

I thought about a solution to eliminate the need for pause messages at all
-- and draining the queue is the same conclusion I came to also. This would
in effect act as a way to pause the workers. This solution presents its own
issue though. Because I want to just temporarily pause, not actually throw
away the work, how do I reliably store the contents of the queue once it
has been drained?

Perhaps something like moving the messages from the original queue to a
different, backup queue and not acking the messages from the first queue
until the backup is in place? That would seem to reliably store the
contents. Then I could do the opposite to restore the original queue. I
could also store them somewhere else, like a database. I am concerned that
this approach leads to its own set of thorny problems and corner cases
though. I suspect I am missing some potentially devastating corner case.

I don't really want to become a messaging expert; I was hoping someone else
may have already implemented something that I could just use.

What do you think? Is there something out there that could help me.

Nick



On Sun, Nov 4, 2012 at 3:02 PM, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i> Hi Nick,
</I>&gt;<i>
</I>&gt;<i> On 01/11/12 15:50, Nick Martin wrote:
</I>&gt;<i> &gt; &gt; Can the same aim be achieved in another way by taking a larger view
</I>&gt;<i> &gt; &gt; of the system?
</I>&gt;<i> &gt; I'm not sure. Do you have any suggestions?
</I>&gt;<i>
</I>&gt;<i> If I understand correctly you want a way of communicating start/stop
</I>&gt;<i> control messages to all workers throughout the system.
</I>&gt;<i>
</I>&gt;<i> You could employ an elaborate RPC scheme to accomplish this, but it
</I>&gt;<i> would be simpler to let the work queue drain instead of sending a stop
</I>&gt;<i> message, assuming you are using a single worker queue. If necessary you
</I>&gt;<i> could delete the work queue and have the workers take special action
</I>&gt;<i> upon receipt of the basic.cancel message that will be sent.
</I>&gt;<i>
</I>&gt;<i> To start work you could have the publisher re-instate the work queue and
</I>&gt;<i> instruct workers to periodically attempt resubscribing to the work queue.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121105/7ee43b79/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121105/7ee43b79/attachment.htm</A>&gt;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023575.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
</A></li>
	<LI>Next message: <A HREF="023618.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks received from subscribers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23597">[ date ]</a>
              <a href="thread.html#23597">[ thread ]</a>
              <a href="subject.html#23597">[ subject ]</a>
              <a href="author.html#23597">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
