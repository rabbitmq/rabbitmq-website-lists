<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] ** Too many db tables **
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%2A%2A%20Too%20many%20db%20tables%20%2A%2A&In-Reply-To=%3CCAO4q6_8ZFQcgXgU1FMe3Zo62V9vYfkyfd__XhcZFeaSjkwFs-Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024223.html">
   <LINK REL="Next"  HREF="024208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] ** Too many db tables **</H1>
    <B>Farshad Meshkinpour</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%2A%2A%20Too%20many%20db%20tables%20%2A%2A&In-Reply-To=%3CCAO4q6_8ZFQcgXgU1FMe3Zo62V9vYfkyfd__XhcZFeaSjkwFs-Q%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] ** Too many db tables **">fmeshkinpour at fonality.com
       </A><BR>
    <I>Thu Nov 29 01:43:41 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024223.html">[rabbitmq-discuss] Negative policy for HA queue name matching
</A></li>
        <LI>Next message: <A HREF="024208.html">[rabbitmq-discuss] ** Too many db tables **
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24205">[ date ]</a>
              <a href="thread.html#24205">[ thread ]</a>
              <a href="subject.html#24205">[ subject ]</a>
              <a href="author.html#24205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I get the following error when one of the nodes in the cluster lost its
connectivity (RabbitMQ *2.8.6* on Erlang *R14B04)*.  After that the cluster
became useless until we restarted all nodes in the cluster.  Few questions:

1. Do we need to increase the ETS table limit from 1400?  we have several
thousands mirrored queues and several hundreds of consumer/producers.
2. How does rabbit uses ETS table (e.g. one per queue, one per connection)?
3. Is there a command to show how many ETS tables are in use?
4. What is the current timeout for detecting other nodes in the cluster and
can it be increased?

Thanks,
Farshad


=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rmq2</A> not responding **
** Removing (timedout) connection **

=INFO REPORT==== 16-Nov-2012::17:31:42 ===
rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rmq2</A> down

=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Too many db tables **


=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Too many db tables **


=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Too many db tables **


=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Too many db tables **

=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Generic server &lt;0.786.0&gt; terminating
** Last message in was {'DOWN',#Ref&lt;0.0.0.68136&gt;,process,&lt;7526.761.0&gt;,
                               noconnection}
** When Server state == {state,
                            {7,&lt;0.786.0&gt;},
                            {{80,&lt;7525.8408.0&gt;},#Ref&lt;0.0.0.54136&gt;},
                            {{10,&lt;7526.761.0&gt;},#Ref&lt;0.0.0.68136&gt;},
                            {resource,&lt;&lt;&quot;/fonsyncd/prod/&quot;&gt;&gt;,queue,
                                &lt;&lt;&quot;Q-SID.16499.fonsyncd&quot;&gt;&gt;},
                            rabbit_mirror_queue_slave,
                            {11,
                             [{{7,&lt;0.786.0&gt;},
                               {view_member,
                                   {7,&lt;0.786.0&gt;},
                                   [],
                                   {80,&lt;7525.8408.0&gt;},
                                   {10,&lt;7526.761.0&gt;}}},
                              {{10,&lt;7526.761.0&gt;},
                               {view_member,
                                   {10,&lt;7526.761.0&gt;},
                                   [],
                                   {7,&lt;0.786.0&gt;},
                                   {80,&lt;7525.8408.0&gt;}}},
                              {{80,&lt;7525.8408.0&gt;},
                               {view_member,
                                   {80,&lt;7525.8408.0&gt;},
                                   [],
                                   {10,&lt;7526.761.0&gt;},
                                   {7,&lt;0.786.0&gt;}}}]},
                            0,
                            [{{7,&lt;0.786.0&gt;},{member,{[],[]},0,0}},
                             {{10,&lt;7526.761.0&gt;},{member,{[],[]},0,0}},
                             {{80,&lt;7525.8408.0&gt;},
                              {member,{[],[]},59944,59944}}],
                            [&lt;0.784.0&gt;],
                            {[],[]},
                            [],undefined}

** Reason for termination ==
** {{badmatch,
        {aborted,
            {system_limit,
                &quot;Cannot create an ets table for the local transaction
store&quot;,
                {system_limit,
                    [{ets,new,[mnesia_trans_store,[bag,public]]},
                     {mnesia_tm,doit_loop,1},
                     {mnesia_sp,init_proc,4},
                     {proc_lib,init_p_do_apply,3}]}}}},
    [{gm,record_dead_member_in_group,2},
     {gm,handle_info,2},
     {gen_server2,handle_msg,2},
     {proc_lib,wake_up,3}]}

=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Too many db tables **


=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Too many db tables **


=ERROR REPORT==== 16-Nov-2012::17:31:42 ===
** Generic server &lt;0.4528.0&gt; terminating
** Last message in was {'DOWN',#Ref&lt;0.0.0.78137&gt;,process,&lt;7526.4380.0&gt;,
                               noconnection}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121128/7147f30b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121128/7147f30b/attachment.htm</A>&gt;
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024223.html">[rabbitmq-discuss] Negative policy for HA queue name matching
</A></li>
	<LI>Next message: <A HREF="024208.html">[rabbitmq-discuss] ** Too many db tables **
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24205">[ date ]</a>
              <a href="thread.html#24205">[ thread ]</a>
              <a href="subject.html#24205">[ subject ]</a>
              <a href="author.html#24205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
