<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%203.0%20Policy%20ha-all%20delete%20issue&In-Reply-To=%3C50AD0534.5050503%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024045.html">
   <LINK REL="Next"  HREF="024006.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%203.0%20Policy%20ha-all%20delete%20issue&In-Reply-To=%3C50AD0534.5050503%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue">matthias at rabbitmq.com
       </A><BR>
    <I>Wed Nov 21 16:45:40 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024045.html">[rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue
</A></li>
        <LI>Next message: <A HREF="024006.html">[rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24068">[ date ]</a>
              <a href="thread.html#24068">[ thread ]</a>
              <a href="subject.html#24068">[ subject ]</a>
              <a href="author.html#24068">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mark,

On 21/11/12 14:11, Mark Ward wrote:
&gt;<i> The size of the message may not be exactly the problem but more like how
</I>&gt;<i> large of a message, queue size, client count can the rabbitMQ cluster manage
</I>&gt;<i> before breaking.  That is probably stating the obvious. It seems even with
</I>&gt;<i> the RabbitMQ's high watermark and flow control I was still able to push
</I>&gt;<i> rabbitMQ above the highwater mark and enough that erlang would crash and
</I>&gt;<i> bring down rabbitmq.  The other was the erlang's heartbeat.  It would
</I>&gt;<i> timeout if the cluster nodes could not exchange messages before the node
</I>&gt;<i> timeout happened.
</I>&gt;<i>
</I>&gt;<i> The lower the high watermark the larger the message rabbitMQ was able to
</I>&gt;<i> manage. But that also greatly increased the use of flow control.
</I>
The default setting of the HWM is designed to work reasonably well on a 
range of typical setups. But it is tuneable for a reason. In particular, 
highly memory constrained set ups, like the one you have, may need 
lowering of the watermark.

As for the erlang inter-node heartbeat... I recall there was an issue in 
Erlang where large messages between nodes would cause heartbeats to be 
missed. I thought that had been fixed but I might well be imagining it. 
The erlang heartbeat is tuneable though, so on overloaded systems and 
when message payloads are large it might be worth increasing the timeout 
value.

&gt;<i> My test cluster is pretty weak.  I have VMWare vSphere 5 hypervisor
</I>&gt;<i> installed on an Intel Core 2 Duo 3.16GHz only 4 gig of ram.  I have 3 VMs
</I>&gt;<i> running on this poor workstation with each VM being Windows 2008 r2.  Each
</I>&gt;<i> VM only has 1 gig of ram given to it.
</I>
I wonder how much memory is actually left to applications in this setup, 
especially if you haven't got any swap space configured. The default HMW 
setting assumes that rabbit can take (nearly) all the available memory, 
which may be far too optimistic in this instance.

Regards,

Matthias.
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024045.html">[rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue
</A></li>
	<LI>Next message: <A HREF="024006.html">[rabbitmq-discuss] RabbitMQ 3.0 Policy ha-all delete issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24068">[ date ]</a>
              <a href="thread.html#24068">[ thread ]</a>
              <a href="subject.html#24068">[ subject ]</a>
              <a href="author.html#24068">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
