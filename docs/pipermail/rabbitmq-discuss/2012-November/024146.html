<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] The rabbitmq-server stop command hangs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20The%20rabbitmq-server%20stop%20command%20hangs&In-Reply-To=%3CE94F626F5C43D14F8B8479C5EBD79038A85EBD90%40vmexchange02.seegrid.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024078.html">
   <LINK REL="Next"  HREF="024147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] The rabbitmq-server stop command hangs</H1>
    <B>Elizabeth Liao</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20The%20rabbitmq-server%20stop%20command%20hangs&In-Reply-To=%3CE94F626F5C43D14F8B8479C5EBD79038A85EBD90%40vmexchange02.seegrid.local%3E"
       TITLE="[rabbitmq-discuss] The rabbitmq-server stop command hangs">eliao at seegrid.com
       </A><BR>
    <I>Mon Nov 26 22:19:51 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="024078.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
        <LI>Next message: <A HREF="024147.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24146">[ date ]</a>
              <a href="thread.html#24146">[ thread ]</a>
              <a href="subject.html#24146">[ subject ]</a>
              <a href="author.html#24146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've attached the inspect trace when using 3.0.
________________________________________
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] on behalf of Tim Watson [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">watson.timothy at gmail.com</A>]
Sent: Thursday, November 22, 2012 1:24 AM
To: Discussions about RabbitMQ
Cc: Discussions about RabbitMQ
Subject: Re: [rabbitmq-discuss] The rabbitmq-server stop command hangs

Thanks for the update Liz. We are looking into this, but 3.0 took precedence for a little while.

On 21 Nov 2012, at 21:59, Elizabeth Liao &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">eliao at seegrid.com</A>&gt; wrote:

&gt;<i> I took another look at this so I have a couple of things to add:
</I>&gt;<i>  * Trying RabbitMQ 3.0.0 did not resolve any issues
</I>&gt;<i>  * When rabbit hangs, there appears to be lots of channels (400-500) open.  However, it's unclear whether that's cause or effect.
</I>&gt;<i>
</I>
500 channels is no big deal for the server, but if the supervision tree is stuck shutting down its quite likely the network is involved so I'll keep this in mind.

Could you send another inspect trace using 3.0 by any chance?

Cheers
Tim

&gt;<i> Liz
</I>&gt;<i> ________________________________________
</I>&gt;<i> From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] on behalf of Elizabeth Liao [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">eliao at seegrid.com</A>]
</I>&gt;<i> Sent: Thursday, November 15, 2012 7:32 PM
</I>&gt;<i> To: Discussions about RabbitMQ
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] The rabbitmq-server stop command hangs
</I>&gt;<i>
</I>&gt;<i> Hi Tim,
</I>&gt;<i>
</I>&gt;<i> I ended up running the script with these commands:
</I>&gt;<i> # su rabbitmq
</I>&gt;<i> $ escript suptree_inspect.beam <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at TEST2</A> rabbit_sup | tee output-rabbit.log
</I>&gt;<i>
</I>&gt;<i> The output is attached.
</I>&gt;<i>
</I>&gt;<i> Thanks!
</I>&gt;<i>
</I>&gt;<i> Liz
</I>&gt;<i> ________________________________________
</I>&gt;<i> From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] on behalf of Tim Watson [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>]
</I>&gt;<i> Sent: Tuesday, November 13, 2012 7:32 AM
</I>&gt;<i> To: Matthias Radestock
</I>&gt;<i> Cc: Discussions about RabbitMQ
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] The rabbitmq-server stop command hangs
</I>&gt;<i>
</I>&gt;<i> Thanks Matthias!
</I>&gt;<i>
</I>&gt;<i> On 13 Nov 2012, at 11:40, Matthias Radestock wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On 13/11/12 11:34, Tim Watson wrote:
</I>&gt;&gt;&gt;<i> Are you using the same account to launch both executables?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Almost certainly not, given...
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> # rabbitmqctl status Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">test2 at test2</A> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> and
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> #  escript suptree_inspect.beam <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">test2 at test2</A> rabbit_sup | tee output.log
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> rabbitmqctl likely is the system-wide version which switches to the rabbitmq user. So the escript will need to be run like this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> sudo rabbitmq escript suptree_inspect.beam <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">test2 at test2</A> rabbit_sup | tee output.log
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matthias.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> Email Confidentiality Notice
</I>&gt;<i>
</I>&gt;<i> The information contained in this transmission is confidential, proprietary or privileged and may be subject to protection under the law. This message is intended for the sole use of the individual or entity to whom it's addressed. If you are not the intended recipient, you are notified that any use, distribution or copying of the message is strictly prohibited and may subject you to criminal or civil penalties. If you received this transmission in error, please contact the sender immediately by replying to this email and delete the material from any computer.
</I>&gt;<i> Email Confidentiality Notice
</I>&gt;<i>
</I>&gt;<i> The information contained in this transmission is confidential, proprietary or privileged and may be subject to protection under the law. This message is intended for the sole use of the individual or entity to whom it's addressed. If you are not the intended recipient, you are notified that any use, distribution or copying of the message is strictly prohibited and may subject you to criminal or civil penalties. If you received this transmission in error, please contact the sender immediately by replying to this email and delete the material from any computer.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
Email Confidentiality Notice

The information contained in this transmission is confidential, proprietary or privileged and may be subject to protection under the law. This message is intended for the sole use of the individual or entity to whom it's addressed. If you are not the intended recipient, you are notified that any use, distribution or copying of the message is strictly prohibited and may subject you to criminal or civil penalties. If you received this transmission in error, please contact the sender immediately by replying to this email and delete the material from any computer.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: output-rabbit-3.0.0.log
Type: text/x-log
Size: 1420590 bytes
Desc: output-rabbit-3.0.0.log
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121126/b80fb58a/attachment-0001.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121126/b80fb58a/attachment-0001.bin</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024078.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
	<LI>Next message: <A HREF="024147.html">[rabbitmq-discuss] The rabbitmq-server stop command hangs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24146">[ date ]</a>
              <a href="thread.html#24146">[ thread ]</a>
              <a href="subject.html#24146">[ subject ]</a>
              <a href="author.html#24146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
