<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Per-Connection Flow Control -- The Case Against	(Try #2)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Per-Connection%20Flow%20Control%20--%20The%20Case%20Against%0A%09%28Try%20%232%29&In-Reply-To=%3C2af00047-238a-49dc-95da-982dcc32f6a6%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020389.html">
   <LINK REL="Next"  HREF="020340.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Per-Connection Flow Control -- The Case Against	(Try #2)</H1>
    <B>Chip Salzenberg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Per-Connection%20Flow%20Control%20--%20The%20Case%20Against%0A%09%28Try%20%232%29&In-Reply-To=%3C2af00047-238a-49dc-95da-982dcc32f6a6%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Per-Connection Flow Control -- The Case Against	(Try #2)">rev.chip at gmail.com
       </A><BR>
    <I>Fri May 25 18:57:41 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020389.html">[rabbitmq-discuss] Why am I being censored?
</A></li>
        <LI>Next message: <A HREF="020340.html">[rabbitmq-discuss] Per-Connection Flow Control -- The Case Against (Try #2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20335">[ date ]</a>
              <a href="thread.html#20335">[ thread ]</a>
              <a href="subject.html#20335">[ subject ]</a>
              <a href="author.html#20335">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The fundamental paradox of per-connection flow control is that it holds up 
the stop sign just when progress becomes possible.  It is backwards and 
unhelpful.  Consider:

1. A client is publishing 1.5K/sec to each of four exchanges, each of which 
has a queue.
2. There are no consumers.  Therefore the queue is growing.
3. RMQ does not stop this.  &quot;Flow control&quot; does not trigger.
4. The consumers appear to begin to tear down the backlog.
5. RMQ per-connection flow control suddenly decides that now there are some 
consumers, now it has a reason to throttle the sender.
6. If the consumers had not shown up, the producer would not have been 
blocked.

Therefore, it is only when the backlog can go DOWN that the broker decides 
to throttle the sender.  Not when the backlog was GROWING, but when it 
could be SHRINKING, that's when RMQ decides to stop accepting.

This is not acceptable.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120525/23703a6a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120525/23703a6a/attachment.htm</A>&gt;
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020389.html">[rabbitmq-discuss] Why am I being censored?
</A></li>
	<LI>Next message: <A HREF="020340.html">[rabbitmq-discuss] Per-Connection Flow Control -- The Case Against (Try #2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20335">[ date ]</a>
              <a href="thread.html#20335">[ thread ]</a>
              <a href="subject.html#20335">[ subject ]</a>
              <a href="author.html#20335">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
