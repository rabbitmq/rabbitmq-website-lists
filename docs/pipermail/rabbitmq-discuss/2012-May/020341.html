<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Regular supervisor shutdown errors?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Regular%20supervisor%20shutdown%20errors%3F&In-Reply-To=%3C5A1722C0-DD44-490C-9203-343E9F3E7368%40thumb.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020340.html">
   <LINK REL="Next"  HREF="020345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Regular supervisor shutdown errors?</H1>
    <B>Will Koffel</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Regular%20supervisor%20shutdown%20errors%3F&In-Reply-To=%3C5A1722C0-DD44-490C-9203-343E9F3E7368%40thumb.it%3E"
       TITLE="[rabbitmq-discuss] Regular supervisor shutdown errors?">will at thumb.it
       </A><BR>
    <I>Sat May 26 05:00:05 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020340.html">[rabbitmq-discuss] Per-Connection Flow Control -- The Case Against (Try #2)
</A></li>
        <LI>Next message: <A HREF="020345.html">[rabbitmq-discuss] Regular supervisor shutdown errors?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20341">[ date ]</a>
              <a href="thread.html#20341">[ thread ]</a>
              <a href="subject.html#20341">[ subject ]</a>
              <a href="author.html#20341">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm seeing somewhat regular (but not in a tight loop) occurrences of these notices in my rabbit@&lt;host&gt;-sasl.log.

Sometimes the reason is listed as &quot;noproc&quot;, other times as &quot;shutdown&quot;.  Are these normal?  If not, how can I debug?


&gt;<i> =SUPERVISOR REPORT==== 26-May-2012::02:09:34 ===
</I>&gt;<i>      Supervisor: {&lt;0.549.2188&gt;,
</I>&gt;<i>                                            rabbit_channel_sup_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     noproc
</I>&gt;<i>      Offender:   [{pid,&lt;0.551.2188&gt;},
</I>&gt;<i>                   {name,channel_sup},
</I>&gt;<i>                   {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i>                   {restart_type,temporary},
</I>&gt;<i>                   {shutdown,infinity},
</I>&gt;<i>                   {child_type,supervisor}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 26-May-2012::02:15:52 ===
</I>&gt;<i>      Supervisor: {&lt;0.31254.2188&gt;,
</I>&gt;<i>                                            rabbit_channel_sup_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     noproc
</I>&gt;<i>      Offender:   [{pid,&lt;0.31256.2188&gt;},
</I>&gt;<i>                   {name,channel_sup},
</I>&gt;<i>                   {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i>                   {restart_type,temporary},
</I>&gt;<i>                   {shutdown,infinity},
</I>&gt;<i>                   {child_type,supervisor}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 26-May-2012::02:18:20 ===
</I>&gt;<i>      Supervisor: {&lt;0.15873.2189&gt;,
</I>&gt;<i>                                            rabbit_channel_sup_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     shutdown
</I>&gt;<i>      Offender:   [{pid,&lt;0.15875.2189&gt;},
</I>&gt;<i>                   {name,channel_sup},
</I>&gt;<i>                   {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i>                   {restart_type,temporary},
</I>&gt;<i>                   {shutdown,infinity},
</I>&gt;<i>                   {child_type,supervisor}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 26-May-2012::03:52:54 ===
</I>&gt;<i>      Supervisor: {&lt;0.23330.3&gt;,rabbit_channel_sup_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     shutdown
</I>&gt;<i>      Offender:   [{pid,&lt;0.23340.3&gt;},
</I>&gt;<i>                   {name,channel_sup},
</I>&gt;<i>                   {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i>                   {restart_type,temporary},
</I>&gt;<i>                   {shutdown,infinity},
</I>&gt;<i>                   {child_type,supervisor}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 26-May-2012::03:53:48 ===
</I>&gt;<i>      Supervisor: {&lt;0.27559.3&gt;,rabbit_channel_sup_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     shutdown
</I>&gt;<i>      Offender:   [{pid,&lt;0.27561.3&gt;},
</I>&gt;<i>                   {name,channel_sup},
</I>&gt;<i>                   {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i>                   {restart_type,temporary},
</I>&gt;<i>                   {shutdown,infinity},
</I>&gt;<i>                   {child_type,supervisor}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 26-May-2012::03:54:22 ===
</I>&gt;<i>      Supervisor: {&lt;0.30115.3&gt;,rabbit_channel_sup_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     shutdown
</I>&gt;<i>      Offender:   [{pid,&lt;0.30117.3&gt;},
</I>&gt;<i>                   {name,channel_sup},
</I>&gt;<i>                   {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i>                   {restart_type,temporary},
</I>&gt;<i>                   {shutdown,infinity},
</I>&gt;<i>                   {child_type,supervisor}]
</I>

I've also seen 3 of my instances of rabbitmq crash this evening. Haven't changed anything about the configuration or versions or anything in weeks, but clearly something is going on.  One one of the crashed instances, the startup_err log shows me:


&gt;<i> Crash dump was written to: erl_crash.dump
</I>&gt;<i> eheap_alloc: Cannot allocate 2850821240 bytes of memory (of type &quot;old_heap&quot;).
</I>&gt;<i> /usr/sbin/rabbitmq-server: line 42: 31512 Aborted                 /usr/lib/rabbitmq/bin/${SCRIPT} &quot;$@&quot;
</I>

I can't find the erl_crash.dump file, however.  Where should that live?

Rabbit seems to startup okay, except that when this happens, I lose all my persistent messages in a queue (issue I mentioned on the list last week, never figured it out, I'm moving away from rabbit for my persistent message needs, this is just too scary an issue for my production data at the moment). Not sure if these warnings in the logs are related to the crashes that I've seen, or the lost messages.

-Will


________________
Will Koffel
CTO, Thumb&#8482;
51 E 12th St., 4th Floor
New York, NY 10003
Office: (212) 673-8650
Mobile: (617) 575-WILL
@thumb
www.thumb.it






-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120526/1625d593/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120526/1625d593/attachment.htm</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020340.html">[rabbitmq-discuss] Per-Connection Flow Control -- The Case Against (Try #2)
</A></li>
	<LI>Next message: <A HREF="020345.html">[rabbitmq-discuss] Regular supervisor shutdown errors?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20341">[ date ]</a>
              <a href="thread.html#20341">[ thread ]</a>
              <a href="subject.html#20341">[ subject ]</a>
              <a href="author.html#20341">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
