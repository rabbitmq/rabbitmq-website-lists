<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Windows service recovery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Windows%20service%20recovery&In-Reply-To=%3CC3A760638FE7B343972DD905011226E3058AF14CB4%40GZSMSCCR03.sms1.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020363.html">
   <LINK REL="Next"  HREF="020366.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Windows service recovery</H1>
    <B>Lior Barnea</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Windows%20service%20recovery&In-Reply-To=%3CC3A760638FE7B343972DD905011226E3058AF14CB4%40GZSMSCCR03.sms1.local%3E"
       TITLE="[rabbitmq-discuss] Windows service recovery">Barnea at 3i-mind.com
       </A><BR>
    <I>Mon May 28 14:46:24 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020363.html">[rabbitmq-discuss] Windows service recovery
</A></li>
        <LI>Next message: <A HREF="020366.html">[rabbitmq-discuss] Windows service recovery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20365">[ date ]</a>
              <a href="thread.html#20365">[ thread ]</a>
              <a href="subject.html#20365">[ subject ]</a>
              <a href="author.html#20365">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&quot;Based on this reading, it ought to be 'possible' to verify that an instance is still up, but I'm a little unclear on how you would confirm that the said program was the one that erlsrv 'ought' to be monitoring. &quot;

This is even worse, cause if I run some other erl process and both erlsrv process and rabbitMQ's erl process goes down it is possible that erlsrv will fail to spawn rabbitMQ for no reason...

A possible solution - erlsrv will save (On disk for example) the PID the erl.exe it needs to monitor and on startup, if there is an erl.exe with the same PID, it is the one.

-----Original Message-----
From: Tim Watson [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>] 
Sent: Monday, May 28, 2012 15:39
To: Lior Barnea
Cc: Emile Joubert; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Windows service recovery

On 28/05/12 13:38, Lior Barnea wrote:
&gt;<i> Erlsrv is the service instance, acting as a watchdog (spawning it on startup) for erl.exe which runs rabbitMQ.
</I>&gt;<i>
</I>&gt;<i> As I said before, the scenario in which erlsvr is going down without erl.exe is currently hypothetic but its behavior after its restarting because I killed it is wrong.
</I>&gt;<i>
</I>&gt;<i> For my QA team: &quot;Its unlikely that it will happens&quot; equals &quot;It can 
</I>&gt;<i> happen&quot; :)
</I>
Yeah, you're right on both counts. The behaviour is wrong and 'it can happen' in theory. This question now needs to move over to the erlang-questions mailing list and get raised with the OTP team, as they're responsible for erlsrv and should be able to get it fixed.

 From a brief glance at the (erlsrv) code, my reading of it is that there is no link between erlsrv and erl.exe other than the use of the fifo pipes provided by to_erl, used to handle interactions (such as shut down). Based on this reading, it ought to be 'possible' to verify that an instance is still up, but I'm a little unclear on how you would confirm that the said program was the one that erlsrv 'ought' to be monitoring.


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020363.html">[rabbitmq-discuss] Windows service recovery
</A></li>
	<LI>Next message: <A HREF="020366.html">[rabbitmq-discuss] Windows service recovery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20365">[ date ]</a>
              <a href="thread.html#20365">[ thread ]</a>
              <a href="subject.html#20365">[ subject ]</a>
              <a href="author.html#20365">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
