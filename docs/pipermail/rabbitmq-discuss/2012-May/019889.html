<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Hang on &quot;starting database ....&quot; remains in	2.8.2 cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Hang%20on%20%22starting%20database%20....%22%20remains%20in%0A%092.8.2%20cluster&In-Reply-To=%3CCACLE7iykgZBFJaSCAs6%2BK6veXFGrweUiKWvT_QnGE-u6DhLJDQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019895.html">
   <LINK REL="Next"  HREF="019924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Hang on &quot;starting database ....&quot; remains in	2.8.2 cluster</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Hang%20on%20%22starting%20database%20....%22%20remains%20in%0A%092.8.2%20cluster&In-Reply-To=%3CCACLE7iykgZBFJaSCAs6%2BK6veXFGrweUiKWvT_QnGE-u6DhLJDQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Hang on &quot;starting database ....&quot; remains in	2.8.2 cluster">mpietrek at skytap.com
       </A><BR>
    <I>Fri May  4 23:55:43 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019895.html">[rabbitmq-discuss] exchange.unbind method enumeration
</A></li>
        <LI>Next message: <A HREF="019924.html">[rabbitmq-discuss] Hang on &quot;starting database ....&quot; remains in 2.8.2 cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19889">[ date ]</a>
              <a href="thread.html#19889">[ thread ]</a>
              <a href="subject.html#19889">[ subject ]</a>
              <a href="author.html#19889">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've written this alias before about this topic, and the problem
remains in 2.8.2. See:
    <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2012-February/018414.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2012-February/018414.html</A>

I have a three node cluster running RabbitMQ 2.82/Erlang R13B03 on Ubuntu 10.04.

Once the cluster is up and running properly (as observed by the Web
UI), I then start/stop individual nodes in the cluster:
    rabbitmqctl stop
    rabbitmq-server

Inevitably one of the nodes won't come back up, waiting forever on
&quot;starting&quot; the database (no 30 second timeout... Forever.)

The only way to get all three nodes functioning again together is to
forcibly stop the other two nodes, then restart them all again.


The first item below is the console output as captured via nohup,
showing &quot;starting database&quot; as the last item.
The second item below is the last few lines of the rabbit@&lt;node&gt;.log
file, showing the node shutting down, then beginning to start up
again.

Is it likely that a newer Erlang version would help out?
What else can I provide to help diagnose this?

Thanks,

Matt

--------
node           : <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at util</A>
app descriptor :
/usr/lib/rabbitmq/lib/rabbitmq_server-2.8.2/sbin/../ebin/rabbit.app
home dir       : /home/mpietrek
config file(s) : /home/mpietrek/work/var/run/rabbitmq.config
cookie hash    : pR5H9kY3Wra/XdLELT5hgQ==
log            :
/home/mpietrek/work/logs/util.mpietrek.internal.illumita.com/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at util.log</A>
sasl log       :
/home/mpietrek/work/logs/util.mpietrek.internal.illumita.com/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at util-sasl.log</A>
database dir   : /home/mpietrek/work/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at util</A>
erlang version : 5.7.4

-- rabbit boot start
starting file handle cache server                                     ...done
starting worker pool                                                  ...done
starting database                                                     ...

--------

=INFO REPORT==== 4-May-2012::15:02:14 ===
    application: rabbitmq_management_agent
    exited: stopped
    type: permanent

=INFO REPORT==== 4-May-2012::15:02:14 ===
stopped TCP Listener on 0.0.0.0:5672

=INFO REPORT==== 4-May-2012::15:02:14 ===
    application: rabbit
    exited: stopped
    type: permanent

=INFO REPORT==== 4-May-2012::15:02:14 ===
    application: os_mon
    exited: stopped
    type: permanent

=INFO REPORT==== 4-May-2012::15:02:14 ===
    application: mnesia
    exited: stopped
    type: permanent

=INFO REPORT==== 4-May-2012::15:02:14 ===
Halting Erlang VM

=INFO REPORT==== 4-May-2012::15:02:52 ===
Limiting to approx 924 file handles (829 sockets)
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019895.html">[rabbitmq-discuss] exchange.unbind method enumeration
</A></li>
	<LI>Next message: <A HREF="019924.html">[rabbitmq-discuss] Hang on &quot;starting database ....&quot; remains in 2.8.2 cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19889">[ date ]</a>
              <a href="thread.html#19889">[ thread ]</a>
              <a href="subject.html#19889">[ subject ]</a>
              <a href="author.html#19889">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
