<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Weird%20ansible-playbook%20behaviour%20when%20trying%0A%20to%20start%20rabbitmq-server%202.8.2&In-Reply-To=%3C4FB39D4A.2070008%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020071.html">
   <LINK REL="Next"  HREF="020091.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Weird%20ansible-playbook%20behaviour%20when%20trying%0A%20to%20start%20rabbitmq-server%202.8.2&In-Reply-To=%3C4FB39D4A.2070008%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2">simon at rabbitmq.com
       </A><BR>
    <I>Wed May 16 13:27:54 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020071.html">[rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2
</A></li>
        <LI>Next message: <A HREF="020091.html">[rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20072">[ date ]</a>
              <a href="thread.html#20072">[ thread ]</a>
              <a href="subject.html#20072">[ subject ]</a>
              <a href="author.html#20072">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 16/05/12 12:58, Cosmin Lu&#539;&#259; wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> Please allow me to cross reference this thread
</I>&gt;<i> &lt;<A HREF="https://groups.google.com/forum/#%21topic/ansible-project/9XKZoqsshE0">https://groups.google.com/forum/#%21topic/ansible-project/9XKZoqsshE0</A>&gt;
</I>&gt;<i> ; I'm trying to install and start rabbitmq-server 2.8.2 (installed from
</I>&gt;<i> a Debian package) using ansible (a tool that connects to remote machines
</I>&gt;<i> using SSH and can performs various administrative tasks).
</I>&gt;<i> Does anyone have an idea what has changed in the initialization scripts
</I>&gt;<i> of rabbitmq since version 2.7.1 upwards that could cause the mentioned
</I>&gt;<i> behaviour?
</I>
We changed a couple of things in the init script, mainly using 
start-stop-daemon instead of su to change the user, and using lsb-base 
functions instead of echo.

I can't reproduce what Michael DeHaan says over in the other thread:

&gt;<i> Ok, so the rabbitmq script sounds like it cares very much about the
</I>&gt;<i> current directory, and when the current directory is gone, it blows
</I>&gt;<i> up.   Please take this up with whoever maintains the distro init
</I>&gt;<i> script, because it's doing stupid things
</I>&gt;<i> and it should not care anything about the directory you first ran
</I>&gt;<i> /sbin/service in.
</I>
I tried this from a deleted directory:

$ sudo service rabbitmq-server stop
sudo: cannot get working directory
sh: getcwd() failed: No such file or directory
  * Stopping message broker rabbitmq-server            [ OK ]

$ sudo service rabbitmq-server start
sudo: cannot get working directory
sh: getcwd() failed: No such file or directory
  * Starting message broker rabbitmq-server            [ OK ]

...and it worked fine. So I am not sure what's up here. If we are doing 
stupid things I would like to fix them, but I'm not sure we are.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020071.html">[rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2
</A></li>
	<LI>Next message: <A HREF="020091.html">[rabbitmq-discuss] Weird ansible-playbook behaviour when trying to start rabbitmq-server 2.8.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20072">[ date ]</a>
              <a href="thread.html#20072">[ thread ]</a>
              <a href="subject.html#20072">[ subject ]</a>
              <a href="author.html#20072">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
