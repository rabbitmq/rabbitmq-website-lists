<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Windows service recovery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Windows%20service%20recovery&In-Reply-To=%3CC3A760638FE7B343972DD905011226E3058AF1472D%40GZSMSCCR03.sms1.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020281.html">
   <LINK REL="Next"  HREF="020325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Windows service recovery</H1>
    <B>Lior Barnea</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Windows%20service%20recovery&In-Reply-To=%3CC3A760638FE7B343972DD905011226E3058AF1472D%40GZSMSCCR03.sms1.local%3E"
       TITLE="[rabbitmq-discuss] Windows service recovery">Barnea at 3i-mind.com
       </A><BR>
    <I>Wed May 23 15:37:41 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020281.html">[rabbitmq-discuss] STOMP adapter lose the last message of	a	burst
</A></li>
        <LI>Next message: <A HREF="020325.html">[rabbitmq-discuss] Windows service recovery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20282">[ date ]</a>
              <a href="thread.html#20282">[ thread ]</a>
              <a href="subject.html#20282">[ subject ]</a>
              <a href="author.html#20282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I am trying to set a recovery policy for rabbitMQ windows service.

Installing rabbitMQ as a windows service sets erlsrv.exe as the internal executable.
I set the OnFail option of Erlang emulator to restart.
I set windows policy for erlsvr.exe to restart on fail.
Starting the service will start the erlsvr.exe process which then spawns erl.exe which is the actual process running rabbitMQ.

Killing erl.exe invokes the OnFail (does not alerts windows cause the windows recovery policy is on erlsvr.exe) and restarts rabbitMQ, which is great.

Killing erlsvr.exe does not stop erl.exe (meaning rabbitMQ still running) but does alert windows that then tries to restart erlsvr.exe
When erlsvr.exe is started again, it tries to spawn erl.exe again and fails because it is already running, failing erlsvr.exe completely, recovery failed.

Help please :)




Lior Barnea

Developer





3i-MIND

T. 074-719-2884

&#9679;&#9679;&#9679;

M.054-816-7341

www.3i-mind.com

<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">barnea at 3i-mind.com</A>



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120523/2a89d632/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120523/2a89d632/attachment.htm</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020281.html">[rabbitmq-discuss] STOMP adapter lose the last message of	a	burst
</A></li>
	<LI>Next message: <A HREF="020325.html">[rabbitmq-discuss] Windows service recovery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20282">[ date ]</a>
              <a href="thread.html#20282">[ thread ]</a>
              <a href="subject.html#20282">[ subject ]</a>
              <a href="author.html#20282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
