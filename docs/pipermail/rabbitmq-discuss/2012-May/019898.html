<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] HA Queues lost when a node dies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20Queues%20lost%20when%20a%20node%20dies&In-Reply-To=%3CCACGcny8FO%3DoEV41B1jxGpHsa2TmsORxg26GzE_PsrGaOWaq4pg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019941.html">
   <LINK REL="Next"  HREF="019900.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] HA Queues lost when a node dies</H1>
    <B>Bozhidar Bozhanov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20Queues%20lost%20when%20a%20node%20dies&In-Reply-To=%3CCACGcny8FO%3DoEV41B1jxGpHsa2TmsORxg26GzE_PsrGaOWaq4pg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] HA Queues lost when a node dies">bozhidar.bozhanov at gmail.com
       </A><BR>
    <I>Mon May  7 17:44:31 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019941.html">[rabbitmq-discuss] 2.7.1 / R14B04 Crash Report: ~1PB RAM allocation failure
</A></li>
        <LI>Next message: <A HREF="019900.html">[rabbitmq-discuss] HA Queues lost when a node dies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19898">[ date ]</a>
              <a href="thread.html#19898">[ thread ]</a>
              <a href="subject.html#19898">[ subject ]</a>
              <a href="author.html#19898">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We are currently trying to run RabbitMQ (2.8.1) in a cluster and use
highly-available queues. We have around 50 queues. Each queue is
registered with one of the nodes (at random), as master, and using
x-ha-policy=all. We have 2 nodes in the cluster.

The management console shows that the cluster is successfully created,
and that the queues are highly-available and properly mirrored. Then
we kill one of the nodes (with kill -9) to simulate system failure. We
have tried this five times, and each time a different result was
observed:
- only 1 queue 'survived' (the metadata about the others was deleted
and they were not visible in the management console, nor we could send
or consume messages to/from them)
- all but 3 queues survived
- only 10 queues survived
- all queues survived
- all but 1 queue survived

The queues that survived properly switched their master node to the
only remaining one.

The results are random, as it seems. Is this expected behaviour? Is it
likely to be fixed in 2.8.2. And how can we make sure that if a node
dies, the queues don't get deleted.
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019941.html">[rabbitmq-discuss] 2.7.1 / R14B04 Crash Report: ~1PB RAM allocation failure
</A></li>
	<LI>Next message: <A HREF="019900.html">[rabbitmq-discuss] HA Queues lost when a node dies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19898">[ date ]</a>
              <a href="thread.html#19898">[ thread ]</a>
              <a href="subject.html#19898">[ subject ]</a>
              <a href="author.html#19898">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
