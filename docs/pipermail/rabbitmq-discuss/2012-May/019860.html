<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] broken release?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20broken%20release%3F&In-Reply-To=%3C4FA29E21.600%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019859.html">
   <LINK REL="Next"  HREF="019863.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] broken release?</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20broken%20release%3F&In-Reply-To=%3C4FA29E21.600%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] broken release?">emile at rabbitmq.com
       </A><BR>
    <I>Thu May  3 16:02:57 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019859.html">[rabbitmq-discuss] broken release?
</A></li>
        <LI>Next message: <A HREF="019863.html">[rabbitmq-discuss] broken release?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19860">[ date ]</a>
              <a href="thread.html#19860">[ thread ]</a>
              <a href="subject.html#19860">[ subject ]</a>
              <a href="author.html#19860">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

On 03/05/12 12:29, Aryeh Leib Taurog wrote:
&gt;<i> Is there any way to detect in the publisher whether or not messages 
</I>&gt;<i> are actually being queued?  With pika 0.9.5, as I mentioned, there was 
</I>&gt;<i> no indication of failure on either client.
</I>
The broker was blocking the producer and would have accepted the message
when more disk space became available. That is different from the broker
receiving the message and discarding it, or from the message being lost
due to the broker crashing. That's not what happened.

Publication is an asynchronous so there is no way to return an outcome
of the command as a value. You can attempt to detect a blocking broker
by using publish confirms with a timeout. See
<A HREF="http://www.rabbitmq.com/extensions.html#publishing">http://www.rabbitmq.com/extensions.html#publishing</A>

A publisher can only be sure that a message was received by the broker
when a publish confirm is received. In your case the client probably
closed the socket while part of the message was still in network buffers.

&gt;<i> Is there a way to move the location on disk somewhere other than /var?
</I>
You can select a location for the logfiles and the database. See
<A HREF="http://www.rabbitmq.com/relocate.html">http://www.rabbitmq.com/relocate.html</A>

&gt;<i> Would it be possible to configure RabbitMQ to discard *oldest* 
</I>&gt;<i> messages as opposed to *newest* messages in situations where there 
</I>&gt;<i> isn't enough memory?  I believe that qpid for example uses some kind 
</I>&gt;<i> of circular buffer for message transport, so that would happen by 
</I>&gt;<i> default.
</I>
To be clear, no messages were discarded. If you run out of memory (or
out of disk space with v2.8.2 and later) the broker will block producers
from sending any more messages until conditions return to normal.

&gt;<i> Is there any way I could receive an alert, say by e-mail, or at least 
</I>&gt;<i> on some message queue, when flow-control events occur?  All I see 
</I>&gt;<i> regarding 'monitoring' in the documentation are interactive tools.
</I>&gt;<i> I would want to be alerted if:
</I>&gt;<i> 
</I>&gt;<i>  * Memory usage exceeds a certain level
</I>&gt;<i>  * Messages are paged to disk
</I>&gt;<i>  * Disk usage exceeds a certain level
</I>
All log messages are also sent to amq.rabbitmq.log exchange, so you
could consume those messages to find out if limits are exceeded. You
could also query the broker state with the REST API (part of the
Management plugin). You could also use the output of the &quot;rabbitmqctl
status&quot; command to obtain this information.

There is no API for alerting when transient messages are paged to disk
and this happens transparently.

-Emile


</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019859.html">[rabbitmq-discuss] broken release?
</A></li>
	<LI>Next message: <A HREF="019863.html">[rabbitmq-discuss] broken release?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19860">[ date ]</a>
              <a href="thread.html#19860">[ thread ]</a>
              <a href="subject.html#19860">[ subject ]</a>
              <a href="author.html#19860">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
