<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ C# .net client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20C%23%20.net%20client&In-Reply-To=73DE98796DEF7648900B97A9EA9222B435C14D%40RCAPLDC4.rcapl.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001170.html">
   <LINK REL="Next"  HREF="001171.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ C# .net client</H1>
    <B>Hubert Plociniczak</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20C%23%20.net%20client&In-Reply-To=73DE98796DEF7648900B97A9EA9222B435C14D%40RCAPLDC4.rcapl.com"
       TITLE="[rabbitmq-discuss] RabbitMQ C# .net client">hubert at lshift.net
       </A><BR>
    <I>Tue Aug 19 18:34:24 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001170.html">[rabbitmq-discuss] RabbitMQ C# .net client
</A></li>
        <LI>Next message: <A HREF="001171.html">[rabbitmq-discuss] Load balancing exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1180">[ date ]</a>
              <a href="thread.html#1180">[ thread ]</a>
              <a href="subject.html#1180">[ subject ]</a>
              <a href="author.html#1180">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Lakmali,

There is nothing special in the code.
Could it be the case that you set AutoClose property in connection to true ?

In that case when closing the channel with 'channel.Close(200, &quot;Goodbye&quot;);'
this will automatically close the whole connection, because I assume that there are no
other channels left. Hence when you try to close the connection manually after it, 
you get this exception.

Does this help?

Thanks,
Hubert

Lakmali Weeraratne wrote:
&gt;<i>
</I>&gt;<i> Hi Hubert,
</I>&gt;<i>
</I>&gt;<i> I was successful in creating a connection to the OpenAMQ Server.
</I>&gt;<i>
</I>&gt;<i> But when I&#8217;m closing the connection, it gives me an exception.
</I>&gt;<i>
</I>&gt;<i> Please be kind enough to point out the cause of the issue.
</I>&gt;<i>
</I>&gt;<i> Code Reference is attached.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> /Lakmali
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Private void closeConnection(object sender, EventArgs e)
</I>&gt;<i>
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i> try
</I>&gt;<i>
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i> channel.Close(200, &quot;Goodbye&quot;);
</I>&gt;<i>
</I>&gt;<i> //conn.Close();
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> catch (RabbitMQ.Client.Exceptions.OperationInterruptedException)
</I>&gt;<i>
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i> MessageBox.Show (&quot;Error&quot;);
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> ------Error Description ------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> On SimpleBlockingRpcContinuation class
</I>&gt;<i>
</I>&gt;<i> public virtual Command GetReply()
</I>&gt;<i>
</I>&gt;<i> {
</I>&gt;<i>
</I>&gt;<i> Either result = (Either)cell.Value;
</I>&gt;<i>
</I>&gt;<i> switch (result.Alternative) {
</I>&gt;<i>
</I>&gt;<i> case EitherAlternative.Left:
</I>&gt;<i>
</I>&gt;<i> return (Command)result.Value;
</I>&gt;<i>
</I>&gt;<i> case EitherAlternative.Right:
</I>&gt;<i>
</I>&gt;<i> throw new OperationInterruptedException((ShutdownEventArgs)result.Value);
</I>&gt;<i>
</I>&gt;<i> default:
</I>&gt;<i>
</I>&gt;<i> Trace.Fail(&quot;Illegal EitherAlternative &quot; + result.Alternative);
</I>&gt;<i>
</I>&gt;<i> return null;
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Error at:
</I>&gt;<i>
</I>&gt;<i> throw new OperationInterruptedException((ShutdownEventArgs)result.Value);
</I>&gt;<i>
</I>&gt;<i> As
</I>&gt;<i>
</I>&gt;<i> &quot; the AMQP operation was interrupted: AMQP close-reason, initiated by 
</I>&gt;<i> Application, code=200, text=&quot;Goodbye&quot;, classId=0, methodId=0, cause= &quot;
</I>&gt;<i>
</I>&gt;<i> ------Error Description ------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>   
</I>

-- 
 [][][] Hubert Plociniczak
   [][] LShift Ltd
 []  [] www.lshift.net



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001170.html">[rabbitmq-discuss] RabbitMQ C# .net client
</A></li>
	<LI>Next message: <A HREF="001171.html">[rabbitmq-discuss] Load balancing exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1180">[ date ]</a>
              <a href="thread.html#1180">[ thread ]</a>
              <a href="subject.html#1180">[ subject ]</a>
              <a href="author.html#1180">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
