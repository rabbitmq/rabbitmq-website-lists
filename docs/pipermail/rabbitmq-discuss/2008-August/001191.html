<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] mod_rabbitmq loses messages on server restart?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20mod_rabbitmq%20loses%20messages%20on%20server%20restart%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001192.html">
   <LINK REL="Next"  HREF="001193.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] mod_rabbitmq loses messages on server restart?</H1>
    <B>Jason Pellerin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20mod_rabbitmq%20loses%20messages%20on%20server%20restart%3F&In-Reply-To="
       TITLE="[rabbitmq-discuss] mod_rabbitmq loses messages on server restart?">jpellerin at leapfrogonline.com
       </A><BR>
    <I>Thu Aug 21 18:11:54 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001192.html">[rabbitmq-discuss] anyone using Twisted?
</A></li>
        <LI>Next message: <A HREF="001193.html">[rabbitmq-discuss] anyone using Twisted?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1191">[ date ]</a>
              <a href="thread.html#1191">[ thread ]</a>
              <a href="subject.html#1191">[ subject ]</a>
              <a href="author.html#1191">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm experimenting, successfully so far, with mod_rabbitmq for ejabberd.
One thing doesn't seem right: If I send some messages to an exchange
whose subscriber is not present, then restart ejabberd, then log in with
the subscriber, those messages are not delivered. They are delivered in
all of the normal cases of the subscriber being online, or being offline
and coming online later, so long as the ejabberd server stays up in the
meantime.

To make things more clear, here's the sequence of events:

<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">a at localhost</A> subcribes to <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">foo at rabbitmq.localhost</A>/message.* (a durable
topic exchange)
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">a at localhost</A> logs out
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">b at localhost</A> sends message to <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">foo at rabbit</A>@rabbitmq.localhost/message.a

Now, if ejabberd is restarted and <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">a at localhost</A> logs in, no message is
delivered. However, if <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">a at localhost</A> logs in without restarting ejabberd,
the message delivers.

Is this a known issue with ejabberd or mod_rabbitmq? Or am I just doing
something wrong? Can anyone suggest a workaround, or where I might start
looking to try to fix it?

Thanks,

JP


CONFIDENTIALITY NOTE
The document(s) accompanying this e-mail transmission, if any, and the e-mail transmittal message containing information from Leapfrog Online Customer Acquisition, LLC is confidential or privileged. The information is intended to be for the use of the individual(s) or entity(ies) named on this e-mail transmission message. If you are not the intended recipient, be aware that any disclosure, copying, distribution or use of the contents of this e-mail is prohibited. If you have received this e-mail in error, please immediately delete this e-mail and notify us by telephone of the error.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001192.html">[rabbitmq-discuss] anyone using Twisted?
</A></li>
	<LI>Next message: <A HREF="001193.html">[rabbitmq-discuss] anyone using Twisted?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1191">[ date ]</a>
              <a href="thread.html#1191">[ thread ]</a>
              <a href="subject.html#1191">[ subject ]</a>
              <a href="author.html#1191">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
