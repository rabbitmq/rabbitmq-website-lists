<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Load%20balancing%20with%20multiple%20consumers%20on%20a%0A%09single%20queue&In-Reply-To=b307b5520807312117v2c66f62br9d8371eb1fcec808%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001116.html">
   <LINK REL="Next"  HREF="001119.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Load%20balancing%20with%20multiple%20consumers%20on%20a%0A%09single%20queue&In-Reply-To=b307b5520807312117v2c66f62br9d8371eb1fcec808%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue">alexis.richardson at cohesiveft.com
       </A><BR>
    <I>Fri Aug  1 06:29:09 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001116.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
        <LI>Next message: <A HREF="001119.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1118">[ date ]</a>
              <a href="thread.html#1118">[ thread ]</a>
              <a href="subject.html#1118">[ subject ]</a>
              <a href="author.html#1118">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nathan

Let me take a chunk of this - but not the Basic.reject part.

On Fri, Aug 1, 2008 at 5:17 AM, Nathan Oorloff &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nathan at comvine.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Alexis: although your solution isn't ideal, the amount of processing a task
</I>&gt;<i> requires is roughly related to the size so that might be a good option.
</I>&gt;<i> Where can I find the options for doing the advanced routing rules? So far
</I>&gt;<i> I've only seen routing based on the routing_key property.
</I>
The question is whether the existing routing rules are advanced
enough.  I argue that, with Topic Exchanges, they are.

It would not be hard to write a custom exchange which routed messages
based on their size.  The thing is that you would still need a
routing_key as well.  Or rather: if the custom exchange only *ever*
routed based on size, and ignored keys, your solution could be hard to
maintain as you sent more and more messages.  On the other hand you
could perform the size check at the application layer, ie on the
sender, and include size information in the routing keys.  That would
make it easier to treat all routing logic in a uniform way even in a
large scale app.

For example:

accounts.london.largetask.100
accounts.paris.smalltask.2

... could be routed with a Topic Exchange.

My point is that if you use keys at all for this, then you may as well
use them for all of it, and send size info as a key.  Then you do not
need to write a new exchange and can reuse existing application level
tools to maintain your routing logic over time.

Do others agree?  Share your thoughts ;-)

alexis


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001116.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
	<LI>Next message: <A HREF="001119.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1118">[ date ]</a>
              <a href="thread.html#1118">[ thread ]</a>
              <a href="subject.html#1118">[ subject ]</a>
              <a href="author.html#1118">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
