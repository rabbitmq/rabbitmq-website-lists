<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ/AMQP understanding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ/AMQP%20understanding&In-Reply-To=ecfbfea90808221305qcd75621j3a39bf01625c7904%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001208.html">
   <LINK REL="Next"  HREF="001213.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ/AMQP understanding</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ/AMQP%20understanding&In-Reply-To=ecfbfea90808221305qcd75621j3a39bf01625c7904%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ/AMQP understanding">0x6e6562 at gmail.com
       </A><BR>
    <I>Fri Aug 22 21:49:23 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001208.html">[rabbitmq-discuss] RabbitMQ/AMQP understanding
</A></li>
        <LI>Next message: <A HREF="001213.html">[rabbitmq-discuss] RabbitMQ/AMQP understanding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1211">[ date ]</a>
              <a href="thread.html#1211">[ thread ]</a>
              <a href="subject.html#1211">[ subject ]</a>
              <a href="author.html#1211">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Torben,

On Fri, Aug 22, 2008 at 9:05 PM, Torben Hoffmann
&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">torben.lehoff at googlemail.com</A>&gt; wrote:
&gt;<i> Okay, I did not think of this type of solution, but I think this would work
</I>&gt;<i> just as fine. So either I get a lot of queues or a lot of exchanges
</I>&gt;<i> depending on how I choose to represent the groups. I will let that be up to
</I>&gt;<i> a practical test on a couple of machines.
</I>
Usually you would go for a queue per client, but this is not a rule,
since queues can be shared. YMMV.

&gt;&gt;<i> Note that you do not necessarily need an AMQP instance on machine that
</I>&gt;&gt;<i> clients run on. Multiple remote clients can connect to a single broker
</I>&gt;&gt;<i> instance.
</I>&gt;<i>
</I>&gt;<i> Yes, but for the sake of performance I think that the more I can distribute
</I>&gt;<i> the work load the better.
</I>
Sure, but wouldn't you want the main load to be with the consumers,
i.e. where the real work is being done? The broker is just an
intermdiary that routes messages in an efficient fashion. Under normal
circumstances I would want to be allocating a lot more resources to be
doing the real work rather than distributing it.

Ideally you should be using a small (relative to the workload) number
of Rabbit instances to farm out work to a large number of workers.

This is not to say that you can't have large Rabbit clusters, it's
just that Rabbit, as a communication fabric, shouldn't consume the
lion share of your resources.

&gt;<i> Indeed! The machines are already there and cannot be removed, but with AMQP
</I>&gt;<i> I think that I can let them do more of the work in my system and remove all
</I>&gt;<i> the machines that connect the machines where the consumer processes run.
</I>
You might be interested in a feature of the AMQP spec called basic.qos
which allows for better load balancing. We have not implemented it yet
in Rabbit because of two reasons:

1. It is tricky to get right and verify it's correctness;
2. Few people have asked for it yet.

But we do have a plan of how we'd like to implement it.

&gt;&gt;<i> The size of your broker cluster will depend (amongst other factors) on
</I>&gt;&gt;<i> the amount of messages you need the system to be able to handle.
</I>&gt;<i>
</I>&gt;<i> A system today consisting of 100 &quot;consumer&quot; machines plus some inner
</I>&gt;<i> machines handles in the neighbourhood of 3,000 message per second.
</I>&gt;<i> So when I aim to remove the inner machines that does the most of the
</I>&gt;<i> intelligence regarding routing of the messages I expect to get rid of the
</I>&gt;<i> inner bottleneck and thus get a higher performance... or at least one that
</I>&gt;<i> is closer to the limits of the &quot;consumer&quot; machines which I think is a better
</I>&gt;<i> constraint.
</I>
You may want to check out the performance metrics of a single broker
with a single producer and a single consumer using the ProducerMain
and ConsumerMain test classes from the RabbitMQ Java library, just to
calibrate your expectations for yourself.

&gt;<i> Sorry if I sound a bit vague at times but I have only just read about AMQP
</I>&gt;<i> and are now trying to get the concepts for a new AMQP based architecture in
</I>&gt;<i> place.
</I>
Not a problem. There are various sources of information about the
concepts of AMQP, not least to mention the specification :-)

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001208.html">[rabbitmq-discuss] RabbitMQ/AMQP understanding
</A></li>
	<LI>Next message: <A HREF="001213.html">[rabbitmq-discuss] RabbitMQ/AMQP understanding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1211">[ date ]</a>
              <a href="thread.html#1211">[ thread ]</a>
              <a href="subject.html#1211">[ subject ]</a>
              <a href="author.html#1211">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
