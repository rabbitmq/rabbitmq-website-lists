<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] queue message count
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20queue%20message%20count&In-Reply-To=f9d1f3560808221644q30e16ad4h2580004e0073de3e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001214.html">
   <LINK REL="Next"  HREF="001216.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] queue message count</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20queue%20message%20count&In-Reply-To=f9d1f3560808221644q30e16ad4h2580004e0073de3e%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] queue message count">matthias at lshift.net
       </A><BR>
    <I>Sat Aug 23 18:44:04 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001214.html">[rabbitmq-discuss] queue message count
</A></li>
        <LI>Next message: <A HREF="001216.html">[rabbitmq-discuss] Using RabbitMQ as Messaging Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1219">[ date ]</a>
              <a href="thread.html#1219">[ thread ]</a>
              <a href="subject.html#1219">[ subject ]</a>
              <a href="author.html#1219">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ryan,

Ryan Pratt wrote:
&gt;<i> I am interested in getting total messsage counts for each queue. I want 
</I>&gt;<i> to be able to write a script that monitors the messages per second on 
</I>&gt;<i> the system as a whole and per queue. The stat_all() function gives me a 
</I>&gt;<i> current depth count, but no the total number of messages processed on 
</I>&gt;<i> that queue. Is there a way to get at this value?
</I>
There currently isn't.

&gt;<i>If not, could you give 
</I>&gt;<i> me a pointer on where to start looking for adding it in myself? Thanks!
</I>
It should be fairly easy to maintain a counter of the total number of 
messages handled by a queue. The code for that would have to go into 
rabbit_amqqueue_process.

You'll need to decide on whether you want to count messages on ingress, 
egress or both - the two are different because messages may get redelivered.

You'll also need to decide what the API should look like. You could 
either extend the rabbit_amqqueue:stat/1 function to return the 
additional information, or introduce a new function.

You may also want to think about what other statistics we may want 
queues to gather. That will help in getting the API right. I reckon 
erlang:process_info/{1,2}, mnesia:system_info/1, and mnesia:table_info/2 
are good examples here w.r.t. overall structure.


Regards,

Matthias


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001214.html">[rabbitmq-discuss] queue message count
</A></li>
	<LI>Next message: <A HREF="001216.html">[rabbitmq-discuss] Using RabbitMQ as Messaging Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1219">[ date ]</a>
              <a href="thread.html#1219">[ thread ]</a>
              <a href="subject.html#1219">[ subject ]</a>
              <a href="author.html#1219">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
