<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Flex subscriber
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20Flex%20subscriber&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001248.html">
   <LINK REL="Next"  HREF="001245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Flex subscriber</H1>
    <B>Pete Kay</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20Flex%20subscriber&In-Reply-To="
       TITLE="[rabbitmq-discuss] RabbitMQ Flex subscriber">petedao at gmail.com
       </A><BR>
    <I>Wed Aug 27 07:24:24 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001248.html">[rabbitmq-discuss] Can RabbitMQ actively subscribe to another	server
</A></li>
        <LI>Next message: <A HREF="001245.html">[rabbitmq-discuss] RabbitMQ Flex subscriber
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1244">[ date ]</a>
              <a href="thread.html#1244">[ thread ]</a>
              <a href="subject.html#1244">[ subject ]</a>
              <a href="author.html#1244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I think I am close to getting my Flex code to subscribe to RabbitMQ, but I
am a bit stuck on just one thing.

When connecting using AMPQ Flex lib, I am getting:

Calling handleForcedShutdown from connection
forceClose called

Is there any way I can turn on some kind of logging to see all the messages
going in and out of RabbitMQ to debug this problem?

Could someone please kindly help me out?

Here is my simple Flex code for getting the published messages from the Java
client:

       public class Subscriber implements BasicConsumer {
      protected var x:String = &quot;&quot;;
          protected var q:String = &quot;&quot;;
         protected var x_type:String = &quot;topic&quot;;
         protected var bind_key:String = &quot;*&quot;
         protected var routing_key:String = &quot;SimpleQueue&quot;
         protected var connection:Connection;
         protected var baseSession:Session;
         protected var sessionManager:SessionManager;
         protected var sessionHandler:SessionStateHandler;

         public function Subscriber() {
           init();
   }

   private function init () : void
   {
    trace(&quot;init()&quot;);
    var state:ConnectionState = new ConnectionState();

        state.username = &quot;guest&quot;;
       state.password = &quot;gutes&quot;;
       state.vhostpath = &quot;/&quot;;
       state.serverhost = &quot;192.168.1.104&quot;;
       var connection:Connection = new Connection(state);
       var baseSession:Session = connection.baseSession;
       var sessionManager:SessionManager = connection.sessionManager;
    connection.start();
    baseSession.addEventListener(new OpenOk(), onOpenOk);
   }

   public function onOpenOk(event:ProtocolEvent):void {
    trace(&quot;OpenOK&quot;);
    sessionHandler = sessionManager.create();
    var open:Open = new Open();
    var accessRequest:Request = new Request();
    accessRequest.realm = &quot;/data&quot;;
    accessRequest.passive = true;
    accessRequest.active = true;
    accessRequest.read = true;
    accessRequest.write = true;
    var exchange:org.amqp.methods.exchange.Declare
     = new org.amqp.methods.exchange.Declare();
    exchange.exchange = x;
    exchange.type =x_type;
    var queue:org.amqp.methods.queue.Declare
     = new org.amqp.methods.queue.Declare();
    queue.queue = q;
    var bind:Bind = new Bind();
    bind.exchange = x;
    bind.queue = q;
    bind.routingkey = bind_key;

   sessionHandler.dispatch(new Command(open));
   sessionHandler.dispatch(new Command(accessRequest));
   sessionHandler.dispatch(new Command(exchange));
   sessionHandler.dispatch(new Command(queue));
   sessionHandler.dispatch(new Command(bind));
   sessionHandler.addEventListener(new BindOk(), onBindOk);

  }
  public function onBindOk(event:ProtocolEvent):void{
    trace(&quot;onBindOk called&quot;);
     var consume:Consume = new Consume();
             consume.queue = q;
             consume.noack = true;
             sessionHandler.register(consume, this);
   };

  public function onConsumeOk(tag:String):void {
            //consumerTag = tag;
            trace(&quot;onConsumeOk&quot;);
        }

       public function onCancelOk(tag:String):void {
            trace(&quot;onCancelOk&quot;);
        }
        public function onDeliver(method:Deliver,
                                  properties:BasicProperties,
                                  body:ByteArray):void {
            trace(&quot;onDeliver --&gt; &quot; + body.readUTF());
        }


Thank you very much for all your kind help.

Anne
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080827/0facf3d2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080827/0facf3d2/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001248.html">[rabbitmq-discuss] Can RabbitMQ actively subscribe to another	server
</A></li>
	<LI>Next message: <A HREF="001245.html">[rabbitmq-discuss] RabbitMQ Flex subscriber
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1244">[ date ]</a>
              <a href="thread.html#1244">[ thread ]</a>
              <a href="subject.html#1244">[ subject ]</a>
              <a href="author.html#1244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
