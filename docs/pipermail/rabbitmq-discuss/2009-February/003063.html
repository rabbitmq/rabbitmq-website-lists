<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] STOMP and anonymous queue deletions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20STOMP%20and%20anonymous%20queue%20deletions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003062.html">
   <LINK REL="Next"  HREF="003064.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] STOMP and anonymous queue deletions</H1>
    <B>Dan Di Spaltro</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20STOMP%20and%20anonymous%20queue%20deletions&In-Reply-To="
       TITLE="[rabbitmq-discuss] STOMP and anonymous queue deletions">dan.dispaltro at gmail.com
       </A><BR>
    <I>Thu Feb 19 00:40:37 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003062.html">[rabbitmq-discuss] erlang at facebook
</A></li>
        <LI>Next message: <A HREF="003064.html">[rabbitmq-discuss] STOMP and anonymous queue deletions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3063">[ date ]</a>
              <a href="thread.html#3063">[ thread ]</a>
              <a href="subject.html#3063">[ subject ]</a>
              <a href="author.html#3063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am using a combination of RabbitMQ and the STOMP adapter to create a
comet application, so this means I have a few different clients
talking to rabbit.  Lets back up a bit, I am using the latest
mercurial source of the application.  The first one is the python
Twisted clients using txamqp.  For the most part everything is
straightforward and works very well on the AMQP side.  The second
piece is the javascript piece, (which is routed through orbited).

This piece is working okay.  Mainly my biggest concern is that while I
finally figured out how to use the exchanges correctly from JS and get
all my permissions lined up I now run into a new problem.  That
problem is simply that my private queues I use to route messages to on
the client side don't seem to properly getting cleaned up.  This seems
odd since I mark them in the stomp headers as auto_delete=True yet
they don't clean up.  Here is a bit of output

rabbitmqctl list_queues name auto_delete messages consumers transactions
Listing queues ...
amq.gen-53+dXDPAtlBB/wuKzyMGDg==        true    0       0       0
amq.gen-j+ewTR2zx3PQDCUCGhiWzA==        true    0       0       0
amq.gen-4ma/+dB7D+bvXpEuXWgj0A==        true    0       1       0
amq.gen-3UOPEX7YnpY1cQlG5A+qZA==        true    0       0       0
...

Since there are no consumers and no messages and no transactions
shouldn't queue be destroyed?  Now as a browser app, it is hard to
guarantee things being cleaned up perfectly, so should I consider a
different way of issuing a subscribe?  Below is what I use...
stomp.subscribe('', {exchange:'public-ops',
&quot;routing_key&quot;:'public-'+session,  &quot;auto_delete&quot;:true&quot; });

Now I like the multicast capabilities this brings but I would like the
queue to go away once someone disconnects, is there a setting I am
missing?  Do you need more info?

Thanks for your help!

-- 
Dan Di Spaltro


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003062.html">[rabbitmq-discuss] erlang at facebook
</A></li>
	<LI>Next message: <A HREF="003064.html">[rabbitmq-discuss] STOMP and anonymous queue deletions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3063">[ date ]</a>
              <a href="thread.html#3063">[ thread ]</a>
              <a href="subject.html#3063">[ subject ]</a>
              <a href="author.html#3063">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
