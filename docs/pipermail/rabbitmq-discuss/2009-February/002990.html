<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cluster Pathology
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Cluster%20Pathology&In-Reply-To=269388e30902110932n460831b9rf318bca3c53ce7c1%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002986.html">
   <LINK REL="Next"  HREF="002992.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cluster Pathology</H1>
    <B>Jason J. W. Williams</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Cluster%20Pathology&In-Reply-To=269388e30902110932n460831b9rf318bca3c53ce7c1%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Cluster Pathology">jasonjwwilliams at gmail.com
       </A><BR>
    <I>Wed Feb 11 19:11:26 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002986.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
        <LI>Next message: <A HREF="002992.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2990">[ date ]</a>
              <a href="thread.html#2990">[ thread ]</a>
              <a href="subject.html#2990">[ subject ]</a>
              <a href="author.html#2990">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> - The reason why the consumer does not get notified about the removal
</I>&gt;<i> of a queue (for whatever reason it may have disappeared) is because
</I>&gt;<i> that this behaviour is not specified in the protocol. It is possible
</I>&gt;<i> that this was an oversight, you would have to seek reference from your
</I>&gt;<i> local AMQP representative. In practical terms, this notion has been
</I>&gt;<i> addressed to an extent in the 0-10 version of the protocol, but YMMV.
</I>&gt;<i> Going forwards, this is exactly the kind of thing that needs to get
</I>&gt;<i> nailed down in the 1.0 version of the protocol;
</I>
Well that explains why it doesn't happen. :-)

&gt;<i>
</I>&gt;<i> - Quorum decisions are difficult at the best of times, hence why we
</I>&gt;<i> would need to think long and hard about how to do transparent
</I>&gt;<i> replication;
</I>
While replication would be nice, I don't really mind having to replay
the messages later.

&gt;<i>
</I>&gt;<i> - Replay logic is potentially equally as tricky, once you have
</I>&gt;<i> considered all of the corner cases;
</I>
I can see where it would be tricky, particularly for applications that
resubmitted messages. Personally, we'd like to see it as either a
start-up option (--enable-auto-replay) or a separate utility that can
be pointed at a persister log  with a particular queue name.

&gt;<i>
</I>&gt;<i> I can tell you right now that Rabbit does not currently cater for
</I>&gt;<i> these circumstances OOTB, so if these are hard requirements for you,
</I>&gt;<i> you may want to look somewhere else.
</I>
Unfortunately, there's no where else to go. :-) We wrote our code to
be fairly failure tolerant, and have upgraded the producers to now
also create exchanges/queues/bindings so nothing gets blackholed. As a
result, we'll be able to work around it for this project by deploying
two non-clustered Rabbit instances. It's workable just not optimal.
We'll have to be careful to upgrade the producers queue creation code
any time we add new queues and consumer types. Allowing producers to
be dumb about consumers is really our design target.

&gt;<i>
</I>&gt;<i> If your application could subscribe to AMQP level events OTOH, there
</I>&gt;<i> may be a simple way to solve this issue for you in a protocol
</I>&gt;<i> compliant fashion - for example, we do have patches that allow clients
</I>&gt;<i> to subscribe to presence events. If the above is a not a KO critiereon
</I>&gt;<i> for you, we could look into this option.
</I>
I'll need to research AMQP level events, but yes we can write it in if
py-amqplib can support it.That would be fine.
We don't mind recreating the queues, but consumers need to know
they're orphaned in edge cases.

Thank you so much for your help! I do really appreciate it and do not
mean to be a pain.

-J


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002986.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
	<LI>Next message: <A HREF="002992.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2990">[ date ]</a>
              <a href="thread.html#2990">[ thread ]</a>
              <a href="subject.html#2990">[ subject ]</a>
              <a href="author.html#2990">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
