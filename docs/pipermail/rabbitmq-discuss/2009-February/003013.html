<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cluster Pathology
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Cluster%20Pathology&In-Reply-To=368574aa0902130734h57b10c79y6a280c16534975eb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003012.html">
   <LINK REL="Next"  HREF="003019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cluster Pathology</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Cluster%20Pathology&In-Reply-To=368574aa0902130734h57b10c79y6a280c16534975eb%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Cluster Pathology">0x6e6562 at gmail.com
       </A><BR>
    <I>Fri Feb 13 16:57:32 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003012.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
        <LI>Next message: <A HREF="003019.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3013">[ date ]</a>
              <a href="thread.html#3013">[ thread ]</a>
              <a href="subject.html#3013">[ subject ]</a>
              <a href="author.html#3013">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Drew,

On Fri, Feb 13, 2009 at 3:34 PM, Drew Smathers &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">drew.smathers at gmail.com</A>&gt; wrote:
&gt;<i> Thanks for the information.  The consumer is not as much my concern as
</I>&gt;<i> the publisher (also attached to A) who would continue publishing
</I>&gt;<i> messages which should be delivered but get discarded. (Btw, it's still
</I>&gt;<i> _very_ unclear to me who to get notification that a message cannot be
</I>&gt;<i> routed.)
</I>
IMHO this shouldn't be the producer because this otherwise couples
production and consumption, which is what the messaging broker is
supposed to avoid. I think it should be something else that is
montoring the presence of a queue.

&gt;<i> I'm solving this issue by making publisher attach to only
</I>&gt;<i> one node where the queue is defined so socket errors would stop the
</I>&gt;<i> publisher; this is appropriate for our system where there are very few
</I>&gt;<i> publishers but many consumers.  We're also keeping a rotating log for
</I>&gt;<i> critical messages as another point of recovery in the event a
</I>&gt;<i> persister log cannot be recovered.
</I>
This would be a slightly different issue though. Are you saying that
you are having troubles replaying the log?

&gt;<i> I haven't finalized what to do
</I>&gt;<i> from the consumers' perspective except perhaps having some activity
</I>&gt;<i> monitor with a timeout to trigger reestablishing a channel, queue
</I>&gt;<i> declarations, etc.  Any ideas how to best handle this without to many
</I>&gt;<i> complications such as AMQP-level events, etc?
</I>
ATM you can't do anything because AMQP level events are currently
vaporware :-) The idea behind this is an event system that provides
the necessary primitives for userland code to be able to extend broker
functionality without having to bloat the core. So right now, your
only options are to either build in a supervisor into the broker
(which requires you to hack on the broker), or to do some kind of
external polling.

&gt;&gt;<i> Obviously it would be nice to have better handling for this kind of
</I>&gt;&gt;<i> thing, which will probably happen at some stage.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yes, please :)  If there are significant performance impacts, I think
</I>&gt;<i> it would still be to nice to have as an optional runtime configuration
</I>&gt;<i> for applications where &quot;(99.99999%) guaranteed delivery&quot; is a
</I>&gt;<i> requirement more than overall throughput.
</I>
I'll take this down as something to consider doing. No ETA on this, of course.

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003012.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
	<LI>Next message: <A HREF="003019.html">[rabbitmq-discuss] Cluster Pathology
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3013">[ date ]</a>
              <a href="thread.html#3013">[ thread ]</a>
              <a href="subject.html#3013">[ subject ]</a>
              <a href="author.html#3013">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
