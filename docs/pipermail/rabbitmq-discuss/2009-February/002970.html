<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Q replication anxiety
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Q%20replication%20anxiety&In-Reply-To=00A5C75C-98D0-4367-B254-E06EF49EEA28%40pobox.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002956.html">
   <LINK REL="Next"  HREF="002910.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Q replication anxiety</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Q%20replication%20anxiety&In-Reply-To=00A5C75C-98D0-4367-B254-E06EF49EEA28%40pobox.com"
       TITLE="[rabbitmq-discuss] Q replication anxiety">tonyg at lshift.net
       </A><BR>
    <I>Wed Feb 11 11:40:59 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002956.html">[rabbitmq-discuss] Q replication anxiety
</A></li>
        <LI>Next message: <A HREF="002910.html">[rabbitmq-discuss] STOMP adapter tagged for v1.5.0, v1.5.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2970">[ date ]</a>
              <a href="thread.html#2970">[ thread ]</a>
              <a href="subject.html#2970">[ subject ]</a>
              <a href="author.html#2970">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ben,

You're quite right. While exchanges are stateless and (thus) distributed
across the cluster, queues are stateful and currently implemented in a
non-distributed way. The node to which a client is connected when it
issues a queue.declare that creates a new queue is the node that the
created queue is situated on until it's deleted and recreated.

So long as the disk that the persister log is on (i.e. where the mnesia
data files go) survives, your data will survive.

One potential alternative approach is to create duplicate queues on
separate nodes and consume from both, eliminating duplicates in the
receiving application. That way, if only one queue goes down, the other
keeps routing messages to the consuming application until the broken
system is repaired or replaced.

Regards,
  Tony


Ben Hyde wrote:
&gt;<i> This is causing me anxiety:  &quot;... All data/state required for the  
</I>&gt;<i> operation of a RabbitMQ broker is replicated across all nodes ...  
</I>&gt;<i> exception to this are message queues, which currently only reside on  
</I>&gt;<i> the node that created them ...&quot;[1]
</I>&gt;<i> 
</I>&gt;<i> My setup is on ec2.   My testing randomly kill's machines; in service  
</I>&gt;<i> of assuring the system can self heal.  Obviously I'm going to be  
</I>&gt;<i> miserable if I kill the machines with Q's on them?  I guess i need to  
</I>&gt;<i> be sure the disks the Q's fall onto aren't wiped (which they are today).
</I>&gt;<i> 
</I>&gt;<i> Is my anxiety misplaced, if not then how do others address it.
</I>&gt;<i> 
</I>&gt;<i>   - ben
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="http://www.rabbitmq.com/clustering.html">http://www.rabbitmq.com/clustering.html</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] <A HREF="http://www.lshift.net/">http://www.lshift.net/</A> | Email: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002956.html">[rabbitmq-discuss] Q replication anxiety
</A></li>
	<LI>Next message: <A HREF="002910.html">[rabbitmq-discuss] STOMP adapter tagged for v1.5.0, v1.5.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2970">[ date ]</a>
              <a href="thread.html#2970">[ thread ]</a>
              <a href="subject.html#2970">[ subject ]</a>
              <a href="author.html#2970">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
