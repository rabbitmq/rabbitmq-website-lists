<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] OOM kill
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20OOM%20kill&In-Reply-To=%3C1D910F8A-718A-49E2-BCE4-7E934F307AC9%40alertme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034403.html">
   <LINK REL="Next"  HREF="034380.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] OOM kill</H1>
    <B>Dmitry Andrianov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20OOM%20kill&In-Reply-To=%3C1D910F8A-718A-49E2-BCE4-7E934F307AC9%40alertme.com%3E"
       TITLE="[rabbitmq-discuss] OOM kill">dmitry.andrianov at alertme.com
       </A><BR>
    <I>Sat Mar  8 19:19:43 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034403.html">[rabbitmq-discuss] OOM kill
</A></li>
        <LI>Next message: <A HREF="034380.html">[rabbitmq-discuss] OOM kill
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34407">[ date ]</a>
              <a href="thread.html#34407">[ thread ]</a>
              <a href="subject.html#34407">[ subject ]</a>
              <a href="author.html#34407">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I understand.

However only fixed limit policy can be easily implemented by 3rd party firewall. Only Rabbit itself can implement free-memory based policies when it stops accepting connection when memory drops below a threshold. (Well, firewall can of course poll Rabbit status regularly and change its behaviour based on current memory consumption but it does not look very reliable and also introduces a delay so won't be able to react on a sudden spike of connections)

Cheers

&gt;<i> On 8 Mar 2014, at 17:08, Matthias Radestock &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> On 08/03/14 16:38, Dmitry Andrianov wrote:
</I>&gt;&gt;<i> I just know that server process dying completely is a very bad thing
</I>&gt;&gt;<i> to happen.
</I>&gt;<i> 
</I>&gt;<i> Indeed. but note that in your case the server didn't die off its own accord; it was bumped off by the OOM killer.
</I>&gt;<i> 
</I>&gt;<i> With ulimits, channel limits and buffer sizes configured carefully, and restrictions in place for exchange/binding/queue creation, you can certainly prevent rabbit from breaching memory limits.
</I>&gt;<i> 
</I>&gt;&gt;<i> So if I was able to extend Rabbit, I would be thinking of adding
</I>&gt;&gt;<i> something like a limiting policy to every tcp listener. So for
</I>&gt;&gt;<i> internal port (inaccessible from internet) I would not set any limits
</I>&gt;&gt;<i> while on the ssl listener (accessible from the internet) I would
</I>&gt;&gt;<i> configure a limiting policy either with fixed limit (say 10k
</I>&gt;&gt;<i> connections) or memory-based policy (start limiting connections when
</I>&gt;&gt;<i> memory is low).
</I>&gt;<i> 
</I>&gt;<i> Right. This is achievable with common firewall products.
</I>&gt;<i> 
</I>&gt;&gt;<i> Something like that. But from Michael's words I understand that it is
</I>&gt;&gt;<i> not something you need yourself or think is needed by the community
</I>&gt;&gt;<i> because it is not how Rabbit is supposed to be used.
</I>&gt;<i> 
</I>&gt;<i> We are in fact quite keen to improve rabbit to make it more bullet proof. We have long-standing bugs open in our tracker for the issues you raised. But any solution we come up with must a) cover a broad spectrum of use cases, b) not be easily handled by off-the-shelf companion products like firewalls.
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Matthias
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>This email is for the use of the intended recipient(s) only.
If you have received this email in error, please notify the sender immediately and then delete it.
If you are not the intended recipient, you must not use, disclose or distribute this email without the
author's prior permission. AlertMe.com Ltd. is not responsible for any personal views expressed
in this message or any attachments that are those of the individual sender.

AlertMe.com Ltd, 30 Station Road, Cambridge, CB1 2RE, UK.
Registered in England, Company number 578 2908, VAT registration number GB 895 9914 42.


</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034403.html">[rabbitmq-discuss] OOM kill
</A></li>
	<LI>Next message: <A HREF="034380.html">[rabbitmq-discuss] OOM kill
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34407">[ date ]</a>
              <a href="thread.html#34407">[ thread ]</a>
              <a href="subject.html#34407">[ subject ]</a>
              <a href="author.html#34407">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
