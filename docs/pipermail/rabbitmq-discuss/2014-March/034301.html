<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Garbage collection of queues and exchanges
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Garbage%20collection%20of%20queues%20and%20exchanges&In-Reply-To=%3CCAMZ8XChku3GxndZ68ACS2oYVd5SPe0xdFkzf6eKreFS3FEyhaQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034300.html">
   <LINK REL="Next"  HREF="034302.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Garbage collection of queues and exchanges</H1>
    <B>Michael Bridgen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Garbage%20collection%20of%20queues%20and%20exchanges&In-Reply-To=%3CCAMZ8XChku3GxndZ68ACS2oYVd5SPe0xdFkzf6eKreFS3FEyhaQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Garbage collection of queues and exchanges">mikeb at squaremobius.net
       </A><BR>
    <I>Tue Mar  4 14:47:44 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034300.html">[rabbitmq-discuss] RabbitMQ 3.2.4 released
</A></li>
        <LI>Next message: <A HREF="034302.html">[rabbitmq-discuss] java.net.SocketException: Connection reset
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34301">[ date ]</a>
              <a href="thread.html#34301">[ thread ]</a>
              <a href="subject.html#34301">[ subject ]</a>
              <a href="author.html#34301">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In the Node.JS module rabbit.js[1], the main abstractions are various
kinds of socket (which are Node.JS streams[2]) that publish or
(sometimes and) consume to and from exchanges and queues hosted in
RabbitMQ. The sockets, like AMQP connections, are expected to be
fairly long-lived, and more so the server objects to which they refer,
since they may be mentioned by a number of sockets with overlapping
lifetimes.

For example, a socket might connect to &quot;events&quot;, which implicitly
creates an exchange called &quot;events&quot;, and sends everything written to
the socket, to that exchange. Simple stuff. Here is the snag: when
there are no longer sockets connected to &quot;events&quot;, I want the exchange
&quot;events&quot; to go away.

If those sockets are consuming from private queues bound to &quot;events&quot;,
I can make those queues exclusive, or mark them as auto-delete, or
give them a TTL. But if a socket is *publishing* to &quot;events&quot;, there's
no relationship between the socket and the exchange, so there's
nothing that happens to signal that the exchange is no longer being
used. This applies equally to sending to queues, and in fact in the
case of sending to queues, rules out the use of auto-delete etc for
consumers of those queues.

I would think this is a problem with AMQP in general. I wonder, aloud
in a public forum, if there are any tactics people have come up with
to get around it.

-Michael

[1] <A HREF="https://github.com/squaremo/rabbit.js">https://github.com/squaremo/rabbit.js</A>
[2] <A HREF="http://nodejs.org/api/stream.html">http://nodejs.org/api/stream.html</A>
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034300.html">[rabbitmq-discuss] RabbitMQ 3.2.4 released
</A></li>
	<LI>Next message: <A HREF="034302.html">[rabbitmq-discuss] java.net.SocketException: Connection reset
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34301">[ date ]</a>
              <a href="thread.html#34301">[ thread ]</a>
              <a href="subject.html#34301">[ subject ]</a>
              <a href="author.html#34301">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
