<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Odd behavior where server stops responding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Odd%20behavior%20where%20server%20stops%20responding&In-Reply-To=%3C2292C621-BB78-4491-89D0-75137BD7BF23%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034494.html">
   <LINK REL="Next"  HREF="034524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Odd behavior where server stops responding</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Odd%20behavior%20where%20server%20stops%20responding&In-Reply-To=%3C2292C621-BB78-4491-89D0-75137BD7BF23%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Odd behavior where server stops responding">tim at rabbitmq.com
       </A><BR>
    <I>Wed Mar 12 09:39:00 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034494.html">[rabbitmq-discuss] Odd behavior where server stops responding
</A></li>
        <LI>Next message: <A HREF="034524.html">[rabbitmq-discuss] Odd behavior where server stops responding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34518">[ date ]</a>
              <a href="thread.html#34518">[ thread ]</a>
              <a href="subject.html#34518">[ subject ]</a>
              <a href="author.html#34518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 11 Mar 2014, at 16:41, Jason McIntosh wrote:

&gt;<i> This may be a 3.0.4-1 issue (or erlang esl-erlang-R15B03-2.x86_64) and I just may need to upgrade rabbit but I thought I'd see if anyone had seen this before.  This is on oracle enterprise linux 6.2.  
</I>&gt;<i> 
</I>&gt;<i> A few days after a software raid filesystem check (may or not be related, only thing I can see that's common), on three separate servers, rabbit just completely hung.  I couldn't even do an LSOF on any file system.  
</I>
That sounds like the OS hung not rabbit?

&gt;<i> The port was still responsive, but the rabbit process itself was completely hung.  CPU use jumped up to 25% on the beam process and just stayed there...
</I>
25% isn't exactly massive, though if the spike in CPU wasn't associated with an increase in messaging traffic then something could be wrong.

&gt;<i>  I killed all the rabbit processes and tried to restart them.  There was nothing in the logs and the startup failed
</I>
How did it fail? Non-zero return code(s) or more?

&gt;<i> I killed everything again, including the EPMD process and then rabbit was finally able to start.  With-in a few moments though the beam hung again - I see a few connections show in the logs and then the process is non-responsive.
</I>
How did the beam process hang and in what way did the broker become unresponsive? How are you trying to interact with the broker? Are we talking about rabbitmqctl commands not responding, or something else?

&gt;<i> 
</I>&gt;<i> I'm GUESSING this is an OS level issue, and I'd swear I've seen this before.
</I>
I've not heard of this before either. If you can get a rabbit node up and running then we may be able to run some diagnostic commands, depending on whether or not rabbitmqctl commands are working (or not). There are other ways to access a console on a running node too, though they're a bit more involved.

&gt;<i>  I've had to do a full restart of the server to get things back to a decent state.  Anyone have any advice/ideas?
</I>&gt;<i> 
</I>
Please clarify what we mean by hung and non-responsive. Also, do you now have the broker running without any of these issues? Can you fire up a standalone (test) node in a VM or some such, run the broker (successfully) on it and re-run the raid check to see if it causes the same problem?

It would be good to get to the bottom of this, though clearly without any logs it's going to be tricky.

Cheers,
Tim

</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034494.html">[rabbitmq-discuss] Odd behavior where server stops responding
</A></li>
	<LI>Next message: <A HREF="034524.html">[rabbitmq-discuss] Odd behavior where server stops responding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34518">[ date ]</a>
              <a href="thread.html#34518">[ thread ]</a>
              <a href="subject.html#34518">[ subject ]</a>
              <a href="author.html#34518">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
