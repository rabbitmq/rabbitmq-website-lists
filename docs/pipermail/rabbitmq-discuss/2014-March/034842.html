<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] badmatch when unbinding queue in web management
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20badmatch%20when%20unbinding%20queue%20in%20web%0A%20management&In-Reply-To=%3CF9E85480F62349458DF67CE8BA000D8D3FC64FDD%40FR44EX3005.global.ds.honeywell.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034841.html">
   <LINK REL="Next"  HREF="034880.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] badmatch when unbinding queue in web management</H1>
    <B>Gotthard, Petr</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20badmatch%20when%20unbinding%20queue%20in%20web%0A%20management&In-Reply-To=%3CF9E85480F62349458DF67CE8BA000D8D3FC64FDD%40FR44EX3005.global.ds.honeywell.com%3E"
       TITLE="[rabbitmq-discuss] badmatch when unbinding queue in web management">Petr.Gotthard at Honeywell.com
       </A><BR>
    <I>Fri Mar 28 11:36:51 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034841.html">[rabbitmq-discuss] badmatch when unbinding queue in web	management
</A></li>
        <LI>Next message: <A HREF="034880.html">[rabbitmq-discuss] badmatch when unbinding queue in web	management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34842">[ date ]</a>
              <a href="thread.html#34842">[ thread ]</a>
              <a href="subject.html#34842">[ subject ]</a>
              <a href="author.html#34842">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm not sure this is the case; we don't have multiple identical bindings with different arguments.


In the meantime we discovered the scenario that causes the web unbinds to fail:
 -- client creates a binding with some parameters
 -- clients unbinds with different parameters (which will fail) and disconnects immediately

It seems that if I disconnect before the failed unbind is fully processed, the queue is left in some strange state. In this state the queue remains &quot;active&quot; forever and cannot be deleted.
Even the standard broker shutdown doesn't work and it is necessary to kill the broker by brute force (-9). After the broker is restarted, the queue can be deleted without any troubles. It almost looks as a way to cripple the broker using a standard AMQP client (a possible DOS attack?).

On the other hand, if there is some wait/sleep between the wrong unbind and the disconnection, everything works fine. This makes me believe there is some race condition in the &quot;wrong unbind-disconnect&quot; scenario.


Petr

-----Original Message-----
From: Simon MacMullen [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>] 
Sent: 28. b&#345;ezna 2014 11:25
To: Discussions about RabbitMQ
Cc: Gotthard, Petr
Subject: Re: [rabbitmq-discuss] badmatch when unbinding queue in web management

On 28/03/14 08:37, Gotthard, Petr wrote:
&gt;<i> Do you have any idea what could be wrong?
</I>
Yes, there's a bug in topic exchanges which is seen when they have 
multiple bindings which have identical source, destination and routing 
key but differ in arguments.

This bug was introduced in 2.4.0 with fast topic routing, and has been 
fixed in hg but has not made it into a release yet - it will be fixed in 
3.3.0 when that comes out.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034841.html">[rabbitmq-discuss] badmatch when unbinding queue in web	management
</A></li>
	<LI>Next message: <A HREF="034880.html">[rabbitmq-discuss] badmatch when unbinding queue in web	management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34842">[ date ]</a>
              <a href="thread.html#34842">[ thread ]</a>
              <a href="subject.html#34842">[ subject ]</a>
              <a href="author.html#34842">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
