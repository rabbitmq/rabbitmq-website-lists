<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit slowing down on accepting messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20slowing%20down%20on%20accepting%20messages&In-Reply-To=%3CCAFtA53xLxNQtC3mVO79%2BpCLoq7bk1QJhtU%3DC4%2BB_vcDfg88CUw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034676.html">
   <LINK REL="Next"  HREF="034678.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit slowing down on accepting messages</H1>
    <B>Ron Cordell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20slowing%20down%20on%20accepting%20messages&In-Reply-To=%3CCAFtA53xLxNQtC3mVO79%2BpCLoq7bk1QJhtU%3DC4%2BB_vcDfg88CUw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbit slowing down on accepting messages">ron.cordell at gmail.com
       </A><BR>
    <I>Wed Mar 19 16:27:59 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034676.html">[rabbitmq-discuss] AMQP closed connection error
</A></li>
        <LI>Next message: <A HREF="034678.html">[rabbitmq-discuss] Rabbit slowing down on accepting messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34677">[ date ]</a>
              <a href="thread.html#34677">[ thread ]</a>
              <a href="subject.html#34677">[ subject ]</a>
              <a href="author.html#34677">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

During our performance testing yesterday we saw some interesting behavior.
The setup is:

RabbitMQ x 3 nodes, clustered, behind a load balancer, running on Linux,
Erlang 16B03, Rabbit 3.2.3. RabbitMQ nodes running on VMWare ESX 4.5

What we observed was a run in the morning publishing and consuming a
sustained rate of 140K messages/hour across 150 mirrored queues (good).
The application was shut down, all connections to Rabbit were observed to
drop to 0.
An hour or two passes while the team does other things.
The application was brought back up, connections re-established, and
another test run kicked off.
This time the max sustained rate is about 65K messages/hour (bad). The
reason was narrowed down to Rabbit not accepting published messages any
faster than that.
Disk I/O was checked - we're on a very fast SAN and there was no issue.
Load balancer was checked, it's not preventing the issue.
Finally, the RabbitMQ nodes were stopped and restarted and another test run
was made, and suddenly we are back up to 140K messages/hour.
The logs show no memory alarms or flow control messages - in fact the logs
are &quot;clean&quot;.

Any suggestions on places to look to see what the underlying issue might be?

In real life I don't expect to start and stop applications, so this may or
may not be a concern, but we are very curious about the observed behavior.

Cheers,

Ron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140319/c53afac5/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140319/c53afac5/attachment.html</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034676.html">[rabbitmq-discuss] AMQP closed connection error
</A></li>
	<LI>Next message: <A HREF="034678.html">[rabbitmq-discuss] Rabbit slowing down on accepting messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34677">[ date ]</a>
              <a href="thread.html#34677">[ thread ]</a>
              <a href="subject.html#34677">[ subject ]</a>
              <a href="author.html#34677">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
