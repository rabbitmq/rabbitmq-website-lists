<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Spring%20amqp%20-%20auto%20acknowledge%20from%20consumer%0A%20taking%20almost%20a%20minute&In-Reply-To=%3CCF5B3359.2370D%25anita.yip%40realpage.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034848.html">
   <LINK REL="Next"  HREF="034852.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute</H1>
    <B>Anita Yip</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Spring%20amqp%20-%20auto%20acknowledge%20from%20consumer%0A%20taking%20almost%20a%20minute&In-Reply-To=%3CCF5B3359.2370D%25anita.yip%40realpage.com%3E"
       TITLE="[rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute">Anita.Yip at RealPage.com
       </A><BR>
    <I>Fri Mar 28 21:09:05 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034848.html">[rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute
</A></li>
        <LI>Next message: <A HREF="034852.html">[rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34851">[ date ]</a>
              <a href="thread.html#34851">[ thread ]</a>
              <a href="subject.html#34851">[ subject ]</a>
              <a href="author.html#34851">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The only problem is my consumer has heavy processing, and the messages are hanging in the queue, the queue size keep growing thus finally resulting in Out of Memory error.

From: Gary Russell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">grussell at gopivotal.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">grussell at gopivotal.com</A>&gt;&gt;
Reply-To: Discussions about RabbitMQ &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Date: Friday, March 28, 2014 1:56 PM
To: Discussions about RabbitMQ &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Subject: Re: [rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute

Your requirements seem to be a little unusual - you want the consumer to ack as soon as you get the message but before the processing completes.

What if your consumer dies right after it acks - you'll still lose the message in that case.

If you don't care about that situation, simply hand off the task to another thread in your listener and the container will ack the message right after the handoff (with ackmode AUTO).

What is the objection to it being &quot;unacked&quot; until the consumer completes the work?

Gary


On Fri, Mar 28, 2014 at 4:49 PM, Anita Yip &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Anita.Yip at realpage.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Anita.Yip at realpage.com</A>&gt;&gt; wrote:
Does that mean no explicit acknowledgement is sent by consumer? What if
the message is lost before it reaches the consumer? When will the message
be removed from the queue in this case?



On 3/28/14 12:06 AM, &quot;Michael Klishin&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt;&gt; wrote:

&gt;<i>On 28 March 2014 at 10:06:21, Anita Yip (<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">anita.yip at realpage.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">anita.yip at realpage.com</A>&gt;) wrote:
</I>&gt;&gt;<i> &gt; I see all the messages falling under &quot;Deliver (noack)&quot;. Doesn't
</I>&gt;&gt;<i> this mean that RabbitMq is not expecting/processing any
</I>&gt;&gt;<i>acknowledgements
</I>&gt;&gt;<i> from the consumer?
</I>&gt;<i>
</I>&gt;<i>Correct. A message is then considered to be processed  as soon as RabbitMQ
</I>&gt;<i>sends it out.
</I>&gt;<i>--
</I>&gt;<i>MK
</I>&gt;<i>
</I>&gt;<i>Software Engineer, Pivotal/RabbitMQ
</I>&gt;<i>_______________________________________________
</I>&gt;<i>rabbitmq-discuss mailing list
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

________________________________

This message is intended only for the use of the individual(s) or entity to which it is addressed and may contain information that is privileged, confidential, and/or proprietary to RealPage and its affiliated companies. If the reader of this message is not the intended recipient, you are hereby notified that any dissemination, distribution, forwarding or copying of this communication is prohibited without the express permission of the sender. If you have received this communication in error, please notify the sender immediately and delete the original message.
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>


________________________________

This message is intended only for the use of the individual(s) or entity to which it is addressed and may contain information that is privileged, confidential, and/or proprietary to RealPage and its affiliated companies. If the reader of this message is not the intended recipient, you are hereby notified that any dissemination, distribution, forwarding or copying of this communication is prohibited without the express permission of the sender. If you have received this communication in error, please notify the sender immediately and delete the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140328/7af3cc9b/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140328/7af3cc9b/attachment.html</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034848.html">[rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute
</A></li>
	<LI>Next message: <A HREF="034852.html">[rabbitmq-discuss] Spring amqp - auto acknowledge from consumer taking almost a minute
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34851">[ date ]</a>
              <a href="thread.html#34851">[ thread ]</a>
              <a href="subject.html#34851">[ subject ]</a>
              <a href="author.html#34851">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
