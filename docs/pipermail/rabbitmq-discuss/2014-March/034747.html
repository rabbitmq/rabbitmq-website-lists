<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20windows%20service%20says%20it%27s%20started%0A%20when%20it%20isn%27t%20ready&In-Reply-To=%3CCAH%2BxwdDgo5AB5m0sSpNPi9479CdijXOBbhf3F0wBWLrRgbo7vw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034746.html">
   <LINK REL="Next"  HREF="034754.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready</H1>
    <B>Robert Raschke</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20windows%20service%20says%20it%27s%20started%0A%20when%20it%20isn%27t%20ready&In-Reply-To=%3CCAH%2BxwdDgo5AB5m0sSpNPi9479CdijXOBbhf3F0wBWLrRgbo7vw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready">rtrlists at googlemail.com
       </A><BR>
    <I>Mon Mar 24 15:50:44 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034746.html">[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
</A></li>
        <LI>Next message: <A HREF="034754.html">[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34747">[ date ]</a>
              <a href="thread.html#34747">[ thread ]</a>
              <a href="subject.html#34747">[ subject ]</a>
              <a href="author.html#34747">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mat,

this is a consequence of how the Windows Service is started. The erlsrv.exe
reports back to Windows when Erlang has been started. But this in no way
means that the application running in the Erlang VM has also finished
starting.

Incidentally, this is the way a lot of systems start up. JBoss startup has
the exact same issue. Although calling it an issue is debatable :-)

Two ways forward are: 1. Application level interface that allows you to
query if your system is up and open for business. 2. Put sleeps into the
startup sequence, which appears to be a common remedy, unfortunately. 3.
Ignore errors on startup and retry until stable.

Hope this helps,
Robby
 I'm using RabbitMQ 3.2.1, Erlang R16B02

The issue described in the subject causes problems for other services which
depend on RabbitMQ

For instance if I have windows service X which has a dependency configured
for the RabbitMQ windows service then when I start X the RabbitMQ service
will be started first

However the RabbitMQ service reports that it's started before it's ready to
accept connections

Hence when service X tries to start it finds it cannot connect to RabbitMQ

This is mostly a problem when the machine is restarted as the services
which depend on RabbitMQ may fail to start

Is this a bug in RabbitMQ's windows service? Is there any way to allow
dependencies to work?

Any other suggestion also welcome, although I really want to avoid the
equivalent of sleeps

Thanks,
Mat B

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140324/d7c01c86/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140324/d7c01c86/attachment.html</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034746.html">[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
</A></li>
	<LI>Next message: <A HREF="034754.html">[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34747">[ date ]</a>
              <a href="thread.html#34747">[ thread ]</a>
              <a href="subject.html#34747">[ subject ]</a>
              <a href="author.html#34747">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
