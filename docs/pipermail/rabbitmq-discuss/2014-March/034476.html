<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ: Different consumer technique
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%3A%20Different%20consumer%20technique&In-Reply-To=%3CCF434128.10F44%25aapte%40zynga.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034473.html">
   <LINK REL="Next"  HREF="034479.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ: Different consumer technique</H1>
    <B>Ajinkya Apte</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%3A%20Different%20consumer%20technique&In-Reply-To=%3CCF434128.10F44%25aapte%40zynga.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ: Different consumer technique">aapte at zynga.com
       </A><BR>
    <I>Mon Mar 10 17:15:30 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034473.html">[rabbitmq-discuss] RabbitMQ: Different consumer technique
</A></li>
        <LI>Next message: <A HREF="034479.html">[rabbitmq-discuss] CPU usage on idle server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34476">[ date ]</a>
              <a href="thread.html#34476">[ thread ]</a>
              <a href="subject.html#34476">[ subject ]</a>
              <a href="author.html#34476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yeh I thought about it a little more and just using the technique where the server pushes changes to the consumer makes most sense here. Thanks for the quick reply Jason.

AJ

From: Jason McIntosh &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mcintoshj at gmail.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mcintoshj at gmail.com</A>&gt;&gt;
Reply-To: Discussions about RabbitMQ &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Date: Monday, March 10, 2014 9:15 AM
To: Discussions about RabbitMQ &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Subject: Re: [rabbitmq-discuss] RabbitMQ: Different consumer technique

Seems like a lot of heavy lifting for a consumer process.  If you use the alternative where rabbit pushes changes to your consumer (instead of basic_get), then rabbit will push new messages as they come in to your consumer, and the consumer will be idle otherwise using minimal resources.  For &quot;basic.get_batch&quot; - that's exactly what the prefetch count does on consumers - get 10 messages at once and process them.  Is there some particularly need to wrap it in all the extra layers?
Jason


On Mon, Mar 10, 2014 at 10:43 AM, Ajinkya Apte &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aapte at zynga.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aapte at zynga.com</A>&gt;&gt; wrote:
(First time user of RabbitMQ)
Hey,
Technique:
Rather than writing a standalone PHP consumer script that keeps consuming the queue, I was planning on writing a batch get and quit PHP script. All that script does is get a batch of 10 from the queue, if the batch isn't available the script immediately exits. If available, it processes the batch and quits. I use a python script to make multiple calls to my 'Get Batch script' and make use of apache workers to do the work rather than making the php standalone script do the work.

Questions:
1. Firstly, do you see a reason why I should not think about consuming the queue this way?
2. (I am using the amq php lib) How can I do a batch get and exit if the batch is not present. With what I have learnt seems like I can set the qos to my batch count and use batch_consume for this. But if the batch is not available the script seems to wait till the batch is available. Is there a way I can timeout?
3. Do you have any usage recommendation for me?
4. Any plans of having basic.get_batch?

AJ

Sent from my iPhone

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>



--
Jason McIntosh
<A HREF="https://github.com/jasonmcintosh/">https://github.com/jasonmcintosh/</A>
573-424-7612
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140310/46c69ccb/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140310/46c69ccb/attachment.html</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034473.html">[rabbitmq-discuss] RabbitMQ: Different consumer technique
</A></li>
	<LI>Next message: <A HREF="034479.html">[rabbitmq-discuss] CPU usage on idle server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34476">[ date ]</a>
              <a href="thread.html#34476">[ thread ]</a>
              <a href="subject.html#34476">[ subject ]</a>
              <a href="author.html#34476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
