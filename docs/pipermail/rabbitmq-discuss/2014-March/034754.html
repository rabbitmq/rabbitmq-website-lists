<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20windows%20service%20says%20it%27s%20started%0A%20when%20it%20isn%27t%20ready&In-Reply-To=%3CCAD4N5E_%3DwFjWzd%2BQ3NWY49GyDSc97UGj-Z_3OPzD%3Dk1L%3DEkxdQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="034747.html">
   <LINK REL="Next"  HREF="034766.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready</H1>
    <B>Mat Burton</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20windows%20service%20says%20it%27s%20started%0A%20when%20it%20isn%27t%20ready&In-Reply-To=%3CCAD4N5E_%3DwFjWzd%2BQ3NWY49GyDSc97UGj-Z_3OPzD%3Dk1L%3DEkxdQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready">matburton at gmail.com
       </A><BR>
    <I>Mon Mar 24 20:23:56 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="034747.html">[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
</A></li>
        <LI>Next message: <A HREF="034766.html">[rabbitmq-discuss] Federation/Connection issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34754">[ date ]</a>
              <a href="thread.html#34754">[ thread ]</a>
              <a href="subject.html#34754">[ subject ]</a>
              <a href="author.html#34754">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Rob,

Thanks for the quick response

We use our message bus to report diagnostic data which means option 3 isn't
really an option.
We wouldn't know when a service somewhere was started but dead in the water
until our monitoring system noticed a lack of activity later.
Worse we could miss real error reports etc because we'd have no where to
send them if we started without a stable connection.

I guess we'll have to use option 2 and leave our services in a starting
state until they manage to connect to RabbitMQ.
I believe a service can request an additional minute of starting time
upfront, which should be sufficient in most cases.

Many thanks,
Mat B


On 24 March 2014 15:50, Robert Raschke &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rtrlists at googlemail.com</A>&gt; wrote:

&gt;<i> Hi Mat,
</I>&gt;<i>
</I>&gt;<i> this is a consequence of how the Windows Service is started. The
</I>&gt;<i> erlsrv.exe reports back to Windows when Erlang has been started. But this
</I>&gt;<i> in no way means that the application running in the Erlang VM has also
</I>&gt;<i> finished starting.
</I>&gt;<i>
</I>&gt;<i> Incidentally, this is the way a lot of systems start up. JBoss startup has
</I>&gt;<i> the exact same issue. Although calling it an issue is debatable :-)
</I>&gt;<i>
</I>&gt;<i> Two ways forward are: 1. Application level interface that allows you to
</I>&gt;<i> query if your system is up and open for business. 2. Put sleeps into the
</I>&gt;<i> startup sequence, which appears to be a common remedy, unfortunately. 3.
</I>&gt;<i> Ignore errors on startup and retry until stable.
</I>&gt;<i>
</I>&gt;<i> Hope this helps,
</I>&gt;<i> Robby
</I>&gt;<i>  I'm using RabbitMQ 3.2.1, Erlang R16B02
</I>&gt;<i>
</I>&gt;<i> The issue described in the subject causes problems for other services
</I>&gt;<i> which depend on RabbitMQ
</I>&gt;<i>
</I>&gt;<i> For instance if I have windows service X which has a dependency configured
</I>&gt;<i> for the RabbitMQ windows service then when I start X the RabbitMQ service
</I>&gt;<i> will be started first
</I>&gt;<i>
</I>&gt;<i> However the RabbitMQ service reports that it's started before it's ready
</I>&gt;<i> to accept connections
</I>&gt;<i>
</I>&gt;<i> Hence when service X tries to start it finds it cannot connect to RabbitMQ
</I>&gt;<i>
</I>&gt;<i> This is mostly a problem when the machine is restarted as the services
</I>&gt;<i> which depend on RabbitMQ may fail to start
</I>&gt;<i>
</I>&gt;<i> Is this a bug in RabbitMQ's windows service? Is there any way to allow
</I>&gt;<i> dependencies to work?
</I>&gt;<i>
</I>&gt;<i> Any other suggestion also welcome, although I really want to avoid the
</I>&gt;<i> equivalent of sleeps
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Mat B
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140324/91520b8d/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140324/91520b8d/attachment.html</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="034747.html">[rabbitmq-discuss] RabbitMQ windows service says it's started when it isn't ready
</A></li>
	<LI>Next message: <A HREF="034766.html">[rabbitmq-discuss] Federation/Connection issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#34754">[ date ]</a>
              <a href="thread.html#34754">[ thread ]</a>
              <a href="subject.html#34754">[ subject ]</a>
              <a href="author.html#34754">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
