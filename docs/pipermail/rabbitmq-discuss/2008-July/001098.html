<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Load%20balancing%20with%20multiple%20consumers%20on%0A%20a%09single%20queue&In-Reply-To=b307b5520807300133y36bfd65dp607cb68dcb566c8a%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001097.html">
   <LINK REL="Next"  HREF="001101.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue</H1>
    <B>David.Corcoran at edftrading.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Load%20balancing%20with%20multiple%20consumers%20on%0A%20a%09single%20queue&In-Reply-To=b307b5520807300133y36bfd65dp607cb68dcb566c8a%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue">David.Corcoran at edftrading.com
       </A><BR>
    <I>Wed Jul 30 12:39:46 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001097.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
        <LI>Next message: <A HREF="001101.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1098">[ date ]</a>
              <a href="thread.html#1098">[ thread ]</a>
              <a href="subject.html#1098">[ subject ]</a>
              <a href="author.html#1098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> wrote on 30/07/2008 09:33:19:


&gt;<i> The round-robin nature of message deliveries is great for load
</I>&gt;<i> balancing if all our jobs require equal processing time but this is
</I>&gt;<i> not the case.. jobs can range anywhere from a few seconds to a
</I>&gt;<i> minute worth of processing.
</I>

Hey Nathan,

We're having the exact same problem. We have jobs of varying lengths and we
don't know how long each will take before we send it off. Some jobs can
take a few ms and others 5 minutes. So we can't do different queues for
different length jobs. One way we were looking at doing it is when a
consumer has an empty queue it sends to a topic saying so. If another
consumer has multiple jobs in its queue it negative acks the extra jobs and
lets rabbitmq redistribute them more evenly. The problem with this is that
we can't find a mechanism to negative ack. Cancelling the consumer, as you
pointed out, doesn't work because you have to ack first. We can't do this
because we could lose a job that way.

The rabbitmq javadocs have classes called AMQP.Basic.Reject and
AMQP.Basic.Return that look like they might do the job but unfortunately
they are not commented so I'm not sure if they're what I'm looking for. It
would be great if they could be used to selectively Nak.

&gt;<i> This was done using Barry Pederson's amqplib-0.3 library in Python.
</I>
I use the java library and it looks like ChannelN.java could do a basicNak
in the same way it does a basicAck. I'm going to test this later. Perhaps
it's the same with the python library.

Dave




*********************************************************************
This communication contains confidential information, some or all of which may be privileged. It is for the intended recipient only and others must not disclose, distribute, copy, print or rely on this communication. If an addressing or transmission error has misdirected this communication, please notify the sender by replying to this e-mail and then delete the e-mail. E-mail sent to EDF Trading may be monitored by the company. Thank you. 
EDF Trading Limited
80 Victoria Street, 3rd Floor, Cardinal Place, London, SW1E 5JL
A Company registered in England No. 4255974. 
Switchboard: 020 7061 4000
EDF Trading Markets Limited is a member of the EDF Trading Limited Group and is authorised and regulated by the Financial Services Authority.
VAT number: GB 735 5479 07
*********************************************************************


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001097.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
	<LI>Next message: <A HREF="001101.html">[rabbitmq-discuss] Load balancing with multiple consumers on a	single queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1098">[ date ]</a>
              <a href="thread.html#1098">[ thread ]</a>
              <a href="subject.html#1098">[ subject ]</a>
              <a href="author.html#1098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
