<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] python client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20python%20client&In-Reply-To=46E02343.5010802%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000202.html">
   <LINK REL="Next"  HREF="000208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] python client</H1>
    <B>Dmitriy Samovskiy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20python%20client&In-Reply-To=46E02343.5010802%40lshift.net"
       TITLE="[rabbitmq-discuss] python client">dmitriy.samovskiy at cohesiveft.com
       </A><BR>
    <I>Fri Sep  7 20:05:02 BST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000202.html">[rabbitmq-discuss] python client
</A></li>
        <LI>Next message: <A HREF="000208.html">[rabbitmq-discuss] Gentoo ebuilds?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#206">[ date ]</a>
              <a href="thread.html#206">[ thread ]</a>
              <a href="subject.html#206">[ subject ]</a>
              <a href="author.html#206">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

Thanks for the link below - I saw that section before, but now I re-read 
it and was able to get it working.

Edwin,

The key is to use original amqp 0.8 xml spec, not the one in qpid trunk. 
Download link is at URL that Matthias provided below.

The code below does not raise an exception. I am just starting working 
with rabbitmq and I still don't understand all details of what this code 
does, but at least it works.

#----------------------------------

#!/usr/bin/python

QPID_PATH = '/usr/local/qpid-svn/qpid'

import sys, os, time
sys.path += [ QPID_PATH + '/python' ]

import qpid
from qpid.client import Client
from qpid.content import Content

client = Client(&quot;127.0.0.1&quot;, 5672, spec=qpid.spec.load('amqp0-8.xml'))
client.start({ 'LOGIN': 'guest', 'PASSWORD': 'guest'})

ch = client.channel(1)
ch.channel_open()
ch.queue_declare(queue=&quot;test1&quot;, exclusive=True)
ch.queue_bind(queue=&quot;test1&quot;, exchange=&quot;amq.direct&quot;, \ 
routing_key=&quot;test_key_1&quot;)

print 'Sending message &quot;ping&quot;...  ',
ch.basic_publish(routing_key=&quot;test_key_1&quot;, content=Content(&quot;ping&quot;),\
         exchange='amq.direct')
print 'done'

print 'Receiving message'
t = ch.basic_consume(queue=&quot;test1&quot;, no_ack=True)
q = client.queue(t.consumer_tag)
msg = q.get(timeout=1)
print 'Got message:', msg.content.body

#-----------------------------------------------



If anybody is interested, when this code runs against 0.8 xml spec from 
qpid trunk, here is what I get in rabbit.log:

=INFO REPORT==== 7-Sep-2007::13:45:31 ===
accepted TCP connection on 0.0.0.0:5672 from 127.0.0.1:2586

=WARNING REPORT==== 7-Sep-2007::13:45:31 ===
Attempt by client to use invalid ticket 0

=WARNING REPORT==== 7-Sep-2007::13:45:31 ===
Lax ticket check mode: fabricating full ticket number 0

=ERROR REPORT==== 7-Sep-2007::13:45:31 ===
Frame error: 'basic.consume', &lt;&lt;0,0,5,116,101,115,116,49,0,2,0,0,0,0&gt;&gt;

=INFO REPORT==== 7-Sep-2007::13:45:31 ===
Sending exception: Channel 1, Reason {amqp,frame_error,'basic.consume'}

=INFO REPORT==== 7-Sep-2007::13:45:31 ===
closing TCP connection from 127.0.0.1:2586

This is on debian etch, original 1.1.1-1 rabbitmq-server deb.
python 2.4.4


- Dmitriy






Matthias Radestock wrote:
&gt;<i> Edwin,
</I>&gt;<i> 
</I>&gt;<i> Edwin Grubbs wrote:
</I>&gt;&gt;<i> Has anyone been able to get a python client working with rabbitmq? I
</I>&gt;&gt;<i> have been trying to use qpid, but I haven't had much luck.
</I>&gt;<i> 
</I>&gt;<i> We are running qpid's python-based test suite against RabbitMQ as part 
</I>&gt;<i> of our conformance and interop testing. See
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/interoperability.html#qpid-python-tests">http://www.rabbitmq.com/interoperability.html#qpid-python-tests</A>
</I>&gt;<i> 
</I>&gt;<i> That definitely works for us.
</I>&gt;<i> 
</I>&gt;<i> What exactly did you try?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Matthias.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000202.html">[rabbitmq-discuss] python client
</A></li>
	<LI>Next message: <A HREF="000208.html">[rabbitmq-discuss] Gentoo ebuilds?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#206">[ date ]</a>
              <a href="thread.html#206">[ thread ]</a>
              <a href="subject.html#206">[ subject ]</a>
              <a href="author.html#206">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
