<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 10 consumers on a queue delivers 10x too many messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%2010%20consumers%20on%20a%20queue%20delivers%2010x%20too%0A%20many%20messages&In-Reply-To=%3C51BB4E5D.5010708%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027865.html">
   <LINK REL="Next"  HREF="027866.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many messages</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%2010%20consumers%20on%20a%20queue%20delivers%2010x%20too%0A%20many%20messages&In-Reply-To=%3C51BB4E5D.5010708%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many messages">simon at rabbitmq.com
       </A><BR>
    <I>Fri Jun 14 18:09:49 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027865.html">[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many	messages
</A></li>
        <LI>Next message: <A HREF="027866.html">[rabbitmq-discuss] BasicPublish in .NET using client 2.8.1.0 and	transaction support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27885">[ date ]</a>
              <a href="thread.html#27885">[ thread ]</a>
              <a href="subject.html#27885">[ subject ]</a>
              <a href="author.html#27885">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hmm.

Are these numbers coming from the management plugin or are they as 
reported by your applications?

If they are coming from the management plugin, are you seeing any 
redelivered messages being reported?

If they are reported by your applications, what does the management 
plugin report? (And do the applications see the &quot;redelivered&quot; flag set?)

(Oh, and which version of RabbitMQ are you running?)

Cheers, Simon

On 13/06/13 18:39, David Goehrig wrote:
&gt;<i> Recently I've had 3 applications all start misbehaving in the same way.
</I>&gt;<i>
</I>&gt;<i> I have a topic exchange called alerts that is bound to 4 queues via the
</I>&gt;<i> same routing key #
</I>&gt;<i>
</I>&gt;<i> debug, hits, words, score
</I>&gt;<i>
</I>&gt;<i> The alerts exchange is recieving 10 messages per second, which is the
</I>&gt;<i> same as the number published to that exchange by the nodes processing
</I>&gt;<i> messages.  The exchange shows 40
</I>&gt;<i> messages per second total outbound.
</I>&gt;<i>
</I>&gt;<i> Each of the 4 queues show 10 messages per second incoming and the queues
</I>&gt;<i> each have a 3 day
</I>&gt;<i> TTL on the messages, with the exception of debug which has a 5 minute.
</I>&gt;<i>
</I>&gt;<i> Now debug queue as expected shows a pretty steady backlog hovering
</I>&gt;<i> around 3000 message (which is correct) and with no consumers doesn't
</I>&gt;<i> show any weird behavior.
</I>&gt;<i>
</I>&gt;<i> The other 3 queues each have 10 consumers bound to them and are showing
</I>&gt;<i> an average of 100 message per second being delivered to each consumer,
</I>&gt;<i> with each consumer recieving approximately 10 messages per second on
</I>&gt;<i> average.  (the distribution doesn't look even though but more likely
</I>&gt;<i> random).   These queues report 10 messages per second incoming, but show
</I>&gt;<i> 100 messages per second outbound.
</I>&gt;<i>
</I>&gt;<i> Looking over the report and the configs for each queue, nothing obvious
</I>&gt;<i> jumps out as to why the queues are behaving this way.  And until this
</I>&gt;<i> week, they've run perfectly fine for months.
</I>&gt;<i>
</I>&gt;<i> Anyone have any idea how this could happen/
</I>&gt;<i>
</I>&gt;<i> Dave
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> -=-=-=-=-=-=-=-=-=-=- <A HREF="http://blog.dloh.org/">http://blog.dloh.org/</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027865.html">[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many	messages
</A></li>
	<LI>Next message: <A HREF="027866.html">[rabbitmq-discuss] BasicPublish in .NET using client 2.8.1.0 and	transaction support
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27885">[ date ]</a>
              <a href="thread.html#27885">[ thread ]</a>
              <a href="subject.html#27885">[ subject ]</a>
              <a href="author.html#27885">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
