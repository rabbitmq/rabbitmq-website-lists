<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 10 consumers on a queue delivers 10x too many	messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%2010%20consumers%20on%20a%20queue%20delivers%2010x%20too%20many%0A%09messages&In-Reply-To=%3CCAPhD6FFCuqp-_P5zk%3D5R3oJ7vhb%2Bib0ZorHYfZPZwMR8aWtU6g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027861.html">
   <LINK REL="Next"  HREF="027885.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many	messages</H1>
    <B>David Goehrig</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%2010%20consumers%20on%20a%20queue%20delivers%2010x%20too%20many%0A%09messages&In-Reply-To=%3CCAPhD6FFCuqp-_P5zk%3D5R3oJ7vhb%2Bib0ZorHYfZPZwMR8aWtU6g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many	messages">dave at nexttolast.com
       </A><BR>
    <I>Thu Jun 13 18:39:54 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027861.html">[rabbitmq-discuss] Mnesia Corruption Bug
</A></li>
        <LI>Next message: <A HREF="027885.html">[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27865">[ date ]</a>
              <a href="thread.html#27865">[ thread ]</a>
              <a href="subject.html#27865">[ subject ]</a>
              <a href="author.html#27865">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Recently I've had 3 applications all start misbehaving in the same way.

I have a topic exchange called alerts that is bound to 4 queues via the
same routing key #

debug, hits, words, score

The alerts exchange is recieving 10 messages per second, which is the same
as the number published to that exchange by the nodes processing messages.
The exchange shows 40
messages per second total outbound.

Each of the 4 queues show 10 messages per second incoming and the queues
each have a 3 day
TTL on the messages, with the exception of debug which has a 5 minute.

Now debug queue as expected shows a pretty steady backlog hovering around
3000 message (which is correct) and with no consumers doesn't show any
weird behavior.

The other 3 queues each have 10 consumers bound to them and are showing an
average of 100 message per second being delivered to each consumer, with
each consumer recieving approximately 10 messages per second on average.
(the distribution doesn't look even though but more likely random).   These
queues report 10 messages per second incoming, but show 100 messages per
second outbound.

Looking over the report and the configs for each queue, nothing obvious
jumps out as to why the queues are behaving this way.  And until this week,
they've run perfectly fine for months.

Anyone have any idea how this could happen/

Dave

-- 
-=-=-=-=-=-=-=-=-=-=- <A HREF="http://blog.dloh.org/">http://blog.dloh.org/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130613/3629ac3d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130613/3629ac3d/attachment.htm</A>&gt;
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027861.html">[rabbitmq-discuss] Mnesia Corruption Bug
</A></li>
	<LI>Next message: <A HREF="027885.html">[rabbitmq-discuss] 10 consumers on a queue delivers 10x too many messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27865">[ date ]</a>
              <a href="thread.html#27865">[ thread ]</a>
              <a href="subject.html#27865">[ subject ]</a>
              <a href="author.html#27865">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
