<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pika connection negotiation behavior
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pika%20connection%20negotiation%20behavior&In-Reply-To=%3C51B034CC.3070300%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027702.html">
   <LINK REL="Next"  HREF="027724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pika connection negotiation behavior</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pika%20connection%20negotiation%20behavior&In-Reply-To=%3C51B034CC.3070300%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Pika connection negotiation behavior">matthias at rabbitmq.com
       </A><BR>
    <I>Thu Jun  6 08:05:48 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027702.html">[rabbitmq-discuss] Pika connection negotiation behavior
</A></li>
        <LI>Next message: <A HREF="027724.html">[rabbitmq-discuss] Pika connection negotiation behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27703">[ date ]</a>
              <a href="thread.html#27703">[ thread ]</a>
              <a href="subject.html#27703">[ subject ]</a>
              <a href="author.html#27703">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Maitreya,

On 06/06/13 06:35, maitreya wrote:
&gt;<i> I wanted to set the heartbeat interval to 3600s(assuming pika is
</I>&gt;<i> single threaded and can analyze the heartbeat events only between
</I>&gt;<i> requests).
</I>&gt;<i> [...]
</I>&gt;<i> I think the heartbeat interval should be flexible enough for different
</I>&gt;<i> type of workers.
</I>
This is the crux of the problem.

The heartbeat interval needs to be tuned to the network conditions. The 
ideal setting is actually &quot;as short as possible, without impacting 
performance&quot;, since that way we a) minimise the delay in detecting dead 
connections, and b) minimise the chances of the connection getting 
killed prematurely due to idleness.

Having to lengthen the interval artificially - e.g. so that 
single-threaded clients can process a whole message - conflicts with 
that. More generally, client libraries / applications should be 
responsive to incoming AMQP traffic. I don't know enough about pika and 
python threading to ascertain whether there is a convenient way to 
achieve that.

Having said that, as was noted in this thread earlier, there is nothing 
stopping clients from setting the interval to whatever they like. 
However, I'd caution against a default client library behaviour of 
&quot;accept whatever the app says, regardless of the server setting&quot; since 
that takes away any possibility for server-side adjustments.

And on that note...

you can adjust the server-suggested heartbeat interval from the default 
600s by setting the 'heartbeat' configuration variable in the server's 
rabbitmq.config, as documented at 
<A HREF="https://www.rabbitmq.com/configure.html#config-items">https://www.rabbitmq.com/configure.html#config-items</A>


Regards,

Matthias.
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027702.html">[rabbitmq-discuss] Pika connection negotiation behavior
</A></li>
	<LI>Next message: <A HREF="027724.html">[rabbitmq-discuss] Pika connection negotiation behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27703">[ date ]</a>
              <a href="thread.html#27703">[ thread ]</a>
              <a href="subject.html#27703">[ subject ]</a>
              <a href="author.html#27703">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
