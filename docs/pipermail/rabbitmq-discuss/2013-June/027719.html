<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq memory usage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20memory%20usage&In-Reply-To=%3C51B09698.5000209%40lshift.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027717.html">
   <LINK REL="Next"  HREF="027721.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq memory usage</H1>
    <B>Ceri Storey</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20memory%20usage&In-Reply-To=%3C51B09698.5000209%40lshift.net%3E"
       TITLE="[rabbitmq-discuss] rabbitmq memory usage">ceri at lshift.net
       </A><BR>
    <I>Thu Jun  6 15:03:04 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027717.html">[rabbitmq-discuss] rabbitmq memory usage
</A></li>
        <LI>Next message: <A HREF="027721.html">[rabbitmq-discuss] rabbitmq memory usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27719">[ date ]</a>
              <a href="thread.html#27719">[ thread ]</a>
              <a href="subject.html#27719">[ subject ]</a>
              <a href="author.html#27719">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(06/06/13 14:45), Sean Allen wrote:
&gt;<i> I'm trying to understand memory usage in rabbitmq. Pointers to
</I>&gt;<i> relevant docs, salient comments etc greatly welcomed. We have a number
</I>&gt;<i> of batch jobs that are handled by one process putting information on a
</I>&gt;<i> queue and then storm spouts read the info off and process. In the case
</I>&gt;<i> of one job, we put about 5.9 million integers on a queue as individual
</I>&gt;<i> messages and process. When those 5.9 go on, rabbitmq usage jumps up by
</I>&gt;<i> about a gig.
</I>&gt;<i>
</I>&gt;<i> Currently with 5.6 million still in the queue, we have the following
</I>&gt;<i> memory usage on the node as determind by rabbitmqctl status:
</I>&gt;<i>
</I>&gt;<i>  {memory,
</I>&gt;<i>      [{total,1178020816},
</I>&gt;<i>       {processes,131791280},
</I>&gt;<i>       {processes_used,130916744},
</I>&gt;<i>       {system,1046229536},
</I>&gt;<i>       {atom,1338193},
</I>&gt;<i>       {atom_used,1314590},
</I>&gt;<i>       {binary,12936792},
</I>&gt;<i>       {code,15696033},
</I>&gt;<i>       {ets,975434504}]},
</I>&gt;<i>
</I>&gt;<i> Can anyone shed light on the high level of memory usage and what we
</I>&gt;<i> could do to cut down on it?
</I>
I'm sure that one of the Rabbit team themselves can shed a bit more
light on this, but AIUI RabbitMQ uses ETS in-memory tables to index the
queues, so with some back of the envelope arithmetic your rabbit is
using approximately 175bytes per message. So on the face of it, that
might look a bit odd, but doesn't seem unreasonable.

Are you seeing any concrete issues because of this, or are you more
concerned about resource usage? Also, do you anticipate having to
process batches many factors larger than that?
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027717.html">[rabbitmq-discuss] rabbitmq memory usage
</A></li>
	<LI>Next message: <A HREF="027721.html">[rabbitmq-discuss] rabbitmq memory usage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27719">[ date ]</a>
              <a href="thread.html#27719">[ thread ]</a>
              <a href="subject.html#27719">[ subject ]</a>
              <a href="author.html#27719">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
