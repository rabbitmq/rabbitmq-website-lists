<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Connection Problem with .NET Client v3.0.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Connection%20Problem%20with%20.NET%20Client%20v3.0.4&In-Reply-To=%3Ce99b1e71-d7b3-4388-9162-7e446ce5361d%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027838.html">
   <LINK REL="Next"  HREF="027842.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Connection Problem with .NET Client v3.0.4</H1>
    <B>David Priddle</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Connection%20Problem%20with%20.NET%20Client%20v3.0.4&In-Reply-To=%3Ce99b1e71-d7b3-4388-9162-7e446ce5361d%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Connection Problem with .NET Client v3.0.4">davidpriddle2000 at gmail.com
       </A><BR>
    <I>Wed Jun 12 11:07:25 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027838.html">[rabbitmq-discuss] configure maxlength feature in 3.1.1
</A></li>
        <LI>Next message: <A HREF="027842.html">[rabbitmq-discuss] Connection Problem with .NET Client v3.0.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27841">[ date ]</a>
              <a href="thread.html#27841">[ thread ]</a>
              <a href="subject.html#27841">[ subject ]</a>
              <a href="author.html#27841">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> 

We&#8217;ve been having occasional problems with connection errors using the 
Rabbit .NET Client v3.0.4. This manifests itself initially with the error:

Shutting down connection. Reason: AMQP close-reason, initiated by Peer, 
code=503, text=&quot;COMMAND_INVALID - second 'channel.open' seen&quot;, classId=20, 
methodId=10, cause=

We attempt to Dispose the connection object at this point to make sure 
we&#8217;ve released all resources, but get an ObjectDisposedException from the 
underlying NetworkStream. We then attempt to reconnect and start consuming 
again, but although the connection and channels appear to create 
successfully we don&#8217;t receive messages off the queue.

I believe the underlying connection we are using is in a bad state.

I&#8217;ve noticed some other discussions online about a problem where a 
duplicate channel number may be allocated. I see that the only difference 
between the .NET 3.1.1 client and the 3.0.4 client is a fix has been made 
to the way the IntAllocator class allocates integers. I assume that is this 
bug in the release notes:

.NET client

-------------

bug fixes

25558 fix a bug that could lead to duplicate channel IDs being allocated,causing a connection failure 

Do you have any more information about this bug? Do you think this fix 
would be relevant to the problems we are seeing? Is there any 

(I&#8217;m considering whether we should urgently patch our software to upgrade 
us onto 3.1.1 client.)

Best Regards,

David Priddle

 

 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130612/efa27a6e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130612/efa27a6e/attachment.htm</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027838.html">[rabbitmq-discuss] configure maxlength feature in 3.1.1
</A></li>
	<LI>Next message: <A HREF="027842.html">[rabbitmq-discuss] Connection Problem with .NET Client v3.0.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27841">[ date ]</a>
              <a href="thread.html#27841">[ thread ]</a>
              <a href="subject.html#27841">[ subject ]</a>
              <a href="author.html#27841">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
