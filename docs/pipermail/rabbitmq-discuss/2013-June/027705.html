<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Node crash, then cluster collapse
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Node%20crash%2C%20then%20cluster%20collapse&In-Reply-To=%3C32727D52-5530-48CE-BDC4-F83A7768CDAE%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027690.html">
   <LINK REL="Next"  HREF="027723.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Node crash, then cluster collapse</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Node%20crash%2C%20then%20cluster%20collapse&In-Reply-To=%3C32727D52-5530-48CE-BDC4-F83A7768CDAE%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Node crash, then cluster collapse">watson.timothy at gmail.com
       </A><BR>
    <I>Thu Jun  6 11:04:37 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027690.html">[rabbitmq-discuss] Node crash, then cluster collapse
</A></li>
        <LI>Next message: <A HREF="027723.html">[rabbitmq-discuss] Node crash, then cluster collapse
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27705">[ date ]</a>
              <a href="thread.html#27705">[ thread ]</a>
              <a href="subject.html#27705">[ subject ]</a>
              <a href="author.html#27705">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Carl

On 5 Jun 2013, at 13:56, carlhoerberg &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">carl.hoerberg at gmail.com</A>&gt; wrote:
&gt;<i> On a three node cluster, one ec2 machine reboots unexpectedly, and when it
</I>&gt;<i> starts up again RabbitMQ fails to start. I've put all logs here:
</I>&gt;<i> <A HREF="https://gist.github.com/carlhoerberg/ff6c6bd4f7639bf4b2f5">https://gist.github.com/carlhoerberg/ff6c6bd4f7639bf4b2f5</A>
</I>&gt;<i> 
</I>
That seems to contain only the logs from one node, what about the others?

&gt;<i> When the troubled node is restarted manually again it's unable to join,
</I>&gt;<i> stopping at &quot;adding mirrors&quot;, staying there forever. 
</I>&gt;<i> 
</I>&gt;<i> The other nodes now start to behave weird too, new queues can't be declared,
</I>&gt;<i> but existing queues seems to continue deliver messages. They also can't
</I>&gt;<i> respond to &quot;rabbitmqctl status&quot;, or /api/overview. I'm forced to stop them
</I>&gt;<i> with &quot;kill -9&quot;. Only when all nodes are stopped the cluster can be brought
</I>&gt;<i> up again normally. 
</I>
If you kill -9 the nodes, it's a bit tricky to get live info for diagnosis, assuming there's nothing in the logs. If the logs are available, please post them. Next time this happens, jump on irc (the #rabbitmq channel on freenode) and  we can try a few things to diagnose what's going on. If you can arrange for me to have ssh access to these nodes whilst the symptoms are present, I'll be more likely to solve the issue quickly - we might be able to sign some kind of privacy agreement if necessary.

Also please post your full setup whenever possible, detailing which plugins you're using (if any) and what kind of ha setup you're using.

Cheers,
Tim
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027690.html">[rabbitmq-discuss] Node crash, then cluster collapse
</A></li>
	<LI>Next message: <A HREF="027723.html">[rabbitmq-discuss] Node crash, then cluster collapse
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27705">[ date ]</a>
              <a href="thread.html#27705">[ thread ]</a>
              <a href="subject.html#27705">[ subject ]</a>
              <a href="author.html#27705">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
