<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Active-Active HA failover downtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Active-Active%20HA%20failover%20downtime&In-Reply-To=%3C1371719008745-27512.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028000.html">
   <LINK REL="Next"  HREF="028010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Active-Active HA failover downtime</H1>
    <B>thomas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Active-Active%20HA%20failover%20downtime&In-Reply-To=%3C1371719008745-27512.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Active-Active HA failover downtime">taihock at gmail.com
       </A><BR>
    <I>Thu Jun 20 10:03:28 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028000.html">[rabbitmq-discuss] RabbitMQ cluster can't startup
</A></li>
        <LI>Next message: <A HREF="028010.html">[rabbitmq-discuss] Using Shovel to Copy Messages for Testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28001">[ date ]</a>
              <a href="thread.html#28001">[ thread ]</a>
              <a href="subject.html#28001">[ subject ]</a>
              <a href="author.html#28001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have currently set up 3 rabbitmq servers, namely <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at A</A>, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at b</A> and
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at C</A> in a mirroring HA cluster.
I have performed some test to find out the downtime. The client application
connects to haproxy which will then direct the traffic to an alive rabbitmq
server. I am using autoheal for cluster_partition_handling. My net_ticktime
is 2 seconds.

Here's what I have tried:
1) client application publishing 10000 messages continuously to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at A</A>,
all 3 rabbitmq servers were up at that point of time, then I bring down the
network connection of a <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at B</A> and this results in the sending of messages
stopping for about 15 seconds before continuing.

2) client application publishing 10000 messages continuously to <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at A</A>,
all 3 rabbitmq servers were up at that point of time, then I bring down the
network connection of a <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at A</A> and this results in the sending of messages
stopping for about 15 seconds before continuing, which is about the same for
the previous case.

I have look through the log and it shows that 2 seconds after i bring down
one node for the above 2 cases the node is detected as dead which is
correct. However, the promotion for slave or &quot;saw death of mirror happens
about 15 seconds after a node is taken down in both cases.


I would like to find out the followings:
1) Is it normal for a disruption of 15 seconds when the slave is brought
down or should there be no disruption at all?
2) Is there suppose to be downtime when the master is down because from my
understanding it seems that  active-active will prevent that.
3) What are some of the configuration that could possibly be configured
wrongly if my 2 test cases were not suppose to behave that way?

Thanks.

Cheers,
Thomas



--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Active-Active-HA-failover-downtime-tp27512.html">http://rabbitmq.1065348.n5.nabble.com/Active-Active-HA-failover-downtime-tp27512.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028000.html">[rabbitmq-discuss] RabbitMQ cluster can't startup
</A></li>
	<LI>Next message: <A HREF="028010.html">[rabbitmq-discuss] Using Shovel to Copy Messages for Testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28001">[ date ]</a>
              <a href="thread.html#28001">[ thread ]</a>
              <a href="subject.html#28001">[ subject ]</a>
              <a href="author.html#28001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
