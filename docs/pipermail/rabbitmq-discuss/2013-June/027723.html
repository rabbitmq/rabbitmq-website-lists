<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Node crash, then cluster collapse
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Node%20crash%2C%20then%20cluster%20collapse&In-Reply-To=%3C45A3DE3F324A49E08ECECFCFD87E3A4F%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027705.html">
   <LINK REL="Next"  HREF="027692.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Node crash, then cluster collapse</H1>
    <B>carlhoerberg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Node%20crash%2C%20then%20cluster%20collapse&In-Reply-To=%3C45A3DE3F324A49E08ECECFCFD87E3A4F%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Node crash, then cluster collapse">carl.hoerberg at gmail.com
       </A><BR>
    <I>Thu Jun  6 16:28:11 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027705.html">[rabbitmq-discuss] Node crash, then cluster collapse
</A></li>
        <LI>Next message: <A HREF="027692.html">[rabbitmq-discuss] 3.1.1 HTTP API leaks information
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27723">[ date ]</a>
              <a href="thread.html#27723">[ thread ]</a>
              <a href="subject.html#27723">[ subject ]</a>
              <a href="author.html#27723">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alright, thanks, I'll try to contact you on IRC next time this happens. I updated the gist with some logs from another node, the third node produced *a lot*, so those I have to email you. 


On Thursday 6 June 2013 at 18:07, Tim Watson-5 [via RabbitMQ] wrote:

&gt;<i> Carl 
</I>&gt;<i> 
</I>&gt;<i> On 5 Jun 2013, at 13:56, carlhoerberg &lt;[hidden email] (/user/SendEmail.jtp?type=node&amp;node=27221&amp;i=0)&gt; wrote: 
</I>&gt;<i> &gt; On a three node cluster, one ec2 machine reboots unexpectedly, and when it 
</I>&gt;<i> &gt; starts up again RabbitMQ fails to start. I've put all logs here: 
</I>&gt;<i> &gt; <A HREF="https://gist.github.com/carlhoerberg/ff6c6bd4f7639bf4b2f5">https://gist.github.com/carlhoerberg/ff6c6bd4f7639bf4b2f5</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> That seems to contain only the logs from one node, what about the others? 
</I>&gt;<i> 
</I>&gt;<i> &gt; When the troubled node is restarted manually again it's unable to join, 
</I>&gt;<i> &gt; stopping at &quot;adding mirrors&quot;, staying there forever. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The other nodes now start to behave weird too, new queues can't be declared, 
</I>&gt;<i> &gt; but existing queues seems to continue deliver messages. They also can't 
</I>&gt;<i> &gt; respond to &quot;rabbitmqctl status&quot;, or /api/overview. I'm forced to stop them 
</I>&gt;<i> &gt; with &quot;kill -9&quot;. Only when all nodes are stopped the cluster can be brought 
</I>&gt;<i> &gt; up again normally. 
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> If you kill -9 the nodes, it's a bit tricky to get live info for diagnosis, assuming there's nothing in the logs. If the logs are available, please post them. Next time this happens, jump on irc (the #rabbitmq channel on freenode) and we can try a few things to diagnose what's going on. If you can arrange for me to have ssh access to these nodes whilst the symptoms are present, I'll be more likely to solve the issue quickly - we might be able to sign some kind of privacy agreement if necessary. 
</I>&gt;<i> 
</I>&gt;<i> Also please post your full setup whenever possible, detailing which plugins you're using (if any) and what kind of ha setup you're using. 
</I>&gt;<i> 
</I>&gt;<i> Cheers, 
</I>&gt;<i> Tim 
</I>&gt;<i> _______________________________________________ 
</I>&gt;<i> rabbitmq-discuss mailing list 
</I>&gt;<i> [hidden email] (/user/SendEmail.jtp?type=node&amp;node=27221&amp;i=1) 
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> If you reply to this email, your message will be added to the discussion below: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Node-crash-then-cluster-collapse-tp27206p27221.html">http://rabbitmq.1065348.n5.nabble.com/Node-crash-then-cluster-collapse-tp27206p27221.html</A> 
</I>&gt;<i> To unsubscribe from Node crash, then cluster collapse, click here (<A HREF="http://rabbitmq.1065348.n5.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=27206&amp;code=Y2FybC5ob2VyYmVyZ0BnbWFpbC5jb218MjcyMDZ8LTEyNDcxMDc4NjM=">http://rabbitmq.1065348.n5.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&amp;node=27206&amp;code=Y2FybC5ob2VyYmVyZ0BnbWFpbC5jb218MjcyMDZ8LTEyNDcxMDc4NjM=</A>).
</I>&gt;<i> NAML (<A HREF="http://rabbitmq.1065348.n5.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml">http://rabbitmq.1065348.n5.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;id=instant_html%21nabble%3Aemail.naml&amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml</A>) 
</I>&gt;<i> 
</I>






--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Node-crash-then-cluster-collapse-tp27206p27239.html">http://rabbitmq.1065348.n5.nabble.com/Node-crash-then-cluster-collapse-tp27206p27239.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130606/e9b7dc95/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130606/e9b7dc95/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027705.html">[rabbitmq-discuss] Node crash, then cluster collapse
</A></li>
	<LI>Next message: <A HREF="027692.html">[rabbitmq-discuss] 3.1.1 HTTP API leaks information
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27723">[ date ]</a>
              <a href="thread.html#27723">[ thread ]</a>
              <a href="subject.html#27723">[ subject ]</a>
              <a href="author.html#27723">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
