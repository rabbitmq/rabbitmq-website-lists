<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Low disk space causes RabbitMQ to lose messages instead of blocking the connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Low%20disk%20space%20causes%20RabbitMQ%20to%20lose%0A%20messages%20instead%20of%20blocking%20the%20connection&In-Reply-To=%3C51AC62B6.5080708%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027640.html">
   <LINK REL="Next"  HREF="027641.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Low disk space causes RabbitMQ to lose messages instead of blocking the connection</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Low%20disk%20space%20causes%20RabbitMQ%20to%20lose%0A%20messages%20instead%20of%20blocking%20the%20connection&In-Reply-To=%3C51AC62B6.5080708%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Low disk space causes RabbitMQ to lose messages instead of blocking the connection">emile at rabbitmq.com
       </A><BR>
    <I>Mon Jun  3 10:32:38 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027640.html">[rabbitmq-discuss] Low disk space causes RabbitMQ to loose messages instead of blocking the connection
</A></li>
        <LI>Next message: <A HREF="027641.html">[rabbitmq-discuss] In RabbitMQ-C Getting AMQP_CHANNEL_CLOSE_METHOD without closing channel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27642">[ date ]</a>
              <a href="thread.html#27642">[ thread ]</a>
              <a href="subject.html#27642">[ subject ]</a>
              <a href="author.html#27642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,


On 03/06/13 06:08, Joe wrote:

&gt;<i>  - *Am I doing something wrong?*
</I>&gt;<i>  - *Is this a bug in RabbitMQ?*
</I>&gt;<i>  - *If so, is there a workaround?*
</I>
You are probably publishing into network buffers while the resource
alarm is set. Since the messages are tiny in your example, the network
buffers will take a while to fill up, but they will eventually fill up
and block publishers. Reducing the network buffer size will speed this up.

If you sever the connection before the messages reach the broker then
they will be lost. If the connection remains up when the resource alarm
is cleared then all messages will eventually make their way to the
broker. Use publisher confirms to avoid the possibility of message loss
when publishing: <A HREF="http://www.rabbitmq.com/confirms.html">http://www.rabbitmq.com/confirms.html</A>

Inserting &quot;channel.waitForConfirms();&quot; immediately after the publish
step will reduce overall throughput, but make the effect of the resource
block apparent to publishers immediately.



-Emile




</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027640.html">[rabbitmq-discuss] Low disk space causes RabbitMQ to loose messages instead of blocking the connection
</A></li>
	<LI>Next message: <A HREF="027641.html">[rabbitmq-discuss] In RabbitMQ-C Getting AMQP_CHANNEL_CLOSE_METHOD without closing channel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27642">[ date ]</a>
              <a href="thread.html#27642">[ thread ]</a>
              <a href="subject.html#27642">[ subject ]</a>
              <a href="author.html#27642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
