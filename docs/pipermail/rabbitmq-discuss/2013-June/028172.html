<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Porting%20.NET%20client%20to%20WinRT%20API%20%28Windows%208%29.&In-Reply-To=%3CCAFCmQSo1w_w08XWO5bP_YEC7MkARHQYn3noJtVJEE8rX872pAQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028097.html">
   <LINK REL="Next"  HREF="028098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).</H1>
    <B>Nathan Brown</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Porting%20.NET%20client%20to%20WinRT%20API%20%28Windows%208%29.&In-Reply-To=%3CCAFCmQSo1w_w08XWO5bP_YEC7MkARHQYn3noJtVJEE8rX872pAQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).">nathan at nkbrown.us
       </A><BR>
    <I>Fri Jun 28 17:03:46 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028097.html">[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
</A></li>
        <LI>Next message: <A HREF="028098.html">[rabbitmq-discuss] rabbitmq Error:{cannot_discover_cluster,	&quot;the nodes provided are either offline or not running&quot;}
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28172">[ date ]</a>
              <a href="thread.html#28172">[ thread ]</a>
              <a href="subject.html#28172">[ subject ]</a>
              <a href="author.html#28172">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have pushed my changes to RabbitMQ client for .NET for it to work in a
Windows 8 Store / WinRT environment.  It includes a basic Windows Store
application that connects to the specified amqp URL and subscribes to
messages.  By pressing a button, messages can be sent to the RabbitMQ
server and will then be received by the subscription and displayed in a
list.

The unit tests had to be copied and ported to MSTest because NUnit doesn't
deploy to an app container and some of the WinRT APIs require that.
 Specifically getting the protocol from application configuration.

I added a Subscription.NextAsync() and modified the SharedQueue to handle a
Task based DequeueAsync efficiently.  This allows the main GUI loop to wait
for a message without a separate thread.  These changes will only be
compiled in if the project is a Windows Store App (which defines
NETFX_CORE).

The SSL code is un-tested and probably broken.  The reason for the change
is that the WinRT StreamSocket API handles the SSL internally and doesn't
let the client code do as much as with the previous Socket implementation.
 If someone with experience with SSL can take a look and test it, that
would be great.

Please take a look here:
<A HREF="https://bitbucket.org/nathanbrown/rabbitmq-dotnet-client/commits/branch/WinStore">https://bitbucket.org/nathanbrown/rabbitmq-dotnet-client/commits/branch/WinStore</A>

It doesn't appear that the NuGet package creation is in this repository, so
I was unable to make any changes to that.

Let me know of any feedback you have.

Thanks,

Nathan Brown



On Tue, Jun 25, 2013 at 10:29 AM, Nathan Brown &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nathan at nkbrown.us</A>&gt; wrote:

&gt;<i> Accidentally sent the message before I finished.
</I>&gt;<i>
</I>&gt;<i> My questions were:
</I>&gt;<i>
</I>&gt;<i> Is there any feedback on the code I've submitted so far?
</I>&gt;<i>
</I>&gt;<i> For the Windows 8 changes; How should I deal with the split in the
</I>&gt;<i> codebase?  Should I use conditional compilation like #ifdef NETFX_CORE, or
</I>&gt;<i> use copies of the files that change and links for the ones that don't?  I
</I>&gt;<i> personally think that conditional compilation for most changes and only
</I>&gt;<i> separate files for the ones that change a lot (like SSL handling) is the
</I>&gt;<i> best option.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Nathan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, Jun 25, 2013 at 10:22 AM, Nathan Brown &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nathan at nkbrown.us</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I've submitted the contributor agreement, and I hope the submitted
</I>&gt;&gt;<i> changes can now be reviewed and considered for main-line inclusion.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Emile mentioned that this is now under &quot;bug25552&quot;, should I re-base my
</I>&gt;&gt;<i> code to the most recent .net client release and set the branch name to
</I>&gt;&gt;<i> match?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, there are really the separate changes that could be made
</I>&gt;&gt;<i> independently:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    - Corrected test to pull correct value types from dictionary.&lt;<A HREF="https://bitbucket.org/nathanbrown/rabbitmq-dotnet-client/commits/25988f1d5bea8ad86aed536edd4d4fe1826ac43f">https://bitbucket.org/nathanbrown/rabbitmq-dotnet-client/commits/25988f1d5bea8ad86aed536edd4d4fe1826ac43f</A>&gt;
</I>&gt;&gt;<i>    - Move from non-generic dictionary (.net 1.1) to generic dictionary,
</I>&gt;&gt;<i>    required, but independent of the next change.  This is my &quot;depreciate1_1&quot;
</I>&gt;&gt;<i>    branch&lt;<A HREF="https://bitbucket.org/nathanbrown/rabbitmq-dotnet-client/commits/branch/depreciate1_1">https://bitbucket.org/nathanbrown/rabbitmq-dotnet-client/commits/branch/depreciate1_1</A>&gt;
</I>&gt;&gt;<i>    .
</I>&gt;&gt;<i>    - Add Windows 8/RT code to handle differences in threads and sockets.
</I>&gt;&gt;<i>    - Threads are removed in favor of Tasks, and sockets have been
</I>&gt;&gt;<i>    removed in favor of StreamSockts
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Sat, May 11, 2013 at 2:05 PM, Michael Klishin &lt;
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.s.klishin at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2013/5/12 Nathan Brown &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nathan at nkbrown.us</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  I'm also not familiar with setting up and testing SSL in RabbitMQ.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Take a look at <A HREF="http://rabbitmq.com/ssl.html">http://rabbitmq.com/ssl.html</A>
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> MK
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130628/b4c7fefb/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130628/b4c7fefb/attachment.htm</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028097.html">[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
</A></li>
	<LI>Next message: <A HREF="028098.html">[rabbitmq-discuss] rabbitmq Error:{cannot_discover_cluster,	&quot;the nodes provided are either offline or not running&quot;}
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28172">[ date ]</a>
              <a href="thread.html#28172">[ thread ]</a>
              <a href="subject.html#28172">[ subject ]</a>
              <a href="author.html#28172">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
