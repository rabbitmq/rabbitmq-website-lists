<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java client and Qpid
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20and%20Qpid&In-Reply-To=%3C51BB4825.6070001%40alertme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027916.html">
   <LINK REL="Next"  HREF="027883.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java client and Qpid</H1>
    <B>Dmitry Andrianov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20and%20Qpid&In-Reply-To=%3C51BB4825.6070001%40alertme.com%3E"
       TITLE="[rabbitmq-discuss] Java client and Qpid">dmitry.andrianov at alertme.com
       </A><BR>
    <I>Fri Jun 14 17:43:17 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027916.html">[rabbitmq-discuss] RabbitMQ service is not starting
</A></li>
        <LI>Next message: <A HREF="027883.html">[rabbitmq-discuss] Java client and Qpid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27881">[ date ]</a>
              <a href="thread.html#27881">[ thread ]</a>
              <a href="subject.html#27881">[ subject ]</a>
              <a href="author.html#27881">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi.

I have a Java application which acts a bit like Shovel plugin - it 
receives messages from one AMQP broker (Apache Qpid) and forwards them 
to another (RabbitMQ). As the RabbitMQ is the &quot;main&quot; broker, I'm using 
its Java library to connect to both.

And it is that Qpid to Rabbit Java client integration point that is 
giving me headache.
I'm not sure what exactly is going on but after some debugging it looks 
to me that scenario is like this:
1. The queue already has some messages at the moment I try to run 
basicConsume() on it (it is a durable queue)
2. ChannelN.basicConsume() begins its RPC call and waits for the reply
3. ChannelN.processAsync() gets invoked with the first message BEFORE 
the reply to that RPC is received
4. As there is no ConsumerTag yet in the _consumers map (it gets there 
when RPC completes), processAsync() throws &quot;Unsolicited delivery&quot; exception.

Unfortunately I do not know the protocol well enough to understand if 
Qpid violates it by sending me a message before sending reply to 
basicConsume request or not. Without reading the specs I would assume 
that this behaviour is a valid one and it is RabbitMQ Java client that 
needs to be more tolerant.

Could you please advise?

Thank you.


This email is for the use of the intended recipient(s) only.
If you have received this email in error, please notify the sender immediately and then delete it.
If you are not the intended recipient, you must not use, disclose or distribute this email without the
author's prior permission. AlertMe.com Ltd. is not responsible for any personal views expressed
in this message or any attachments that are those of the individual sender.

AlertMe.com Ltd, 30 Station Road, Cambridge, CB1 2RE, UK.
Registered in England, Company number 578 2908, VAT registration number GB 895 9914 42.


</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027916.html">[rabbitmq-discuss] RabbitMQ service is not starting
</A></li>
	<LI>Next message: <A HREF="027883.html">[rabbitmq-discuss] Java client and Qpid
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27881">[ date ]</a>
              <a href="thread.html#27881">[ thread ]</a>
              <a href="subject.html#27881">[ subject ]</a>
              <a href="author.html#27881">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
