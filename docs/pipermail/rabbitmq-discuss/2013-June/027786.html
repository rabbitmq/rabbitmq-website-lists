<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Restart Cluster after crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Restart%20Cluster%20after%20crash&In-Reply-To=%3Ce4e37a80-c286-4c24-bf63-0916eaf8b3ec%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027790.html">
   <LINK REL="Next"  HREF="027795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Restart Cluster after crash</H1>
    <B>Brendan Fry</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Restart%20Cluster%20after%20crash&In-Reply-To=%3Ce4e37a80-c286-4c24-bf63-0916eaf8b3ec%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Restart Cluster after crash">bfry at fryhard.com
       </A><BR>
    <I>Mon Jun 10 06:32:39 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027790.html">[rabbitmq-discuss] 3.1.1 - Errors during failover
</A></li>
        <LI>Next message: <A HREF="027795.html">[rabbitmq-discuss] Restart Cluster after crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27786">[ date ]</a>
              <a href="thread.html#27786">[ thread ]</a>
              <a href="subject.html#27786">[ subject ]</a>
              <a href="author.html#27786">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

We are trying to restart our RabbitMQ cluster after an unexpected 
environment failure. 

We are running:

   - rabbitmq_server-3.1.0 on Windows
   - erl5.10.1
   
Our cluster is configured like so:

   - web01, web02, web03, web04, web05, app05, app06

During earlier testing we were able to take down any and all of the nodes 
with a Windows restart and the cluster would recover. Though, after the 
unexpected crash that brought down the entire cluster the rabbit services 
will no longer start.

We receive the following error:

*C:\Program Files (x86)\RabbitMQ 
Server\rabbitmq_server-3.1.0\sbin&gt;rabbitmq-server.bat*
*
*
*              RabbitMQ 3.1.0. Copyright (C) 2007-2013 VMware, Inc.*
*  ##  ##      Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/*">http://www.rabbitmq.com/*</A>
*  ##  ##*
*  ##########  Logs: C:/RabbitMQ/log/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02.log</A>*
*  ######  ##        C:/RabbitMQ/log/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02-sasl.log</A>*
*  ##########*
*              Starting broker...*
*
*
*BOOT FAILED*
*===========*
*Timeout contacting cluster nodes: [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB05</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABWEB04</A>,*
*                                   <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB03</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABWEB01</A>,*
*                                   <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABAPP06</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABAPP05</A>].*
*
*
*DIAGNOSTICS*
*===========*
*nodes in question: [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB05</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABWEB04</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABWEB03</A>,*
*                    <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB01</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABAPP06</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at OTLABAPP05</A>]*
*
*
*hosts, their running nodes and ports:*
*- OTLABAPP05: []*
*- OTLABAPP06: []*
*- OTLABWEB01: []*
*- OTLABWEB03: []*
*- OTLABWEB04: []*
*- OTLABWEB05: []*
*
*
*current node details:*
*- node name: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02</A>*
*- home dir: U:\*
*- cookie hash: j9x9r680xF6JzFI7IVDLew==*
*
*
*BOOT FAILED*
*===========*
*Error description:*
*   {could_not_start,rabbit,*
*       {bad_return,*
*           {{rabbit,start,[normal,[]]},*
*            {'EXIT',*
*                {rabbit,failure_during_boot,*
*                    {error,*
*                        {timeout_waiting_for_tables,*
*                            
[rabbit_user,rabbit_user_permission,rabbit_vhost,*
*                             rabbit_durable_route,rabbit_durable_exchange,*
*                             rabbit_runtime_parameters,*
*                             rabbit_durable_queue]}}}}}}}*
*
*
*Log files (may contain more information):*
*   C:/RabbitMQ/log/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02.log</A>*
*   C:/RabbitMQ/log/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02-sasl.log</A>*
*
*
*{&quot;init terminating in 
do_boot&quot;,{rabbit,failure_during_boot,{could_not_start,rabb*
*
it,{bad_return,{{rabbit,start,[normal,[]]},{'EXIT',{rabbit,failure_during_boot,{
*
*
error,{timeout_waiting_for_tables,[rabbit_user,rabbit_user_permission,rabbit_vho
*
*
st,rabbit_durable_route,rabbit_durable_exchange,rabbit_runtime_parameters,rabbit
*
*_durable_queue]}}}}}}}}}*
*
*
*Crash dump was written to: erl_crash.dump*
*init terminating in do_boot ()*


I have attached the log files from web02.

Reading the groups and Googling we have managed to recreate the cluster 
before, but at the loss of the queues. We would like to retain our queues 
and the information they contained. We hope that this is easy to solve, 
since servers do unexpectedly go down. :(

Any help would be greatly appreciated.

Thanks
Brendan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130609/55356de1/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130609/55356de1/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02.log</A>
Type: application/octet-stream
Size: 1994 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130609/55356de1/attachment.obj">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130609/55356de1/attachment.obj</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at OTLABWEB02-sasl.log</A>
Type: application/octet-stream
Size: 965 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130609/55356de1/attachment-0001.obj">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130609/55356de1/attachment-0001.obj</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027790.html">[rabbitmq-discuss] 3.1.1 - Errors during failover
</A></li>
	<LI>Next message: <A HREF="027795.html">[rabbitmq-discuss] Restart Cluster after crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27786">[ date ]</a>
              <a href="thread.html#27786">[ thread ]</a>
              <a href="subject.html#27786">[ subject ]</a>
              <a href="author.html#27786">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
