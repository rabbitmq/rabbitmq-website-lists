<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Simultaneous Scalability and HA
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Simultaneous%20Scalability%20and%20HA&In-Reply-To=%3C5F673FAD-E0F5-42F3-AEE7-C3EFA27FCBA5%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028023.html">
   <LINK REL="Next"  HREF="028025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Simultaneous Scalability and HA</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Simultaneous%20Scalability%20and%20HA&In-Reply-To=%3C5F673FAD-E0F5-42F3-AEE7-C3EFA27FCBA5%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Simultaneous Scalability and HA">tim at rabbitmq.com
       </A><BR>
    <I>Fri Jun 21 11:17:46 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028023.html">[rabbitmq-discuss] Simultaneous Scalability and HA
</A></li>
        <LI>Next message: <A HREF="028025.html">[rabbitmq-discuss] Simultaneous Scalability and HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28024">[ date ]</a>
              <a href="thread.html#28024">[ thread ]</a>
              <a href="subject.html#28024">[ subject ]</a>
              <a href="author.html#28024">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21 Jun 2013, at 09:39, Hudson Jiang wrote:
&gt;<i> However, for achieving HA, the suggested approach is the built-in active-active option for queues: mirrored queues. And it's recommended to use: 
</I>&gt;<i> queue_args = {&quot;x-ha-policy&quot; : &quot;all&quot; }
</I>&gt;<i> 
</I>
Where does it say the &quot;all&quot; policy is the recommend one? Look at it like this: mirror queues (i.e., HA in RabbitMQ) buys you resilience to node failure, which might increase availability. But it doesn't buy you anything in terms of &quot;distributing load&quot;, since HA actually adds load (as a result of replication) to the system.

&gt;<i> Is above cluster approach for scalability conflicted with the mirrored queues approach for HA (do I misunderstand anything)? How can I achieve both of them simultaneously?
</I>&gt;<i> 
</I>
Clustering provides a consistent view of all the (clustered) brokers from each node, which means you can connect to any node and interact with objects (i.e., publish to exchanges or consume from queues) on any node in the cluster.

Mirroring / HA provides replication of contents for 1 queue, that you've chosen to mirror, and you can maintain the queue's state across however many replicas you see fit by setting the appropriate policy. If you mirrored all queues across all nodes, you'd find that hurts performance. If you mirror no queues, you might loose data if one of your nodes crashes.

Now, to Michael's point: what do *you* want to do here? Scalability is an almost meaningless term used in isolation. Are you trying to achieve:

* higher levels of throughput than a single node can manage?
* higher levels of availability/resilience just in case one or more nodes crash?
* ability to add more capacity (e.g., # clients, volume of work/throughput, etc) to a live system?
* etc??

Note that the &quot;A&quot; in HA stands for &quot;Availability&quot; not &quot;throughput&quot; or &quot;performance&quot;, though we think that acceptable levels of throughput and performance are achievable with mirror queues, considering the compromises necessary to guarantee consistency and avoid data loss.

Other options for utilising clusters include load balancing in front of the cluster, using federation or the shovel plugin instead of clustering to distribute messages between nodes (or data centres).

Cheers,
Tim
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028023.html">[rabbitmq-discuss] Simultaneous Scalability and HA
</A></li>
	<LI>Next message: <A HREF="028025.html">[rabbitmq-discuss] Simultaneous Scalability and HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28024">[ date ]</a>
              <a href="thread.html#28024">[ thread ]</a>
              <a href="subject.html#28024">[ subject ]</a>
              <a href="author.html#28024">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
