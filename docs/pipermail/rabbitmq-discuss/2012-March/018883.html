<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Multithreading and rabbitmq-c
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Multithreading%20and%20rabbitmq-c&In-Reply-To=%3CCAAt2poLRE7qrc350QQTpxd934kpX7%2B1DuRUQGzYfB9y08mVNKw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018881.html">
   <LINK REL="Next"  HREF="018884.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Multithreading and rabbitmq-c</H1>
    <B>Alan Antonuk</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Multithreading%20and%20rabbitmq-c&In-Reply-To=%3CCAAt2poLRE7qrc350QQTpxd934kpX7%2B1DuRUQGzYfB9y08mVNKw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Multithreading and rabbitmq-c">alan.antonuk at gmail.com
       </A><BR>
    <I>Thu Mar 15 14:43:02 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018881.html">[rabbitmq-discuss] Multithreading and rabbitmq-c
</A></li>
        <LI>Next message: <A HREF="018884.html">[rabbitmq-discuss] Multithreading and rabbitmq-c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18883">[ date ]</a>
              <a href="thread.html#18883">[ thread ]</a>
              <a href="subject.html#18883">[ subject ]</a>
              <a href="author.html#18883">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Inlined:

-Alan

On Thu, Mar 15, 2012 at 9:57 AM, Artsiom &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">u2.storm at gmail.com</A>&gt; wrote:

&gt;<i>  I some questions concerning multithreading and using multiple channels
</I>&gt;<i> within single connection.
</I>&gt;<i>
</I>&gt;<i> Is structure amqp_connection_state_t is thread-safe?
</I>&gt;<i> Can I share connection between threads and at the same time
</I>&gt;<i> use separate channel for each thread in producer app? and in consumer app?
</I>&gt;<i>
</I>
The amqp_connection_state_t object is not synchronized. In order to use it
from multiple threads you would have to synchronize its use across threads
(provide some external mutual exclusion when calling any amqp_* function
that uses a common amqp_connection_state_t).


&gt;<i> The second part of the question(about consumer) is needed to be explained.
</I>&gt;<i> When I looked at API, I didn't find any difficulties to use many channels
</I>&gt;<i> within single connection
</I>&gt;<i> in producer app, because each method (declare queue\exchange, bind,
</I>&gt;<i> publish &amp; etc) has
</I>&gt;<i> &quot;channel&quot; parameter.
</I>&gt;<i>
</I>&gt;<i> But in consumer app, where it is needed to receive messages (or frames as
</I>&gt;<i> shown in example .c-files),
</I>&gt;<i> we have to call wait_for_single_frame method, which is lack of &quot;channel&quot;
</I>&gt;<i> method.
</I>&gt;<i> Could you give an advice how to organize &quot;multichannel&quot; message fetch from
</I>&gt;<i> one queue?
</I>&gt;<i>
</I>
The API for consuming messages is pretty low-level at this point.  In order
to consume from multiple channels you need to read messages from all the
channels using amqp_simple_wait_frame, then provide your own logic to
handle messages from different channels appropriately.

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *OR*
</I>&gt;<i> It is better to use separate connection for each thread and have no
</I>&gt;<i> problems? :)
</I>&gt;<i>
</I>&gt;<i> That would the the easiest way to get started.
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120315/9d238a39/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120315/9d238a39/attachment.htm</A>&gt;
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018881.html">[rabbitmq-discuss] Multithreading and rabbitmq-c
</A></li>
	<LI>Next message: <A HREF="018884.html">[rabbitmq-discuss] Multithreading and rabbitmq-c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18883">[ date ]</a>
              <a href="thread.html#18883">[ thread ]</a>
              <a href="subject.html#18883">[ subject ]</a>
              <a href="author.html#18883">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
