<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Per-Connection%20Flow%20Control%20-%20RMQ%202.8.1&In-Reply-To=%3C4F704404.8080504%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019100.html">
   <LINK REL="Next"  HREF="019144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Per-Connection%20Flow%20Control%20-%20RMQ%202.8.1&In-Reply-To=%3C4F704404.8080504%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1">simon at rabbitmq.com
       </A><BR>
    <I>Mon Mar 26 11:25:08 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019100.html">[rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1
</A></li>
        <LI>Next message: <A HREF="019144.html">[rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19114">[ date ]</a>
              <a href="thread.html#19114">[ thread ]</a>
              <a href="subject.html#19114">[ subject ]</a>
              <a href="author.html#19114">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi.

There's no way to monitor what the flow control is doing.

I would assume that with 7k msg/s on 2.7.1 you see memory use steadily 
increasing? The flow control should just be preventing (significant 
numbers of) messages being queued up anywhere else than in queues. The 
idea is to ensure that whatever performance RabbitMQ is giving you is 
sustainable, rather than letting it absorb more messages in the short 
term at the cost of working itself into a hole that is difficult to get 
out of.

If you need the ability to absorb spikes in publishing rates then you 
can increase the size of TCP buffers on the server.

Cheers, Simon

On 23/03/12 20:03, DawgTool wrote:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> Wondering is anyone having issues with the Per-Connection Flow Control
</I>&gt;<i> in 2.8.1?
</I>&gt;<i> Under 2.7.1 was able to push about 4.5MB/s per connection (about
</I>&gt;<i> ~7000msg/s).
</I>&gt;<i> Under 2.8.1 I am hitting the flow control constantly at about 2.4MB/s
</I>&gt;<i> per connection.
</I>&gt;<i> Clean installed 2.8.1 on the same hardware as 2.7.1.
</I>&gt;<i>
</I>&gt;<i> Is there someway to configure/monitor what is causing the Flow Control
</I>&gt;<i> to be tripped?
</I>&gt;<i>
</I>&gt;<i> Thanks in Advance.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Config: (both 2.7.1/2.8.1)
</I>&gt;<i> Erlang R15B (erts-5.9) [source] [64-bit] [smp:4:4] [async-threads:30]
</I>&gt;<i> [hipe] [kernel-poll:true]
</I>&gt;<i>
</I>&gt;<i> ==&gt; enabled_plugins &lt;==
</I>&gt;<i> [rabbitmq_management,rabbitmq_management_agent].
</I>&gt;<i>
</I>&gt;<i> ==&gt; rabbitmq.config &lt;==
</I>&gt;<i> [
</I>&gt;<i> {rabbit, [{vm_memory_high_watermark, 0.6},
</I>&gt;<i> {collect_statistics_interval, 5000},
</I>&gt;<i> {hipe_compile, true}
</I>&gt;<i> ]
</I>&gt;<i> },
</I>&gt;<i> {mnesia, [{dc_dump_limit, 40},
</I>&gt;<i> {dump_log_write_threshold, 50000},
</I>&gt;<i> {no_table_loaders, 20},
</I>&gt;<i> {send_compressed, 9},
</I>&gt;<i> {snmp, true}
</I>&gt;<i> ]
</I>&gt;<i> },
</I>&gt;<i> {rabbitmq_management, [ {http_log_dir,
</I>&gt;<i> &quot;/data/rabbitmq/dc001/rabbit-mgmt&quot;} ] },
</I>&gt;<i> {rabbitmq_management_agent, [ {force_fine_statistics, true} ] }
</I>&gt;<i> ].
</I>&gt;<i>
</I>&gt;<i> ==&gt; rabbitmq-env.conf &lt;==
</I>&gt;<i> NODENAME=dc001
</I>&gt;<i> BASE=/data/rabbitmq/dc001
</I>&gt;<i> MNESIA_BASE=/data/rabbitmq/dc001/mnesia
</I>&gt;<i> LOG_BASE=/data/rabbitmq/dc001/log
</I>&gt;<i> SERVER_START_ARGS=&quot;+K true -smp enable&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019100.html">[rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1
</A></li>
	<LI>Next message: <A HREF="019144.html">[rabbitmq-discuss] Per-Connection Flow Control - RMQ 2.8.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19114">[ date ]</a>
              <a href="thread.html#19114">[ thread ]</a>
              <a href="subject.html#19114">[ subject ]</a>
              <a href="author.html#19114">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
