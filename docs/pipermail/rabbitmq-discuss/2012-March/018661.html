<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 2.6.1 is unexpectedly eating up	memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.6.1%20is%20unexpectedly%20eating%20up%0A%09memory&In-Reply-To=%3C4F58E1D8.7010601%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018630.html">
   <LINK REL="Next"  HREF="018608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 2.6.1 is unexpectedly eating up	memory</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.6.1%20is%20unexpectedly%20eating%20up%0A%09memory&In-Reply-To=%3C4F58E1D8.7010601%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ 2.6.1 is unexpectedly eating up	memory">simon at rabbitmq.com
       </A><BR>
    <I>Thu Mar  8 16:44:08 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018630.html">[rabbitmq-discuss] RabbitMQ 2.6.1 is unexpectedly eating up memory
</A></li>
        <LI>Next message: <A HREF="018608.html">[rabbitmq-discuss] Experimental RabbitMQ-C client - consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18661">[ date ]</a>
              <a href="thread.html#18661">[ thread ]</a>
              <a href="subject.html#18661">[ subject ]</a>
              <a href="author.html#18661">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ingo, thanks for this.

It looks like your Rabbit is somewhat overloaded. When some parts of the 
broker (e.g. channels or queues) can't keep up, messages can build up 
waiting to get into them - potentially in an unbounded way, sending 
memory use very high.

The good news is the next release (2.8.0, available very soon I hope) 
will contain an internal flow control mechanism to bound the amount of 
memory that can be used when this happens.

Cheers, Simon

On 07/03/12 14:26, ingo schramm wrote:
&gt;<i> Today it happened again. When Rabbit had about 13G RAM usage on one node
</I>&gt;<i> (&lt;1G is the usual number), I connected to the node and got some infos. I
</I>&gt;<i> post these below. Unfortunately, I cannot see that much in the data
</I>&gt;<i> since I do not know what the processes are doing exactly inside Rabbit.
</I>&gt;<i>
</I>&gt;<i> After a while the system seemed to recover but irritated clients started
</I>&gt;<i> to connect in an unusual pattern and then - almost immediately - the RAM
</I>&gt;<i> usage executed a Big Bang, up to 55G allocated, the machine began to
</I>&gt;<i> swap ...
</I>&gt;<i>
</I>&gt;<i> Here is the dump of the 10 most memory consuming processes.
</I>&gt;<i>
</I>&gt;<i> (<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>)4&gt; erlang:memory().
</I>&gt;<i> [{total,14709955672},
</I>&gt;<i> {processes,9701451024},
</I>&gt;<i> {processes_used,9685449080},
</I>&gt;<i> {system,5008504648},
</I>&gt;<i> {atom,1318801},
</I>&gt;<i> {atom_used,1286285},
</I>&gt;<i> {binary,4901053992},
</I>&gt;<i> {code,15227889},
</I>&gt;<i> {ets,23180616}]
</I>&gt;<i>
</I>&gt;<i> [{{memory,1868315056},
</I>&gt;<i> &lt;0.21462.60&gt;,
</I>&gt;<i> [{current_function,{erl_eval,do_apply,5}},
</I>&gt;<i> {initial_call,{erlang,apply,2}},
</I>&gt;<i> {status,running},
</I>&gt;<i> {message_queue_len,0},
</I>&gt;<i> {messages,[]},
</I>&gt;<i> {links,[&lt;0.21461.60&gt;]},
</I>&gt;<i> {dictionary,[]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;18922.32.0&gt;},
</I>&gt;<i> {total_heap_size,233539280},
</I>&gt;<i> {heap_size,116769640},
</I>&gt;<i> {stack_size,88},
</I>&gt;<i> {reductions,8019756},
</I>&gt;<i> {garbage_collection,[{fullsweep_after,65535},{minor_gcs,1}]},
</I>&gt;<i> {suspending,[]}]},
</I>&gt;<i> {{memory,1826853040},
</I>&gt;<i> &lt;0.252.0&gt;,
</I>&gt;<i> [{current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,3},
</I>&gt;<i> {messages,[{'$gen_cast',{notify_sent,&lt;0.26233.60&gt;}},
</I>&gt;<i> {'$gen_cast',{ack,[128755027],&lt;0.22877.60&gt;}},
</I>&gt;<i> {'$gen_cast',{unblock,&lt;0.22877.60&gt;}}]},
</I>&gt;<i> {links,[#Port&lt;0.162932&gt;,&lt;0.250.0&gt;,#Port&lt;0.4466&gt;]},
</I>&gt;<i> {dictionary,[{{ch,&lt;0.30314.59&gt;},
</I>&gt;<i> {cr,1,&lt;0.30314.59&gt;,
</I>&gt;<i> {token,&lt;0.30313.59&gt;,true},
</I>&gt;<i> #Ref&lt;0.0.913.261747&gt;,
</I>&gt;<i> {set,1,16,16,8,80,...},
</I>&gt;<i> true,1}},
</I>&gt;<i> {{ch,&lt;0.11679.60&gt;},
</I>&gt;<i> {cr,1,&lt;0.11679.60&gt;,
</I>&gt;<i> {token,&lt;0.11678.60&gt;,true},
</I>&gt;<i> #Ref&lt;0.0.916.161564&gt;,
</I>&gt;<i> {set,1,16,16,8,...},
</I>&gt;<i> true,0}},
</I>&gt;<i> {{ch,&lt;0.29890.59&gt;},
</I>&gt;<i> {cr,1,&lt;0.29890.59&gt;,
</I>&gt;<i> {token,&lt;0.29889.59&gt;,true},
</I>&gt;<i> #Ref&lt;0.0.913.256520&gt;,
</I>&gt;<i> {set,1,16,16,...},
</I>&gt;<i> true,1}},
</I>&gt;<i> {{ch,&lt;0.24130.59&gt;},
</I>&gt;<i> {cr,1,&lt;0.24130.59&gt;,
</I>&gt;<i> {token,&lt;0.24129.59&gt;,true},
</I>&gt;<i> #Ref&lt;0.0.912.149255&gt;,
</I>&gt;<i> {set,1,16,...},
</I>&gt;<i> true,1}},
</I>&gt;<i> {{ch,&lt;0.21656.59&gt;},
</I>&gt;<i> {cr,1,&lt;0.21656.59&gt;,
</I>&gt;<i> {token,&lt;0.21655.59&gt;,true},
</I>&gt;<i> #Ref&lt;0.0.911.188523&gt;,
</I>&gt;<i> {set,1,...},
</I>&gt;<i> true,1}},
</I>&gt;<i> {{ch,&lt;0.15601.60&gt;},
</I>&gt;<i> {cr,1,&lt;0.15601.60&gt;,
</I>&gt;<i> {token,&lt;0.15600.60&gt;,true},
</I>&gt;<i> #Ref&lt;0.0.917.100808&gt;,
</I>&gt;<i> {set,...},
</I>&gt;<i> true,...}},
</I>&gt;<i> {{ch,&lt;15215.21015.63&gt;},
</I>&gt;<i> {cr,1,&lt;15215.21015.63&gt;,
</I>&gt;<i> {token,&lt;15215.21014.63&gt;,...},
</I>&gt;<i> #Ref&lt;0.0.815.242631&gt;,{...},...}},
</I>&gt;<i> {{ch,&lt;0.21015.12&gt;},
</I>&gt;<i> {cr,1,&lt;0.21015.12&gt;,{token,...},#Ref&lt;0.0.295.125075&gt;,...}},
</I>&gt;<i> {{ch,&lt;0.17432.59&gt;},{cr,1,&lt;0.17432.59&gt;,{...},...}},
</I>&gt;<i> {{ch,&lt;0.9598.46&gt;},{cr,1,&lt;0.9598.46&gt;,...}},
</I>&gt;<i> {{ch,&lt;15215.20479.63&gt;},{cr,1,...}},
</I>&gt;<i> {{ch,&lt;0.24362.59&gt;},{cr,...}},
</I>&gt;<i> {{ch,...},{...}},
</I>&gt;<i> {{...},...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {trap_exit,true},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,228065700},
</I>&gt;<i> {heap_size,228065700},
</I>&gt;<i> {stack_size,48},
</I>&gt;<i> {reductions,86360443586},
</I>&gt;<i> {garbage_collection,[{fullsweep_after,65535},{minor_gcs,0}]},
</I>&gt;<i> {suspending,[]}]},
</I>&gt;<i> {{memory,544009512},
</I>&gt;<i> &lt;0.218.0&gt;,
</I>&gt;<i> [{registered_name,delegate_11},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,45210},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,67810415},
</I>&gt;<i> {heap_size,8024355},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,536435169},
</I>&gt;<i> {garbage_collection,[{fullsweep_after,65535},{minor_gcs,1}]},
</I>&gt;<i> {suspending,[]}]},
</I>&gt;<i> {{memory,544003272},
</I>&gt;<i> &lt;0.213.0&gt;,
</I>&gt;<i> [{registered_name,delegate_6},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,45000},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_call',{&lt;15215.4753.67&gt;,
</I>&gt;<i> {#Ref&lt;15215.0.573.141891&gt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,ram2 at tarazed</A>}},
</I>&gt;<i> {invoke,#Fun&lt;rabbit_amqqueue.22.114209891&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,67810415},
</I>&gt;<i> {heap_size,8024355},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,492300563},
</I>&gt;<i> {garbage_collection,[{fullsweep_after,65535},
</I>&gt;<i> {minor_gcs,...}]},
</I>&gt;<i> {suspending,[]}]},
</I>&gt;<i> {{memory,543937016},
</I>&gt;<i> &lt;0.220.0&gt;,
</I>&gt;<i> [{registered_name,delegate_13},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,43117},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,67810415},
</I>&gt;<i> {heap_size,8024355},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,516829717},
</I>&gt;<i> {garbage_collection,[{fullsweep_after,...},{...}]},
</I>&gt;<i> {suspending,[]}]},
</I>&gt;<i> {{memory,509272344},
</I>&gt;<i> &lt;0.208.0&gt;,
</I>&gt;<i> [{registered_name,delegate_1},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,36921},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_amqqueue.23.2473037&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,63501410},
</I>&gt;<i> {heap_size,15672560},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,481258527},
</I>&gt;<i> {garbage_collection,[{...}|...]},
</I>&gt;<i> {suspending,[]}]},
</I>&gt;<i> {{memory,484092056},
</I>&gt;<i> &lt;0.209.0&gt;,
</I>&gt;<i> [{registered_name,delegate_2},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,33987},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,60366900},
</I>&gt;<i> {heap_size,12538050},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,439896730},
</I>&gt;<i> {garbage_collection,[...]},
</I>&gt;<i> {suspending,...}]},
</I>&gt;<i> {{memory,383857832},
</I>&gt;<i> &lt;0.207.0&gt;,
</I>&gt;<i> [{registered_name,delegate_0},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,36015},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[&lt;0.252.0&gt;]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,47828850},
</I>&gt;<i> {heap_size,47828850},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,464166560},
</I>&gt;<i> {garbage_collection,...},
</I>&gt;<i> {...}]},
</I>&gt;<i> {{memory,322186712},
</I>&gt;<i> &lt;0.214.0&gt;,
</I>&gt;<i> [{registered_name,delegate_7},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,25955},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,[...]}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,7}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,40160935},
</I>&gt;<i> {heap_size,15672560},
</I>&gt;<i> {stack_size,32},
</I>&gt;<i> {reductions,...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {{memory,245833600},
</I>&gt;<i> &lt;0.212.0&gt;,
</I>&gt;<i> [{registered_name,delegate_5},
</I>&gt;<i> {current_function,{gen,wait_resp_mon,3}},
</I>&gt;<i> {initial_call,{proc_lib,init_p,5}},
</I>&gt;<i> {status,waiting},
</I>&gt;<i> {message_queue_len,27354},
</I>&gt;<i> {messages,[{'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ram2 at tarazed</A>,...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,
</I>&gt;<i> [{...}]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,[...]}},
</I>&gt;<i> {'$gen_cast',{invoke,#Fun&lt;rabbit_router.0.66097277&gt;,...}},
</I>&gt;<i> {'$gen_cast',{invoke,...}},
</I>&gt;<i> {'$gen_cast',{...}},
</I>&gt;<i> {'$gen_cast',...},
</I>&gt;<i> {...}|...]},
</I>&gt;<i> {links,[&lt;0.206.0&gt;]},
</I>&gt;<i> {dictionary,[{'$ancestors',[delegate_sup,rabbit_sup,
</I>&gt;<i> &lt;0.109.0&gt;]},
</I>&gt;<i> {'$initial_call',{gen,init_it,...}}]},
</I>&gt;<i> {trap_exit,false},
</I>&gt;<i> {error_handler,error_handler},
</I>&gt;<i> {priority,normal},
</I>&gt;<i> {group_leader,&lt;0.108.0&gt;},
</I>&gt;<i> {total_heap_size,30610465},
</I>&gt;<i> {heap_size,30610465},
</I>&gt;<i> {stack_size,...},
</I>&gt;<i> {...}|...]}]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am Dienstag, 6. M&#228;rz 2012 13:15:41 UTC+1 schrieb Simon MacMullen:
</I>&gt;<i>
</I>&gt;<i>     On 06/03/12 11:38, ingo schramm wrote:
</I>&gt;<i>      &gt; I do *not* use a mirrored queue :)
</I>&gt;<i>
</I>&gt;<i>     Ah, right, that's how I read &quot;queues distributed over all nodes&quot;.
</I>&gt;<i>
</I>&gt;<i>     Hmm. It's still easier to figure out the memory use of RabbitMQ on
</I>&gt;<i>     2.7.1, but for 2.6.1 you could check per-queue memory use with
</I>&gt;<i>     &quot;rabbitmqctl list_queues name memory&quot; (or look in mgmt). If this
</I>&gt;<i>     doesn't
</I>&gt;<i>     bring anything useful up then:
</I>&gt;<i>
</I>&gt;<i>     * Become the user the broker is running as
</I>&gt;<i>     * Run &quot;erl -sname foo -remsh rabbit@$(hostname -s)&quot; to get a shell into
</I>&gt;<i>     the running broker
</I>&gt;<i>     * Invoke &quot;erlang:memory().&quot; for an overview of memory use in the VM.
</I>&gt;<i>     * Invoke &quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid,
</I>&gt;<i>     memory), Pid, process_info(Pid)} || Pid &lt;- processes()])), 10).&quot; for a
</I>&gt;<i>     lit of the top 10 memory using processes, and some information on
</I>&gt;<i>     each one.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     Simon MacMullen
</I>&gt;<i>     RabbitMQ, VMware
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am Dienstag, 6. M&#228;rz 2012 13:15:41 UTC+1 schrieb Simon MacMullen:
</I>&gt;<i>
</I>&gt;<i>     On 06/03/12 11:38, ingo schramm wrote:
</I>&gt;<i>      &gt; I do *not* use a mirrored queue :)
</I>&gt;<i>
</I>&gt;<i>     Ah, right, that's how I read &quot;queues distributed over all nodes&quot;.
</I>&gt;<i>
</I>&gt;<i>     Hmm. It's still easier to figure out the memory use of RabbitMQ on
</I>&gt;<i>     2.7.1, but for 2.6.1 you could check per-queue memory use with
</I>&gt;<i>     &quot;rabbitmqctl list_queues name memory&quot; (or look in mgmt). If this
</I>&gt;<i>     doesn't
</I>&gt;<i>     bring anything useful up then:
</I>&gt;<i>
</I>&gt;<i>     * Become the user the broker is running as
</I>&gt;<i>     * Run &quot;erl -sname foo -remsh rabbit@$(hostname -s)&quot; to get a shell into
</I>&gt;<i>     the running broker
</I>&gt;<i>     * Invoke &quot;erlang:memory().&quot; for an overview of memory use in the VM.
</I>&gt;<i>     * Invoke &quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid,
</I>&gt;<i>     memory), Pid, process_info(Pid)} || Pid &lt;- processes()])), 10).&quot; for a
</I>&gt;<i>     lit of the top 10 memory using processes, and some information on
</I>&gt;<i>     each one.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     Simon MacMullen
</I>&gt;<i>     RabbitMQ, VMware
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am Dienstag, 6. M&#228;rz 2012 13:15:41 UTC+1 schrieb Simon MacMullen:
</I>&gt;<i>
</I>&gt;<i>     On 06/03/12 11:38, ingo schramm wrote:
</I>&gt;<i>      &gt; I do *not* use a mirrored queue :)
</I>&gt;<i>
</I>&gt;<i>     Ah, right, that's how I read &quot;queues distributed over all nodes&quot;.
</I>&gt;<i>
</I>&gt;<i>     Hmm. It's still easier to figure out the memory use of RabbitMQ on
</I>&gt;<i>     2.7.1, but for 2.6.1 you could check per-queue memory use with
</I>&gt;<i>     &quot;rabbitmqctl list_queues name memory&quot; (or look in mgmt). If this
</I>&gt;<i>     doesn't
</I>&gt;<i>     bring anything useful up then:
</I>&gt;<i>
</I>&gt;<i>     * Become the user the broker is running as
</I>&gt;<i>     * Run &quot;erl -sname foo -remsh rabbit@$(hostname -s)&quot; to get a shell into
</I>&gt;<i>     the running broker
</I>&gt;<i>     * Invoke &quot;erlang:memory().&quot; for an overview of memory use in the VM.
</I>&gt;<i>     * Invoke &quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid,
</I>&gt;<i>     memory), Pid, process_info(Pid)} || Pid &lt;- processes()])), 10).&quot; for a
</I>&gt;<i>     lit of the top 10 memory using processes, and some information on
</I>&gt;<i>     each one.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     Simon MacMullen
</I>&gt;<i>     RabbitMQ, VMware
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am Dienstag, 6. M&#228;rz 2012 13:15:41 UTC+1 schrieb Simon MacMullen:
</I>&gt;<i>
</I>&gt;<i>     On 06/03/12 11:38, ingo schramm wrote:
</I>&gt;<i>      &gt; I do *not* use a mirrored queue :)
</I>&gt;<i>
</I>&gt;<i>     Ah, right, that's how I read &quot;queues distributed over all nodes&quot;.
</I>&gt;<i>
</I>&gt;<i>     Hmm. It's still easier to figure out the memory use of RabbitMQ on
</I>&gt;<i>     2.7.1, but for 2.6.1 you could check per-queue memory use with
</I>&gt;<i>     &quot;rabbitmqctl list_queues name memory&quot; (or look in mgmt). If this
</I>&gt;<i>     doesn't
</I>&gt;<i>     bring anything useful up then:
</I>&gt;<i>
</I>&gt;<i>     * Become the user the broker is running as
</I>&gt;<i>     * Run &quot;erl -sname foo -remsh rabbit@$(hostname -s)&quot; to get a shell into
</I>&gt;<i>     the running broker
</I>&gt;<i>     * Invoke &quot;erlang:memory().&quot; for an overview of memory use in the VM.
</I>&gt;<i>     * Invoke &quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid,
</I>&gt;<i>     memory), Pid, process_info(Pid)} || Pid &lt;- processes()])), 10).&quot; for a
</I>&gt;<i>     lit of the top 10 memory using processes, and some information on
</I>&gt;<i>     each one.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     Simon MacMullen
</I>&gt;<i>     RabbitMQ, VMware
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am Dienstag, 6. M&#228;rz 2012 13:15:41 UTC+1 schrieb Simon MacMullen:
</I>&gt;<i>
</I>&gt;<i>     On 06/03/12 11:38, ingo schramm wrote:
</I>&gt;<i>      &gt; I do *not* use a mirrored queue :)
</I>&gt;<i>
</I>&gt;<i>     Ah, right, that's how I read &quot;queues distributed over all nodes&quot;.
</I>&gt;<i>
</I>&gt;<i>     Hmm. It's still easier to figure out the memory use of RabbitMQ on
</I>&gt;<i>     2.7.1, but for 2.6.1 you could check per-queue memory use with
</I>&gt;<i>     &quot;rabbitmqctl list_queues name memory&quot; (or look in mgmt). If this
</I>&gt;<i>     doesn't
</I>&gt;<i>     bring anything useful up then:
</I>&gt;<i>
</I>&gt;<i>     * Become the user the broker is running as
</I>&gt;<i>     * Run &quot;erl -sname foo -remsh rabbit@$(hostname -s)&quot; to get a shell into
</I>&gt;<i>     the running broker
</I>&gt;<i>     * Invoke &quot;erlang:memory().&quot; for an overview of memory use in the VM.
</I>&gt;<i>     * Invoke &quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid,
</I>&gt;<i>     memory), Pid, process_info(Pid)} || Pid &lt;- processes()])), 10).&quot; for a
</I>&gt;<i>     lit of the top 10 memory using processes, and some information on
</I>&gt;<i>     each one.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     Simon MacMullen
</I>&gt;<i>     RabbitMQ, VMware
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Am Dienstag, 6. M&#228;rz 2012 13:15:41 UTC+1 schrieb Simon MacMullen:
</I>&gt;<i>
</I>&gt;<i>     On 06/03/12 11:38, ingo schramm wrote:
</I>&gt;<i>      &gt; I do *not* use a mirrored queue :)
</I>&gt;<i>
</I>&gt;<i>     Ah, right, that's how I read &quot;queues distributed over all nodes&quot;.
</I>&gt;<i>
</I>&gt;<i>     Hmm. It's still easier to figure out the memory use of RabbitMQ on
</I>&gt;<i>     2.7.1, but for 2.6.1 you could check per-queue memory use with
</I>&gt;<i>     &quot;rabbitmqctl list_queues name memory&quot; (or look in mgmt). If this
</I>&gt;<i>     doesn't
</I>&gt;<i>     bring anything useful up then:
</I>&gt;<i>
</I>&gt;<i>     * Become the user the broker is running as
</I>&gt;<i>     * Run &quot;erl -sname foo -remsh rabbit@$(hostname -s)&quot; to get a shell into
</I>&gt;<i>     the running broker
</I>&gt;<i>     * Invoke &quot;erlang:memory().&quot; for an overview of memory use in the VM.
</I>&gt;<i>     * Invoke &quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid,
</I>&gt;<i>     memory), Pid, process_info(Pid)} || Pid &lt;- processes()])), 10).&quot; for a
</I>&gt;<i>     lit of the top 10 memory using processes, and some information on
</I>&gt;<i>     each one.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>     --
</I>&gt;<i>     Simon MacMullen
</I>&gt;<i>     RabbitMQ, VMware
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>     &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018630.html">[rabbitmq-discuss] RabbitMQ 2.6.1 is unexpectedly eating up memory
</A></li>
	<LI>Next message: <A HREF="018608.html">[rabbitmq-discuss] Experimental RabbitMQ-C client - consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18661">[ date ]</a>
              <a href="thread.html#18661">[ thread ]</a>
              <a href="subject.html#18661">[ subject ]</a>
              <a href="author.html#18661">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
