<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss]  atomic transactions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%20atomic%20transactions&In-Reply-To=%3C33544596.post%40talk.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019057.html">
   <LINK REL="Next"  HREF="019083.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss]  atomic transactions</H1>
    <B>gaillard</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%20atomic%20transactions&In-Reply-To=%3C33544596.post%40talk.nabble.com%3E"
       TITLE="[rabbitmq-discuss]  atomic transactions">jonathan.gaillard at dominionenterprises.com
       </A><BR>
    <I>Thu Mar 22 03:39:59 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019057.html">[rabbitmq-discuss] Pika warning (after write buffer exceeded)	causes exception
</A></li>
        <LI>Next message: <A HREF="019083.html">[rabbitmq-discuss] atomic transactions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19058">[ date ]</a>
              <a href="thread.html#19058">[ thread ]</a>
              <a href="subject.html#19058">[ subject ]</a>
              <a href="author.html#19058">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello everyone,

I have need to use transactions in the following way:
-get a message (m1) from queue A
-transforms the message and create new message (m2)
-publish m2 to queue B
-ack m1
-commit the transaction (includes ack and publish)

Which i believe in all failure scenarios should result in possibly two
things:
m1 on queue A, nothing on queue B
m2 on queue B, nothing on queue A

Is this what will happen in rabbit 2.7 or 2.8?

Note: the need above has nothing to do with how to detect that m1 got
delivered a second time or ensuring that cant happen (which of course it
could and should if it dies while transforming)

What I wouldn't expect to see would be m1 on queue A AND m2 on queue B

----------
As a simple example of a situation that I believe requires support of the
above, is a single queue with one or two message on it. Multiple consumers
on the queue that process each message and then put it back on the queue to
be picked up again. After a crash there shouldn't be two copies of the same
message on the queue.

By having a transaction that just picks up and publishes back to the same
queue and commits, I would think that example could be achieved with rabbit
2.7 or 2.8 from everything I have read in the mailing list, is that correct?

Thanks !!!


-- 
View this message in context: <A HREF="http://old.nabble.com/atomic-transactions-tp33544596p33544596.html">http://old.nabble.com/atomic-transactions-tp33544596p33544596.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.

</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019057.html">[rabbitmq-discuss] Pika warning (after write buffer exceeded)	causes exception
</A></li>
	<LI>Next message: <A HREF="019083.html">[rabbitmq-discuss] atomic transactions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19058">[ date ]</a>
              <a href="thread.html#19058">[ thread ]</a>
              <a href="subject.html#19058">[ subject ]</a>
              <a href="author.html#19058">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
