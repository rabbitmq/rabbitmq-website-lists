<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Inconsistent queue synchronization behavior
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Inconsistent%20queue%20synchronization%20behavior&In-Reply-To=%3CCB850D3D.3295D%25mpietrek%40skytap.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018804.html">
   <LINK REL="Next"  HREF="018824.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Inconsistent queue synchronization behavior</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Inconsistent%20queue%20synchronization%20behavior&In-Reply-To=%3CCB850D3D.3295D%25mpietrek%40skytap.com%3E"
       TITLE="[rabbitmq-discuss] Inconsistent queue synchronization behavior">mpietrek at skytap.com
       </A><BR>
    <I>Tue Mar 13 21:42:05 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018804.html">[rabbitmq-discuss] Throttling when Fast Producer, Slow Consumer
</A></li>
        <LI>Next message: <A HREF="018824.html">[rabbitmq-discuss] Inconsistent queue synchronization behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18788">[ date ]</a>
              <a href="thread.html#18788">[ thread ]</a>
              <a href="subject.html#18788">[ subject ]</a>
              <a href="author.html#18788">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm experiencing a problem with mirrored queue synchronization, and I'm
trying to determine if there's a bug or I'm just not understanding
something.

Our setup:
* RabbitMQ 2.71 on 64-bit Ubuntu 10.04.
* Three brokers with all queues mirrored
* Web Management plugin installed

We typically have five queues defined, all mirrored. If I observe them in
the &quot;Queues tab&quot; of the Management UI, they all have a green &quot;+2&quot; after the
Node name. They're all mastered on the same Node.

None of these queues have any messages, and there are no clients connected,
sending or receiving messages.

If I stop one of the brokers, all the &quot;+2&quot;s become &quot;+1&quot;, as expected.
However, when I restart the broker a couple of seconds later, some subset of
the queues (varies from run to run) go back to &quot;+2&quot;, while the remaining
queues switch to &quot;+1  +1&quot;, meaning 1 synched, and 1 unsynched.

Given that there are no messages in the queue, I don't understand why some
queues don't synch back up properly.

Also, I've looked at the sync status of the queues in rabbitmqctl, and the
results seem consistent with what the HTTP API reports.

Matt



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120313/b7eef667/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120313/b7eef667/attachment.htm</A>&gt;
</PRE>





























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018804.html">[rabbitmq-discuss] Throttling when Fast Producer, Slow Consumer
</A></li>
	<LI>Next message: <A HREF="018824.html">[rabbitmq-discuss] Inconsistent queue synchronization behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18788">[ date ]</a>
              <a href="thread.html#18788">[ thread ]</a>
              <a href="subject.html#18788">[ subject ]</a>
              <a href="author.html#18788">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
