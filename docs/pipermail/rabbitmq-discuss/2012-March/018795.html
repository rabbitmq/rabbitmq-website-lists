<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%20with%20running%20two%20RabbitMQ%20servers%20on%0A%09one%20machine&In-Reply-To=%3CCALD4NQYT_qRY_KMV2c6RfQnDq-NQDiPDbOEzwZ8SiX%2B%3D2Lh62A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018774.html">
   <LINK REL="Next"  HREF="018805.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine</H1>
    <B>Brian Jing</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%20with%20running%20two%20RabbitMQ%20servers%20on%0A%09one%20machine&In-Reply-To=%3CCALD4NQYT_qRY_KMV2c6RfQnDq-NQDiPDbOEzwZ8SiX%2B%3D2Lh62A%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine">brian.newsgroup at gmail.com
       </A><BR>
    <I>Wed Mar 14 00:26:48 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018774.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on one	machine
</A></li>
        <LI>Next message: <A HREF="018805.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on one machine
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18795">[ date ]</a>
              <a href="thread.html#18795">[ thread ]</a>
              <a href="subject.html#18795">[ subject ]</a>
              <a href="author.html#18795">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Simon,

Thanks for your reply! So I guess we'll have to stick with Erlang R13B03
until we've completely made the transition to Rabbit 2.7.1.

I just had a look at the logs, you are right, the ssl port is not being
listened. What could be wrong here. Is there anything I need to do to
enable SSL when building it?

Here is the config file for rabbit 2.7.1. The 1.8.0 config file sits in the
same directory with the same content(except the port) but with a different
name.

[
    {rabbit, [
        {ssl_listeners, [{&quot;0.0.0.0&quot;,4445}]},
        {ssl_options, [
            {cacertfile,&quot;/etc/rabbitmq/certs/testca/cacert.pem&quot;},
            {certfile,&quot;/etc/rabbitmq/certs/server/cert.pem&quot;},
            {keyfile,&quot;/etc/rabbitmq/certs/server/key.pem&quot;},
            {verify, verify_peer},
            {fail_if_no_peer_cert, false}
        ]}

    ]}
].

When I start rabbit 2.7.1, I only see it starts to listen to the non-ssl
port as follows:

=INFO REPORT==== 14-Mar-2012::11:05:06 ===
Limiting to approx 924 file handles (829 sockets)

=INFO REPORT==== 14-Mar-2012::11:05:06 ===
Memory limit set to 1304MB of 3260MB total.

=INFO REPORT==== 14-Mar-2012::11:05:06 ===
msg_store_transient: using rabbit_msg_store_ets_index to provide index

=INFO REPORT==== 14-Mar-2012::11:05:07 ===
msg_store_persistent: using rabbit_msg_store_ets_index to provide index

=WARNING REPORT==== 14-Mar-2012::11:05:07 ===
msg_store_persistent: rebuilding indices from scratch

=INFO REPORT==== 14-Mar-2012::11:05:07 ===
started TCP Listener on [::]:4446

Cheers,

Brian

On Tue, Mar 13, 2012 at 10:53 PM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;wrote:

&gt;<i> On 13/03/12 03:21, Brian Jing wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> The problem is that although I have SSL configured for 2.7.1, only
</I>&gt;&gt;<i> non-SSl connections currently work. For any SSL connections, I get a
</I>&gt;&gt;<i> &quot;connection refused&quot; on the client side. I triple checked the SSL
</I>&gt;&gt;<i> certificates and saw no problems. However, when I list the status of the
</I>&gt;&gt;<i> 2.7.1 server , it says the following:
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That looks like Rabbit is not even trying to listen for SSL. Do you see
</I>&gt;<i> something like
</I>&gt;<i>
</I>&gt;<i> =INFO REPORT==== 13-Mar-2012::11:49:04 ===
</I>&gt;<i> started TCP Listener on [::]:5672
</I>&gt;<i>
</I>&gt;<i> =INFO REPORT==== 13-Mar-2012::11:49:04 ===
</I>&gt;<i> started SSL Listener on [::]:5671
</I>&gt;<i>
</I>&gt;<i> in the logs? Or is there an error? What does your config file look like?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  I noticed that ServerA doesn't have ssl in the &quot;running_application&quot;
</I>&gt;&gt;<i> list. Is this why SSL doesn't work? I'm pretty sure erlang R13B03 thats
</I>&gt;&gt;<i> currently running on ServerA supports SSL because rabbit 1.8.0 is using
</I>&gt;&gt;<i> it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What are my options here? Would updating Erlang on ServerA to the latest
</I>&gt;&gt;<i> version solve the problem? Would the latest Erlang be incompatible with
</I>&gt;&gt;<i> rabbitmq 1.8.0? If I were to still use Erlang R13B03, what shall I do to
</I>&gt;&gt;<i> make 2.7.1 work with SSL?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The SSL dependencies haven't changed much since 1.8.0. SSL support in
</I>&gt;<i> newer Erlang is more robust, but if it was working for you with R13B03 and
</I>&gt;<i> 1.8.0 then it should work with R13B03 and 2.7.1.
</I>&gt;<i>
</I>&gt;<i> I'm not sure, but I suspect Erlang R15B will not work with 1.8.0. Various
</I>&gt;<i> bits of deprecated API have been removed, and I imagine 1.8.0 used them.
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120314/39886277/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120314/39886277/attachment.htm</A>&gt;
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018774.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on one	machine
</A></li>
	<LI>Next message: <A HREF="018805.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on one machine
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18795">[ date ]</a>
              <a href="thread.html#18795">[ thread ]</a>
              <a href="subject.html#18795">[ subject ]</a>
              <a href="author.html#18795">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
