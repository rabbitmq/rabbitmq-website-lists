<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 2 unack messages for 1 process
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%202%20unack%20messages%20for%201%20process&In-Reply-To=%3C33A63ACC-0999-4608-8D61-0D07A293571F%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019039.html">
   <LINK REL="Next"  HREF="019040.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 2 unack messages for 1 process</H1>
    <B>Ask Solem</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%202%20unack%20messages%20for%201%20process&In-Reply-To=%3C33A63ACC-0999-4608-8D61-0D07A293571F%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] 2 unack messages for 1 process">ask at rabbitmq.com
       </A><BR>
    <I>Mon Mar 26 15:09:28 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019039.html">[rabbitmq-discuss] 2 unack messages for 1 process
</A></li>
        <LI>Next message: <A HREF="019040.html">[rabbitmq-discuss] Is it possible to remove unacked messages?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19131">[ date ]</a>
              <a href="thread.html#19131">[ thread ]</a>
              <a href="subject.html#19131">[ subject ]</a>
              <a href="author.html#19131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 21 Mar 2012, at 16:26, Paulo Cheque wrote:

&gt;<i> Hi, I am using Celery (<A HREF="http://celeryproject.org/">http://celeryproject.org/</A>) to produce and
</I>&gt;<i> consume RabbitMQ messages. Only one process of Celery consume
</I>&gt;<i> messages, so why can I see in Rabbit 2 unack messages at the same
</I>&gt;<i> time?
</I>&gt;<i> 
</I>&gt;<i> I understand Rabbit had 1 unack message for each consumer process.
</I>&gt;<i> 
</I>
See <A HREF="http://docs.celeryproject.org/en/latest/userguide/optimizing.html#prefetch-limits">http://docs.celeryproject.org/en/latest/userguide/optimizing.html#prefetch-limits</A>

Also, Celery has two 'ack' settings: early or late.
With early ack (default) the message is acknowledged *before* the
task is executed, with late ack it is acknowledged after.

So with early ack it may reserve an additional message even if the prefetch multiplier
is set to 1.


You should read this FAQ entry to understand why Celery uses the early ack behavior
by default: <A HREF="http://docs.celeryproject.org/en/latest/faq.html#should-i-use-retry-or-acks-late">http://docs.celeryproject.org/en/latest/faq.html#should-i-use-retry-or-acks-late</A>

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019039.html">[rabbitmq-discuss] 2 unack messages for 1 process
</A></li>
	<LI>Next message: <A HREF="019040.html">[rabbitmq-discuss] Is it possible to remove unacked messages?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19131">[ date ]</a>
              <a href="thread.html#19131">[ thread ]</a>
              <a href="subject.html#19131">[ subject ]</a>
              <a href="author.html#19131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
