<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm	randomly throwing exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RMQ%20Java%20Client%20-%20ChannelN.waitForConfirm%0A%09randomly%20throwing%20exceptions&In-Reply-To=%3CC9733A8F-F2BF-49BD-AD8A-84F5BF384A9A%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019224.html">
   <LINK REL="Next"  HREF="019245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm	randomly throwing exceptions</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RMQ%20Java%20Client%20-%20ChannelN.waitForConfirm%0A%09randomly%20throwing%20exceptions&In-Reply-To=%3CC9733A8F-F2BF-49BD-AD8A-84F5BF384A9A%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm	randomly throwing exceptions">steve at rabbitmq.com
       </A><BR>
    <I>Wed Mar 28 18:17:57 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019224.html">[rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm randomly throwing exceptions
</A></li>
        <LI>Next message: <A HREF="019245.html">[rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm randomly throwing exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19225">[ date ]</a>
              <a href="thread.html#19225">[ thread ]</a>
              <a href="subject.html#19225">[ subject ]</a>
              <a href="author.html#19225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Emanuele,

There should be no need to use AtomicInteger to guarantee a new channel
number; createChannel should guarantee this for you.

You have shown me the stack trace -- and I can see that your application
threads are issuing waitForConfirms().

Can you tell me a little more about how your threads use the Channel?
I'd like to know the state of the channel the thread is using, at the
time of the call. What happened on that channel immediately before the
waitForConfirms() call?

Perhaps some more snippets of the thread code would be useful, and a
little more of the stack trace would help.

Finally, was there anything in the rabbit log around this time?

Steve Powell  (a happy bunny)
----------some more definitions from the SPD----------
chinchilla (n.) Cooling device for the lower jaw.
socialcast (n.) Someone to whom everyone is speaking but nobody likes.
literacy (n.) A textually transmitted disease usually contracted in childhood.

On 28 Mar 2012, at 17:29, Emanuele Gheradini wrote:

&gt;<i> 
</I>&gt;<i> I want also to add that what I understood is:
</I>&gt;<i> 
</I>&gt;<i> for some reasons RabbitMQ java client gives the same channel (or channel
</I>&gt;<i> number) to different threads, then these threads will perform different
</I>&gt;<i> operations on that channel which will be closed by RabbitMQjavaclient, thus
</I>&gt;<i> resulting in the crash of the waitForConfirm method, at line 182 (here is
</I>&gt;<i> the snipped):
</I>&gt;<i> 
</I>&gt;<i> 181: if (getCloseReason() != null) {
</I>&gt;<i> 182:                  throw Utility.fixStackTrace(getCloseReason());
</I>&gt;<i> 183:               }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I tried getting channels from rabbit in this way:
</I>&gt;<i> 
</I>&gt;<i> AtomicInteger chanNumber = new AtomicInteger(0);
</I>&gt;<i> 
</I>&gt;<i> connection.createChannel(chanNumber.getAndIncrement());
</I>&gt;<i> 
</I>&gt;<i> to be sure that each thread gets a channel with a different channelNumber,
</I>&gt;<i> but this does not work either...
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I hope someone can give me a suggestion.
</I>&gt;<i> 
</I>&gt;<i> Thanks.
</I>&gt;<i> -- 
</I>&gt;<i> View this message in context: <A HREF="http://old.nabble.com/RMQ-Java-Client---ChannelN.waitForConfirm-randomly-throwing-exceptions-tp33544834p33544845.html">http://old.nabble.com/RMQ-Java-Client---ChannelN.waitForConfirm-randomly-throwing-exceptions-tp33544834p33544845.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019224.html">[rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm randomly throwing exceptions
</A></li>
	<LI>Next message: <A HREF="019245.html">[rabbitmq-discuss] RMQ Java Client - ChannelN.waitForConfirm randomly throwing exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19225">[ date ]</a>
              <a href="thread.html#19225">[ thread ]</a>
              <a href="subject.html#19225">[ subject ]</a>
              <a href="author.html#19225">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
