<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Federation Many Connections?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20Many%20Connections%3F&In-Reply-To=%3CCAJreXKDKUNCUBFkAQt7PNue7vQPj39Z3XtRhAiWhPAifu7FOyw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019184.html">
   <LINK REL="Next"  HREF="019186.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Federation Many Connections?</H1>
    <B>James Carr</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20Many%20Connections%3F&In-Reply-To=%3CCAJreXKDKUNCUBFkAQt7PNue7vQPj39Z3XtRhAiWhPAifu7FOyw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Federation Many Connections?">james.r.carr at gmail.com
       </A><BR>
    <I>Tue Mar 27 16:57:57 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019184.html">[rabbitmq-discuss] Federation Many Connections?
</A></li>
        <LI>Next message: <A HREF="019186.html">[rabbitmq-discuss] Federation Many Connections?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19185">[ date ]</a>
              <a href="thread.html#19185">[ thread ]</a>
              <a href="subject.html#19185">[ subject ]</a>
              <a href="author.html#19185">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The issue persists with version 2.8.1 as well. It seems to work okay
when a single downstream connects to the upstream, but when a cluster
connects to the upstream the node making the connection creates new
direct connections to itself each time it fails to bind to the
upstream exchange.

Attached is a screenshot from the management console and here is the
contents of my log file: <A HREF="https://gist.github.com/b8714347f97a86b34724.">https://gist.github.com/b8714347f97a86b34724.</A>
 The interesting thing to note is that the number of errors in the log
file correspond directly to the number of direct connections
dc2rabbitmq5 makes to itself (I cleared the logs before retrying
again).

Thanks,
James

On Tue, Mar 27, 2012 at 10:38 AM, James Carr &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">james.r.carr at gmail.com</A>&gt; wrote:
&gt;<i> So I investigated why it seems that one of the nodes in my test
</I>&gt;<i> cluster wind up have hundreds of direct connections to itself lately.
</I>&gt;<i> It turned out that &#160;one of the upstreams it was connecting to didn't
</I>&gt;<i> have the exchange that is meant to be federated defined. It seems that
</I>&gt;<i> when the exchange doesn't exist on the upstream it just periodically
</I>&gt;<i> keeps retrying but does't close the previous connection.
</I>&gt;<i>
</I>&gt;<i> I can send more log details if needed. I am currently running 2.8.0
</I>&gt;<i> but will upgrade to 2.8.1 and see if the problem persists.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> James
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: many-connections.png
Type: image/png
Size: 121113 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120327/1068e681/attachment.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120327/1068e681/attachment.png</A>&gt;
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019184.html">[rabbitmq-discuss] Federation Many Connections?
</A></li>
	<LI>Next message: <A HREF="019186.html">[rabbitmq-discuss] Federation Many Connections?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19185">[ date ]</a>
              <a href="thread.html#19185">[ thread ]</a>
              <a href="subject.html#19185">[ subject ]</a>
              <a href="author.html#19185">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
