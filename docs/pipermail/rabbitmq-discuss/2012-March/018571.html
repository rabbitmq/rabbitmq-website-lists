<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Does clustering increase throughput?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Does%20clustering%20increase%20throughput%3F&In-Reply-To=%3C4F54E4AB.2020306%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018570.html">
   <LINK REL="Next"  HREF="018573.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Does clustering increase throughput?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Does%20clustering%20increase%20throughput%3F&In-Reply-To=%3C4F54E4AB.2020306%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Does clustering increase throughput?">simon at rabbitmq.com
       </A><BR>
    <I>Mon Mar  5 16:07:07 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018570.html">[rabbitmq-discuss] Is there ever a need for a federation and a	cluster?
</A></li>
        <LI>Next message: <A HREF="018573.html">[rabbitmq-discuss] STOMP Plugin: Alternative exchange other	than amq.topic?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18571">[ date ]</a>
              <a href="thread.html#18571">[ thread ]</a>
              <a href="subject.html#18571">[ subject ]</a>
              <a href="author.html#18571">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm not sure I fully understand your test, however it's important to 
understand that non-HA queues only live on one node in a cluster (and HA 
queues need to do enough extra work that they're slower anyway).

Therefore connecting to one queue from multiple nodes in the cluster 
will not in general go any faster.

Clustering increases throughput in the case where you have a bunch of 
queues. They will tend to end up distributed across nodes so each 
individual node has fewer queues on it.

Cheers, Simon

On 26/02/12 17:29, matan zinger wrote:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> I've read and experienced with rabbit mq clustering feature over 2
</I>&gt;<i> machines.
</I>&gt;<i> Below are the results I found, which I found quite strange:
</I>&gt;<i>
</I>&gt;<i> 0. Direct exchange named &quot;myexchange&quot; was defined.
</I>&gt;<i> 1. rabbit1&amp;  rabbit2 were configured to work in a cluster. both are
</I>&gt;<i> using disc.
</I>&gt;<i> 2. queue named &quot;in.queue&quot; was configured, and binded to routing key
</I>&gt;<i> &quot;in&quot;
</I>&gt;<i> 3. 100k messages were enqueued with routing key &quot;in&quot;. connection was
</I>&gt;<i> to rabbit1.
</I>&gt;<i> 4. Running a single message handler on rabbit1 machine, connected to
</I>&gt;<i> rabbit1 mq.
</I>&gt;<i> Handling throuput: 2k messages / second
</I>&gt;<i> 5. Running handlers on both rabbit1&amp;  rabbit2 - each reached the
</I>&gt;<i> throuput of ~400 messages / second.
</I>&gt;<i> After stopping the message handler on rabbit2, handler on rabbit1
</I>&gt;<i> returned to 2k messages / second.
</I>&gt;<i> 6. Running a single message handler on rabbit1 machine, connected to
</I>&gt;<i> rabbit2 mq.
</I>&gt;<i> Handling throuput: 400 messages / second
</I>&gt;<i>
</I>&gt;<i> I still can't figure out this behavior:
</I>&gt;<i> I understood form the documentation that adding nodes to a cluster is
</I>&gt;<i> done in order to INCREASE throughput.
</I>&gt;<i> However, adding an additional handler leads to a degredation in
</I>&gt;<i> performance!
</I>&gt;<i>
</I>&gt;<i> The second thing I can't figure out is the difference is throughput
</I>&gt;<i> between the cases of a single handler on rabbit1, and a single handler
</I>&gt;<i> on rabbit2.
</I>&gt;<i> If both nodes are active, and are using discs, than they should be
</I>&gt;<i> exactly the same.
</I>&gt;<i> There is no notion of master/slave.
</I>&gt;<i> If so - how come a different throughput received when running a single
</I>&gt;<i> handler on each of them?
</I>&gt;<i>
</I>&gt;<i> Please help me understand these conflicts.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Matan
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018570.html">[rabbitmq-discuss] Is there ever a need for a federation and a	cluster?
</A></li>
	<LI>Next message: <A HREF="018573.html">[rabbitmq-discuss] STOMP Plugin: Alternative exchange other	than amq.topic?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18571">[ date ]</a>
              <a href="thread.html#18571">[ thread ]</a>
              <a href="subject.html#18571">[ subject ]</a>
              <a href="author.html#18571">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
