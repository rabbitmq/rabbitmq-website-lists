<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Lost message in 50k size range
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Lost%20message%20in%2050k%20size%20range&In-Reply-To=%3CCACDr4ic9P2Up-Jw3Wrm6Yyynj0hxoRg%3D_LFPQhVkELn%3DdX6z_Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018621.html">
   <LINK REL="Next"  HREF="018659.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Lost message in 50k size range</H1>
    <B>John Reuning</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Lost%20message%20in%2050k%20size%20range&In-Reply-To=%3CCACDr4ic9P2Up-Jw3Wrm6Yyynj0hxoRg%3D_LFPQhVkELn%3DdX6z_Q%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Lost message in 50k size range">john at ibiblio.org
       </A><BR>
    <I>Tue Mar  6 18:13:42 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018621.html">[rabbitmq-discuss] Lost message in 50k size range
</A></li>
        <LI>Next message: <A HREF="018659.html">[rabbitmq-discuss] Lost message in 50k size range
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18622">[ date ]</a>
              <a href="thread.html#18622">[ thread ]</a>
              <a href="subject.html#18622">[ subject ]</a>
              <a href="author.html#18622">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In this case, lost means the consumer never gets it.  I have a test
setup for debugging.  Both publisher and consumer are python/pika.
The publisher sends 2 messages -- one is a bson encoded python string
of length 49144, the other is 49145.  The consumer gets the first
message but not the second.  It's the same behavior for messages down
to 1 byte and up to a few 100 KB.  The failure point seems to be at
this 49145 length.

Other useful information may be that queue durability and message
delivery mode settings don't affect the behavior.  Also, your
suggestion of publishing to a consumerless queue didn't result in a
queued message, as far as I can tell.

I'm using the management and tracing plugins, turned on tracing, and
turned on pika debug logging.  I can't find any errors or indication
of why the message disappears or where it's going.  I'm not sure I
know the right places to look, though.

Thanks,

-John

On Tue, Mar 6, 2012 at 12:24 PM, Gavin M. Roy &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">gmr at myyearbook.com</A>&gt; wrote:
&gt;<i> I regularly send much larger messages. &#160;How are you determining the message
</I>&gt;<i> is lost?
</I>&gt;<i>
</I>&gt;<i> Have you tried setting up a stand-alone queue with no consumers and
</I>&gt;<i> publishing the messages to it? &#160;And are you using the management plugin? The
</I>&gt;<i> UI is a good way to inspect that kind of stuff.
</I>&gt;<i>
</I>&gt;<i> On Tuesday, March 6, 2012 at 11:48 AM, John Reuning wrote:
</I>&gt;<i>
</I>&gt;<i> I'm using pika to send and receive bson-encoded binary data through
</I>&gt;<i> rabbitmq. Pika 0.9.5, rabbitmq 2.7.1. Everything works until the
</I>&gt;<i> message body goes over 49144 characters. The message disappears into
</I>&gt;<i> the void at 49145 characters. The content of the message doesn't seem
</I>&gt;<i> to matter, but I've not tested that extensively. The encoding is set
</I>&gt;<i> to application/octet-stream.
</I>&gt;<i>
</I>&gt;<i> Pika debug logging shows the message split into multiple frames and
</I>&gt;<i> sent to rabbitmq. Trace logs don't show any activity. Increasing
</I>&gt;<i> frame_max didn't help. Does anyone have suggestions on how to debug
</I>&gt;<i> this or what might be going wrong? I'd rather not resort to tcpdump.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> -John
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018621.html">[rabbitmq-discuss] Lost message in 50k size range
</A></li>
	<LI>Next message: <A HREF="018659.html">[rabbitmq-discuss] Lost message in 50k size range
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18622">[ date ]</a>
              <a href="thread.html#18622">[ thread ]</a>
              <a href="subject.html#18622">[ subject ]</a>
              <a href="author.html#18622">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
