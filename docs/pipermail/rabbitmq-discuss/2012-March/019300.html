<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] |Spam| Re:Re: Re: Re: Re: |Spam| question	about	rabbitmq TPS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%7CSpam%7C%20Re%3ARe%3A%20Re%3A%20Re%3A%20Re%3A%20%7CSpam%7C%20question%0A%09about%09rabbitmq%20TPS&In-Reply-To=%3C4d3eb23c.27a.13664b6ae4a.Coremail.chen-hongqin%40163.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019295.html">
   <LINK REL="Next"  HREF="019266.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] |Spam| Re:Re: Re: Re: Re: |Spam| question	about	rabbitmq TPS</H1>
    <B>&#38472;&#40511;&#38054;</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%7CSpam%7C%20Re%3ARe%3A%20Re%3A%20Re%3A%20Re%3A%20%7CSpam%7C%20question%0A%09about%09rabbitmq%20TPS&In-Reply-To=%3C4d3eb23c.27a.13664b6ae4a.Coremail.chen-hongqin%40163.com%3E"
       TITLE="[rabbitmq-discuss] |Spam| Re:Re: Re: Re: Re: |Spam| question	about	rabbitmq TPS">chen-hongqin at 163.com
       </A><BR>
    <I>Fri Mar 30 18:45:55 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019295.html">[rabbitmq-discuss] |Spam| question about rabbitmq TPS
</A></li>
        <LI>Next message: <A HREF="019266.html">[rabbitmq-discuss] Dead Letter Exchanges
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19300">[ date ]</a>
              <a href="thread.html#19300">[ thread ]</a>
              <a href="subject.html#19300">[ subject ]</a>
              <a href="author.html#19300">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I have no ideas, but it happens when the number of queues is large(for example, 300 queues)


&#22312; 2012-03-30 21:27:15&#65292;&quot;Alexis Richardson&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt; &#20889;&#36947;&#65306;
So, what do you think is happening, given that spikes also occur when persistence is off?



2012/3/29 &#38472;&#40511;&#38054; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">chen-hongqin at 163.com</A>&gt;

figure 1
figure 2


figure 3
 
Hi, I create 15 queues in the first case, and create 300 queues in the second case. Each message is acknowledged before sending the next one. Figure 3 illustrates the detail of figure2 when i remove the several top points.
 

 
&#22312; 2012-03-29 22:53:39&#65292;&quot;Alexis Richardson&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt; &#20889;&#36947;&#65306;

try it without persistence and see what graphs you get..?




2012/3/29 &#38472;&#40511;&#38054; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">chen-hongqin at 163.com</A>&gt;

yes, all the messages are persistent



&#22312; 2012-03-29 21:17:04&#65292;&quot;Alexis Richardson&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt; &#20889;&#36947;&#65306;

are you using persistent messages?



2012/3/29 &#38472;&#40511;&#38054; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">chen-hongqin at 163.com</A>&gt;

This is about my master paper which is related with availability, and I use rabbitmq as the middle-ware component. So I am trying to find how can cause this problem. And my current answer I guess is that it is caused by the OS cache. Cache hit ratio is high at the very start and becomes lower because of the page replacement after more and more requests come. And the other reason maybe is messages are orderly sufficiently for the disk to write at start. But i am not sure if the rabbitmq has do some optimals for that?

At 2012-03-29 18:23:33,&quot;Alexis Richardson&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt; wrote:
Hi,


There are lots of possible reasons for this, including that &quot;measuring anything accurately is hard&quot;.  


What problem are you trying to solve?


alexis



2012/3/26 &#38472;&#40511;&#38054; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">chen-hongqin at 163.com</A>&gt;

hi, 
can you tell me why TPS is too high at first and sometimes maybe even more higher(maybe over 30000/s) when I send messages to rabbitmq cluster concurrently? thanks!
 
 
 
Some infos about this test:
1. all the messages are same and each message size is 1kb.
2. 300 queues created by multiple Producers at start and messages sent to the queues are random 
3. All messages are persistent and queues are all durable
4. 3 nodes consists of a rabbitmq cluster and all the nodes are in the same host but different ports
the host info:
|<i>
</I>
JAVA version

|<i>
</I>
Java version &quot;1.6.0_12&quot; Java(TM) SE Runtime Environment (build 1.6.0_12-b04)

|<i>
</I>|<i>
</I>
JAVA VM

|<i>
</I>
Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)

|<i>
</I>|<i>
</I>
CPU

|<i>
</I>
Intel(R) Xeon(R) CPU E5504 @2.00GHz

|<i>
</I>|<i>
</I>
number of cores

|<i>
</I>
8

|<i>
</I>|<i>
</I>
memory

|<i>
</I>
33011192kb

|<i>
</I>|<i>
</I>
Erlang VM

|<i>
</I>
Erlang R15B (erts-5.9) [source] [64-bit] [smp:8:8] [async-threads:0] [hipe] [kernel-poll:false]

|<i>
</I>|<i>
</I>
RabbitMQ version

|<i>
</I>
Release 2.7.1

|<i>
</I>

 





_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>

















-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 15.jpg
Type: image/jpeg
Size: 34912 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment.jpg">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment.jpg</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 300.jpg
Type: image/jpeg
Size: 32359 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment-0001.jpg">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment-0001.jpg</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: detail300.jpg
Type: image/jpeg
Size: 37945 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment-0002.jpg">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment-0002.jpg</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 2012-03-26_00-02-28.png
Type: image/png
Size: 24610 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120331/973b7a24/attachment.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019295.html">[rabbitmq-discuss] |Spam| question about rabbitmq TPS
</A></li>
	<LI>Next message: <A HREF="019266.html">[rabbitmq-discuss] Dead Letter Exchanges
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19300">[ date ]</a>
              <a href="thread.html#19300">[ thread ]</a>
              <a href="subject.html#19300">[ subject ]</a>
              <a href="author.html#19300">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
