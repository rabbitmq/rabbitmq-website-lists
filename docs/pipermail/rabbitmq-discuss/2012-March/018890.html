<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cluster fails when current primary node shuts	down.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20fails%20when%20current%20primary%20node%20shuts%0A%09down.&In-Reply-To=%3CCAChq9g33wZVMFUvba04S%2BZbPKNDharX%2B4LAgc_wt3t%2BaQFUO3Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018885.html">
   <LINK REL="Next"  HREF="018928.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cluster fails when current primary node shuts	down.</H1>
    <B>Travis</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20fails%20when%20current%20primary%20node%20shuts%0A%09down.&In-Reply-To=%3CCAChq9g33wZVMFUvba04S%2BZbPKNDharX%2B4LAgc_wt3t%2BaQFUO3Q%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Cluster fails when current primary node shuts	down.">hcoyote at ghostar.org
       </A><BR>
    <I>Thu Mar 15 19:57:28 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018885.html">[rabbitmq-discuss] Up To Date Federation Details?
</A></li>
        <LI>Next message: <A HREF="018928.html">[rabbitmq-discuss] Cluster fails when current primary node shuts down.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18890">[ date ]</a>
              <a href="thread.html#18890">[ thread ]</a>
              <a href="subject.html#18890">[ subject ]</a>
              <a href="author.html#18890">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We're running RabbitMQ 2.7.1 on CentoOS 5.6 with erlang R14B in a
clustered configuration with mirrored queues.

Both nodes in the cluster are configured as disc nodes.

Yesterday, we attempted to force a failover of the cluster from
machineA to machineB, by doing a

  service rabbitmq-server stop

on machineA.

When this completed on machineA, instead of the cluster failing over,
the rabbitmq on machineB died.  What we then noticed was that when we
tried to start up machineB's rabbitmq-server, it would fail the
startup process.  machineB would only ever start up if machineA's
rabbitmq-server was started first.

note:  this is ONLY happening on our production cluster; I can't seem
to reproduce it in our QA environment.  I suspect something is whacked
in cluster config in production.

Anyone else seen this?  Is service rabbitmq-server stop sufficient to
cause a safe failover?  Or is there a more preferred way?

Unfortunately, I don't have the log messages from machineB's
rabbitmq-server because it appears that they get overwritten upon
subsequent restarts of rabbitmq. :-(

Travis
-- 
Travis Campbell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">travis at ghostar.org</A>
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018885.html">[rabbitmq-discuss] Up To Date Federation Details?
</A></li>
	<LI>Next message: <A HREF="018928.html">[rabbitmq-discuss] Cluster fails when current primary node shuts down.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18890">[ date ]</a>
              <a href="thread.html#18890">[ thread ]</a>
              <a href="subject.html#18890">[ subject ]</a>
              <a href="author.html#18890">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
