<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%20with%20running%20two%20RabbitMQ%20servers%20on%0A%09one%20machine&In-Reply-To=%3CCALD4NQZop5YENw8p_hnvXZTpHAu68Gb6V3RR%3D%3D2VGcGfM8DFBg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018805.html">
   <LINK REL="Next"  HREF="018857.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine</H1>
    <B>Brian Jing</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Issue%20with%20running%20two%20RabbitMQ%20servers%20on%0A%09one%20machine&In-Reply-To=%3CCALD4NQZop5YENw8p_hnvXZTpHAu68Gb6V3RR%3D%3D2VGcGfM8DFBg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine">brian.newsgroup at gmail.com
       </A><BR>
    <I>Thu Mar 15 00:08:09 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018805.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on one machine
</A></li>
        <LI>Next message: <A HREF="018857.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18856">[ date ]</a>
              <a href="thread.html#18856">[ thread ]</a>
              <a href="subject.html#18856">[ subject ]</a>
              <a href="author.html#18856">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Emile,

On Wed, Mar 14, 2012 at 9:57 PM, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i> Hi Brian,
</I>&gt;<i>
</I>&gt;<i> On 14/03/12 00:26, Brian Jing wrote:
</I>&gt;<i> &gt; =INFO REPORT==== 14-Mar-2012::11:05:07 ===
</I>&gt;<i> &gt; started TCP Listener on [::]:4446
</I>&gt;<i>
</I>&gt;<i> Where does the config for this port number (4446) come from?
</I>

This comes from the NODE_PORT variable defined in the environment config
file. since the existing 1.8.0 already uses 5672 as the default port,  I
need a different port to be able to run this second instance of rabbitmq on
the same machine. Does this make sense?


&gt;<i> Are you
</I>&gt;<i> sure the correct config file is being read during broker startup?  What
</I>&gt;<i> does the broker startup banner say?
</I>&gt;<i>
</I>&gt;<i> I'm pretty sure that the correct config files are being used. I changed
</I>the default env config file from /etc/rabbitmq/rabbitmq-env.conf to
/etc/rabbitmq/rabbitmq_env.conf before I rebuilt the source (only thing I
changed in the source). I know this env config file is being used because
rabbitmq 2.7.1 generates separate log files for the SERVICENAME I specified
and rabbitmq 2.7.1 listens to the port I specified in the env file as well.

The content of my rabbitmq_env.conf is as follows:

# cat /etc/rabbitmq/rabbitmq_env.conf
SERVICENAME=RabbitMQ-new
NODENAME=rabbit-new@$HOSTNAME
NODE_PORT=4446
CONFIG_FILE=/etc/rabbitmq/rabbitmq-2.7.1.config

Content of my new rabbitmq.conf:

# cat /etc/rabbitmq/rabbitmq-2.7.1.config
[
    {rabbit, [
        {ssl_listeners, [{&quot;0.0.0.0&quot;,4445}]},
        {ssl_options, [
            {cacertfile,&quot;/etc/rabbitmq/certs/testca/cacert.pem&quot;},
            {certfile,&quot;/etc/rabbitmq/certs/server/cert.pem&quot;},
            {keyfile,&quot;/etc/rabbitmq/certs/server/key.pem&quot;},
            {verify, verify_peer},
            {fail_if_no_peer_cert, false}
        ]}

    ]}
].

Here is the rabbitmq startup information:

# /opt/rabbitmq-server-2.7.1/sbin/rabbitmq-server
Activating RabbitMQ plugins ...
0 plugins activated:


+---+   +---+
|<i>   |   |   |
</I>|<i>   |   |   |
</I>|<i>   |   |   |
</I>|<i>   +---+   +-------+
</I>|<i>                   |
</I>|<i> RabbitMQ  +---+   |
</I>|<i>           |   |   |
</I>|<i>   v2.7.1  +---+   |
</I>|<i>                   |
</I>+-------------------+
AMQP 0-9-1 / 0-9 / 0-8
Copyright (C) 2007-2011 VMware, Inc.
Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/">http://www.rabbitmq.com/</A>

node           : <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit-new at ServerA</A>
app descriptor : /opt/rabbitmq-server-2.7.1/sbin/../ebin/rabbit.app
home dir       : /root
config file(s) : (none)
cookie hash    :
log            : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit-new at ServerA.log</A>
sasl log       : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit-new at ServerA-sasl.log</A>
database dir   : /var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit-new at ServerA</A>
erlang version : 5.7.4

-- rabbit boot start
starting file handle cache server
...done
starting worker pool
...done
starting database
...done
starting codec correctness check
...done
-- external infrastructure ready
starting plugin registry
...done
starting auth mechanism cr-demo
...done
starting auth mechanism amqplain
...done
starting auth mechanism plain
...done
starting statistics event manager
...done
starting logging server
...done
starting exchange type direct
...done
starting exchange type fanout
...done
starting exchange type headers
...done
starting exchange type topic
...done
-- kernel ready
starting alarm handler
...done
starting node monitor
...done
starting cluster delegate
...done
starting guid generator
...done
starting memory monitor
...done
-- core initialized
starting empty DB check
...done
starting exchange, queue and binding recovery
...done
starting mirror queue slave sup
...done
starting adding mirrors to queues
...done
-- message delivery logic ready
starting error log relay
...done
starting networking
...done
starting direct_client
...done
starting notify cluster nodes
...done

broker running

Cheers,

Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120315/3e4d7b74/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120315/3e4d7b74/attachment.htm</A>&gt;
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018805.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on one machine
</A></li>
	<LI>Next message: <A HREF="018857.html">[rabbitmq-discuss] Issue with running two RabbitMQ servers on	one machine
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18856">[ date ]</a>
              <a href="thread.html#18856">[ thread ]</a>
              <a href="subject.html#18856">[ subject ]</a>
              <a href="author.html#18856">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
