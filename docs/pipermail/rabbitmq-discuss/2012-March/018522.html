<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] building SimpleAmqpClient
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20building%20SimpleAmqpClient&In-Reply-To=%3CCAAt2poJFQ_Ww5212uJPWkyb%3DOutxy8jxD_acCpo2tTE2Zy46mA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018513.html">
   <LINK REL="Next"  HREF="018523.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] building SimpleAmqpClient</H1>
    <B>Alan Antonuk</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20building%20SimpleAmqpClient&In-Reply-To=%3CCAAt2poJFQ_Ww5212uJPWkyb%3DOutxy8jxD_acCpo2tTE2Zy46mA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] building SimpleAmqpClient">alan.antonuk at gmail.com
       </A><BR>
    <I>Sat Mar  3 05:49:18 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018513.html">[rabbitmq-discuss] building SimpleAmqpClient
</A></li>
        <LI>Next message: <A HREF="018523.html">[rabbitmq-discuss] building SimpleAmqpClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18522">[ date ]</a>
              <a href="thread.html#18522">[ thread ]</a>
              <a href="subject.html#18522">[ subject ]</a>
              <a href="author.html#18522">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think you're misunderstanding how to use cmake: when I said set a
variable I meant a cmake variable and not a shell variable.

You set a cmake variable by adding a -DVARIABLE_NAME=VALUE to the command
line.

To be more concrete, lets say you have your rabbitmq-c source tree in:
c:\dev\rabbitmq-c
And have built the project in-source using MSVC

You have boost v1.47.0 in, and its built with shared libraries
c:\dev\boost-1.47.0

The appropriate cmake command might look something like:
$ cmake -DBOOST_ROOT=c:\dev\boost-1.47.0
-DBoost_ADDITIONAL_VERSIONS=&quot;1.47.0&quot;
-DRabbitmqc_INCLUDE_DIR=c:\dev\rabbitmq-c\librabbitmq
-DRabbitmqc_LIBRARY=c:\dev\rabbitmq-c\librabbitmq\Debug\rabbitmq.lib

You can also use the cmake-gui program to set these variables.

That said: the FindRabbitmq.cmake module does not expect to find the
headers and the libraries in a source, or build tree.  It expects to find
these in an 'install tree', which basically copies the correct files to a
known location and structure: headers in ${PREFIX}/include libraries in
${PREFIX}/lib and executables in ${PREFIX}/bin. On linux/unix ${PREFIX} is
usually /usr/local, on windows its in C:\Program Files\${ProjectName} -
which I personally don't like.

My recommendation would be to run cmake-gui in your rabbitmq-c build and
set the CMAKE_INSTALL_PREFIX to something like c:\dev\install, then build
the 'INSTALL' project which will copy the appropriate files to an install
tree in c:\dev\install

You can then either add c:\dev\install\include and c:\dev\install\lib paths
to the INCLUDE and LIB environment variables or you can set the cmake
variable Rabbitmqc_DIR to c:\dev\install when running cmake against
SimpleAmqpClient, and save having to specify the Rabbitmqc_INCLUDE_DIR and
Rabbitmqc_LIBRARY individually.

Note that since rabbitmq is built as a shared library (DLL on windows) by
default, you'll need to have the rabbitmq.dll in a place that windows can
find it (putting these in the same directory as the executable or adding
the path containing the DLL to the PATH environment variable.

HTH
-Alan

On Fri, Mar 2, 2012 at 7:55 AM, Eric J. Holtman &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">eric at holtmans.com</A>&gt; wrote:

&gt;<i> On 3/1/2012 10:59 PM, Alan Antonuk wrote:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; *For finding Rabbitmq-c* I wrote a FindRabbitmqc.cmake (in the Modules
</I>&gt;<i> &gt; directory).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It searches for the amqp.h file in:
</I>&gt;<i> &gt; ${Rabbitmqc_DIR}/include
</I>&gt;<i> &gt; Then your system paths
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If it doesn't pick it up automatically you set Rabbitmqc_INCLUDE_DIR to
</I>&gt;<i> the
</I>&gt;<i> &gt; directory containing the amqp.h file by hand.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It searches for the rabbitmq library (librabbitmq.a/librabbitmq.so on
</I>&gt;<i> *nix
</I>&gt;<i> &gt; rabbitmq.lib/.dll on windows) in:
</I>&gt;<i> &gt; ${Rabbitmq_DIR}/lib
</I>&gt;<i> &gt; Then your system include paths
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If it doesn't pick it up automatically, you can set Rabbitmqc_LIBRARY to
</I>&gt;<i> &gt; the filename of the library by hand.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hope that helps.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I tried that:
</I>&gt;<i>
</I>&gt;<i> C:\rabbit-c\simpleamqpclient-build&gt;dir %Rabbitmqc_INCLUDE_DIR%\amqp.h
</I>&gt;<i>  Volume in drive C has no label.
</I>&gt;<i>  Volume Serial Number is 60C2-C1FC
</I>&gt;<i>
</I>&gt;<i>  Directory of c:\rabbit-c\rabbitmq-c\librabbitmq
</I>&gt;<i>
</I>&gt;<i> 02/15/2012  03:00 PM            14,097 amqp.h
</I>&gt;<i>               1 File(s)         14,097 bytes
</I>&gt;<i>               0 Dir(s)  36,886,913,024 bytes free
</I>&gt;<i>
</I>&gt;<i> so, amqp.h is in the right place.
</I>&gt;<i>
</I>&gt;<i> C:\rabbit-c\simpleamqpclient-build&gt;dir %Rabbitmqc_LIBRARY%\rabbitmq.*
</I>&gt;<i>  Volume in drive C has no label.
</I>&gt;<i>  Volume Serial Number is 60C2-C1FC
</I>&gt;<i>
</I>&gt;<i>  Directory of c:\rabbit-c\rabbitmq-c-build\librabbitmq\Debug
</I>&gt;<i>
</I>&gt;<i> 02/22/2012  01:15 PM           108,544 rabbitmq.dll
</I>&gt;<i> 02/15/2012  05:03 PM             9,383 rabbitmq.exp
</I>&gt;<i> 02/22/2012  01:15 PM           265,216 rabbitmq.idb
</I>&gt;<i> 02/22/2012  01:15 PM           386,320 rabbitmq.ilk
</I>&gt;<i> 02/15/2012  05:03 PM            16,132 rabbitmq.lib
</I>&gt;<i> 02/22/2012  01:15 PM           815,104 rabbitmq.pdb
</I>&gt;<i>               6 File(s)      1,600,699 bytes
</I>&gt;<i>               0 Dir(s)  36,886,913,024 bytes free
</I>&gt;<i>
</I>&gt;<i> .dll/.lib in the right place:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> C:\rabbit-c\simpleamqpclient-build&gt;cmake ..\SimpleAmqpClient
</I>&gt;<i> -- Building for: Visual Studio 9 2008
</I>&gt;<i> -- Check for working C compiler using: Visual Studio 9 2008
</I>&gt;<i> -- Check for working C compiler using: Visual Studio 9 2008 -- works
</I>&gt;<i> -- Detecting C compiler ABI info
</I>&gt;<i> -- Detecting C compiler ABI info - done
</I>&gt;<i> -- Check for working CXX compiler using: Visual Studio 9 2008
</I>&gt;<i> -- Check for working CXX compiler using: Visual Studio 9 2008 -- works
</I>&gt;<i> -- Detecting CXX compiler ABI info
</I>&gt;<i> -- Detecting CXX compiler ABI info - done
</I>&gt;<i> -- Boost version: 1.47.0
</I>&gt;<i> -- Found the following Boost libraries:
</I>&gt;<i> --   chrono
</I>&gt;<i> --   system
</I>&gt;<i> Rabbitmqc_INCLUDE_DIR=Rabbitmqc_INCLUDE_DIR-NOTFOUND
</I>&gt;<i> Rabbitmqc_LIBRARY=Rabbitmqc_LIBRARY-NOTFOUND
</I>&gt;<i> CMake Error at Modules/LibFindMacros.cmake:74 (message):
</I>&gt;<i>  Required library Rabbitmqc NOT FOUND.
</I>&gt;<i>
</I>&gt;<i>  Install the library (dev version) and try again.  If the library is
</I>&gt;<i> already
</I>&gt;<i>  installed, use ccmake to set the missing variables manually.
</I>&gt;<i> Call Stack (most recent call first):
</I>&gt;<i>  Modules/FindRabbitmqc.cmake:19 (LIBFIND_PROCESS)
</I>&gt;<i>  CMakeLists.txt:12 (FIND_PACKAGE)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- Configuring incomplete, errors occurred!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Still fails.
</I>&gt;<i>
</I>&gt;<i> I'm wondering if this is even worth the effort.  (Not your wrapper,
</I>&gt;<i> just the cmake process).
</I>&gt;<i>
</I>&gt;<i> Once I've gotten the C library itself to build (using python et al
</I>&gt;<i> to build the framing files), I'm tempted to just extract the .c and
</I>&gt;<i> .h files I need into a new Visual Studio project, and go from there.
</I>&gt;<i>
</I>&gt;<i> I understand the concept of cmake (trying to get a platform independent
</I>&gt;<i> delivery base), but at this point, for a library with only really
</I>&gt;<i> 10 .c and .h files, I've got at least 4 directories, the .vcproj files
</I>&gt;<i> have tons of -I directives, and......
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Anyway, after seeing the trace above, if you have any clues, I'd
</I>&gt;<i> appreciate it.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120303/92384dfc/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120303/92384dfc/attachment.htm</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018513.html">[rabbitmq-discuss] building SimpleAmqpClient
</A></li>
	<LI>Next message: <A HREF="018523.html">[rabbitmq-discuss] building SimpleAmqpClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18522">[ date ]</a>
              <a href="thread.html#18522">[ thread ]</a>
              <a href="subject.html#18522">[ subject ]</a>
              <a href="author.html#18522">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
