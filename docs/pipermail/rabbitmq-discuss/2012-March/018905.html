<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Run RabbitMQ server with N scheduler threads
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Run%20RabbitMQ%20server%20with%20N%20scheduler%20threads&In-Reply-To=%3CCAEqHY8t6JO0OjHH-OFKoyKsVUde_pBCc2sSTLe8EVcO1JpHvBg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019048.html">
   <LINK REL="Next"  HREF="018940.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Run RabbitMQ server with N scheduler threads</H1>
    <B>Katerina Roukounaki</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Run%20RabbitMQ%20server%20with%20N%20scheduler%20threads&In-Reply-To=%3CCAEqHY8t6JO0OjHH-OFKoyKsVUde_pBCc2sSTLe8EVcO1JpHvBg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Run RabbitMQ server with N scheduler threads">k4t3r1n4 at gmail.com
       </A><BR>
    <I>Fri Mar 16 17:28:27 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019048.html">[rabbitmq-discuss] newbie problem--'Error: unable to connect to node 'rabbit at rabbitmq-small02-dev': nodedown'
</A></li>
        <LI>Next message: <A HREF="018940.html">[rabbitmq-discuss] Run RabbitMQ server with N scheduler threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18905">[ date ]</a>
              <a href="thread.html#18905">[ thread ]</a>
              <a href="subject.html#18905">[ subject ]</a>
              <a href="author.html#18905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!

Since the RabbitMQ server is an Erlang application, I wanted to see whether
it runs faster as I increase the number of scheduler threads in the Erlang
VM that runs it (+S option of the erl program).

For this purpose, I wrote a simple benchmark (in Erlang) that spawns P
producer and P consumer processes and creates P queues. The i-th producer
sends M messages to the i-th queue and the i-th consumer waits to receive
them. My benchmark uses native Erlang messaging for sending and receiving
messages.

I attach the results I get when I run the benchmark with P=M=1000 on a
machine with 16 cores and assign 1, 2, &#8230;, 16 scheduler threads to the VM
that runs the RabbitMQ server.

As you can see, things get better up to 6 schedulers, but with 7 or more
schedulers it seems that there is no further speedup.
Do you have any idea why this is happening?
Is there some kind of synchronization among the processes that the RabbitMQ
server spawns that explains it or should I look for bugs in my benchmark?


Thanks!
Katerina
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120316/44a0e6e1/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120316/44a0e6e1/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rabbitmq_onetoone_direct-time.ps
Type: application/postscript
Size: 17853 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120316/44a0e6e1/attachment.ps">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120316/44a0e6e1/attachment.ps</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019048.html">[rabbitmq-discuss] newbie problem--'Error: unable to connect to node 'rabbit at rabbitmq-small02-dev': nodedown'
</A></li>
	<LI>Next message: <A HREF="018940.html">[rabbitmq-discuss] Run RabbitMQ server with N scheduler threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18905">[ date ]</a>
              <a href="thread.html#18905">[ thread ]</a>
              <a href="subject.html#18905">[ subject ]</a>
              <a href="author.html#18905">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
