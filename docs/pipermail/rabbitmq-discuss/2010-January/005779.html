<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Erlang R12B and new persister
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Erlang%20R12B%20and%20new%20persister&In-Reply-To=84fb38e31001051420p21546125ibe70e7b223251339%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005766.html">
   <LINK REL="Next"  HREF="005789.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Erlang R12B and new persister</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Erlang%20R12B%20and%20new%20persister&In-Reply-To=84fb38e31001051420p21546125ibe70e7b223251339%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Erlang R12B and new persister">matthew at lshift.net
       </A><BR>
    <I>Wed Jan  6 12:02:30 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005766.html">[rabbitmq-discuss] Erlang R12B and new persister
</A></li>
        <LI>Next message: <A HREF="005789.html">[rabbitmq-discuss] Erlang R12B and new persister
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5779">[ date ]</a>
              <a href="thread.html#5779">[ thread ]</a>
              <a href="subject.html#5779">[ subject ]</a>
              <a href="author.html#5779">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Jan 05, 2010 at 04:20:02PM -0600, tsuraan wrote:
&gt;<i> &gt; There was a post to the list about 6 weeks ago talking about how much
</I>&gt;<i> &gt; better the R13 garbage collector works with the new persister. I am
</I>&gt;<i> &gt; pretty sure the devs are going to make R13 a requirement for that code
</I>&gt;<i> &gt; so that it runs and behaves well.
</I>&gt;<i> 
</I>&gt;<i> Yeah, I read the discussion (and the commits where a ton of explicit
</I>&gt;<i> gc:collect calls were removed).  I was hoping R12 would still work,
</I>&gt;<i> since I have it on about 1200 machines that I'll otherwise have to
</I>&gt;<i> upgrade :)
</I>
Thanks for that report. I need to check with Matthias on this one.
Personally, ets:update_element is so useful (mainly because it's atomic
which helps massively with concurrent access to ets tables) that I would
argue in favour of requiring R13, and indeed I'm planning on adding more
ets:update_element calls this afternoon!

Having checked the code, the update_element calls in msg_store and
msg_store_gc could be worked around. The update_element in
msg_store_ets_index can't be, but if you use the rabbitmq-toke plugin
then that avoids that.

ets:update_element appeared in R12B2, according to
<A HREF="http://www.erlang.org/download/otp_src_R12B-2.readme">http://www.erlang.org/download/otp_src_R12B-2.readme</A> . The last time we
had this discussion in the office, I _think_ we maybe settled on saying
that we would support back to Debian stable (currently lenny), which is
R12B3. Given that Debian testing (squeeze) is already on R13B2, and our
release cycle is probably slower than Debian's, I would be surprised if
the new persister is released before the squeeze goes stable! Thus you
may well find that by the time it's released, we require R13.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005766.html">[rabbitmq-discuss] Erlang R12B and new persister
</A></li>
	<LI>Next message: <A HREF="005789.html">[rabbitmq-discuss] Erlang R12B and new persister
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5779">[ date ]</a>
              <a href="thread.html#5779">[ thread ]</a>
              <a href="subject.html#5779">[ subject ]</a>
              <a href="author.html#5779">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
