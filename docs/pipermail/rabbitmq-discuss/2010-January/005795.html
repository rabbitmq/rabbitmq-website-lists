<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem with Clustering
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Problem%20with%20Clustering&In-Reply-To=757cc9481001061253x6efb17a1g68639579022c8b5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005792.html">
   <LINK REL="Next"  HREF="005809.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem with Clustering</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Problem%20with%20Clustering&In-Reply-To=757cc9481001061253x6efb17a1g68639579022c8b5%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Problem with Clustering">matthew at lshift.net
       </A><BR>
    <I>Thu Jan  7 10:38:30 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005792.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
        <LI>Next message: <A HREF="005809.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5795">[ date ]</a>
              <a href="thread.html#5795">[ thread ]</a>
              <a href="subject.html#5795">[ subject ]</a>
              <a href="author.html#5795">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi David,

You're using the latest default code, yes?

We've just changed the behaviour in this case - previously, yes, the
queue would be recreated. This is incorrect because it then causes many
problems when the failed node comes back up - you end up with the same
queue on both nodes with different concepts of what should be in the
queue. Exciting if undesireable things happen in this case.

Thus if a queue is declared but it's found that the queue does already
exist but is on a downed node, we return a 404, because it's really
saying &quot;the node on which this queue exists can't be found&quot;.

&gt;<i>From your code, I see you're declaring the queue durable. This really
</I>reenforces the issue because if its durable, then persistent messages
shouldn't be lost, and yet if you want to be able to recreate the queue
on the other node, then it'll start empty, at which point, logically,
the contents of the queue have been lost.

In general, clustering should not be used for HA purposes. If you wish
to achive HA, then active/passive HA can be achieved by using shared
disk storage, heartbeat/pacemaker, maybe a tcp load balancer on the
front, and make sure you set the node names to localhost, and point both
rabbit instances at the same mnesia dir on the shared storage. When the
passive node comes up, it will recover everything from the storage.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005792.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
	<LI>Next message: <A HREF="005809.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5795">[ date ]</a>
              <a href="thread.html#5795">[ thread ]</a>
              <a href="subject.html#5795">[ subject ]</a>
              <a href="author.html#5795">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
