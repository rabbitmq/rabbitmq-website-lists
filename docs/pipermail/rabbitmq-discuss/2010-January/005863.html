<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] .NET client hangs on BasicGet
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20.NET%20client%20hangs%20on%20BasicGet&In-Reply-To=4B4E0AAB.7060805%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005860.html">
   <LINK REL="Next"  HREF="005864.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] .NET client hangs on BasicGet</H1>
    <B>Peter Townsend</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20.NET%20client%20hangs%20on%20BasicGet&In-Reply-To=4B4E0AAB.7060805%40lshift.net"
       TITLE="[rabbitmq-discuss] .NET client hangs on BasicGet">Peter.Townsend at mflow.com
       </A><BR>
    <I>Wed Jan 13 19:07:52 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005860.html">[rabbitmq-discuss] .NET client hangs on BasicGet
</A></li>
        <LI>Next message: <A HREF="005864.html">[rabbitmq-discuss] .NET client hangs on BasicGet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5863">[ date ]</a>
              <a href="thread.html#5863">[ thread ]</a>
              <a href="subject.html#5863">[ subject ]</a>
              <a href="author.html#5863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matthias,

I have the stack trace of the hanging Model.BasicGet call

14	Worker Thread	&lt;No Name DigitalDistribution.RabbitMQ.RabbitMessageQueue&lt;DigitalDistribution.ContentIngest.ServiceModel.V100.Messages.SupplierReleaseUpdate&gt;.GetNormal
[In a sleep, wait, or join]	 
mscorlib.dll!System.Threading.Monitor.Wait(object obj, int millisecondsTimeout, bool exitContext) + 0x18 bytes	 
mscorlib.dll!System.Threading.Monitor.Wait(object obj) + 0xa bytes	 
RabbitMQ.Client.dll!RabbitMQ.Util.BlockingCell.Value.get() + 0x52 bytes	 
RabbitMQ.Client.dll!RabbitMQ.Client.Impl.SimpleBlockingRpcContinuation.GetReply() + 0x2e bytes	 
RabbitMQ.Client.dll!RabbitMQ.Client.Impl.ModelBase.BasicGet(string queue = &quot;001.load.release.update&quot;, bool noAck = false) + 0x82 bytes	 
DigitalDistribution.RabbitMQ.dll!DigitalDistribution.RabbitMQ.RabbitMessageQueue&lt;DigitalDistribution.ContentIngest.ServiceModel.V100.Messages.SupplierReleaseUpdate&gt;.Get() Line 121 + 0x24 bytes	 
DigitalDistribution.ContentIngest.dll!DigitalDistribution.ContentIngest.Messaging.AbstractMessageConsumer&lt;DigitalDistribution.ContentIngest.ServiceModel.V100.Messages.SupplierReleaseUpdate&gt;.ReadNextMessage() Line 155 + 0x53 bytes	 
DigitalDistribution.ContentIngest.dll!DigitalDistribution.ContentIngest.Messaging.AbstractMessageConsumer&lt;DigitalDistribution.ContentIngest.ServiceModel.V100.Messages.SupplierReleaseUpdate&gt;.ProcessMessageLoop() Line 107 + 0x8 bytes	 
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart_Context(object state) + 0x66 bytes	 
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state) + 0x6f bytes	 
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart() + 0x44 bytes	

@Jeremy

The number is inconsistent when continuing the process but I have just seen it I load an empty queue with the same messages that it is hanging after the same set of messages every time. The message data I'm using is binary serialized XML, could this be perhaps a message content/size restriction? I'll look into getting the message content and size for the message prior to hanging and the one expected next.

Note when I restart the consumer it will happily process the next message. Would it be possible that a corrupt message is blocking and the server re-queues it (I assume its appends it to the end of the queue) thus the restarted consumer skips it?

Thanks for the prompt reply guys
Pete

-----Original Message-----
From: Matthias Radestock [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>] 
Sent: 13 January 2010 18:02
To: Peter Townsend
Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] .NET client hangs on BasicGet

Peter,

Peter Townsend wrote:
&gt;<i> I'm using the .NET client running against a windows installation of the 
</I>&gt;<i> RabbitMQ broker. I have found that calls to IModel.BasicGet(...) will 
</I>&gt;<i> hang after process a number of message. The number of messages processed 
</I>&gt;<i> before it hangs changes with each run.
</I>
When it hangs, please take a thread dump and post it here.

&gt;<i> I refactored to use a BasicConsume approach
</I>
It will probably be easier to debug this by sticking to BasicGet.


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005860.html">[rabbitmq-discuss] .NET client hangs on BasicGet
</A></li>
	<LI>Next message: <A HREF="005864.html">[rabbitmq-discuss] .NET client hangs on BasicGet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5863">[ date ]</a>
              <a href="thread.html#5863">[ thread ]</a>
              <a href="subject.html#5863">[ subject ]</a>
              <a href="author.html#5863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
