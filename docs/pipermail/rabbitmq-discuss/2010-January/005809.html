<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem with Clustering
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Problem%20with%20Clustering&In-Reply-To=20100107103829.GB15498%40wellquite.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005795.html">
   <LINK REL="Next"  HREF="005822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem with Clustering</H1>
    <B>Stephen Day</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Problem%20with%20Clustering&In-Reply-To=20100107103829.GB15498%40wellquite.org"
       TITLE="[rabbitmq-discuss] Problem with Clustering">sjaday at gmail.com
       </A><BR>
    <I>Thu Jan  7 21:17:29 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005795.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
        <LI>Next message: <A HREF="005822.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5809">[ date ]</a>
              <a href="thread.html#5809">[ thread ]</a>
              <a href="subject.html#5809">[ subject ]</a>
              <a href="author.html#5809">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthew:

This is the best description of the intent of RabbitMQ clustering I have
heard yet. Specifically, the distinction that RabbitMQ clustering is for
high volume messaging, rather than HA concerns. Do you mind adding some of
these points to the RabbitMQ clustering guide (
<A HREF="http://www.rabbitmq.com/clustering.html">http://www.rabbitmq.com/clustering.html</A>)?

Steve

On Thu, Jan 7, 2010 at 2:38 AM, Matthew Sackman &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at lshift.net</A>&gt; wrote:

&gt;<i> Hi David,
</I>&gt;<i>
</I>&gt;<i> You're using the latest default code, yes?
</I>&gt;<i>
</I>&gt;<i> We've just changed the behaviour in this case - previously, yes, the
</I>&gt;<i> queue would be recreated. This is incorrect because it then causes many
</I>&gt;<i> problems when the failed node comes back up - you end up with the same
</I>&gt;<i> queue on both nodes with different concepts of what should be in the
</I>&gt;<i> queue. Exciting if undesireable things happen in this case.
</I>&gt;<i>
</I>&gt;<i> Thus if a queue is declared but it's found that the queue does already
</I>&gt;<i> exist but is on a downed node, we return a 404, because it's really
</I>&gt;<i> saying &quot;the node on which this queue exists can't be found&quot;.
</I>&gt;<i>
</I>&gt;<i> From your code, I see you're declaring the queue durable. This really
</I>&gt;<i> reenforces the issue because if its durable, then persistent messages
</I>&gt;<i> shouldn't be lost, and yet if you want to be able to recreate the queue
</I>&gt;<i> on the other node, then it'll start empty, at which point, logically,
</I>&gt;<i> the contents of the queue have been lost.
</I>&gt;<i>
</I>&gt;<i> In general, clustering should not be used for HA purposes. If you wish
</I>&gt;<i> to achive HA, then active/passive HA can be achieved by using shared
</I>&gt;<i> disk storage, heartbeat/pacemaker, maybe a tcp load balancer on the
</I>&gt;<i> front, and make sure you set the node names to localhost, and point both
</I>&gt;<i> rabbit instances at the same mnesia dir on the shared storage. When the
</I>&gt;<i> passive node comes up, it will recover everything from the storage.
</I>&gt;<i>
</I>&gt;<i> Matthew
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100107/3de25f98/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100107/3de25f98/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005795.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
	<LI>Next message: <A HREF="005822.html">[rabbitmq-discuss] Problem with Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5809">[ date ]</a>
              <a href="thread.html#5809">[ thread ]</a>
              <a href="subject.html#5809">[ subject ]</a>
              <a href="author.html#5809">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
