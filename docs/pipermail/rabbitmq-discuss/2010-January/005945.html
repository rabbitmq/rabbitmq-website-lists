<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ xmpp gateway
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20xmpp%20gateway&In-Reply-To=8517b1311001121225m4e5f9abco7ffc23df11269652%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005850.html">
   <LINK REL="Next"  HREF="005842.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ xmpp gateway</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20xmpp%20gateway&In-Reply-To=8517b1311001121225m4e5f9abco7ffc23df11269652%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ xmpp gateway">tonyg at lshift.net
       </A><BR>
    <I>Wed Jan 20 16:06:29 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005850.html">[rabbitmq-discuss] RabbitMQ xmpp gateway
</A></li>
        <LI>Next message: <A HREF="005842.html">[rabbitmq-discuss] compatibility with legacy code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5945">[ date ]</a>
              <a href="thread.html#5945">[ thread ]</a>
              <a href="subject.html#5945">[ subject ]</a>
              <a href="author.html#5945">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chetna,

Chetna Kaur wrote:
&gt;<i> 1) The gateway doesn't handle loss of connection to the ejabberd server.
</I>
You mean the rabbitmq server? Yes, that's an outstanding issue for sure.
If you fix this, your patch would be very welcome :)

&gt;<i> 2) Consumer Processes are not supervised ( I believe this may be on your
</I>&gt;<i> To-do list).
</I>&gt;<i> If I understand correctly, once a consumer process crashes the user
</I>&gt;<i> associated with the queue will no longer receive any data. This data
</I>&gt;<i> would continue to queue up at the server. Even if the user were to go
</I>&gt;<i> offline and come back online, because of an entry in
</I>&gt;<i> rabbitmq_consumer_process with queue and pid, a new process will not be
</I>&gt;<i> created. Am I missing something here?
</I>
It's been a while since I looked at the code. Yes, the mnesia table will
cause problems.

There's also another bug I know of: if the system is up and working, and
I restart ejabberd, it used to ping presence for all the people it was
supposed to be in touch with. When the replies came in, consumer
processes would be started. However, it no longer seems to do the
initial ping reliably. I haven't investigated the problem though: I have
been lazily working around it by signing out and in of chat to
explicitly issue presence notifications to the rabbit-ejabberd.

&gt;<i> What would be the best way to make these processes supervised?
</I>
Split out the consumer process into a separate gen_server, introduce a
supervisor, and make the mnesia management more robust (probably by
trapping exits and putting cleanup code in the new gen_server's
terminate/2).

Regards,
  Tony



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005850.html">[rabbitmq-discuss] RabbitMQ xmpp gateway
</A></li>
	<LI>Next message: <A HREF="005842.html">[rabbitmq-discuss] compatibility with legacy code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5945">[ date ]</a>
              <a href="thread.html#5945">[ thread ]</a>
              <a href="subject.html#5945">[ subject ]</a>
              <a href="author.html#5945">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
