<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Single vs Multiple Queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Single%20vs%20Multiple%20Queues&In-Reply-To=167204d21001052307r761ce78au6f3976be7a2125e9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005771.html">
   <LINK REL="Next"  HREF="005773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Single vs Multiple Queues</H1>
    <B>vishnu</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Single%20vs%20Multiple%20Queues&In-Reply-To=167204d21001052307r761ce78au6f3976be7a2125e9%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Single vs Multiple Queues">pathsny at gmail.com
       </A><BR>
    <I>Wed Jan  6 10:18:11 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005771.html">[rabbitmq-discuss] Single vs Multiple Queues
</A></li>
        <LI>Next message: <A HREF="005773.html">[rabbitmq-discuss] Single vs Multiple Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5772">[ date ]</a>
              <a href="thread.html#5772">[ thread ]</a>
              <a href="subject.html#5772">[ subject ]</a>
              <a href="author.html#5772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alexis
    yeah, I see the argument about how using a single queue means I do the
filtering at the consumer end, but as I see it, it also means I no longer
have to figure out how to prioritise each of the tasks by providing a number
of consumers (though I can imagine that being useful at times).But if I
expect all jobs to as important, but the number of messages to be variable.
Using a single queue seems to give me the advantage that all messages are of
equal priority and so if I get three times the number of messages of one
type as opposed to others, that task is automatically going to get three
times the number of consumers. Do you have any thoughts about this?

This prevents me from having to juggle numbers to optimise different queues
with different pool size. The cost of filtering seems easier if I can make
sure my messages carry that information. I'm trying to figure out if this
advantage I see is deceptive? Is there a way to achieve the same goal with
different queues? For example if I have multiple queues can I make the pool
of consumers subscribe to all queues and pick up the first message that
comes through no matter what? Or does this not make sense.

Another question that might be related is the reason for the &quot;channel&quot;
abstraction. I have a connection over which I create a channel and then
register queues. What are channels for? Why would I have multiple channels
on one connection.

On Wed, Jan 6, 2010 at 12:37 PM, Alexis Richardson &lt;
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>&gt; wrote:

&gt;<i> Vishnu
</I>&gt;<i>
</I>&gt;<i> If you hang multiple consumers off a single queue, then that queue's
</I>&gt;<i> state is shared and those consumers share the messages out between
</I>&gt;<i> them &quot;round robin&quot; style.  This is good for the 'master worker'
</I>&gt;<i> pattern for example.  Now, you can also have multiple queues doing a
</I>&gt;<i> master/worker type application.  For example you could have four
</I>&gt;<i> queues, one for 'large' tasks (messages), one for 'medium', one for
</I>&gt;<i> 'small', and one more queue that gets a copy of all messages for
</I>&gt;<i> logging and management.  Each of those queues could be private to one
</I>&gt;<i> consumer, or it could be shared among a 'pool' of consumers (eg worker
</I>&gt;<i> threads).
</I>&gt;<i>
</I>&gt;<i> In the above 'large'. 'medium', 'small' tasks example, you can load
</I>&gt;<i> balance work by size by allocating different numbers of consumers to
</I>&gt;<i> each queue.  So, if you want to filter your flows in the broker, use
</I>&gt;<i> many queues.  Using just one queue forces you to manage any filtering
</I>&gt;<i> in your thread pool.
</I>&gt;<i>
</I>&gt;<i> alexis
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Wed, Jan 6, 2010 at 3:53 AM, vishnu &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pathsny at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi
</I>&gt;<i> &gt;    We're looking at building a back end which picks up 3 or 4 different
</I>&gt;<i> &gt; messages. Now we have the option of using a single queue and sending
</I>&gt;<i> &gt; different messages through it, or multiple queues each of which is
</I>&gt;<i> dedicated
</I>&gt;<i> &gt; for a single kind of message.
</I>&gt;<i> &gt; We're wondering what's more common. We're thinking of using Scala with
</I>&gt;<i> lift
</I>&gt;<i> &gt; amqp or the Java api to connect to RabbitMq. On one hand using multiple
</I>&gt;<i> &gt; queues makes it seem like we're going to have to prioritise the number of
</I>&gt;<i> &gt; threads or processes per queue which seems like we're trying to optimise
</I>&gt;<i> &gt; that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100106/469b1b92/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100106/469b1b92/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005771.html">[rabbitmq-discuss] Single vs Multiple Queues
</A></li>
	<LI>Next message: <A HREF="005773.html">[rabbitmq-discuss] Single vs Multiple Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5772">[ date ]</a>
              <a href="thread.html#5772">[ thread ]</a>
              <a href="subject.html#5772">[ subject ]</a>
              <a href="author.html#5772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
