<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 21673 never recovers from emfile
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%2021673%20never%20recovers%20from%20emfile&In-Reply-To=95163FEE-4B99-49C0-BC2E-046E71A75804%40epicadvertising.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005909.html">
   <LINK REL="Next"  HREF="005898.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 21673 never recovers from emfile</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%2021673%20never%20recovers%20from%20emfile&In-Reply-To=95163FEE-4B99-49C0-BC2E-046E71A75804%40epicadvertising.com"
       TITLE="[rabbitmq-discuss] 21673 never recovers from emfile">matthew at lshift.net
       </A><BR>
    <I>Fri Jan 15 16:28:34 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005909.html">[rabbitmq-discuss] 21673 never recovers from emfile
</A></li>
        <LI>Next message: <A HREF="005898.html">[rabbitmq-discuss] Can We Get the message again after delivering to	consumer.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5910">[ date ]</a>
              <a href="thread.html#5910">[ thread ]</a>
              <a href="subject.html#5910">[ subject ]</a>
              <a href="author.html#5910">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jan 15, 2010 at 10:18:39AM -0600, Scott Brooks wrote:
&gt;<i> On 2010-01-15, at 11:09 AM, Matthew Sackman wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; On Fri, Jan 15, 2010 at 09:57:00AM -0600, tsuraan wrote:
</I>&gt;<i> &gt;&gt;&gt; Hmmm, interesting find. I don't think that this is related to the file
</I>&gt;<i> &gt;&gt;&gt; descriptor management that's going on in the new persister, but I'll
</I>&gt;<i> &gt;&gt;&gt; certainly test and see if I can reproduce.
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; Ok, some better test conditions:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Many thanks for these. The Erlang VM gets very upset when it runs out of
</I>&gt;<i> &gt; available file descriptors. The safest thing to do is just to massively
</I>&gt;<i> &gt; raise the limit through ulimit. That said, we do have some plans to be
</I>&gt;<i> &gt; able to artificially limit the number of FDs Rabbit is using to a little
</I>&gt;<i> &gt; less than the actual limit. This would allow Rabbit to successfully
</I>&gt;<i> &gt; refuse new connections when it gets to this artificial limit, and leave
</I>&gt;<i> &gt; enough FDs around for the VM to continue with.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Matthew
</I>&gt;<i> 
</I>&gt;<i> Can you confirm if this bug exists in 1.7.0?
</I>&gt;<i> We have seen some rare crashes that look similar to this on 1.7.0.
</I>
The same behaviour exists in 1.7.0 - the issue is the Erlang VM blowing
up at some random point. It's not really a bug per se - I wouldn't
expect Java or .Net VMs to do particularly well when they run out of
file descriptors either. If you are seeing this, you should raise the
limit on the number of FDs available to Rabbit.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005909.html">[rabbitmq-discuss] 21673 never recovers from emfile
</A></li>
	<LI>Next message: <A HREF="005898.html">[rabbitmq-discuss] Can We Get the message again after delivering to	consumer.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5910">[ date ]</a>
              <a href="thread.html#5910">[ thread ]</a>
              <a href="subject.html#5910">[ subject ]</a>
              <a href="author.html#5910">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
