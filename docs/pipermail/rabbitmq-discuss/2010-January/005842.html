<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] compatibility with legacy code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20compatibility%20with%20legacy%20code&In-Reply-To=167204d21001110814w4f5285c4vd92739c3c5ead772%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005945.html">
   <LINK REL="Next"  HREF="005858.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] compatibility with legacy code</H1>
    <B>Dinabandhu Mitra</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20compatibility%20with%20legacy%20code&In-Reply-To=167204d21001110814w4f5285c4vd92739c3c5ead772%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] compatibility with legacy code">Dinabandhu.Mitra at tecnotree.com
       </A><BR>
    <I>Tue Jan 12 05:50:24 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005945.html">[rabbitmq-discuss] RabbitMQ xmpp gateway
</A></li>
        <LI>Next message: <A HREF="005858.html">[rabbitmq-discuss] Page to disk feature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5842">[ date ]</a>
              <a href="thread.html#5842">[ thread ]</a>
              <a href="subject.html#5842">[ subject ]</a>
              <a href="author.html#5842">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The sample programs are running. I plan to code a thin C++ wrapper over the C API and try it out.

Regards,
Dinabandhu

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Alexis Richardson [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>]
</I>&gt;<i> Sent: Monday, January 11, 2010 9:44 PM
</I>&gt;<i> To: Dinabandhu Mitra
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] compatibility with legacy code
</I>&gt;<i> 
</I>&gt;<i> Great!
</I>&gt;<i> 
</I>&gt;<i> On Mon, Jan 11, 2010 at 3:34 PM, Dinabandhu Mitra
</I>&gt;<i> &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Dinabandhu.Mitra at tecnotree.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi Alexis,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yes :). At least managed to compile. Not tested though as yet.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is complete set of steps that I followed ... it should
</I>&gt;<i> (hopefully) work for anyone using RHEL 4.8
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1. Downloaded rabbitmq-codegen from <A HREF="http://hg.rabbitmq.com/rabbitmq-">http://hg.rabbitmq.com/rabbitmq-</A>
</I>&gt;<i> codegen/archive/default.tar.gz
</I>&gt;<i> &gt; 2. Downloaded rabbitmq-c from <A HREF="http://hg.rabbitmq.com/rabbitmq-">http://hg.rabbitmq.com/rabbitmq-</A>
</I>&gt;<i> c/archive/default.tar.gz
</I>&gt;<i> &gt; 3. Copied both to /home/dinu [my home directory].
</I>&gt;<i> &gt; 4. Download and install simplejson 2.0.5. from
</I>&gt;<i> <A HREF="http://pypi.python.org/pypi/simplejson/2.0.5">http://pypi.python.org/pypi/simplejson/2.0.5</A> .
</I>&gt;<i> &gt; &#160; [The current latest version 2.0.9 is dependent on Python 2.4+ and I
</I>&gt;<i> don't know if it will
</I>&gt;<i> &gt; &#160; work on RHEL 4.8 which comes with python 2.3+.]
</I>&gt;<i> &gt; 5. tar -xvzf rabbitmq-c-default.tar.gz
</I>&gt;<i> &gt; 6. tar -xvzf rabbitmq-codegen-default.tar.gz
</I>&gt;<i> &gt; 7. mv rabbitmq-c-default rabbitmq-c
</I>&gt;<i> &gt; 8. mv rabbitmq-codegen-default rabbitmq-codegen
</I>&gt;<i> &gt; 9. cd rabbitmq-c
</I>&gt;<i> &gt; 10. Edit &quot;configure.ac&quot; file and make the following changes
</I>&gt;<i> &gt; &#160; &#160; &#160; &#160;#sibling_codegen_dir=&quot;$ac_abs_confdir/../rabbitmq-codegen&quot;
</I>&gt;<i> &gt; &#160; &#160; &#160; &#160;sibling_codegen_dir=&quot;/home/dinu/rabbitmq-codegen&quot;
</I>&gt;<i> &gt; &#160; Note that this step was required in my environment. But that may be
</I>&gt;<i> due
</I>&gt;<i> &gt; &#160; to something broken in the server I am using and may not be
</I>&gt;<i> necessary for everyone.
</I>&gt;<i> &gt; 11. autoreconf -i
</I>&gt;<i> &gt; 12. ./configure
</I>&gt;<i> &gt; 13. Edit librabbitmq/Makefile* (three files) and make the following
</I>&gt;<i> modification in each
</I>&gt;<i> &gt; &#160; &#160;#PYTHON=python2.5
</I>&gt;<i> &gt; &#160; &#160;PYTHON=python
</I>&gt;<i> &gt; 14. make
</I>&gt;<i> &gt; 15. make install [I logged in as root to do the install but may not
</I>&gt;<i> be necessary]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Lastly, for people like me, for whom the word &quot;python&quot; relates only
</I>&gt;<i> to a large serpent :),
</I>&gt;<i> &gt; this is how I built simplejson -
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1. Download simplejson 2.0.5 source from
</I>&gt;<i> <A HREF="http://pypi.python.org/pypi/simplejson/2.0.5">http://pypi.python.org/pypi/simplejson/2.0.5</A>
</I>&gt;<i> &gt; 2. tar -xvzf simplejson-2.0.5.tar.gz
</I>&gt;<i> &gt; 3. cd simplejson-2.0.5
</I>&gt;<i> &gt; 4. python ez_setup.py [I am not sure if this is necessary but I did
</I>&gt;<i> this]
</I>&gt;<i> &gt; 5. python setup.py build
</I>&gt;<i> &gt; 6. python setup.py install
</I>&gt;<i> &gt; 7. I did above steps as root user.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As of now, the library seems to have built and installed correctly
</I>&gt;<i> ... i.e. I can see
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; /usr/local/lib/librabbitmq.*
</I>&gt;<i> &gt; /usr/local/bin/amqp_* [I guess example binaries]
</I>&gt;<i> &gt; /usr/local/include/amqp*.h
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I will test the installation and keep you posted.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt; Dinabandhu
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; -----Original Message-----
</I>&gt;<i> &gt;&gt; From: Alexis Richardson [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at gmail.com</A>]
</I>&gt;<i> &gt;&gt; Sent: Monday, January 11, 2010 5:00 PM
</I>&gt;<i> &gt;&gt; To: Dinabandhu Mitra
</I>&gt;<i> &gt;&gt; Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt;&gt; Subject: Re: [rabbitmq-discuss] compatibility with legacy code
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Dinabandhu
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; How are you getting on? &#160;Were you able to get the C client working?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; alexis
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On Fri, Jan 8, 2010 at 10:18 AM, Dinabandhu
</I>&gt;<i> &gt;&gt; &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dinabandhu.mitra at tecnotree.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Hi Tony,
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I am trying to build this. I followed your links &amp; instructions
</I>&gt;<i> here.
</I>&gt;<i> &gt;&gt; &gt; configure still gives error saying it could not find AMQP spec
</I>&gt;<i> file
</I>&gt;<i> &gt;&gt; at
</I>&gt;<i> &gt;&gt; &gt; '/codegen/amqp-0.8.json'.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; This directory is of course wrong because the file is actually at
</I>&gt;<i> &gt;&gt; &gt; /home/dinu/rabbitmq-codegen.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; The variable $ac_abs_confdir is blank and that seems to be reason
</I>&gt;<i> ...
</I>&gt;<i> &gt;&gt; from
</I>&gt;<i> &gt;&gt; &gt; the configure script it looks like $ac_abs_confdir is expected to
</I>&gt;<i> &gt;&gt; point to
</I>&gt;<i> &gt;&gt; &gt; the directory from where configure is being run. I don't know
</I>&gt;<i> enough
</I>&gt;<i> &gt;&gt; about
</I>&gt;<i> &gt;&gt; &gt; the autoconf tool chain to determine the root cause.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I next modified configure.ac file to point sibling_codegen_dir to
</I>&gt;<i> the
</I>&gt;<i> &gt;&gt; &gt; correct directory ...
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; #sibling_codegen_dir=&quot;$ac_abs_confdir/../rabbitmq-codegen&quot;
</I>&gt;<i> &gt;&gt; &gt; sibling_codegen_dir=&quot;/home/janus/dinu/rabbitmq-codegen&quot;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; After this change the configure script went through. But make
</I>&gt;<i> still
</I>&gt;<i> &gt;&gt; fails
</I>&gt;<i> &gt;&gt; &gt; ...
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; [<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dinu at j4</A> rabbitmq-c]$ make
</I>&gt;<i> &gt;&gt; &gt; make &#160;all-recursive
</I>&gt;<i> &gt;&gt; &gt; make[1]: Entering directory `/home/dinu/rabbitmq-c'
</I>&gt;<i> &gt;&gt; &gt; Making all in librabbitmq
</I>&gt;<i> &gt;&gt; &gt; make[2]: Entering directory `/home/dinu/rabbitmq-c/librabbitmq'
</I>&gt;<i> &gt;&gt; &gt; PYTHONPATH=/home/dinu/rabbitmq-codegen python2.5 ./codegen.py
</I>&gt;<i> header
</I>&gt;<i> &gt;&gt; &gt; /home/dinu/rabbitmq-codegen/amqp-0.8.json amqp_framing.h
</I>&gt;<i> &gt;&gt; &gt; /bin/sh: python2.5: command not found
</I>&gt;<i> &gt;&gt; &gt; make[2]: *** [amqp_framing.h] Error 127
</I>&gt;<i> &gt;&gt; &gt; make[2]: Leaving directory `/home/dinu/rabbitmq-c/librabbitmq'
</I>&gt;<i> &gt;&gt; &gt; make[1]: *** [all-recursive] Error 1
</I>&gt;<i> &gt;&gt; &gt; make[1]: Leaving directory `/home/dinu/rabbitmq-c'
</I>&gt;<i> &gt;&gt; &gt; make: *** [all] Error 2
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I don't have python2.5. what is there on my machine is python2.3.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I am using RHEL 4.8 64 bit. Does the library expect some other
</I>&gt;<i> &gt;&gt; distribution?
</I>&gt;<i> &gt;&gt; &gt; 5.x?
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; I will try by modifying the script files ... but if you can
</I>&gt;<i> provide
</I>&gt;<i> &gt;&gt; some
</I>&gt;<i> &gt;&gt; &gt; pointers it would be good.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Regards,
</I>&gt;<i> &gt;&gt; &gt; Dinabandhu
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Tony Garnock-Jones-2 wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Hi Jim,
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Jim Irrer wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; checking location of AMQP codegen directory... configure: error:
</I>&gt;<i> &gt;&gt; could
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; not find AMQP spec file at &quot;'/codegen/amqp-0.9.1.json'&quot;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; The MD5sum is correct, b50fd568311a052a45157631ba17c2b5, but are
</I>&gt;<i> you
</I>&gt;<i> &gt;&gt; &gt;&gt; sure you're really building the one you just downloaded? For me,
</I>&gt;<i> &gt;&gt; using
</I>&gt;<i> &gt;&gt; &gt;&gt; the file with the MD5sum you provided, I get:
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; checking location of AMQP codegen directory... configure: error:
</I>&gt;<i> &gt;&gt; could
</I>&gt;<i> &gt;&gt; &gt;&gt; not find AMQP spec file at
</I>&gt;<i> &gt;&gt; &gt;&gt; &quot;'/Users/tonyg/qq/rabbitmq-c-default/codegen/amqp-0.8.json'&quot;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Note the 0.8 version number.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; Am I supposed to get that file from somewhere else, or should it
</I>&gt;<i> be
</I>&gt;<i> &gt;&gt; in
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; the tarball?
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; You should retrieve rabbitmq-codegen as well. Sorry for the
</I>&gt;<i> &gt;&gt; incomplete
</I>&gt;<i> &gt;&gt; &gt;&gt; instructions, I really must write this up properly and check it
</I>&gt;<i> in.
</I>&gt;<i> &gt;&gt; &gt;&gt; Here's a complete recipe for building the C client and examples,
</I>&gt;<i> on
</I>&gt;<i> &gt;&gt; the
</I>&gt;<i> &gt;&gt; &gt;&gt; 0-8 branch.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;curl <A HREF="http://hg.rabbitmq.com/rabbitmq-">http://hg.rabbitmq.com/rabbitmq-</A>
</I>&gt;<i> &gt;&gt; codegen/archive/default.tar.gz\
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160; | tar -zxf -
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;curl <A HREF="http://hg.rabbitmq.com/rabbitmq-c/archive/default.tar.gz\">http://hg.rabbitmq.com/rabbitmq-c/archive/default.tar.gz\</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160; | tar -zxf -
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;mv rabbitmq-codegen-default rabbitmq-codegen
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;mv rabbitmq-c-default rabbitmq-c
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;cd rabbitmq-c
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;autoreconf -i
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;./configure
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;make
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Alternatively, if you have mercurial installed:
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;hg clone <A HREF="http://hg.rabbitmq.com/rabbitmq-codegen">http://hg.rabbitmq.com/rabbitmq-codegen</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;hg clone <A HREF="http://hg.rabbitmq.com/rabbitmq-c">http://hg.rabbitmq.com/rabbitmq-c</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;cd rabbitmq-c
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;autoreconf -i
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;./configure
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160;make
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; Also, I have doubts that this will work anyway, because the
</I>&gt;<i> &gt;&gt; RabbitMQ
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; server
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt; is running at version 0.8, so it won't be compatible with this
</I>&gt;<i> &gt;&gt; client.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; The &quot;default&quot; branches of both the C client and the server are
</I>&gt;<i> for
</I>&gt;<i> &gt;&gt; 0-8,
</I>&gt;<i> &gt;&gt; &gt;&gt; and do work together.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Cheers,
</I>&gt;<i> &gt;&gt; &gt;&gt; &#160; Tony
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-</A>
</I>&gt;<i> discuss
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; --
</I>&gt;<i> &gt;&gt; &gt; View this message in context: <A HREF="http://old.nabble.com/compatibility-">http://old.nabble.com/compatibility-</A>
</I>&gt;<i> &gt;&gt; with-legacy-code-tp26197670p27073885.html
</I>&gt;<i> &gt;&gt; &gt; Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt;&gt; &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt;&gt; &gt; <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-</A>
</I>&gt;<i> discuss
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005945.html">[rabbitmq-discuss] RabbitMQ xmpp gateway
</A></li>
	<LI>Next message: <A HREF="005858.html">[rabbitmq-discuss] Page to disk feature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5842">[ date ]</a>
              <a href="thread.html#5842">[ thread ]</a>
              <a href="subject.html#5842">[ subject ]</a>
              <a href="author.html#5842">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
