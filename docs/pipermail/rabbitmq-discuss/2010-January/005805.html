<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Daemonizing connection threads (was Re: .Net	client foreground threads)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Daemonizing%20connection%20threads%20%28was%20Re%3A%20.Net%0A%09client%20foreground%20threads%29&In-Reply-To=4B45E8E5.5040804%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005799.html">
   <LINK REL="Next"  HREF="005878.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Daemonizing connection threads (was Re: .Net	client foreground threads)</H1>
    <B>JD Conley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Daemonizing%20connection%20threads%20%28was%20Re%3A%20.Net%0A%09client%20foreground%20threads%29&In-Reply-To=4B45E8E5.5040804%40lshift.net"
       TITLE="[rabbitmq-discuss] Daemonizing connection threads (was Re: .Net	client foreground threads)">jdc at hive7.com
       </A><BR>
    <I>Thu Jan  7 18:39:50 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="005799.html">[rabbitmq-discuss] Daemonizing connection threads (was Re: .Net client foreground threads)
</A></li>
        <LI>Next message: <A HREF="005878.html">[rabbitmq-discuss] Daemonizing connection threads (was Re: .Net	client foreground threads)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5805">[ date ]</a>
              <a href="thread.html#5805">[ thread ]</a>
              <a href="subject.html#5805">[ subject ]</a>
              <a href="author.html#5805">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> At the moment there's no easy way to ask for daemon threads if you
</I>&gt;<i> decide they're appropriate for your app: so maybe we should go with
</I>&gt;<i> non-daemon per default, daemon per user-selectable option.
</I>
A background/daemon thread would be preferred for our situation as well.
This configurable option would be great.

In our ASP.NET applications we hook the app domain unload event and try to
complete our pending rabbit operations and close things down. Maybe
something along these lines should be recommended in the docs. Doing this
along with making the client use a background thread means you still get the
chance to cleanup and know what has and hasn't been written to the exchange,
and you also know your app will actually shutdown and not hang.


        Thread.GetDomain().DomainUnload += new
EventHandler(RabbitmqAsyncCommandService_DomainUnload);

...

        void RabbitmqAsyncCommandService_DomainUnload(object sender,
EventArgs e)
        {
            if (null != _cnn)
            {
                //wait for stuff to finish (up to a few seconds)... 
                //close the channels...

                _cnn.Close();
            }
        }

-JD





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005799.html">[rabbitmq-discuss] Daemonizing connection threads (was Re: .Net client foreground threads)
</A></li>
	<LI>Next message: <A HREF="005878.html">[rabbitmq-discuss] Daemonizing connection threads (was Re: .Net	client foreground threads)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5805">[ date ]</a>
              <a href="thread.html#5805">[ thread ]</a>
              <a href="subject.html#5805">[ subject ]</a>
              <a href="author.html#5805">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
