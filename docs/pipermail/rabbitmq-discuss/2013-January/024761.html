<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Returned messages when Federation in effect?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Returned%20messages%20when%20Federation%20in%20effect%3F&In-Reply-To=%3C50E5B001.5040807%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024742.html">
   <LINK REL="Next"  HREF="024745.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Returned messages when Federation in effect?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Returned%20messages%20when%20Federation%20in%20effect%3F&In-Reply-To=%3C50E5B001.5040807%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Returned messages when Federation in effect?">simon at rabbitmq.com
       </A><BR>
    <I>Thu Jan  3 16:21:21 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024742.html">[rabbitmq-discuss] Returned messages when Federation in effect?
</A></li>
        <LI>Next message: <A HREF="024745.html">[rabbitmq-discuss] rabbitmq on remote server?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24761">[ date ]</a>
              <a href="thread.html#24761">[ thread ]</a>
              <a href="subject.html#24761">[ subject ]</a>
              <a href="author.html#24761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/01/13 21:39, Matt Pietrek wrote:
&gt;<i> I imagine this is already answered somewhere, but I can't seem to locate
</I>&gt;<i> a concise answer.
</I>&gt;<i>
</I>&gt;<i> if a client publishes a messages using a routing key that doesn't
</I>&gt;<i> resolve to anywhere reachable, should the message be returned to the
</I>&gt;<i> client via basic.return?
</I>
Yes. Ish.

Since the bindings get propagated upstream, it should be the case that 
if a message won't get routed, you'll find out about it.

However, note that in the single broker / cluster case, this happens 
immediately - as soon as you unbind a queue from an exchange you will 
start to get basic.returns for messages that would no longer be routed. 
Due to the eventually consistent nature of federation, you're not 
guaranteed this will happen immediately.

Also note that there were bugs in the pre-3.0.0 binding propagation code 
which could cause bindings to never be removed upstream.

Cheers, Simon

&gt;<i>
</I>&gt;<i> Background:
</I>&gt;<i>
</I>&gt;<i> I'm currently working with 2.8.7 using a topic exchange to route between
</I>&gt;<i> rabbitmq instances. The federation looks like this:
</I>&gt;<i>
</I>&gt;<i> client1 &lt;--&gt; master &lt;--&gt; client2
</I>&gt;<i>
</I>&gt;<i> Maxhops is set to 1, and client1 and client2 don't have federation
</I>&gt;<i> between them.
</I>&gt;<i>
</I>&gt;<i> Each routing key instance looks something like 'client1.xxx.yyy. or
</I>&gt;<i> 'master.xxx.yyy', that is, the routing key contains the broker name that
</I>&gt;<i> the message is intended for.
</I>&gt;<i>
</I>&gt;<i> If client1 attempts to write a message using 'client2.xxx.yyy', should I
</I>&gt;<i> expect to see the message returned to me or is it just dropped on the floor?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Matt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024742.html">[rabbitmq-discuss] Returned messages when Federation in effect?
</A></li>
	<LI>Next message: <A HREF="024745.html">[rabbitmq-discuss] rabbitmq on remote server?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24761">[ date ]</a>
              <a href="thread.html#24761">[ thread ]</a>
              <a href="subject.html#24761">[ subject ]</a>
              <a href="author.html#24761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
