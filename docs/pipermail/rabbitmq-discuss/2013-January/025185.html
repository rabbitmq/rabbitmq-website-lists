<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ scaling with OpenStack
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scaling%20with%20OpenStack&In-Reply-To=%3C50AFC3AB-981C-42D8-AB02-31496E42D8B4%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025122.html">
   <LINK REL="Next"  HREF="025124.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ scaling with OpenStack</H1>
    <B>Ask Solem</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scaling%20with%20OpenStack&In-Reply-To=%3C50AFC3AB-981C-42D8-AB02-31496E42D8B4%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ scaling with OpenStack">ask at rabbitmq.com
       </A><BR>
    <I>Mon Jan 28 11:44:39 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025122.html">[rabbitmq-discuss] RabbitMQ scaling with OpenStack
</A></li>
        <LI>Next message: <A HREF="025124.html">[rabbitmq-discuss] Rabbit Node Won't Boot No Matter What I Do	(schema_integrity_check_failed)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25185">[ date ]</a>
              <a href="thread.html#25185">[ thread ]</a>
              <a href="subject.html#25185">[ subject ]</a>
              <a href="author.html#25185">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jan 23, 2013, at 2:04 AM, Ray Pekowski &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pekowski at gmail.com</A>&gt; wrote:

&gt;<i> On Jan 22, 2013, at 1:58 PM, Ask Solem &lt;ask at rabbitmq.com&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; I could help you review the code as I have lots of experience optimizing
</I>&gt;<i> &gt; this pattern and Python consumers.
</I>&gt;<i> 
</I>&gt;<i> It would be great if you could review the code.  Here is where the Kombu interface is implemented in OpenStack
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://github.com/openstack/nova/blob/master/nova/openstack/common/rpc/impl_kombu.py">https://github.com/openstack/nova/blob/master/nova/openstack/common/rpc/impl_kombu.py</A>
</I>&gt;<i> 
</I>&gt;<i> Roughly, the RPC call is sent by TopicPublisher (caller), then received by TopicConsumers (callee).  The response is sent by DirectPublisher (callee) and received by DirectConsumer (caller).  In real time, the consumes happen before the publishes.
</I>&gt;<i> 
</I>&gt;<i> The RPC calls to impl_kombu.py come from amqp.py. which is simply a common higher level set of methods that either calls methods from impl_kombu.py or impl_qpid.py depending upon which implementation is configured.
</I>&gt;<i> 
</I>&gt;<i> Ray
</I>&gt;<i> 
</I>
I've spent some time reviewing the code, but it's really hard to follow, and it's
reinventing a lot of things that Kombu already supports.   Having two sets of
implementations means that we both have to debug and maintain it, this code could
definitely be reduced by a lot.

One thing that I'm unable to understand is whether it's creating a channel or not
(other than the Connection.default_channel), and if so if it creates a channel for
every request.  This would be bad since creating channels is very expensive (at least in amqplib/py-amqp).

Also, it seems that the reply messages are persistent, do they have to be?

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025122.html">[rabbitmq-discuss] RabbitMQ scaling with OpenStack
</A></li>
	<LI>Next message: <A HREF="025124.html">[rabbitmq-discuss] Rabbit Node Won't Boot No Matter What I Do	(schema_integrity_check_failed)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25185">[ date ]</a>
              <a href="thread.html#25185">[ thread ]</a>
              <a href="subject.html#25185">[ subject ]</a>
              <a href="author.html#25185">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
