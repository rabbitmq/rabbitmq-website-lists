<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20cluster%20with%20potentially%20millions%0A%09of%20connections&In-Reply-To=%3C1359393082853-24720.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025176.html">
   <LINK REL="Next"  HREF="025198.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections</H1>
    <B>Romanas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20cluster%20with%20potentially%20millions%0A%09of%20connections&In-Reply-To=%3C1359393082853-24720.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections">romanass at gmail.com
       </A><BR>
    <I>Mon Jan 28 17:11:22 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025176.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
</A></li>
        <LI>Next message: <A HREF="025198.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions of connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25196">[ date ]</a>
              <a href="thread.html#25196">[ thread ]</a>
              <a href="subject.html#25196">[ subject ]</a>
              <a href="author.html#25196">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jason,

mc717990 wrote
&gt;<i> Umm, I'm reasonably sure millions of persistent connections isn't possible
</I>&gt;<i> through a single entry point.  First, with TCP/IP communications an
</I>&gt;<i> interface only has 65k ports (roughly).  Of those, quite a few are
</I>&gt;<i> typically in use for things like SSH requests or similar.  I'm actually
</I>&gt;<i> surprised you made it to 30k simultaneous connections.  Now, you should be
</I>&gt;<i> able to handle that many channels when distributed across a cluster - at
</I>&gt;<i> least I think so though I've not really tested that situation.  The kicker
</I>&gt;<i> is even if a server can handle say 30k connections and so you have your 50
</I>&gt;<i> servers, the load balancer itself would become your bottle neck as it
</I>&gt;<i> couldn't keep open a million persistent connections (again, 65k limit,
</I>&gt;<i> which is really a lot lower).  Most load balancers act as a proxy, not as
</I>&gt;<i> a DNS lookup in concept.
</I>
Yes I'm aware of this limitation - there are ways around it, e.g. having
multiple LBs and perform DNS load balancing on them (like the Amazon ELB
does) or having multiple outbound network interfaces on the LB. However
that's not the point. My problems is that even if I spread the load myself
without going through the LB, the cluster seems to grind to a halt after a
while. 

As Matthias suggested, I've switched to using a single exchange for all
connections (each connection with it's own routing key), however I'm still
struggling to go above 10-15k connections per node. I did disable the
management plugin on all but one node (just to keep track of what's going
on), but that didn't seem to help much. I'm pretty sure this isn't such an
obscure use case. Is there anything I could do to try troubleshooting this
(the log files aren't very useful!)? 

Regards,
Roman



--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/RabbitMQ-cluster-with-potentially-millions-of-connections-tp24698p24720.html">http://rabbitmq.1065348.n5.nabble.com/RabbitMQ-cluster-with-potentially-millions-of-connections-tp24698p24720.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025176.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
</A></li>
	<LI>Next message: <A HREF="025198.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions of connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25196">[ date ]</a>
              <a href="thread.html#25196">[ thread ]</a>
              <a href="subject.html#25196">[ subject ]</a>
              <a href="author.html#25196">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
