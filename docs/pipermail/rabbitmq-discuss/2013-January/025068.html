<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmqctl.bat not working:Cookie handling	problem [windows multi-user access]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmqctl.bat%20not%20working%3ACookie%20handling%0A%09problem%20%5Bwindows%20multi-user%20access%5D&In-Reply-To=%3CFD8AA686-4271-46F4-A946-E639EA5C0822%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025064.html">
   <LINK REL="Next"  HREF="025065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmqctl.bat not working:Cookie handling	problem [windows multi-user access]</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmqctl.bat%20not%20working%3ACookie%20handling%0A%09problem%20%5Bwindows%20multi-user%20access%5D&In-Reply-To=%3CFD8AA686-4271-46F4-A946-E639EA5C0822%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmqctl.bat not working:Cookie handling	problem [windows multi-user access]">watson.timothy at gmail.com
       </A><BR>
    <I>Sun Jan 20 19:33:42 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025064.html">[rabbitmq-discuss] rabbitmqctl.bat not working:Cookie handling problem [windows multi-user access]
</A></li>
        <LI>Next message: <A HREF="025065.html">[rabbitmq-discuss] logfile maintenance in windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25068">[ date ]</a>
              <a href="thread.html#25068">[ thread ]</a>
              <a href="subject.html#25068">[ subject ]</a>
              <a href="author.html#25068">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

On 20 Jan 2013, at 15:57, mabra wrote:

&gt;<i> Hello !
</I>&gt;<i> 
</I>&gt;<i> I want to control the shovel status [start/stop/get] and I have to this from my own program,
</I>&gt;<i> which just spawns a sub-process, which uses &quot;rabbitmqctl.bat&quot;. It does not work, but this
</I>&gt;<i> is decribed in the trouble shooting document a bit.
</I>&gt;<i> 
</I>&gt;<i> I needed hours to find out the consequence of this statement [from the troubleshooting guide]:
</I>&gt;<i> 
</I>&gt;<i> &quot;Evidence of this comes in the form of a mismatch in the node home dir shown by the broker on startup vs what is displayed in the rabbitmqctl diagnostics.&quot;
</I>&gt;<i> 
</I>&gt;<i> is just no help on how to find the cookie, which is in use and how to allow other users
</I>&gt;<i> to use this. In the service-docs is just a small hint:
</I>&gt;<i> 
</I>&gt;<i> &quot;It is therefore necessary to synchronise Erlang cookies
</I>&gt;<i>    between the local system account (typically C:\WINDOWS\.erlang.cookie and
</I>&gt;<i>    the account that will be used to run rabbitmqctl&quot;
</I>&gt;<i> 
</I>
That's hardly a *small* hint - it says that 'it is necessary' to do this. Erlang nodes require a cookie file in order to secure communication with one another. Furthermore, the installation guide for Windows states categorically:

&quot;Erlang Security Cookies used by the service account and the user running rabbitmqctl.bat must be synchronised for rabbitmqctl.bat to function. To ensure Erlang cookie files contain the same string, copy the .erlang.cookie file from the Windows directory (normally C:\WINDOWS\.erlang.cookie) to replace the user .erlang.cookie. The user cookie will be in the user's home directory (%HOMEDRIVE%%HOMEPATH%), e.g. C:\Documents and Settings\%USERNAME%\.erlang.cookie or C:\Users\%USERNAME%\.erlang.cookie (Windows Vista and later).&quot; 

Is that not clear enough?

&gt;<i> This leads to the little nightmare to copy the services cookie to all users homedirs,
</I>&gt;<i> which should be able to run &quot;rabbitmqctl.bat&quot;. The cookie value is not in the services
</I>&gt;<i> logfile, so, one cannot know it.
</I>&gt;<i> 
</I>
Following the Windows installation guide should obviate the need to know what the cookie value is set to.

&gt;<i> So, is ther another way ? This way would require to copy the cookie each time, the
</I>&gt;<i> service is restarted [so, at least on each boot!].
</I>
Why would you have to copy the cookie after the service was restarted? Even when running a manually installed Windows Service, you still only need to re-sync the cookies if they have changed. Perhaps I'm missing something? Can't you just copy the cookie to the home directory of the user under which the program always runs? If the cookie is static, can't you just bundle it as an assembly resource and handle it when spawning the sub-process?

&gt;<i> Is there probably a direct accessible
</I>&gt;<i> way from a Net Framework program ?
</I>&gt;<i> 
</I>
A 'direct accessible way' of doing what from a .NET program? 

</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025064.html">[rabbitmq-discuss] rabbitmqctl.bat not working:Cookie handling problem [windows multi-user access]
</A></li>
	<LI>Next message: <A HREF="025065.html">[rabbitmq-discuss] logfile maintenance in windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25068">[ date ]</a>
              <a href="thread.html#25068">[ thread ]</a>
              <a href="subject.html#25068">[ subject ]</a>
              <a href="author.html#25068">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
