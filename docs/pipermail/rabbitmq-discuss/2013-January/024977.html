<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbitmq boot failure with	&quot;tables_not_present&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20boot%20failure%20with%0A%09%22tables_not_present%22&In-Reply-To=%3CCAE0Sz%3DxUPNDeQP7XyPgXR%2Ben-4YLeVJyeQVspcRdJKiJCaSpLw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024976.html">
   <LINK REL="Next"  HREF="024985.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbitmq boot failure with	&quot;tables_not_present&quot;</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20boot%20failure%20with%0A%09%22tables_not_present%22&In-Reply-To=%3CCAE0Sz%3DxUPNDeQP7XyPgXR%2Ben-4YLeVJyeQVspcRdJKiJCaSpLw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbitmq boot failure with	&quot;tables_not_present&quot;">jerryk at rbcon.com
       </A><BR>
    <I>Thu Jan 17 00:45:43 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024976.html">[rabbitmq-discuss] Rabbitmq boot failure	with	&quot;tables_not_present&quot;
</A></li>
        <LI>Next message: <A HREF="024985.html">[rabbitmq-discuss] Rabbitmq boot failure with	&quot;tables_not_present&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24977">[ date ]</a>
              <a href="thread.html#24977">[ thread ]</a>
              <a href="subject.html#24977">[ subject ]</a>
              <a href="author.html#24977">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> I think during the time the error logs are generated, the cluster may not
</I>&gt;<i> be successfully formed. As part of the deployment scripts, I deleted all
</I>&gt;<i> content in /var/lib/rabbitmq/mnesia to recover from some scenario when
</I>&gt;<i> cluster cannot be formed. Here is the relevant part of the deployment
</I>&gt;<i> scripts:
</I>&gt;<i>
</I> **
&gt;<i>
</I>&gt;<i> sudo(&quot;bash -c 'echo XXXXXXXXXXXXXXXX &gt; /var/lib/rabbitmq/.erlang.cookie'&quot;)
</I>&gt;<i> ****
</I>&gt;<i>
</I>&gt;<i> sudo(&quot;chown rabbitmq /var/lib/rabbitmq/.erlang.cookie&quot;)****
</I>&gt;<i>
</I>&gt;<i> sudo(&quot;chmod 600 /var/lib/rabbitmq/.erlang.cookie&quot;)****
</I>&gt;<i>
</I>&gt;<i> sudo(&quot;rm -fr /var/lib/rabbitmq/mnesia&quot;)
</I>&gt;<i>
</I>
That is indeed a fine way to get rid of your Mnesia contents including
clustering info and any metadata that needs to be shared amongst the nodes
(queue, exchange, binding, user, vhost, etc. definitions).

On the other hand, after you've done it, you've got no really good reason
to expect your nodes to act as clustered.


&gt;<i> ****
</I>&gt;<i>
</I>&gt;<i> What I want to achieve after redeployment is to erase previous states
</I>&gt;<i> completely and let the cluster starts with a clean state, that&#8217;s why I
</I>&gt;<i> erased the /mnesia folder (is there a better way to do that?). The problem
</I>&gt;<i> is sometimes the error messages show up for a few minutes then everything
</I>&gt;<i> works fine after that, but other times I saw the error message being logged
</I>&gt;<i> for 80 minutes before the cluster works correctly. Do you have any
</I>&gt;<i> suggestions?
</I>&gt;<i>
</I>
Are you establishing your clusters using the rabbitmq command line tools or
by statically encoding their properties in your rabbitmq.config files?
 You're going to have to repeat whichever you did when you bring a newly
redeployed cluster, having gone through the cleansing you outline above,
back online.

You might consider setting up scripts to execute the appropriate commands,
as per our clustering guide, on the appropriate nodes after you've done the
scripted clean-up you describe.

Best regards,
Jerry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130116/5bcc8503/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130116/5bcc8503/attachment.htm</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024976.html">[rabbitmq-discuss] Rabbitmq boot failure	with	&quot;tables_not_present&quot;
</A></li>
	<LI>Next message: <A HREF="024985.html">[rabbitmq-discuss] Rabbitmq boot failure with	&quot;tables_not_present&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24977">[ date ]</a>
              <a href="thread.html#24977">[ thread ]</a>
              <a href="subject.html#24977">[ subject ]</a>
              <a href="author.html#24977">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
