<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Publisher confirms when the unexpected	happens
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publisher%20confirms%20when%20the%20unexpected%0A%09happens&In-Reply-To=%3C50F154C2.20602%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024889.html">
   <LINK REL="Next"  HREF="024893.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Publisher confirms when the unexpected	happens</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publisher%20confirms%20when%20the%20unexpected%0A%09happens&In-Reply-To=%3C50F154C2.20602%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Publisher confirms when the unexpected	happens">matthias at rabbitmq.com
       </A><BR>
    <I>Sat Jan 12 12:19:14 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024889.html">[rabbitmq-discuss] Publisher confirms when the unexpected happens
</A></li>
        <LI>Next message: <A HREF="024893.html">[rabbitmq-discuss] Publisher confirms when the unexpected	happens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24891">[ date ]</a>
              <a href="thread.html#24891">[ thread ]</a>
              <a href="subject.html#24891">[ subject ]</a>
              <a href="author.html#24891">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Chris,

On 12/01/13 11:59, Chris Duncan wrote:
&gt;<i> I am publishing persistent messages which get routed via a durable
</I>&gt;<i> direct exchange to a durable queue. The channel that I'm using is in
</I>&gt;<i> confirmation mode. There are no consumers subscribed to the queue.
</I>&gt;<i>
</I>&gt;<i> What I would like to understand is what happens if my publisher loses
</I>&gt;<i> its AMQP connection and channels after it has sent all of its messages
</I>&gt;<i> but before it can receive any confirmations. I'm testing this in two ways:
</I>&gt;<i>
</I>&gt;<i> 1. My publisher sends its messages and then exits immediately.
</I>&gt;<i> 2. My publisher sends its messages, closes the connection/channels in a
</I>&gt;<i> controlled manner and then exits.
</I>&gt;<i>
</I>&gt;<i> No. 2 above always results in all of the messages appearing in the
</I>&gt;<i> target queue. I don't have any issues with this behaviour.
</I>&gt;<i>
</I>&gt;<i> However, when I perform No. 1 above, I am observing inconsistent
</I>&gt;<i> behaviour. Sometimes all of the messages appear in the target queue, but
</I>&gt;<i> at other times only some of the messages appear. There are always some
</I>&gt;<i> messages in the queue - never zero.
</I>&gt;<i>
</I>&gt;<i> What I was hoping for was an 'all or nothing' outcome for No. 1 as in
</I>&gt;<i> No. 2. So what I'd like to know is - is the behaviour that I'm seeing
</I>&gt;<i> expected from a RabbitMQ point of view?
</I>
That behaviour is perfectly normal and expected. See my reply to your 
other message.

The fact that you have the channel in confirm mode is irrelevant here, 
since you are not actually looking at the confirmations. If you did then 
you'd know which message definitely have been received and processed by 
the broker. But you still wouldn't have an &quot;all or nothing&quot; guarantee. 
Transactions are the closest you can get for that.

Regards,

Matthias.
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024889.html">[rabbitmq-discuss] Publisher confirms when the unexpected happens
</A></li>
	<LI>Next message: <A HREF="024893.html">[rabbitmq-discuss] Publisher confirms when the unexpected	happens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24891">[ date ]</a>
              <a href="thread.html#24891">[ thread ]</a>
              <a href="subject.html#24891">[ subject ]</a>
              <a href="author.html#24891">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
