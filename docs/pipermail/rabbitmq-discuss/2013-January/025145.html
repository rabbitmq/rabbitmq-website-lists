<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ scaling with OpenStack
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scaling%20with%20OpenStack&In-Reply-To=%3CCAJcv3CRbrbwoEHH57jhcZ_e0kqEfDbSXFoNVfN%2BZhcu_jdw7Ag%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025094.html">
   <LINK REL="Next"  HREF="025156.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ scaling with OpenStack</H1>
    <B>Ray Pekowski</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scaling%20with%20OpenStack&In-Reply-To=%3CCAJcv3CRbrbwoEHH57jhcZ_e0kqEfDbSXFoNVfN%2BZhcu_jdw7Ag%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ scaling with OpenStack">pekowski at gmail.com
       </A><BR>
    <I>Wed Jan 23 16:43:04 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025094.html">[rabbitmq-discuss] RabbitMQ scaling with OpenStack
</A></li>
        <LI>Next message: <A HREF="025156.html">[rabbitmq-discuss] RabbitMQ scaling with OpenStack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25145">[ date ]</a>
              <a href="thread.html#25145">[ thread ]</a>
              <a href="subject.html#25145">[ subject ]</a>
              <a href="author.html#25145">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Jan 19, 2013 at 11:47 PM, Ray Pekowski &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pekowski at gmail.com</A>&gt; wrote:

&gt;<i> Some possible things that could make the results lower than you would
</I>&gt;<i> expect are:
</I>&gt;<i> 1) All machines are virtual machines, including the RabbitMQ servers.
</I>&gt;<i> Virtualization typically costs around 40%.
</I>&gt;<i> 2) All VMs were only assigned 2 CPUs.  The CPUs are Intel Xeon E5620 @ 2.4
</I>&gt;<i> GHz.
</I>&gt;<i>
</I>&gt;<i> I forgot to mention some other possible reasons:
</I>
3) OpenStack RPC implementation over AMQP (RabbitMQ and Qpid) sends two
messages for each reply.  This means there are three messages sent per RPC,
one for the request and two for the reply.

The effective rate in terms of RabbitMQ message/sec for the cluster of
three RabbitMQ servers and mirroring enabled and the OpenStack patch to use
a single queue per process for the reply is 812 X 3 ~= 2400 msg/sec, which
might still be considered low but perhaps the 2 CPU VMs per RabbitMQ server
is the biggest reason for this.

4) The OpenStack RPC producers re-declare the queues and exchanges upon
which they send messages.  I say re-declare, because under normal
circumstances in the OpenStack implementation, the consumers exist before
the producers and so have already declared/created the exchanges and
queues.  I think this is done in case an RPC call is made to a service that
isn't up at the time.  I wonder that is a good practice, but I may be
missing some other reason for it.  I might play around with prototyping a
removal of the producer side re-declares.

Ray
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130123/311ccf9d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130123/311ccf9d/attachment.htm</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025094.html">[rabbitmq-discuss] RabbitMQ scaling with OpenStack
</A></li>
	<LI>Next message: <A HREF="025156.html">[rabbitmq-discuss] RabbitMQ scaling with OpenStack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25145">[ date ]</a>
              <a href="thread.html#25145">[ thread ]</a>
              <a href="subject.html#25145">[ subject ]</a>
              <a href="author.html#25145">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
