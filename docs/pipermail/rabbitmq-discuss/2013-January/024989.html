<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] two factor authentication with tokens
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20two%20factor%20authentication%20with%20tokens&In-Reply-To=%3C50F7DE8A.3050400%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024931.html">
   <LINK REL="Next"  HREF="024999.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] two factor authentication with tokens</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20two%20factor%20authentication%20with%20tokens&In-Reply-To=%3C50F7DE8A.3050400%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] two factor authentication with tokens">simon at rabbitmq.com
       </A><BR>
    <I>Thu Jan 17 11:20:42 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024931.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
        <LI>Next message: <A HREF="024999.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24989">[ date ]</a>
              <a href="thread.html#24989">[ thread ]</a>
              <a href="subject.html#24989">[ subject ]</a>
              <a href="author.html#24989">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes, but that shouldn't be too problematic - while all our auth 
mechanisms invoke rabbit_access_control:check_user_pass_login/2 or 
similar (which ends up looking up and driving auth backends), you could 
write an auth mechanism which either drives an auth backend directly, or 
contains its own auth backend. Then it can do whatever it wants - the 
contract of an auth mechanism is to reject login or provide a user.

Cheers, Simon

On 15/01/13 10:31, Ben Hood wrote:
&gt;<i> Thinking about this a little further, what I am proposing with encoding
</I>&gt;<i> a vhost based challenge in the SASL mechanism would then make the
</I>&gt;<i> subsequent vhost authorization liable to be hi-jacked by a client that
</I>&gt;<i> declares itself in the SASL challenge to want to access the low security
</I>&gt;<i> (non-2FA vhost) and only supply 1FA, but then in the ConnectionOpen
</I>&gt;<i> frame it could freely request to access the 2FA vhost.
</I>&gt;<i>
</I>&gt;<i> So maybe this conditional execution is not so cool from a security
</I>&gt;<i> perspective, unless you somehow patch the whole handshake to prevent the
</I>&gt;<i> vhost from being forged.
</I>&gt;<i>
</I>&gt;<i> On Tuesday, 15 January 2013 at 09:33, Ben Hood wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> In addition to the previous questions, is it possible to configure the
</I>&gt;&gt;<i> auth challenge on the broker side to be vhost specific? For example,
</I>&gt;&gt;<i> clients connecting to vhost 1 should be taken down the aforementioned
</I>&gt;&gt;<i> LDAP + Radius path, but clients connecting to vhost 2 can just be
</I>&gt;&gt;<i> authenticated with a plain LDAP lookup.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Or does the SASL handshake occur before the client presents the target
</I>&gt;&gt;<i> vhost to the broker - in which case I presume you would have to
</I>&gt;&gt;<i> encapsulate this information into the custom SASL mechanism and
</I>&gt;&gt;<i> evaluate it selectively in the custom auth plugin that wraps Radius
</I>&gt;&gt;<i> and LDAP (as discussed previously)?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Friday, 11 January 2013 at 18:02, Jerry Kuch wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Fri, Jan 11, 2013 at 9:47 AM, Ben Hood &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A>
</I>&gt;&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Can this also be made to work in conjunction with an LDAP provider,
</I>&gt;&gt;&gt;&gt;<i> i.e. by chaining the supported LDAP backend with a custom backend to
</I>&gt;&gt;&gt;&gt;<i> additionally validate the the token? I wondering whether you can
</I>&gt;&gt;&gt;&gt;<i> require the client to answer both a username/password challenge
</I>&gt;&gt;&gt;&gt;<i> (evaluated by the supported LDAP auth backend) as well as having the
</I>&gt;&gt;&gt;&gt;<i> token checked by the the custom backend? Does the protocol and
</I>&gt;&gt;&gt;&gt;<i> wiring flow allow for the LDAP backend to get re-used in this way or
</I>&gt;&gt;&gt;&gt;<i> would you need to implement the custom backend that wraps the lookup
</I>&gt;&gt;&gt;&gt;<i> against the LDAP directory and the lookup against the Radius server?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If I recall correctly, one backend or the other would have to know
</I>&gt;&gt;&gt;<i> about the other one and take care of the chaining rather than
</I>&gt;&gt;&gt;<i> something like this being possible in the Rabbit configuration.  The
</I>&gt;&gt;&gt;<i> backend chosen to go with a given connection is basically the first
</I>&gt;&gt;&gt;<i> one in the rabbitmq.config file's list of backends that succeeds as
</I>&gt;&gt;&gt;<i> they're tried in order, and is bound irrevocably to that session
</I>&gt;&gt;&gt;<i> thereafter.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Pursuing this outcome you might be able to call into specific parts
</I>&gt;&gt;&gt;<i> of the LDAP backend as helpers, but a good hunk of your hybrid auth
</I>&gt;&gt;&gt;<i> logic would be in your plugin itself.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024931.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
	<LI>Next message: <A HREF="024999.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24989">[ date ]</a>
              <a href="thread.html#24989">[ thread ]</a>
              <a href="subject.html#24989">[ subject ]</a>
              <a href="author.html#24989">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
