<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20cluster%20with%20potentially%20millions%0A%09of%20connections&In-Reply-To=%3CCABHYwy866TWdOYQMjBq4K7FuN6iS6%3D19inNs9s%3DSE%2BPvj3JO9Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025198.html">
   <LINK REL="Next"  HREF="025244.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections</H1>
    <B>Romanas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20cluster%20with%20potentially%20millions%0A%09of%20connections&In-Reply-To=%3CCABHYwy866TWdOYQMjBq4K7FuN6iS6%3D19inNs9s%3DSE%2BPvj3JO9Q%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections">romanass at gmail.com
       </A><BR>
    <I>Mon Jan 28 20:42:50 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025198.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions of connections
</A></li>
        <LI>Next message: <A HREF="025244.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25204">[ date ]</a>
              <a href="thread.html#25204">[ thread ]</a>
              <a href="subject.html#25204">[ subject ]</a>
              <a href="author.html#25204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Simon,


&gt;<i> I think Matthias meant to disable management altogether. Elsewhere you
</I>&gt;<i> mentioned that the management overview page was very slow; this is a known
</I>&gt;<i> issue with large numbers of queues / connections (which we are working on)
</I>&gt;<i> so don't take that as evidence of the cluster grinding to a halt. And
</I>&gt;<i> management does have some per-object overheads of its own; it would be good
</I>&gt;<i> to eliminate them.
</I>&gt;<i>
</I>
I'll try disabling management altogether and see what happens then - I'll
post my results. Although if you do that, it gets annoyingly difficult to
see what's going on.


&gt;<i> So what goes wrong when you start this many connections? (and queues - I
</I>&gt;<i> assume you still have one queue per connection?) Do you run out of memory,
</I>&gt;<i> does CPU reach 100%? &quot;rabbitmqctl status&quot; can tell you more about where
</I>&gt;<i> memory is going.
</I>&gt;<i>
</I>
Both CPU and RAM seem to be increasing at a stable pace and are nowhere
near the limits. At some point one node decides to lock up (=no new
connections), then another, then another... It would look very much like
running out of file handles / sockets, but those are nowhere near the
limits as well (30k out of 100k limit for open sockets) and there's nothing
in the logs. I'll do some more tests and try to play around with logging to
get some more out of this, maybe it's AWS imposing some secret limits.


Regards,
Roman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130128/5752b966/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130128/5752b966/attachment.htm</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025198.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions of connections
</A></li>
	<LI>Next message: <A HREF="025244.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25204">[ date ]</a>
              <a href="thread.html#25204">[ thread ]</a>
              <a href="subject.html#25204">[ subject ]</a>
              <a href="author.html#25204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
