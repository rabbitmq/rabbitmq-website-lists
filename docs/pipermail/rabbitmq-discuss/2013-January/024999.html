<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] two factor authentication with tokens
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20two%20factor%20authentication%20with%20tokens&In-Reply-To=%3CB533B714551F42F1BB731B72FFADAB48%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024989.html">
   <LINK REL="Next"  HREF="025006.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] two factor authentication with tokens</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20two%20factor%20authentication%20with%20tokens&In-Reply-To=%3CB533B714551F42F1BB731B72FFADAB48%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] two factor authentication with tokens">0x6e6562 at gmail.com
       </A><BR>
    <I>Thu Jan 17 13:17:13 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024989.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
        <LI>Next message: <A HREF="025006.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24999">[ date ]</a>
              <a href="thread.html#24999">[ thread ]</a>
              <a href="subject.html#24999">[ subject ]</a>
              <a href="author.html#24999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Simon, 


On Thursday, 17 January 2013 at 11:20, Simon MacMullen wrote:

&gt;<i> Yes, but that shouldn't be too problematic - while all our auth 
</I>&gt;<i> mechanisms invoke rabbit_access_control:check_user_pass_login/2 or 
</I>&gt;<i> similar (which ends up looking up and driving auth backends), you could 
</I>&gt;<i> write an auth mechanism which either drives an auth backend directly, or 
</I>&gt;<i> contains its own auth backend. Then it can do whatever it wants - the 
</I>&gt;<i> contract of an auth mechanism is to reject login or provide a user.
</I>

Since I posted a number of times into this thread, I'm not sure which question you are answering here. My latest question was about the fact that I could encode the
username;
password;
vhost;
(optional) radius token, depending on whether the specified vhost is subject to a extra token verification or not;

into the SASL payload and my custom rabbit_auth_mechanism would decode this, and decide based on the vhost supplied whether to perform a lookup on the token. All of this is up to this custom implementation.

What I don't understand about your observation may stem from my misunderstanding the flow of the handshake during AMQP connection establishment. I was assuming that due to the sequence of AMQP frames defined in the protocol, Rabbit would initially delegate the authentication to my custom rabbit_auth_mechanism, which could present vhost X. Once this callback has successfully done everything it needs to do and returns a user back to Rabbit, then the client would be able to send a connection.open frame. At this point, the client could potentially encode vhost Y into that frame, and hence effectively by-pass the logic of the custom rabbit_auth_mechanism.

Maybe I'm missing the point here.

Having said all of this, in the meantime I've come up with an alternative solution - just run separate Rabbit instances for each vhost.

Cheers,

Ben




-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130117/32f00bf1/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130117/32f00bf1/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024989.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
	<LI>Next message: <A HREF="025006.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24999">[ date ]</a>
              <a href="thread.html#24999">[ thread ]</a>
              <a href="subject.html#24999">[ subject ]</a>
              <a href="author.html#24999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
