<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Performance Issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Performance%20Issue&In-Reply-To=%3C50F48A5C.3040100%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024922.html">
   <LINK REL="Next"  HREF="024924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Performance Issue</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Performance%20Issue&In-Reply-To=%3C50F48A5C.3040100%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Performance Issue">matthias at rabbitmq.com
       </A><BR>
    <I>Mon Jan 14 22:44:44 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024922.html">[rabbitmq-discuss] Performance Issue
</A></li>
        <LI>Next message: <A HREF="024924.html">[rabbitmq-discuss] Performance Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24923">[ date ]</a>
              <a href="thread.html#24923">[ thread ]</a>
              <a href="subject.html#24923">[ subject ]</a>
              <a href="author.html#24923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Pavel,

On 14/01/13 21:21, Pavel Kogan wrote:
&gt;<i> I have a rabbit server on single dedicated CentOS machine (Quad Core
</I>&gt;<i> with 16Gb RAM) connected to 1Gbit LAN.
</I>
What version of Erlang and Rabbit are you running? If it's not the 
latest of both then please upgrade.

&gt;<i> I have many queues running, but total number of messages is not very
</I>&gt;<i> high for such a machine.
</I>
What are all those queues doing? Are the completely idle or is there a 
trickle of messages flowing in/out/through them?

&gt;<i> The problem is following:
</I>&gt;<i> 1) I connect client A to some queue (with many many messages ready) with
</I>&gt;<i> some routing key - it processes 150 messages per sec (its limit).
</I>
What do you mean by &quot;connect... to some queue... with some routing key&quot;? 
Consuming from a queue does not involve a routing key.

&gt;<i> 2) I connect another client A in parallel on identical server to same
</I>&gt;<i> queue with same routing key. Now I have 2 identical consumers on same
</I>&gt;<i> queue and messages are distributed on round robin
</I>&gt;<i>      manner, but somehow second unit receives only 50 messages per sec.
</I>&gt;<i> 3) If I disconnect A1, A2 starts working normally. If I connect A1 back
</I>&gt;<i> it becomes a slow node.
</I>
As Alvaro said, check your basic.qos settings; if they are too low then 
throughput becomes bounded by network latency.

Also, check that there aren't any extraneous AMQP commands being issued 
by your client. e.g. it would be bad if, say, it (re)declared the queue 
every time it receives a message. You may want to connect through the 
tracer (<A HREF="http://www.rabbitmq.com/api-guide.html#tracer">http://www.rabbitmq.com/api-guide.html#tracer</A>) and examine the 
command stream.


Regards,

Matthias.
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024922.html">[rabbitmq-discuss] Performance Issue
</A></li>
	<LI>Next message: <A HREF="024924.html">[rabbitmq-discuss] Performance Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24923">[ date ]</a>
              <a href="thread.html#24923">[ thread ]</a>
              <a href="subject.html#24923">[ subject ]</a>
              <a href="author.html#24923">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
