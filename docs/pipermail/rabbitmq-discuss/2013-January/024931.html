<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] two factor authentication with tokens
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20two%20factor%20authentication%20with%20tokens&In-Reply-To=%3CF7BDE79D91E94E498C3C29F088B09A13%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024930.html">
   <LINK REL="Next"  HREF="024989.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] two factor authentication with tokens</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20two%20factor%20authentication%20with%20tokens&In-Reply-To=%3CF7BDE79D91E94E498C3C29F088B09A13%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] two factor authentication with tokens">0x6e6562 at gmail.com
       </A><BR>
    <I>Tue Jan 15 10:31:27 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024930.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
        <LI>Next message: <A HREF="024989.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24931">[ date ]</a>
              <a href="thread.html#24931">[ thread ]</a>
              <a href="subject.html#24931">[ subject ]</a>
              <a href="author.html#24931">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thinking about this a little further, what I am proposing with encoding a vhost based challenge in the SASL mechanism would then make the subsequent vhost authorization liable to be hi-jacked by a client that declares itself in the SASL challenge to want to access the low security (non-2FA vhost) and only supply 1FA, but then in the ConnectionOpen frame it could freely request to access the 2FA vhost. 

So maybe this conditional execution is not so cool from a security perspective, unless you somehow patch the whole handshake to prevent the vhost from being forged. 


On Tuesday, 15 January 2013 at 09:33, Ben Hood wrote:

&gt;<i> In addition to the previous questions, is it possible to configure the auth challenge on the broker side to be vhost specific? For example, clients connecting to vhost 1 should be taken down the aforementioned LDAP + Radius path, but clients connecting to vhost 2 can just be authenticated with a plain LDAP lookup. 
</I>&gt;<i> 
</I>&gt;<i> Or does the SASL handshake occur before the client presents the target vhost to the broker - in which case I presume you would have to encapsulate this information into the custom SASL mechanism and evaluate it selectively in the custom auth plugin that wraps Radius and LDAP (as discussed previously)? 
</I>&gt;<i> 
</I>&gt;<i> On Friday, 11 January 2013 at 18:02, Jerry Kuch wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On Fri, Jan 11, 2013 at 9:47 AM, Ben Hood &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A>)&gt; wrote:
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Can this also be made to work in conjunction with an LDAP provider, i.e. by chaining the supported LDAP backend with a custom backend to additionally validate the the token? I wondering whether you can require the client to answer both a username/password challenge (evaluated by the supported LDAP auth backend) as well as having the token checked by the the custom backend? Does the protocol and wiring flow allow for the LDAP backend to get re-used in this way or would you need to implement the custom backend that wraps the lookup against the LDAP directory and the lookup against the Radius server? 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If I recall correctly, one backend or the other would have to know about the other one and take care of the chaining rather than something like this being possible in the Rabbit configuration.  The backend chosen to go with a given connection is basically the first one in the rabbitmq.config file's list of backends that succeeds as they're tried in order, and is bound irrevocably to that session thereafter. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Pursuing this outcome you might be able to call into specific parts of the LDAP backend as helpers, but a good hunk of your hybrid auth logic would be in your plugin itself.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>)
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130115/d292c576/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130115/d292c576/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024930.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
	<LI>Next message: <A HREF="024989.html">[rabbitmq-discuss] two factor authentication with tokens
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24931">[ date ]</a>
              <a href="thread.html#24931">[ thread ]</a>
              <a href="subject.html#24931">[ subject ]</a>
              <a href="author.html#24931">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
