<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to handle poison messages (version	3.0.1)?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20handle%20poison%20messages%20%28version%0A%093.0.1%29%3F&In-Reply-To=%3CCAE0Sz%3Dy3D2A6Cew1bP%3D2m3esa3bboDBJrDsODFN7Z0nr9y%3D-cA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025019.html">
   <LINK REL="Next"  HREF="025021.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to handle poison messages (version	3.0.1)?</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20handle%20poison%20messages%20%28version%0A%093.0.1%29%3F&In-Reply-To=%3CCAE0Sz%3Dy3D2A6Cew1bP%3D2m3esa3bboDBJrDsODFN7Z0nr9y%3D-cA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] How to handle poison messages (version	3.0.1)?">jerryk at rbcon.com
       </A><BR>
    <I>Thu Jan 17 23:22:51 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025019.html">[rabbitmq-discuss] How to handle poison messages (version 3.0.1)?
</A></li>
        <LI>Next message: <A HREF="025021.html">[rabbitmq-discuss] How to handle poison messages (version	3.0.1)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25020">[ date ]</a>
              <a href="thread.html#25020">[ thread ]</a>
              <a href="subject.html#25020">[ subject ]</a>
              <a href="author.html#25020">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, Sandeep:

I'm using RabbitMQ version 3.0.1 and trying to handle the case with poison
&gt;<i> messages.
</I>&gt;<i>
</I>
I assume that by a &quot;poison message&quot; you mean a message that a consumer can
definitively determine is somehow bad and should never be considered for
processing again?


&gt;<i> In our code here, if there is a problem with processing the message, we
</I>&gt;<i> nack the message with redeliver flag set to true. However, this causes the
</I>&gt;<i> message to go back in the queue and in turn the consumer reads the same
</I>&gt;<i> message again (and again in a loop). This causes my consumer to crash or go
</I>&gt;<i> fishing in a loop.
</I>&gt;<i>
</I>
If we're using the same definition of poison message you could basic.reject
the message, specifying requeue=false.  This will cause Rabbit to dispose
of the message and not bother you with it again.


&gt;<i> I do have an option in mind - we can check for the redelivered flag to be
</I>&gt;<i> true and if its true more than 3 times for a given message, we can post
</I>&gt;<i> this message to a poison queue and ack it in the main queue. It's do-able
</I>&gt;<i> but I'm hoping there is some option directly from rabbitMQ. Thanks in
</I>&gt;<i> advance.
</I>&gt;<i>
</I>
Such a compromise solution seems only to make sense if the message itself
wasn't truly poisonous, but rather the consumer that dequeued it just
wasn't able to deal with it properly upon taking possession of it.  Of
course counting the number of times a given message has arrived with the
redelivered flag set to true would require you to coordinate this count
globally across all of your consumers if there were more than one and this
might be a hassle.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130117/5d8e177d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130117/5d8e177d/attachment.htm</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025019.html">[rabbitmq-discuss] How to handle poison messages (version 3.0.1)?
</A></li>
	<LI>Next message: <A HREF="025021.html">[rabbitmq-discuss] How to handle poison messages (version	3.0.1)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25020">[ date ]</a>
              <a href="thread.html#25020">[ thread ]</a>
              <a href="subject.html#25020">[ subject ]</a>
              <a href="author.html#25020">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
