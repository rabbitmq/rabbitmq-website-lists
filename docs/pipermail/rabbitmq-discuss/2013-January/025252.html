<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Performance Hit when using Federation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Performance%20Hit%20when%20using%20Federation&In-Reply-To=%3C51095F86.1030100%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025250.html">
   <LINK REL="Next"  HREF="025253.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Performance Hit when using Federation</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Performance%20Hit%20when%20using%20Federation&In-Reply-To=%3C51095F86.1030100%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Performance Hit when using Federation">simon at rabbitmq.com
       </A><BR>
    <I>Wed Jan 30 17:59:34 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025250.html">[rabbitmq-discuss] Performance Hit when using Federation
</A></li>
        <LI>Next message: <A HREF="025253.html">[rabbitmq-discuss] Performance Hit when using Federation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25252">[ date ]</a>
              <a href="thread.html#25252">[ thread ]</a>
              <a href="subject.html#25252">[ subject ]</a>
              <a href="author.html#25252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 30/01/13 17:26, Eric Cozzi wrote:
&gt;<i> Hello all,
</I>&gt;<i>
</I>&gt;<i> I am investigating RabbitMQ for a project where we would need to
</I>&gt;<i> federate multiple brokers. From my testing, I'm seeing acceptable
</I>&gt;<i> throughput results as long as the server and client are bot talking to
</I>&gt;<i> the same RabbitMQ server instance. However, as soon as I have the Server
</I>&gt;<i> and Client talking to different servers using a federated exchange, I'm
</I>&gt;<i> only seeing 1/4 of the throughput. Is this expected?
</I>
Well, federation does require that the message be published on the 
source broker, consumed and republished by the federation plugin and 
finally consumed for real. So I would expect 1/2 the throughput for a 
simple Producer -&gt; Broker A -&gt; Broker B -&gt; Consumer case.

Where federation *helps* throughput is when most of your messages can be 
local. Ultimately if every message has to go everywhere, you have a 
scaling problem anyway :-)

However, I wouldn't expect 1/4 the throughput... except that federation 
does transfer messages using confirms and acks. If your publishers and 
consumers are *not* using confirms / acks then they could go faster 
enough that the federation step in the middle would be that much more 
expensive. Does that sound like what might be happening?

And would anyone be interested in an optional mode for federation to 
disable confirms and acks, going faster at the expense of guaranteed 
delivery?

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025250.html">[rabbitmq-discuss] Performance Hit when using Federation
</A></li>
	<LI>Next message: <A HREF="025253.html">[rabbitmq-discuss] Performance Hit when using Federation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25252">[ date ]</a>
              <a href="thread.html#25252">[ thread ]</a>
              <a href="subject.html#25252">[ subject ]</a>
              <a href="author.html#25252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
