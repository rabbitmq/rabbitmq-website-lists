<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to use federation with clustering for	best HA-behaviour?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20use%20federation%20with%20clustering%20for%0A%09best%20HA-behaviour%3F&In-Reply-To=%3C29A5C876-61D1-4EC2-98EC-0158A8B5DCE9%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024991.html">
   <LINK REL="Next"  HREF="024968.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to use federation with clustering for	best HA-behaviour?</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20use%20federation%20with%20clustering%20for%0A%09best%20HA-behaviour%3F&In-Reply-To=%3C29A5C876-61D1-4EC2-98EC-0158A8B5DCE9%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] How to use federation with clustering for	best HA-behaviour?">tim at rabbitmq.com
       </A><BR>
    <I>Thu Jan 17 12:52:16 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="024991.html">[rabbitmq-discuss] How to use federation with clustering for best HA-behaviour?
</A></li>
        <LI>Next message: <A HREF="024968.html">[rabbitmq-discuss] Rabbitmq boot failure with &quot;tables_not_present&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24993">[ date ]</a>
              <a href="thread.html#24993">[ thread ]</a>
              <a href="subject.html#24993">[ subject ]</a>
              <a href="author.html#24993">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi  Adam
On 17 Jan 2013, at 12:39, Adam Aquilon wrote:
&gt;<i> In the federation plugin docs (<A HREF="http://www.rabbitmq.com/federation.html">http://www.rabbitmq.com/federation.html</A>)
</I>&gt;<i> it says:
</I>&gt;<i> 
</I>&gt;<i> &quot;ha-policy
</I>&gt;<i> Determines the &quot;x-ha-policy&quot; argument for the upstream queue (see expires). This is only of interest when connecting to old brokers which determine queue HA mode using this argument. Default is 'none', meaning the queue is not HA.&quot;
</I>&gt;<i> 
</I>&gt;<i> So what it says is not entirely true -- you also need it for &quot;federation
</I>&gt;<i> HA&quot; behaviour.
</I>&gt;<i> 
</I>
If I'm not mistaken then this won't work when the upstream broker is running a 3.x version. You'll need to enable x-ha-policy *on the broker* as passing this as a queue argument no longer works.  

&gt;<i> BTW, you wouldn't happen to have some tips on how to do upgrades without
</I>&gt;<i> downtime?
</I>&gt;<i> 
</I>&gt;<i> I've studied the documentation for clustered installations and it seems
</I>&gt;<i> you don't use the Erlang facilities for 'upgrading on the fly' and that
</I>&gt;<i> any upgrade *will* require downtime. (A problem for any company, but
</I>&gt;<i> especially for a large one...)
</I>&gt;<i> 
</I>
There isn't any support for this at the moment and I don't know of any plans to do so. A load balancer and warm standby using HA is probably the simplest way to deal with this.
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024991.html">[rabbitmq-discuss] How to use federation with clustering for best HA-behaviour?
</A></li>
	<LI>Next message: <A HREF="024968.html">[rabbitmq-discuss] Rabbitmq boot failure with &quot;tables_not_present&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24993">[ date ]</a>
              <a href="thread.html#24993">[ thread ]</a>
              <a href="subject.html#24993">[ subject ]</a>
              <a href="author.html#24993">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
