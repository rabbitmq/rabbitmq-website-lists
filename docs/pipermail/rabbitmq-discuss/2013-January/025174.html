<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ cluster with potentially millions of	connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20cluster%20with%20potentially%20millions%20of%0A%09connections&In-Reply-To=%3Cf75213a1-1571-415b-a5ba-e84c0d6bd0c9%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025170.html">
   <LINK REL="Next"  HREF="025176.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ cluster with potentially millions of	connections</H1>
    <B>Romanas S.</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20cluster%20with%20potentially%20millions%20of%0A%09connections&In-Reply-To=%3Cf75213a1-1571-415b-a5ba-e84c0d6bd0c9%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ cluster with potentially millions of	connections">romanass at gmail.com
       </A><BR>
    <I>Sat Jan 26 11:58:36 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025170.html">[rabbitmq-discuss] How to debug queue memory leak
</A></li>
        <LI>Next message: <A HREF="025176.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25174">[ date ]</a>
              <a href="thread.html#25174">[ thread ]</a>
              <a href="subject.html#25174">[ subject ]</a>
              <a href="author.html#25174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys,
 I'm trying to come up with an architecture for a RabbitMQ cluster that 
could potentially handle millions of (persistent) connections. I've set up 
a cluster of Rabbits with 3 nodes (16GB RAM, 4x cpu cores each) and a Load 
Balancer in front of them, increased all of the system limits on sockets 
and file descriptors, but can't seem to scale to more then 30k connections 
on the entire cluster. 

Each connections has it's own exchange and a temporary direct queue, RAM 
usage is about 2-3GB on each node and CPU usage peaks at about 200% (which 
on 4 cores isn't all that bad). At first all is quite well and the cluster 
manages upwards of 1k msgs/second (I haven't tried more, pretty sure it 
would handle it). However, after scaling to that many connections, the 
cluster seems to grind to a halt and eventually nodes become unresponsive. 
The management API takes upwards of 5 (FIVE!) minutes to retrieve a server 
summary report. Am I missing something here? Or is this just a bad idea 
altogether? I was expecting that if each node was able to handle 30k+ 
connections, I could have a cluster of 50 or so (with multiple balancers, 
of course!) and live a happy life  ;-)

Thanks,
Roman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130126/f278a7d7/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130126/f278a7d7/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025170.html">[rabbitmq-discuss] How to debug queue memory leak
</A></li>
	<LI>Next message: <A HREF="025176.html">[rabbitmq-discuss] RabbitMQ cluster with potentially millions	of connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25174">[ date ]</a>
              <a href="thread.html#25174">[ thread ]</a>
              <a href="subject.html#25174">[ subject ]</a>
              <a href="author.html#25174">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
