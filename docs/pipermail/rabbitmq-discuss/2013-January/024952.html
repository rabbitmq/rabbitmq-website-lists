<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rate limiting queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rate%20limiting%20queues&In-Reply-To=%3Cd1391582-a98d-4073-8804-8cb8014b0878%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025171.html">
   <LINK REL="Next"  HREF="024954.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rate limiting queues</H1>
    <B>Pedro Werneck</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rate%20limiting%20queues&In-Reply-To=%3Cd1391582-a98d-4073-8804-8cb8014b0878%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Rate limiting queues">pjwerneck at gmail.com
       </A><BR>
    <I>Wed Jan 16 00:36:50 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025171.html">[rabbitmq-discuss] Securing Messages Over WAN Link
</A></li>
        <LI>Next message: <A HREF="024954.html">[rabbitmq-discuss] Rate limiting queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24952">[ date ]</a>
              <a href="thread.html#24952">[ thread ]</a>
              <a href="subject.html#24952">[ subject ]</a>
              <a href="author.html#24952">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm running RabbitMQ 3.0.1 with celery 3.0.11 for a stack of applications 
based on the Python framework Flask, with a demand for a dozen million 
messages a day.

The problem is, some queues have to be rate limited dynamically during the 
day. We had a lot of problems with rate limiting the workers, using the 
rate_limit provided by celery and other client side solutions, and decided 
to look for some limiting on the deliver rate by the broker itself. I 
searched a lot and couldn't find anything like that, which surprised me, 
nor a reason why something like that isn't implemented. I found a plugin 
that implements throttling between the exchange and the queue, but I'm not 
sure how reliable it is. 
<A HREF="https://github.com/flopezluis/rabbitmq-throttling-exchange">https://github.com/flopezluis/rabbitmq-throttling-exchange</A>

I'm not familiar with Erlang and the RabbitMQ internals, so we adopted an 
ugly hackish solution for now, which is to have an input queue, an output 
queue, and a background process using a token bucket algorithm and amqp to 
get the messages from the input queue and send them back to the exchange 
and the output queue with the given rate. It isn't pretty, but is working 
reliably and we know everything that's going on.

Is there any reliable solution I missed? If not, is there any way to 
improve this solution we adopted?


Thanks for any help


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130115/c571a610/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130115/c571a610/attachment.htm</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025171.html">[rabbitmq-discuss] Securing Messages Over WAN Link
</A></li>
	<LI>Next message: <A HREF="024954.html">[rabbitmq-discuss] Rate limiting queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24952">[ date ]</a>
              <a href="thread.html#24952">[ thread ]</a>
              <a href="subject.html#24952">[ subject ]</a>
              <a href="author.html#24952">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
