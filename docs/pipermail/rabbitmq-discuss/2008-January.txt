From 0x6e6562 at gmail.com  Sun Jan  6 23:29:28 2008
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Sun, 6 Jan 2008 23:29:28 +0000
Subject: [rabbitmq-discuss] AMQP client for flex/flash
In-Reply-To: <F2891857-3F28-4FA9-83DB-AC492D0C6415@gmail.com>
References: <cdbebedf0712130625g79412672kc7a8711e082729b4@mail.gmail.com>
	<05593966-031B-4671-A87A-703916FD65E5@gmail.com>
	<167204d20712140047g3c5e91ffje75a563ceb874ead@mail.gmail.com>
	<F2891857-3F28-4FA9-83DB-AC492D0C6415@gmail.com>
Message-ID: <D087420E-1124-4431-AF15-8B22B547AFB6@gmail.com>

All,

On 17 Dec 2007, at 17:56, Ben Hood wrote:

>> I think a flex client would be of interest.  We especially like use
>> cases that make RabbitMQ more tangible to web developers and other
>> normal human beings, and web client or GUI tools are great for this
>
> Fine. I'll have to separate out the AMQP specific code and introduce  
> this as a binary dependency for that project, and then I can add  
> this to a repo (e.g. the mtn repo). This may take a week or two as I  
> am on holiday now and don't have any time to hack.

I've imported the AMQP specific code into an mtn repo called  
com.rabbitmq.as .

I've haven't done much extensive testing of the packaging and there is  
no build script as of yet, but this will gradually get done.

Although it is rough around the edges, it does actually work and I  
wanted to start getting the code out there as soon as possible to let  
any interested parties know.

Ben



From alexis.richardson at cohesiveft.com  Wed Jan  9 06:10:12 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Wed, 9 Jan 2008 06:10:12 +0000
Subject: [rabbitmq-discuss] article on integrating Java and Erlang
Message-ID: <167204d20801082210q5096f5f0t6b0545d40069f992@mail.gmail.com>

Happy New Year everyone :-)

The Serverside has just published an article on integrating Java and
Erlang, that may be of interest to RabbitMQ folks:

http://www.theserverside.com/tt/articles/article.tss?l=IntegratingJavaandErlang

alexis


-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From JWatson at sis.tv  Thu Jan 10 12:57:29 2008
From: JWatson at sis.tv (John Watson)
Date: Thu, 10 Jan 2008 12:57:29 -0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
Message-ID: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>

If I (say) create durable exchanges and queues with the Channel
interface in the java API, how do I later list them?  (Presumably I
don't know my way about the API yet, but I couldn't find anything...)

 

John

 


*************************************************************
Satellite Information Services Limited Registered Office: 
17 Corsham Street London N1 6DR, Company No. 4243307

The information in this e-mail (which includes any files
transmitted with it) is confidential and is intended for the
addressee only. Unauthorised recipients are required to
maintain confidentiality.  If you have received this e-mail
in error please notify the sender immediately, destroy any
copies and delete it from your computer system. 
*************************************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080110/427c3f80/attachment.htm 

From matthias at lshift.net  Thu Jan 10 18:31:00 2008
From: matthias at lshift.net (Matthias Radestock)
Date: Thu, 10 Jan 2008 18:31:00 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>
Message-ID: <47866464.50503@lshift.net>

John,

John Watson wrote:
> If I (say) create durable exchanges and queues with the Channel 
> interface in the java API, how do I later list them?  (Presumably I 
> don't know my way about the API yet, but I couldn't find anything...)

There are no methods in the AMQP 0-8/9 protocol to retrieve lists of 
queues, exchanges etc. AFAIK there are plans to include this kind of 
functionality as part of management features in AMQP 0-11.

Do you need these lists for management and monitoring purposes or do you 
actually have an application that requires this?

Regards,

Matthias



From berlin.brown at gmail.com  Fri Jan 11 02:23:52 2008
From: berlin.brown at gmail.com (Berlin Brown)
Date: Thu, 10 Jan 2008 21:23:52 -0500
Subject: [rabbitmq-discuss] Ascii text for strings
Message-ID: <df27a55b0801101823r30bbf82fic012ab803b21201b@mail.gmail.com>

According to the amqp protocol, are ascii strings supported or for
most operations:

For example, in the Connection.start_ok AMQP operation:

You have to send the locale and the login properties (shortstr):

Must that data be sent as UTF-8 string?  The protocol spec seems to be
light detailing unicode support.  Or does it matter, can the server
detect the unicode type?

-- 
Berlin Brown
http://botspiritcompany.com/botlist/spring/help/about.html



From JWatson at sis.tv  Fri Jan 11 08:33:39 2008
From: JWatson at sis.tv (John Watson)
Date: Fri, 11 Jan 2008 08:33:39 -0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv> 
	<47866464.50503@lshift.net>
Message-ID: <85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>

Hi, Matthias

You wrote:
>Do you need these lists for management and monitoring purposes or do
you actually have an application that requires this?

I don't have a particular queuing application in mind.  I was trying to
work out what it would need to develop administration tools along the
same lines as those provided for MQ (for example the RUNMQSC command
line utility or the Websphere MQ Explorer Eclipse plugin). My experience
with MQ has been that the majority of programming effort goes in to its
administration, not into its actual use.

John


*************************************************************
Satellite Information Services Limited Registered Office: 
17 Corsham Street London N1 6DR, Company No. 4243307

The information in this e-mail (which includes any files
transmitted with it) is confidential and is intended for the
addressee only. Unauthorised recipients are required to
maintain confidentiality.  If you have received this e-mail
in error please notify the sender immediately, destroy any
copies and delete it from your computer system. 
*************************************************************




From 0x6e6562 at gmail.com  Fri Jan 11 08:55:06 2008
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Fri, 11 Jan 2008 08:55:06 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>
	<47866464.50503@lshift.net>
	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>
Message-ID: <3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>

John,

On 11 Jan 2008, at 08:33, John Watson wrote:
>
> I don't have a particular queuing application in mind.  I was trying  
> to
> work out what it would need to develop administration tools along the
> same lines as those provided for MQ (for example the RUNMQSC command
> line utility or the Websphere MQ Explorer Eclipse plugin). My  
> experience
> with MQ has been that the majority of programming effort goes in to  
> its
> administration, not into its actual use.

FWIW, I've written a rabbit_management module that exposes an internal  
server API via Hessian over AMQP, so all you need to do is to call a  
Java interface that exposes the same methods as the internal API.  
There is some client side glue that proxies this Java interface by an  
AMQP RPC handler, but this is transparent to the calling application.  
At the moment it only exposes the rabbit_access_module, so it does  
exactly what the rabbitmqctl script does, but it's been designed to  
expose an arbitrary module that is deployed in the server VM via AMQP  
in an SCA-style fashion.

I don't know if this is the kind of thing you are looking for, or  
whether you're after the existence of specific management API's in  
rabbit to perform specific tasks.

HTH,

Ben



From JWatson at sis.tv  Fri Jan 11 09:23:47 2008
From: JWatson at sis.tv (John Watson)
Date: Fri, 11 Jan 2008 09:23:47 -0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv><47866464.50503@lshift.net><85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>
	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>
Message-ID: <85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>

Ben,

You wrote:
> I don't know if this is the kind of thing you are looking for, or  
> whether you're after the existence of specific management API's in  
> rabbit to perform specific tasks.

This all looks very useful.  I would definitely have a need to
administer remotely, but my main concern at the moment is that some core
AMQP objects don't seem to be exposed by any administration interface at
all.

John 

*************************************************************
Satellite Information Services Limited Registered Office: 
17 Corsham Street London N1 6DR, Company No. 4243307

The information in this e-mail (which includes any files
transmitted with it) is confidential and is intended for the
addressee only. Unauthorised recipients are required to
maintain confidentiality.  If you have received this e-mail
in error please notify the sender immediately, destroy any
copies and delete it from your computer system. 
*************************************************************




From matthias at lshift.net  Fri Jan 11 09:32:01 2008
From: matthias at lshift.net (Matthias Radestock)
Date: Fri, 11 Jan 2008 09:32:01 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv><47866464.50503@lshift.net><85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>
	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>
Message-ID: <47873791.90401@lshift.net>

John,

John Watson wrote:

> This all looks very useful.  I would definitely have a need to
> administer remotely, but my main concern at the moment is that some core
> AMQP objects don't seem to be exposed by any administration interface at
> all.

The AMQP Working Group is well aware that this kind of functionality is 
important. As I mentioned earlier, admin/management interfaces are 
scheduled to appear in AMQP 0-11.

In the meantime, broker-specific approaches, such as the one proposed by 
Ben, provide a stop-gap solution.

Matthias.



From alexis.richardson at cohesiveft.com  Fri Jan 11 09:38:42 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Fri, 11 Jan 2008 09:38:42 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <47873791.90401@lshift.net>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>
	<47866464.50503@lshift.net>
	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>
	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>
	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>
	<47873791.90401@lshift.net>
Message-ID: <167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>

John,

On Jan 11, 2008 9:32 AM, Matthias Radestock <matthias at lshift.net> wrote:
>
> In the meantime, broker-specific approaches, such as the one proposed by
> Ben, provide a stop-gap solution.

To add to Matthias' point: the exploration of management requirements,
through actual use of tools such as Ben's, is a very good way to
understand what needs to be in 0-11.  Do please share use cases as you
come across them.

alexis



From tonyg at lshift.net  Fri Jan 11 09:55:25 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Fri, 11 Jan 2008 09:55:25 +0000
Subject: [rabbitmq-discuss] Ascii text for strings
In-Reply-To: <df27a55b0801101823r30bbf82fic012ab803b21201b@mail.gmail.com>
References: <df27a55b0801101823r30bbf82fic012ab803b21201b@mail.gmail.com>
Message-ID: <47873D0D.8070301@lshift.net>

Hi,

Berlin Brown wrote:
> According to the amqp protocol, are ascii strings supported or for
> most operations:

If your string contains only 7-bit ASCII characters, i.e. codepoints
less than 128, then a UTF-8 encoding of that string is the same byte
sequence as the raw ASCII encoding.

> For example, in the Connection.start_ok AMQP operation:
> You have to send the locale and the login properties (shortstr):

You can pretty much choose to send ASCII anytime UTF-8 is expected.

You will of course have to deal with potentially *receiving* byte
sequences encoding characters with codepoints greater than or equal to
128... but, depending on your application, this could be as simple as a
gentleman's agreement between all participants to avoid non-ASCII
codepoints...

> Must that data be sent as UTF-8 string?

It must. ?4.2.5.3 of AMQP 0-8 reads

"
AMQP strings are variable length and represented by an integer length
followed by zero or more octets of data. AMQP defines two string types:

    Short strings, stored as an 8-bit unsigned integer length followed
    by zero or more octets of data. Short strings can carry up to 255
    octets of UTF-8 data, but may not contain binary zero octets.

    Long strings, stored as a 32-bit unsigned integer length followed by
    zero or more octets of data. Long strings can contain any data.
"

> The protocol spec seems to be
> light detailing unicode support.

You're right about this. Generally, whenever longstr is used *as a
string*, the consensus among the current implementors seems to be to
assume UTF-8. In other places, of course, it's used as a chunk of binary
data, with no assumed encoding at all.

>  Or does it matter, can the server
> detect the unicode type?

It *could*, if certain restrictions were placed on the content, but in
practice, this is not done.

One way of doing it (probably best applicable to longstr, leaving
shortstr unambiguously restricted to UTF-8) would be to first assume
Unicode (because otherwise we're completely doomed), and examine the
bytes for the presence of a UTF-32, UTF-16 or UTF-8 BOM. If present,
these give a clear indication of the coding and endianness. If absent,
one could either heuristically guess the encoding based on the presence
and position of NULs (not recommended) or simply assume UTF-8.

Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From JWatson at sis.tv  Fri Jan 11 12:12:48 2008
From: JWatson at sis.tv (John Watson)
Date: Fri, 11 Jan 2008 12:12:48 -0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv> 
	<47866464.50503@lshift.net> 
	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv> 
	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com> 
	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv> 
	<47873791.90401@lshift.net> 
	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>
Message-ID: <85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>

Alexis,

You wrote:
> To add to Matthias' point: the exploration of management requirements,
> through actual use of tools such as Ben's is a very good way to
> understand what needs to be in 0-11.  Do please share use cases as you
> come across them.

I'll certainly do that.  But I think Ben was saying that his approach is
currently limited to what's exposed in rabbit_access_control so it shows
me nothing new as far as I can tell.  If you want requirements to add to
0-11 then I'd say that the three most important components seem to be
the exchange, queue and binding and these should be fully administrable
in order to allow for scripting, GUI tools etc. to manipulate them
fully.

John

*************************************************************
Satellite Information Services Limited Registered Office: 
17 Corsham Street London N1 6DR, Company No. 4243307

The information in this e-mail (which includes any files
transmitted with it) is confidential and is intended for the
addressee only. Unauthorised recipients are required to
maintain confidentiality.  If you have received this e-mail
in error please notify the sender immediately, destroy any
copies and delete it from your computer system. 
*************************************************************




From alexis.richardson at cohesiveft.com  Fri Jan 11 13:32:15 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Fri, 11 Jan 2008 13:32:15 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>
	<47866464.50503@lshift.net>
	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>
	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>
	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>
	<47873791.90401@lshift.net>
	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>
	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
Message-ID: <167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com>

John

On Jan 11, 2008 12:12 PM, John Watson <JWatson at sis.tv> wrote:
>
>  If you want requirements to add to
> 0-11 then I'd say that the three most important components seem to be
> the exchange, queue and binding and these should be fully administrable
> in order to allow for scripting, GUI tools etc. to manipulate them
> fully.

Thank-you.  Towards full administrability, other than obtaining a list
of live queues (.., exchanges, bindings), what would you expect to see
API-wise?

alexis



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From 0x6e6562 at gmail.com  Fri Jan 11 13:47:25 2008
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Fri, 11 Jan 2008 13:47:25 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <478772B4.4070407@lshift.net>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>	<47866464.50503@lshift.net>	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>	<47873791.90401@lshift.net>	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
	<6AB432F6-16BB-4D2A-89A7-1697555CA3F3@gmail.com>
	<478772B4.4070407@lshift.net>
Message-ID: <1881766A-A1AB-4109-BDDC-BC95C3E93012@gmail.com>

Thanks for picking that one Matthias.

John, please find my comments inline.

Ben

On 11 Jan 2008, at 13:44, Matthias Radestock wrote:

> Ben,
>
> I suspect you meant to send this to the discuss list rather than amq at lshift.net 
> .
>
> Matthias.
>
> Ben Hood wrote:
>> John,
>> On 11 Jan 2008, at 12:12, John Watson wrote:
>>> I'll certainly do that.  But I think Ben was saying that his  
>>> approach is
>>> currently limited to what's exposed in rabbit_access_control so it  
>>> shows
>>> me nothing new as far as I can tell.
>> The approach is only limited to rabbit_access_control by virtue of  
>> the fact that that's only rabbit module I've tested against.  
>> Essentially it is a generalized RPC over AMQP handling mechanism  
>> that on the server side takes a concrete Erlang module as a  
>> parameter to a handler instance. So presenting a further module via  
>> this mechanism is trivial:
>> Client ---> Java Interface ---> Dynamic Proxy --> Wire --> Queue -- 
>> > RPC Handler --> Erlang module
>> The only thing you have to add is
>> 1. The business module whose exported functions you wish to invoke
>> 2. A Java interface definition of those functions.
>> Everything else is generic.
>>> If you want requirements to add to
>>> 0-11 then I'd say that the three most important components seem to  
>>> be
>>> the exchange, queue and binding and these should be fully  
>>> administrable
>>> in order to allow for scripting, GUI tools etc. to manipulate them
>>> fully.
>> It sounds like you might to start with a wish list of functions you  
>> would like to be able to invoke, rather than exposing the kitchen  
>> sink unnecessarily.
>> HTH,
>> Ben
>




From JWatson at sis.tv  Fri Jan 11 14:13:21 2008
From: JWatson at sis.tv (John Watson)
Date: Fri, 11 Jan 2008 14:13:21 -0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv> 
	<47866464.50503@lshift.net> 
	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv> 
	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com> 
	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv> 
	<47873791.90401@lshift.net> 
	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com> 
	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv> 
	<167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com>
Message-ID: <85FA03E6BB6F0340B5A117013571A9B768485C@exchange3.ad.sis.tv>

Hi, Alex

When you say
> what would you expect to see API-wise?

I'm not completely sure: Ultimately I'm interested in setting up a
network of servers with a reasonably static topology that manage
point-to-point messaging, with store-and-forward in case of network
outages and with reasonably static message routing. I'd like to be able
to set this up in some declarative manner. So I suppose I'm mostly
interested in such attributes as exchange: type, durability, bindings:
routing keys, also access rights to the various components and
authentication of the connections between servers.

I'm very conscious that I seem to be talking at cross-purposes here -
I've been grappling with the problems of easing the administration
burden for our MQ network for the last couple of years and it's
colouring my approach to Rabbit.  I certainly didn't intend you to
expose the whole kitchen sink......

John

-----Original Message-----
From: alexis.richardson at gmail.com [mailto:alexis.richardson at gmail.com]
On Behalf Of Alexis Richardson
Sent: 11 January 2008 13:32
To: John Watson
Cc: Matthias Radestock; rabbitmq-discuss at lists.rabbitmq.com
Subject: Re: [rabbitmq-discuss] Administering Rabbit exchanges and
queues

John

On Jan 11, 2008 12:12 PM, John Watson <JWatson at sis.tv> wrote:
>
>  If you want requirements to add to
> 0-11 then I'd say that the three most important components seem to be
> the exchange, queue and binding and these should be fully
administrable
> in order to allow for scripting, GUI tools etc. to manipulate them
> fully.

Thank-you.  Towards full administrability, other than obtaining a list
of live queues (.., exchanges, bindings), what would you expect to see
API-wise?

alexis



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)

*************************************************************
Satellite Information Services Limited Registered Office: 
17 Corsham Street London N1 6DR, Company No. 4243307

The information in this e-mail (which includes any files
transmitted with it) is confidential and is intended for the
addressee only. Unauthorised recipients are required to
maintain confidentiality.  If you have received this e-mail
in error please notify the sender immediately, destroy any
copies and delete it from your computer system. 
*************************************************************




From cctrieloff at redhat.com  Fri Jan 11 14:44:12 2008
From: cctrieloff at redhat.com (Carl Trieloff)
Date: Fri, 11 Jan 2008 09:44:12 -0500
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>	<47866464.50503@lshift.net>	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>	<47873791.90401@lshift.net>	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
	<167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com>
Message-ID: <478780BC.6070901@redhat.com>

Alexis Richardson wrote:
> John
>
> On Jan 11, 2008 12:12 PM, John Watson <JWatson at sis.tv> wrote:
>   
>>  If you want requirements to add to
>> 0-11 then I'd say that the three most important components seem to be
>> the exchange, queue and binding and these should be fully administrable
>> in order to allow for scripting, GUI tools etc. to manipulate them
>> fully.
>>     
>
> Thank-you.  Towards full administrability, other than obtaining a list
> of live queues (.., exchanges, bindings), what would you expect to see
> API-wise?
>
> alexis
>
>
>
>   

You guys might be interested ... this is what has been done for Qpid. We 
asked if we could start from what OpenAMQ
had done, and then updated it to be able to also work with 0-10, use the 
AMQP type system, allow for sec to be
applied with out opening the content frame, etc... so it this the same 
type of mechanism. currently the type code are
just randomly assigned and will be updated to the spec once the exact 
mapping for both 0-8 & 0-10 are known

http://cwiki.apache.org/qpid/management-design-notes.html

Might be useful, Schema for command set is in svn.
Carl.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080111/037517de/attachment.htm 

From JWatson at sis.tv  Fri Jan 11 15:08:25 2008
From: JWatson at sis.tv (John Watson)
Date: Fri, 11 Jan 2008 15:08:25 -0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>	<47866464.50503@lshift.net>	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>	<47873791.90401@lshift.net>	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
	<167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com> 
	<478780BC.6070901@redhat.com>
Message-ID: <85FA03E6BB6F0340B5A117013571A9B768485F@exchange3.ad.sis.tv>

Carl,

> http://cwiki.apache.org/qpid/management-design-notes.html

 

The requirements here seem to me to cover the sort of thing I've been
groping my way towards.....  Thanks very much.

 

John


*************************************************************
Satellite Information Services Limited Registered Office: 
17 Corsham Street London N1 6DR, Company No. 4243307

The information in this e-mail (which includes any files
transmitted with it) is confidential and is intended for the
addressee only. Unauthorised recipients are required to
maintain confidentiality.  If you have received this e-mail
in error please notify the sender immediately, destroy any
copies and delete it from your computer system. 
*************************************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080111/47df5ef5/attachment.htm 

From cctrieloff at redhat.com  Fri Jan 11 15:16:56 2008
From: cctrieloff at redhat.com (Carl Trieloff)
Date: Fri, 11 Jan 2008 10:16:56 -0500
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <85FA03E6BB6F0340B5A117013571A9B768485F@exchange3.ad.sis.tv>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>	<47866464.50503@lshift.net>	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>	<47873791.90401@lshift.net>	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
	<167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com>
	<478780BC.6070901@redhat.com>
	<85FA03E6BB6F0340B5A117013571A9B768485F@exchange3.ad.sis.tv>
Message-ID: <47878868.9080206@redhat.com>


John,

Great, feel free to use it, and please send comment to us. It would be 
great to submit it or an update of
it to AMQP working group for 0-11 mgmt. If you want to see it in action, 
fire up the trunk c++ broker
and run the command line mgmt tool.

Carl.


John Watson wrote:
>
> Carl,
>
> > http://cwiki.apache.org/qpid/management-design-notes.html
>
>  
>
> The requirements here seem to me to cover the sort of thing I've been 
> groping my way towards.....  Thanks very much.
>
>  
>
> John
>
> *************************************************************
>
> Satellite Information Services Limited Registered Office:
>
> 17 Corsham Street London N1 6DR, Company No. 4243307
>
>  
>
> The information in this e-mail (which includes any files
>
> transmitted with it) is confidential and is intended for the
>
> addressee only. Unauthorised recipients are required to
>
> maintain confidentiality. If you have received this e-mail
>
> in error please notify the sender immediately, destroy any
>
> copies and delete it from your computer system.
>
> *************************************************************
>
>  
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080111/98a2a47c/attachment.htm 

From alexis.richardson at cohesiveft.com  Fri Jan 11 15:29:11 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Fri, 11 Jan 2008 15:29:11 +0000
Subject: [rabbitmq-discuss] interoperability
In-Reply-To: <a21e8c210801110721p331ba3d1jf3da6970206da9f1@mail.gmail.com>
References: <167204d20801110659n5039060cj86561cbb311c8eb8@mail.gmail.com>
	<a21e8c210801110721p331ba3d1jf3da6970206da9f1@mail.gmail.com>
Message-ID: <167204d20801110729i4e691c85je5d7bac36ff252a@mail.gmail.com>

Rupert

On Jan 11, 2008 3:21 PM, Rupert Smith <rupertlssmith at googlemail.com> wrote:
> Thanks Alexis,
>
> The numbers now make sense to me with all the details.

No worries, happy to help.


> One thing I am curious about... How well did RabbitMQ scale across the 16
> cores? In theory Erlang HIPE scheduler should scale well (and at no extra
> effort to the programmer too) did it live up to it?

It seems to scale pretty well and certainly without any effort on our parts.

>From my fading memory, we did about 45k AMQP messages (300 byte/msg),
per second per core for the first couple of cores then the rate drops
a little adding 30k per core thereafter.  But one month later we ran
the tests on faster cores which got better numbers and scaled a bit
better.

Bear in mind that this was only a first round of testing with Intel.
We had done similar testing on our own back in June.  In both cases we
did not have quite enough time to do everything we wanted to.  Perhaps
this is the way of all tests.

In other words - YMMV.

alexis



>
>
>
> On 11/01/2008, Alexis Richardson <alexis.richardson at cohesiveft.com> wrote:
> > Hello Qpid folks,
> >
> > I've noticed some traffic recently on interoperability and testing,
> > and relatedly on performance.  There appears to be a lot of confusion
> > on this point.
> >
> > 1.  We very much want to see seamless interoperabilty for all brokers
> > of any given spec.  This is good for AMQP.
> > 2.  This should include all Python tests if possible, unless clearly
> > marked otherwise for a good reason.
> > 3.  People will then be able to make like for like performance
> > comparisons, because tests will work with any broker on 'swap in and
> > out' basis.  This is also good for AMQP.
> >
> > On this last point (3) it is worth noting that writing
> > business-relevant tests is hard.  It's one thing to pipe millions of
> > one byte messages through a socket, and another to implement a real
> > use case.  We reported an OPRA case in December which has the merit of
> > being 'real world'.  Make of this what you will.  The case was written
> > up by Intel in a press release - they did the tests - you can see the
> > link below.
> >
> > Also included below are the full details of what these numbers mean,
> > as posted to the RabbitMQ mailing list verbatim.  Feel free to read
> > and comment here or on the RabbitMQ list.
> >
> > Make no mistake, brokers (like CPU) will get faster and faster
> > especially once this stuff is implemented in hardware.  For software
> > that is well written and can scale, the limiting factor is how many
> > messages you can process per core.  Provided AMQP implementations
> > interoperate to the standard, the only thing that customers will need
> > to do is to pick and choose which implementation suits their use case
> > the best, e.g. for reliability, scalability, ease of use, or raw
> > speed.
> >
> > Best wishes
> >
> > alexis
> >
> > RabbitMQ
> >
> >
> >
> > ---------- Forwarded message ----------
> > From: Alexis Richardson < alexis.richardson at cohesiveft.com>
> > Date: Dec 1, 2007 10:26 AM
> > Subject: rabbitmq performance
> > To: RabbitMQ Discuss <rabbitmq-discuss at lists.rabbitmq.com >
> >
> >
> > Hi everyone,
> >
> > Recently we did some load testing of RabbitMQ, working with Intel.
> > Their press release is reported here:
> >
> > http://www.intelfasterfs.com/trading/articles/071128-intellowlatency.aspx
> >
> > The use case was a simulated OPRA data feed using combination of:
> >
> > - Pantor FAST client (essentially a codec) combined with an AMQP
> > client written in C (yes we are hoping to get this into the community)
> > - RabbitMQ AMQP broker version 1.2 on the server
> >
> > Please don't read too much into the latency numbers here: the timed
> > path included two network hops as well as message processing at the
> > broker; also, somewhat annoyingly, the numbers are averaged over
> > multiple scenarios.  We wanted to look at throughput because OPRA
> > feeds are heading to 1 million ticks per second and it's a good load
> > testing case.
> >
> > We shall publish more info soon but the numbers are as follows:
> >
> > 1. Ingress of about 1.3 million OPRA messages per second
> > 2. Replicated out to four clients at once (unicast pub/sub not multicast)
> > 3. So simultaneously, egress of about 5 million OPRA messages per second
> >
> > The broker cluster was on one multicore box with 16 cores.  The network
> > was a full TCP/IP stack, and a standard 1GigE network (= the bottleneck).
> >
> > The set up was:
> >
> > 1 Client Box --> 1 Server Box --> 1 Client Box
> >
> > We used Intel's 16 core Caneland box for the server and the FAST/AMQP
> > client was delivered by Pantor, working with us.
> >
> > How come the numbers are so high?  Well, one reason is that we used
> > FAST, which is a codec.  Each OPRA message was FAST-compressed
> > and batched into a block or 'datagram' of 16 compressed OPRA messages.
> > This is gradually becoming normal practice in the world of market data
> > feeds because the loads are high and people do not have enough
> > bandwidth to cope.
> >
> > So in our test, each datagram contained 16 OPRA messages, and was
> > sent as one 256 byte AMQP message.
> >
> > So the throughput can also be seen as:
> >
> > 1. Ingress of 80,000 AMQP messages per second (256b per message)
> > 2. Replicated out to four clients at once (unicast pub/sub)
> > 3. So simultaneously, egress of 320,000 AMQP messages per second (256b
> > per message)
> >
> > I.e the real load is about 400,000 mps.
> >
> > There are several ways to get these numbers higher:
> >
> > - tune RabbitMQ for speed
> > - use multicast
> > - use Infiniband
> > - use faster cores
> >
> > We just did some more tests using Intel's 45nm cores which look
> > promising in this regard.
> >
> > The point is: for most use cases you can get good performance using
> > COTS hardware.  This means you can spend your valuable project
> > investment dollars on making the user experience better instead of
> > messing about with deep tech.
> >
> > We think scalability, stability and ease of use are more important than
> > raw speed.  If you try to run RabbitMQ and do not see what you
> > expect along any of these metrics, please let us know and we'll help you.
> >
> > alexis
> >
> > --
> > Alexis Richardson
> > +44 20 7617 7339 (UK)
> > +44 77 9865 2911 (cell)
> > +1 650 206 2517 (US)
> >
>
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From 0x6e6562 at gmail.com  Fri Jan 11 16:33:45 2008
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Fri, 11 Jan 2008 16:33:45 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <478788EF.7080805@lshift.net>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>	<47866464.50503@lshift.net>	<85FA03E6BB6F0340B5A117013571A9B768484D@exchange3.ad.sis.tv>	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>	<47873791.90401@lshift.net>	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
	<6AB432F6-16BB-4D2A-89A7-1697555CA3F3@gmail.com>
	<478788EF.7080805@lshift.net>
Message-ID: <F66905E0-0038-453B-A456-AA54792A57B9@gmail.com>

Tony,

On 11 Jan 2008, at 15:19, Tony Garnock-Jones wrote:

> Ben Hood wrote:
>> Essentially it
>> is a generalized RPC over AMQP handling mechanism that on the server
>> side takes a concrete Erlang module as a parameter to a handler
>> instance.
>
> That is a really cool design. I'm looking forward to playing with it.

Because it's still in an alpha stage at the moment I'd definitely be  
interested in some feedback.

Although I used Hessian as a serialization mechanism, it's not tied to  
it, rather you can specify what you like (e.g. JSON).

Ben



From alexis.richardson at cohesiveft.com  Fri Jan 11 18:49:28 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Fri, 11 Jan 2008 18:49:28 +0000
Subject: [rabbitmq-discuss] Administering Rabbit exchanges and queues
In-Reply-To: <47878868.9080206@redhat.com>
References: <85FA03E6BB6F0340B5A117013571A9B7684840@exchange3.ad.sis.tv>
	<3E39012D-6051-4993-89F7-0C569605FF6C@gmail.com>
	<85FA03E6BB6F0340B5A117013571A9B7684850@exchange3.ad.sis.tv>
	<47873791.90401@lshift.net>
	<167204d20801110138h6f736193q9ebcd79eb328dd12@mail.gmail.com>
	<85FA03E6BB6F0340B5A117013571A9B768485B@exchange3.ad.sis.tv>
	<167204d20801110532w13ecd441r5567fdb4dbd21dc9@mail.gmail.com>
	<478780BC.6070901@redhat.com>
	<85FA03E6BB6F0340B5A117013571A9B768485F@exchange3.ad.sis.tv>
	<47878868.9080206@redhat.com>
Message-ID: <167204d20801111049s20e72093k41f8fdb559dc43ee@mail.gmail.com>

Thanks Carl, that's actually quite helpful.

We should make sure our efforts to achieve interop continue.

alexis

On Jan 11, 2008 3:16 PM, Carl Trieloff <cctrieloff at redhat.com> wrote:
>
>
>  John,
>
>  Great, feel free to use it, and please send comment to us. It would be
> great to submit it or an update of
>  it to AMQP working group for 0-11 mgmt. If you want to see it in action,
> fire up the trunk c++ broker
>  and run the command line mgmt tool.
>
>  Carl.
>
>
>
>
>  John Watson wrote:
>
>
>
> Carl,
>
> > http://cwiki.apache.org/qpid/management-design-notes.html
>
>
>
> The requirements here seem to me to cover the sort of thing I've been
> groping my way towards?..  Thanks very much.
>
>
>
> John
>
> *************************************************************
>
> Satellite Information Services Limited Registered Office:
>
> 17 Corsham Street London N1 6DR, Company No. 4243307
>
>
>
>
>
> The information in this e-mail (which includes any files
>
> transmitted with it) is confidential and is intended for the
>
> addressee only. Unauthorised recipients are required to
>
> maintain confidentiality. If you have received this e-mail
>
> in error please notify the sender immediately, destroy any
>
> copies and delete it from your computer system.
>
> *************************************************************
>
>
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From stevej at gmail.com  Sat Jan 12 03:16:35 2008
From: stevej at gmail.com (Steve Jenson)
Date: Fri, 11 Jan 2008 19:16:35 -0800
Subject: [rabbitmq-discuss] confused about permissions.
Message-ID: <81d74c280801111916w9441502r1ff1c5a372b868a6@mail.gmail.com>

Hi Gang,

I have a user account called example and a virtual host called
example.com. I have a realm called /mail.

$ sbin/rabbitmqctl list_permissions example example.com
Listing permissions for user "example" in vhost "example.com" ...
/data: [passive,active,write,read]
/mail: [passive,active,write,read]

$ sbin/rabbitmqctl list_vhost_users example.com
Listing users for vhosts "example.com"...
guest
example
done.


When I connect (as user example with a vhost of example.com) to
rabbitmq using the Java API (via Scala), I run into an error:

val ticket = channel.accessRequest("/mail")

throws an Exception
Caused by: com.rabbitmq.client.ShutdownSignalException (channel error;
reason: {#method<channel.close>(reply code=403, reply
text=ACCESS_REFUSED, class id=30, method id=10),null,""})

rabbit.log shows:

=INFO REPORT==== 11-Jan-2008::19:11:00 ===
accepted TCP connection on 0.0.0.0:5672 from 127.0.0.1:55165

=INFO REPORT==== 11-Jan-2008::19:11:00 ===
Realm access refused: bad path; User <<"example">>, VHost
<<"example.com">>, Realm <<"/mail">>

=INFO REPORT==== 11-Jan-2008::19:11:00 ===
Sending exception: Channel 1, Reason {amqp,access_refused,'access.request'}

If I use accessRequest("/data"), everything woks fine. I know that
/data is built-in which makes me wonder what magic /data has that I
haven't applied to /mail.

This is with rabbitmq 1.2.0 on erlang r11b-5.

Best,
Steve Jenson



From matthias at lshift.net  Sun Jan 13 22:50:57 2008
From: matthias at lshift.net (Matthias Radestock)
Date: Sun, 13 Jan 2008 22:50:57 +0000
Subject: [rabbitmq-discuss] confused about permissions.
In-Reply-To: <81d74c280801111916w9441502r1ff1c5a372b868a6@mail.gmail.com>
References: <81d74c280801111916w9441502r1ff1c5a372b868a6@mail.gmail.com>
Message-ID: <478A95D1.3070604@lshift.net>

Steve,

Steve Jenson wrote:

> When I connect (as user example with a vhost of example.com) to
> rabbitmq using the Java API (via Scala), I run into an error:
> [...]
> rabbit.log shows:
> 
> =INFO REPORT==== 11-Jan-2008::19:11:00 ===
> accepted TCP connection on 0.0.0.0:5672 from 127.0.0.1:55165
> 
> =INFO REPORT==== 11-Jan-2008::19:11:00 ===
> Realm access refused: bad path; User <<"example">>, VHost
> <<"example.com">>, Realm <<"/mail">>

The AMQP 0-8 spec says
<quote>
     The realm name MUST start with either "/data" (for application
     resources) or "/admin" (for server administration resources).
     If the realm starts with any other path, the server MUST raise
     a connection exception with reply code 403 (access refused).
</quote>

So the error you are seeing is because your realm doesn't start with 
/data or /admin.


Matthias.



From 0x6e6562 at gmail.com  Mon Jan 14 22:51:57 2008
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Mon, 14 Jan 2008 22:51:57 +0000
Subject: [rabbitmq-discuss] Article introducing the Erlang AMQP client
Message-ID: <BA62DEA6-0F27-4BF2-BAA3-1603426600D7@gmail.com>

Hi,

I've written an article describing the usage of the Erlang AMQP client  
- http://hopper.squarespace.com/blog/2008/1/12/introducing-the-erlang-amqp-client.html

Ben



From codewalkerjoe at gmail.com  Tue Jan 15 15:02:43 2008
From: codewalkerjoe at gmail.com (joe lee)
Date: Tue, 15 Jan 2008 10:02:43 -0500
Subject: [rabbitmq-discuss] synchronized messages: through the queue and
	multiple consumers
Message-ID: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>

I have two producers that need to send synchronized message to a queue,
where 1 of 3 consumers will consume the message.  In this scenario, would
the producer who sent the message, waits for the status back from the
consumer, that consumed the message?  In synchronized messaging, would
producer and consumer talk directly to each other or the message put in
queue and consumer consume and reply back to the waiting producer?

thanks,
joe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080115/c1724ef8/attachment.htm 

From alexis.richardson at cohesiveft.com  Tue Jan 15 21:40:59 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Tue, 15 Jan 2008 21:40:59 +0000
Subject: [rabbitmq-discuss] Article introducing the Erlang AMQP client
In-Reply-To: <BA62DEA6-0F27-4BF2-BAA3-1603426600D7@gmail.com>
References: <BA62DEA6-0F27-4BF2-BAA3-1603426600D7@gmail.com>
Message-ID: <167204d20801151340l2ee529f0ta8b604cd4955a4f1@mail.gmail.com>

Ben

I have spent the last 11 hours or so trying to think of something
sensible to say about this, something specific, other than "wow, this
is just great and wonderful and fantastic".

I cannot think of anything.

Thanks for this, it is top stuff.

alexis



On Jan 14, 2008 10:51 PM, Ben Hood <0x6e6562 at gmail.com> wrote:
> Hi,
>
> I've written an article describing the usage of the Erlang AMQP client
> - http://hopper.squarespace.com/blog/2008/1/12/introducing-the-erlang-amqp-client.html
>
> Ben
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From tonyg at lshift.net  Thu Jan 17 12:03:50 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 17 Jan 2008 12:03:50 +0000
Subject: [rabbitmq-discuss] synchronized messages: through the queue and
 multiple consumers
In-Reply-To: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>
References: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>
Message-ID: <478F4426.20301@lshift.net>

Hi Joe,

joe lee wrote:
> I have two producers that need to send synchronized message to a queue,
> where 1 of 3 consumers will consume the message.  In this scenario,
> would the producer who sent the message, waits for the status back from
> the consumer, that consumed the message?

There's no provision for this kind of synchronisation embedded in AMQP,
but it's the kind of thing that's easy to construct on top of AMQP.

> In synchronized messaging,
> would producer and consumer talk directly to each other or the message
> put in queue and consumer consume and reply back to the waiting producer?

The latter - every communication is mediated by a queue.

One way you could get what I think you're after would be to have a setup
like the following diagram, where consumers get handed work items
round-robin from the queue, and each item has a queue name in the
"reply-to" field of the Basic Properties content header. When the
consumer finishes the job, it replies to the producer by inserting a
message in the reply queue found in the request, with the reply's
"correlation-id" field set equal to the "correlation-id" field of the
request. See, for example, classes RpcClient and RpcServer in the main
RabbitMQ java client library.


	Producer   -----------------------\
	    ^				   \
	    |	  		      	    \
	       	  			     |
       	Producer's			     |
       	reply				     |
       	queue				     v

	    ^				Service exchange
	    |
	    |
	    |				     |
	    |				     |
	    |				     v
	    |
	    | 			      Service queue
	    |
	    | 				     |
	    | 				     |
	    | 				     v
	    | 				     |
	    | 		              /------+------\
	    | 		             /       |	     \
	    | 		            |        |	      |
	    | 		            |        |	      |
	    |		            |        |	      |
	    |		            v  	     v 	      v
	    |
 	    |		 Consumers: 1        2        3
	    |
	     \ 					      |
	      \					      /
	       \--------------------------------------


Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From sustrik at imatix.com  Thu Jan 17 12:08:59 2008
From: sustrik at imatix.com (Martin Sustrik)
Date: Thu, 17 Jan 2008 13:08:59 +0100
Subject: [rabbitmq-discuss] synchronized messages: through the queue and
 multiple consumers
In-Reply-To: <478F4426.20301@lshift.net>
References: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>
	<478F4426.20301@lshift.net>
Message-ID: <478F455B.7010802@imatix.com>

Hi,

We have a detailed article about implementing this kind of stuff over 
AMQP here:

http://wiki.openamq.org/tutorial:soa

It's not RabbitMQ, but as both products use AMQP, the solution should be 
almost identical.

Martin

Tony Garnock-Jones wrote:
> Hi Joe,
>
> joe lee wrote:
>   
>> I have two producers that need to send synchronized message to a queue,
>> where 1 of 3 consumers will consume the message.  In this scenario,
>> would the producer who sent the message, waits for the status back from
>> the consumer, that consumed the message?
>>     
>
> There's no provision for this kind of synchronisation embedded in AMQP,
> but it's the kind of thing that's easy to construct on top of AMQP.
>
>   
>> In synchronized messaging,
>> would producer and consumer talk directly to each other or the message
>> put in queue and consumer consume and reply back to the waiting producer?
>>     
>
> The latter - every communication is mediated by a queue.
>
> One way you could get what I think you're after would be to have a setup
> like the following diagram, where consumers get handed work items
> round-robin from the queue, and each item has a queue name in the
> "reply-to" field of the Basic Properties content header. When the
> consumer finishes the job, it replies to the producer by inserting a
> message in the reply queue found in the request, with the reply's
> "correlation-id" field set equal to the "correlation-id" field of the
> request. See, for example, classes RpcClient and RpcServer in the main
> RabbitMQ java client library.
>
>
> 	Producer   -----------------------\
> 	    ^				   \
> 	    |	  		      	    \
> 	       	  			     |
>        	Producer's			     |
>        	reply				     |
>        	queue				     v
>
> 	    ^				Service exchange
> 	    |
> 	    |
> 	    |				     |
> 	    |				     |
> 	    |				     v
> 	    |
> 	    | 			      Service queue
> 	    |
> 	    | 				     |
> 	    | 				     |
> 	    | 				     v
> 	    | 				     |
> 	    | 		              /------+------\
> 	    | 		             /       |	     \
> 	    | 		            |        |	      |
> 	    | 		            |        |	      |
> 	    |		            |        |	      |
> 	    |		            v  	     v 	      v
> 	    |
>  	    |		 Consumers: 1        2        3
> 	    |
> 	     \ 					      |
> 	      \					      /
> 	       \--------------------------------------
>
>
> Regards,
>   Tony
>   




From tonyg at lshift.net  Thu Jan 17 12:12:46 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 17 Jan 2008 12:12:46 +0000
Subject: [rabbitmq-discuss] synchronized messages: through the queue and
 multiple consumers
In-Reply-To: <478F455B.7010802@imatix.com>
References: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>
	<478F4426.20301@lshift.net> <478F455B.7010802@imatix.com>
Message-ID: <478F463E.6080006@lshift.net>

Martin Sustrik wrote:
> Hi,
> We have a detailed article about implementing this kind of stuff over
> AMQP here:
> http://wiki.openamq.org/tutorial:soa

That's fantastic, Martin. Thank you!

Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From karel.alfonso at inventri.com  Thu Jan 17 23:56:50 2008
From: karel.alfonso at inventri.com (Karel Alfonso)
Date: Fri, 18 Jan 2008 10:56:50 +1100
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
Message-ID: <200801172356.m0HNuveg002435@galah.inventri.com>

Hi everyone,

 

 I'm planning to use RabbitMQ in a system that will process events in the
order of the thousands. I haven't found in RabbitMQ a mechanism to process
concurrently the messages received. Is there any suggestion or guideline I
could follow?

 

Thanks in advance, Regards,

 

Karel Alfonso

Tech Lead

Inventri

Level 4, 365 Little Collin St.

Melbourne, VIC 3000

 

Phone: 61 3 86760374

Mobile: 0402663985

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080118/835233a0/attachment.htm 

From karel.alfonso at inventri.com  Thu Jan 17 23:56:50 2008
From: karel.alfonso at inventri.com (Karel Alfonso)
Date: Fri, 18 Jan 2008 10:56:50 +1100
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
Message-ID: <200801172356.m0HNuveg002435@galah.inventri.com>

Hi everyone,

 

 I'm planning to use RabbitMQ in a system that will process events in the
order of the thousands. I haven't found in RabbitMQ a mechanism to process
concurrently the messages received. Is there any suggestion or guideline I
could follow?

 

Thanks in advance, Regards,

 

Karel Alfonso

Tech Lead

Inventri

Level 4, 365 Little Collin St.

Melbourne, VIC 3000

 

Phone: 61 3 86760374

Mobile: 0402663985

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080118/835233a0/attachment-0001.htm 

From matthias at lshift.net  Sun Jan 20 20:00:19 2008
From: matthias at lshift.net (Matthias Radestock)
Date: Sun, 20 Jan 2008 20:00:19 +0000
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <200801172356.m0HNuveg002435@galah.inventri.com>
References: <200801172356.m0HNuveg002435@galah.inventri.com>
Message-ID: <4793A853.1090305@lshift.net>

Karel,

Karel Alfonso wrote:

>  I?m planning to use RabbitMQ in a system that will process events in 
> the order of the thousands. I haven?t found in RabbitMQ a mechanism to 
> process concurrently the messages received. Is there any suggestion or 
> guideline I could follow?

It is certainly possible to perform high-volume concurrent event 
processing with RabbitMQ, but coming up with the best setup requires a 
better understanding of your specific requirements.

Can you elaborate on what you are trying to accomplish? How many event 
producers are there? How many event consumers are there? What routing do 
you need between them? What delivery guarantees do you require? What 
ordering guarantees do you require? What AMQP client libraries are you 
using (e.g. RabbitMQ's Java client, the Erlang client etc)?


Regards,

Matthias.



From tonyg at lshift.net  Mon Jan 21 12:32:26 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 21 Jan 2008 12:32:26 +0000
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <200801172356.m0HNuveg002435@galah.inventri.com>
References: <200801172356.m0HNuveg002435@galah.inventri.com>
Message-ID: <479490DA.1080700@lshift.net>

Hi Karel,

Karel Alfonso wrote:
> I haven?t found in RabbitMQ a mechanism to
> process concurrently the messages received. Is there any suggestion or
> guideline I could follow?

If you mean handing messages received on a consumer off to multiple
worker threads, one approach is to have multiple threads reading from a
single QueueingConsumer. Each thread would, at its heart, do something
like this:

    while (true) {
        QueueingConsumer.Delivery delivery = consumer.nextDelivery();
        // ... handle delivery ...
        synchronized (channel) {
            channel.basicAck(delivery.getEnvelope().getDeliveryTag(),
                             false);
        }
    }

QueueingConsumer uses java.util.concurrent.BlockingQueue internally, so
it is thread-safe. You still need to lock the channel object if you are
accessing it from multiple threads, though - the usual model is for a
single thread to have a single channel, so if they share one, they must
take scrupulous care to not step on each other's toes.

Another approach is to open a channel and a consumer for each thread.
That way, you avoid the locking headaches needed when sharing a channel
between threads, and each thread can manage its own resources. This
approach is also gives better control over the thread/process boundary,
so if at a later date you decide you need to have multiple JVMs, it'll
be easier to move a few worker threads at a time over to the other process.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From karel.alfonso at inventri.com  Mon Jan 21 23:35:27 2008
From: karel.alfonso at inventri.com (Karel Alfonso)
Date: Tue, 22 Jan 2008 10:35:27 +1100
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
Message-ID: <200801212335.m0LNZexr009191@galah.inventri.com>



Hi everyone,

  Thanks so much for your reply.

  I'm working on a system that requires to download via POP3 every X amount
of time, the email of potentially 10 000 users (each user can have their
POP3 account on the internet).

  There is a Java component in the system that is activated via a scheduled
task that sends 10 000 events (messages) to start the mail download via POP3
for each user.

  In Java we have the problems with the scalability using multithreading,
that is, I wished I could have 10 000 threads running at the same time on
the system. I'm also limited by the number of File descriptors the OS will
allow me to open at once and the number of threads per process, etc.

  I'm considering Erlang because of the scalability and concurrency
features. I know I can have thousands of Erlang process connected to POP3
accounts on the internet, provided I have enough file descriptors, without
doing many fancy stuff.

  When I came across RabbitMQ, I thought that was a good way to interface
Java with Erlang ... But first I wanted to know if I could process or
consume the messages on the Java side with an efficient thread pool, then in
a second phase, move the message consumption to Erlang.

  I hope that gives a better explanation of what I'm after. It might be the
case the RabbitMQ is not the right technology for what I'm trying to do. I
appreciate your time and suggestions

Regards,
 
Karel Alfonso
Tech Lead
Inventri
Level 4, 365 Little Collin St.
Melbourne, VIC 3000
 
Phone: 61 3 86760374
Mobile: 0402663985
-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net] 
Sent: Monday, 21 January 2008 7:00 AM
To: Karel Alfonso
Cc: rabbitmq-discuss at lists.rabbitmq.com
Subject: Re: [rabbitmq-discuss] Scalable multithreaded consumer

Karel,

Karel Alfonso wrote:

>  I'm planning to use RabbitMQ in a system that will process events in 
> the order of the thousands. I haven't found in RabbitMQ a mechanism to 
> process concurrently the messages received. Is there any suggestion or 
> guideline I could follow?

It is certainly possible to perform high-volume concurrent event 
processing with RabbitMQ, but coming up with the best setup requires a 
better understanding of your specific requirements.

Can you elaborate on what you are trying to accomplish? How many event 
producers are there? How many event consumers are there? What routing do 
you need between them? What delivery guarantees do you require? What 
ordering guarantees do you require? What AMQP client libraries are you 
using (e.g. RabbitMQ's Java client, the Erlang client etc)?


Regards,

Matthias.




From codewalkerjoe at gmail.com  Tue Jan 22 12:09:59 2008
From: codewalkerjoe at gmail.com (joe lee)
Date: Tue, 22 Jan 2008 07:09:59 -0500
Subject: [rabbitmq-discuss] synchronized messages: through the queue and
	multiple consumers
In-Reply-To: <478F455B.7010802@imatix.com>
References: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>
	<478F4426.20301@lshift.net> <478F455B.7010802@imatix.com>
Message-ID: <50ec7a2e0801220409q637e9d0dp168c46e80e011c02@mail.gmail.com>

Martin,

Qpid python or RabbitMQ java client compatible with OpenAMQ?  I must say, I
am impressed with the documentation.  Very nice.  I am downloading as of now
and will give it a try.

Thanks,
joe



On Jan 17, 2008 7:08 AM, Martin Sustrik <sustrik at imatix.com> wrote:

> Hi,
>
> We have a detailed article about implementing this kind of stuff over
> AMQP here:
>
> http://wiki.openamq.org/tutorial:soa
>
> It's not RabbitMQ, but as both products use AMQP, the solution should be
> almost identical.
>
> Martin
>
> Tony Garnock-Jones wrote:
> > Hi Joe,
> >
> > joe lee wrote:
> >
> >> I have two producers that need to send synchronized message to a queue,
> >> where 1 of 3 consumers will consume the message.  In this scenario,
> >> would the producer who sent the message, waits for the status back from
> >> the consumer, that consumed the message?
> >>
> >
> > There's no provision for this kind of synchronisation embedded in AMQP,
> > but it's the kind of thing that's easy to construct on top of AMQP.
> >
> >
> >> In synchronized messaging,
> >> would producer and consumer talk directly to each other or the message
> >> put in queue and consumer consume and reply back to the waiting
> producer?
> >>
> >
> > The latter - every communication is mediated by a queue.
> >
> > One way you could get what I think you're after would be to have a setup
> > like the following diagram, where consumers get handed work items
> > round-robin from the queue, and each item has a queue name in the
> > "reply-to" field of the Basic Properties content header. When the
> > consumer finishes the job, it replies to the producer by inserting a
> > message in the reply queue found in the request, with the reply's
> > "correlation-id" field set equal to the "correlation-id" field of the
> > request. See, for example, classes RpcClient and RpcServer in the main
> > RabbitMQ java client library.
> >
> >
> >       Producer   -----------------------\
> >           ^                              \
> >           |                               \
> >                                            |
> >               Producer's                           |
> >               reply                                |
> >               queue                                v
> >
> >           ^                           Service exchange
> >           |
> >           |
> >           |                                |
> >           |                                |
> >           |                                v
> >           |
> >           |                         Service queue
> >           |
> >           |                                |
> >           |                                |
> >           |                                v
> >           |                                |
> >           |                         /------+------\
> >           |                        /       |       \
> >           |                       |        |        |
> >           |                       |        |        |
> >           |                       |        |        |
> >           |                       v        v        v
> >           |
> >           |            Consumers: 1        2        3
> >           |
> >            \                                        |
> >             \                                       /
> >              \--------------------------------------
> >
> >
> > Regards,
> >   Tony
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080122/696abd33/attachment.htm 

From dgl at dgl.cx  Wed Jan 23 16:17:25 2008
From: dgl at dgl.cx (David Leadbeater)
Date: Wed, 23 Jan 2008 16:17:25 +0000
Subject: [rabbitmq-discuss] C or C++ client
Message-ID: <20080123161725.GA4218@dgl.cx>

I've seen various postings on the list about a C client. I've tried
using OpenAMQ however it just segfaults (using the amq_client test
program it ships with) which doesn't inspire confidence.

I wondered if anyone had success with using OpenAMQ? If not is there
any progress on releasing the C client mentioned in conjunction with
the performance testing?

David



From alexis.richardson at cohesiveft.com  Thu Jan 24 10:23:51 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Thu, 24 Jan 2008 10:23:51 +0000
Subject: [rabbitmq-discuss] C or C++ client
In-Reply-To: <20080123161725.GA4218@dgl.cx>
References: <20080123161725.GA4218@dgl.cx>
Message-ID: <167204d20801240223q6a5f58fgcb1d34419f7427aa@mail.gmail.com>

David

On Jan 23, 2008 4:17 PM, David Leadbeater <dgl at dgl.cx> wrote:
> I've seen various postings on the list about a C client. I've tried
> using OpenAMQ however it just segfaults (using the amq_client test
> program it ships with) which doesn't inspire confidence.
>
> I wondered if anyone had success with using OpenAMQ?

I'm sure one of the OpenAMQ guys can help you out.  Martin?

> If not is there
> any progress on releasing the C client mentioned in conjunction with
> the performance testing?

In a word no.  The client needs cleaning up to remove some non open
source code from it.

Let me look into this.

alexis




> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From sustrik at imatix.com  Thu Jan 24 18:36:56 2008
From: sustrik at imatix.com (Martin Sustrik)
Date: Thu, 24 Jan 2008 19:36:56 +0100
Subject: [rabbitmq-discuss] C or C++ client
In-Reply-To: <167204d20801240223q6a5f58fgcb1d34419f7427aa@mail.gmail.com>
References: <20080123161725.GA4218@dgl.cx>
	<167204d20801240223q6a5f58fgcb1d34419f7427aa@mail.gmail.com>
Message-ID: <4798DAC8.1090602@imatix.com>

Hi,
>> I've seen various postings on the list about a C client. I've tried
>> using OpenAMQ however it just segfaults (using the amq_client test
>> program it ships with) which doesn't inspire confidence.
>>
>> I wondered if anyone had success with using OpenAMQ?
>>     
>
> I'm sure one of the OpenAMQ guys can help you out.  Martin?
>   
The problem is that OpenAMQ and RabbitMQ support different versions of 
AMQP protocol (0.9 and 0.8 respectively) therefore they are not able to 
speak each to another. Of course, the client should report some 
meaningful error rather than segfaulting... However, OpenAMQ is being 
used for a more than a year in JPMorganChase bank, meaning that it had 
to pass the bank's internal ultra-paranoid testing process. That may 
inspire some confidence :)

Martin



From alexis.richardson at cohesiveft.com  Tue Jan 29 18:49:35 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Tue, 29 Jan 2008 12:49:35 -0600
Subject: [rabbitmq-discuss] .NET for AMQP
Message-ID: <167204d20801291049v3eb43e51v78ae3081093f1de9@mail.gmail.com>

To the RabbitMQ user community -

We are very pleased to announce the release of the RabbitMQ .NET
client library.  This is an ideal solution for SOA and integration,
including bridging between .NET and any other language that supports
AMQP.  As our recent work with Intel has shown, RabbitMQ exhibits
stable performance at scale and we believe this creates real value for
.NET.

The RabbitMQ .NET client is:

* an implementation of an AMQP client library for C# (and implicitly
for other .NET languages)
* a binding exposing AMQP services via Microsoft's Windows
Communication Foundation (WCF)

The client library implements AMQP specifications version:

* 0-8
* 0-8bis, which is 0-8 as modified by QPid for their M2 release
* 0-9, omitting sections of the specification marked "work in
progress", i.e. the Message content-class

A single binary copy of the library contains support for all three
protocol variants, and code can select a variant to use at runtime.

The library has been tested against:

* RabbitMQ 1.2.x (AMQP 0-8)
* QPid M2 (AMQP 0-8bis, 0-9 (in the M2.1 branch))
* OpenAMQ 1.2c4 (AMQP 0-9)

The library is open-source, and is dual-licensed under the Apache
License v2 and the Mozilla Public License v1.1.  Downloads and full
documentation are available from the RabbitMQ web site:
http://www.rabbitmq.com/dotnet.html

We welcome comments on the product and participation by the community.
 Please spread the word!

This product has been developed as a solution for customers with real
world needs.  We wish to thank those involved.

One of RabbitMQ's users recently said: "RabbitMQ is a pleasure to use
and it just works. Everyday, every time, every message."  I very much
hope that this new .NET library brings the same response from anyone
wishing to do business messaging in .NET.

alexis




-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From tonyg at lshift.net  Wed Jan 30 13:27:18 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Wed, 30 Jan 2008 13:27:18 +0000
Subject: [rabbitmq-discuss] I've been busy with the .NET client
Message-ID: <47A07B36.8050401@lshift.net>

Hi all,

Sorry if I've not been able to provide timely replies to your questions
here on the list. I've been pretty busy working on our new .NET/C#
RabbitMQ Client. I'll go through the backlog looking for messages I
might have missed, but if there's anything specific anyone wants to
bring to my attention, please feel free to mail me directly or post to
the list.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Wed Jan 30 13:31:04 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Wed, 30 Jan 2008 13:31:04 +0000
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <200801212335.m0LNZexr009191@galah.inventri.com>
References: <200801212335.m0LNZexr009191@galah.inventri.com>
Message-ID: <47A07C18.1010405@lshift.net>

Hi Karel,

Karel Alfonso wrote:
>   There is a Java component in the system that is activated via a scheduled
> task that sends 10 000 events (messages) to start the mail download via POP3
> for each user.

Each message is basically "please poll the POP3 mailbox for user XYZ", then?

> In Java [...] I wished I could have 10 000 threads running at the same time

Oh yes, wouldn't that be nice :-)

>   I'm considering Erlang because of the scalability and concurrency
> features. I know I can have thousands of Erlang process connected to POP3
> accounts on the internet, provided I have enough file descriptors, without
> doing many fancy stuff.

Absolutely. Because of the file-descriptor limit, you'd probably still
want some kind of queueing system in place, though. (Even if it was just
an ad-hoc one on the erlang side.)

>   When I came across RabbitMQ, I thought that was a good way to interface
> Java with Erlang ... But first I wanted to know if I could process or
> consume the messages on the Java side with an efficient thread pool, then in
> a second phase, move the message consumption to Erlang.

Yes, that is a sensible thing to do. A queue containing all the
poll-requests could have several consumers, in one or several JVMs,
consuming from it, making a simple load-balancing worker pool.

How are you getting on? If you're using RabbitMQ, and have any questions
or comments, we'd love to hear about it.

Thanks,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Wed Jan 30 13:36:27 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Wed, 30 Jan 2008 13:36:27 +0000
Subject: [rabbitmq-discuss] synchronized messages: through the queue and
 multiple consumers
In-Reply-To: <50ec7a2e0801220409q637e9d0dp168c46e80e011c02@mail.gmail.com>
References: <50ec7a2e0801150702k8b3685ah867e6758d66a919@mail.gmail.com>	
	<478F4426.20301@lshift.net> <478F455B.7010802@imatix.com>
	<50ec7a2e0801220409q637e9d0dp168c46e80e011c02@mail.gmail.com>
Message-ID: <47A07D5B.1080206@lshift.net>

Hi Joe,

Sorry for the delay in getting back to you. How are you getting on with
AMQP?

joe lee wrote:
> Qpid python or RabbitMQ java client compatible with OpenAMQ?  I must
> say, I am impressed with the documentation.  Very nice.  I am
> downloading as of now and will give it a try.

OpenAMQ speaks AMQP 0-9, where the RabbitMQ broker alas currently only
speaks AMQP 0-8, as does our Java client. The QPid python client
probably can be made to speak to OpenAMQ as well as RabbitMQ.

Our new .NET client, however, is runtime-switchable between 0-8 and 0-9
protocol variants, and we've used it successfully to talk to OpenAMQ
1.2c4 as well as RabbitMQ 1.2.x. Of course, using .NET may not be an
option for you.

(Aside: Mono's implementation is really pretty good. I found myself able
to "write once, run anywhere" AMQP programs using Mono or MS's CLR. The
code ran unmodified on Mac OS X 10.3.9, OS X 10.5, Debian Linux, and
Windows Server 2003...)

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From tonyg at lshift.net  Wed Jan 30 13:43:23 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Wed, 30 Jan 2008 13:43:23 +0000
Subject: [rabbitmq-discuss] File transfers
In-Reply-To: <cdbebedf0712270835k38e1f0ffm31ca897d818aeebb@mail.gmail.com>
References: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>	
	<4773C1A0.6090408@lshift.net>
	<cdbebedf0712270835k38e1f0ffm31ca897d818aeebb@mail.gmail.com>
Message-ID: <47A07EFB.1090104@lshift.net>

Hi David,

How did you get on with file transfers over AMQP? Did it work out, or
have you switched to something else?

David Pollak wrote:
> PS -- I'm currently implementing an encrypted session mechanism that
> does a handshake with authentication and all the subsequent messages are
> encrypted using the secret shared during the handshake.  It solves the
> "using Rabbit in the Wild" problem without SSL.  I should have some code
> posted in a few days.

This sounds very interesting! Are there any further details available?
Would support for this style of encryption be a useful addition to
RabbitMQ? Does it require cooperation from the broker, or is it a
decentralised, peer-to-peer style thing? (with Bob Frankston-style
innovation-at-the-edge)

Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From holger at wizards.de  Wed Jan 30 13:46:05 2008
From: holger at wizards.de (=?ISO-8859-1?Q?Holger_Hoffst=E4tte?=)
Date: Wed, 30 Jan 2008 14:46:05 +0100
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <47A07C18.1010405@lshift.net>
References: <200801212335.m0LNZexr009191@galah.inventri.com>
	<47A07C18.1010405@lshift.net>
Message-ID: <47A07F9D.9010401@wizards.de>

Tony Garnock-Jones wrote:
> Each message is basically "please poll the POP3 mailbox for user XYZ", then?
> 
>> In Java [...] I wished I could have 10 000 threads running at the same time
> 
> Oh yes, wouldn't that be nice :-)

Not to steal any Erlang steam here but those of you who need at least some 
kind of Actor-ish lightweight behaviour in their Java should check out the 
ForkJoin work going on in the jsr166y project 
(http://gee.cs.oswego.edu/dl/concurrency-interest/). Tim Peierls set up a 
Wiki at http://artisans-serverintellect-com.si-eioswww6.com/default.asp?W1 
which provides some overview and example code.

Holger
(ZOMG! I can't believe I'm advocating Java..)



From feeder.of.the.bears at gmail.com  Wed Jan 30 14:08:32 2008
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Wed, 30 Jan 2008 06:08:32 -0800
Subject: [rabbitmq-discuss] File transfers
In-Reply-To: <47A07EFB.1090104@lshift.net>
References: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>
	<4773C1A0.6090408@lshift.net>
	<cdbebedf0712270835k38e1f0ffm31ca897d818aeebb@mail.gmail.com>
	<47A07EFB.1090104@lshift.net>
Message-ID: <cdbebedf0801300608p54c8961cy867acfc76399342c@mail.gmail.com>

Tony,

A couple of things.

First, I've been thinking it's easier for me to use the HTTPS stuff in trunk
head and stunnel4 than to reimplement SSL handshaking in Rabbit.

Second, I've been sidetracked by an existing client and business development
opportunities so I've been unable to work on this project.

More as I have time.

Thanks,

David

On 1/30/08, Tony Garnock-Jones <tonyg at lshift.net> wrote:
>
> Hi David,
>
> How did you get on with file transfers over AMQP? Did it work out, or
> have you switched to something else?
>
> David Pollak wrote:
> > PS -- I'm currently implementing an encrypted session mechanism that
> > does a handshake with authentication and all the subsequent messages are
> > encrypted using the secret shared during the handshake.  It solves the
> > "using Rabbit in the Wild" problem without SSL.  I should have some code
> > posted in a few days.
>
> This sounds very interesting! Are there any further details available?
> Would support for this style of encryption be a useful addition to
> RabbitMQ? Does it require cooperation from the broker, or is it a
> decentralised, peer-to-peer style thing? (with Bob Frankston-style
> innovation-at-the-edge)
>
> Tony
> --
> [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>    [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
> []  [] http://www.lshift.net/ | Email: tonyg at lshift.net
>



-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080130/85b5e93d/attachment.htm 

From tonyg at lshift.net  Wed Jan 30 14:18:44 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Wed, 30 Jan 2008 14:18:44 +0000
Subject: [rabbitmq-discuss] File transfers
In-Reply-To: <cdbebedf0801300608p54c8961cy867acfc76399342c@mail.gmail.com>
References: <cdbebedf0712261714p4195215bla9c18684840e9dbd@mail.gmail.com>	
	<4773C1A0.6090408@lshift.net>	
	<cdbebedf0712270835k38e1f0ffm31ca897d818aeebb@mail.gmail.com>	
	<47A07EFB.1090104@lshift.net>
	<cdbebedf0801300608p54c8961cy867acfc76399342c@mail.gmail.com>
Message-ID: <47A08744.6010105@lshift.net>

Hi David,

Thanks for the update. Yes, SSL is a good quick solution. For 0-11, the
AMQP group will be looking at encryption and authentication, so I'd be
interested to discuss your ideas in that context when you have time.

Regards,
  Tony


David Pollak wrote:
> Tony,
> 
> A couple of things.
> 
> First, I've been thinking it's easier for me to use the HTTPS stuff in
> trunk head and stunnel4 than to reimplement SSL handshaking in Rabbit.
> 
> Second, I've been sidetracked by an existing client and business
> development opportunities so I've been unable to work on this project.
> 
> More as I have time.
> 
> Thanks,
> 
> David
> 
> On 1/30/08, *Tony Garnock-Jones* <tonyg at lshift.net
> <mailto:tonyg at lshift.net>> wrote:
> 
>     Hi David,
> 
>     How did you get on with file transfers over AMQP? Did it work out, or
>     have you switched to something else?
> 
>     David Pollak wrote:
>     > PS -- I'm currently implementing an encrypted session mechanism that
>     > does a handshake with authentication and all the subsequent
>     messages are
>     > encrypted using the secret shared during the handshake.  It solves the
>     > "using Rabbit in the Wild" problem without SSL.  I should have
>     some code
>     > posted in a few days.
> 
>     This sounds very interesting! Are there any further details available?
>     Would support for this style of encryption be a useful addition to
>     RabbitMQ? Does it require cooperation from the broker, or is it a
>     decentralised, peer-to-peer style thing? (with Bob Frankston-style
>     innovation-at-the-edge)
> 
>     Tony
>     --
>     [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>        [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
>     []  [] http://www.lshift.net/ | Email: tonyg at lshift.net
>     <mailto:tonyg at lshift.net>
> 
> 
> 
> 
> -- 
> lift, the secure, simple, powerful web framework http://liftweb.net
> Collaborative Task Management http://much4.us


-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From feeder.of.the.bears at gmail.com  Wed Jan 30 14:26:29 2008
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Wed, 30 Jan 2008 06:26:29 -0800
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <47A07F9D.9010401@wizards.de>
References: <200801212335.m0LNZexr009191@galah.inventri.com>
	<47A07C18.1010405@lshift.net> <47A07F9D.9010401@wizards.de>
Message-ID: <cdbebedf0801300626q3fc8571by5b8c7f72972be6c6@mail.gmail.com>

On 1/30/08, Holger Hoffst?tte <holger at wizards.de> wrote:
>
> Tony Garnock-Jones wrote:
> > Each message is basically "please poll the POP3 mailbox for user XYZ",
> then?
> >
> >> In Java [...] I wished I could have 10 000 threads running at the same
> time
> >
> > Oh yes, wouldn't that be nice :-)
>
> Not to steal any Erlang steam here but those of you who need at least some
> kind of Actor-ish lightweight behaviour in their Java should check out the
> ForkJoin work going on in the jsr166y project
> (http://gee.cs.oswego.edu/dl/concurrency-interest/). Tim Peierls set up a
> Wiki at http://artisans-serverintellect-com.si-eioswww6.com/default.asp?W1
> which provides some overview and example code.
>
> Holger
> (ZOMG! I can't believe I'm advocating Java..)


Or you could look at Scala (http://scala-lang.org ) which has Erlang-style
Actors built right in.

_______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080130/c18f5b2a/attachment.htm 

From matthew at lshift.net  Wed Jan 30 16:01:32 2008
From: matthew at lshift.net (Matthew Sackman)
Date: Wed, 30 Jan 2008 16:01:32 +0000
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <cdbebedf0801300626q3fc8571by5b8c7f72972be6c6@mail.gmail.com>
References: <200801212335.m0LNZexr009191@galah.inventri.com>
	<47A07C18.1010405@lshift.net> <47A07F9D.9010401@wizards.de>
	<cdbebedf0801300626q3fc8571by5b8c7f72972be6c6@mail.gmail.com>
Message-ID: <20080130160132.GA3405@arkansas.doc.ic.ac.uk>

On Wed, Jan 30, 2008 at 06:26:29AM -0800, David Pollak wrote:
> Or you could look at Scala (http://scala-lang.org ) which has Erlang-style
> Actors built right in.

Yes, are they preempting yet?

Matthew



From ksalasko at gmail.com  Wed Jan 30 21:40:14 2008
From: ksalasko at gmail.com (kyles)
Date: Wed, 30 Jan 2008 13:40:14 -0800 (PST)
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <47547A2B.5040007@barryp.org>
References: <47547A2B.5040007@barryp.org>
Message-ID: <15192757.post@talk.nabble.com>


Hi Barry,


Barry Pederson wrote:
> 
> I've seen a few Python users on this list, so I thought I'd mention that 
> I've been working on a Python AMQP client library as an alternative to 
> Qpid, and have a Mercurial repository and initial tarball available at:
> 
>    http://barryp.org/software/py-amqplib/
> 
> The library is a bit rough, but I've been using it with RabbitMQ for a 
> while now.
> 

I've been unable to get the amqplib client working when I'm running 2 or
more nodes in a RabbitMQ cluster. Using a single node (local or remote)
works fine. The error I'm getting is:

Traceback (most recent call last):
  File "demo_send.py", line 56, in <module>
    main()
  File "demo_send.py", line 41, in main
    conn = amqp.Connection(options.host, userid=options.userid,
password=options.password, ssl=options.ssl)
  File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
180, in __init__
    self.close()
  File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
420, in close
    (10, 61),    # Connection.close_ok
  File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
356, in wait
    frame_type, payload = self._wait_channel(0)
  File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
298, in _wait_channel
    frame_type, frame_channel, payload = self._wait_frame()
  File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
273, in _wait_frame
    frame_type = self.input.read_octet()
  File "/usr/local/lib/python2.5/site-packages/amqplib/util_0_8.py", line
96, in read_octet
    return unpack('B', self.input.read(1))[0]
  File "/usr/local/lib/python2.5/struct.py", line 87, in unpack
    return o.unpack(s)
struct.error: unpack requires a string argument of length 1
Exception socket.error: (32, 'Broken pipe') in <bound method
Connection.__del__ of <amqplib.client_0_8.Connection object at 0xb7c7470c>>
ignored

Is this something you've seen before?

Thanks,
Kyle
-- 
View this message in context: http://www.nabble.com/Alternative-Python-AMQP-client-library-tp14139740p15192757.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From karel.alfonso at inventri.com  Wed Jan 30 21:55:29 2008
From: karel.alfonso at inventri.com (Karel Alfonso)
Date: Thu, 31 Jan 2008 08:55:29 +1100
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <47A07C18.1010405@lshift.net>
Message-ID: <200801302155.m0ULtSwi001155@galah.inventri.com>

Thanks Tony for your reply.

I have to say I decided to use ActiveMQ with clustered queue consumers where
each of them has a thread pool managed by Jencks, an MDB solution that
integrates nicely with ActiveMQ. 

I would have loved to have RabbitMQ and Erlang consumers but I have to wait
till we have Erlang client implemented in RabbitMQ, then we can move away
from consuming messages in Java.

In my solution each message means "poll the pop3 account of user XYZ for new
mails", that's right. So this is a solution where I need thousands of
clients/consumers to poll a POP3 account for a specific user.

I looked into an Erlang solution without RabbitMQ, but I don't think
enterprise APIs in Erlang are as mature and proven as those for Java. For
example, the POP3 client in Erlang, epop, dates back since 1998, and we
don't have yet a JavaMail-like package in Erlang, so, things become more
difficult.

Scala offeres the Acto model as well, but using the threading capability
offered by Java.

For the moment I'll use ActiveMQ with clustered consumers, in the future
I'll move the implementation to use RabbitMQ with Erlang consumers.

Thanks for your support,

  Cheers,

  Karel


-----Original Message-----
From: Tony Garnock-Jones [mailto:tonyg at lshift.net] 
Sent: Thursday, 31 January 2008 12:31 AM
To: Karel Alfonso
Cc: rabbitmq-discuss at lists.rabbitmq.com
Subject: Re: [rabbitmq-discuss] Scalable multithreaded consumer

Hi Karel,

Karel Alfonso wrote:
>   There is a Java component in the system that is activated via a
scheduled
> task that sends 10 000 events (messages) to start the mail download via
POP3
> for each user.

Each message is basically "please poll the POP3 mailbox for user XYZ", then?

> In Java [...] I wished I could have 10 000 threads running at the same
time

Oh yes, wouldn't that be nice :-)

>   I'm considering Erlang because of the scalability and concurrency
> features. I know I can have thousands of Erlang process connected to POP3
> accounts on the internet, provided I have enough file descriptors, without
> doing many fancy stuff.

Absolutely. Because of the file-descriptor limit, you'd probably still
want some kind of queueing system in place, though. (Even if it was just
an ad-hoc one on the erlang side.)

>   When I came across RabbitMQ, I thought that was a good way to interface
> Java with Erlang ... But first I wanted to know if I could process or
> consume the messages on the Java side with an efficient thread pool, then
in
> a second phase, move the message consumption to Erlang.

Yes, that is a sensible thing to do. A queue containing all the
poll-requests could have several consumers, in one or several JVMs,
consuming from it, making a simple load-balancing worker pool.

How are you getting on? If you're using RabbitMQ, and have any questions
or comments, we'd love to hear about it.

Thanks,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net




From bp at barryp.org  Thu Jan 31 00:37:47 2008
From: bp at barryp.org (Barry Pederson)
Date: Wed, 30 Jan 2008 18:37:47 -0600
Subject: [rabbitmq-discuss] Alternative Python AMQP client library
In-Reply-To: <15192757.post@talk.nabble.com>
References: <47547A2B.5040007@barryp.org> <15192757.post@talk.nabble.com>
Message-ID: <47A1185B.2040109@barryp.org>

kyles wrote:
> Hi Barry,
> 
> 
> Barry Pederson wrote:
>> I've seen a few Python users on this list, so I thought I'd mention that 
>> I've been working on a Python AMQP client library as an alternative to 
>> Qpid, and have a Mercurial repository and initial tarball available at:
>>
>>    http://barryp.org/software/py-amqplib/
>>
>> The library is a bit rough, but I've been using it with RabbitMQ for a 
>> while now.
>>
> 
> I've been unable to get the amqplib client working when I'm running 2 or
> more nodes in a RabbitMQ cluster. Using a single node (local or remote)
> works fine. The error I'm getting is:
> 
> Traceback (most recent call last):
>   File "demo_send.py", line 56, in <module>
>     main()
>   File "demo_send.py", line 41, in main
>     conn = amqp.Connection(options.host, userid=options.userid,
> password=options.password, ssl=options.ssl)
>   File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
> 180, in __init__
>     self.close()
>   File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
> 420, in close
>     (10, 61),    # Connection.close_ok
>   File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
> 356, in wait
>     frame_type, payload = self._wait_channel(0)
>   File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
> 298, in _wait_channel
>     frame_type, frame_channel, payload = self._wait_frame()
>   File "/usr/local/lib/python2.5/site-packages/amqplib/client_0_8.py", line
> 273, in _wait_frame
>     frame_type = self.input.read_octet()
>   File "/usr/local/lib/python2.5/site-packages/amqplib/util_0_8.py", line
> 96, in read_octet
>     return unpack('B', self.input.read(1))[0]
>   File "/usr/local/lib/python2.5/struct.py", line 87, in unpack
>     return o.unpack(s)
> struct.error: unpack requires a string argument of length 1
> Exception socket.error: (32, 'Broken pipe') in <bound method
> Connection.__del__ of <amqplib.client_0_8.Connection object at 0xb7c7470c>>
> ignored
> 
> Is this something you've seen before?
> 
> Thanks,
> Kyle

Sorry, I haven't had a multi-node RabbitMQ setup to try anything like
that particular setup, so haven't seen that particular error.

It looks like the node you're connecting to is maybe trying to redirect
you to the other node, and then closing the socket without waiting for
the client to send a "close" message and then responding with "close-ok".

(Does the server initiate the exchange of "close"/"close-ok" messages
after a redirect?  It wasn't clear to me from the specs.)

Anyhow, an easy workaround would be to wrap the call to self.close() in
line 180 of amqplib/client_0_8.py in a try/except block - so try
changing this:

--------
             # we were redirected, close the socket, loop and try again
             self.close()
--------

to this:

---------
             # we were redirected, close the socket, loop and try again
             try:
                 self.close()
             except:
                 pass
---------

that might do the trick.

	Barry





From 0x6e6562 at gmail.com  Thu Jan 31 06:36:20 2008
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Thu, 31 Jan 2008 06:36:20 +0000
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <200801302155.m0ULtSwi001155@galah.inventri.com>
References: <200801302155.m0ULtSwi001155@galah.inventri.com>
Message-ID: <C4891D60-39CB-4A66-BAEE-36A92C271FD9@gmail.com>

Karel,

On 30 Jan 2008, at 21:55, Karel Alfonso wrote:
>
> I would have loved to have RabbitMQ and Erlang consumers but I have  
> to wait
> till we have Erlang client implemented in RabbitMQ, then we can move  
> away
> from consuming messages in Java.

Were you looking for an AMQP client for Erlang?

Ben



From alexis.richardson at cohesiveft.com  Thu Jan 31 14:54:31 2008
From: alexis.richardson at cohesiveft.com (Alexis Richardson)
Date: Thu, 31 Jan 2008 08:54:31 -0600
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <C4891D60-39CB-4A66-BAEE-36A92C271FD9@gmail.com>
References: <200801302155.m0ULtSwi001155@galah.inventri.com>
	<C4891D60-39CB-4A66-BAEE-36A92C271FD9@gmail.com>
Message-ID: <167204d20801310654t526de266x57c95cbfe83fee45@mail.gmail.com>

Karel,

If you look at the bottom of the downloads page
(http://www.rabbitmq.com/download.html) you will see an Erlang client
which works with RabbitMQ.  Do please give that a go, if that is
indeed what you needed.  I hope you will then find RabbitMQ's
clustering features to be adequate with respect to your needs.

It would be great to hear more about how you are getting on with your
use case involving both email and messaging.  We have seen similar
cases, unfortunately still 'off list' which we hope to be able to
share with the community.

alexis


On Jan 31, 2008 12:36 AM, Ben Hood <0x6e6562 at gmail.com> wrote:
> Karel,
>
> On 30 Jan 2008, at 21:55, Karel Alfonso wrote:
> >
> > I would have loved to have RabbitMQ and Erlang consumers but I have
> > to wait
> > till we have Erlang client implemented in RabbitMQ, then we can move
> > away
> > from consuming messages in Java.
>
> Were you looking for an AMQP client for Erlang?
>
> Ben
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)



From tonyg at lshift.net  Thu Jan 31 15:11:30 2008
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 31 Jan 2008 15:11:30 +0000
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <200801302155.m0ULtSwi001155@galah.inventri.com>
References: <200801302155.m0ULtSwi001155@galah.inventri.com>
Message-ID: <47A1E522.8020100@lshift.net>

Hi Karel,

Karel Alfonso wrote:
> In my solution each message means "poll the pop3 account of user XYZ for new
> mails", that's right. So this is a solution where I need thousands of
> clients/consumers to poll a POP3 account for a specific user.

RabbitMQ's Java library and Erlang broker should have no trouble with
that kind of solution - unless there was some showstopper you've found
that I haven't thought of?

Can you tell us more about the surrounding environment - for instance,
is Spring an important part of your total application?

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From feeder.of.the.bears at gmail.com  Thu Jan 31 15:59:44 2008
From: feeder.of.the.bears at gmail.com (David Pollak)
Date: Thu, 31 Jan 2008 07:59:44 -0800
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <47A1E522.8020100@lshift.net>
References: <200801302155.m0ULtSwi001155@galah.inventri.com>
	<47A1E522.8020100@lshift.net>
Message-ID: <cdbebedf0801310759t6d372fdcm8631185752006f07@mail.gmail.com>

And FWIW, you might want to look at Scala.  You can use the Java RabbitMQ
libraries, but Scala has Actors that can handle the actual POP stuff... it's
kinda the best of both worlds.



On 1/31/08, Tony Garnock-Jones <tonyg at lshift.net> wrote:
>
> Hi Karel,
>
> Karel Alfonso wrote:
> > In my solution each message means "poll the pop3 account of user XYZ for
> new
> > mails", that's right. So this is a solution where I need thousands of
> > clients/consumers to poll a POP3 account for a specific user.
>
> RabbitMQ's Java library and Erlang broker should have no trouble with
> that kind of solution - unless there was some showstopper you've found
> that I haven't thought of?
>
> Can you tell us more about the surrounding environment - for instance,
> is Spring an important part of your total application?
>
> Regards,
>   Tony
> --
> [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
>    [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
> []  [] http://www.lshift.net/ | Email: tonyg at lshift.net
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



-- 
lift, the secure, simple, powerful web framework http://liftweb.net
Collaborative Task Management http://much4.us
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080131/fb089114/attachment.htm 

From karel.alfonso at inventri.com  Thu Jan 31 23:21:56 2008
From: karel.alfonso at inventri.com (Karel Alfonso)
Date: Fri, 1 Feb 2008 10:21:56 +1100
Subject: [rabbitmq-discuss] Scalable multithreaded consumer
In-Reply-To: <47A1E522.8020100@lshift.net>
Message-ID: <200801312322.m0VNLt3C029010@galah.inventri.com>

Hi everyone,

  First, thanks so much for the support and quick replies.

  The problem I have at hand is to "periodically poll the POP3 accounts of 5
thousand users or more and download the mails that match certain criteria".

  As the user base will increase in the future, I'm thinking of having a
clustered solution for scalability purpose.

  Right now I'm using ActiveMQ with clustered queue consumers. The master
distributes the messages in a round-robin manner to each of the consumers.
The consumers handle the message through Jencks, an MDB solution which has a
thread pool. To scale this architecture I have to add more consumer nodes
(with Jenck).

  I thought about Erlang cause in only one box I can have thousands of
processes running, provided that I have enough file descriptors in the OS.
Then if on top of that I can have a clustered solution with RabbitMQ, that
would be the perfect solution for me.

  Using RabbitMQ's Java libraries to consume the messages using a thread
pool does not offer any advantage to me, given that that is the solution I
have at the moment.

  The other question might be out of the subject of this list, but once you
have a RabbitMQ cluster, which technologies would you suggest to share the
file system amongst the cluster?

 Thanks in advance for all your help.

Regards,
 
Karel Alfonso
Tech Lead
Inventri
Level 4, 365 Little Collin St.
Melbourne, VIC 3000
 
Phone: 61 3 86760374
Mobile: 0402663985

-----Original Message-----
From: Tony Garnock-Jones [mailto:tonyg at lshift.net] 
Sent: Friday, 1 February 2008 2:12 AM
To: Karel Alfonso
Cc: rabbitmq-discuss at lists.rabbitmq.com
Subject: Re: [rabbitmq-discuss] Scalable multithreaded consumer

Hi Karel,

Karel Alfonso wrote:
> In my solution each message means "poll the pop3 account of user XYZ for
new
> mails", that's right. So this is a solution where I need thousands of
> clients/consumers to poll a POP3 account for a specific user.

RabbitMQ's Java library and Erlang broker should have no trouble with
that kind of solution - unless there was some showstopper you've found
that I haven't thought of?

Can you tell us more about the surrounding environment - for instance,
is Spring an important part of your total application?

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net




