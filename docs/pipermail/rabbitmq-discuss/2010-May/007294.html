<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] New persister (bug21673) crashed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20New%20persister%20%28bug21673%29%20crashed&In-Reply-To=20100418162850.GA23773%40wellquite.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007292.html">
   <LINK REL="Next"  HREF="007299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] New persister (bug21673) crashed</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20New%20persister%20%28bug21673%29%20crashed&In-Reply-To=20100418162850.GA23773%40wellquite.org"
       TITLE="[rabbitmq-discuss] New persister (bug21673) crashed">matthew at lshift.net
       </A><BR>
    <I>Sat May 15 21:22:54 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007292.html">[rabbitmq-discuss] Regarding latest Fedora 12 &amp; Fedora 13 Erlang	R13B-04 packaging bug (nteventlog missing)
</A></li>
        <LI>Next message: <A HREF="007299.html">[rabbitmq-discuss] RabbitMQ Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7294">[ date ]</a>
              <a href="thread.html#7294">[ thread ]</a>
              <a href="subject.html#7294">[ subject ]</a>
              <a href="author.html#7294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Apr 18, 2010 at 05:28:51PM +0100, Matthew Sackman wrote:
&gt;<i> On Sun, Apr 18, 2010 at 08:50:14AM -0700, Scott White wrote:
</I>&gt;<i> &gt; I am running the new persister and after running fine for several
</I>&gt;<i> &gt; weeks, it
</I>&gt;<i> &gt; crashed last night. Please see crash low below. I'm not sure how to
</I>&gt;<i> &gt; interpret this, any ideas what the problem might be?
</I>&gt;<i> 
</I>&gt;<i> Yes, it recovered more off disk than it was expecting to. I have no idea
</I>&gt;<i> how that could happen...[snipped]
</I>
I do now. During QA of the new persister this afternoon, Matthias
spotted a simple accountancy error in the queue index module. See the
commit comment for the gory details (3e0e01f3591e), but suffice to say,
this would be able to cause the crash that you reported.

The circumstances that would cause this are that Rabbit would have had
to have died suddenly (either crashed or be killed) during flushing of
the queue index journal (which is an internal operation which happens
from time to time), on a durable queue with persistent messages.

I have to say, I think this is excellent means of justification for the
extensive QA process that's been going on of the new persister. Of the
~7000 new lines of code that make up the new persister, we're down to
just two modules left to QA, with about 2500 lines in total to go. There
is most certainly light at the end of the tunnel - I know many of you
have been working off the new persister branch for a long time now and
yet more of you just waiting for us to release it. Much progress has
been made in the last month, and we really are getting there now.
Hopefully not too much longer!

Matthew

</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007292.html">[rabbitmq-discuss] Regarding latest Fedora 12 &amp; Fedora 13 Erlang	R13B-04 packaging bug (nteventlog missing)
</A></li>
	<LI>Next message: <A HREF="007299.html">[rabbitmq-discuss] RabbitMQ Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7294">[ date ]</a>
              <a href="thread.html#7294">[ thread ]</a>
              <a href="subject.html#7294">[ subject ]</a>
              <a href="author.html#7294">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
