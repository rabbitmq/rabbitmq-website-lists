<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] message/artifact chunking?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20message/artifact%20chunking%3F&In-Reply-To=AANLkTimBUSCeO-_x_V_VQ2efwtaKKYWQ5PfjebzjjoK3%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007172.html">
   <LINK REL="Next"  HREF="007158.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] message/artifact chunking?</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20message/artifact%20chunking%3F&In-Reply-To=AANLkTimBUSCeO-_x_V_VQ2efwtaKKYWQ5PfjebzjjoK3%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] message/artifact chunking?">tonyg at lshift.net
       </A><BR>
    <I>Tue May 11 10:42:01 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007172.html">[rabbitmq-discuss] message/artifact chunking?
</A></li>
        <LI>Next message: <A HREF="007158.html">[rabbitmq-discuss] Haskell Client for RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7199">[ date ]</a>
              <a href="thread.html#7199">[ thread ]</a>
              <a href="subject.html#7199">[ subject ]</a>
              <a href="author.html#7199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Marek Majkowski wrote:
&gt;<i> Putting a large file over RabbitMQ obviously will work, but I'd say
</I>&gt;<i> it's a bad idea. It's just easier to put the big things to some
</I>&gt;<i> temporary storage, and transfer only light requests over message bus.
</I>
Furthermore, until the new persister lands, sending *really* big messages will
cause problems with memory exhaustion.

HTTP has all sorts of neat machinery for reliably transferring very large
payloads a piece at a time, resuming aborted transfers, and so on. It even has
a verb, DELETE, that can be pressed into service as a poor-man's
acknowledge-and-release-message signal (which can work especially nicely on a
server file system supporting hard links: give every potential receiver a
distinct URL to retrieve and delete, and you get a kind of automatic garbage
collection). I'd go with HTTP for transferring large chunks of data, and the
messaging system for carrying the URLs.

The problems with that system I can think of: 1. when is it safe to stop
serving a piece of information from the HTTP server? and 2. how do you get the
chunk up to the HTTP server in the first place? Not every client can run an
httpd, and HTTP sadly (!) lacks resumable PUT/POST.

To solve 1: If you know you have a single receiver, use DELETE. If you know you
have exactly n receivers, hardlink the file on the server a few times for
URL-uniqueness, and use DELETE. If you don't know the set of receivers, you're
in trouble, and a timeout is likely your only sensible option.

To solve 2: Either run an httpd on clients wishing to send Very Large Files
(with associated firewall and configuration headaches), or use ReverseHTTP to
be httpd-like without the firewall and configuration hassle, or put a CGI
script or similar on the server that supports a protocol you can use to
reliably upload files in a resumable fashion for later download by other clients.

Or yeah, if it's not going to kill your server, just send the big files as
large messages. Resumability of partial transfers goes out the window, of course.

Tony


</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007172.html">[rabbitmq-discuss] message/artifact chunking?
</A></li>
	<LI>Next message: <A HREF="007158.html">[rabbitmq-discuss] Haskell Client for RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7199">[ date ]</a>
              <a href="thread.html#7199">[ thread ]</a>
              <a href="subject.html#7199">[ subject ]</a>
              <a href="author.html#7199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
