<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Caching proxy for cloud HA
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Caching%20proxy%20for%20cloud%20HA&In-Reply-To=4BFB8BFB.8030808%40rabbitmq.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007381.html">
   <LINK REL="Next"  HREF="007389.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Caching proxy for cloud HA</H1>
    <B>Jon Brisbin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Caching%20proxy%20for%20cloud%20HA&In-Reply-To=4BFB8BFB.8030808%40rabbitmq.com"
       TITLE="[rabbitmq-discuss] Caching proxy for cloud HA">jon.brisbin at npcinternational.com
       </A><BR>
    <I>Tue May 25 14:29:40 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007381.html">[rabbitmq-discuss] Caching proxy for cloud HA
</A></li>
        <LI>Next message: <A HREF="007389.html">[rabbitmq-discuss] Caching proxy for cloud HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7382">[ date ]</a>
              <a href="thread.html#7382">[ thread ]</a>
              <a href="subject.html#7382">[ subject ]</a>
              <a href="author.html#7382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>response below...

On May 25, 2010, at 3:36 AM, Matthias Radestock wrote:

&gt;<i> Jon,
</I>&gt;<i> 
</I>&gt;<i> Jon Brisbin wrote:
</I>&gt;&gt;<i> I'm thinking I can also proxy my RabbitMQ servers for HA as well.
</I>&gt;&gt;<i> My proxies would be immediately responsive to changes in my cloud services, so servers will drop off and join the cloud at unknown intervals. I'm thinking I could have my RMQ clients connect to the HA
</I>&gt;&gt;<i> proxy, which load-balances requests to the configured back-end servers.
</I>&gt;<i> 
</I>&gt;<i> The proxy would have to operate with sticky sessions, since AMQP is a connection/session-oriented protocol, but other than that this should work.
</I>&gt;<i> 
</I>&gt;&gt;<i> I could easily introduce caching here because the proxy is
</I>&gt;&gt;<i> transparent.
</I>&gt;<i> 
</I>&gt;<i> What would the proxy be caching? All AMQP operations carrying payloads are non-idempotent, which makes them unsuitable for caching.
</I>&gt;<i> 
</I>&gt;&gt;<i> I could duplicate data coming in to multiple back-end servers
</I>&gt;<i> 
</I>&gt;<i> Multi-casting doesn't make sense for most operations. The obvious exception is basic.publish.
</I>&gt;<i> 
</I>&gt;<i> What would you do with the responses from the multiple back-end servers? How would you deal with operations that return different results depending on the back-end server? Anonymous queue declaration is one such example. Also, some aspects of AMQP are inherently racy. For example, operations on different channels can be executed in any order. That too means servers can return different responses for the same series of requests.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Matthias.
</I>
Actually, HAProxy does just about everything I need so far, so I'm just using that to front a standard cluster.

The HA I was thinking of would basically be a proxy pretending to be a single server. Incoming requests (client -&gt; server) go out to all backend servers and responses (server -&gt; client) go back to the client by using the first responder. The idea is that all backend servers are equal and no matter which one replies, that answer will be valid. It seems to me that any cloud or HA solution is going to involve a middle-man of some sort. No matter what service it is, something like HAProxy will have to be integrated into the platform to allow dynamic membership on the backend with a fixed front-end. 

As for caching, some of the things I'm using MQ for include running SQL queries. Since the results will be cacheable, I could return the last result directly from the proxy, saving the db connection, etc... and masking the caching from the client. Not everything would be cacheable, of course, but query bodies strike me as something I could easily cache.

Jon Brisbin
Portal Webmaster
NPC International, Inc.



</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007381.html">[rabbitmq-discuss] Caching proxy for cloud HA
</A></li>
	<LI>Next message: <A HREF="007389.html">[rabbitmq-discuss] Caching proxy for cloud HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7382">[ date ]</a>
              <a href="thread.html#7382">[ thread ]</a>
              <a href="subject.html#7382">[ subject ]</a>
              <a href="author.html#7382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
