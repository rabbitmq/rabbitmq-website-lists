<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] MTU
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20MTU&In-Reply-To=u2u5ef296b31005091958sb0a056e8s94b5f5851b65c412%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007167.html">
   <LINK REL="Next"  HREF="007170.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] MTU</H1>
    <B>Martin Sustrik</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20MTU&In-Reply-To=u2u5ef296b31005091958sb0a056e8s94b5f5851b65c412%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] MTU">sustrik at 250bpm.com
       </A><BR>
    <I>Mon May 10 08:35:24 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007167.html">[rabbitmq-discuss] MTU
</A></li>
        <LI>Next message: <A HREF="007170.html">[rabbitmq-discuss] MTU
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7168">[ date ]</a>
              <a href="thread.html#7168">[ thread ]</a>
              <a href="subject.html#7168">[ subject ]</a>
              <a href="author.html#7168">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gustavo,

&gt;<i> If RabbitMQ are receiving 20 messages per millisecond from publisher and 
</I>&gt;<i> each message have 213 bytes, what the size of packages over network to a 
</I>&gt;<i> consumer or other broker?
</I>
20 msgs/ms = 1 message each 50 us

This means (under Linux at least) that each message is sent as a 
separate packet. Or maybe three packets per message. It depends on 
whether RabbitMQ sends message using single OS call or whether is sends 
each frame separately.

Anyway, with 213 bytes of message body and ~60 bytes of AMQP envelope, 
OS gets 273 bytes each 50 us to send. At this rate OS will probably do 
no packet coallescing (depends on TCP_NODELAY setting and latency of 
your link), neither will interrupt coalescing in the NIC kick in (it 
usually starts working when packets are less than 20-30 us apart).

Thus, packets on the network are likely to be ~300 bytes long (taking 
into account IP and TCP headers). Check it using a packet capturing tool 
such as wireshark!

Anyway, packets 300 bytes long are way below standard MTU (1500) or 
jumbo frame MTU (9000) -- making the setting pretty irrelevant.

Martin



</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007167.html">[rabbitmq-discuss] MTU
</A></li>
	<LI>Next message: <A HREF="007170.html">[rabbitmq-discuss] MTU
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7168">[ date ]</a>
              <a href="thread.html#7168">[ thread ]</a>
              <a href="subject.html#7168">[ subject ]</a>
              <a href="author.html#7168">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
