<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd:  Fwd: active/active
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20%20Fwd%3A%20active/active&In-Reply-To=AANLkTinfGfbOZgIBdv6aNI_RdZZ7mkOMwHR4ACVFXsbc%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007232.html">
   <LINK REL="Next"  HREF="007276.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd:  Fwd: active/active</H1>
    <B>John Apps</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20%20Fwd%3A%20active/active&In-Reply-To=AANLkTinfGfbOZgIBdv6aNI_RdZZ7mkOMwHR4ACVFXsbc%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Fwd:  Fwd: active/active">johndapps at gmail.com
       </A><BR>
    <I>Tue May 11 19:59:17 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007232.html">[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
</A></li>
        <LI>Next message: <A HREF="007276.html">[rabbitmq-discuss] Fwd: Fwd: active/active
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7229">[ date ]</a>
              <a href="thread.html#7229">[ thread ]</a>
              <a href="subject.html#7229">[ subject ]</a>
              <a href="author.html#7229">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jason suggested I post my response to his note rather than a private reply
to him. Well, it just so happens that that is what I intended, but managed
to get the email addresses all mixed - again.
It is my belief that the world does need truly durable/persistent/reliable
messaging. It is also the case that there are many applications out there
which use it even when they had no need originally. DECmessageQ (Oracle
Message Queue these days) is an example in point.

---------- Forwarded message ----------
From: Jason J. W. Williams &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt;
Date: Tue, May 11, 2010 at 20:46
Subject: Re: [rabbitmq-discuss] Fwd: active/active
To: John Apps &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johndapps at gmail.com</A>&gt;


Hi John,

It'd be great if you could share that with the list. Regarding
duplication, I think that's easily addressed. If you're in a situation
where the sender is going to re-send if they don't get confirmation it
was accepted/processed on the other side, then you don't need durable
messages. You're providing the durability.

So the replay concept would only apply to durable messages and would
allow all involved to make the assumption the message will eventually
arrive and trust RabbitMQ to get it there...something that can't be
assumed at the moment with clustering.

-J

On Tue, May 11, 2010 at 1:25 AM, John Apps &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johndapps at gmail.com</A>&gt; wrote:
&gt;<i> Option 1 below is neat and something that a product called Reliable
</I>&gt;<i> Transaction Router (RTR) has offered for many years with considerable
</I>&gt;<i> success. So, what, you might ask, has that to do with RabbitMQ? Well,
</I>quite
&gt;<i> simply, only to show that the concept is a viable one and has been used in
</I>&gt;<i> practice for many years.
</I>&gt;<i> One of the caveats with it is when the queues are feeding into two
</I>&gt;<i> databases, one a copy of the other; no, not mirrored in the classic sense,
</I>&gt;<i> rather, the messages are sent to both. The thing to take care of here is
</I>&gt;<i> that when messages are being replayed, i.e., one server has been down and
</I>&gt;<i> comes back up, whereupon the other server then plays the missed messages
</I>to
&gt;<i> it, is that the DB on the server processing the messages MUST not have
</I>been
&gt;<i> changed whilst the server was down.
</I>&gt;<i> What would be 'nice to have' in this scenario is a flag stating that the
</I>&gt;<i> messages are being re-played. This helps to avoid the problem of possible
</I>&gt;<i> duplicate messages by making one aware of the fact that a re-play is in
</I>&gt;<i> progress.
</I>&gt;<i> With the purchase of GemStone, perhaps the folks at RabbitMQ can use some
</I>of
&gt;<i> the distributed messaging technology from that product suite?
</I>&gt;<i>
</I>&gt;<i> On Tue, May 11, 2010 at 00:43, Jason J. W. Williams
</I>&gt;<i> &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It was suggested to me I relay a convo I had with Alexis earlier this
</I>&gt;&gt;<i> year making the case for better active/active fail-over in RabbitMQ.
</I>&gt;&gt;<i> Particularly, when working with durable messaging.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ---------- Forwarded message ----------
</I>&gt;&gt;<i> From: Jason J. W. Williams &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt;
</I>&gt;&gt;<i> Date: Mon, Jan 18, 2010 at 7:07 PM
</I>&gt;&gt;<i> Subject: Re: active/active
</I>&gt;&gt;<i> To: Alexis Richardson &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hey Alexis,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Currently, we have a single RMQ 1.5 pair that are setup
</I>&gt;&gt;<i> active/passive. That is to say, our apps publish to node A and if it
</I>&gt;&gt;<i> is unavailable publish to node B. Nodes A and B are standalone in that
</I>&gt;&gt;<i> they are not in a cluster together. This is because the messages being
</I>&gt;&gt;<i> published are durable, and in the event node A crashes any pending
</I>&gt;&gt;<i> durable messages would not be auto-resubmitted if node A were
</I>&gt;&gt;<i> clustered with node B (node B's queue essentially hides the pendings
</I>&gt;&gt;<i> that were in the queue on node A before the crash).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This set up works OK for us, as the load is fairly light and
</I>&gt;&gt;<i> durability is more important for these tasks than availability.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That being said we are designing a rework of our statistics logging
</I>&gt;&gt;<i> infrastructure around Rabbit. Our stats is very high volume and
</I>&gt;&gt;<i> availability is more important than durability (in fact none of the
</I>&gt;&gt;<i> messages will be durable). So our intention is to create a new Rabbit
</I>&gt;&gt;<i> cluster with three nodes and a load-balanced IP in front (since
</I>&gt;&gt;<i> auto-redirect based on load is no longer supported....nasty memo to
</I>&gt;&gt;<i> follow... ;) ).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Our desire due to the fact that we're moving from a colo'd environment
</I>&gt;&gt;<i> to a cloud environment, is to collapse both Rabbit &quot;clusters&quot;
</I>&gt;&gt;<i> into a single cluster to maximize efficiency. It would also allow our
</I>&gt;&gt;<i> existing app to benefit from the performance of a load-sharing
</I>&gt;&gt;<i> environment. For that to happen however, Rabbit would have to do one
</I>&gt;&gt;<i> of two things when clustered regarding durable messages:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1.) When a crashed node is restarted, replay the pending/durable
</I>&gt;&gt;<i> messages into the queue on the node now responsible for the queue
</I>&gt;&gt;<i> after the crash.
</I>&gt;&gt;<i> 2.) Replicate all durable queues to more than one node, so that
</I>&gt;&gt;<i> durable queue contents continue after a node crash.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Frankly, option 1 is just fine with us and would solve our issue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Does this help? Thank you for being concerned.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -J
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> ---
</I>&gt;<i> John Apps
</I>&gt;<i> (49) 171 869 1813
</I>&gt;<i>
</I>


-- 
---
John Apps
(49) 171 869 1813
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100511/551af758/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100511/551af758/attachment.htm</A> 
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007232.html">[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
</A></li>
	<LI>Next message: <A HREF="007276.html">[rabbitmq-discuss] Fwd: Fwd: active/active
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7229">[ date ]</a>
              <a href="thread.html#7229">[ thread ]</a>
              <a href="subject.html#7229">[ subject ]</a>
              <a href="author.html#7229">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
