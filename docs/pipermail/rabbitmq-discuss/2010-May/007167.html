<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] MTU
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20MTU&In-Reply-To=4BE7325E.9000107%40250bpm.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007166.html">
   <LINK REL="Next"  HREF="007168.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] MTU</H1>
    <B>Gustavo Aquino</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20MTU&In-Reply-To=4BE7325E.9000107%40250bpm.com"
       TITLE="[rabbitmq-discuss] MTU">aquino.gustavo at gmail.com
       </A><BR>
    <I>Mon May 10 03:58:02 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007166.html">[rabbitmq-discuss] MTU
</A></li>
        <LI>Next message: <A HREF="007168.html">[rabbitmq-discuss] MTU
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7167">[ date ]</a>
              <a href="thread.html#7167">[ thread ]</a>
              <a href="subject.html#7167">[ subject ]</a>
              <a href="author.html#7167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Martin,


On Sun, May 9, 2010 at 7:08 PM, Martin Sustrik &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A>&gt; wrote:

&gt;<i> Gustavo Aquino wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Martin,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Sun, May 9, 2010 at 6:02 PM, Martin Sustrik &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A>&lt;mailto:
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Gustavo,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        Thanks but today we are trying to get this information by this
</I>&gt;&gt;<i>        hard way. I'm trying to get a help here, someone may have done
</I>&gt;&gt;<i>        it before or RabbitMQ owners can have this number and will help
</I>&gt;&gt;<i>        me to get back time loosed hacking packages network.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Per-message overhead for AMQP/0-8 is 50+ bytes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks, do you know if RabbitMQ cover this pattern ?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sure. It's minimal size of envelope for AMQP/0-8. Actual envelope may be
</I>&gt;<i> larger depending on what you put into it (exchange name, topic etc.)
</I>

Well MTU is about maximum not minimal, so you sad a interest stuff, let say
that we posting message to one exchange named &quot;123&quot;and it routed to one
queue named &quot;456&quot; on other machine, so what is MTU from primarily message
and what the size of second ?


&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        This number is very important, and have significant differences
</I>&gt;&gt;<i>        between AMQP implementations. Just for example the Qpid package
</I>&gt;&gt;<i>        have a oversize in message larger than RabbitMQ until you can
</I>&gt;&gt;<i>        send 32k messages per second using 100mbps you can do only 16k
</I>&gt;&gt;<i>        messages per second with Qpid with the same 100mbps. (Messages
</I>&gt;&gt;<i>        with 213bytes).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        Resuming If you will have a high throughput and need high
</I>&gt;&gt;<i>        performance make sure that you will not want to use jumbo frame.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    It's very unlikely that MTU size setting will have any impact on
</I>&gt;&gt;<i>    performance in your scenario.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you use jumbo frame you have a significant impact in your round trip,
</I>&gt;&gt;<i> and make sure we are working to save microseconds/nanoseconds and a simple
</I>&gt;&gt;<i> overhead in round trip message impact us so much.
</I>&gt;&gt;<i> Again the MTU question is to do some calc to refine our network
</I>&gt;&gt;<i> configurations, not a simple configuration in Ethernet interface, a network
</I>&gt;&gt;<i> admin use this calc to project your network to a specific requirement, and
</I>&gt;&gt;<i> when you are talking in microseconds/nanoseconds this configuration made a
</I>&gt;&gt;<i> big difference. For example we are getting bad performance in one of our
</I>&gt;&gt;<i> nodes, and we discovered that router was configured for 576 MTU the result
</I>&gt;&gt;<i> is an overhead of 0.500 us each message with one specific throughput.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 0.5 us is presumably less than 1% of overall latency. In fact, it's pretty
</I>&gt;<i> hard even to measure that kind of latency difference. Just the latency
</I>&gt;<i> jitter is going to be many times higher than that.
</I>&gt;<i>
</I>&gt;<i> What exactly are you trying to achieve? And what are you measuring?
</I>&gt;<i>
</I>
Look 0.5us in each message based on a throughput, whats happend if your
router have a 576 MTU and your other are sending 1.500 MTU? it will
fragmente this packages in 3 packages of 576 MTU, this cause something like
a full network bandwidth used, in other words if my router can use only
1.500 MTU how much messages I can put in this value ? this is te basic calc
that we want do do and about that we need to know the MTU of RabbitMQ
messages understand ?


If RabbitMQ are receiving 20 messages per millisecond from publisher and
each message have 213 bytes, what the size of packages over network to a
consumer or other broker?


Gustavo


&gt;<i>
</I>&gt;<i> Martin
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100509/324e7d68/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100509/324e7d68/attachment.htm</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007166.html">[rabbitmq-discuss] MTU
</A></li>
	<LI>Next message: <A HREF="007168.html">[rabbitmq-discuss] MTU
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7167">[ date ]</a>
              <a href="thread.html#7167">[ thread ]</a>
              <a href="subject.html#7167">[ subject ]</a>
              <a href="author.html#7167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
