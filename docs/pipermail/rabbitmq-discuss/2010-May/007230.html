<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%5BPATCH%2000%20of%2010%5D%20Several%20improvements%20to%20the%0A%20OCF%20resource%20agent&In-Reply-To=4BE9A6EB.3000908%40linbit.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007228.html">
   <LINK REL="Next"  HREF="007232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%5BPATCH%2000%20of%2010%5D%20Several%20improvements%20to%20the%0A%20OCF%20resource%20agent&In-Reply-To=4BE9A6EB.3000908%40linbit.com"
       TITLE="[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent">matthew at lshift.net
       </A><BR>
    <I>Tue May 11 20:04:45 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007228.html">[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
</A></li>
        <LI>Next message: <A HREF="007232.html">[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7230">[ date ]</a>
              <a href="thread.html#7230">[ thread ]</a>
              <a href="subject.html#7230">[ subject ]</a>
              <a href="author.html#7230">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, May 11, 2010 at 08:50:19PM +0200, Florian Haas wrote:
&gt;<i> On 05/11/2010 08:01 PM, Matthew Sackman wrote:
</I>&gt;<i> &gt; These are excellent, and I have no doubt they will likely all be
</I>&gt;<i> &gt; accepted. As I'm sure you've been able to gather, some of the
</I>&gt;<i> &gt; documentation and example scripts that I've read in order to be able to
</I>&gt;<i> &gt; write the OCF script are out of date themselves, hence some of the
</I>&gt;<i> &gt; issues you've spotted and corrected.
</I>&gt;<i> 
</I>&gt;<i> Would you mind sharing exactly what documentation and example scripts
</I>&gt;<i> you were following? We should get those fixed.
</I>
Sure, a lot of it was just done from reading other OCF scripts, such as
the DRBD, IPAddr and such like. But I think I got the most out of the
docs at
<A HREF="http://www.clusterlabs.org/doc/en-US/Pacemaker/1.0/html/Pacemaker_Explained/ap-ocf.html">http://www.clusterlabs.org/doc/en-US/Pacemaker/1.0/html/Pacemaker_Explained/ap-ocf.html</A>

For example, that only talks of the monitor action, not status, and no
where that I found is there any real documentation as to what the
library of functions that is supplied with pacemaker do, nor how or when
they should be used (eg the ocf_is_probe function you've used).

&gt;<i> One other thing that came to mind while looking at the RA: the
</I>&gt;<i> recommended minimum start timeout of 600s seems a bit excessive.
</I>&gt;<i> Starting with Pacemaker 1.0.8 the crm shell will warn if the
</I>&gt;<i> configuration provides for shorter timeouts than the RA recommends. Sure
</I>&gt;<i> you need a 10-minute start timeout?
</I>
Currently, startup time can be very long if you have an awful lot of
data to recover from disk. We think this might be partially fixed very
soon as some work that's recently been done will all Rabbit to come up
even before all recovery is complete (only the queues still being
recovered will continue to be unavailable). However, even in this case,
there are still some internal resources that must be fully recovered
before Rabbit can be in any way considered to be up, and that can be
proportional to the amount of data it has previously stored on disk.

Thus, in conclusion, yes, 10 mins may be far too long. But in some cases
it may also be too short. Any advice you have as to what we should be
doing wrt the OCF script would be gratefully received.

Matthew

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007228.html">[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
</A></li>
	<LI>Next message: <A HREF="007232.html">[rabbitmq-discuss] [PATCH 00 of 10] Several improvements to the OCF resource agent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7230">[ date ]</a>
              <a href="thread.html#7230">[ thread ]</a>
              <a href="subject.html#7230">[ subject ]</a>
              <a href="author.html#7230">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
