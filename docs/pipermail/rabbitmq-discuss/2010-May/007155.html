<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Unofficial%20guide%20to%20AMQP%201.0%20PR3&In-Reply-To=201005071559.07067.jpellerin%40leapfrogonline.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007146.html">
   <LINK REL="Next"  HREF="007177.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3</H1>
    <B>Rafael Schloming</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Unofficial%20guide%20to%20AMQP%201.0%20PR3&In-Reply-To=201005071559.07067.jpellerin%40leapfrogonline.com"
       TITLE="[rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3">rafaels at redhat.com
       </A><BR>
    <I>Sat May  8 14:18:42 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007146.html">[rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3
</A></li>
        <LI>Next message: <A HREF="007177.html">[rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7155">[ date ]</a>
              <a href="thread.html#7155">[ thread ]</a>
              <a href="subject.html#7155">[ subject ]</a>
              <a href="author.html#7155">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jason Pellerin wrote:
&gt;<i> On Wednesday 05 May 2010 18:38:18 Michael Bridgen wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Flow control acts like a more fine-grained channel.flow for publishers,
</I>&gt;&gt;<i> and like basic.qos for consumers; in each case, the receiving side
</I>&gt;&gt;<i> issues *credit*, which the sending side uses up by transferring
</I>&gt;&gt;<i> messages.  To do something like a basic.get, a consumer issues a single
</I>&gt;&gt;<i> unit of *credit*, and waits for the single message to come in.
</I>&gt;<i> 
</I>&gt;<i> I hope I'm missing something, but this description jumped out at me as looking
</I>&gt;<i> like AMQP 1.0 is going to include one of (IMO) 0-10's biggest mistakes.
</I>&gt;<i> 
</I>&gt;<i> As someone using messaging mainly in web applications, basic.get is the best
</I>&gt;<i> thing in amqp. When response time matters, having a single command that polls
</I>&gt;<i> for a message and returns immediately if one isn't present is incredibly
</I>&gt;<i> useful. Replacing that with 2+ commands and replacing polling with waiting --
</I>&gt;<i> ouch.
</I>
What Michael is describing above is correct, but not complete for the 
case you're interested in. To do a synchronous get you would also put 
the link in drain mode, and this would guarantee that your credit is 
consumed immediately, i.e. no waiting.

In the simple case this boils down to an interaction similar to 
basic.get. You send a flow frame (equivalent to basic.get -&gt;), receive 
either a transfer (&lt;- get-ok), or another flow frame indicating there is 
nothing available to transfer (&lt;- get-empty).

This scheme has the significant added benefit that by issuing N units of 
credit rather than just one, you can use the same mechanism to poll in 
batches rather than just one message at a time.

While this is an evolution of the same flow control model first 
introduced in 0-10, I wouldn't be concerned over that as neither one 
requires you to substitute waiting for polling, and the number of 
frames/commands required is the same as for the equivalent basic.get 
interaction.

The flow control section of the transport spec includes examples of this 
and other cases if you're interested in more details.

--Rafael


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007146.html">[rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3
</A></li>
	<LI>Next message: <A HREF="007177.html">[rabbitmq-discuss] Unofficial guide to AMQP 1.0 PR3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7155">[ date ]</a>
              <a href="thread.html#7155">[ thread ]</a>
              <a href="subject.html#7155">[ subject ]</a>
              <a href="author.html#7155">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
