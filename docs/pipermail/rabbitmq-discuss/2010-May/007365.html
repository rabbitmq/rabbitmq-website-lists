<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq recovery, channelflow, and clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbitmq%20recovery%2C%20channelflow%2C%20and%20clients&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007364.html">
   <LINK REL="Next"  HREF="007367.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq recovery, channelflow, and clients</H1>
    <B>Tyler Williams</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbitmq%20recovery%2C%20channelflow%2C%20and%20clients&In-Reply-To="
       TITLE="[rabbitmq-discuss] rabbitmq recovery, channelflow, and clients">tyler at echonest.com
       </A><BR>
    <I>Sat May 22 14:21:32 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007364.html">[rabbitmq-discuss] RabbitMQ failover and message loss
</A></li>
        <LI>Next message: <A HREF="007367.html">[rabbitmq-discuss] rabbitmq recovery, channelflow, and clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7365">[ date ]</a>
              <a href="thread.html#7365">[ thread ]</a>
              <a href="subject.html#7365">[ subject ]</a>
              <a href="author.html#7365">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I've been playing with the 21673 branch of rabbitmq, and I have a few questions. 

How does rabbitmq handle bumping up against ulimit -n?

After overwhelming rabbitmq with what I think is a misbehaving client, and then restarting it, rabbitmq recovers some of my queues, and none of the messages that were in them. Is this the expected behavior? I see messages like this in rabbit.log for the unrecovered queues:

=ERROR REPORT==== 21-May-2010::20:11:07 ===
** Generic server &lt;0.981.0&gt; terminating 
** Last message in was {init,true}
** When Server state == {q,{amqqueue,{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;queue-23&quot;&gt;&gt;},
                                     true,false,[],&lt;0.981.0&gt;},
                           none,none,false,rabbit_variable_queue,undefined,
                           {[],[]},
                           {[],[]},
                           undefined,undefined}
** Reason for termination == 
** {{badmatch,{error,emfile}},
    [{filename,absname,1},
     {file_handle_cache,open,3},
     {rabbit_queue_index,get_segment_handle,1},
     {rabbit_queue_index,load_segment,2},
     {rabbit_queue_index,recover_segment,3},
     {rabbit_queue_index,'-init_dirty/3-fun-0-',5},
     {lists,foldl,3},
     {rabbit_queue_index,init_dirty,3}]}


With respect to ChannelFlow, when rabbit gets a high mem watermark event and sends out the channelflow command to producers, will it disconnect producers who don't honor this?

I've been playing with both pika and amqplib clients. With pika, I see the watermark get set, the flow exception thrown in my producer, and then eventually the watermark gets cleared. With amqplib I see the watermark set but never cleared. I see what looks like some support for flow in amqplib, but I can't tell how it's being used.

Any help you can give me is appreciated!

Thanks,

--tyler
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007364.html">[rabbitmq-discuss] RabbitMQ failover and message loss
</A></li>
	<LI>Next message: <A HREF="007367.html">[rabbitmq-discuss] rabbitmq recovery, channelflow, and clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7365">[ date ]</a>
              <a href="thread.html#7365">[ thread ]</a>
              <a href="subject.html#7365">[ subject ]</a>
              <a href="author.html#7365">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
