<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd: Fwd: active/active
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20Fwd%3A%20active/active&In-Reply-To=AANLkTik4FGjv_PA_giiw4FGiR_ij_KpcRRbXVGrK3u3B%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007229.html">
   <LINK REL="Next"  HREF="007231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd: Fwd: active/active</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20Fwd%3A%20active/active&In-Reply-To=AANLkTik4FGjv_PA_giiw4FGiR_ij_KpcRRbXVGrK3u3B%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Fwd: Fwd: active/active">alexis at rabbitmq.com
       </A><BR>
    <I>Thu May 13 20:02:22 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007229.html">[rabbitmq-discuss] Fwd:  Fwd: active/active
</A></li>
        <LI>Next message: <A HREF="007231.html">[rabbitmq-discuss] Caching proxy for cloud HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7276">[ date ]</a>
              <a href="thread.html#7276">[ thread ]</a>
              <a href="subject.html#7276">[ subject ]</a>
              <a href="author.html#7276">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'd like to make a brief comment on this.

Right now, we are starting to think properly about HA cases that
require something more refined than the active/passive set-up
described here: <A HREF="http://www.rabbitmq.com/pacemaker.html">http://www.rabbitmq.com/pacemaker.html</A>

There are a lot of these, depending on how you mix durability,
visibility, latency and domains of control.  Some of the NoSQL folks,
eg the Riak team, are working on related problems which we try to
study when we can.  We are actively working with customers who need
any kind of HA Rabbit, mostly behind the firewall but also in the
cloud.  We are also working on some 'cloud services' as I stated here:
<A HREF="http://skillsmatter.com/podcast/cloud-grid/use-cases-for-cloud-messaging">http://skillsmatter.com/podcast/cloud-grid/use-cases-for-cloud-messaging</A>

My point is - this is a useful discussion and we really appreciate any
and all feedback on this :-)

alexis






On Tue, May 11, 2010 at 7:59 PM, John Apps &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johndapps at gmail.com</A>&gt; wrote:
&gt;<i> Jason suggested I post my response to his note rather than a private reply
</I>&gt;<i> to him. Well, it just so happens that that is what I intended, but managed
</I>&gt;<i> to get the email addresses all mixed - again.
</I>&gt;<i> It is my belief that the world does need truly durable/persistent/reliable
</I>&gt;<i> messaging. It is also the case that there are many applications out there
</I>&gt;<i> which use it even when they had no need originally. DECmessageQ (Oracle
</I>&gt;<i> Message Queue these days) is an example in point.
</I>&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> From: Jason J. W. Williams &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt;
</I>&gt;<i> Date: Tue, May 11, 2010 at 20:46
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] Fwd: active/active
</I>&gt;<i> To: John Apps &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johndapps at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi John,
</I>&gt;<i>
</I>&gt;<i> It'd be great if you could share that with the list. Regarding
</I>&gt;<i> duplication, I think that's easily addressed. If you're in a situation
</I>&gt;<i> where the sender is going to re-send if they don't get confirmation it
</I>&gt;<i> was accepted/processed on the other side, then you don't need durable
</I>&gt;<i> messages. You're providing the durability.
</I>&gt;<i>
</I>&gt;<i> So the replay concept would only apply to durable messages and would
</I>&gt;<i> allow all involved to make the assumption the message will eventually
</I>&gt;<i> arrive and trust RabbitMQ to get it there...something that can't be
</I>&gt;<i> assumed at the moment with clustering.
</I>&gt;<i>
</I>&gt;<i> -J
</I>&gt;<i>
</I>&gt;<i> On Tue, May 11, 2010 at 1:25 AM, John Apps &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johndapps at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> Option 1 below is neat and something that a product called Reliable
</I>&gt;&gt;<i> Transaction Router (RTR) has offered for many years with considerable
</I>&gt;&gt;<i> success. So, what, you might ask, has that to do with RabbitMQ? Well,
</I>&gt;&gt;<i> quite
</I>&gt;&gt;<i> simply, only to show that the concept is a viable one and has been used in
</I>&gt;&gt;<i> practice for many years.
</I>&gt;&gt;<i> One of the caveats with it is when the queues are feeding into two
</I>&gt;&gt;<i> databases, one a copy of the other; no, not mirrored in the classic sense,
</I>&gt;&gt;<i> rather, the messages are sent to both. The thing to take care of here is
</I>&gt;&gt;<i> that when messages are being replayed, i.e., one server has been down and
</I>&gt;&gt;<i> comes back up, whereupon the other server then plays the missed messages
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> it, is that the DB on the server processing the messages MUST not have
</I>&gt;&gt;<i> been
</I>&gt;&gt;<i> changed whilst the server was down.
</I>&gt;&gt;<i> What would be 'nice to have' in this scenario is a flag stating that the
</I>&gt;&gt;<i> messages are being re-played. This helps to avoid the problem of possible
</I>&gt;&gt;<i> duplicate messages by making one aware of the fact that a re-play is in
</I>&gt;&gt;<i> progress.
</I>&gt;&gt;<i> With the purchase of GemStone, perhaps the folks at RabbitMQ can use some
</I>&gt;&gt;<i> of
</I>&gt;&gt;<i> the&#160;distributed&#160;messaging technology from that product suite?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Tue, May 11, 2010 at 00:43, Jason J. W. Williams
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It was suggested to me I relay a convo I had with Alexis earlier this
</I>&gt;&gt;&gt;<i> year making the case for better active/active fail-over in RabbitMQ.
</I>&gt;&gt;&gt;<i> Particularly, when working with durable messaging.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ---------- Forwarded message ----------
</I>&gt;&gt;&gt;<i> From: Jason J. W. Williams &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>&gt;
</I>&gt;&gt;&gt;<i> Date: Mon, Jan 18, 2010 at 7:07 PM
</I>&gt;&gt;&gt;<i> Subject: Re: active/active
</I>&gt;&gt;&gt;<i> To: Alexis Richardson &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hey Alexis,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Currently, we have a single RMQ 1.5 pair that are setup
</I>&gt;&gt;&gt;<i> active/passive. That is to say, our apps publish to node A and if it
</I>&gt;&gt;&gt;<i> is unavailable publish to node B. Nodes A and B are standalone in that
</I>&gt;&gt;&gt;<i> they are not in a cluster together. This is because the messages being
</I>&gt;&gt;&gt;<i> published are durable, and in the event node A crashes any pending
</I>&gt;&gt;&gt;<i> durable messages would not be auto-resubmitted if node A were
</I>&gt;&gt;&gt;<i> clustered with node B (node B's queue essentially hides the pendings
</I>&gt;&gt;&gt;<i> that were in the queue on node A before the crash).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This set up works OK for us, as the load is fairly light and
</I>&gt;&gt;&gt;<i> durability is more important for these tasks than availability.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> That being said we are designing a rework of our statistics logging
</I>&gt;&gt;&gt;<i> infrastructure around Rabbit. Our stats is very high volume and
</I>&gt;&gt;&gt;<i> availability is more important than durability (in fact none of the
</I>&gt;&gt;&gt;<i> messages will be durable). So our intention is to create a new Rabbit
</I>&gt;&gt;&gt;<i> cluster with three nodes and a load-balanced IP in front (since
</I>&gt;&gt;&gt;<i> auto-redirect based on load is no longer supported....nasty memo to
</I>&gt;&gt;&gt;<i> follow... ;) ).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Our desire due to the fact that we're moving from a colo'd environment
</I>&gt;&gt;&gt;<i> to a cloud environment, is to collapse both Rabbit &quot;clusters&quot;
</I>&gt;&gt;&gt;<i> into a single cluster to maximize efficiency. It would also allow our
</I>&gt;&gt;&gt;<i> existing app to benefit from the performance of a load-sharing
</I>&gt;&gt;&gt;<i> environment. For that to happen however, Rabbit would have to do one
</I>&gt;&gt;&gt;<i> of two things when clustered regarding durable messages:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 1.) When a crashed node is restarted, replay the pending/durable
</I>&gt;&gt;&gt;<i> messages into the queue on the node now responsible for the queue
</I>&gt;&gt;&gt;<i> after the crash.
</I>&gt;&gt;&gt;<i> 2.) Replicate all durable queues to more than one node, so that
</I>&gt;&gt;&gt;<i> durable queue contents continue after a node crash.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Frankly, option 1 is just fine with us and would solve our issue.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Does this help? Thank you for being concerned.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -J
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> ---
</I>&gt;&gt;<i> John Apps
</I>&gt;&gt;<i> (49) 171 869 1813
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> ---
</I>&gt;<i> John Apps
</I>&gt;<i> (49) 171 869 1813
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007229.html">[rabbitmq-discuss] Fwd:  Fwd: active/active
</A></li>
	<LI>Next message: <A HREF="007231.html">[rabbitmq-discuss] Caching proxy for cloud HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7276">[ date ]</a>
              <a href="thread.html#7276">[ thread ]</a>
              <a href="subject.html#7276">[ subject ]</a>
              <a href="author.html#7276">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
