<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [PATCH 05 of 10] OCF resource agent: fix	validate exit codes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%5BPATCH%2005%20of%2010%5D%20OCF%20resource%20agent%3A%20fix%0A%09validate%20exit%20codes&In-Reply-To=patchbomb.1273597777%40gluehwein.linbit">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007217.html">
   <LINK REL="Next"  HREF="007221.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [PATCH 05 of 10] OCF resource agent: fix	validate exit codes</H1>
    <B>Florian Haas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%5BPATCH%2005%20of%2010%5D%20OCF%20resource%20agent%3A%20fix%0A%09validate%20exit%20codes&In-Reply-To=patchbomb.1273597777%40gluehwein.linbit"
       TITLE="[rabbitmq-discuss] [PATCH 05 of 10] OCF resource agent: fix	validate exit codes">florian.haas at linbit.com
       </A><BR>
    <I>Tue May 11 18:09:42 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007217.html">[rabbitmq-discuss] [PATCH 04 of 10] OCF resource agent: on error,	exit, don't return
</A></li>
        <LI>Next message: <A HREF="007221.html">[rabbitmq-discuss] [PATCH 06 of 10] OCF resource agent: fix	incorrect parameter type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7223">[ date ]</a>
              <a href="thread.html#7223">[ thread ]</a>
              <a href="subject.html#7223">[ subject ]</a>
              <a href="author.html#7223">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE># HG changeset patch
# User Florian Haas &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">florian.haas at linbit.com</A>&gt;
# Date 1273594006 -7200
# Node ID 2a468e9f5b96c9d31554525c5b00852f0f302487
# Parent  f0a7e4621b20a35c6cf20b2393d7d6b3f02fbc7b
OCF resource agent: fix validate exit codes

Exit with $OCF_ERR_INSTALLED if validate fails due to non-availability
of a required binary, or config file.

diff -r f0a7e4621b20 -r 2a468e9f5b96 packaging/common/rabbitmq-server.ocf
--- a/packaging/common/rabbitmq-server.ocf	Tue May 11 18:05:09 2010 +0200
+++ b/packaging/common/rabbitmq-server.ocf	Tue May 11 18:06:46 2010 +0200
@@ -204,34 +204,34 @@
 rabbit_validate_partial() {
     if [ ! -x $RABBITMQ_MULTI ]; then
 	ocf_log err &quot;rabbitmq-server multi $RABBITMQ_MULTI does not exist or is not executable&quot;;
-	exit $OCF_ERR_ARGS;
+	exit $OCF_ERR_INSTALLED;
     fi
 
     if [ ! -x $RABBITMQ_CTL ]; then
 	ocf_log err &quot;rabbitmq-server ctl $RABBITMQ_CTL does not exist or is not executable&quot;;
-	exit $OCF_ERR_ARGS;
+	exit $OCF_ERR_INSTALLED;
     fi
 }
 
 rabbit_validate_full() {
     if [ ! -z $RABBITMQ_CLUSTER_CONFIG_FILE ] &amp;&amp; [ ! -e $RABBITMQ_CLUSTER_CONFIG_FILE ]; then
 	ocf_log err &quot;rabbitmq-server cluster_config_file $RABBITMQ_CLUSTER_CONFIG_FILE does not exist or is not a file&quot;;
-	exit $OCF_ERR_ARGS;
+	exit $OCF_ERR_INSTALLED;
     fi
 
     if [ ! -z $RABBITMQ_CONFIG_FILE ] &amp;&amp; [ ! -e $RABBITMQ_CONFIG_FILE ]; then
 	ocf_log err &quot;rabbitmq-server config_file $RABBITMQ_CONFIG_FILE does not exist or is not a file&quot;;
-	exit $OCF_ERR_ARGS;
+	exit $OCF_ERR_INSTALLED;
     fi
 
     if [ ! -z $RABBITMQ_LOG_BASE ] &amp;&amp; [ ! -d $RABBITMQ_LOG_BASE ]; then
 	ocf_log err &quot;rabbitmq-server log_base $RABBITMQ_LOG_BASE does not exist or is not a directory&quot;;
-	exit $OCF_ERR_ARGS;
+	exit $OCF_ERR_INSTALLED;
     fi
 
     if [ ! -z $RABBITMQ_MNESIA_BASE ] &amp;&amp; [ ! -d $RABBITMQ_MNESIA_BASE ]; then
 	ocf_log err &quot;rabbitmq-server mnesia_base $RABBITMQ_MNESIA_BASE does not exist or is not a directory&quot;;
-	exit $OCF_ERR_ARGS;
+	exit $OCF_ERR_INSTALLED;
     fi
 
     rabbit_validate_partial



</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007217.html">[rabbitmq-discuss] [PATCH 04 of 10] OCF resource agent: on error,	exit, don't return
</A></li>
	<LI>Next message: <A HREF="007221.html">[rabbitmq-discuss] [PATCH 06 of 10] OCF resource agent: fix	incorrect parameter type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7223">[ date ]</a>
              <a href="thread.html#7223">[ thread ]</a>
              <a href="subject.html#7223">[ subject ]</a>
              <a href="author.html#7223">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
