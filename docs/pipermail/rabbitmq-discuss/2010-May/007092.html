<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Behaviour when connecting with invalid	credentials
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Behaviour%20when%20connecting%20with%20invalid%0A%09credentials&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007099.html">
   <LINK REL="Next"  HREF="007094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Behaviour when connecting with invalid	credentials</H1>
    <B>David MacIver</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Behaviour%20when%20connecting%20with%20invalid%0A%09credentials&In-Reply-To="
       TITLE="[rabbitmq-discuss] Behaviour when connecting with invalid	credentials">david at drmaciver.com
       </A><BR>
    <I>Thu May  6 17:25:01 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007099.html">[rabbitmq-discuss] Deleting Queues, How?
</A></li>
        <LI>Next message: <A HREF="007094.html">[rabbitmq-discuss] Behaviour when connecting with invalid credentials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7092">[ date ]</a>
              <a href="thread.html#7092">[ thread ]</a>
              <a href="subject.html#7092">[ subject ]</a>
              <a href="author.html#7092">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(Currently using the 1.7.2 server and the current default branch of
mercurial for the Java client)

If you use the Java client and try to connect to the rabbit server
with bad credentials (e.g. dodgy password, no permissions for the
vhost, user doesn't exist) you'll see the following:

com.rabbitmq.client.ShutdownSignalException: connection error; reason:
java.io.EOFException
	at com.rabbitmq.utility.ValueOrException.getValue(ValueOrException.java:81)
	at com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:47)
	at com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:336)
	at com.rabbitmq.client.impl.AMQChannel.rpc(AMQChannel.java:209)
	at com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:133)
	at com.rabbitmq.client.impl.AMQConnection.start(AMQConnection.java:302)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:375)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:420)
java.io.EOFException
	at java.io.DataInputStream.readUnsignedByte(DataInputStream.java:273)
	at com.rabbitmq.client.impl.Frame.readFrom(Frame.java:118)
	at com.rabbitmq.client.impl.SocketFrameHandler.readFrame(SocketFrameHandler.java:133)
	at com.rabbitmq.client.impl.AMQConnection.readFrame(AMQConnection.java:413)
	at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.j...

I'm not quite sure if this is correct behaviour on the part of the
broker - it's not clear to me what the defined behaviour when
rejecting the credentials of a connecting user, but the actual
behaviour just seems to be to close the connection with prejudice:

=ERROR REPORT==== 6-May-2010::17:13:56 ===
exception on TCP connection &lt;0.652.0&gt; from 127.0.0.1:54886
{channel0_error,starting,
                {amqp_error,access_refused,
                            &quot;login refused for user 'hello world'&quot;,
                            'connection.start_ok'}}

=INFO REPORT==== 6-May-2010::17:13:56 ===
closing TCP connection &lt;0.652.0&gt; from 127.0.0.1:54886

if this is intended behaviour then it would be nice if the Java client
were to be a little more informative rather than failing noisily here.

I first noticed this because Bunny (a ruby AMQP client I'm doing some
work with/on) has essentially the same behaviour and falls over with
an unexpected nil on having its credentials rejected.  Other AMQP
clients presumably have similar issues.

So, what's up here?

</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007099.html">[rabbitmq-discuss] Deleting Queues, How?
</A></li>
	<LI>Next message: <A HREF="007094.html">[rabbitmq-discuss] Behaviour when connecting with invalid credentials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7092">[ date ]</a>
              <a href="thread.html#7092">[ thread ]</a>
              <a href="subject.html#7092">[ subject ]</a>
              <a href="author.html#7092">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
