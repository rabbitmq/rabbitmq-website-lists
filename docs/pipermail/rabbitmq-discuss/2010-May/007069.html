<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] request for help!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20request%20for%20help%21&In-Reply-To=r2ifde171c01005060335h80fefdf1i75f467738b185f87%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007380.html">
   <LINK REL="Next"  HREF="007071.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] request for help!</H1>
    <B>Robert Godfrey</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20request%20for%20help%21&In-Reply-To=r2ifde171c01005060335h80fefdf1i75f467738b185f87%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] request for help!">rob.j.godfrey at gmail.com
       </A><BR>
    <I>Thu May  6 11:43:30 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007380.html">[rabbitmq-discuss] socket read timeout in rabbitmq-c
</A></li>
        <LI>Next message: <A HREF="007071.html">[rabbitmq-discuss] request for help!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7069">[ date ]</a>
              <a href="thread.html#7069">[ thread ]</a>
              <a href="subject.html#7069">[ subject ]</a>
              <a href="author.html#7069">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry - had meant this e-mail exchange to be on list (should really
learn to read the To: list before sending :-) )

-- Rob

---------- Forwarded message ----------

From: Robert Godfrey &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rob.j.godfrey at gmail.com</A>&gt;
Date: 6 May 2010 12:35
Subject: Re: [rabbitmq-discuss] request for help!
To: Martin Sustrik &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A>&gt;



Oops - just noticed that this mail only went to you and not the Rabbit
list... would you be OK if I posted it back onto the list - which was
my original intent?

Som more comments in-line below:

On 6 May 2010 12:16, Martin Sustrik &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hi Rob,
</I>&gt;<i>
</I>&gt;&gt;<i> On 6 May 2010 10:11, Martin Sustrik &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A> &lt;mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sustrik at 250bpm.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &#160; &#160;Great you are bringing this to the public attention!
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &#160; &#160;We've discussed this before, so I'm going to repeat myself for the sake
</I>&gt;&gt;&gt;<i> &#160; &#160;of people on the mailing list...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &#160; &#160; From my point of view there are two crucial issues with AMQP/1.0:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &#160; &#160;1. Messy layering. Almost every concept is discussed at multiple places.
</I>&gt;&gt;&gt;<i> &#160; &#160;It's very hard to understand the specification in its current form. (To
</I>&gt;&gt;&gt;<i> &#160; &#160;be fair, one piece is nicely and consistently separated. The codec.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Would be glad to understand this comment in more detail. &#160;At least
</I>&gt;&gt;<i> conceptually I think the layering in 1-0 is a lot better defined with
</I>&gt;&gt;<i> concerns separated than in previous versions. &#160;Are your concerns
</I>&gt;&gt;<i> around the &#160;model, or the documentation of it?
</I>&gt;<i>
</I>&gt;<i> It's much better than it used to be. Anyway, I volunteer to help with this.
</I>&gt;<i> My idea is to start with moving pieces of the specification around to make
</I>&gt;<i> it easier to follow without changing the wire protocol. Will get in touch with
</I>&gt;<i> you shortly!
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> &#160; &#160;2. Assumption that messages are stored on the node in unordered fashion
</I>&gt;&gt;&gt;<i> &#160; &#160;shifts AMQP from being message queueing protocol to being database
</I>&gt;&gt;&gt;<i> &#160; &#160;protocol. This blurs AMQP's mission, makes it compete with SQL and
</I>&gt;&gt;&gt;<i> &#160; &#160;causes implementation to be extremely costly and complex. We should
</I>&gt;&gt;&gt;<i> &#160; &#160;follow the good old &quot;do one thing and do it well&quot; principle and focus on
</I>&gt;&gt;&gt;<i> &#160; &#160;defining MQ behaviour rather than DB behaviour.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It's not that we assume the messages are unordered at the node... but that
</I>&gt;&gt;<i> the *transport* makes *no* assumptions about message ordering within a
</I>&gt;&gt;<i> node (because it doesn't need to). &#160;It would be perfectly valid for an
</I>&gt;&gt;<i> implementation to be built with nodes that store messages strictly in order
</I>&gt;&gt;<i>  - and that's certainly how I expect most &quot;Queues&quot; inside &quot;Brokers&quot; to work
</I>&gt;&gt;<i> (having said that we already see things in AMQP implementations such
</I>&gt;&gt;<i> as priority queues, last value queues, etc. that violate this notion of &quot;strict&quot;
</I>&gt;&gt;<i> ordering).
</I>&gt;<i>
</I>&gt;<i> It's wider than ordering alone. Node with unordered messages is basically a
</I>&gt;<i> database table.
</I>
A Node with unordered messages would be some sort of Bag I would
think... Unlike a DB table there would be no natural notion of a
primary key, or necessarily any notion of a way to select the messages
(though I guess the node *may* support certain AMQP1-0 filter types).
Again, there is no requirement on implementers to write such a Node
type (unless Michael has secretly put that in the document he is
currently writing ;-) )... All that the core spec is doing is saying
is &quot;it's perfectly valid to have nodes that give FIFO ordering, LIFO
ordering, or any other (non-)ordering you like&quot;.&#160; This is actually
removing a burden on implementers rather than adding one (although the
requirement for the same sort of pseudo-FIFO that 0-x requires will
probably also be a requirement for AMQP 1-0 *Brokers*).

&gt;<i>
</I>&gt;<i> However, there are also other DB concepts in the spec. Say a concept of
</I>&gt;<i> non-destructive link -- which boils down to a SELECT statement. Or, say,
</I>&gt;<i> it seems implied that a message cannot silently disappear from a node
</I>&gt;<i> same way as record cannot silently disappear from a DB table.
</I>
There is absolutely no intent to prevent a node from silently
&quot;disappearing&quot; a message that it is holding.&#160; All that
&quot;non-destructive&quot; means is that the act of sending the message to the
receiver does not in itself cause the message to be &quot;disappeared&quot;.
The two major use cases this functionality is designed for are Queue
&quot;browsing&quot; (i.e. the ability to look at what is in your queue without
consuming the messages) and the ability to implement &quot;Topics&quot; as a
single entity (rather than the AMQP 0-x way of having a queue per
consumer).&#160; The Topic case is potentially more interesting as a Topic
node would have a policy that says &quot;when all connected consumers have
moved beyond a message in the *ordered* Topic, then the message may be
deleted&quot;.&#160; This obviously requires some notion of ordering at the
(Topic) node.&#160; Having implemented this functionality elsewhere, it
certainly doesn't require a database table like data-structure - all
it requires is that you hold pointers into the queue.

&gt;<i>
</I>&gt;<i> Compare this witch 0-9 exchanges where message is dropped when it
</I>&gt;<i> cannot be routed. Etc.
</I>
&#160;My belief is that an 0-x exchange would be a perfectly valid node in AMQP.

&gt;&gt;<i> Subsequent pieces of the AMQP specification will define the required
</I>&gt;&gt;<i> node types that need to be supported by applications acting as
</I>&gt;&gt;<i> &quot;AMQP Brokers&quot;. &#160;Michael may be able to talk more to that as that's
</I>&gt;&gt;<i> his area of responsibility :-)
</I>

hope this helps,
Rob

</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007380.html">[rabbitmq-discuss] socket read timeout in rabbitmq-c
</A></li>
	<LI>Next message: <A HREF="007071.html">[rabbitmq-discuss] request for help!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7069">[ date ]</a>
              <a href="thread.html#7069">[ thread ]</a>
              <a href="subject.html#7069">[ subject ]</a>
              <a href="author.html#7069">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
