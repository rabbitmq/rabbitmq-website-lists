<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pika and Channel.Flow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Pika%20and%20Channel.Flow&In-Reply-To=AANLkTil-pqGPwRRpn-a7vbtyzaO-nGbOOj96_Z-OE61Z%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007373.html">
   <LINK REL="Next"  HREF="007375.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pika and Channel.Flow</H1>
    <B>allan bailey</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Pika%20and%20Channel.Flow&In-Reply-To=AANLkTil-pqGPwRRpn-a7vbtyzaO-nGbOOj96_Z-OE61Z%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Pika and Channel.Flow">zirpubolci at gmail.com
       </A><BR>
    <I>Mon May 24 20:45:23 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007373.html">[rabbitmq-discuss] Pika and Channel.Flow
</A></li>
        <LI>Next message: <A HREF="007375.html">[rabbitmq-discuss] Pika and Channel.Flow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7374">[ date ]</a>
              <a href="thread.html#7374">[ thread ]</a>
              <a href="subject.html#7374">[ subject ]</a>
              <a href="author.html#7374">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If you do a  channel.access_request before every channel.basic_publish  (or
after ever N publishes), then
amqplib properly raises the AMQPContentTransmissionForbidden exception since
the active state will have been
updated.

I don't think it's very efficient to do, but it does show that the patch is
working.   Apparently the AMQP protocol does not
send an exception to an active client connection until it reconnects or
re-requests access.

I definately don't know the AMQP protocol in detail, so someone please
correct me if I'm wrong.

thanks,
Allan

On Mon, May 24, 2010 at 11:33 AM, allan bailey &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">zirpubolci at gmail.com</A>&gt; wrote:

&gt;<i> Matthias,
</I>&gt;<i>
</I>&gt;<i> On Sun, May 23, 2010 at 10:56 AM, Matthias Radestock &lt;
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Allan,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> allan bailey wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I just tried this patch in py-amqplib 0.6.2 and it doesn't seem to work,
</I>&gt;&gt;&gt;<i> or raise an exception.  It might be
</I>&gt;&gt;&gt;<i> rabbitmq isn't sending the channel.flow.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Check the rabbit.log for memory alarms; that will tell you whether
</I>&gt;&gt;<i> channel.flow is working.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Yes, I see the alarms.  But a connected producer is allowed, w/ the patch
</I>&gt;<i> to continue sending.
</I>&gt;<i> New producers are disallowed from sending though.  So it's close.  I need
</I>&gt;<i> for the connected producer
</I>&gt;<i> to catch and exception so that it will stop sending.
</I>&gt;<i>
</I>&gt;<i> I'll work on this fork and publish it when I get it working with an
</I>&gt;<i> example.
</I>&gt;<i>
</I>&gt;<i> -allan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>  I tested with rabbitmq 1.7.2 on OSX 10.6.2.  I'll test on a real OS when
</I>&gt;&gt;&gt;<i> I can.   I definately need the flow control
</I>&gt;&gt;&gt;<i> to stop producers from overwhelming the server.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If the patch doesn't work, perhaps you could develop one that does and
</I>&gt;&gt;<i> release it, or a forked repo, to the community?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matthias.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100524/4c78d304/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100524/4c78d304/attachment.htm</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007373.html">[rabbitmq-discuss] Pika and Channel.Flow
</A></li>
	<LI>Next message: <A HREF="007375.html">[rabbitmq-discuss] Pika and Channel.Flow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7374">[ date ]</a>
              <a href="thread.html#7374">[ thread ]</a>
              <a href="subject.html#7374">[ subject ]</a>
              <a href="author.html#7374">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
