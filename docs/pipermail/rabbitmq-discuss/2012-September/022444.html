<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Unintended message flow using federation?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Unintended%20message%20flow%20using%20federation%3F&In-Reply-To=%3CCACLE7iwzJ7Vt8HxzuLkK6vcfzM8hiNw1yUKsgEDX%2Bt7qD-qigg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022600.html">
   <LINK REL="Next"  HREF="022460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Unintended message flow using federation?</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Unintended%20message%20flow%20using%20federation%3F&In-Reply-To=%3CCACLE7iwzJ7Vt8HxzuLkK6vcfzM8hiNw1yUKsgEDX%2Bt7qD-qigg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Unintended message flow using federation?">mpietrek at skytap.com
       </A><BR>
    <I>Wed Sep 12 23:57:27 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022600.html">[rabbitmq-discuss] Cluster nodes stop/start order can lead	to	failures
</A></li>
        <LI>Next message: <A HREF="022460.html">[rabbitmq-discuss] Unintended message flow using federation?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22444">[ date ]</a>
              <a href="thread.html#22444">[ thread ]</a>
              <a href="subject.html#22444">[ subject ]</a>
              <a href="author.html#22444">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using federation with a topic exchange between two RabbitMQ nodes. As
part of this, I've defined an exchange, 'skytap' which is a topic exchange
(yes, I know it's not *really* a topic exchange).

The upstream sets for the skytap exchange are pointed to each other, as
described in the Federation doc as a &quot;Pair of federated exchanges&quot;. For
routing keys, I'm using something of the form &quot;foo.XXX&quot;, where XXX is
either 'east' or 'west'.

On server 'A', I have a queue 'foo' bound to the skytap exchange, using a
routing key of 'foo.west'. On server 'B', I have a queue 'foo' bound to the
skytap exchange, using a routing key of 'foo.east'.

This all generally works as expected. In particular, I have a client app
running on server 'A' that publishes using the 'foo.west' routing key. In
other words, everything should be happening locally to server 'A'.

However, via the Management Web UI, I'm noticing that there seems to be
message traffic to server 'B'. In particular, on the Exchanges tab for
server 'B' if I select the 'skytap' exchange, I see:

Channel                                  | publish  | confirm
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at xxx.3.299.0</A>&gt; (1)       | 20/s      | 20/s

However (as I'd expect), no messages go into the 'foo' queue (or any other
queue) on server 'B'. Likewise, on the queue tab of server 'A', the queue
named &quot;skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at serverA.blah.blah</A>&quot;, shows incoming/deliver/ack
rates of 20/s as well.

This runs counter to what I'd expect from reading the Federation doc,
specifically: &quot;Therefore the federated exchange only receives messages for
which it has a subscription.&quot;

Am I misunderstanding something, or perhaps don't have things configured
optimally?

Thanks,

Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120912/6d73180e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120912/6d73180e/attachment.htm</A>&gt;
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022600.html">[rabbitmq-discuss] Cluster nodes stop/start order can lead	to	failures
</A></li>
	<LI>Next message: <A HREF="022460.html">[rabbitmq-discuss] Unintended message flow using federation?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22444">[ date ]</a>
              <a href="thread.html#22444">[ thread ]</a>
              <a href="subject.html#22444">[ subject ]</a>
              <a href="author.html#22444">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
