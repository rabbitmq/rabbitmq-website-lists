<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Often%20failed%20to%20produce%20message%20due%20to%0A%20TIMEOUT%20WAITING%20FOR%20ACK&In-Reply-To=%3C5062AC08.9060606%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022688.html">
   <LINK REL="Next"  HREF="022649.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Often%20failed%20to%20produce%20message%20due%20to%0A%20TIMEOUT%20WAITING%20FOR%20ACK&In-Reply-To=%3C5062AC08.9060606%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK">matthias at rabbitmq.com
       </A><BR>
    <I>Wed Sep 26 08:17:28 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022688.html">[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK
</A></li>
        <LI>Next message: <A HREF="022649.html">[rabbitmq-discuss] rabbitmq_web_stomp and rabbitmq_web_stomp_examples plugins for the current RabbitMQ release (2.8.6)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22689">[ date ]</a>
              <a href="thread.html#22689">[ thread ]</a>
              <a href="subject.html#22689">[ subject ]</a>
              <a href="author.html#22689">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wong,

On 26/09/12 07:18, Wong Kam Hoong wrote:
&gt;<i> *_Master Node Usage_*
</I>&gt;<i> Memory : 300M
</I>&gt;<i> CPU %  : Average 30%
</I>&gt;<i>
</I>&gt;<i> _*Slave Node Usage*_
</I>&gt;<i> Memory : 130M
</I>&gt;<i> CPU %  : Average 30%
</I>&gt;<i>
</I>&gt;<i> there are only few messages during that time, e.g.
</I>&gt;<i> 2012-09-26 03:28:32 =&gt; 4 messages
</I>
If the CPU is averaging 30% when the load is so low then the machines 
must be doing something else too. I notice from...

&gt;<i> =INFO REPORT==== 26-Sep-2012::03:29:37 ===
</I>&gt;<i> accepting AMQP connection &lt;0.8897.18&gt; (192.168.0.100:43836
</I>&gt;<i> &lt;<A HREF="http://192.168.0.100:43836/">http://192.168.0.100:43836/</A>&gt; -&gt; 192.168.0.100:5672
</I>&gt;<i> &lt;<A HREF="http://192.168.0.100:5672/">http://192.168.0.100:5672/</A>&gt;)
</I>
...that your clients are on the same machine as one of the nodes. Could 
it be that the machine was busy with other tasks, such as your application?

Also, 3:29 in the morning is just the sort of time that I'd expect 
systems to run various housekeeping tasks which could hammer the CPU or 
disk. Those can result in significant delays, particularly when your 
messages persistent.

I recommend increasing the timeout substantially, e.g. to 1 minute. That 
way if the problem really is just due to load it will go away.

&gt;<i> Are you using mirrored/HA queues at all?
</I>&gt;<i> Yes, I'm using HA in all queues.
</I>
We are aware of two bugs in 2.8.x that can cause confirms to go missing. 
One of them involved setting an x-message-ttl=0 on queues and use of the 
'immediate' flag on publish. So if you are doing that then, well, don't 
:<i>). The 2nd issue involves (re)starting of nodes. So check whether any 
</I>of the nodes in your cluster (re)started around the time of the problem.

Regards,

Matthias.
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022688.html">[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK
</A></li>
	<LI>Next message: <A HREF="022649.html">[rabbitmq-discuss] rabbitmq_web_stomp and rabbitmq_web_stomp_examples plugins for the current RabbitMQ release (2.8.6)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22689">[ date ]</a>
              <a href="thread.html#22689">[ thread ]</a>
              <a href="subject.html#22689">[ subject ]</a>
              <a href="author.html#22689">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
