<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] channel 1 badfun
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20channel%201%20badfun&In-Reply-To=%3C3CD80CD5-B243-4FB1-985D-EF77447F893C%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022224.html">
   <LINK REL="Next"  HREF="022226.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] channel 1 badfun</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20channel%201%20badfun&In-Reply-To=%3C3CD80CD5-B243-4FB1-985D-EF77447F893C%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] channel 1 badfun">tim at rabbitmq.com
       </A><BR>
    <I>Fri Sep 14 15:34:59 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022224.html">[rabbitmq-discuss] channel 1 badfun
</A></li>
        <LI>Next message: <A HREF="022226.html">[rabbitmq-discuss] rabbitmq - simple message sending error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22506">[ date ]</a>
              <a href="thread.html#22506">[ thread ]</a>
              <a href="subject.html#22506">[ subject ]</a>
              <a href="author.html#22506">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi John,

Any word on this? Did you check the things that I mentioned below and did you continue to see this behaviour?

Cheers,
Tim

On 1 Sep 2012, at 12:44, Tim Watson wrote:

&gt;<i> John, can you confirm a few things for me please.
</I>&gt;<i> 
</I>&gt;<i> 1. Are both nodes running the same version of rabbit and erlang
</I>&gt;<i> 
</I>&gt;<i> 2. Do the checksums for the rabbit_amqqueue.beam files (in the ebin directory within the broker install dir) match for both nodes
</I>&gt;<i> 
</I>&gt;<i> 3. is hipe compilation enabled
</I>&gt;<i> 
</I>&gt;<i> Cheers
</I>&gt;<i> 
</I>&gt;<i> On 30 Aug 2012, at 23:17, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi John
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On 25 Aug 2012, at 00:39, John Merrells wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> We have a two node cluster of RabbitMQ 2.8.6 on Erlang 5.8.5.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Sometimes one of the servers will peg the cpu and messages will
</I>&gt;&gt;&gt;<i> stop passing through the system. We don't have a reliable way of
</I>&gt;&gt;&gt;<i> reproducing this...
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> There are a few conditions that can cause this to happen. What other symptoms happen when this occurs? Does memory usage go up as well? Does the CPU usage come down eventually, or get stuck?
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> But, we do have some curious error reports in the logs. I've read
</I>&gt;&gt;&gt;<i> through rabbit_amqqueue.erl and delegate.erl and I think that
</I>&gt;&gt;&gt;<i> one server is telling the other to execute some function in 
</I>&gt;&gt;&gt;<i> rabbit_amqqueue... but I don't see why that function would be 
</I>&gt;&gt;&gt;<i> 'bad'.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Anyone any thoughts on the cpu issue, or this error report?
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Well we'd certainly like to get to the bottom of it asap. Can you please tell us a bit more about your setup please:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> a. cluster setup (i.e., disk vs ram nodes)
</I>&gt;&gt;<i> b. how many queues, are there any HA queues?
</I>&gt;&gt;<i> c. how you're interacting with the broker/cluster (publishers, consumers, exchanges and bindings and so on)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Also if there's any more of the logs (and sasl logs) for both nodes you're able to share, that would also help. If this occurs again and you're able to run `rabbitmqctl report` on the affected node, that would be great.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i> Tim
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022224.html">[rabbitmq-discuss] channel 1 badfun
</A></li>
	<LI>Next message: <A HREF="022226.html">[rabbitmq-discuss] rabbitmq - simple message sending error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22506">[ date ]</a>
              <a href="thread.html#22506">[ thread ]</a>
              <a href="subject.html#22506">[ subject ]</a>
              <a href="author.html#22506">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
