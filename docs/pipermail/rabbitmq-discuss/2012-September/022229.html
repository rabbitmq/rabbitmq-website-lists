<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20lib%3A%20up%20to%205%20threads%20created%20in%0A%20client%20when%20server%20publishes%20new%20message&In-Reply-To=%3C1346591180334-21751.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022226.html">
   <LINK REL="Next"  HREF="022235.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message</H1>
    <B>sharonbn</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20lib%3A%20up%20to%205%20threads%20created%20in%0A%20client%20when%20server%20publishes%20new%20message&In-Reply-To=%3C1346591180334-21751.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message">Sharon.Ben-Asher at AVG.com
       </A><BR>
    <I>Sun Sep  2 14:06:20 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022226.html">[rabbitmq-discuss] rabbitmq - simple message sending error
</A></li>
        <LI>Next message: <A HREF="022235.html">[rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22229">[ date ]</a>
              <a href="thread.html#22229">[ thread ]</a>
              <a href="subject.html#22229">[ subject ]</a>
              <a href="author.html#22229">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I created a simple client in Java, which consumes messages from a queue in a
loop.
what I see in the debugger, is that whenever I publish a new message into
queue &quot;q0&quot;
a new thread is opened in the client.  until 5 threads are open and running.
(this is besides the single thread named &quot;AMQP Connection&quot;)
the threads begin when the messages are published, not when they are
consumed...

is this expected behavior? can this be changed?

here is the stack trace, the client code is below.

Test at localhost:62105	
	Thread [main] (Suspended (breakpoint at line 19 in Test))	
		Test.main(String...) line: 19	
	Thread [AMQP Connection 204.236.192.179:1883] (Running)	
	Thread [pool-1-thread-1] (Running)	
	Thread [pool-1-thread-2] (Running)	
	Thread [pool-1-thread-3] (Running)	
	Thread [pool-1-thread-4] (Running)	
	Thread [pool-1-thread-5] (Running)	

thanks,
Sharon.


import com.rabbitmq.client.*;

public class Test
{
	static Connection connection;
	static Channel channel;
	static QueueingConsumer consumer;

	public static void main (String... args) throws Exception
	{
		ConnectionFactory factory = new ConnectionFactory();
		factory.setHost(Constants.server);
		factory.setPort(Constants.port);
		connection = factory.newConnection();
		channel = connection.createChannel();
		consumer = new QueueingConsumer(channel);
		channel.basicConsume(&quot;q0&quot;, true, consumer);

		for (int i = 0 ; i &lt; 10 ; i++) {
			QueueingConsumer.Delivery d = consumer.nextDelivery();
			System.out.println(&quot; got: &quot; + new String(d.getBody()));
			try { Thread.sleep(1000); } catch (InterruptedException e) {}
		}
	}
}




--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Java-client-lib-up-to-5-threads-created-in-client-when-server-publishes-new-message-tp21751.html">http://rabbitmq.1065348.n5.nabble.com/Java-client-lib-up-to-5-threads-created-in-client-when-server-publishes-new-message-tp21751.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022226.html">[rabbitmq-discuss] rabbitmq - simple message sending error
</A></li>
	<LI>Next message: <A HREF="022235.html">[rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22229">[ date ]</a>
              <a href="thread.html#22229">[ thread ]</a>
              <a href="subject.html#22229">[ subject ]</a>
              <a href="author.html#22229">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
