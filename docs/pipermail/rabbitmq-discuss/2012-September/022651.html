<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Often%20failed%20to%20produce%20message%20due%20to%0A%20TIMEOUT%20WAITING%20FOR%20ACK&In-Reply-To=%3C50614FE4.3010105%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022647.html">
   <LINK REL="Next"  HREF="022688.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Often%20failed%20to%20produce%20message%20due%20to%0A%20TIMEOUT%20WAITING%20FOR%20ACK&In-Reply-To=%3C50614FE4.3010105%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK">matthias at rabbitmq.com
       </A><BR>
    <I>Tue Sep 25 07:32:04 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022647.html">[rabbitmq-discuss] Often failed to produce message due to TIMEOUT	WAITING FOR ACK
</A></li>
        <LI>Next message: <A HREF="022688.html">[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22651">[ date ]</a>
              <a href="thread.html#22651">[ thread ]</a>
              <a href="subject.html#22651">[ subject ]</a>
              <a href="author.html#22651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wong,

On 25/09/12 03:46, Wong Kam Hoong wrote:
&gt;<i> com.rabbitmq.client.ShutdownSignalException: clean channel shutdown;
</I>&gt;<i> reason: #method&lt;channel.close&gt;(reply-code=406, reply-text=TIMEOUT
</I>&gt;<i> WAITING FOR ACK, class-id=0, method-id=0)
</I>&gt;<i>          at
</I>&gt;<i> com.rabbitmq.client.impl.ChannelN.waitForConfirms(ChannelN.java:182)
</I>&gt;<i>
</I>&gt;<i> Based on the log, the problem seems like related to &quot;*NACKS Received*&quot;
</I>&gt;<i> and &quot;*ChannelN*&quot; code throw the TimeoutException with reply-code *406
</I>&gt;<i> *(PRECONDITION_FAILED).
</I>
I don't think it has anything to do with nacks - unless you are actually 
seeing some exception mentioning nacks.

Looks like a straightforward timeout.

&gt;<i> I check all RabbitMQ servers are still working fine and I believe the
</I>&gt;<i> time I set for *waitForConfirmsOrDie *(10000) should be sufficient enough.
</I>
10s should indeed generally be long enough. But one can certainly 
envision scenarios where it won't be. What's the general health of your 
rabbit when this happens? Plenty of free memory and disk? No strange 
errors in the logs? Are you using mirrored/HA queues at all? Could there 
possibly be a spike, i.e. lots of messages getting published in a short 
space of time?


Regards,

Matthias.
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022647.html">[rabbitmq-discuss] Often failed to produce message due to TIMEOUT	WAITING FOR ACK
</A></li>
	<LI>Next message: <A HREF="022688.html">[rabbitmq-discuss] Often failed to produce message due to TIMEOUT WAITING FOR ACK
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22651">[ date ]</a>
              <a href="thread.html#22651">[ thread ]</a>
              <a href="subject.html#22651">[ subject ]</a>
              <a href="author.html#22651">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
