<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit won't restart - no next heap size	found
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20won%27t%20restart%20-%20no%20next%20heap%20size%0A%09found&In-Reply-To=%3CCAJ0FASqb90V8juMj06ZWyj47-H5KCUXUc%2B9Jr%3D-Cr%2BVLfxSg9g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022686.html">
   <LINK REL="Next"  HREF="022741.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit won't restart - no next heap size	found</H1>
    <B>Mike Khristo</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20won%27t%20restart%20-%20no%20next%20heap%20size%0A%09found&In-Reply-To=%3CCAJ0FASqb90V8juMj06ZWyj47-H5KCUXUc%2B9Jr%3D-Cr%2BVLfxSg9g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbit won't restart - no next heap size	found">mikekhristo at gmail.com
       </A><BR>
    <I>Fri Sep 28 22:06:56 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022686.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
        <LI>Next message: <A HREF="022741.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22740">[ date ]</a>
              <a href="thread.html#22740">[ thread ]</a>
              <a href="subject.html#22740">[ subject ]</a>
              <a href="author.html#22740">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Added a 200G swap... it used some of it, but still seg faults at
startup. Is there any way to split up the data on disk so I can get 2
rabbits up with half the data each?

Any other ideas on how to start this? I need urgent access to the 300M
queued messages

Thanks for the help so far...



On Tue, Sep 25, 2012 at 3:07 PM, Matthias Radestock
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt; wrote:
&gt;<i> Mike,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 25/09/12 22:10, Mike Khristo wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Upgraded to erlang 5.9.2.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> eheap_alloc: Cannot allocate 11037567056 bytes of memory (of type
</I>&gt;&gt;<i> &quot;heap&quot;).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That's better. Sort of.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> How can I get rabbit to start w/o using so much memory?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You probably can't.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> It was only using 30G out of the 68G avail while it was running
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That is more than the 0.4*total_memory default high watermark. Presumably
</I>&gt;<i> you have altered that threshold in the config. There's a reason it's set to
</I>&gt;<i> 0.4 by default - rabbit can take up all the rest temporarily in some
</I>&gt;<i> circumstances. So you were living on the edge somewhat.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> This is a production box and I need to get access to the 300M
</I>&gt;&gt;<i> messages asap.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I suggest you configure some temporary swap space. That should hopefully
</I>&gt;<i> allow rabbit to start up and recover all the messages. And, with any luck,
</I>&gt;<i> once it's done all that memory usage might drop off a bit.
</I>&gt;<i>
</I>&gt;<i> Would be good to keep an eye on memory use during that startup/recovery
</I>&gt;<i> phase and send us that plus the log files. And if you have some disk space
</I>&gt;<i> to spare where you can stash away a copy of the database dir before you
</I>&gt;<i> start rabbit that would be great.
</I>&gt;<i>
</I>&gt;<i> With all that info we might be able to identify whether we are missing a
</I>&gt;<i> trick somewhere in conserving memory during startup, and address that in a
</I>&gt;<i> future release.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>


-- 
-mk
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022686.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
	<LI>Next message: <A HREF="022741.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22740">[ date ]</a>
              <a href="thread.html#22740">[ thread ]</a>
              <a href="subject.html#22740">[ subject ]</a>
              <a href="author.html#22740">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
