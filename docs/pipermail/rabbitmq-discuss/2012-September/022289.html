<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Odd delay in federation exchanges being	recognized
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Odd%20delay%20in%20federation%20exchanges%20being%0A%09recognized&In-Reply-To=%3CCACLE7iyK-fcHGPdvVu_oGpr3Tj3DncojMV_o4wpNDgAiqnPaOA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022389.html">
   <LINK REL="Next"  HREF="022310.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Odd delay in federation exchanges being	recognized</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Odd%20delay%20in%20federation%20exchanges%20being%0A%09recognized&In-Reply-To=%3CCACLE7iyK-fcHGPdvVu_oGpr3Tj3DncojMV_o4wpNDgAiqnPaOA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Odd delay in federation exchanges being	recognized">mpietrek at skytap.com
       </A><BR>
    <I>Wed Sep  5 19:27:47 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022389.html">[rabbitmq-discuss] Publisher Authentication
</A></li>
        <LI>Next message: <A HREF="022310.html">[rabbitmq-discuss] Odd delay in federation exchanges being	recognized
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22289">[ date ]</a>
              <a href="thread.html#22289">[ thread ]</a>
              <a href="subject.html#22289">[ subject ]</a>
              <a href="author.html#22289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Let me admit up front that this is a weird one, but I'll press ahead on the
chance there's something there.

I've got two brokers I'm using the federation plugin with. I create a
single exchange 'skytap' on each broker, and make the 'skytap' exchange on
the other broker its upstream.

I create the rabbitmq.config file dynamically before starting each broker.
Starting from a blank slate (blowing away the mnesia directory), I launch
the two nodes concurrently.

When I go to the Exchange tab in either broker, I see two Exchanges as
expected:

   - federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.skytap.com</A> B
   - skytap


The type of the exchanges is x-federation-upstream and x-federation,
respectively. However, when first starting up, the type column is a red
color indicating a problem, and hovering over it, I get a message to the
effect of &quot;unknown exchange type x-federation. Messages published to this
exchange won't work.&quot;

Now, here's the interesting thing: I*f I wait long enough (usually around
10-15 minutes) **and without doing anything, the error state eventually
goes away* and the Exchanges seem happy. This has happened at least three
times, so it doesn't seem like a random fluke or that I accidentally did
something.

Here's my config file, FWIW...

[
{rabbit, [{cluster_nodes, [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>]}, {disk_free_limit, 104857600}]},
{mnesia, [{debug, trace}]},
{rabbitmq_federation, [{exchanges, [[{type, &quot;topic&quot;}, {upstream_set,
&quot;skytap_upstreams&quot;}, {virtual_host, &quot;/&quot;}, {exchange, &quot;skytap&quot;}]]},
{upstream_sets, [{&quot;skytap_upstreams&quot;, [[{connection, &quot;upstream-mq2&quot;},
{max_hops, 1}, {exchange, &quot;skytap&quot;}]]}]},
{connections, [{&quot;upstream-mq2&quot;, [{host, &quot;mq2&quot;}, {port, 5672}]}]}]}
].

Again, I realize this sounds a bit wonky, but it's happened enough times to
make me not think I'm crazy.

Thanks,

Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120905/c0a4933d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120905/c0a4933d/attachment.htm</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022389.html">[rabbitmq-discuss] Publisher Authentication
</A></li>
	<LI>Next message: <A HREF="022310.html">[rabbitmq-discuss] Odd delay in federation exchanges being	recognized
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22289">[ date ]</a>
              <a href="thread.html#22289">[ thread ]</a>
              <a href="subject.html#22289">[ subject ]</a>
              <a href="author.html#22289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
