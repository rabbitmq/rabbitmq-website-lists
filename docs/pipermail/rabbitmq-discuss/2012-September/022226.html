<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq - simple message sending error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20-%20simple%20message%20sending%20error&In-Reply-To=%3C003801cd88c5%2421be58f0%24653b0ad0%24%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022506.html">
   <LINK REL="Next"  HREF="022229.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq - simple message sending error</H1>
    <B>Nadeem M Nayeck</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20-%20simple%20message%20sending%20error&In-Reply-To=%3C003801cd88c5%2421be58f0%24653b0ad0%24%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq - simple message sending error">nadeem.m.nayeck at gmail.com
       </A><BR>
    <I>Sun Sep  2 05:40:43 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022506.html">[rabbitmq-discuss] channel 1 badfun
</A></li>
        <LI>Next message: <A HREF="022229.html">[rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22226">[ date ]</a>
              <a href="thread.html#22226">[ thread ]</a>
              <a href="subject.html#22226">[ subject ]</a>
              <a href="author.html#22226">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks to all you help guys.

Actually I screwed up - I didn&#8217;t need to declare a queue in my Spring Application Context if the queue was already declared on the Rabbit-MQ server.

Am new to Rabbit, don't bash me :)

 

Thanks

Nadeem

 

From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] On Behalf Of Matthias Reik
Sent: 31 August 2012 23:03
To: Discussions about RabbitMQ
Subject: Re: [rabbitmq-discuss] rabbitmq - simple message sending error

 

Or to put it more simple:
If you already have a queue, and you try to declare it again (which is ok), you will have to make sure that you declare it with the same parameters. As your stack trace shows, and as Mark mentions, in your case the x-message-ttl is the parameter that differs.

I want to take to use the occasion to ask a question in this context:
For most of the parameters this is a good approach, but for some parameters this can be a bit annoying, especially for the HA feature, where you specify over which servers a queue is distributed. For the TTL it's a bit similar
At least I feel sometimes that it would be good if the queue parameters could be adjusted at runtime, that the mirroring could be changed at runtime, without clients requiring an update.
The current approach we have taken is that clients don't define the queues anymore, but they are managed externally. Which is not ideal either :-( If anyone has a good recommendation, ideas, ... I would be interested to hear them

Cheers
Maze



On Fri, Aug 31, 2012 at 7:15 PM, Mark Fisher &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">markfisher at vmware.com</A>&gt; wrote:

The error message is showing that you are trying to declare a Queue where the value for 'x-message-ttl' does not match that of an existing Queue with the same name ('ml2gos_events').

  _____  

From: &quot;Nadeem M Nayeck&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nadeem.m.nayeck at gmail.com</A>&gt;
To: &quot;Discussions about RabbitMQ&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Sent: Friday, August 31, 2012 12:57:51 PM
Subject: [rabbitmq-discuss]  rabbitmq - simple message sending error



hi guys
I wrote a simple java client  sending a message to a queue on Rabbit
I get this:


org.springframework.amqp.rabbit.connection.CachingConnectionFactory$CachedChannelInvocationHandler.invoke(CachingConnectionFactory.java:331)
    at $Proxy9.queueDeclare(Unknown Source)
    at org.springframework.amqp.rabbit.core.RabbitAdmin.declareQueues(RabbitAdmin.java:342)
    at org.springframework.amqp.rabbit.core.RabbitAdmin.access$200(RabbitAdmin.java:46)
    at org.springframework.amqp.rabbit.core.RabbitAdmin$11.doInRabbit(RabbitAdmin.java:312)
    at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:600)
    ... 41 more
Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; reason: {#method&lt;channel.close&gt;(reply-code=406, reply-text=PRECONDITION_FAILED - inequivalent arg 'x-message-ttl'for queue 'ml2gos_events' in vhost 'OPLCPMED00': received none but current is the value '86400000' of type 'long', class-id=50, method-id=10), null, &quot;&quot;}
    at com.rabbitmq.utility.ValueOrException.getValue(ValueOrException.java:67)
    at com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:33)
    at com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:343)
    at com.rabbitmq.client.impl.AMQChannel.privateRpc(AMQChannel.java:216)
    at com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:118)
    ... 53 more
Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; reason: {#method&lt;channel.close&gt;(reply-code=406, reply-text=PRECONDITION_FAILED - inequivalent arg 'x-message-ttl'for queue 'ml2gos_events' in vhost 'OPLCPMED00': received none but current is the value '86400000' of type 'long', class-id=50, method-id=10), null, &quot;&quot;}
    at com.rabbitmq.client.impl.ChannelN.asyncShutdown(ChannelN.java:454)
    at com.rabbitmq.client.impl.ChannelN.processAsync(ChannelN.java:294)
    at com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel.java:144)
    at com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:91)
    at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:519)



Any pointers?

regards,
Nadeem

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>

 


_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120902/fa9c67e3/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120902/fa9c67e3/attachment.htm</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022506.html">[rabbitmq-discuss] channel 1 badfun
</A></li>
	<LI>Next message: <A HREF="022229.html">[rabbitmq-discuss] Java client lib: up to 5 threads created in client when server publishes new message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22226">[ date ]</a>
              <a href="thread.html#22226">[ thread ]</a>
              <a href="subject.html#22226">[ subject ]</a>
              <a href="author.html#22226">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
