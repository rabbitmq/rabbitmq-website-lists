<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Can't receive STOMP messages in ISAPI.dll under IIS 6 (Delphi/Habari client)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Can%27t%20receive%20STOMP%20messages%20in%20ISAPI.dll%20under%0A%20IIS%206%20%28Delphi/Habari%20client%29&In-Reply-To=%3Cf498ff31-759e-4179-adc7-249060ae353e%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022458.html">
   <LINK REL="Next"  HREF="022434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Can't receive STOMP messages in ISAPI.dll under IIS 6 (Delphi/Habari client)</H1>
    <B>Adam Hiler</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Can%27t%20receive%20STOMP%20messages%20in%20ISAPI.dll%20under%0A%20IIS%206%20%28Delphi/Habari%20client%29&In-Reply-To=%3Cf498ff31-759e-4179-adc7-249060ae353e%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Can't receive STOMP messages in ISAPI.dll under IIS 6 (Delphi/Habari client)">ahiler at gmail.com
       </A><BR>
    <I>Tue Sep 11 16:07:49 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022458.html">[rabbitmq-discuss] RabbitMQ Clustering with SSL
</A></li>
        <LI>Next message: <A HREF="022434.html">[rabbitmq-discuss] Can't receive STOMP messages in ISAPI.dll under IIS 6 (Delphi/Habari client)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22426">[ date ]</a>
              <a href="thread.html#22426">[ thread ]</a>
              <a href="subject.html#22426">[ subject ]</a>
              <a href="author.html#22426">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am having difficulty receiving messages inside my application which is an 
ISAPI dll written in Delphi.  I am not trying to use IIS for the RabbitMQ 
communication, but for other RPC purposes.

We use RemObjects for our RPC implementation.  The server side is compiled 
as an ISAPI DLL and runs under IIS (v6 and possibly v7).  My test 
environment is IIS 6 on Windows 2003 Server.  In that Delphi ISAPI dll we 
want to talk to a RabbitMQ broker for server-side work queue processing.  
Using the Habarisoft Delphi toolkit I can send messages fine, but I cannot 
receive them if the code is hosted as ISAPI under IIS.  It does not appear 
to be a normal firewall issue because I can compile the same code as a 
standalone EXE and it runs fine, sending and receiving, on the same Windows 
2003 server.  If I put a message in the queue first with the RabbitMQ HTTP 
Management Tool, then start the ISAPI server (by sending a command to it 
through its web-site, forcing the isapi dll to be loaded), I can see 
various things in the RabbitMQ console:

The connection that appears is STOMP 1.0.

 The &quot;name&quot; is 192.168.124.129:4298 -&gt; 192.168.124.128:61613

I can also see that the &quot;ready&quot; count goes from 1 to 0 and the 
&quot;unacknowledged&quot; count goes from 0 to 1 and stays there.  If I stop the 
app-pool, the message will revert to ready.  Again, I can run this exact 
code and get acknowledgements and reply messages if I do not run it as an 
ISAPI dll under IIS, but still run it on the same machine.

Thanks for any help.  

Adam Hiler

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120911/69360664/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120911/69360664/attachment.htm</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022458.html">[rabbitmq-discuss] RabbitMQ Clustering with SSL
</A></li>
	<LI>Next message: <A HREF="022434.html">[rabbitmq-discuss] Can't receive STOMP messages in ISAPI.dll under IIS 6 (Delphi/Habari client)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22426">[ date ]</a>
              <a href="thread.html#22426">[ thread ]</a>
              <a href="subject.html#22426">[ subject ]</a>
              <a href="author.html#22426">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
