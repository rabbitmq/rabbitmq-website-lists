<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%202.5.1%20Bad%20argument%20crash&In-Reply-To=%3C5065B938.8070609%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022731.html">
   <LINK REL="Next"  HREF="022733.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%202.5.1%20Bad%20argument%20crash&In-Reply-To=%3C5065B938.8070609%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash">simon at rabbitmq.com
       </A><BR>
    <I>Fri Sep 28 15:50:32 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022731.html">[rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash
</A></li>
        <LI>Next message: <A HREF="022733.html">[rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22732">[ date ]</a>
              <a href="thread.html#22732">[ thread ]</a>
              <a href="subject.html#22732">[ subject ]</a>
              <a href="author.html#22732">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi.

Yes, this looks like a bad message. Such a message can be created by a 
buggy plugin (as at the link below), or a buggy Erlang application using 
the direct client. It's very unlikely to have come in over AMQP.

So do you have messages arriving over things that are not AMQP?

Cheers, Simon

On 28/09/12 15:41, Chris Larsen wrote:
&gt;<i> Hey everyone, we had a problem today with 2.5.1 where the broker kept
</I>&gt;<i> crashing on us. We think it&#8217;s just a bad message but wanted to verify
</I>&gt;<i> that. The other nodes in our cluster don&#8217;t seem to be running into any
</I>&gt;<i> issues. I found something similar in the post about Stomp packets at
</I>&gt;<i> <A HREF="http://groups.google.com/group/rabbitmq-discuss/tree/browse_frm/month/2011-02/ce709a4aacac8569?rnum=31&amp;_done=%2Fgroup%2Frabbitmq-discuss%2Fbrowse_frm%2Fmonth%2F2011-02%3F">http://groups.google.com/group/rabbitmq-discuss/tree/browse_frm/month/2011-02/ce709a4aacac8569?rnum=31&amp;_done=%2Fgroup%2Frabbitmq-discuss%2Fbrowse_frm%2Fmonth%2F2011-02%3F</A>
</I>&gt;<i> &lt;<A HREF="http://groups.google.com/group/rabbitmq-discuss/tree/browse_frm/month/2011-02/ce709a4aacac8569?rnum=31&amp;_done=%2Fgroup%2Frabbitmq-discuss%2Fbrowse_frm%2Fmonth%2F2011-02%3F">http://groups.google.com/group/rabbitmq-discuss/tree/browse_frm/month/2011-02/ce709a4aacac8569?rnum=31&amp;_done=%2Fgroup%2Frabbitmq-discuss%2Fbrowse_frm%2Fmonth%2F2011-02%3F</A>&gt;
</I>&gt;<i> but we&#8217;re not pushing anything through Stomp that we&#8217;re aware of (though
</I>&gt;<i> the plugin is enabled on the system). What do ya&#8217;ll think? Thanks!
</I>&gt;<i>
</I>&gt;<i> Ubuntu 2.6.38-10-server #46~lucid1-Ubuntu
</I>&gt;<i>
</I>&gt;<i> Erlang: 1:13.b.3-dfsg-2ubuntu2.1
</I>&gt;<i>
</I>&gt;<i> =CRASH REPORT==== 28-Sep-2012::13:39:19 ===
</I>&gt;<i>
</I>&gt;<i> crasher:
</I>&gt;<i>
</I>&gt;<i> initial call: rabbit_writer:mainloop/2
</I>&gt;<i>
</I>&gt;<i> pid: &lt;0.1778.2&gt;
</I>&gt;<i>
</I>&gt;<i> registered_name: []
</I>&gt;<i>
</I>&gt;<i> exception error: bad argument
</I>&gt;<i>
</I>&gt;<i> in function size/1
</I>&gt;<i>
</I>&gt;<i> called as size(2)
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_binary_generator:encode_property/2
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_binary_generator:encode_properties/6
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_binary_generator:ensure_content_encoded/2
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_binary_generator:build_simple_content_frames/4
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_writer:assemble_frames/5
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_writer:internal_send_command_async/3
</I>&gt;<i>
</I>&gt;<i> in call from rabbit_writer:handle_message/2
</I>&gt;<i>
</I>&gt;<i> ancestors: [&lt;0.1777.2&gt;,&lt;0.1773.2&gt;,&lt;0.1771.2&gt;,rabbit_tcp_client_sup,
</I>&gt;<i>
</I>&gt;<i> rabbit_sup,&lt;0.127.0&gt;]
</I>&gt;<i>
</I>&gt;<i> messages: [{inet_reply,#Port&lt;0.6160&gt;,ok}]
</I>&gt;<i>
</I>&gt;<i> links: [&lt;0.1777.2&gt;]
</I>&gt;<i>
</I>&gt;<i> dictionary: []
</I>&gt;<i>
</I>&gt;<i> trap_exit: false
</I>&gt;<i>
</I>&gt;<i> status: running
</I>&gt;<i>
</I>&gt;<i> heap_size: 610
</I>&gt;<i>
</I>&gt;<i> stack_size: 24
</I>&gt;<i>
</I>&gt;<i> reductions: 210
</I>&gt;<i>
</I>&gt;<i> neighbours:
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 28-Sep-2012::13:39:19 ===
</I>&gt;<i>
</I>&gt;<i> Supervisor: {&lt;0.1777.2&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i> Context: child_terminated
</I>&gt;<i>
</I>&gt;<i> Reason: badarg
</I>&gt;<i>
</I>&gt;<i> Offender: [{pid,&lt;0.1778.2&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfa,{rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.6160&gt;,1,131072,
</I>&gt;<i>
</I>&gt;<i> rabbit_framing_amqp_0_9_1,&lt;0.1774.2&gt;]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i> =SUPERVISOR REPORT==== 28-Sep-2012::13:39:19 ===
</I>&gt;<i>
</I>&gt;<i> Supervisor: {&lt;0.1777.2&gt;,rabbit_channel_sup}
</I>&gt;<i>
</I>&gt;<i> Context: shutdown
</I>&gt;<i>
</I>&gt;<i> Reason: reached_max_restart_intensity
</I>&gt;<i>
</I>&gt;<i> Offender: [{pid,&lt;0.1778.2&gt;},
</I>&gt;<i>
</I>&gt;<i> {name,writer},
</I>&gt;<i>
</I>&gt;<i> {mfa,{rabbit_writer,start_link,
</I>&gt;<i>
</I>&gt;<i> [#Port&lt;0.6160&gt;,1,131072,
</I>&gt;<i>
</I>&gt;<i> rabbit_framing_amqp_0_9_1,&lt;0.1774.2&gt;]}},
</I>&gt;<i>
</I>&gt;<i> {restart_type,intrinsic},
</I>&gt;<i>
</I>&gt;<i> {shutdown,4294967295},
</I>&gt;<i>
</I>&gt;<i> {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022731.html">[rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash
</A></li>
	<LI>Next message: <A HREF="022733.html">[rabbitmq-discuss] Rabbitmq 2.5.1 Bad argument crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22732">[ date ]</a>
              <a href="thread.html#22732">[ thread ]</a>
              <a href="subject.html#22732">[ subject ]</a>
              <a href="author.html#22732">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
