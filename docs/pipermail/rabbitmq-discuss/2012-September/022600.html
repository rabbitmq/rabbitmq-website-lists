<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cluster nodes stop/start order can lead	to	failures
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20nodes%20stop/start%20order%20can%20lead%0A%09to%09failures&In-Reply-To=%3C87k3vn8qo0.wl%25francesco%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022584.html">
   <LINK REL="Next"  HREF="022444.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cluster nodes stop/start order can lead	to	failures</H1>
    <B>Francesco Mazzoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20nodes%20stop/start%20order%20can%20lead%0A%09to%09failures&In-Reply-To=%3C87k3vn8qo0.wl%25francesco%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Cluster nodes stop/start order can lead	to	failures">francesco at rabbitmq.com
       </A><BR>
    <I>Fri Sep 21 14:13:35 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022584.html">[rabbitmq-discuss] Cluster nodes stop/start order can lead to	failures
</A></li>
        <LI>Next message: <A HREF="022444.html">[rabbitmq-discuss] Unintended message flow using federation?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22600">[ date ]</a>
              <a href="thread.html#22600">[ thread ]</a>
              <a href="subject.html#22600">[ subject ]</a>
              <a href="author.html#22600">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At Thu, 20 Sep 2012 12:52:50 -0700 (PDT),
Jonathan Oliver wrote:
&gt;<i> Wouldn't having no less than 3 nodes help with this? I would imagine that the
</I>&gt;<i> last node, even if it's a RAM node, would have the latest exchanges, bindings,
</I>&gt;<i> etc. and would be able to deliver them authoritatively to the any node coming
</I>&gt;<i> back online.
</I>
The rule is simple: when all the nodes in a cluster go down, the last disc node
to go down must be the first one to go up.  This guarantees that the node with
the most up-to-date data is the first one to reappear.

Having a standalone RAM node is a different scenario, and one that should be
avoided (and in fact we try to prevent users from doing so, and we will do more
in the future), since when if the RAM node fails there will be loss of data,
moreover...

&gt;<i> Obviously changes to exchanges and bindings could not occur during the time
</I>&gt;<i> period during which no durable nodes are available
</I>
there's nothing that prevents bindings to be created on RAM nodes (but as said
before that's asking for loss of data).

&gt;<i> but I can't see why a RAM node couldn't help in this scenario.
</I>
Having 3 nodes simply defers the problem - the limitation of having to bring the
last node to go down up remains.  If the last node to stand is a RAM node then
if that node fails the first node to be brought up must be the last disc node
anyway.

&gt;<i> I haven't yet tested this scenario just yet, but it's simple enough to prove
</I>&gt;<i> with a few AWS cloud instances.
</I>
You don't need AWS instances, everything can be done locally, see
&lt;<A HREF="https://rabbitmq.com/clustering.html#single-machine">https://rabbitmq.com/clustering.html#single-machine</A>&gt;.

--
Francesco * Often in error, never in doubt
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022584.html">[rabbitmq-discuss] Cluster nodes stop/start order can lead to	failures
</A></li>
	<LI>Next message: <A HREF="022444.html">[rabbitmq-discuss] Unintended message flow using federation?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22600">[ date ]</a>
              <a href="thread.html#22600">[ thread ]</a>
              <a href="subject.html#22600">[ subject ]</a>
              <a href="author.html#22600">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
