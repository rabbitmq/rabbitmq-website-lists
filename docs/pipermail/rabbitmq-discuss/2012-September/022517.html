<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Confusing disk free space limit warning
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Confusing%20disk%20free%20space%20limit%20warning&In-Reply-To=%3C5056A79A.1030008%40vardr.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022529.html">
   <LINK REL="Next"  HREF="022518.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Confusing disk free space limit warning</H1>
    <B>Mark Hingston</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Confusing%20disk%20free%20space%20limit%20warning&In-Reply-To=%3C5056A79A.1030008%40vardr.com%3E"
       TITLE="[rabbitmq-discuss] Confusing disk free space limit warning">mark.hingston at vardr.com
       </A><BR>
    <I>Mon Sep 17 05:31:22 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022529.html">[rabbitmq-discuss] shovel ipv6 resolving dns name
</A></li>
        <LI>Next message: <A HREF="022518.html">[rabbitmq-discuss] Confusing disk free space limit warning
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22517">[ date ]</a>
              <a href="thread.html#22517">[ thread ]</a>
              <a href="subject.html#22517">[ subject ]</a>
              <a href="author.html#22517">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys,

I'm new to the list so please forgive me if I forgot any important info. 
First of all thanks to the rabbitmq devs for releasing a great product :)

I'm running Rabbitmq 2.8.4 and connecting to it with a celery / kombu / 
amqplib client. I'm running on Ubuntu 12.04.1 LTS on an Amazon EC2 
instance. After running for quite some time without issue, I saw this 
warning in the Rabbit log:


=INFO REPORT==== 16-Sep-2012::06:49:17 ===

=INFO REPORT==== 16-Sep-2012::06:49:17 ===
Disk free space limit now below limit. Free bytes:2000396288 
Limit:1000000000

=INFO REPORT==== 16-Sep-2012::06:49:17 ===
     alarm_handler: {clear,{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">resource_limit,disk,rabbit at mq1</A>}}


The amount of free space reported in the log is around twice the amount 
of space that rabbit requires in this instance, so I can't understand 
why this log occurred. Following this rabbit did seem to rate limit all 
clients, so I believe that it was acting as though we had breached the 
limit. There were no subsequent rabbit logs for the next ~24 hours. Not 
knowing much about rate limiting, etc, we actually restarted our amqp 
clients and then rabbit itself, after which everything seemed to start 
working fine again.

This is the output of rabbitmq status (done on the next day, which was 
when i realised there was a throttling issue):

Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A> ...
[{pid,828},
  {running_applications,
      [{rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;2.8.4&quot;},
       {xmerl,&quot;XML parser&quot;,&quot;1.2.10&quot;},
       {rabbitmq_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;2.8.4&quot;},
       {rabbitmq_mochiweb,&quot;RabbitMQ Mochiweb Embedding&quot;,&quot;2.8.4&quot;},
       {webmachine,&quot;webmachine&quot;,&quot;1.7.0-rmq2.8.4-hg&quot;},
       {mochiweb,&quot;MochiMedia Web Server&quot;,&quot;1.3-rmq2.8.4-git&quot;},
       {inets,&quot;INETS  CXC 138 49&quot;,&quot;5.7.1&quot;},
       {rabbitmq_stomp,&quot;Embedded Rabbit Stomp Adapter&quot;,&quot;2.8.4&quot;},
       {rabbit,&quot;RabbitMQ&quot;,&quot;2.8.4&quot;},
       {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.5&quot;},
       {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.7&quot;},
       {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.10&quot;},
       {amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.8.4&quot;},
       {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.5&quot;},
       {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.5&quot;}]},
  {os,{unix,linux}},
  {erlang_version,
      &quot;Erlang R14B04 (erts-5.8.5) [source] [64-bit] [smp:2:2] [rq:2] 
[async-threads:30] [kernel-poll:true]\n&quot;},
  {memory,
      [{total,35645328},
       {processes,12347544},
       {processes_used,12333872},
       {system,23297784},
       {atom,1548841},
       {atom_used,1538490},
       {binary,301336},
       {code,17536634},
       {ets,2116424}]},
  {vm_memory_high_watermark,0.3999999998873157},
  {vm_memory_limit,709948211},
  {disk_free_limit,1000000000},
  {disk_free,1808924672},
  {file_descriptors,
[{total_limit,924},{total_used,10},{sockets_limit,829},{sockets_used,6}]},
  {processes,[{limit,1048576},{used,225}]},
  {run_queue,0},
  {uptime,8035}]
...done.

Any help you guys could give with tracking down the cause of this issue 
would be appreciated.

Cheers,
Mark
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022529.html">[rabbitmq-discuss] shovel ipv6 resolving dns name
</A></li>
	<LI>Next message: <A HREF="022518.html">[rabbitmq-discuss] Confusing disk free space limit warning
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22517">[ date ]</a>
              <a href="thread.html#22517">[ thread ]</a>
              <a href="subject.html#22517">[ subject ]</a>
              <a href="author.html#22517">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
