<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20very%20slow%20%28or%20never%29%20shuts%20down&In-Reply-To=%3CB35E667D-AF62-4901-9556-38F7ABD9A49C%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022483.html">
   <LINK REL="Next"  HREF="022553.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20very%20slow%20%28or%20never%29%20shuts%20down&In-Reply-To=%3CB35E667D-AF62-4901-9556-38F7ABD9A49C%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down">tim at rabbitmq.com
       </A><BR>
    <I>Wed Sep 19 09:37:43 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022483.html">[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
</A></li>
        <LI>Next message: <A HREF="022553.html">[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22541">[ date ]</a>
              <a href="thread.html#22541">[ thread ]</a>
              <a href="subject.html#22541">[ subject ]</a>
              <a href="author.html#22541">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matt,

Just to keep you up to date - we're still investigating this. I will reply here once we've got to the bottom of it.

Cheers,
Tim

On 13 Sep 2012, at 21:05, Matt Pietrek wrote:

&gt;<i> Here you to Tim:
</I>&gt;<i> 
</I>&gt;<i> The scrubbed <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.log</A>:
</I>&gt;<i> --------
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i>     application: rabbitmq_management
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: permanent
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i>     application: rabbitmq_federation
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: permanent
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i> Stopping Rabbit
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i>     application: rabbitmq_management_agent
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: permanent
</I>&gt;<i> 
</I>&gt;<i> =WARNING REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i> Connection (&lt;0.1659.0&gt;) closing: internal error in channel (&lt;0.1666.0&gt;): shutdown
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i> stopped TCP Listener on 0.0.0.0:5672
</I>&gt;<i> 
</I>&gt;<i> =ERROR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i> ** Generic server &lt;0.1676.0&gt; terminating 
</I>&gt;<i> ** Last message in was {inet_async,#Port&lt;0.5748&gt;,5106,{error,etimedout}}
</I>&gt;<i> ** When Server state == {state,#Port&lt;0.5748&gt;,&lt;0.1671.0&gt;,&lt;0.1673.0&gt;,
</I>&gt;<i>                                {method,rabbit_framing_amqp_0_9_1},
</I>&gt;<i>                                none}
</I>&gt;<i> ** Reason for termination == 
</I>&gt;<i> ** {socket_error,etimedout}
</I>&gt;<i> 
</I>&gt;<i> =ERROR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i> ** Generic server &lt;0.1671.0&gt; terminating 
</I>&gt;<i> ** Last message in was {socket_error,etimedout}
</I>&gt;<i> ** When Server state == {state,amqp_network_connection,
</I>&gt;<i>                             {state,#Port&lt;0.5748&gt;,0,&lt;0.1675.0&gt;,131072,
</I>&gt;<i>                                 undefined,false},
</I>&gt;<i>                             &lt;0.1670.0&gt;,&lt;0.1673.0&gt;,
</I>&gt;<i>                             {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                                 &lt;&lt;&quot;/&quot;&gt;&gt;,&quot;slg1matt1.xyz.com&quot;,
</I>&gt;<i>                                 5672,0,0,0,infinity,none,
</I>&gt;<i>                                 [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                  #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                                 [],[]},
</I>&gt;<i>                             0,
</I>&gt;<i>                             [{&lt;&lt;&quot;capabilities&quot;&gt;&gt;,table,
</I>&gt;<i>                               [{&lt;&lt;&quot;publisher_confirms&quot;&gt;&gt;,bool,true},
</I>&gt;<i>                                {&lt;&lt;&quot;exchange_exchange_bindings&quot;&gt;&gt;,bool,true},
</I>&gt;<i>                                {&lt;&lt;&quot;basic.nack&quot;&gt;&gt;,bool,true},
</I>&gt;<i>                                {&lt;&lt;&quot;consumer_cancel_notify&quot;&gt;&gt;,bool,true}]},
</I>&gt;<i>                              {&lt;&lt;&quot;copyright&quot;&gt;&gt;,longstr,
</I>&gt;<i>                               &lt;&lt;&quot;Copyright (C) 2007-2012 VMware, Inc.&quot;&gt;&gt;},
</I>&gt;<i>                              {&lt;&lt;&quot;information&quot;&gt;&gt;,longstr,
</I>&gt;<i>                               &lt;&lt;&quot;Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/&quot;">http://www.rabbitmq.com/&quot;</A>&gt;&gt;},
</I>&gt;<i>                              {&lt;&lt;&quot;platform&quot;&gt;&gt;,longstr,&lt;&lt;&quot;Erlang/OTP&quot;&gt;&gt;},
</I>&gt;<i>                              {&lt;&lt;&quot;product&quot;&gt;&gt;,longstr,&lt;&lt;&quot;RabbitMQ&quot;&gt;&gt;},
</I>&gt;<i>                              {&lt;&lt;&quot;version&quot;&gt;&gt;,longstr,&lt;&lt;&quot;2.8.6&quot;&gt;&gt;}],
</I>&gt;<i>                             #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i>                             #Fun&lt;amqp_connection_sup.2.54430129&gt;,false}
</I>&gt;<i> ** Reason for termination == 
</I>&gt;<i> ** {socket_error,etimedout}
</I>&gt;<i> 
</I>&gt;<i> =ERROR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i> ** Generic server &lt;0.1657.0&gt; terminating
</I>&gt;<i> ** Last message in was {'EXIT',&lt;0.197.0&gt;,shutdown}
</I>&gt;<i> ** When Server state == {state,
</I>&gt;<i>                          {upstream,
</I>&gt;<i>                           {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                            &lt;&lt;&quot;/&quot;&gt;&gt;,&quot;slg1matt1.xyz.com&quot;,5672,0,
</I>&gt;<i>                            0,0,infinity,none,
</I>&gt;<i>                            [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                             #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                            [],[]},
</I>&gt;<i>                           &lt;&lt;&quot;skytap&quot;&gt;&gt;,1000,1,1,none,none,none,&quot;upstream-slg&quot;},
</I>&gt;<i>                          &lt;0.1671.0&gt;,&lt;0.1683.0&gt;,
</I>&gt;<i>                          &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.matt.xyz.com</A>&quot;&gt;&gt;,
</I>&gt;<i>                          &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.matt.xyz.com</A> A&quot;&gt;&gt;,
</I>&gt;<i>                          {0,nil},
</I>&gt;<i>                          115,
</I>&gt;<i>                          {dict,10,16,16,8,80,48,
</I>&gt;<i>                           {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
</I>&gt;<i>                           {{[],
</I>&gt;<i>                             [[{&lt;&lt;&quot;charon.us-east.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,1,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [],
</I>&gt;<i>                             [[{&lt;&lt;&quot;cmcmd.us-east.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,1,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}],
</I>&gt;<i>                              [{&lt;&lt;&quot;charon.us-west.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,2,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [],
</I>&gt;<i>                             [[{&lt;&lt;&quot;cmcmd.us-west.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,2,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;cmcmd&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [],
</I>&gt;<i>                             [[{&lt;&lt;&quot;system_test.us-east.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,1,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [],
</I>&gt;<i>                             [[{&lt;&lt;&quot;system_test.us-west.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,2,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;system_test&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [],[],
</I>&gt;<i>                             [[{&lt;&lt;&quot;unit_test.us-east.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,1,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [[{&lt;&lt;&quot;ConfigurationManager.us-east.default&quot;&gt;&gt;,
</I>&gt;<i>                                []}|
</I>&gt;<i>                               {set,1,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [[{&lt;&lt;&quot;unit_test.us-west.default&quot;&gt;&gt;,[]}|
</I>&gt;<i>                               {set,2,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;unit_test&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]],
</I>&gt;<i>                             [[{&lt;&lt;&quot;ConfigurationManager.us-west.default&quot;&gt;&gt;,
</I>&gt;<i>                                []}|
</I>&gt;<i>                               {set,2,16,16,8,80,48,
</I>&gt;<i>                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                 []},
</I>&gt;<i>                                {{[],[],[],[],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
</I>&gt;<i>                                    &lt;&lt;&quot;ConfigurationManager&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[],[],
</I>&gt;<i>                                  [{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
</I>&gt;<i>                                    &lt;&lt;&quot;federation: skytap -&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at slg1matt1.xyz.com</A> A&quot;&gt;&gt;}],
</I>&gt;<i>                                  [],[],[]}}}]]}}},
</I>&gt;<i>                          &lt;0.1659.0&gt;,&lt;0.1666.0&gt;,
</I>&gt;<i>                          {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;skytap&quot;&gt;&gt;},
</I>&gt;<i>                          {0,nil}}
</I>&gt;<i> ** Reason for termination == 
</I>&gt;<i> ** {undef,
</I>&gt;<i>        [{rabbit_federation_old_status,report,
</I>&gt;<i>             [{upstream,
</I>&gt;<i>                  {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,
</I>&gt;<i>                      &quot;slg1matt1.xyz.com&quot;,5672,0,0,0,infinity,
</I>&gt;<i>                      none,
</I>&gt;<i>                      [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                       #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                      [],[]},
</I>&gt;<i>                  &lt;&lt;&quot;skytap&quot;&gt;&gt;,1000,1,1,none,none,none,&quot;upstream-slg&quot;},
</I>&gt;<i>              {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;skytap&quot;&gt;&gt;},
</I>&gt;<i>              shutdown],
</I>&gt;<i>             []},
</I>&gt;<i>         {rabbit_federation_link,terminate,2,[]},
</I>&gt;<i>         {gen_server2,terminate,3,[]},
</I>&gt;<i>         {proc_lib,init_p_do_apply,3,[{file,&quot;proc_lib.erl&quot;},{line,227}]}]}
</I>&gt;<i> ** In 'terminate' callback with reason ==
</I>&gt;<i> ** shutdown
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>     application: rabbit
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: permanent
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>     application: os_mon
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: permanent
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>     application: mnesia
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: permanent
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i> Halting Erlang VM
</I>&gt;<i> --------
</I>&gt;<i> 
</I>&gt;<i> And the scrubbed <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1-sasl.log</A>:
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i>      Supervisor: {&lt;0.1664.0&gt;,amqp_channel_sup}
</I>&gt;<i>      Context:    child_terminated
</I>&gt;<i>      Reason:     shutdown
</I>&gt;<i>      Offender:   [{pid,&lt;0.1666.0&gt;},
</I>&gt;<i>                   {name,channel},
</I>&gt;<i>                   {mfa,{amqp_channel,start_link,
</I>&gt;<i>                                      [direct,&lt;0.1659.0&gt;,1,&lt;0.1665.0&gt;,
</I>&gt;<i>                                       #Fun&lt;amqp_channel_sup.0.24953263&gt;]}},
</I>&gt;<i>                   {restart_type,intrinsic},
</I>&gt;<i>                   {shutdown,4294967295},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:00:21 ===
</I>&gt;<i>      Supervisor: {&lt;0.1664.0&gt;,amqp_channel_sup}
</I>&gt;<i>      Context:    shutdown
</I>&gt;<i>      Reason:     reached_max_restart_intensity
</I>&gt;<i>      Offender:   [{pid,&lt;0.1666.0&gt;},
</I>&gt;<i>                   {name,channel},
</I>&gt;<i>                   {mfa,{amqp_channel,start_link,
</I>&gt;<i>                                      [direct,&lt;0.1659.0&gt;,1,&lt;0.1665.0&gt;,
</I>&gt;<i>                                       #Fun&lt;amqp_channel_sup.0.24953263&gt;]}},
</I>&gt;<i>                   {restart_type,intrinsic},
</I>&gt;<i>                   {shutdown,4294967295},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =CRASH REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>   crasher:
</I>&gt;<i>     initial call: amqp_main_reader:init/1
</I>&gt;<i>     pid: &lt;0.1676.0&gt;
</I>&gt;<i>     registered_name: []
</I>&gt;<i>     exception exit: {socket_error,etimedout}
</I>&gt;<i>       in function  gen_server:terminate/6 (gen_server.erl, line 747)
</I>&gt;<i>     ancestors: [&lt;0.1674.0&gt;,&lt;0.1670.0&gt;,amqp_sup,&lt;0.240.0&gt;]
</I>&gt;<i>     messages: []
</I>&gt;<i>     links: [&lt;0.1674.0&gt;]
</I>&gt;<i>     dictionary: []
</I>&gt;<i>     trap_exit: false
</I>&gt;<i>     status: running
</I>&gt;<i>     heap_size: 2584
</I>&gt;<i>     stack_size: 24
</I>&gt;<i>     reductions: 2529
</I>&gt;<i>   neighbours:
</I>&gt;<i> 
</I>&gt;<i> =CRASH REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>   crasher:
</I>&gt;<i>     initial call: amqp_gen_connection:init/1
</I>&gt;<i>     pid: &lt;0.1671.0&gt;
</I>&gt;<i>     registered_name: []
</I>&gt;<i>     exception exit: {socket_error,etimedout}
</I>&gt;<i>       in function  gen_server:terminate/6 (gen_server.erl, line 747)
</I>&gt;<i>     ancestors: [&lt;0.1670.0&gt;,amqp_sup,&lt;0.240.0&gt;]
</I>&gt;<i>     messages: []
</I>&gt;<i>     links: [&lt;0.1670.0&gt;,#Port&lt;0.5748&gt;]
</I>&gt;<i>     dictionary: []
</I>&gt;<i>     trap_exit: false
</I>&gt;<i>     status: running
</I>&gt;<i>     heap_size: 1597
</I>&gt;<i>     stack_size: 24
</I>&gt;<i>     reductions: 805
</I>&gt;<i>   neighbours:
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>      Supervisor: {&lt;0.1670.0&gt;,amqp_connection_sup}
</I>&gt;<i>      Context:    child_terminated
</I>&gt;<i>      Reason:     {socket_error,etimedout}
</I>&gt;<i>      Offender:   [{pid,&lt;0.1671.0&gt;},
</I>&gt;<i>                   {name,connection},
</I>&gt;<i>                   {mfa,
</I>&gt;<i>                       {amqp_gen_connection,start_link,
</I>&gt;<i>                           [amqp_network_connection,
</I>&gt;<i>                            {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                                &lt;&lt;&quot;/&quot;&gt;&gt;,&quot;slg1matt1.xyz.com&quot;,
</I>&gt;<i>                                5672,0,0,0,infinity,none,
</I>&gt;<i>                                [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                 #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                                [],[]},
</I>&gt;<i>                            #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i>                            #Fun&lt;amqp_connection_sup.2.54430129&gt;,[]]}},
</I>&gt;<i>                   {restart_type,intrinsic},
</I>&gt;<i>                   {shutdown,brutal_kill},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>      Supervisor: {&lt;0.1670.0&gt;,amqp_connection_sup}
</I>&gt;<i>      Context:    shutdown
</I>&gt;<i>      Reason:     reached_max_restart_intensity
</I>&gt;<i>      Offender:   [{pid,&lt;0.1671.0&gt;},
</I>&gt;<i>                   {name,connection},
</I>&gt;<i>                   {mfa,
</I>&gt;<i>                       {amqp_gen_connection,start_link,
</I>&gt;<i>                           [amqp_network_connection,
</I>&gt;<i>                            {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                                &lt;&lt;&quot;/&quot;&gt;&gt;,&quot;slg1matt1.xyz.com&quot;,
</I>&gt;<i>                                5672,0,0,0,infinity,none,
</I>&gt;<i>                                [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                 #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                                [],[]},
</I>&gt;<i>                            #Fun&lt;amqp_connection_sup.0.39273983&gt;,
</I>&gt;<i>                            #Fun&lt;amqp_connection_sup.2.54430129&gt;,[]]}},
</I>&gt;<i>                   {restart_type,intrinsic},
</I>&gt;<i>                   {shutdown,brutal_kill},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>      Supervisor: {&lt;0.1674.0&gt;,
</I>&gt;<i>                                            amqp_connection_type_sup}
</I>&gt;<i>      Context:    child_terminated
</I>&gt;<i>      Reason:     {socket_error,etimedout}
</I>&gt;<i>      Offender:   [{pid,&lt;0.1676.0&gt;},
</I>&gt;<i>                   {name,main_reader},
</I>&gt;<i>                   {mfa,
</I>&gt;<i>                       {amqp_main_reader,start_link,
</I>&gt;<i>                           [#Port&lt;0.5748&gt;,&lt;0.1671.0&gt;,&lt;0.1673.0&gt;,
</I>&gt;<i>                            {method,rabbit_framing_amqp_0_9_1}]}},
</I>&gt;<i>                   {restart_type,transient},
</I>&gt;<i>                   {shutdown,4294967295},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>      Supervisor: {&lt;0.1674.0&gt;,
</I>&gt;<i>                                            amqp_connection_type_sup}
</I>&gt;<i>      Context:    shutdown
</I>&gt;<i>      Reason:     reached_max_restart_intensity
</I>&gt;<i>      Offender:   [{pid,&lt;0.1676.0&gt;},
</I>&gt;<i>                   {name,main_reader},
</I>&gt;<i>                   {mfa,
</I>&gt;<i>                       {amqp_main_reader,start_link,
</I>&gt;<i>                           [#Port&lt;0.5748&gt;,&lt;0.1671.0&gt;,&lt;0.1673.0&gt;,
</I>&gt;<i>                            {method,rabbit_framing_amqp_0_9_1}]}},
</I>&gt;<i>                   {restart_type,transient},
</I>&gt;<i>                   {shutdown,4294967295},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =CRASH REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>   crasher:
</I>&gt;<i>     initial call: gen:init_it/6
</I>&gt;<i>     pid: &lt;0.1657.0&gt;
</I>&gt;<i>     registered_name: []
</I>&gt;<i>     exception exit: {undef,
</I>&gt;<i>                         [{rabbit_federation_old_status,report,
</I>&gt;<i>                              [{upstream,
</I>&gt;<i>                                   {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                                       &lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,
</I>&gt;<i>                                       &quot;slg1matt1.xyz.com&quot;,
</I>&gt;<i>                                       5672,0,0,0,infinity,none,
</I>&gt;<i>                                       [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                        #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                                       [],[]},
</I>&gt;<i>                                   &lt;&lt;&quot;skytap&quot;&gt;&gt;,1000,1,1,none,none,none,
</I>&gt;<i>                                   &quot;upstream-slg&quot;},
</I>&gt;<i>                               {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;skytap&quot;&gt;&gt;},
</I>&gt;<i>                               shutdown],
</I>&gt;<i>                              []},
</I>&gt;<i>                          {rabbit_federation_link,terminate,2,[]},
</I>&gt;<i>                          {gen_server2,terminate,3,[]},
</I>&gt;<i>                          {proc_lib,init_p_do_apply,3,
</I>&gt;<i>                              [{file,&quot;proc_lib.erl&quot;},{line,227}]}]}
</I>&gt;<i>       in function  gen_server2:terminate/3 
</I>&gt;<i>     ancestors: [&lt;0.197.0&gt;,&lt;0.194.0&gt;,rabbit_federation_link_sup_sup,
</I>&gt;<i>                   rabbit_federation_sup,rabbit_sup,&lt;0.143.0&gt;]
</I>&gt;<i>     messages: [{'DOWN',#Ref&lt;0.0.0.8909&gt;,process,&lt;0.1683.0&gt;,shutdown}]
</I>&gt;<i>     links: []
</I>&gt;<i>     dictionary: []
</I>&gt;<i>     trap_exit: true
</I>&gt;<i>     status: running
</I>&gt;<i>     heap_size: 2584
</I>&gt;<i>     stack_size: 24
</I>&gt;<i>     reductions: 9640
</I>&gt;<i>   neighbours:
</I>&gt;<i> 
</I>&gt;<i> =SUPERVISOR REPORT==== 13-Sep-2012::12:17:00 ===
</I>&gt;<i>      Supervisor: {&lt;0.197.0&gt;,
</I>&gt;<i>                                            rabbit_federation_link_sup}
</I>&gt;<i>      Context:    shutdown_error
</I>&gt;<i>      Reason:     {undef,
</I>&gt;<i>                      [{rabbit_federation_old_status,report,
</I>&gt;<i>                           [{upstream,
</I>&gt;<i>                                {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                                    &lt;&lt;&quot;/&quot;&gt;&gt;,
</I>&gt;<i>                                    &quot;slg1matt1.xyz.com&quot;,5672,0,
</I>&gt;<i>                                    0,0,infinity,none,
</I>&gt;<i>                                    [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                     #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                                    [],[]},
</I>&gt;<i>                                &lt;&lt;&quot;skytap&quot;&gt;&gt;,1000,1,1,none,none,none,
</I>&gt;<i>                                &quot;upstream-slg&quot;},
</I>&gt;<i>                            {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;skytap&quot;&gt;&gt;},
</I>&gt;<i>                            shutdown],
</I>&gt;<i>                           []},
</I>&gt;<i>                       {rabbit_federation_link,terminate,2,[]},
</I>&gt;<i>                       {gen_server2,terminate,3,[]},
</I>&gt;<i>                       {proc_lib,init_p_do_apply,3,
</I>&gt;<i>                           [{file,&quot;proc_lib.erl&quot;},{line,227}]}]}
</I>&gt;<i>      Offender:   [{pid,&lt;0.1657.0&gt;},
</I>&gt;<i>                   {name,
</I>&gt;<i>                       {upstream,
</I>&gt;<i>                           {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                               &lt;&lt;&quot;/&quot;&gt;&gt;,&quot;slg1matt1.xyz.com&quot;,
</I>&gt;<i>                               5672,0,0,0,infinity,none,
</I>&gt;<i>                               [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                               [],[]},
</I>&gt;<i>                           &lt;&lt;&quot;skytap&quot;&gt;&gt;,1000,1,1,none,none,none,
</I>&gt;<i>                           &quot;upstream-slg&quot;}},
</I>&gt;<i>                   {mfa,
</I>&gt;<i>                       {rabbit_federation_link,start_link,
</I>&gt;<i>                           [{{upstream,
</I>&gt;<i>                                 {amqp_params_network,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;&quot;guest&quot;&gt;&gt;,
</I>&gt;<i>                                     &lt;&lt;&quot;/&quot;&gt;&gt;,
</I>&gt;<i>                                     &quot;slg1matt1.xyz.com&quot;,5672,
</I>&gt;<i>                                     0,0,0,infinity,none,
</I>&gt;<i>                                     [#Fun&lt;amqp_auth_mechanisms.plain.3&gt;,
</I>&gt;<i>                                      #Fun&lt;amqp_auth_mechanisms.amqplain.3&gt;],
</I>&gt;<i>                                     [],[]},
</I>&gt;<i>                                 &lt;&lt;&quot;skytap&quot;&gt;&gt;,1000,1,1,none,none,none,
</I>&gt;<i>                                 &quot;upstream-slg&quot;},
</I>&gt;<i>                             {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;skytap&quot;&gt;&gt;}}]}},
</I>&gt;<i>                   {restart_type,{permanent,1}},
</I>&gt;<i>                   {shutdown,4294967295},
</I>&gt;<i>                   {child_type,worker}]
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> 
</I>&gt;<i> On Thu, Sep 13, 2012 at 12:30 PM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> On 13 Sep 2012, at 20:26, Matt Pietrek wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; We &quot;own&quot; the network in that it's a direct connection between two datacenters. It's not a particularly high speed connection, but it's generally reliable. I've done some ping tests between the two nodes and while an occasional packet will drop every once in awhile, it's not a really horrible connection. The average ping round trip time is areound 80ms.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'd be surprised if it's a dropped packet, as the shutdown on both brokers seems to consistently take a long time. I just reproed this again, and one broker took 1000 seconds to shut down, while the other took 995. I have the logs from this repro, but a quick glance doesn't show anything radically different. Let me know if there's anything else I can supply.
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> Ok - do send the second pair of logs (or a scrubbed version if you need to hide private data) please, as we're keen to get to the bottom of this.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120919/f14419ad/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120919/f14419ad/attachment.htm</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022483.html">[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
</A></li>
	<LI>Next message: <A HREF="022553.html">[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22541">[ date ]</a>
              <a href="thread.html#22541">[ thread ]</a>
              <a href="subject.html#22541">[ subject ]</a>
              <a href="author.html#22541">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
