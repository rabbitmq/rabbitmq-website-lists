<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit won't restart - no next heap size	found
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20won%27t%20restart%20-%20no%20next%20heap%20size%0A%09found&In-Reply-To=%3C50622B0D.7050709%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022683.html">
   <LINK REL="Next"  HREF="022740.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit won't restart - no next heap size	found</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20won%27t%20restart%20-%20no%20next%20heap%20size%0A%09found&In-Reply-To=%3C50622B0D.7050709%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Rabbit won't restart - no next heap size	found">matthias at rabbitmq.com
       </A><BR>
    <I>Tue Sep 25 23:07:09 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022683.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
        <LI>Next message: <A HREF="022740.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22686">[ date ]</a>
              <a href="thread.html#22686">[ thread ]</a>
              <a href="subject.html#22686">[ subject ]</a>
              <a href="author.html#22686">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mike,

On 25/09/12 22:10, Mike Khristo wrote:
&gt;<i> Upgraded to erlang 5.9.2.
</I>&gt;<i>
</I>&gt;<i> eheap_alloc: Cannot allocate 11037567056 bytes of memory (of type
</I>&gt;<i> &quot;heap&quot;).
</I>
That's better. Sort of.

&gt;<i> How can I get rabbit to start w/o using so much memory?
</I>
You probably can't.

&gt;<i> It was only using 30G out of the 68G avail while it was running
</I>
That is more than the 0.4*total_memory default high watermark. 
Presumably you have altered that threshold in the config. There's a 
reason it's set to 0.4 by default - rabbit can take up all the rest 
temporarily in some circumstances. So you were living on the edge somewhat.

&gt;<i> This is a production box and I need to get access to the 300M
</I>&gt;<i> messages asap.
</I>
I suggest you configure some temporary swap space. That should hopefully 
allow rabbit to start up and recover all the messages. And, with any 
luck, once it's done all that memory usage might drop off a bit.

Would be good to keep an eye on memory use during that startup/recovery 
phase and send us that plus the log files. And if you have some disk 
space to spare where you can stash away a copy of the database dir 
before you start rabbit that would be great.

With all that info we might be able to identify whether we are missing a 
trick somewhere in conserving memory during startup, and address that in 
a future release.


Regards,

Matthias.
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022683.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
	<LI>Next message: <A HREF="022740.html">[rabbitmq-discuss] Rabbit won't restart - no next heap size	found
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22686">[ date ]</a>
              <a href="thread.html#22686">[ thread ]</a>
              <a href="subject.html#22686">[ subject ]</a>
              <a href="author.html#22686">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
