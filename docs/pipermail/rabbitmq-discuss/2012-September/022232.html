<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to achieve HA consumers?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20achieve%20HA%20consumers%3F&In-Reply-To=%3C87mx17mp36.wl%25francesco%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022231.html">
   <LINK REL="Next"  HREF="022233.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to achieve HA consumers?</H1>
    <B>Francesco Mazzoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20achieve%20HA%20consumers%3F&In-Reply-To=%3C87mx17mp36.wl%25francesco%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] How to achieve HA consumers?">francesco at rabbitmq.com
       </A><BR>
    <I>Mon Sep  3 10:29:33 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022231.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
        <LI>Next message: <A HREF="022233.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22232">[ date ]</a>
              <a href="thread.html#22232">[ thread ]</a>
              <a href="subject.html#22232">[ subject ]</a>
              <a href="author.html#22232">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Andrea,

At Mon, 3 Sep 2012 09:16:41 +0000,
Rosa, Andrea (HP Cloud Services) wrote:
&gt;<i> Sorry but I didn't understand your solution:
</I>&gt;<i> 
</I>&gt;<i> &gt;  * You create a second queue that we'll call &quot;token queue&quot;, and you
</I>&gt;<i> &gt;publish one
</I>&gt;<i> &gt;    dummy message in it, with acks enabled.  Then, a consumer wishing to
</I>&gt;<i> &gt;consume
</I>&gt;<i> &gt;    from your queue, will:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;      - Consume from the token queue
</I>&gt;<i> &gt;      - Start consuming from the actual queue
</I>&gt;<i> &gt;      - When shutting down, publish a dummy message to the token queue
</I>&gt;<i> 
</I>&gt;<i> Which consumer needs to consume from the &quot;token queue&quot;?
</I>&gt;<i> When the second consumer will start to consume messages?
</I>
Please note that the last step is wrong (see Matthias correction).

That said, whoever wants to consume from the queue needs to consume from the
token queue first.  In the case of the OP, the main consumer will start first,
and the second right after it.  This way, the second will be blocked until the
first consumer dies/quits and the token message will be requeued.

I hope this makes it clearer for you.

--
Francesco * Often in error, never in doubt
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022231.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
	<LI>Next message: <A HREF="022233.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22232">[ date ]</a>
              <a href="thread.html#22232">[ thread ]</a>
              <a href="subject.html#22232">[ subject ]</a>
              <a href="author.html#22232">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
