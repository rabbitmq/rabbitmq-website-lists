<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] limit number of messages buffered in memory	in new persister
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20limit%20number%20of%20messages%20buffered%20in%20memory%0A%09in%20new%20persister&In-Reply-To=20100302112309.GO1641%40mrnibble.lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006520.html">
   <LINK REL="Next"  HREF="006532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] limit number of messages buffered in memory	in new persister</H1>
    <B>alex chen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20limit%20number%20of%20messages%20buffered%20in%20memory%0A%09in%20new%20persister&In-Reply-To=20100302112309.GO1641%40mrnibble.lshift.net"
       TITLE="[rabbitmq-discuss] limit number of messages buffered in memory	in new persister">chen650 at yahoo.com
       </A><BR>
    <I>Wed Mar  3 08:39:31 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006520.html">[rabbitmq-discuss] limit number of messages buffered in memory in new persister
</A></li>
        <LI>Next message: <A HREF="006532.html">[rabbitmq-discuss] limit number of messages buffered in memory in new persister
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6531">[ date ]</a>
              <a href="thread.html#6531">[ thread ]</a>
              <a href="subject.html#6531">[ subject ]</a>
              <a href="author.html#6531">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks a lot Matthew!  We will try commit on every 100 publishes as you suggested.  One problem is that client needs to keep a copy of uncommitted messages to handle broker restart.

Looking into the server's src code, it seems to me rabbit_reader is the process that accepts the publish.  I am wondering when it sends to message to the message writer's inbox, can it wait for the ack from message writer?  then it can stop accepting publish from client if there are too many un-acked messages.   This will simplify client's publish a lot - no need to use commit, and no need to listen for channel flow.

thanks.

-alex



&gt;<i> From: Matthew Sackman &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at lshift.net</A>&gt;
</I>
&gt;<i> There is no such parameter, and adding one would be very tricky indeed
</I>giving the number of processes and corresponding mailboxes that messages
can sit in. Your best bet to limit this is to use transactions - if you
put the publishing channel in transactional mode, and then issue a
commit every, say, 100 publishes,


      


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006520.html">[rabbitmq-discuss] limit number of messages buffered in memory in new persister
</A></li>
	<LI>Next message: <A HREF="006532.html">[rabbitmq-discuss] limit number of messages buffered in memory in new persister
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6531">[ date ]</a>
              <a href="thread.html#6531">[ thread ]</a>
              <a href="subject.html#6531">[ subject ]</a>
              <a href="author.html#6531">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
