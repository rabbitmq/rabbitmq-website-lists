<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Writing applications using AMQP,	basic design 	questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Writing%20applications%20using%20AMQP%2C%0A%09basic%20design%20%09questions&In-Reply-To=cedc0c091003031025p1146093byef88a2ac2c40fd1d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006537.html">
   <LINK REL="Next"  HREF="006548.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Writing applications using AMQP,	basic design 	questions</H1>
    <B>Garrett Smith</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Writing%20applications%20using%20AMQP%2C%0A%09basic%20design%20%09questions&In-Reply-To=cedc0c091003031025p1146093byef88a2ac2c40fd1d%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Writing applications using AMQP,	basic design 	questions">g at rre.tt
       </A><BR>
    <I>Wed Mar  3 23:32:09 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006537.html">[rabbitmq-discuss] Writing applications using AMQP,	basic design questions
</A></li>
        <LI>Next message: <A HREF="006548.html">[rabbitmq-discuss] Writing applications using AMQP,	basic design 	questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6546">[ date ]</a>
              <a href="thread.html#6546">[ thread ]</a>
              <a href="subject.html#6546">[ subject ]</a>
              <a href="author.html#6546">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Laurens,

On Wed, Mar 3, 2010 at 12:25 PM, Laurens Van Houtven &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lvh at laurensvh.be</A>&gt; wrote:
&gt;<i> ello :-)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm stuck with a few questions about designing an application based on
</I>&gt;<i> AMQP messaging, and using RabbitMQ. I'm not sure how much of this is
</I>&gt;<i> RabbitMQ-specific. If anyone knows a mailing list for AMQP apps in
</I>&gt;<i> general or if rabbitmq-discuss is not the right place for this
</I>&gt;<i> message, please feel free to shout :-)
</I>
-snip-

&gt;<i> Because people want to track one particular mobile client, I think the
</I>&gt;<i> AMQP thing to do would be to have one queue per mobile client. As long
</I>&gt;<i> as we're not in AMQP/1.0 which gets rid of them there would be one
</I>&gt;<i> exchange, and the routing key would be the unique identifier of the
</I>&gt;<i> mobile client. (Sending everything to everyone is not acceptable,
</I>&gt;<i> because the information is sensitive.)
</I>
Are you talking about exposing your mobile apps to external users via AMQP?

What's the nature of the public API. Is there a performance or
throughput requirement?

Working with an AMQP interface is considerably different from working
with a REST or other RPC interface. If you're thinking along these
lines, I'd float the idea by some of your users to see what they think
of the approach. That's also assuming you have a technical requirement
to use AMQP for the public interface.

&gt;<i> I'm interested in temporary queues, so that only active mobile clients
</I>&gt;<i> have queues running. I have read the AMQP specification (v0.8),
</I>&gt;<i> section 2.2.8, specifically the part about temporary queues.
</I>&gt;<i> Apparently any client can cause a queue to be created, and the client
</I>&gt;<i> creating it is responsible for creating a consumer on it.
</I>
You can create your queues as exclusive, which tells rabbit to auto
delete the queue once the declaring connection is closed.

&gt;<i> I take it that means letting the mobile clients (with untrustworthy
</I>&gt;<i> software) do AMQP is a bad idea. The first idea is to have an
</I>&gt;<i> HTTP(S)-&gt;AMQP bridge. Why?
</I>&gt;<i>
</I>&gt;<i> 1. As said before, if the client (soon to be producer) is responsible
</I>&gt;<i> for creating a consumer, a malicious client might refuse to do that.
</I>&gt;<i> I'm not sure what happens then. The bridge could be responsible for
</I>&gt;<i> creating the consumer that persists the data. I trust the bridge.
</I>&gt;<i> Giving the clients the power to start a consumer that talks to a
</I>&gt;<i> database sounds like a disaster waiting to happen anyway.
</I>&gt;<i> 2. Perhaps not every stupid mobile client can be taught to speak AMQP,
</I>&gt;<i> but *everyone* understands HTTPS.
</I>&gt;<i> 3. AMQP seems to be more catered towards doing messaging for your
</I>&gt;<i> app's internals, as opposed to, for example, XMPP or perhaps even
</I>&gt;<i> STOMP, which is built for going to clients.
</I>&gt;<i> 4. Authentication through pre-shared certs means client's don't have
</I>&gt;<i> to tell me who they are (and, as a result, attackers can't lie about
</I>&gt;<i> it either).
</I>&gt;<i> 5. Not telling the mobile clients about my internal messaging means
</I>&gt;<i> more flexibility to change it later.
</I>
Running AMQP on mobile clients would make for a cool demo, but you're
thinking is sound here.

&gt;<i> Basically, I don't really know anything about AMQP yet, and I might be
</I>&gt;<i> completely wrong about everything, but I'd love to pick you guy's
</I>&gt;<i> brains' on the matter. I have some other question regarding the other
</I>&gt;<i> end (monitoring in browsers: an AMQP -&gt; HTTPS bridge to do Comet-like
</I>&gt;<i> things), but perhaps asking too many questions about that when I don't
</I>&gt;<i> even know the mobile client side makes sense is any good might be a
</I>&gt;<i> bit of a waste of time.
</I>
In my block-and-tackle understanding, you would opt for a message
oriented approach for a few reasons:

- Out-of-the-box support async application patterns
- Latency requirements prohibit the use of expensive transports like HTTP
- Flexibility in provisioning services

(I hope others weigh in with their thoughts here.)

You may very well be fine with an HTTP server and a database. I think
you'll want to be pretty clear on why you need a broker, else you'll
end up spending a lot of time horsing around with the tech for minimal
or no payoff. You've already signed up for an HTTPS interface for the
mobile clients, so that's a sunk cost.

&gt;<i>
</I>&gt;<i> Thanks for reading this admittedly long post, and thanks in advance
</I>&gt;<i> for your comments and insights :-)
</I>&gt;<i> Laurens
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>
Garrett


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006537.html">[rabbitmq-discuss] Writing applications using AMQP,	basic design questions
</A></li>
	<LI>Next message: <A HREF="006548.html">[rabbitmq-discuss] Writing applications using AMQP,	basic design 	questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6546">[ date ]</a>
              <a href="thread.html#6546">[ thread ]</a>
              <a href="subject.html#6546">[ subject ]</a>
              <a href="author.html#6546">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
