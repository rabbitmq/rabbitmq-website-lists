<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumer stop to receive messages but continue listening queue problem.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Consumer%20stop%20to%20receive%20messages%20but%0A%20continue%20listening%20queue%20problem.&In-Reply-To=5ef296b31003111900r577611f7vf1a2bdf1b4752db1%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006629.html">
   <LINK REL="Next"  HREF="006632.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumer stop to receive messages but continue listening queue problem.</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Consumer%20stop%20to%20receive%20messages%20but%0A%20continue%20listening%20queue%20problem.&In-Reply-To=5ef296b31003111900r577611f7vf1a2bdf1b4752db1%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Consumer stop to receive messages but continue listening queue problem.">matthew at lshift.net
       </A><BR>
    <I>Fri Mar 12 12:24:32 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006629.html">[rabbitmq-discuss] Consumer stop to receive messages but	continue listening queue problem.
</A></li>
        <LI>Next message: <A HREF="006632.html">[rabbitmq-discuss] Consumer stop to receive messages but	continue listening queue problem.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6630">[ date ]</a>
              <a href="thread.html#6630">[ thread ]</a>
              <a href="subject.html#6630">[ subject ]</a>
              <a href="author.html#6630">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Gustavo,

On Fri, Mar 12, 2010 at 12:00:52AM -0300, Gustavo Aquino wrote:
&gt;<i> I'm running my RabbitMQ in one server, and have 2 producers in other server
</I>&gt;<i> posting ~2000 messages /s , and have 4 consumers in one server and other 4
</I>&gt;<i> in other.
</I>
Ok, so we have 4kHz in, in total? Are the 8 consumers all off the same
queue, or do they all have their own queues? If the former, then the sum
out should also be 4kHz, whereas the latter would suggest the sum out
should be 8 * 4kHz = 32kHz. That's faster than I've seen Rabbit running
before, but then again you do have very meaty hardware.

&gt;<i> When I start the test all running fine.. but my 8 consumers not consuming
</I>&gt;<i> the queue in same speed that we are posting, ok it is the proposal of test,
</I>&gt;<i> all 8 consumers are working harder consuming ~1200 /s when my doubt happen,
</I>&gt;<i> all the time that I run this test it happen, when my queue have a size about
</I>&gt;<i> 200.000 messages all consumers at one of this two consume's machine stop to
</I>&gt;<i> receive messages, all of them, and if I restart all consumers in this
</I>&gt;<i> machine anyone get any messages from Rabbit,all are connected but don't get
</I>&gt;<i> any message, now if instead of restart this consumers I stop the other four
</I>&gt;<i> consumers in the other machine he come back to receive messages...
</I>&gt;<i> 
</I>&gt;<i> Anybody here have any feelings about what is happen ?
</I>
That's very interesting. You don't say which client you're using though.
Also, when this happens, what does Rabbit record in the logs?

&gt;<i> My Rabbit server have 20Gb of memory and 4 processors P6 and when this drop
</I>&gt;<i> happen Rabbit are consuming 80% of Proc and 20% of Memory.
</I>
I have never used Power6 machines, and I have no idea how well Erlang
(or Rabbit) runs on it, I'm afraid.

&gt;<i> My message size is about 180~200Kbytes
</I>
Those are pretty big. If my maths above is right, that means that you're
trying to push (4+32)*1000*200*1024 = 7372,800,000 bytes / sec, which is
6.8GB/s or 55Gb/s. That's enourmous. I suspect maybe my maths is wrong
and you actually have all 8 consumers bound to the same 1 queue?

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006629.html">[rabbitmq-discuss] Consumer stop to receive messages but	continue listening queue problem.
</A></li>
	<LI>Next message: <A HREF="006632.html">[rabbitmq-discuss] Consumer stop to receive messages but	continue listening queue problem.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6630">[ date ]</a>
              <a href="thread.html#6630">[ thread ]</a>
              <a href="subject.html#6630">[ subject ]</a>
              <a href="author.html#6630">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
