<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] High Availability
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20High%20Availability&In-Reply-To=5ef296b31003180859k6ce1d8cp91705810e88e570d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006677.html">
   <LINK REL="Next"  HREF="006687.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] High Availability</H1>
    <B>Alvaro Videla</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20High%20Availability&In-Reply-To=5ef296b31003180859k6ce1d8cp91705810e88e570d%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] High Availability">videlalvaro at gmail.com
       </A><BR>
    <I>Fri Mar 19 05:38:39 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006677.html">[rabbitmq-discuss] High Availability
</A></li>
        <LI>Next message: <A HREF="006687.html">[rabbitmq-discuss] High Availability
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6686">[ date ]</a>
              <a href="thread.html#6686">[ thread ]</a>
              <a href="subject.html#6686">[ subject ]</a>
              <a href="author.html#6686">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gustavo,

1) We haven't benchmarked the overhead of using LVS

2) As you can find out from our numbers, not that much, and it's hard to tell, since during peak time we have 20.000 concurrent users, but maybe in the morning the are only 5000. And at the end it depends on what they do on the site. Soon we plan to add other 300.000 messages a day.

3) The queues are persistent. 

This means that if one node is out of the LVS, anyway we can reach that node by it's exact IP. In our setup that node won't receive more messages &#8211;because the publishers connect to the LVS IP&#8211;, but we are able to consume the old ones.

4) We don't share storage. 1 message will go to one queue, there's no replication. The sysadmin is working on solving that. I prefer to try something &quot;native&quot; i.e.: provided or implemented inside RabbitMQ. He's researching some Linux technologies for filesystems.

Regards,

Alvaro

P. S. My second name is Gustavo, so this feels like replying to myself :)

On Mar 18, 2010, at 11:59 PM, Gustavo Aquino wrote:

&gt;<i> Alvaro,
</I>&gt;<i> 
</I>&gt;<i> Thank you so much to report your experience.
</I>&gt;<i> 
</I>&gt;<i> I will take a look about LVM now.. so I would like to do some questions that I'm in doubt about your solution. Do you know what is the overhead using LVM ? How many messages per second do you have ? Do you use a persistent queue ? If yes how did you to continue consume queue when one node is down ?
</I>&gt;<i> 
</I>&gt;<i> You are using a heartbeat, so how you share inter nodes the same disk ? NFS ? Storage ?
</I>&gt;<i> 
</I>&gt;<i> Thank you so much for your report it helps a lot.
</I>&gt;<i> 
</I>&gt;<i> Best wishes. 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Mar 18, 2010 at 12:17 PM, Alvaro Videla &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">videlalvaro at gmail.com</A>&gt; wrote:
</I>&gt;<i> Sorry, It's me again, forgot to add something :)
</I>&gt;<i> 
</I>&gt;<i> That LVS setup was live tested when we got the dreaded out of memory problem, when the Erlang VM just crash shutting down the RabbitMQ node. One of the brokers went down, but we continued working from the other.
</I>&gt;<i> 
</I>&gt;<i> After that we decided to finally upgrade our RabbitMQ server to the latest version
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Mar 18, 2010 at 11:05 PM, Alvaro Videla &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">videlalvaro at gmail.com</A>&gt; wrote:
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> After some feedback by @etrepum at Twitter, I feel that what I commented needs some more details, so I did some research about LVS, since that set up was done by one of our sysadmins.
</I>&gt;<i> 
</I>&gt;<i> You can check about a LVS setup here: 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.ibiblio.org/oswg/oswg-nightly/oswg/en_US.ISO_8859-1/articles/cluster-howto/cluster-howto/index.html">http://www.ibiblio.org/oswg/oswg-nightly/oswg/en_US.ISO_8859-1/articles/cluster-howto/cluster-howto/index.html</A>
</I>&gt;<i> 
</I>&gt;<i> From that page:
</I>&gt;<i> 
</I>&gt;<i> &quot;the role of the active router is to redirect service requests from the virtual server address to the real servers.&quot; [...] 
</I>&gt;<i> 
</I>&gt;<i> &quot;The active router dynamically monitors the health of the real servers, and the workload on each.&quot; [...] 
</I>&gt;<i> 
</I>&gt;<i> &quot;If a real server becomes disabled, the active router stops sending jobs to the server until it returns to normal operation.&quot;
</I>&gt;<i> 
</I>&gt;<i> I hope this mails clarifies things up,
</I>&gt;<i> 
</I>&gt;<i> Alvaro
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mar 18, 2010, at 7:57 PM, Gustavo Aquino wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I have done this question before for many peoples, without success, because I don't found (Documentation, discussion lists and etc) any way to do High Availability with RabbitMQ without a lot of workaround, so exist a way to do HA with RabbitMQ without implementing a lot of stuffs by client side, like recreating queues when node down, recreating configurations, recreating client connections and etc ?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> What's recommendation from RabbitMQ to do HA ?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Someone here have done some HA implementation to RabbitMQ ?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Regards.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Gustavo
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100319/e41bd53f/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100319/e41bd53f/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006677.html">[rabbitmq-discuss] High Availability
</A></li>
	<LI>Next message: <A HREF="006687.html">[rabbitmq-discuss] High Availability
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6686">[ date ]</a>
              <a href="thread.html#6686">[ thread ]</a>
              <a href="subject.html#6686">[ subject ]</a>
              <a href="author.html#6686">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
