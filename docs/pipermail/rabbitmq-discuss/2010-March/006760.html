<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ crashed again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20crashed%20again&In-Reply-To=46C25109-EDD6-4721-9B08-79ADEFE6BC6A%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006756.html">
   <LINK REL="Next"  HREF="006761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ crashed again</H1>
    <B>Michael Bridgen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20crashed%20again&In-Reply-To=46C25109-EDD6-4721-9B08-79ADEFE6BC6A%40gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ crashed again">mikeb at lshift.net
       </A><BR>
    <I>Wed Mar 31 23:11:20 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006756.html">[rabbitmq-discuss] RabbitMQ crashed again
</A></li>
        <LI>Next message: <A HREF="006761.html">[rabbitmq-discuss] RabbitMQ crashed again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6760">[ date ]</a>
              <a href="thread.html#6760">[ thread ]</a>
              <a href="subject.html#6760">[ subject ]</a>
              <a href="author.html#6760">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ian,

 &gt; Hello all, I'm trying to track down the cause of another RabbitMQ
 &gt; crash that happened to me last night.  The server was clearly no
 &gt; longer working correctly (my consumers stopped receiving messages)
 &gt; but the main producer seemed to be able to continue to publish
 &gt; messages.  On a dev machine I started the producer and then stopped
 &gt; the server entirely, and it stopped producing as expected, but the
 &gt; live producer seemed to think the server was still working, and
 &gt; happily published messages to the broken rabbitmq instance, which is
 &gt; extremely troubling.
 &gt;
 &gt; This does not seem to be caused by the same issue that caused my
 &gt; previous crash (hitting channel limits) - the crash log is different,
 &gt; but still has a reference to a system limit being reached.  RabbitMQ
 &gt; seems very stable for others, so I'm guessing there's some issue in
 &gt; my code base causing this.  Since I disabled the code that was
 &gt; causing all the extra channels to be created, I'm at a bit of a loss
 &gt; trying to understand what is causing these crashes and how I can
 &gt; prevent them - this is starting to become a huge problem.

As you deduced, it looks like you're running into a limit on the number 
of processes.  This is possible with some usages, and there's examples 
of how to increase process limits not long ago on the list which may be 
worth trying out.

For troubleshooting your application, you could keep an eye on the 
things that use processes -- principally connections, channels and 
queues -- by using rabbitmqctl with 'list_connections', 'list_channels' 
(new in 1.7.latest), or 'list_queues'.  (&quot;watch&quot; could be your friend 
here; e.g., &quot;watch -n4 rabbitmqctl list_channels&quot;.)

My first suspicion is that channels are somehow remaining open.  If the 
problem remains mysterious, it'll be a help if you can post (ideally 
minimal!) app code.  Happy to look at it.

Please do let us know if this helps, and how you get on.

Regards,
Michael


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006756.html">[rabbitmq-discuss] RabbitMQ crashed again
</A></li>
	<LI>Next message: <A HREF="006761.html">[rabbitmq-discuss] RabbitMQ crashed again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6760">[ date ]</a>
              <a href="thread.html#6760">[ thread ]</a>
              <a href="subject.html#6760">[ subject ]</a>
              <a href="author.html#6760">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
