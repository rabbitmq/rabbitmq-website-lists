<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Stop producer and queue continue growing...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Stop%20producer%20and%20queue%20continue%20growing...&In-Reply-To=5ef296b31003111910n4bdb279buf67751a31c5526e9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006621.html">
   <LINK REL="Next"  HREF="006628.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Stop producer and queue continue growing...</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Stop%20producer%20and%20queue%20continue%20growing...&In-Reply-To=5ef296b31003111910n4bdb279buf67751a31c5526e9%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Stop producer and queue continue growing...">matthew at lshift.net
       </A><BR>
    <I>Fri Mar 12 10:49:41 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006621.html">[rabbitmq-discuss] Stop producer and queue continue growing...
</A></li>
        <LI>Next message: <A HREF="006628.html">[rabbitmq-discuss] Stop producer and queue continue growing...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6622">[ date ]</a>
              <a href="thread.html#6622">[ thread ]</a>
              <a href="subject.html#6622">[ subject ]</a>
              <a href="author.html#6622">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Mar 12, 2010 at 12:10:38AM -0300, Gustavo Aquino wrote:
&gt;<i> So my question is why queue continue to grow ?
</I>
Messages can be buffered in many places. In your case, you're seeing
messages buffered in the channel, before they reach the queue. This is
why the numbers reported by things like rabbitmqctl list_queues should
not really be trusted - there can be many messages which you believe are
published but have not yet reached the queue - eg client TCP stack,
kernel buffers, network buffers, and the channel in the server. Try
sending a sync operation down, eg a queue.declare to (re)declare the
queue. That has to go through the channel behind all the backed up
publishes. When you get the queue.declare_ok back, it will contain a
different number - the number of messages in the queue at the point at
which the queue.declare was processed.

You also didn't mention which branch/version of rabbit you're using, nor
if you're publishing persistent messages (persistent messages to a
transient queue still *have* to be written to disk because they should
survive a crash, though not a clean shutdown).

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006621.html">[rabbitmq-discuss] Stop producer and queue continue growing...
</A></li>
	<LI>Next message: <A HREF="006628.html">[rabbitmq-discuss] Stop producer and queue continue growing...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6622">[ date ]</a>
              <a href="thread.html#6622">[ thread ]</a>
              <a href="subject.html#6622">[ subject ]</a>
              <a href="author.html#6622">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
