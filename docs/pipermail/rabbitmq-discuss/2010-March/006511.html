<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Draft of C++ rabbitMq API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Draft%20of%20C%2B%2B%20rabbitMq%20API&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006510.html">
   <LINK REL="Next"  HREF="006543.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Draft of C++ rabbitMq API</H1>
    <B>Alexandre Kalendarev</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Draft%20of%20C%2B%2B%20rabbitMq%20API&In-Reply-To="
       TITLE="[rabbitmq-discuss] Draft of C++ rabbitMq API">akalend at mail.ru
       </A><BR>
    <I>Mon Mar  1 11:55:57 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006510.html">[rabbitmq-discuss] Queue durability
</A></li>
        <LI>Next message: <A HREF="006543.html">[rabbitmq-discuss] Draft of C++ rabbitMq API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6511">[ date ]</a>
              <a href="thread.html#6511">[ thread ]</a>
              <a href="subject.html#6511">[ subject ]</a>
              <a href="author.html#6511">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi colleagues!

I developed the C++ interface, see below

If You have any ideas - wellcome! 

the Draft of C++ API

Connection class

class AMQPConnection {
	AMQPConnection();
	AMQPConnection( string connectionString );
	AMQPConnection( string connectionString , int channelNumber);
	
	void Open( string connectionString );
	void Open( string connectionString , int channelNumber);
	
	void Close();
	
	setChannel(int channelNumber);
}

const AMQPCnnDebug = &quot;localhost:5672&quot;

the example:
	AMQPConnection * cnn = new AMQPConnection(  &quot;guest:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">guest at localhost</A>:5673/somevhost&quot; );

	default connection string is &quot;localhost:5672&quot;
	the debug connection string   AMQPCnnDebug  is &quot;guest:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">guest at localhost</A>:5673&quot; 


Exchange class

class AMQPExchange {
	AMQPExchange( AMQPConnection * cnn );
	
	void Declare(string name);
	void Declare(string name, int parms);
	void Declare(string name, int parms, map properties ); // *)?

	void Delete(string name)
}

the parms is set of constants as AMQPDurable, AMQPAutodelete etc
the type of exchange is AMQPDirect default or AMQPFanout, or AMQPTopic 


Example:
	AMQPExchange * ex = new  AMQPExchange(new AMQPConnection());
	ex-&gt;Declare(&quot;my_exchange&quot;);

Queue class

class AMQPQueue {
	AMQPQueue(AMQPConnection * cnn);

	void Declare(string name);
	void Declare(string name, int parms);
	void Declare(string name, int parms, map properties ); // *)?

	void Delete(string name)

	void Purge (string name)

}
the parms is set of constants as AMQPDurable, AMQPAutodelete etc


example:
	AMQPEQueue * qu = new AMQPEQueue(new AMQPConnection());
	qu-&gt;Declare(&quot;qu_mylife&quot;);

Basic class:

class AMQPBasic {
	AMQPBasic(AMQPConnection * cnn);

	void setProperty(string name, string value  );
	void setProperty(string name, int value  );

	void Bind (string exchangeName, string queueName );
	void Bind (string exchangeName, string queueName , string key);

	void Publish( string exchangeName, string message);
	void Publish( string exchangeName, uchar* message);
	void Publish( string exchangeName, string message, string key);
	void Publish( string exchangeName, uchar* message, string key);

	void Cancel( string queueName)

	AMQPMessage *  Get( string queueName)


	void Ask( string queueName ) ????

	void Reject( string queueName ) ????

	void Consume( string queueName , IAMQPCallback * callbackName );

}

class AMQPMessage  ????
 int timestamp
 int expiration
 string contentType
 string deliveryTag
 uchar* message or string 
 int number // internal number message
 string exchange 
 string key
....

 IAMQPCallback is abstract class, the callbackName is derived from IAMQPCallback.
after received each the message call the method run of derived AMQPCallback base class.


*) properties is map of addional property, it will to resolve in future.

Examples:

	// publish message	
	AMQPConnection * cnn = new AMQPConnection();
	AMQPExchange * ex = new  AMQPExchange(cnn);
	ex-&gt;Declare(&quot;my_exchange&quot;, AMQPTopic);
	basic = new AMQPBasic(cnn);
	basic-&gt;Bind(&quot;my_exchange&quot;, &quot;qu_mylive&quot;, &quot;news&quot; );
	basic-&gt;Publish(&quot;my_exchange&quot;, &quot;12345&quot; , &quot;news&quot;);


	// consume message
	class printMessage : IAMQPCallback {
		void run (uchar* message) {
			std::cout &lt;&lt; message &lt;&lt; std::endl;
		}
	}
	
	AMQPConnection * cnn = new AMQPConnection();
	basic = new AMQPBasic(cnn);
	printMessage * pm = new printMessage();
	basic-&gt;Consume(&quot;qu_mylive&quot;, pm); 




unrealise classes(it will to resolve in future):  AMQPFile, AMQPStreams etc ...

exceptions:

AMQPnoConnectException
AMQPnonAutorizeException
AMQPnotFoundException 
AMQPnotAllowedException 
...
AMQPerrorException (AMQPcommandInvalidException  )







</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006510.html">[rabbitmq-discuss] Queue durability
</A></li>
	<LI>Next message: <A HREF="006543.html">[rabbitmq-discuss] Draft of C++ rabbitMq API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6511">[ date ]</a>
              <a href="thread.html#6511">[ thread ]</a>
              <a href="subject.html#6511">[ subject ]</a>
              <a href="author.html#6511">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
