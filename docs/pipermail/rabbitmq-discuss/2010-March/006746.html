<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] &quot;Returning&quot; values
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%22Returning%22%20values&In-Reply-To=4BB0C9C2.2070302%40zopyx.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006745.html">
   <LINK REL="Next"  HREF="006753.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] &quot;Returning&quot; values</H1>
    <B>Garrett Smith</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%22Returning%22%20values&In-Reply-To=4BB0C9C2.2070302%40zopyx.com"
       TITLE="[rabbitmq-discuss] &quot;Returning&quot; values">g at rre.tt
       </A><BR>
    <I>Mon Mar 29 17:46:50 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006745.html">[rabbitmq-discuss] &quot;Returning&quot; values
</A></li>
        <LI>Next message: <A HREF="006753.html">[rabbitmq-discuss] &quot;Returning&quot; values
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6746">[ date ]</a>
              <a href="thread.html#6746">[ thread ]</a>
              <a href="subject.html#6746">[ subject ]</a>
              <a href="author.html#6746">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You can use a single reply queue for a caller - use the correlation ID
property to associate a response from a server with a particular call.
The server will need to pass the request correlation ID to the
response and you'll know who it came from.

Also, rabbit cleans up auto deleted reply queues very nicely, so you
really only need queues for running calls. But I prefer using
correlation IDs in any case.

Garrett

On Mon, Mar 29, 2010 at 10:39 AM, Andreas Jung &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lists at zopyx.com</A>&gt; wrote:
&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> First, I know about the explained concepts very well.
</I>&gt;<i>
</I>&gt;<i> The main question is: assuming you have 10k visitors on a portal and
</I>&gt;<i> each visitor would need a queue...you might run out of resources (I was
</I>&gt;<i> able to create 16k queues at a time before I got errors). So this
</I>&gt;<i> approach does not scale very well. Of course you can create individual
</I>&gt;<i> queues for each client on request and as needed...no idea about the
</I>&gt;<i> overhead for creating and destroying queues...
</I>&gt;<i>
</I>&gt;<i> Andreas
</I>&gt;<i>
</I>&gt;<i> Garrett Smith wrote:
</I>&gt;&gt;<i> On Sun, Mar 28, 2010 at 11:56 PM, Andreas Jung &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lists at zopyx.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> Hi there,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am aware that a message queue does not support returning value. Is there a
</I>&gt;&gt;&gt;<i> pattern for the following usecase:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> User submits a data set through the browser to the backend application. The
</I>&gt;&gt;&gt;<i> backend puts the data into a queue in order to be processed by one of a
</I>&gt;&gt;&gt;<i> worker processes running on some other machine taking requests from the
</I>&gt;&gt;&gt;<i> queue.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The client application should be notified or take notice when the data has
</I>&gt;&gt;&gt;<i> been processed and get hold of some return value.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I was thinking for having some client specific 'return queue' where the
</I>&gt;&gt;&gt;<i> worker could insert the return value...however the number of queues is
</I>&gt;&gt;&gt;<i> limited ( by RAM?) and the number of possible clients may exceed the number
</I>&gt;&gt;&gt;<i> of maximum queues....so not a solution..
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Is there a pattern for implementing this usecase with RabbitMQ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As Alvaro stated, you setup a queue that's used to communicate results
</I>&gt;&gt;<i> from you backend to your front end.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is a super common pattern, sometimes referred to as RPC.
</I>&gt;&gt;<i> Depending on the AMQP client's you're using, you should be able to
</I>&gt;&gt;<i> find some examples of RPC like communication over AMQP. Look around
</I>&gt;&gt;<i> for a tell tale &quot;reply-to&quot; queue property being set somewhere in code.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Short of a code example (definitely try to locate one - folks here can
</I>&gt;&gt;<i> help based on your language environment), it looks like this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - Client wants to &quot;call&quot; a server and get a response, so sends a
</I>&gt;&gt;<i> message with the reply-to property set to a queue, generally one
</I>&gt;&gt;<i> declared specifically that call or for any response back to that
</I>&gt;&gt;<i> particular client
</I>&gt;&gt;<i> - Server (can be zero, one or more depending on the exchange and
</I>&gt;&gt;<i> routing rules) receives the message, does some work, notes the
</I>&gt;&gt;<i> reply-to queue and sends a response message via amq.direct to that
</I>&gt;&gt;<i> queue
</I>&gt;&gt;<i> - Client either polls or is otherwise notified that the a response
</I>&gt;&gt;<i> arrived in its reply-to queue
</I>&gt;&gt;<i> - Client needs to handle a &quot;no reply&quot; condition via a timeout
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It's not uncommon for a client to block during the entire sequence,
</I>&gt;&gt;<i> which is probably what you want to do for a traditional web front end.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I find it helpful to think of AMQP (and any messaging scheme) as
</I>&gt;&gt;<i> essentially the same as email exchanges: You have a request, you send
</I>&gt;&gt;<i> an email message to one or more people who can help. Those people have
</I>&gt;&gt;<i> your reply-to address and will get back to you in due time, or not.
</I>&gt;&gt;<i> You impatiently check you in box for the results :)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It's definitely more work than a traditional RPC setup (SOAP, REST,
</I>&gt;&gt;<i> etc.) but it gives a ton more leverage over your architecture.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Garrett
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> - --
</I>&gt;<i> ZOPYX Limited &#160; &#160; &#160; &#160; &#160; &#160; &#160;\ zopyx group
</I>&gt;<i> Charlottenstr. 37/1 &#160; &#160; &#160; &#160; \ The full-service network for your
</I>&gt;<i> D-72070 T&#252;bingen &#160; &#160; &#160; &#160; &#160; &#160; \ Python, Zope and Plone projects
</I>&gt;<i> www.zopyx.com, <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">info at zopyx.com</A> \ www.zopyxgroup.com
</I>&gt;<i> - ------------------------------------------------------------------------
</I>&gt;<i> E-Publishing, Python, Zope &amp; Plone development, Consulting
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v1.4.10 (Darwin)
</I>&gt;<i> Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org/">http://enigmail.mozdev.org/</A>
</I>&gt;<i>
</I>&gt;<i> iEYEARECAAYFAkuwycIACgkQCJIWIbr9KYwnOgCfXMPiVL6aXX06M1jWQVO96hbx
</I>&gt;<i> EUYAnjek2cPw5y9kIc/gOnVp8kqF4Tj6
</I>&gt;<i> =NAU8
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006745.html">[rabbitmq-discuss] &quot;Returning&quot; values
</A></li>
	<LI>Next message: <A HREF="006753.html">[rabbitmq-discuss] &quot;Returning&quot; values
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6746">[ date ]</a>
              <a href="thread.html#6746">[ thread ]</a>
              <a href="subject.html#6746">[ subject ]</a>
              <a href="author.html#6746">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
