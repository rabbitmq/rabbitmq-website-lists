<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss]  rabbit cluster keeps crashing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20rabbit%20cluster%20keeps%20crashing&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006717.html">
   <LINK REL="Next"  HREF="006728.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss]  rabbit cluster keeps crashing</H1>
    <B>LoOoD</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20rabbit%20cluster%20keeps%20crashing&In-Reply-To="
       TITLE="[rabbitmq-discuss]  rabbit cluster keeps crashing">gman at colo247.com
       </A><BR>
    <I>Thu Mar 25 01:07:09 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006717.html">[rabbitmq-discuss] queues scheme at startup time
</A></li>
        <LI>Next message: <A HREF="006728.html">[rabbitmq-discuss] Client connection timeout
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6718">[ date ]</a>
              <a href="thread.html#6718">[ thread ]</a>
              <a href="subject.html#6718">[ subject ]</a>
              <a href="author.html#6718">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
We've been having a problem with our rabbit servers. We have a cluster setup,
one disk node and two ram nodes. All clients only connect to
the ram nodes. The ram nodes eventually stop accepting new connections.

The only way to fix so far is to restart the affected ram node. 

We're running 1.7.2-1 (installed via the deb repo) on ubuntu 8.10 64bit.

Here is are some crash reports from rabbit-sasl.log:

=CRASH REPORT==== 24-Mar-2010::17:17:49 ===
  crasher:
    pid: &lt;0.8294.1&gt;
    registered_name: []
    exception exit: {{{<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nodedown,rabbit at job3</A>},
                      {gen_server2,call,[&lt;6902.26064.102&gt;,stat,infinity]}},
                     [{gen_server2,call,3},
                      {rabbit_misc,with_exit_handler,2},
                      {rabbit_channel,return_queue_declare_ok,3},
                      {rabbit_channel,handle_cast,2},
                      {gen_server2,handle_msg,7},
                      {proc_lib,init_p,5}]}
      in function  gen_server2:terminate/6
    initial call: gen:init_it(gen_server2,&lt;0.8293.1&gt;,&lt;0.8293.1&gt;,
                              rabbit_channel,
                              [1,&lt;0.8283.1&gt;,&lt;0.8292.1&gt;,&lt;&lt;&quot;mtvmq&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;],
                              [])
    ancestors: [&lt;0.8293.1&gt;]
    messages: []
    links: [&lt;0.8293.1&gt;,&lt;0.8292.1&gt;]
    dictionary: [{permission_cache,
                     
[{{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;},
                        configure}]}]
    trap_exit: true
    status: running
    heap_size: 987
    stack_size: 23
    reductions: 2442
  neighbours:
    neighbour: [{pid,&lt;0.8292.1&gt;},
                  {registered_name,[]},
                  {initial_call,{rabbit_writer,mainloop,1}},
                  {current_function,{erlang,hibernate,3}},
                  {ancestors,[]},
                  {messages,[shutdown]},
                  {links,[&lt;0.8294.1&gt;]},
                  {dictionary,[]},
                  {trap_exit,false},
                  {status,runnable},
                  {heap_size,7},
                  {stack_size,0},
                  {reductions,17}]
=CRASH REPORT==== 24-Mar-2010::17:17:49 ===
  crasher:
    pid: &lt;0.9336.0&gt;
    registered_name: []
    exception exit: {{{<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nodedown,rabbit at job3</A>},
                      {gen_server2,call,[&lt;6902.26064.102&gt;,stat,infinity]}},
                     [{gen_server2,call,3},
                      {rabbit_misc,with_exit_handler,2},
                      {rabbit_channel,return_queue_declare_ok,3},
                      {rabbit_channel,handle_cast,2},
                      {gen_server2,handle_msg,7},
                      {proc_lib,wake_up,3}]}
      in function  gen_server2:terminate/6
    initial call: gen_server2:wake_hib(&lt;0.9335.0&gt;,&lt;0.9336.0&gt;,
                                       {ch,running,1,&lt;0.9333.0&gt;,&lt;0.9334.0&gt;,
                                        &lt;0.9337.0&gt;,none,
                                        {sets,0,16,16,8,80,48,
                                        
{[],[],[],[],[],[],[],[],[],[],[],[],
                                          [],[],[],[]},
                                         {{[],[],[],[],[],[],[],[],[],[],[],
                                           [],[],[],[],[]}}},
                                        3,
                                        {[],[]},
                                        {[],[]},
                                        &lt;&lt;&quot;mtvmq&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,
                                        &lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;,
                                        {dict,1,16,16,8,80,48,
                                        
{[],[],[],[],[],[],[],[],[],[],[],[],
                                          [],[],[],[]},
                                         {{[],[],[],[],[],[],[],[],[],[],[],
                                           [],
                                           [[&lt;&lt;&quot;W&quot;&gt;&gt;|
                                             {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
                                             
&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;}]],
                                           [],[],[]}}}},
                                       rabbit_channel,
                                       {{1269,476217,925545},
                                        {backoff,1460,1000,10000,
                                         {1635,29903,19828}}},
                                       {queue,[],[]},
                                       [])
    ancestors: [&lt;0.9335.0&gt;]
    messages: []
    links: [&lt;0.9335.0&gt;,&lt;0.9334.0&gt;]
    dictionary: [{permission_cache,
                     
[{{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;},
                        configure}]}]
    trap_exit: true
    status: running
    heap_size: 610
    stack_size: 23
    reductions: 20122
  neighbours:
    neighbour: [{pid,&lt;0.9334.0&gt;},
                  {registered_name,[]},
                  {initial_call,{rabbit_writer,mainloop,1}},
                  {current_function,{erlang,hibernate,3}},
                  {ancestors,[]},
                  {messages,[shutdown]},
                  {links,[&lt;0.9336.0&gt;]},
                  {dictionary,[]},
                  {trap_exit,false},
                  {status,runnable},
                  {heap_size,7},
                  {stack_size,0},
                  {reductions,352}]

=CRASH REPORT==== 24-Mar-2010::17:17:56 ===
  crasher:
    pid: &lt;0.16307.0&gt;
    registered_name: []
    exception exit: {{{<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nodedown,rabbit at job3</A>},
                      {gen_server2,call,[&lt;6902.26064.102&gt;,stat,infinity]}},
                     [{gen_server2,call,3},
                      {rabbit_misc,with_exit_handler,2},
                      {rabbit_channel,return_queue_declare_ok,3},
                      {rabbit_channel,handle_cast,2},
                      {gen_server2,handle_msg,7},
                      {proc_lib,wake_up,3}]}
      in function  gen_server2:terminate/6
    initial call: gen_server2:wake_hib(&lt;0.16306.0&gt;,&lt;0.16307.0&gt;,
                                      
{ch,running,1,&lt;0.16304.0&gt;,&lt;0.16305.0&gt;,
                                        &lt;0.16308.0&gt;,none,
                                        {sets,0,16,16,8,80,48,
                                        
{[],[],[],[],[],[],[],[],[],[],[],[],
                                          [],[],[],[]},
                                         {{[],[],[],[],[],[],[],[],[],[],[],
                                           [],[],[],[],[]}}},
                                        7,
                                        {[],[]},
                                        {[],[]},
                                        &lt;&lt;&quot;mtvmq&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,
                                        &lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;,
                                        {dict,1,16,16,8,80,48,
                                        
{[],[],[],[],[],[],[],[],[],[],[],[],
                                          [],[],[],[]},
                                         {{[],[],[],[],[],[],[],[],[],[],[],
                                           [],
                                           [[&lt;&lt;&quot;W&quot;&gt;&gt;|
                                             {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
                                             
&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;}]],
                                           [],[],[]}}}},
                                       rabbit_channel,
                                       {{1269,476256,284302},
                                        {backoff,1998,1000,10000,
                                         {7558,3810,6674}}},
                                       {queue,[],[]},
                                       [])
    ancestors: [&lt;0.16306.0&gt;]
    messages: [{'EXIT',&lt;0.16305.0&gt;,normal}]
    links: [&lt;0.16306.0&gt;]
    dictionary: [{permission_cache,
                     
[{{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;},
                        configure}]}]
    trap_exit: true
    status: running
    heap_size: 987
    stack_size: 23
    reductions: 12119
  neighbours:

=CRASH REPORT==== 24-Mar-2010::17:17:56 ===
  crasher:
    pid: &lt;0.13792.0&gt;
    registered_name: []
    exception exit: {{{<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nodedown,rabbit at job3</A>},
                      {gen_server2,call,[&lt;6902.26064.102&gt;,stat,infinity]}},
                     [{gen_server2,call,3},
                      {rabbit_misc,with_exit_handler,2},
                      {rabbit_channel,return_queue_declare_ok,3},
                      {rabbit_channel,handle_cast,2},
                      {gen_server2,handle_msg,7},
                      {proc_lib,wake_up,3}]}
      in function  gen_server2:terminate/6
    initial call: gen_server2:wake_hib(&lt;0.13791.0&gt;,&lt;0.13792.0&gt;,
                                      
{ch,running,1,&lt;0.13789.0&gt;,&lt;0.13790.0&gt;,
                                        &lt;0.13793.0&gt;,none,
                                        {sets,0,16,16,8,80,48,
                                        
{[],[],[],[],[],[],[],[],[],[],[],[],
                                          [],[],[],[]},
                                         {{[],[],[],[],[],[],[],[],[],[],[],
                                           [],[],[],[],[]}}},
                                        5,
                                        {[],[]},
                                        {[],[]},
                                        &lt;&lt;&quot;mtvmq&quot;&gt;&gt;,&lt;&lt;&quot;/&quot;&gt;&gt;,
                                        &lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;,
                                        {dict,1,16,16,8,80,48,
                                        
{[],[],[],[],[],[],[],[],[],[],[],[],
                                          [],[],[],[]},
                                         {{[],[],[],[],[],[],[],[],[],[],[],
                                           [],
                                           [[&lt;&lt;&quot;W&quot;&gt;&gt;|
                                             {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
                                             
&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;}]],
                                           [],[],[]}}}},
                                       rabbit_channel,
                                       {{1269,476259,683048},
                                        {backoff,1067,1000,10000,
                                         {21120,18572,28318}}},
                                       {queue,[],[]},
                                       [])
    ancestors: [&lt;0.13791.0&gt;]
    messages: [{'EXIT',&lt;0.13790.0&gt;,normal}]
    links: [&lt;0.13791.0&gt;]
    dictionary: [{permission_cache,
                     
[{{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;worker.transcode_queue&quot;&gt;&gt;},
                        configure}]}]
    trap_exit: true
    status: running
    heap_size: 987
    stack_size: 23
    reductions: 11759
  neighbours:

-- 
View this message in context: <A HREF="http://old.nabble.com/rabbit-cluster-keeps-crashing-tp28023134p28023134.html">http://old.nabble.com/rabbit-cluster-keeps-crashing-tp28023134p28023134.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006717.html">[rabbitmq-discuss] queues scheme at startup time
</A></li>
	<LI>Next message: <A HREF="006728.html">[rabbitmq-discuss] Client connection timeout
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6718">[ date ]</a>
              <a href="thread.html#6718">[ thread ]</a>
              <a href="subject.html#6718">[ subject ]</a>
              <a href="author.html#6718">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
