<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] dropped messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20dropped%20messages&In-Reply-To=23673004.post%40talk.nabble.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003617.html">
   <LINK REL="Next"  HREF="003639.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] dropped messages</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20dropped%20messages&In-Reply-To=23673004.post%40talk.nabble.com"
       TITLE="[rabbitmq-discuss] dropped messages">matthias at lshift.net
       </A><BR>
    <I>Mon May 25 22:07:39 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003617.html">[rabbitmq-discuss] dropped messages
</A></li>
        <LI>Next message: <A HREF="003639.html">[rabbitmq-discuss] dropped messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3629">[ date ]</a>
              <a href="thread.html#3629">[ thread ]</a>
              <a href="subject.html#3629">[ subject ]</a>
              <a href="author.html#3629">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mark,

smittycb10 wrote:
&gt;<i> however I still have the same problem 100,000's messages in and only
</I>&gt;<i> 1,000's of messages out. Am I publishing and subscribing in the most
</I>&gt;<i> efficent manner?
</I>
Can you send through the *complete* code? It's impossible to tell
otherwise why exactly you are getting the results you are seeing.

How are you measuring the rates? If on the sending side you are just
timing a loop of publishes then all you are measuring is the time it
takes to hand over the messages to the kernel. They can get buffered
there, in the network layer, in multiple layers at the broker, etc, etc.

Also, since AMQP's basic.publish is asynchronous, if the publishing 
connection is not terminated cleanly then some messages will inevitably 
get lost.

It's also worth remembering that RabbitMQ is a message *queuing* system, 
so one shouldn't be surprised if occasionally it queues some messages ;) 
What's more, because RabbitMQ's queuing is quite efficient, when you 
push the system hard, i.e. by feeding it messages as fast as you can, it 
will handle the incoming messages at a faster rate than it sends them to 
consumers.

For meaningful benchmark results it is therefore important to throttle
the producer, e.g. send messages at a fixed rate, monitor the rate at
which they are received by consumers, and slowly increase the producing
rate until the consumption rate starts falling behind.

&gt;&gt;<i> Do I need to anything to broker?
</I>
Unlikely.

&gt;&gt;<i> Is a message rate of 100,000 per second unreasonable?
</I>
For a single producer-&gt;broker-&gt;consumer chain that would be quite a high
rate - 10s of thousands of msgs/s is more realistic on stock hardware.

If you have several independent message streams then higher total
throughputs can be achieved when running on lots of cores.

&gt;<i> is there a max number of messages any one channel can have queued in
</I>&gt;<i> it at one time?
</I>
No.

&gt;<i> I am currently trying to squeeze all the messages into one channel,
</I>&gt;<i> should I be splitting work across channels and threads on the
</I>&gt;<i> receiving side??
</I>
Having multiple channels and, even better, multiple connections, 
provides more opportunities for parellelism at the server. Whether or 
not that actually makes a positive difference depends on lots of factors.


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003617.html">[rabbitmq-discuss] dropped messages
</A></li>
	<LI>Next message: <A HREF="003639.html">[rabbitmq-discuss] dropped messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3629">[ date ]</a>
              <a href="thread.html#3629">[ thread ]</a>
              <a href="subject.html#3629">[ subject ]</a>
              <a href="author.html#3629">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
