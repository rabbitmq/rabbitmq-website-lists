<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] message queues in clustered mode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20message%20queues%20in%20clustered%20mode&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003601.html">
   <LINK REL="Next"  HREF="003603.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] message queues in clustered mode</H1>
    <B>work at anomalizer.net</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20message%20queues%20in%20clustered%20mode&In-Reply-To="
       TITLE="[rabbitmq-discuss] message queues in clustered mode">work at anomalizer.net
       </A><BR>
    <I>Thu May 21 12:26:00 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003601.html">[rabbitmq-discuss] best practice for EC2 deployment?
</A></li>
        <LI>Next message: <A HREF="003603.html">[rabbitmq-discuss] message queues in clustered mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3602">[ date ]</a>
              <a href="thread.html#3602">[ thread ]</a>
              <a href="subject.html#3602">[ subject ]</a>
              <a href="author.html#3602">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(rabbit n00b warning)
I have two machines januty00 and jaunty01 that are running in clustered
mode. There is a durable queue with a few messages in it. Here is the
behaviour I am seeing:


<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">arvindj at jaunty00</A> ~ $ sudo rabbitmqctl list_queues
Listing queues ...
po_box  40
...done.
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">arvindj at jaunty00</A> ~ $ sudo rabbitmqctl status
Status of node <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jaunty00</A> ...
[{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;1.5.4&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.7&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.1.8&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.5.4&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.15.5&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.12.5&quot;}]},
 {nodes,[<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jaunty01</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at jaunty00</A>]},
 {running_nodes,[<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jaunty01</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at jaunty00</A>]}]
...done.



<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">arvindj at jaunty01</A> ~ $ sudo rabbitmqctl list_queues
Listing queues ...
po_box  40
...done.
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">arvindj at jaunty01</A> ~ $ sudo rabbitmqctl status
Status of node <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jaunty01</A> ...
[{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;1.5.4&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.7&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.1.8&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.5.4&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.15.5&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.12.5&quot;}]},
 {nodes,[<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jaunty01</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at jaunty00</A>]},
 {running_nodes,[<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jaunty00</A><A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at jaunty01</A>]}]
...done.


All looks fine when both machines are up. Now when jaunty00 goes down, the
queue disappears from jaunty01
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">arvindj at jaunty00</A> ~ $ sudo /etc/init.d/rabbitmq-server stop
Stopping rabbitmq-server: rabbitmq-server.
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">arvindj at jaunty01</A> ~ $ sudo rabbitmqctl list_queues
Listing queues ...
...done.


When I bring januty00 back, the queue reappears on jaunty01.The reverse is
not true i.e. when jaunty01 goes down, the queue is still available on
jaunty00

My understanding was that in clustered mode, if any one of the nodes goes
down, the queue is still available on the other nodes. What am I missing
here?



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003601.html">[rabbitmq-discuss] best practice for EC2 deployment?
</A></li>
	<LI>Next message: <A HREF="003603.html">[rabbitmq-discuss] message queues in clustered mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3602">[ date ]</a>
              <a href="thread.html#3602">[ thread ]</a>
              <a href="subject.html#3602">[ subject ]</a>
              <a href="author.html#3602">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
