<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Managing and unknown number of responses
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Managing%20and%20unknown%20number%20of%20responses&In-Reply-To=ce47f6b80905041540i384cfaf8vbf44eecb4f3238f0%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003512.html">
   <LINK REL="Next"  HREF="003514.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Managing and unknown number of responses</H1>
    <B>Neil Bartlett</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Managing%20and%20unknown%20number%20of%20responses&In-Reply-To=ce47f6b80905041540i384cfaf8vbf44eecb4f3238f0%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Managing and unknown number of responses">njbartlett at gmail.com
       </A><BR>
    <I>Tue May  5 00:06:35 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003512.html">[rabbitmq-discuss] Managing and unknown number of responses
</A></li>
        <LI>Next message: <A HREF="003514.html">[rabbitmq-discuss] .net client exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3513">[ date ]</a>
              <a href="thread.html#3513">[ thread ]</a>
              <a href="subject.html#3513">[ subject ]</a>
              <a href="author.html#3513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You cannot really know how many consumers there will be. You might
think you know, but some might crash or do something funky and as a
result you will get fewer responses than you expect. If you wait until
all the consumers respond, then you may wait forever for the last
couple of responses that never arrive.

What you're trying to do is reach consensus on the value of a binary
variable. That's very hard to do in in absolute terms, instead you
have to think about probability. And, yes, non-determinism too...
sorry! Rather than always waiting a fixed period of time, you could
assume the value is true once a certain number of consumers have
responded, but you would still need a timeout in case that level of
confidence cannot be not reached in a reasonable time.

Neil


On Mon, May 4, 2009 at 11:40 PM, Colin Z &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">theczintheroc2007 at gmail.com</A>&gt; wrote:
&gt;<i> This may be an issue with asynchronous or message-passing based programming
</I>&gt;<i> in general...I hope someone can help out...
</I>&gt;<i>
</I>&gt;<i> Basically, I want to send out a query in the form of an AMQ message and
</I>&gt;<i> receive back responses from an unknown and possibly large number of
</I>&gt;<i> responders.
</I>&gt;<i>
</I>&gt;<i> As an example, let's say we're doing some game logic and we want to figure
</I>&gt;<i> out if an action should succeed or not.
</I>&gt;<i>
</I>&gt;<i> My idea was to publish a message to a topic exchange with a routing key like
</I>&gt;<i> &quot;magic.success.&lt;characterName&gt;&quot; and then collect all the responses from all
</I>&gt;<i> the subscribed subsystems and use their responses to decide if the action
</I>&gt;<i> succeeded or not. It's almost like a map-reduce I guess.
</I>&gt;<i>
</I>&gt;<i> It seems like I would either need to set a timeout after which I stop
</I>&gt;<i> waiting for responses (seems wasteful and possibly non-deterministic if some
</I>&gt;<i> logic takes unusually long to run)
</I>&gt;<i>
</I>&gt;<i> or I somehow need to know in advance how many consumers there are, OR I need
</I>&gt;<i> to know how many queues my initial message got delivered to.
</I>&gt;<i>
</I>&gt;<i> Has anyone dealt with something like this before?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003512.html">[rabbitmq-discuss] Managing and unknown number of responses
</A></li>
	<LI>Next message: <A HREF="003514.html">[rabbitmq-discuss] .net client exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3513">[ date ]</a>
              <a href="thread.html#3513">[ thread ]</a>
              <a href="subject.html#3513">[ subject ]</a>
              <a href="author.html#3513">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
