<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Moving from 2node to 3node cluster?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Moving%20from%202node%20to%203node%20cluster%3F&In-Reply-To=%3C53957A4E.7050007%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036510.html">
   <LINK REL="Next"  HREF="036525.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Moving from 2node to 3node cluster?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Moving%20from%202node%20to%203node%20cluster%3F&In-Reply-To=%3C53957A4E.7050007%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Moving from 2node to 3node cluster?">simon at rabbitmq.com
       </A><BR>
    <I>Mon Jun  9 10:11:42 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036510.html">[rabbitmq-discuss] Moving from 2node to 3node cluster?
</A></li>
        <LI>Next message: <A HREF="036525.html">[rabbitmq-discuss] Moving from 2node to 3node cluster?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36523">[ date ]</a>
              <a href="thread.html#36523">[ thread ]</a>
              <a href="subject.html#36523">[ subject ]</a>
              <a href="author.html#36523">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/06/2014 2:36AM, Jakov Sosic wrote:
&gt;<i> I have a 2node rabbitmq cluster with about 10 HA queues.
</I>&gt;<i>
</I>&gt;<i> I plan to expand it to 3 node cluster..
</I>&gt;<i>
</I>&gt;<i> My plan so far is to:
</I>&gt;<i>
</I>&gt;<i> - shut down secondary
</I>&gt;<i> - shut down primary
</I>&gt;<i> - change config on primary
</I>&gt;<i> - start primary
</I>&gt;<i> - change config on secondary
</I>&gt;<i> - start secondary
</I>&gt;<i> - sync secondary to primary
</I>&gt;<i> - start third server
</I>&gt;<i>
</I>&gt;<i> Is there maybe a faster solution, or is this as best as I can do :)
</I>
You don't need to do that.

I assume by &quot;config&quot; you're referring to 
<A HREF="http://www.rabbitmq.com/clustering.html#auto-config.">http://www.rabbitmq.com/clustering.html#auto-config.</A>

But the docs there say:

&gt;<i> Note that the cluster configuration is applied only to fresh nodes. A
</I>&gt;<i> fresh nodes is a node which has just been reset or is being start for
</I>&gt;<i> the first time. Thus, the automatic clustering won't take place after
</I>&gt;<i> restarts of nodes. This means that any change to the clustering via
</I>&gt;<i> rabbitmqctl will take precedence over the automatic clustering
</I>&gt;<i> configuration.
</I>
So neither of the existing nodes need to be reconfigured. You just need 
to tell the third node to join the cluster, either with the config file 
(on the third node!) as mentioned above, or with 'rabbitmqctl 
join_cluster'. No downtime needed.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036510.html">[rabbitmq-discuss] Moving from 2node to 3node cluster?
</A></li>
	<LI>Next message: <A HREF="036525.html">[rabbitmq-discuss] Moving from 2node to 3node cluster?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36523">[ date ]</a>
              <a href="thread.html#36523">[ thread ]</a>
              <a href="subject.html#36523">[ subject ]</a>
              <a href="author.html#36523">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
