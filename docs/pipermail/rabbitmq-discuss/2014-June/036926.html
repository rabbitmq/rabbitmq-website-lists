<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] custom exchange checking auth user
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20exchange%20checking%20auth%20user&In-Reply-To=%3C53AC53F9.9000400%40alertme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036923.html">
   <LINK REL="Next"  HREF="036928.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] custom exchange checking auth user</H1>
    <B>Dmitry Andrianov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20exchange%20checking%20auth%20user&In-Reply-To=%3C53AC53F9.9000400%40alertme.com%3E"
       TITLE="[rabbitmq-discuss] custom exchange checking auth user">dmitry.andrianov at alertme.com
       </A><BR>
    <I>Thu Jun 26 18:10:17 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036923.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
        <LI>Next message: <A HREF="036928.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36926">[ date ]</a>
              <a href="thread.html#36926">[ thread ]</a>
              <a href="subject.html#36926">[ subject ]</a>
              <a href="author.html#36926">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,
we did not want to do that kind of tests in the consuming applications 
because more consumers can be created later and copying that kind of 
check into each of them is error prone and is easy to be forgotten, 
especially by new team members. So we opted for the custom exchange type 
that just does not allow these messages into the system. And I do 
confirm no API changes were required :) - there are a few examples of 
custom exchanges on the internet. My only problem was Erlang :)

While we are there given that we have our custom exchange - how can we 
&quot;enrich&quot; a message with some data like client's IP?
(I know we are not supposed to touch the message according to AMQP 
standard, but we are not very standard already given three custom plugins)

Thank you.

On 26/06/14 18:00, Matthias Radestock wrote:
&gt;<i> Dmitry,
</I>&gt;<i>
</I>&gt;<i> On 23/06/14 09:37, Dmitry Andrianov wrote:
</I>&gt;&gt;<i> we actually using that thing already - client sets the user ID property
</I>&gt;&gt;<i> and server rejects a message if it does not match the actual auth user.
</I>&gt;&gt;<i> However, I did read it as that setUserId call being optional - it is up
</I>&gt;&gt;<i> to the client to set it. And if client does not set it, no validation is
</I>&gt;&gt;<i> performed.
</I>&gt;&gt;<i> So how do I prevent messages without an user id from being accepted?
</I>&gt;<i>
</I>&gt;<i> You can't, though your consuming applications could drop such messages.
</I>&gt;<i>
</I>&gt;&gt;<i> If I need a custom exchange type or exchange decorator - it does not
</I>&gt;&gt;<i> really makes life much easier.
</I>&gt;<i>
</I>&gt;<i> It would be quite straightforward to write an exchange type or 
</I>&gt;<i> decorator that drops messages which do not have the user-id header. Or 
</I>&gt;<i> rejects them with some amqp error.
</I>&gt;<i>
</I>&gt;<i> That may not be the ideal solution but can be done now, without 
</I>&gt;<i> requiring any changes to rabbit's APIs.
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>
This email is for the use of the intended recipient(s) only.
If you have received this email in error, please notify the sender immediately and then delete it.
If you are not the intended recipient, you must not use, disclose or distribute this email without the
author's prior permission. AlertMe.com Ltd. is not responsible for any personal views expressed
in this message or any attachments that are those of the individual sender.

AlertMe.com Ltd, 30 Station Road, Cambridge, CB1 2RE, UK.
Registered in England, Company number 578 2908, VAT registration number GB 895 9914 42.


</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036923.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
	<LI>Next message: <A HREF="036928.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36926">[ date ]</a>
              <a href="thread.html#36926">[ thread ]</a>
              <a href="subject.html#36926">[ subject ]</a>
              <a href="author.html#36926">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
