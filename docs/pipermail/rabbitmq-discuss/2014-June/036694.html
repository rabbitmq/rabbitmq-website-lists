<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue data recovery after master failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20data%20recovery%20after%20master%20failure&In-Reply-To=%3C7FAE6517-8D75-4757-B690-800B4B63FD99%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036722.html">
   <LINK REL="Next"  HREF="036700.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue data recovery after master failure</H1>
    <B>Andrei</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20data%20recovery%20after%20master%20failure&In-Reply-To=%3C7FAE6517-8D75-4757-B690-800B4B63FD99%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Queue data recovery after master failure">theonlyandrei at gmail.com
       </A><BR>
    <I>Wed Jun 18 04:43:14 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036722.html">[rabbitmq-discuss] web-stomp SSL config causing SASL crash?
</A></li>
        <LI>Next message: <A HREF="036700.html">[rabbitmq-discuss] Queue data recovery after master failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36694">[ date ]</a>
              <a href="thread.html#36694">[ thread ]</a>
              <a href="subject.html#36694">[ subject ]</a>
              <a href="author.html#36694">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have a 12 node cluster with dozens of mirrored queues (2 slaves per queue). 
Here's the scenario we're trying to understand how to recover from.

Say we have a complete power failure and when power is restored one of the nodes is dead. 
For at least one queue, that node used to be the master node. The queue is now unresponsive, which is somewhat expected (no failover happened before the crash so we now have 2 slaves). The queue data (messages) must be physically present on at least one slave (at least one of those is a disc node). However, we seem to have no way to recover the queue and keep that data. 
If we bring a new node up to replace the old one (we reset the old one to simulate a fresh node), the queue becomes available but it's now empty (we assume this to be the result of the - now empty - master synchronizing with the slaves, sort of in the &quot;opposite direction&quot; of what we'd like). 
Is there a way to either designate the slave that still has the data as a master for the troubled queue, or to push that queue data to the new (resurrected) node? 

Thanks is advance!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140617/7d8924df/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140617/7d8924df/attachment.html</A>&gt;
</PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036722.html">[rabbitmq-discuss] web-stomp SSL config causing SASL crash?
</A></li>
	<LI>Next message: <A HREF="036700.html">[rabbitmq-discuss] Queue data recovery after master failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36694">[ date ]</a>
              <a href="thread.html#36694">[ thread ]</a>
              <a href="subject.html#36694">[ subject ]</a>
              <a href="author.html#36694">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
