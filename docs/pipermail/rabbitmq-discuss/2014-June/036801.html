<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] custom exchange checking auth user
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20exchange%20checking%20auth%20user&In-Reply-To=%3C53A44907.5090908%40alertme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036800.html">
   <LINK REL="Next"  HREF="036811.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] custom exchange checking auth user</H1>
    <B>Dmitry Andrianov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20custom%20exchange%20checking%20auth%20user&In-Reply-To=%3C53A44907.5090908%40alertme.com%3E"
       TITLE="[rabbitmq-discuss] custom exchange checking auth user">dmitry.andrianov at alertme.com
       </A><BR>
    <I>Fri Jun 20 15:45:27 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036800.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
        <LI>Next message: <A HREF="036811.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36801">[ date ]</a>
              <a href="thread.html#36801">[ thread ]</a>
              <a href="subject.html#36801">[ subject ]</a>
              <a href="author.html#36801">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Uh, oh. You will criticize my idea :)

So there is a custom auth backend that extract something from client's 
SSL certificate and puts it into user's impl.
Client is obliged to also provide the same information in AMQP headers.
This is done because our server app also needs that data and by the time 
message reaches it, there is no SSL anymore.

Since client may put whatever it likes in the header, I want that 
RabbitMQ that accepts the message did the validation - compare that 
value in the header and the value from user.impl (extracted from SSL 
cert) are the same or reject the message otherwise.

So we do not trust AMQP headers we receive from the client but we do 
trust the SSL certificate and we do trust AQMP headers after the message 
came through the first Rabbit and was verified.


A am also thinking of relaxing the requirements for the client to add 
that header in the first place - the custom exchange can add it if it is 
missing.
I do understand that it violates AMQP specs but it does not look that 
serious.

Thanks


On 20/06/14 15:28, Simon MacMullen wrote:
&gt;<i> On 20/06/14 15:21, Dmitry Andrianov wrote:
</I>&gt;&gt;<i> can a custom exchange plugin access record of the user that sent the
</I>&gt;&gt;<i> message?
</I>&gt;<i>
</I>&gt;<i> It can't, I'm afraid.
</I>&gt;<i>
</I>&gt;<i> What are you trying to do?
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>
This email is for the use of the intended recipient(s) only.
If you have received this email in error, please notify the sender immediately and then delete it.
If you are not the intended recipient, you must not use, disclose or distribute this email without the
author's prior permission. AlertMe.com Ltd. is not responsible for any personal views expressed
in this message or any attachments that are those of the individual sender.

AlertMe.com Ltd, 30 Station Road, Cambridge, CB1 2RE, UK.
Registered in England, Company number 578 2908, VAT registration number GB 895 9914 42.


</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036800.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
	<LI>Next message: <A HREF="036811.html">[rabbitmq-discuss] custom exchange checking auth user
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36801">[ date ]</a>
              <a href="thread.html#36801">[ thread ]</a>
              <a href="subject.html#36801">[ subject ]</a>
              <a href="author.html#36801">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
