<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue data recovery after master failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20data%20recovery%20after%20master%20failure&In-Reply-To=%3C53A43515.7010201%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036715.html">
   <LINK REL="Next"  HREF="036696.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue data recovery after master failure</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20data%20recovery%20after%20master%20failure&In-Reply-To=%3C53A43515.7010201%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Queue data recovery after master failure">simon at rabbitmq.com
       </A><BR>
    <I>Fri Jun 20 14:20:21 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036715.html">[rabbitmq-discuss] Queue data recovery after master failure
</A></li>
        <LI>Next message: <A HREF="036696.html">[rabbitmq-discuss] Messages are read by consumer befor than sender	get confirmation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36798">[ date ]</a>
              <a href="thread.html#36798">[ thread ]</a>
              <a href="subject.html#36798">[ subject ]</a>
              <a href="author.html#36798">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/06/14 09:42, Simon MacMullen wrote:
&gt;<i> I'm afraid not. Really &quot;rabbitmqctl forget_cluster_node&quot; should be able
</I>&gt;<i> to cause down slaves to come back as new masters, which would be the
</I>&gt;<i> right solution to this. I'm hoping that we'll be able to do that for
</I>&gt;<i> 3.4.0, but it's a somewhat intrusive change. The bug number for this
</I>&gt;<i> branch will be 26191, so you can keep an eye on it in future (currently
</I>&gt;<i> there's nothing there).
</I>
To follow on:

This turns out to be easy if we can assume that there will be a slave to 
promote that is also down (quite likely since you tend to encounter this 
while your cluster is down), so I've done that as a first pass at the 
problem. See:

<A HREF="http://next.rabbitmq.com/ha.html#promotion-while-down">http://next.rabbitmq.com/ha.html#promotion-while-down</A>

for documentation of how it will be in tonight's nightly build.

26191 is still reserved for the more thorny case of how to do this when 
the rest of the cluster has come back up - there are a lot of issues 
there so it might not happen soon.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036715.html">[rabbitmq-discuss] Queue data recovery after master failure
</A></li>
	<LI>Next message: <A HREF="036696.html">[rabbitmq-discuss] Messages are read by consumer befor than sender	get confirmation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36798">[ date ]</a>
              <a href="thread.html#36798">[ thread ]</a>
              <a href="subject.html#36798">[ subject ]</a>
              <a href="author.html#36798">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
