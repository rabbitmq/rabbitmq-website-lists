<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] More about SSL_TIMEOUT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20More%20about%20SSL_TIMEOUT&In-Reply-To=%3C5395DDA1.6020004%40alertme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036530.html">
   <LINK REL="Next"  HREF="036532.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] More about SSL_TIMEOUT</H1>
    <B>Dmitry Andrianov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20More%20about%20SSL_TIMEOUT&In-Reply-To=%3C5395DDA1.6020004%40alertme.com%3E"
       TITLE="[rabbitmq-discuss] More about SSL_TIMEOUT">dmitry.andrianov at alertme.com
       </A><BR>
    <I>Mon Jun  9 17:15:29 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036530.html">[rabbitmq-discuss] SSL_TIMEOUT
</A></li>
        <LI>Next message: <A HREF="036532.html">[rabbitmq-discuss] More about SSL_TIMEOUT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36531">[ date ]</a>
              <a href="thread.html#36531">[ thread ]</a>
              <a href="subject.html#36531">[ subject ]</a>
              <a href="author.html#36531">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[Michael Klishin suggested me to post the issue in a new thread in order 
for it to be reviewed properly for possible inclusion in your issue tracker]

So to remind. the issue is Rabbit MQ Java client failing to connect to 
the server (with &quot;connection reset&quot;).
The problem is there because Rabbit MQ server kills inbound connection 
should SSL handshake not finish in 5 seconds.
I first experienced the issue in the network where something was not 
quite right with DNS server - I found that when establishing SSL 
connection the Java client did a reverse lookup of IP address. (That 
means the &quot;forward&quot; DNS lookup was already done and IP address resolved 
from the server name, TCP connection was already established to that IP 
and only then Java SSL code started reverse lookup).
When that reverse DNS lookup takes more than 5 sec, Rabbit MQ server 
kills the connection. And even though we retry 30 seconds later - it is 
not going to improve so process repeats.

Since that first time, I saw this problem multiple times on other 
networks. The solution each time was to manually hack /etc/hosts file to 
put there the IP address with arbitrary name. This makes that IP to name 
translation quick and connection succeeds. This is obviously a 
workaround, not a solution.

IIRC, that reverse lookup was done by standard Java SSL support, not 
Rabbit MQ client library so it is not a Rabbit MQ bug technically. I do 
not know why Java SSL code does that lookup but it did not seem easy how 
to avoid it.

So for me the solution would be to increase the timeout to 10 sec 
minimum or, probably better, make it configurable.

Many thanks


This email is for the use of the intended recipient(s) only.
If you have received this email in error, please notify the sender immediately and then delete it.
If you are not the intended recipient, you must not use, disclose or distribute this email without the
author's prior permission. AlertMe.com Ltd. is not responsible for any personal views expressed
in this message or any attachments that are those of the individual sender.

AlertMe.com Ltd, 30 Station Road, Cambridge, CB1 2RE, UK.
Registered in England, Company number 578 2908, VAT registration number GB 895 9914 42.


</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036530.html">[rabbitmq-discuss] SSL_TIMEOUT
</A></li>
	<LI>Next message: <A HREF="036532.html">[rabbitmq-discuss] More about SSL_TIMEOUT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36531">[ date ]</a>
              <a href="thread.html#36531">[ thread ]</a>
              <a href="subject.html#36531">[ subject ]</a>
              <a href="author.html#36531">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
