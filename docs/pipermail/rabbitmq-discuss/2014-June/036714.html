<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Web-STOMP%20plugin%20-%20Authentication%20with%20SSL%0A%20Client%20Certificates&In-Reply-To=%3CCANcm3vkc0JxpjosSiY43k-%3DwSL74CB-%3Dni%2Bs4hNR3cuJ00hJyQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036618.html">
   <LINK REL="Next"  HREF="036738.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates</H1>
    <B>Andrei</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Web-STOMP%20plugin%20-%20Authentication%20with%20SSL%0A%20Client%20Certificates&In-Reply-To=%3CCANcm3vkc0JxpjosSiY43k-%3DwSL74CB-%3Dni%2Bs4hNR3cuJ00hJyQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates">andrei002 at gmail.com
       </A><BR>
    <I>Wed Jun 18 16:51:56 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036618.html">[rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates
</A></li>
        <LI>Next message: <A HREF="036738.html">[rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36714">[ date ]</a>
              <a href="thread.html#36714">[ thread ]</a>
              <a href="subject.html#36714">[ subject ]</a>
              <a href="author.html#36714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Michael,

Thanks for the feedback!

I have a few more questions:

1. Is there any possibility for this feature to be implemented in one of
the next releases, in order for Web-STOMP to be fully compatible with STOMP
plugin?

2. In case it is too complex to implement due to lack of client SSL
authentication mechanisms in Cowboy, could it be implemented in the
following way, as a workaround?

a. On Websocket session initiation handshake over HTTP, Cowboy will receive
a HTTP header containing the username/password string from the client
(which in reality will contain the CN field stripped from the client
certificate and appended to the HTTP request by Nginx)

b. This string should probably be extracted from the request somewhere here:
<A HREF="http://hg.rabbitmq.com/sockjs-erlang-wrapper/file/6be67ee815ff/0003-websocket-subprotocol">http://hg.rabbitmq.com/sockjs-erlang-wrapper/file/6be67ee815ff/0003-websocket-subprotocol</A>

c. And then sent down the calls as a parameter up to the call of the
rabbitmq_stomp_processor here (
<A HREF="http://hg.rabbitmq.com/rabbitmq-web-stomp/file/c3e862675fac/src/rabbit_ws_client_sup.erl">http://hg.rabbitmq.com/rabbitmq-web-stomp/file/c3e862675fac/src/rabbit_ws_client_sup.erl</A>),
or maybe earlier, and replace the username/password arguments of the
CONNECT STOMP command.

Thus, some default username/password strings sent from client JS code will
be replaced with this additional handshake HTTP header which will be sent
by Nginx and contain the CN field of the client certificate.

Unfortunately I'm not an Erlang developer, so much of this is wild
guessing..

Please let me know of your opinion on this approach, and I'd be really
grateful for some assistance with implementing the sockjs-erlang-wrapper
and Web-STOMP part of this solution, in case it looks to be feasible to
you..

Thanks a lot for checking this out!

Best regards,
Andy.

P.S.: Although you have CCd rabbitmq-discuss group in the previous
messages, somehow these are not visible to me on the Rabbitmq-discuss
Google Group. Are there some viewing or access restrictions set up?


On Sat, Jun 14, 2014 at 1:28 AM, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt;
wrote:

&gt;<i> On 14 June 2014 at 02:21:50, Andrei (<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">andrei002 at gmail.com</A>) wrote:
</I>&gt;<i> &gt; &gt; The question is whether the Web-STOMP plugin also has an option
</I>&gt;<i> &gt; like this, i.e. something like:
</I>&gt;<i> &gt; {rabbitmq_web_stomp, [{ssl_cert_login, true}]}
</I>&gt;<i>
</I>&gt;<i> No, it's not currently supported in Web-STOMP .
</I>&gt;<i> --
</I>&gt;<i> MK
</I>&gt;<i>
</I>&gt;<i> Software Engineer, Pivotal/RabbitMQ
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140618/e787957c/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140618/e787957c/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036618.html">[rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates
</A></li>
	<LI>Next message: <A HREF="036738.html">[rabbitmq-discuss] Web-STOMP plugin - Authentication with SSL Client Certificates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36714">[ date ]</a>
              <a href="thread.html#36714">[ thread ]</a>
              <a href="subject.html#36714">[ subject ]</a>
              <a href="author.html#36714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
