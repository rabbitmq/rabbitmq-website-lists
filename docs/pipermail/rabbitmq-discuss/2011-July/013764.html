<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Published%20message%20not%20queued%20after%0A%20publish-ok%20received%20when%20connection%20quickly%20closed&In-Reply-To=%3CCAE3HoVRt3V_jhNKW5cHCM1eE_KCZ-d5ioJxTjfFo6M4fcxmTEg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013762.html">
   <LINK REL="Next"  HREF="013766.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Published%20message%20not%20queued%20after%0A%20publish-ok%20received%20when%20connection%20quickly%20closed&In-Reply-To=%3CCAE3HoVRt3V_jhNKW5cHCM1eE_KCZ-d5ioJxTjfFo6M4fcxmTEg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed">michael.s.klishin at gmail.com
       </A><BR>
    <I>Fri Jul  8 15:19:07 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013762.html">[rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed
</A></li>
        <LI>Next message: <A HREF="013766.html">[rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13764">[ date ]</a>
              <a href="thread.html#13764">[ thread ]</a>
              <a href="subject.html#13764">[ subject ]</a>
              <a href="author.html#13764">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2011/7/8 Michael Nacos &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">m.nacos at gmail.com</A>&gt;

&gt;<i> so, what's currently the best way to publish messages consumed from one
</I>&gt;<i> queue into another with the amqp gem?
</I>&gt;<i>
</I>
Just republish them or take


&gt;<i> This is quite important in processing scenaria when no messages may be
</I>&gt;<i> lost. In particular, is the following code safe? Will the pseudo-synchronous
</I>&gt;<i> *publish* call return only after the message has been accepted in the
</I>&gt;<i> second queue (:nowait =&gt; false)? otherwise, what would be the point of
</I>&gt;<i> wrapping the publish call with @channel.tx_select / @channel.tx_commit ?
</I>&gt;<i>
</I>
Exchange#publish returns as soon as your data was placed into an outgoing
data buffer. This is documented in detail (including why knowing that you
message was received is impossible without receiving an acknowledgement for
it):

<A HREF="http://rubydoc.info/github/ruby-amqp/amqp/master/file/docs/Exchanges.textile#Publishing_callback__Reliable_delivery_in_distributed_environments">http://rubydoc.info/github/ruby-amqp/amqp/master/file/docs/Exchanges.textile#Publishing_callback__Reliable_delivery_in_distributed_environments</A>

An examples of publishing confirmations extension in action:
<A HREF="https://github.com/ruby-amqp/amqp/blob/master/examples/extensions/rabbitmq/publisher_confirmations_with_transient_messages.rb">https://github.com/ruby-amqp/amqp/blob/master/examples/extensions/rabbitmq/publisher_confirmations_with_transient_messages.rb</A>

I am not sure what &quot;(:nowait =&gt; false)&quot; is referring to, can you please
explain?
-- 
MK

<A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
<A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110708/993ee5f8/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110708/993ee5f8/attachment.htm</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013762.html">[rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed
</A></li>
	<LI>Next message: <A HREF="013766.html">[rabbitmq-discuss] Published message not queued after publish-ok received when connection quickly closed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13764">[ date ]</a>
              <a href="thread.html#13764">[ thread ]</a>
              <a href="subject.html#13764">[ subject ]</a>
              <a href="author.html#13764">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
