<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] single broker and queue scalability question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20single%20broker%20and%20queue%20scalability%20question&In-Reply-To=%3Cyrv4czkjv8jvr.fsf%40dwragg.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014255.html">
   <LINK REL="Next"  HREF="014253.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] single broker and queue scalability question</H1>
    <B>David Wragg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20single%20broker%20and%20queue%20scalability%20question&In-Reply-To=%3Cyrv4czkjv8jvr.fsf%40dwragg.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] single broker and queue scalability question">david at rabbitmq.com
       </A><BR>
    <I>Sat Jul 30 23:48:56 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014255.html">[rabbitmq-discuss] single broker and queue scalability question
</A></li>
        <LI>Next message: <A HREF="014253.html">[rabbitmq-discuss] running rabbitmqadmin CLI on windows 7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14259">[ date ]</a>
              <a href="thread.html#14259">[ thread ]</a>
              <a href="subject.html#14259">[ subject ]</a>
              <a href="author.html#14259">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">justin.adam.miller at gmail.com</A>&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">justin.adam.miller at gmail.com</A>&gt; writes:
&gt;<i> I have an app that will have, at any one time, &lt; 500 connections to a
</I>&gt;<i> single broker, across multiple machines, all of whom I want as
</I>&gt;<i> consumers of one queue so that rabbit can load balance amongst them.
</I>
It's certainly possible for rabbit to handle 500 connections, even on
relatively modest hardware.

As for 500 consumers of a single queue, it doesn't seem likely to be a
problem.  But you could prototype it and see what you get.  Try to match
your expected message throughput, message size distribution, and
consumption intervals (how long between a message being delivered and
being acked).  And try with hardware similar or less capable than what
you expect to use in production.

&gt;<i> Is handling so few connections/consumers a joke for rabbit? Should I
</I>&gt;<i> consider clustering, and if so, what does clustering buy me in this
</I>&gt;<i> case? The one thing I don't love about clustering is that, without
</I>&gt;<i> active/passive failover, the node that declares the queue is a single
</I>&gt;<i> point of failure.
</I>
Currently clustering won't buy you anything in this context.

As for active/active failover, there will be developments in that area
soon.  But even then, a single queue will remain a potential bottleneck.

&gt;<i> The idea of clustering along with multiple queues bound to one
</I>&gt;<i> exchange is appealing (since exchange and binding information is
</I>&gt;<i> replicated across the cluster), but rabbit will not round robin
</I>&gt;<i> messages to all the bound queues -- there's no exchange type (that I
</I>&gt;<i> know of) that has that behavior.
</I>&gt;<i>
</I>&gt;<i> If I knew the bound queues ahead of time, then I could pick one at
</I>&gt;<i> random, but it seems like determining that queue would be cumbersome,
</I>&gt;<i> inefficient and/or costly at best.
</I>
If you were to go down this route, there may be advantages to using
multiple brokers rather than clustering.  E.g., have one queue in each
broker, with each consumer coonsuming from one of them.  Then each
producer connects to each broker and publishes each message to one of
them, chosen at random.  This would allow you to do things like rolling
upgrades of the brokers.  Clustering won't, as we don't support mixed
version clusters.

-- 
David Wragg
Staff Engineer, RabbitMQ
VMware, Inc.
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014255.html">[rabbitmq-discuss] single broker and queue scalability question
</A></li>
	<LI>Next message: <A HREF="014253.html">[rabbitmq-discuss] running rabbitmqadmin CLI on windows 7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14259">[ date ]</a>
              <a href="thread.html#14259">[ thread ]</a>
              <a href="subject.html#14259">[ subject ]</a>
              <a href="author.html#14259">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
