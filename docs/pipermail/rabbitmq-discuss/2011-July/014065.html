<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Patching%20rabbitmq%20to%20get%20more%20information%0A%20about%20framing%20exceptions&In-Reply-To=%3C4E27C7A5.10008%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014059.html">
   <LINK REL="Next"  HREF="014073.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Patching%20rabbitmq%20to%20get%20more%20information%0A%20about%20framing%20exceptions&In-Reply-To=%3C4E27C7A5.10008%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions">matthias at rabbitmq.com
       </A><BR>
    <I>Thu Jul 21 07:31:01 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014059.html">[rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions
</A></li>
        <LI>Next message: <A HREF="014073.html">[rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14065">[ date ]</a>
              <a href="thread.html#14065">[ thread ]</a>
              <a href="subject.html#14065">[ subject ]</a>
              <a href="author.html#14065">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Michael,

On 21/07/11 03:51, Michael Klishin wrote:
&gt;<i> So far I narrowed it down to the &quot;empty messages&quot; problem: whenever
</I>&gt;<i> there is an empty message sent by amqp gem master version, RabbitMQ
</I>&gt;<i> doesn't consider it a complete message and thus clients do not get
</I>&gt;<i> anything. With a simple script that terminates as soon as the message is
</I>&gt;<i> received
</I>&gt;<i> (by the same process), this looks like app is hanging. In the context of
</I>&gt;<i> a larger application, sometimes there are empty messages transmitted (I
</I>&gt;<i> am streaming a stdout output).
</I>&gt;<i>
</I>&gt;<i> After comparing 2 clients I see the following picture: the data
</I>&gt;<i> transmitted is exactly the same, frame order is correct but Wireshark
</I>&gt;<i> GUI suggests that
</I>&gt;<i> one client transmits 3 frames as 3 IP packets. In this case, RabbitMQ is
</I>&gt;<i> happy. The other transmits them all in a single IP packet and RabbitMQ
</I>&gt;<i> doesn't seem to recognize it as a complete message.
</I>&gt;<i>
</I>&gt;<i> Here are two Wireshark session exports:
</I>&gt;<i> <A HREF="https://gist.github.com/1096404">https://gist.github.com/1096404</A>
</I>&gt;<i>
</I>&gt;<i> If the [frames] content is the same, what may be going on here?
</I>
That's curious. Both should cause rabbit to complain with the &quot;expected 
method frame, got non method frame instead&quot; error. Are you sure you are 
seeing different behaviour here? If so, please send through the pcap 
files showing the entire tcp session.

Content body frames should never be zero length. If the content length 
is zero then no content body frame should be sent at all, just a header.


Matthias.
</PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014059.html">[rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions
</A></li>
	<LI>Next message: <A HREF="014073.html">[rabbitmq-discuss] Patching rabbitmq to get more information about framing exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14065">[ date ]</a>
              <a href="thread.html#14065">[ thread ]</a>
              <a href="subject.html#14065">[ subject ]</a>
              <a href="author.html#14065">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
