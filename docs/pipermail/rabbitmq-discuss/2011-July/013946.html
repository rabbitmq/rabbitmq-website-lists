<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd: a few json rpc questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Fwd%3A%20a%20few%20json%20rpc%20questions&In-Reply-To=%3CCAJ2-Vrnk3Q27A4r%2BuT0eGxCoeSaTr5r1_rCw%2BPLFS2qdWr6-0Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013904.html">
   <LINK REL="Next"  HREF="013947.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd: a few json rpc questions</H1>
    <B>mysurf mail</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Fwd%3A%20a%20few%20json%20rpc%20questions&In-Reply-To=%3CCAJ2-Vrnk3Q27A4r%2BuT0eGxCoeSaTr5r1_rCw%2BPLFS2qdWr6-0Q%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Fwd: a few json rpc questions">stammailbox at gmail.com
       </A><BR>
    <I>Mon Jul 18 10:04:03 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013904.html">[rabbitmq-discuss] Fwd: a few json rpc questions
</A></li>
        <LI>Next message: <A HREF="013947.html">[rabbitmq-discuss] Fwd: a few json rpc questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13946">[ date ]</a>
              <a href="thread.html#13946">[ thread ]</a>
              <a href="subject.html#13946">[ subject ]</a>
              <a href="author.html#13946">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Emile,

I find a lot of assistance in your answers.
I do use the RPC the way you mentioned and multiple clients do connect.
but my problem is that sometimes - a new client cannot connect .

While investigating this problem I found that one of the server RPC queues
was deleted. and when the client tries to connect to it, it halts when
trying.

How come?
I have 2 RPC queues for different services/ I declare them both in the same
way - declaring both queues for the rpcserver with this line

      ch.queueDeclare(QueueName, false,false,true,null)

(obviously giving  different names in the first parameter for the different
queues.. )
But only the first queue is sometimes deleted.
I have tried to see if it happens when the last client is shut down but it
is not related.
1. When do you think it could happen?
2. Should I declare it in another way? Like changing the third parameter -
autodelete to false?
(  though it should never be deleted because the server app is still holding
a handle to it, no?)
Any hints would be highly appreciated.


On Fri, Jul 15, 2011 at 12:27 PM, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> On 14/07/11 07:35, mysurf mail wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i>
</I>&gt;<i> &gt; Can all the clients be configurated with the same queuename (&quot;&quot;) and the
</I>&gt;<i> &gt; same routing key (the same for all)?
</I>&gt;<i>
</I>&gt;<i> There are two queues required for an RPC call over AMQP. The first is
</I>&gt;<i> the work queue for the service. The request published by the RPC client
</I>&gt;<i> needs to end up in this queue and be consumed by the RPC server. The
</I>&gt;<i> second is the callback queue. This is declared by the RPC client and
</I>&gt;<i> receives the reply from the RPC server.
</I>&gt;<i>
</I>&gt;<i> When multiple RPC clients are making use of the same RPC service then
</I>&gt;<i> they should all use the same routing key so that all requests for that
</I>&gt;<i> service go to the same work queue. This is called RPC_QUEUE_NAME in the
</I>&gt;<i> relevant Java tutorial:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/tutorials/tutorial-six-java.html">http://www.rabbitmq.com/tutorials/tutorial-six-java.html</A>
</I>&gt;<i>
</I>&gt;<i> When you make use of RpcClient in the Java client (see
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://hg.rabbitmq.com/rabbitmq-java-client/file/default/src/com/rabbitmq/client/RpcClient.java">http://hg.rabbitmq.com/rabbitmq-java-client/file/default/src/com/rabbitmq/client/RpcClient.java</A>
</I>&gt;<i> )
</I>&gt;<i>
</I>&gt;<i> you will see each client declares its own callback queue, so these are
</I>&gt;<i> not shared. If a queue is declared with an empty name then the server
</I>&gt;<i> assigns a random name. (See the &quot;Temporary Queues&quot; explanation in the
</I>&gt;<i> 3rd tutorial.) So even if it looks like all the clients are declaring
</I>&gt;<i> the same queue named &quot;&quot;, they are all using different callback queues.
</I>&gt;<i> This is the recommended approach.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110718/565cbb70/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110718/565cbb70/attachment.htm</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013904.html">[rabbitmq-discuss] Fwd: a few json rpc questions
</A></li>
	<LI>Next message: <A HREF="013947.html">[rabbitmq-discuss] Fwd: a few json rpc questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13946">[ date ]</a>
              <a href="thread.html#13946">[ thread ]</a>
              <a href="subject.html#13946">[ subject ]</a>
              <a href="author.html#13946">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
