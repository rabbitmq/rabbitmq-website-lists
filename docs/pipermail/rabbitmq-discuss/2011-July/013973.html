<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Management plugin crash server at startup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Management%20plugin%20crash%20server%20at%20startup&In-Reply-To=%3C89583B36-2B3E-4745-91D9-811BF50B6382%40jaxx.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013974.html">
   <LINK REL="Next"  HREF="013975.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Management plugin crash server at startup</H1>
    <B>Julien Banchet</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Management%20plugin%20crash%20server%20at%20startup&In-Reply-To=%3C89583B36-2B3E-4745-91D9-811BF50B6382%40jaxx.org%3E"
       TITLE="[rabbitmq-discuss] Management plugin crash server at startup">jaxx at jaxx.org
       </A><BR>
    <I>Mon Jul 18 20:39:27 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013974.html">[rabbitmq-discuss] Management plugin(s) crash server at startup
</A></li>
        <LI>Next message: <A HREF="013975.html">[rabbitmq-discuss] Management plugin crash server at startup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13973">[ date ]</a>
              <a href="thread.html#13973">[ thread ]</a>
              <a href="subject.html#13973">[ subject ]</a>
              <a href="author.html#13973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello!

(Reposted+edited since I forgot to join the list first)

I'm trying to move my actual (working) RabbitMQ node to another, less
loaded, server (actually another VM, hidden from internet, which will
also have a memcache).

So after setting up a barebone 64b Debian6 from a netinst and adding
RabbitMQ repo and installing it I got a working node.

Problem is, the management plugin seems to die, bringing down the
daemon with it after a couple of seconds (immediatly after start,
rabbitmq_ctl status does list plugins, two seconds later it's dead
already):

[... end of output launched from cli <A HREF="http://pastebin.com/rQGBDbF8">http://pastebin.com/rQGBDbF8</A> ]
broker running
** Found 0 name clashes in code paths
Erlang has closed
{&quot;Kernel pid
terminated&quot;,application_controller,&quot;{application_start_failure,rabbitmq_management,
{bad_return,{{rabbit_mgmt_app,start,[normal,[]]},{'EXIT',{timeout,
{gen_server,call,[rabbit_mochiweb_registry,
{add,rabbit_mgmt,#Fun&lt;rabbit_mochiweb.2.78160903&gt;,#Fun&lt;rabbit_mochiweb.
5.23044403&gt;,{[109,103,109,116],
[77,97,110,97,103,101,109,101,110,116,58,32,87,101,98,32,85,73]}}]}}}}}}&quot;}
_____________
[... end of <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mqcache.log</A> ]
=INFO REPORT==== 18-Jul-2011::17:57:27 ===
Management agent started.

=INFO REPORT==== 18-Jul-2011::17:57:27 ===
Management plugin started.
HTTP API:       <A HREF="http://mqcache:55672/api/">http://mqcache:55672/api/</A>
Management UI:  <A HREF="http://mqcache:55672/mgmt/">http://mqcache:55672/mgmt/</A>

=INFO REPORT==== 18-Jul-2011::17:57:32 ===
   application: rabbitmq_management
   exited: {bad_return,
               {{rabbit_mgmt_app,start,[normal,[]]},
                {'EXIT',
                    {timeout,
                        {gen_server,call,
                            [rabbit_mochiweb_registry,
                             {add,rabbit_mgmt,
                                 #Fun&lt;rabbit_mochiweb.2.78160903&gt;,
                                 #Fun&lt;rabbit_mochiweb.5.23044403&gt;,
                                 {&quot;mgmt&quot;,&quot;Management: Web UI&quot;}}]}}}}}
   type: permanent

=INFO REPORT==== 18-Jul-2011::17:57:32 ===
stopped TCP Listener on [::]:5672

Crash dump was written to: erl_crash.dump
Kernel pid terminated (application_controller)
({application_start_failure,rabbitmq_management,{bad_return,
{{rabbit_mgmt_app,start,[normal,[]]},{'EXIT',{timeout,{gen_server,call,
[rabbit_mochiweb_reg


All plugin files are there, I even compared the CRCs with my actual
RabbitMQ installation (which is another VM, just internet wise +
apache/mysql/etc...) . It's an independant node, no clustering,
replication, nothing special involved. Installing plugins one after
another boils it down to rabbitmq_management alone being the culprit.

As said, it's a fresh and updated Deb6 64b 2 CPUs, 2Gigs of RAM.
Erlang R14A (erts-5.8)
RabbitMQ 2.5.1
# md5sum *.ez
2602dd3df87fa4c7dedd6eb3192b0c19  amqp_client-2.5.1.ez
07f3b87ccb1d03d479a4277014a7e017  mochiweb-1.3-rmq2.5.1-git9a53dbd.ez
69aa2c17ebfff7bdf141d8df0b358631  rabbitmq_management-2.5.1.ez
4165b7d2aeeeeae9239b173b5e803c89  rabbitmq_management_agent-2.5.1.ez
0cd0b60bd8b9019fd9dbea08f667a697  rabbitmq_mochiweb-2.5.1.ez
2c7fddc210317a054c97b43e13d38ced  webmachine-1.7.0-rmq2.5.1-
hg0c4b60a.ez

The only diff I can imagine is that no queues/exchanges have ever been
created yet, and there's already an admin user created on it.

Has anyone encountered this? Erlang is a bit chinese to me, I might
have missed an obvious message somewhere, but I can't figure it out
yet :-)

Thanks in advance,

JaXX
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110718/65e39e16/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110718/65e39e16/attachment.htm</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013974.html">[rabbitmq-discuss] Management plugin(s) crash server at startup
</A></li>
	<LI>Next message: <A HREF="013975.html">[rabbitmq-discuss] Management plugin crash server at startup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13973">[ date ]</a>
              <a href="thread.html#13973">[ thread ]</a>
              <a href="subject.html#13973">[ subject ]</a>
              <a href="author.html#13973">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
