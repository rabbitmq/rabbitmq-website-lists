<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Installation%20Trouble%20on%20Windows%20-%20%22The%0A%20handle%20is%09invalid%22&In-Reply-To=%3C1776037840.451663.1311761901870.JavaMail.root%40zimbra-prod-mbox-4.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014195.html">
   <LINK REL="Next"  HREF="014205.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;</H1>
    <B>Ann Witbrock (c)</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Installation%20Trouble%20on%20Windows%20-%20%22The%0A%20handle%20is%09invalid%22&In-Reply-To=%3C1776037840.451663.1311761901870.JavaMail.root%40zimbra-prod-mbox-4.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;">awitbrock at vmware.com
       </A><BR>
    <I>Wed Jul 27 11:18:21 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014195.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
</A></li>
        <LI>Next message: <A HREF="014205.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is invalid&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14196">[ date ]</a>
              <a href="thread.html#14196">[ thread ]</a>
              <a href="subject.html#14196">[ subject ]</a>
              <a href="author.html#14196">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Chris, 
I'm sorry our troubleshooting instructions weren't able to help you. 

Does the rabbitmq service still appear in your list of services? 
Is epmd.exe still running in your processes? You may like to kill that. 
Did you make any change to the cookie or was that ok? 

It sounds like you had an older version already installed. Is that correct? 
If so, you may need to install the older version combination in order to stop and remove the old service. 
After removing the service you should be able to uninstall rabbitmq, remove directories (including mnesia and logs if you want) and uninstall erlang, and remove any&#160;environment variables&#160;you dont want (eg from path and ERLANG_HOME). 
Double check there is no RabbitMQ service present and that epmd.exe is not running. You may wish to reboot. 

After that a clean&#160;fresh install should work ok. Our &quot;experimental&quot; installer works quite well, just ensure you stop, remove and start the service again (or reboot) after adding plugins. Also remember you may need to run some steps as administrator (elevated permission). 

Ann 

----- Original Message -----

From: &quot;Christopher Moloney&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">cmoloney at vt.edu</A>&gt; 
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> 
Sent: Wednesday, 27 July, 2011 1:16:54 AM 
Subject: [rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;invalid&quot; 


Hello, 
I am new to rabbitmq and these sorts of messaging services. I am having trouble installing RabbitMQ on window7. I would like to use it in conjunction with django-celery to manage a task queue. 
I looked around the archives but I didn&#8217;t see anything that offered a solution to my problem. 
Here is a summary of what I have done thus far. First I installed erlang 5.8.4 and rabbitmq 2.5.1 and followed the procedure on the windows install page. Everything seemed to go well, however when I tried to run the server it continually returned node down. In the hello world example using pika I got the message that the connection was actively refused by the machine. So first I checked my firewall to make sure port 5672 was open. Then, I made sure my C:/Windows .erlang.cookie matched the on in my user directory. 
Starting the server I would get a boot error that was not very descriptive: error, badmatch error. 
So I decided to try to uninstall and run the prepackaged windows binaries. Well then there was a windows service error mismatch because I had installed erlang 5.8.4 and the windows binaries used 5.8.3. &#160; The windows service was point to the wrong directory. Service.msc does not allow you to edit the path. I used the SC DELETE command at the terminal to remove the RabbitMQ service imaging that a fresh install would replace the service value with the correct location. 
Since then I have not been able to add the service back. When I attempt to run &#8216;rabbitmq-service install&#8217; get the message: Warning, could not set correct service description (comment) Error: The handle is invalid. 
The same message comes up when I run any of the commands. I have tried to wipe all traces of erlang and rabbit from my machine to start again, but it has not been possible. I would really like to resolve this matter and get the messaging server up and running. 
Any suggestions? I appreciate any assistance. 
Thanks. 
Chris 
_______________________________________________ 
rabbitmq-discuss mailing list 
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> 
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110727/0f9f3727/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110727/0f9f3727/attachment.htm</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014195.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
</A></li>
	<LI>Next message: <A HREF="014205.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is invalid&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14196">[ date ]</a>
              <a href="thread.html#14196">[ thread ]</a>
              <a href="subject.html#14196">[ subject ]</a>
              <a href="author.html#14196">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
