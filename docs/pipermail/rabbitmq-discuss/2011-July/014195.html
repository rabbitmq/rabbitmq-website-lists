<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Installation%20Trouble%20on%20Windows%20-%20%22The%0A%20handle%20is%09invalid%22&In-Reply-To=%3C4E2FE551.5010203%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014194.html">
   <LINK REL="Next"  HREF="014196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Installation%20Trouble%20on%20Windows%20-%20%22The%0A%20handle%20is%09invalid%22&In-Reply-To=%3C4E2FE551.5010203%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;">emile at rabbitmq.com
       </A><BR>
    <I>Wed Jul 27 11:15:45 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014194.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
</A></li>
        <LI>Next message: <A HREF="014196.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14195">[ date ]</a>
              <a href="thread.html#14195">[ thread ]</a>
              <a href="subject.html#14195">[ subject ]</a>
              <a href="author.html#14195">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christopher,

On 27/07/11 01:16, Christopher Moloney wrote:

&gt;<i> Here is a summary of what I have done thus far. First I installed erlang
</I>&gt;<i> 5.8.4 and rabbitmq 2.5.1 and followed the procedure on the windows
</I>&gt;<i> install page. Everything seemed to go well, however when I tried to run
</I>&gt;<i> the server it continually returned node down. In the hello world example
</I>
Could you tell by using the troubleshooting tips at
<A HREF="http://www.rabbitmq.com/install.html#troubleshooting">http://www.rabbitmq.com/install.html#troubleshooting</A>
whether the broker was running at this point?
Was the &quot;nodedown&quot; a result of running the rabbitmqctl script?
Were the .erlang.cookies matching at this time?

&gt;<i> using pika I got the message that the connection was actively refused by
</I>&gt;<i> the machine. So first I checked my firewall to make sure port 5672 was
</I>&gt;<i> open. Then, I made sure my C:/Windows .erlang.cookie matched the on in
</I>&gt;<i> my user directory.
</I>&gt;<i> 
</I>&gt;<i> Starting the server I would get a boot error that was not very
</I>&gt;<i> descriptive: error, badmatch error.
</I>
What command preceded this error, and was there any additional
information following the error?

&gt;<i> So I decided to try to uninstall and run the prepackaged windows
</I>&gt;<i> binaries. Well then there was a windows service error mismatch because I
</I>&gt;<i> had installed erlang 5.8.4 and the windows binaries used 5.8.3.  The
</I>
This is not a problem. You must set the %ERLANG_HOME% variable in any
case. Also see the rabbitmq-service documentation at
<A HREF="http://www.rabbitmq.com/man/rabbitmq-service.man.html">http://www.rabbitmq.com/man/rabbitmq-service.man.html</A>

&gt;<i> windows service was point to the wrong directory. Service.msc does not
</I>&gt;<i> allow you to edit the path. I used the SC DELETE command at the terminal
</I>&gt;<i> to remove the RabbitMQ service imaging that a fresh install would
</I>&gt;<i> replace the service value with the correct location.
</I>
It is possible to modify the service parameters by installing the
service again, as explained in the rabbitmq-service documentation:
<A HREF="http://www.rabbitmq.com/install.html#running-windows-service">http://www.rabbitmq.com/install.html#running-windows-service</A>

&gt;<i> Since then I have not been able to add the service back. When I attempt
</I>&gt;<i> to run &#8216;rabbitmq-service install&#8217; get the message: Warning, could not
</I>&gt;<i> set correct service description (comment) Error: The handle is invalid.
</I>
I would recommend using the &quot;rabbitmq-service.bat remove&quot; command to
remove the service. See the documentation:
<A HREF="http://www.rabbitmq.com/man/rabbitmq-service.man.html#Commands">http://www.rabbitmq.com/man/rabbitmq-service.man.html#Commands</A>

Running &quot;SC DELETE&quot; may have caused problems. There are additional
registry keys that need to be removed if you want to completely remove
the service. On my workstation they are under
HKEY_LOCAL_MACHINE\SOFTWARE\Ericsson\Erlang\ErlSrv\1.1\RabbitMQ

You must use the rabbitmq-service.bat (or the Erlang Service Manager
directly) to modify services. If these fail then you may need to remove
the registry keys manually. Needless to say, this is not standard
operating procedure and you risk even more serious problem if you make a
mistake. Take a backup first.

&gt;<i> The same message comes up when I run any of the commands. I have tried
</I>&gt;<i> to wipe all traces of erlang and rabbit from my machine to start again,
</I>&gt;<i> but it has not been possible. I would really like to resolve this matter
</I>&gt;<i> and get the messaging server up and running.
</I>&gt;<i> 
</I>&gt;<i> Any suggestions? I appreciate any assistance.
</I>
Clean up the registry and make sure you install and remove the service
using the rabbitmq-service.bat script. Your experience suggests that we
could add more troubleshooting tips. Please let us know if you wish to
suggest some.


-Emile

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014194.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
</A></li>
	<LI>Next message: <A HREF="014196.html">[rabbitmq-discuss] Installation Trouble on Windows - &quot;The handle is	invalid&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14195">[ date ]</a>
              <a href="thread.html#14195">[ thread ]</a>
              <a href="subject.html#14195">[ subject ]</a>
              <a href="author.html#14195">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
