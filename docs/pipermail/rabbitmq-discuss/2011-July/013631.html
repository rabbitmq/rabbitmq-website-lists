<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Reordering on requeue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Reordering%20on%20requeue&In-Reply-To=%3C4E1198BE.8050307%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013628.html">
   <LINK REL="Next"  HREF="013632.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Reordering on requeue</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Reordering%20on%20requeue&In-Reply-To=%3C4E1198BE.8050307%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Reordering on requeue">emile at rabbitmq.com
       </A><BR>
    <I>Mon Jul  4 11:41:02 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013628.html">[rabbitmq-discuss] Reordering on requeue
</A></li>
        <LI>Next message: <A HREF="013632.html">[rabbitmq-discuss] Reordering on requeue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13631">[ date ]</a>
              <a href="thread.html#13631">[ thread ]</a>
              <a href="subject.html#13631">[ subject ]</a>
              <a href="author.html#13631">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jiri,

On 04/07/11 07:35, Jiri Krutil wrote:
&gt;&gt;&gt;<i> Will a requeued message be pushed back onto the queue tail or will it
</I>&gt;&gt;&gt;<i> stay at the head?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It will go to the tail. We are considering changing that behaviour for 
</I>&gt;&gt;<i> channel/connection closure and basic.recover{requeue=true}, but 
</I>&gt;&gt;<i> basic.reject/nack will likely stay as they are.
</I>&gt;<i> 
</I>&gt;<i> I asked because I was wondering if there is a way in rabbit how to
</I>&gt;<i> emulate read-only queue browsing, as supported by Qpid. (I think they
</I>&gt;<i> support it because they are so JMS-like.)
</I>
If you are attempting to scan all the messages in a queue without
removing them then this is not currently possible. The closest
alternative is to fetch and recover messages with the requeue flag
turned on, but this is not guaranteed to preserve message order. We are
currently working on preserving message order of queues with a single
consumer issuing basic.recover{requeue=true}.

&gt;<i> I guess currently this can only be done in rabbit using the management
</I>&gt;<i> plugin? And should not be used for regular processing, but only for
</I>&gt;<i> ad-hoc monitoring?
</I>
The management plugin does not have privileged access to queue messages.
Viewing a message with the requeue option has the same effect as using
basic.get and basic.recover with any client library that supports those
operations.

&gt;<i> I understand queue browsing is not in AMQP standard, but a Qpid
</I>&gt;<i> extension, correct?
</I>
javax.jms.QueueBrowser appears in JMS, so you should see an
implementations of that interface in many providers.

&gt;<i> What about the message ordering on reject - I assume the specs does not
</I>&gt;<i> say where should a requeued message appear on the queue?
</I>
Messages that are returned to the queue due to
basic.recover{requeue=true} as well as basis.reject go to the tail of
the queue.


-Emile
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013628.html">[rabbitmq-discuss] Reordering on requeue
</A></li>
	<LI>Next message: <A HREF="013632.html">[rabbitmq-discuss] Reordering on requeue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13631">[ date ]</a>
              <a href="thread.html#13631">[ thread ]</a>
              <a href="subject.html#13631">[ subject ]</a>
              <a href="author.html#13631">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
