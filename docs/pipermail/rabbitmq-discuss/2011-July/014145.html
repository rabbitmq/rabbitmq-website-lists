<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel with exchange-exchange bindings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20with%20exchange-exchange%20bindings&In-Reply-To=%3C20110725105659.GB398%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014143.html">
   <LINK REL="Next"  HREF="014146.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel with exchange-exchange bindings</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20with%20exchange-exchange%20bindings&In-Reply-To=%3C20110725105659.GB398%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Shovel with exchange-exchange bindings">matthew at rabbitmq.com
       </A><BR>
    <I>Mon Jul 25 11:56:59 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014143.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
        <LI>Next message: <A HREF="014146.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14145">[ date ]</a>
              <a href="thread.html#14145">[ thread ]</a>
              <a href="subject.html#14145">[ subject ]</a>
              <a href="author.html#14145">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Simone,

On Mon, Jul 25, 2011 at 09:45:09AM +0000, Busoli, Simone wrote:
&gt;<i> I'm trying to set up a shovel with exchange-exchange bindings to
</I>&gt;<i> workaround the issue with infinite loops when configuring a symmetric
</I>&gt;<i> shovel between two brokers (to achieve transparent bidirectional
</I>&gt;<i> communication), but I get an error on broker startup as if the shovel
</I>&gt;<i> didn't support exchange-exchange bindings.
</I>&gt;<i> 
</I>&gt;<i> As suggested by Matthew some time ago on the list this is what I'm
</I>&gt;<i> trying to accomplish:
</I>&gt;<i> 
</I>&gt;<i>               /---------------------[ Shovel 2 ]---------------------\
</I>&gt;<i>               |                                                      |
</I>&gt;<i>               V                                                      |
</I>&gt;<i> ---&gt;[X1]---&gt;[X2]----&gt;[[my queues]]        [[my queues]]&lt;---[X2]&lt;---[X1]&lt;---
</I>&gt;<i>      |                                                       ^
</I>&gt;<i>      |                                                       |
</I>&gt;<i>      \------------------[ Shovel 1 ]-------------------------/
</I>
That's a very pretty picture ;)

&gt;<i> But on broker startup I get  this:
</I>&gt;<i> 
</I>&gt;<i> {&quot;Kernel pid terminated&quot;,application_controller,&quot;{application_start_failure,rabbitmq_shovel,{{invalid_shovel_configuration,test1,{invalid_parameter_value,sources,{unknown_method_name,'exchange.bind'}}},{rabbit_shovel,start,[normal,[]]}}}&quot;}
</I>&gt;<i> 
</I>
Yup. I've just fixed this on default - if you pull from our hg repos,
update, and compile again, then you'll get it working though check the
README because a few other things have changed in the mean time (like
support for confirms has been added, and support for transactions has
been removed).

In short, the problem was that the shovel predated Rabbit's support of
AMQP 0-9-1. When 0-9-1 was added, the shovel seems to have been forced
to check only 0-8 methods. As such, it didn't have support for our
extensions to 0-9-1 (at least from configuration - the actual erlang
client being used does connect using 0-9-1 and uses those features that
we've added, such as confirms). Anyway, fixed now.

Many thanks for the bug reports - the shovel will clearly benefit!


Matthew
</PRE>





































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014143.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
	<LI>Next message: <A HREF="014146.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14145">[ date ]</a>
              <a href="thread.html#14145">[ thread ]</a>
              <a href="subject.html#14145">[ subject ]</a>
              <a href="author.html#14145">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
