<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-c -- multiple exectables receiving same message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-c%20--%20multiple%20exectables%20receiving%0A%20same%20message&In-Reply-To=%3C8A1A883E3F171B42A81817DEC138352C1DB3305B56%40MX06A.corp.emc.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013596.html">
   <LINK REL="Next"  HREF="013597.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-c -- multiple exectables receiving same message</H1>
    <B>Lowell.Boggs at emc.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-c%20--%20multiple%20exectables%20receiving%0A%20same%20message&In-Reply-To=%3C8A1A883E3F171B42A81817DEC138352C1DB3305B56%40MX06A.corp.emc.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-c -- multiple exectables receiving same message">Lowell.Boggs at emc.com
       </A><BR>
    <I>Fri Jul  1 15:02:21 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013596.html">[rabbitmq-discuss] rabbitmq-c -- multiple exectables receiving same message
</A></li>
        <LI>Next message: <A HREF="013597.html">[rabbitmq-discuss] reading time extending on persistent messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13593">[ date ]</a>
              <a href="thread.html#13593">[ thread ]</a>
              <a href="subject.html#13593">[ subject ]</a>
              <a href="author.html#13593">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Also,
The one piece of the tutorial I have not actually duplicated in my experiments is the use of the durable flag on queue creation and the use use of persistent in the message creation.  Would that have anything to do with the round robin distribution of messages to queues?

Thanks,
   Lowell

________________________________
From: Simone Busoli [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simone.busoli at gmail.com</A>]
Sent: Thursday, June 30, 2011 5:06 PM
To: Boggs Jr., Lowell
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] rabbitmq-c -- multiple exectables receiving same message


Hi Lowell,

The second tutorial does not use a topic exchange, but even with a topic exchange the situation would be the same. The key point here is that your workers are reading messages from the same queue. The exchange, topic or anything else, as soon as it has delivered a message to a queue is out of the game. The queue receives the message because it's bound to the exchange. Then you have two or more workers reading from the same queue, thereby receiving each one message in a round-robin fashion.

On Jun 30, 2011 11:29 PM, &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Lowell.Boggs at emc.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Lowell.Boggs at emc.com</A>&gt;&gt; wrote:
&gt;<i> I am confused by my experiments with rabbitmq-c.
</I>&gt;<i>
</I>&gt;<i> I was trying to follow the task worker tutorial:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/tutorials/tutorial-two-python.html">http://www.rabbitmq.com/tutorials/tutorial-two-python.html</A>
</I>&gt;<i>
</I>&gt;<i> Of course, I'm using C interfaces not the python or Java interfaces.
</I>&gt;<i>
</I>&gt;<i> Being a newbie it is probable that I'm doing something wrong, but:
</I>&gt;<i>
</I>&gt;<i> The tutorial implies to me that if I have:
</I>&gt;<i>
</I>&gt;<i> * one exchange+topic
</I>&gt;<i> * two worker executables that read from it
</I>&gt;<i>
</I>&gt;<i> then
</I>&gt;<i>
</I>&gt;<i> * due to round-robin processing, some messages will go to one executable
</I>&gt;<i> * other messages will go to the other
</I>&gt;<i>
</I>&gt;<i> However, I am seeing that both exectuables receive all the messages -- which is not at all what I want.
</I>&gt;<i>
</I>&gt;<i> Is this supposed to work with the default version of rabbitmq-c?
</I>&gt;<i>
</I>&gt;<i> Immediately upon logging into the channel, in the consumers, I am setting
</I>&gt;<i>
</I>&gt;<i> basic_qos(conn, 1, 0, 1, 0);
</I>&gt;<i>
</I>&gt;<i> Also, I am calling basic_consume like this:
</I>&gt;<i>
</I>&gt;<i> amqp_basic_consume(conn,
</I>&gt;<i> 1,
</I>&gt;<i> amqp_cstring_bytes(queuename),
</I>&gt;<i> amqp_empty_bytes,
</I>&gt;<i> 0,
</I>&gt;<i> 0,
</I>&gt;<i> 0,
</I>&gt;<i> amqp_empty_table
</I>&gt;<i> );
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The exchange that i am using is amq.direct. I have tried an empty string queue name as well as &quot;hello&quot;.
</I>&gt;<i>
</I>&gt;<i> I am calling basic_ack() as soon as I receive the messages in both worker executables -- well, after I log their reception.
</I>&gt;<i>
</I>&gt;<i> Any ideas?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Lowell
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110701/da7ed72c/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110701/da7ed72c/attachment.htm</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013596.html">[rabbitmq-discuss] rabbitmq-c -- multiple exectables receiving same message
</A></li>
	<LI>Next message: <A HREF="013597.html">[rabbitmq-discuss] reading time extending on persistent messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13593">[ date ]</a>
              <a href="thread.html#13593">[ thread ]</a>
              <a href="subject.html#13593">[ subject ]</a>
              <a href="author.html#13593">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
