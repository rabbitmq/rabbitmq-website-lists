<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ crash in production - help diagnose from log
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20crash%20in%20production%20-%20help%20diagnose%0A%20from%20log&In-Reply-To=%3CBANLkTimdfr73m9r%2BEcfZFX_J05QbBiuZ8A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013819.html">
   <LINK REL="Next"  HREF="013620.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ crash in production - help diagnose from log</H1>
    <B>Bryan Alves</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20crash%20in%20production%20-%20help%20diagnose%0A%20from%20log&In-Reply-To=%3CBANLkTimdfr73m9r%2BEcfZFX_J05QbBiuZ8A%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ crash in production - help diagnose from log">bryanalves at gmail.com
       </A><BR>
    <I>Sat Jul  2 16:05:20 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013819.html">[rabbitmq-discuss] Feedback on STOMP changes
</A></li>
        <LI>Next message: <A HREF="013620.html">[rabbitmq-discuss] RabbitMQ crash in production - help diagnose from log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13618">[ date ]</a>
              <a href="thread.html#13618">[ thread ]</a>
              <a href="subject.html#13618">[ subject ]</a>
              <a href="author.html#13618">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is the first time it happened, and the system had been in production
for a few months. The load (in messages/sec) had maybe been up a bit
recently, and become a little spikey, but still on the order of dozens to
low hundreds per second.

If upgrading is likely to fix the situation we can try setting that up. I'd
like to avoid that effort if its not going to solve this specific problem
(not a huge fan of upgrading &quot;just because&quot;)

Also, it's probably obvious from the report, we can't reproduce the problem.

Thanks for taking a look at this. If there is anything else you need from
me, let me know.

On Jul 2, 2011 8:13 AM, &quot;Matthias Radestock&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Bryan,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 02/07/11 02:56, Bryan Alves wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> A production instance of RabbitMQ crashed on us yesterday, and we have
</I>&gt;&gt;<i> no idea why.  RabbitMQ 2.3.1 &amp; Erlang R14B01
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Is that the first time it happened? And for how long had that rabbit been
</I>running when it perished?
&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Attached is the SASL log and erl_crash.dump file.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks. It looks like the crash might be triggered by a rare race
</I>condition. The message store gc is trying to combine two files, one of which
appears to have vanished from its index. It should be impossible to end up
in that situation. Nothing obvious jumps out at me from the code, so this
may take a while to track down.
&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Any advice about what could  have caused the crashed and how to avoid it
</I>&gt;&gt;<i> in the future would be appreciated.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I suggest you upgrade to 2.5.1. There have been some changes in that area
</I>of the code, though nothing specifically related to the above. So I doubt
the problem will go away with 2.5.1, but it would help to find out for sure.
&gt;<i>
</I>&gt;<i> Thanks for bringing this problem to our attention.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110702/a2c4352b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110702/a2c4352b/attachment.htm</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013819.html">[rabbitmq-discuss] Feedback on STOMP changes
</A></li>
	<LI>Next message: <A HREF="013620.html">[rabbitmq-discuss] RabbitMQ crash in production - help diagnose from log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13618">[ date ]</a>
              <a href="thread.html#13618">[ thread ]</a>
              <a href="subject.html#13618">[ subject ]</a>
              <a href="author.html#13618">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
