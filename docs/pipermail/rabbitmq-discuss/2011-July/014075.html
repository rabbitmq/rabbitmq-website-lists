<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting	for frames already received
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ-C%3A%20amqp_simple_rpc%20blocks%20waiting%0A%09for%20frames%20already%20received&In-Reply-To=%3Cyrv4cwrfbvrev.fsf%40dwragg.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014071.html">
   <LINK REL="Next"  HREF="014085.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting	for frames already received</H1>
    <B>David Wragg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ-C%3A%20amqp_simple_rpc%20blocks%20waiting%0A%09for%20frames%20already%20received&In-Reply-To=%3Cyrv4cwrfbvrev.fsf%40dwragg.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting	for frames already received">david at rabbitmq.com
       </A><BR>
    <I>Thu Jul 21 11:50:32 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014071.html">[rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting for	frames already received
</A></li>
        <LI>Next message: <A HREF="014085.html">[rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting	for frames already received
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14075">[ date ]</a>
              <a href="thread.html#14075">[ thread ]</a>
              <a href="subject.html#14075">[ subject ]</a>
              <a href="author.html#14075">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Clint Miller &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">clint at rtcreativegroup.com</A>&gt; writes:
&gt;<i> I'm having a little trouble with the RabbitMQ-C library. I'm able to
</I>&gt;<i> declare exchanges, queues, setup bindings, and start the basic.consume
</I>&gt;<i> (amqp_simple_rpc function) method as I would expect.
</I>
You are calling the amqp_basic_*, amqp_queue_* and amqp_exchange_*
functions, right?  amqp_simple_rpc is best thought of as an internal
function, and calling it directly should never be necessary these days.
None of the sample code in the tools/ and examples/ directories uses it.

&gt;<i> But when a message is received by the consumer, I am able to observe
</I>&gt;<i> (via the debugger) the complete message (all the frames) being
</I>&gt;<i> processed. However, loop where multiple frames are linked together in
</I>&gt;<i> the amqp_simple_rpc function (labeled &quot;retry:&quot;) never terminates, and
</I>&gt;<i> thus, at the end of what I think is a correct processing of all the
</I>&gt;<i> frames in the message, control goes back into the wait_frame_inner
</I>&gt;<i> function, where the recv function is called, anticipating more raw
</I>&gt;<i> data on the socket that isn't going to arrive.
</I>
amqp_simple_rpc doesn't process incoming messages.  If it gets an
incoming frame that doesn't relate to the method, it stashes that frame
away for later handling, and waits for the next frame (as the reply
method frame should arrive sooner or later).

To consume messages via basic.get, use amqp_basic_get and then
amqp_simple_wait_frame to receive the body (see tools/get.c).

To consume messages via basic.consume, use amqp_basic_consume and then
call amqp_simple_wait_frame in a loop (see tools/consume.c and
examples/amqp_consumer.c).

-- 
David Wragg
Staff Engineer, RabbitMQ
VMware, Inc.
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014071.html">[rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting for	frames already received
</A></li>
	<LI>Next message: <A HREF="014085.html">[rabbitmq-discuss] RabbitMQ-C: amqp_simple_rpc blocks waiting	for frames already received
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14075">[ date ]</a>
              <a href="thread.html#14075">[ thread ]</a>
              <a href="subject.html#14075">[ subject ]</a>
              <a href="author.html#14075">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
