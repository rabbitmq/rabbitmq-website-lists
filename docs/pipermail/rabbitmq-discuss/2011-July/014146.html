<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel with exchange-exchange bindings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20with%20exchange-exchange%20bindings&In-Reply-To=%3C88E590DC4586974D825FC82AE798294E52020989%40GSVCLU03.ges.ferlan.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014145.html">
   <LINK REL="Next"  HREF="014147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel with exchange-exchange bindings</H1>
    <B>Busoli, Simone</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20with%20exchange-exchange%20bindings&In-Reply-To=%3C88E590DC4586974D825FC82AE798294E52020989%40GSVCLU03.ges.ferlan.it%3E"
       TITLE="[rabbitmq-discuss] Shovel with exchange-exchange bindings">Simone.Busoli at ferrari.com
       </A><BR>
    <I>Mon Jul 25 12:06:50 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014145.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
        <LI>Next message: <A HREF="014147.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14146">[ date ]</a>
              <a href="thread.html#14146">[ thread ]</a>
              <a href="subject.html#14146">[ subject ]</a>
              <a href="author.html#14146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you very much Matthew. Now, isn't there a chance that you have some spare time to add the max-hops option to the shovel addin as well? ;)
Because all I'm trying to do with these tricks is what I would accomplish with that.. I am already working on it, I've been able to build the addin and its dependencies on Ubuntu - which is unfamiliar environment for me - but my erlang-fu is still not very good.

As a side note,  as mentioned in another thread, shovel has a dependency on erlando, which is not documented in the readme.

-----Original Message-----
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] On Behalf Of Matthew Sackman
Sent: Monday, July 25, 2011 12:57 PM
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Shovel with exchange-exchange bindings

Hi Simone,

On Mon, Jul 25, 2011 at 09:45:09AM +0000, Busoli, Simone wrote:
&gt;<i> I'm trying to set up a shovel with exchange-exchange bindings to 
</I>&gt;<i> workaround the issue with infinite loops when configuring a symmetric 
</I>&gt;<i> shovel between two brokers (to achieve transparent bidirectional 
</I>&gt;<i> communication), but I get an error on broker startup as if the shovel 
</I>&gt;<i> didn't support exchange-exchange bindings.
</I>&gt;<i> 
</I>&gt;<i> As suggested by Matthew some time ago on the list this is what I'm 
</I>&gt;<i> trying to accomplish:
</I>&gt;<i> 
</I>&gt;<i>               /---------------------[ Shovel 2 ]---------------------\
</I>&gt;<i>               |                                                      |
</I>&gt;<i>               V                                                      |
</I>&gt;<i> ---&gt;[X1]---&gt;[X2]----&gt;[[my queues]]        [[my queues]]&lt;---[X2]&lt;---[X1]&lt;---
</I>&gt;<i>      |                                                       ^
</I>&gt;<i>      |                                                       |
</I>&gt;<i>      \------------------[ Shovel 1 ]-------------------------/
</I>
That's a very pretty picture ;)

&gt;<i> But on broker startup I get  this:
</I>&gt;<i> 
</I>&gt;<i> {&quot;Kernel pid 
</I>&gt;<i> terminated&quot;,application_controller,&quot;{application_start_failure,rabbitm
</I>&gt;<i> q_shovel,{{invalid_shovel_configuration,test1,{invalid_parameter_value
</I>&gt;<i> ,sources,{unknown_method_name,'exchange.bind'}}},{rabbit_shovel,start,
</I>&gt;<i> [normal,[]]}}}&quot;}
</I>&gt;<i> 
</I>
Yup. I've just fixed this on default - if you pull from our hg repos, update, and compile again, then you'll get it working though check the README because a few other things have changed in the mean time (like support for confirms has been added, and support for transactions has been removed).

In short, the problem was that the shovel predated Rabbit's support of AMQP 0-9-1. When 0-9-1 was added, the shovel seems to have been forced to check only 0-8 methods. As such, it didn't have support for our extensions to 0-9-1 (at least from configuration - the actual erlang client being used does connect using 0-9-1 and uses those features that we've added, such as confirms). Anyway, fixed now.

Many thanks for the bug reports - the shovel will clearly benefit!


Matthew
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>

_________________________________________________________________________________________________________________
Questo messaggio e da intendersi esclusivamente ad uso del destinatario e puo contenere informazioni che sono di natura privilegiata, confidenziale
o non divulgabile secondo le leggi vigenti. Se il lettore del presente messaggio non e il destinatario designato, o il dipendente/agente responsabile
per la consegna del messaggio al destinatario designato, si informa che ogni disseminazione, distribuzione o copiatura di questa comunicazione e 
strettamente proibita anche ai sensi del decreto legislativo 196/03 . Se avete ricevuto questo messaggio per errore, vi preghiamo di notificarcelo
immediatamente a mezzo e-mail di risposta e successivamente di procedere alla cancellazione di questa e-mail e relativi allegati dal vostro sistema.
_________________________________________________________________________________________________________________
This message is intended only for the use of the addressee and may contain information that is privileged, confidential and exempt from 
disclosure under applicable law. If the reader of this message is not the intended recipient, or the employee or agent responsible for delivering the 
message to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly 
prohibited. If you have received this e-mail in error, please notify us immediately by return e-mail and delete this e-mail and all attachments from 
your system.
_________________________________________________________________________________________________________________

</PRE>





































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014145.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
	<LI>Next message: <A HREF="014147.html">[rabbitmq-discuss] Shovel with exchange-exchange bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14146">[ date ]</a>
              <a href="thread.html#14146">[ thread ]</a>
              <a href="subject.html#14146">[ subject ]</a>
              <a href="author.html#14146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
