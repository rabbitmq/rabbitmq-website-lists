<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] MQTT plugin, QoS 1, Android, not consuming on reconnect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20MQTT%20plugin%2C%20QoS%201%2C%20Android%2C%0A%20not%20consuming%20on%20reconnect&In-Reply-To=%3CetPan.53d2b72c.66334873.1552e%40mercurio.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037255.html">
   <LINK REL="Next"  HREF="037258.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] MQTT plugin, QoS 1, Android, not consuming on reconnect</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20MQTT%20plugin%2C%20QoS%201%2C%20Android%2C%0A%20not%20consuming%20on%20reconnect&In-Reply-To=%3CetPan.53d2b72c.66334873.1552e%40mercurio.local%3E"
       TITLE="[rabbitmq-discuss] MQTT plugin, QoS 1, Android, not consuming on reconnect">mklishin at gopivotal.com
       </A><BR>
    <I>Fri Jul 25 20:59:11 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="037255.html">[rabbitmq-discuss] MQTT plugin, QoS 1, Android,	not consuming on reconnect
</A></li>
        <LI>Next message: <A HREF="037258.html">[rabbitmq-discuss] MQTT plugin, QoS 1, Android, not consuming on reconnect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37257">[ date ]</a>
              <a href="thread.html#37257">[ thread ]</a>
              <a href="subject.html#37257">[ subject ]</a>
              <a href="author.html#37257">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&#160;On 25 July 2014 at 23:54:35, brydev (<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">bcliffe at gmail.com</A>) wrote:
&gt;<i> &gt; =WARNING REPORT==== 25-Jul-2014::17:08:50  
</I>&gt;<i> ===
</I>&gt;<i> MQTT disconnecting duplicate client id &quot;sub1_19c6ee855806c472&quot;  
</I>&gt;<i> (&quot;10.144.103.154:40335(<A HREF="http://10.144.103.154:40335">http://10.144.103.154:40335</A>)  
</I>&gt;<i> -&gt; 143.239.72.239:1883(<A HREF="http://143.239.72.239:1883">http://143.239.72.239:1883</A>)&quot;)  
</I>&gt;<i>  
</I>&gt;<i>  
</I>&gt;<i> This gets called after a disconnect, if I call mClient.setCallback(MqttService.this);  
</I>&gt;<i> it forces the message queue onto the device but it only works sometimes,  
</I>&gt;<i> usually only on a fresh start.
</I>
So if I understand it correctly, when a client (Paho Java) loses connection,
you get no deliveries for re-registered subscription with the same client id,
but creating a completely new connection with the same client id makes
things work some of the time?

MQTT spec requires brokers to disconnect existing clients with the same client ID
when handling CONNECT:

&#171;If a client with the same Client ID is already connected to the server, the &quot;older&quot; client
must be disconnected by the server before completing the CONNECT flow of the new
client.&#187;

So I'm curious if the issue may have something to do with lost connections not being
detected fast enough.

How do you simulate lost client connections? What [MQTT] heartbeat value do you use?
--  
MK  

Staff Software Engineer, Pivotal/RabbitMQ
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037255.html">[rabbitmq-discuss] MQTT plugin, QoS 1, Android,	not consuming on reconnect
</A></li>
	<LI>Next message: <A HREF="037258.html">[rabbitmq-discuss] MQTT plugin, QoS 1, Android, not consuming on reconnect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37257">[ date ]</a>
              <a href="thread.html#37257">[ thread ]</a>
              <a href="subject.html#37257">[ subject ]</a>
              <a href="author.html#37257">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
