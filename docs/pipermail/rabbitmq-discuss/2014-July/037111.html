<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] default_user vs definitions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20default_user%20vs%20definitions&In-Reply-To=%3C53BC07E8.3030204%40alertme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037103.html">
   <LINK REL="Next"  HREF="037112.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] default_user vs definitions</H1>
    <B>Dmitry Andrianov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20default_user%20vs%20definitions&In-Reply-To=%3C53BC07E8.3030204%40alertme.com%3E"
       TITLE="[rabbitmq-discuss] default_user vs definitions">dmitry.andrianov at alertme.com
       </A><BR>
    <I>Tue Jul  8 16:02:00 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="037103.html">[rabbitmq-discuss] Connection is always in &quot;flow&quot; State.
</A></li>
        <LI>Next message: <A HREF="037112.html">[rabbitmq-discuss] default_user vs definitions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37111">[ date ]</a>
              <a href="thread.html#37111">[ thread ]</a>
              <a href="subject.html#37111">[ subject ]</a>
              <a href="author.html#37111">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello.

RabbitMQ 3.3.4. In the rabbitmq.config we have both default user and 
loading of definitions JSON like that:

   {rabbit, [
       {default_user, &lt;&lt;&quot;default&quot;&gt;&gt;},
       {default_pass, &lt;&lt;&quot;password&quot;&gt;&gt;},
...
     ]},
   {rabbitmq_management, [{load_definitions, 
&quot;/etc/rabbitmq/definitions.json&quot;}]},

And if we have users in that JSON - they get created. However if we 
remove users from JSON, the default one does not get created. (We 
stopping, removing mnesia and starting again). Disabling definition JSON 
makes default user to appear.
I am not sure if it is an intended behaviour or just some race condition 
when the server core makes a wrong decision regarding is it the first 
start or not because management plugin has already created some entities.

The reason why we prefer creating user with rabbitmq.config is because 
the password there is plaintext while definitions requires a hash.
Usernames and passwords get populated from some master file during the 
deployment. We need plaintext password for clients so it is already in 
that file. Using JSON would require us to also add the same password but 
in hashed form to the same master config which does not feel right. 
Maintaining this pass+hash pair in multiple config files won't be very 
pleasant. I considered generating hashed value from plaintext during 
deployment myself given your algorithm is straightforward but it does 
not feel right either - this will introduce unnecessary coupling and if 
one day you change your hashing algorithm everything will break.

So are there any options here?

1. The fact default_user is ignored - is it a feature or a bug?
2. is there any way to supply plaintext passwords with definitions JSON?
3. Any other approach I should consider instead?

Many thanks.
Dmitry
This email is for the use of the intended recipient(s) only.
If you have received this email in error, please notify the sender immediately and then delete it.
If you are not the intended recipient, you must not use, disclose or distribute this email without the
author's prior permission. AlertMe.com Ltd. is not responsible for any personal views expressed
in this message or any attachments that are those of the individual sender.

AlertMe.com Ltd, 30 Station Road, Cambridge, CB1 2RE, UK.
Registered in England, Company number 578 2908, VAT registration number GB 895 9914 42.


</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037103.html">[rabbitmq-discuss] Connection is always in &quot;flow&quot; State.
</A></li>
	<LI>Next message: <A HREF="037112.html">[rabbitmq-discuss] default_user vs definitions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37111">[ date ]</a>
              <a href="thread.html#37111">[ thread ]</a>
              <a href="subject.html#37111">[ subject ]</a>
              <a href="author.html#37111">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
