<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ persistence when clustering
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20persistence%20when%20clustering&In-Reply-To=%3C20101209230910.GB2284%40dakota.Home%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010307.html">
   <LINK REL="Next"  HREF="010309.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ persistence when clustering</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20persistence%20when%20clustering&In-Reply-To=%3C20101209230910.GB2284%40dakota.Home%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ persistence when clustering">alexandru at rabbitmq.com
       </A><BR>
    <I>Thu Dec  9 23:09:10 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010307.html">[rabbitmq-discuss] RabbitMQ persistence when clustering
</A></li>
        <LI>Next message: <A HREF="010309.html">[rabbitmq-discuss] RabbitMQ persistence when clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10308">[ date ]</a>
              <a href="thread.html#10308">[ thread ]</a>
              <a href="subject.html#10308">[ subject ]</a>
              <a href="author.html#10308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Nathan,

&gt;<i> 1. When you cluster, do ram nodes persist messages to their queues? Or
</I>&gt;<i> only disk nodes?
</I>
Ram and disk apply only to whether the cluster configuration is in
memory or also written to disk.  Nodes of any type may persist messages
to disk.  The broker will always try to write persistent messages (on
durable queues) to disk, and may also persist transient messages if it's
running low on memory.

&gt;<i> 2. What's the state that's replicated across all nodes in a cluster?
</I>
Queues, bindings and exchanges.

Note that while all three appear the same on every node in the cluster,
queues are tied to the node they were declared on.  If that node goes
down, they'll also go down.

&gt;<i> 3. When a Rabbit node goes down, does its queue become unavailable?
</I>
Yes.  If the queue was non-durable, then the queue is deleted and can be
redeclared on any other node.  If the queue was durable, then it becomes
unavailable, and attempting to redeclare it will result in an exception.

&gt;<i> 4. What are the conditions (if any) for which there will be lost
</I>&gt;<i> messages?
</I>
If the broker goes down before it's had time to write (persistent) messages
to disk, those messages will be lost.

Cheers,
Alex

On Thu, Dec 09, 2010 at 02:46:58PM -0800, nathanmarz wrote:
&gt;<i> I'm trying to understand the behavior of a clustered RabbitMQ setup.
</I>&gt;<i> 
</I>&gt;<i> Specifically:
</I>&gt;<i> 
</I>&gt;<i> 1. When you cluster, do ram nodes persist messages to their queues? Or
</I>&gt;<i> only disk nodes?
</I>&gt;<i> 2. What's the state that's replicated across all nodes in a cluster?
</I>&gt;<i> 3. When a Rabbit node goes down, does its queue become unavailable?
</I>&gt;<i> 4. What are the conditions (if any) for which there will be lost
</I>&gt;<i> messages?
</I>&gt;<i> 
</I>&gt;<i> Thanks in advance,
</I>&gt;<i> Nathan
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010307.html">[rabbitmq-discuss] RabbitMQ persistence when clustering
</A></li>
	<LI>Next message: <A HREF="010309.html">[rabbitmq-discuss] RabbitMQ persistence when clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10308">[ date ]</a>
              <a href="thread.html#10308">[ thread ]</a>
              <a href="subject.html#10308">[ subject ]</a>
              <a href="author.html#10308">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
