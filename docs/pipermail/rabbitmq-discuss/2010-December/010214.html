<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RPC style messaging with a clustered web	application
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RPC%20style%20messaging%20with%20a%20clustered%20web%0A%09application&In-Reply-To=%3C689b9825-1100-4ac7-941c-5b2215240c46%40o23g2000prh.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010213.html">
   <LINK REL="Next"  HREF="010215.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RPC style messaging with a clustered web	application</H1>
    <B>SimonT</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RPC%20style%20messaging%20with%20a%20clustered%20web%0A%09application&In-Reply-To=%3C689b9825-1100-4ac7-941c-5b2215240c46%40o23g2000prh.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] RPC style messaging with a clustered web	application">simonthorogood at hotmail.com
       </A><BR>
    <I>Thu Dec  2 10:13:22 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010213.html">[rabbitmq-discuss] Permission handling changed on 2.2.0?
</A></li>
        <LI>Next message: <A HREF="010215.html">[rabbitmq-discuss] RPC style messaging with a clustered web	application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10214">[ date ]</a>
              <a href="thread.html#10214">[ thread ]</a>
              <a href="subject.html#10214">[ subject ]</a>
              <a href="author.html#10214">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi - Can anybody suggest how the following scenerio could be
accomplished using RabbitMQ?

There are 2 processes that need to communicate with one another. One
is a web application, the other a long running batch-processing
service (windows service). In the web layer a 'session' is created and
as part of that process, several 'request' messages are sent to the
windows service. On subsequent polling requests to the web
application, the user's session is re-constructed and an attempt is
made to update it from response messages returned by the batch-
processing service (usng a correlation ID to pick the relevant
messages from the queue). Currently this is achieved using a pair of
private MSMQ queues, which ties pairs of web apps and processing
services together on a single node (i.e. using sticky users sessions).

What we'd like to achieve is decoupling of these processes into a
cluster of web app nodes and a separate cluster of processing nodes.
The req part seems simple - the messages can be broadcast to a fan-out
(i think?) exchange and any one of the (identical) processing nodes
can pick up the messages.

What we are struggling with is getting the response routed back to the
session correctly. At this end there is no long-running process (i.e.
the session is re-hydrated with each polling request and could be
requested on any web app node).

I think that we probably need a response queue per session created at
session start and some routing rules for the response messages based
on the session ID. However, I'm not clear on how these queues could be
expired once their purpose is complete? or if this is an issue?
(though I assume it is since we have many 100s sessions a minute).
There is no definitive 'end' to the session - currently it's
serialized state just expires after x amount of idle time.
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010213.html">[rabbitmq-discuss] Permission handling changed on 2.2.0?
</A></li>
	<LI>Next message: <A HREF="010215.html">[rabbitmq-discuss] RPC style messaging with a clustered web	application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10214">[ date ]</a>
              <a href="thread.html#10214">[ thread ]</a>
              <a href="subject.html#10214">[ subject ]</a>
              <a href="author.html#10214">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
