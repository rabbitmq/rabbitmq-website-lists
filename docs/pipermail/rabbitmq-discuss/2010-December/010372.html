<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Resolving hostnamesfor high availability
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Resolving%20hostnamesfor%20high%20availability&In-Reply-To=%3CFB190E47-2E4B-4506-A06A-CC10F048FA70%40jbrisbin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010370.html">
   <LINK REL="Next"  HREF="010371.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Resolving hostnamesfor high availability</H1>
    <B>Jon Brisbin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Resolving%20hostnamesfor%20high%20availability&In-Reply-To=%3CFB190E47-2E4B-4506-A06A-CC10F048FA70%40jbrisbin.com%3E"
       TITLE="[rabbitmq-discuss] Resolving hostnamesfor high availability">jon at jbrisbin.com
       </A><BR>
    <I>Tue Dec 14 12:24:57 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010370.html">[rabbitmq-discuss] Resolving hostnamesfor high availability
</A></li>
        <LI>Next message: <A HREF="010371.html">[rabbitmq-discuss] Multi tenancy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10372">[ date ]</a>
              <a href="thread.html#10372">[ thread ]</a>
              <a href="subject.html#10372">[ subject ]</a>
              <a href="author.html#10372">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Dec 14, 2010, at 5:04 AM, Mark Hudson wrote:

&gt;<i> Two questions on resolving RabbitMQ broker hostnames
</I>&gt;<i> 
</I>&gt;<i> 1.I'm able to cluster 2 or more rabbitmq brokers on different machines, but to send a message I need to specify a hotsname/ipaddress. For redundancy, is there some way to look up all the hosts within a cluster so I can pick a running broker ?
</I>&gt;<i> 
</I>
You could use HAProxy:

<A HREF="http://haproxy.1wt.eu/">http://haproxy.1wt.eu/</A>

You get round-robin load balancing and failover, though you could skip the load balancing and just use it for failover. Then your clients always point to the proxy and you never have to change them, even if you add 20 brokers on the backend.

&gt;<i> 2. When a broker is taken down, any connected consumers/producers get an exception. Do I catch the exception and try to recconect to a live broker - this relates to question 1 - or is there some other mechanism to handle this ?
</I>
Reconnection is not easy. I've found it's best to keep your app aware enough of what consumers it has open at any time such that it can re-establish those consumers when the connection/channel gets re-created.

I know there's been some work recently in Spring AMQP to make this reconnection stuff less painful...

Thanks!

Jon Brisbin

        Web: <A HREF="http://jbrisbin.com/">http://jbrisbin.com/</A>
    Twitter: @j_brisbin
      Skype: jon.brisbin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101214/438addd2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101214/438addd2/attachment.htm</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010370.html">[rabbitmq-discuss] Resolving hostnamesfor high availability
</A></li>
	<LI>Next message: <A HREF="010371.html">[rabbitmq-discuss] Multi tenancy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10372">[ date ]</a>
              <a href="thread.html#10372">[ thread ]</a>
              <a href="subject.html#10372">[ subject ]</a>
              <a href="author.html#10372">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
