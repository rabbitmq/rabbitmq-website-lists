<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Handling network reliability problems on the publisher side
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Handling%20network%20reliability%20problems%20on%20the%0A%20publisher%20side&In-Reply-To=%3CC92CF397.1BCF8%25stefan.kaes%40xing.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010356.html">
   <LINK REL="Next"  HREF="010354.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Handling network reliability problems on the publisher side</H1>
    <B>Stefan Kaes</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Handling%20network%20reliability%20problems%20on%20the%0A%20publisher%20side&In-Reply-To=%3CC92CF397.1BCF8%25stefan.kaes%40xing.com%3E"
       TITLE="[rabbitmq-discuss] Handling network reliability problems on the publisher side">Stefan.Kaes at xing.com
       </A><BR>
    <I>Tue Dec 14 09:12:39 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010356.html">[rabbitmq-discuss] Handling network reliability problems on the publisher side
</A></li>
        <LI>Next message: <A HREF="010354.html">[rabbitmq-discuss] Question about management setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10366">[ date ]</a>
              <a href="thread.html#10366">[ thread ]</a>
              <a href="subject.html#10366">[ subject ]</a>
              <a href="author.html#10366">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thx for the quick answer.

I think we'll experiment with transactions and how how that works out.

-- stefan


Am 13.12.10 16:42 schrieb &quot;Simon MacMullen&quot; unter &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;:

&gt;<i> On 13/12/10 15:17, Stefan Kaes wrote:
</I>&gt;<i> &lt;snip&gt;
</I>&gt;<i> 
</I>&gt;&gt;<i> It looks like no programming cleverness on our side can achieve what we
</I>&gt;&gt;<i> want: have the publisher block as soon as a message cannot be accepted
</I>&gt;&gt;<i> by the intended rabbitmq server, because, as far as we understand the
</I>&gt;&gt;<i> amqp protocol, no protocol level acknowledgements are sent which the
</I>&gt;&gt;<i> publisher could wait for (and optionally timeout), before sending the
</I>&gt;&gt;<i> next message.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This is all fine to achieve high throughput on the publisher side, but
</I>&gt;&gt;<i> doesn&#185;t quite fit our use case. For some messages, we really need to
</I>&gt;&gt;<i> make reasonably sure the message has been received by a rabbitmq server,
</I>&gt;&gt;<i> before we continue. We could then use timeouts to detect network
</I>&gt;&gt;<i> partitioning and buffer messages locally until they can be sent (only if
</I>&gt;&gt;<i> none of our three redundant servers can be reached, of course).
</I>&gt;<i> 
</I>&gt;<i> &lt;snip&gt;
</I>&gt;<i> 
</I>&gt;&gt;<i>     * is the analysis correct?
</I>&gt;<i> 
</I>&gt;<i> Yes. Publishes are fully async in AMQP.
</I>&gt;<i> 
</I>&gt;&gt;<i>     * is the JSON-RPC plugin stable enough to be used in production?
</I>&gt;<i> 
</I>&gt;<i> Interesting question. Our official position is that like all the plugins
</I>&gt;<i> it is &quot;unsupported&quot;. However it's pretty clear that some plugins are
</I>&gt;<i> more supported than others, and JSON-RPC is pretty low down the pecking
</I>&gt;<i> order.
</I>&gt;<i> 
</I>&gt;&gt;<i>     * maybe there&#185;s a better solution available?
</I>&gt;<i> 
</I>&gt;<i> The next release will feature publisher acknowledgements, where Rabbit
</I>&gt;<i> will stream basic.acks back at you (if you ask for that). This sounds
</I>&gt;<i> like exactly what you're looking for.
</I>&gt;<i> 
</I>&gt;<i> In the meantime, you could get away with publishing inside a
</I>&gt;<i> transaction. When you commit the transaction, and get commit-ok back,
</I>&gt;<i> you know Rabbit has got the message (and persisted it if it's
</I>&gt;<i> persistent). Unfortunately this imposes a cost per commit - tweak the
</I>&gt;<i> number of publishes per commit to tune performance versus maximum number
</I>&gt;<i> of outstanding messages.
</I>&gt;<i> 
</I>&gt;<i> Cheers, Simon
</I>
Dr. Stefan Kaes
Principal System Architect
 
XING AG
Gaensemarkt 43, 20354 Hamburg, Germany
Tel. +49 40 419131-801, Fax +49 40 419131-11
 
Commercial Reg. (Registergericht): Amtsgericht Hamburg, HRB 98807
Exec. Board (Vorstand): Dr. Stefan Gro&#223;-Selbeck (Vorsitzender), Ingo Chu,
Burkhard Blum, Michael Otto, Dr. Helmut Becker
Chairman of the Supervisory Board (Aufsichtsratsvorsitzender): Dr. Neil
Sunderland
 
Please join my network on XING: <A HREF="http://www.xing.com/go/invite/Stefan.Kaes">http://www.xing.com/go/invite/Stefan.Kaes</A>

This email may contain confidential and/or privileged information. If you
are not the intended recipient (or have received this email in error) please
notify the sender immediately and destroy this email. Any unauthorized
copying, disclosure or distribution of the material in this email is
strictly forbidden and may be unlawful.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010356.html">[rabbitmq-discuss] Handling network reliability problems on the publisher side
</A></li>
	<LI>Next message: <A HREF="010354.html">[rabbitmq-discuss] Question about management setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10366">[ date ]</a>
              <a href="thread.html#10366">[ thread ]</a>
              <a href="subject.html#10366">[ subject ]</a>
              <a href="author.html#10366">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
