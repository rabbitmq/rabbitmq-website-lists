<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 2.0 broker crashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.0%20broker%20crashes&In-Reply-To=%3C20101220182758.GO18077%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010447.html">
   <LINK REL="Next"  HREF="010451.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 2.0 broker crashes</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.0%20broker%20crashes&In-Reply-To=%3C20101220182758.GO18077%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ 2.0 broker crashes">matthew at rabbitmq.com
       </A><BR>
    <I>Mon Dec 20 18:27:58 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010447.html">[rabbitmq-discuss] RabbitMQ 2.0 broker crashes
</A></li>
        <LI>Next message: <A HREF="010451.html">[rabbitmq-discuss] RabbitMQ 2.0 broker crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10448">[ date ]</a>
              <a href="thread.html#10448">[ thread ]</a>
              <a href="subject.html#10448">[ subject ]</a>
              <a href="author.html#10448">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Dec 20, 2010 at 06:15:14PM +0000, Scott Dupoy wrote:
&gt;<i> I've narrowed down the scenario when the crash occurs.  As the queue builds
</I>&gt;<i> up the msg_store_transient\0.rdq file is populated.  If I start the consumer
</I>&gt;<i> at this point everything is fine.  If the broker starts storing data in a
</I>&gt;<i> second database file (msg_store_transient\1.rdq) and then I start my
</I>&gt;<i> consumer then the crash occurs.  Procmon suggests a sharing violation with
</I>&gt;<i> one handle attempting to delete the 0.rdq file.
</I>
Right. I think I can guess what's going on here, and it's not pretty.
For various reasons, Rabbit can have the same file open multiple times.
It can then decide to delete that file. Under unices, that's not a
problem. However, apparently in general, on Windows, you can't ask for a
file to be deleted if it's held open.

This is not going to be a simple thing to fix. In all honesty, the best
solution right now is for you not to run Rabbit under Windows. If you
have to use a Windows host, then run a Linux VM within it.

I'm pretty astonished that this hasn't been reported before. I guess
that's likely an indication of the number of people that run RabbitMQ
under Windows.

Matthew
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010447.html">[rabbitmq-discuss] RabbitMQ 2.0 broker crashes
</A></li>
	<LI>Next message: <A HREF="010451.html">[rabbitmq-discuss] RabbitMQ 2.0 broker crashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10448">[ date ]</a>
              <a href="thread.html#10448">[ thread ]</a>
              <a href="subject.html#10448">[ subject ]</a>
              <a href="author.html#10448">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
