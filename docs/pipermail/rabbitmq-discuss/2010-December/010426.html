<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Question/clarification wrt durable messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Question/clarification%20wrt%20durable%20messages&In-Reply-To=%3C37D22E80-0E81-4471-821F-DAA72A4E1E7C%40whatevernot.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010425.html">
   <LINK REL="Next"  HREF="010427.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Question/clarification wrt durable messages</H1>
    <B>Brian Parkinson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Question/clarification%20wrt%20durable%20messages&In-Reply-To=%3C37D22E80-0E81-4471-821F-DAA72A4E1E7C%40whatevernot.com%3E"
       TITLE="[rabbitmq-discuss] Question/clarification wrt durable messages">parki at whatevernot.com
       </A><BR>
    <I>Fri Dec 17 15:38:56 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010425.html">[rabbitmq-discuss] Question/clarification wrt durable messages
</A></li>
        <LI>Next message: <A HREF="010427.html">[rabbitmq-discuss] Question/clarification wrt durable messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10426">[ date ]</a>
              <a href="thread.html#10426">[ thread ]</a>
              <a href="subject.html#10426">[ subject ]</a>
              <a href="author.html#10426">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Emile:

Ran the tests under a transaction, and the messages certainly survive a server (node) crash.

The throughput I'm getting is approximately 10 messages per second - does this gibe with what you would expect for throughput? I ask, as it seems slow compared to non-tx, even taking into account the time for persistence. I'm wrapping the call to basicPublish with txSelect and txCommit.

Thanks.

b...



On Dec 17, 2010, at 8:43 AM, Emile Joubert wrote:

&gt;<i> Hi Brian,
</I>&gt;<i> 
</I>&gt;<i> On 16/12/10 20:03, Brian Parkinson wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> However, as near as I can tell, there is no difference - in both
</I>&gt;&gt;<i> cases, the message remains in the queue until a consumer comes and
</I>&gt;&gt;<i> retrieves it. Is there a difference in this case?
</I>&gt;<i> 
</I>&gt;<i> If you are not seeing a difference then you are most likely shutting down the broker forcibly without the use of transactions. If you set the channel to transaction mode:
</I>&gt;<i> 
</I>&gt;<i> channel.txSelect();
</I>&gt;<i> 
</I>&gt;<i> and commit after the publish:
</I>&gt;<i> 
</I>&gt;<i> channel.txCommit();
</I>&gt;<i> 
</I>&gt;<i> then you will see persistent messages in durable queues even after an unclean shutdown.
</I>&gt;<i> 
</I>&gt;&gt;<i> Perhaps it's more useful to outline what my use case is - I need to
</I>&gt;&gt;<i> have high availability, and so can form a multi-node broker, but
</I>&gt;&gt;<i> since the queues are (currently) tied to a node, if a node goes down,
</I>&gt;&gt;<i> I lose the queue (and all the messages in that queue). How does one
</I>&gt;&gt;<i> design this setup in RabbitMQ/AMQP - I'm guessing there's a pretty
</I>&gt;&gt;<i> standard pattern here (?).
</I>&gt;<i> 
</I>&gt;<i> For high availability you should look at the Pacemaker guide: <A HREF="http://www.rabbitmq.com/pacemaker.html">http://www.rabbitmq.com/pacemaker.html</A> . This uses persistent storage and a heartbeat mechanism between two brokers.
</I>&gt;<i> 
</I>&gt;&gt;<i> ps. I'm using the whizzy mgmt web front end; when I launch the
</I>&gt;&gt;<i> server, I see some warnings about undefined functions (see below). Is
</I>&gt;&gt;<i> this something I should worry about?
</I>&gt;<i> 
</I>&gt;<i> Those warnings are normal. Mochiweb uses some functions in some modules we don't distribute.  One of our startup checks catches this and complains. Since we never actually use those functions, it shouldn't be a problem.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Regards
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Emile
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010425.html">[rabbitmq-discuss] Question/clarification wrt durable messages
</A></li>
	<LI>Next message: <A HREF="010427.html">[rabbitmq-discuss] Question/clarification wrt durable messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10426">[ date ]</a>
              <a href="thread.html#10426">[ thread ]</a>
              <a href="subject.html#10426">[ subject ]</a>
              <a href="author.html#10426">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
