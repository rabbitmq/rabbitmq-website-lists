<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java API methods don't return nor throw	exceptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Java%20API%20methods%20don%27t%20return%20nor%20throw%0A%09exceptions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002258.html">
   <LINK REL="Next"  HREF="002266.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java API methods don't return nor throw	exceptions</H1>
    <B>Jonatan Kallus</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Java%20API%20methods%20don%27t%20return%20nor%20throw%0A%09exceptions&In-Reply-To="
       TITLE="[rabbitmq-discuss] Java API methods don't return nor throw	exceptions">jonatan at heysan.com
       </A><BR>
    <I>Wed Dec 10 23:42:09 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002258.html">[rabbitmq-discuss] New installation failing on start
</A></li>
        <LI>Next message: <A HREF="002266.html">[rabbitmq-discuss] Java API methods don't return nor	throw	exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2260">[ date ]</a>
              <a href="thread.html#2260">[ thread ]</a>
              <a href="subject.html#2260">[ subject ]</a>
              <a href="author.html#2260">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am trying to write a java application that can handle the rabbitmq server
going down and coming back up (or losing the connection to the server and
getting it back).

When my application is running and I stop the rabbitmq server, the
ShutdownListener gets called (and some of the disconnection methods may
throw some exceptions). So far all good.

When the server comes back up the application connects to the server: (It
keeps trying to connect while the server is down until it successes.)

ConnectionFactory factory = new ConnectionFactory(params);
connection = factory.newConnection(host, AMQP.PROTOCOL.PORT);
channel = connection.createChannel();
channel.accessRequest(this.realm);

Code above gets run through without any exceptions. But, when reconnecting,
the execution stops at this line, the method seems to never return:

connection.addShutdownListener(shutdownListener);

At first time connection the same code is executed without any problems.

In some cases, when the connection is terminated from within my application,
execution also stops at these lines:

channel.basicCancel(consumerTag);
channel.basicCancel(commandConsumerTag);

I have once seen addShutdownListener throw a
ConcurrentModificationException, but the rabbitmq connection is not running
in a multithreaded environment.

Is it possible to set a general timeout for all API method? Am I missing
anything else wrt this problem? I understand that it may be impossible to
find the cause of this with this little information unless anyone has seen
anything similar. I am ready to supply more information that can help find
the cause of this.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20081210/8e55990d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20081210/8e55990d/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002258.html">[rabbitmq-discuss] New installation failing on start
</A></li>
	<LI>Next message: <A HREF="002266.html">[rabbitmq-discuss] Java API methods don't return nor	throw	exceptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2260">[ date ]</a>
              <a href="thread.html#2260">[ thread ]</a>
              <a href="subject.html#2260">[ subject ]</a>
              <a href="author.html#2260">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
