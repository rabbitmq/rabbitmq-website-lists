<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] erlang-client problem on OS X	(empty_rpc_bottom_half)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20erlang-client%20problem%20on%20OS%20X%0A%09%28empty_rpc_bottom_half%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002235.html">
   <LINK REL="Next"  HREF="002238.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] erlang-client problem on OS X	(empty_rpc_bottom_half)</H1>
    <B>Matt Stancliff</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20erlang-client%20problem%20on%20OS%20X%0A%09%28empty_rpc_bottom_half%29&In-Reply-To="
       TITLE="[rabbitmq-discuss] erlang-client problem on OS X	(empty_rpc_bottom_half)">sysop at mindspring.com
       </A><BR>
    <I>Tue Dec  9 06:37:50 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002235.html">[rabbitmq-discuss] AMQP 0-9-1 released
</A></li>
        <LI>Next message: <A HREF="002238.html">[rabbitmq-discuss] erlang-client problem on OS X	(empty_rpc_bottom_half)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2237">[ date ]</a>
              <a href="thread.html#2237">[ thread ]</a>
              <a href="subject.html#2237">[ subject ]</a>
              <a href="author.html#2237">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Rabbits,

I've spent the past two days attempting to track down why the erlang- 
client doesn't work for me on OS X.
Everything works fine on my Linux box.
The Linux and OS X (10.5.5) installs of everything are performed by  
the same automated scripts.

I'm running erlang (R12B-5), rabbitmq-server (tip: cedf2c7e873d) and  
the erlang-client (tip: a9695aaf5083).

The error is reproducible with a one-line  
&quot;lib_amqp:start_channel(lib_amqp:start_connection())&quot; (the same error  
occurs with direct or network clients).

Running through the debugger, the bottom half gets called once  
(correctly) then it gets called again but this time RequestQueue is  
empty.  I haven't been able to track down what is sending messages  
causing handle_method/2 (therefore rpc_bottom_half/2) to get called  
incorrectly.

My OS X rabbitmq install works properly with the http2 client (the  
tests run successfully and the demo apps work).

Any ideas?


The crash and error reports I've been fighting for two days are:
=====
=CRASH REPORT==== 8-Dec-2008::22:14:21 ===
   crasher:
     pid: &lt;0.238.0&gt;
     registered_name: []
     exception exit: empty_rpc_bottom_half
       in function  gen_server:terminate/6
     initial call: amqp_channel:init/1
     ancestors: [&lt;0.237.0&gt;,&lt;0.236.0&gt;]
     messages: []
     links: [&lt;0.239.0&gt;,&lt;0.240.0&gt;,&lt;0.237.0&gt;]
     dictionary: []
     trap_exit: true
     status: running
     heap_size: 610
     stack_size: 23
     reductions: 247
   neighbours:
===
=ERROR REPORT==== 8-Dec-2008::22:14:21 ===
** Generic server &lt;0.242.0&gt; terminating
** Last message in was {send_command,{'channel.flow',false}}
** When Server state == {channel_state,1,&lt;0.241.0&gt;,undefined,&lt;0.243.0&gt;,
                             #Fun&lt;amqp_direct_driver.do.2&gt;,
                             #Fun&lt;amqp_direct_driver.do.3&gt;,
                             #Fun&lt;amqp_direct_driver.close_channel.1&gt;,
                             {[],[]},
                             {[],[]},
                             {dict,0,16,16,8,80,48,
                                 {[],[],[],[],[],[],[],[],[],[],[],[], 
[],[],[],
                                  []},
                                 {{[],[],[],[],[],[],[],[],[],[],[],[], 
[],[],
                                   [],[]}}},
                             false,undefined,
                             {dict,0,16,16,8,80,48,
                                 {[],[],[],[],[],[],[],[],[],[],[],[], 
[],[],[],
                                  []},
                                 {{[],[],[],[],[],[],[],[],[],[],[],[], 
[],[],
                                   [],[]}}}}
** Reason for termination ==
** empty_rpc_bottom_half
=====


Any pointers in the right direction will be greatly appreciated.

Sincerely,

-Matt
-- 
Matt Stancliff                    San Jose, CA
AIM: seijimr              iPhone: 678-591-9337
&quot;The best way to predict the future is to invent it.&quot; --Alan Kay



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002235.html">[rabbitmq-discuss] AMQP 0-9-1 released
</A></li>
	<LI>Next message: <A HREF="002238.html">[rabbitmq-discuss] erlang-client problem on OS X	(empty_rpc_bottom_half)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2237">[ date ]</a>
              <a href="thread.html#2237">[ thread ]</a>
              <a href="subject.html#2237">[ subject ]</a>
              <a href="author.html#2237">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
