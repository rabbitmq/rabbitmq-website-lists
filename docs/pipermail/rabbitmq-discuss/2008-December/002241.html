<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] log file management
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20log%20file%20management&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002240.html">
   <LINK REL="Next"  HREF="002256.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] log file management</H1>
    <B>Michael Ossareh</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20log%20file%20management&In-Reply-To="
       TITLE="[rabbitmq-discuss] log file management">michael at heysan.com
       </A><BR>
    <I>Wed Dec 10 03:06:34 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002240.html">[rabbitmq-discuss] patch to 1.4.0 rabbitmqctl to watch rabbitmq
</A></li>
        <LI>Next message: <A HREF="002256.html">[rabbitmq-discuss] log file management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2241">[ date ]</a>
              <a href="thread.html#2241">[ thread ]</a>
              <a href="subject.html#2241">[ subject ]</a>
              <a href="author.html#2241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Today I just restarted our rabbitmq server due to what seems to be a
memory leak somwhere in rabbitmq. We'll investigate that more; however
I noticed

rabbitmq-server/scripts/rabbitmq-server

has two bad lines in it;

[ -f  &quot;${LOGS}&quot; ] &amp;&amp; cat &quot;${LOGS}&quot; &gt;&gt; &quot;${LOGS}${BACKUP_EXTENSION}&quot;
[ -f  &quot;${SASL_LOGS}&quot; ] &amp;&amp; cat &quot;${SASL_LOGS}&quot; &gt;&gt;
&quot;${SASL_LOGS}${BACKUP_EXTENSION}&quot;

in our case we have many gb log files (7gb after a few days)  and the
server spends a long time putting them into cat.

I suggest changing it to

[ -f  &quot;${LOGS}&quot; ] &amp;&amp; mv &quot;${LOGS}&quot; &gt;&gt; &quot;${LOGS}${BACKUP_EXTENSION}&quot; &amp;&amp;
touch &quot;${LOGS}&quot; &amp;&amp; chown ${RMQUSER}.${RMQGRP} &quot;${LOGS}&quot;
[ -f  &quot;${SASL_LOGS}&quot; ] &amp;&amp; mv &quot;${SASL_LOGS}&quot; &gt;&gt;
&quot;${SASL_LOGS}${BACKUP_EXTENSION}&quot; &amp;&amp; touch &quot;${SASL_LOGS}&quot; &amp;&amp; chown
${RMQUSER}.${RMQGRP} &quot;${SASL_LOGS}&quot;

or something like that.

Overall, however, surely log rotation is the task of logrotated? I'm
not sure how well this maps to any erlang best practices though.

More than happy to help make whatever changes are needed, but will
need some guidance.

Thanks,

mike
-- 
god loves atheists, Fact: <A HREF="http://www.mrwiggleslovesyou.com/comics/rehab477.jpg">http://www.mrwiggleslovesyou.com/comics/rehab477.jpg</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002240.html">[rabbitmq-discuss] patch to 1.4.0 rabbitmqctl to watch rabbitmq
</A></li>
	<LI>Next message: <A HREF="002256.html">[rabbitmq-discuss] log file management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2241">[ date ]</a>
              <a href="thread.html#2241">[ thread ]</a>
              <a href="subject.html#2241">[ subject ]</a>
              <a href="author.html#2241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
