<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] EXT :Re:  Memory not flushing to disk
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20EXT%20%3ARe%3A%20%20Memory%20not%20flushing%20to%20disk&In-Reply-To=%3C5177DCE7.5000509%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026662.html">
   <LINK REL="Next"  HREF="026638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] EXT :Re:  Memory not flushing to disk</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20EXT%20%3ARe%3A%20%20Memory%20not%20flushing%20to%20disk&In-Reply-To=%3C5177DCE7.5000509%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] EXT :Re:  Memory not flushing to disk">emile at rabbitmq.com
       </A><BR>
    <I>Wed Apr 24 14:23:51 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026662.html">[rabbitmq-discuss] EXT :Re:  Memory not flushing to disk
</A></li>
        <LI>Next message: <A HREF="026638.html">[rabbitmq-discuss] How can RabbitMQ Shovel be configured to overwrite the timestamp property with the current time?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26663">[ date ]</a>
              <a href="thread.html#26663">[ thread ]</a>
              <a href="subject.html#26663">[ subject ]</a>
              <a href="author.html#26663">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/04/13 13:50, Rodrian, Logan P (IS) wrote:
&gt;<i> You mentioned batching messages.  Is this something that is done by
</I>&gt;<i> the producer when sending to the broker or a setting within
</I>&gt;<i> RabbitMQ?
</I>
Batching and unbatching is not performed by the broker, so this is
something that would need to be done by producers and consumers.

&gt;<i> What does RabbitMQ do with the RAM indexes when it is shutdown?  I
</I>&gt;<i> assume it writes to disk somehow and then reads the indexes back into
</I>&gt;<i> RAM upon startup.  Does this process only happen upon shutdown and
</I>&gt;<i> never during execution?  i.e. it never pages the RAM index to disk
</I>&gt;<i> when out of space?
</I>
The rabbit_msg_store_index behaviour contains recover and terminate
callbacks. The default implementation included with the broker makes use
of Erlang Term Storage (ETS) tables that are read from and saved to disk
upon boot and shutdown respectively, but not during execution.

Alternatives (e.g. rabbit_toke) with different RAM requirements do
exist, or you can provide your own. The behaviour to implement is here:

<A HREF="http://hg.rabbitmq.com/rabbitmq-server/file/default/src/rabbit_msg_store_index.erl">http://hg.rabbitmq.com/rabbitmq-server/file/default/src/rabbit_msg_store_index.erl</A>

The default implementation:
<A HREF="http://hg.rabbitmq.com/rabbitmq-server/file/default/src/rabbit_msg_store_ets_index.erl">http://hg.rabbitmq.com/rabbitmq-server/file/default/src/rabbit_msg_store_ets_index.erl</A>





-Emile



</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026662.html">[rabbitmq-discuss] EXT :Re:  Memory not flushing to disk
</A></li>
	<LI>Next message: <A HREF="026638.html">[rabbitmq-discuss] How can RabbitMQ Shovel be configured to overwrite the timestamp property with the current time?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26663">[ date ]</a>
              <a href="thread.html#26663">[ thread ]</a>
              <a href="subject.html#26663">[ subject ]</a>
              <a href="author.html#26663">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
