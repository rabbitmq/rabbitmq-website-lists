<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Hash Exchange with temporary queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Hash%20Exchange%20with%20temporary%20queues&In-Reply-To=%3C5171423A.5000101%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026538.html">
   <LINK REL="Next"  HREF="026526.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Hash Exchange with temporary queues</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Hash%20Exchange%20with%20temporary%20queues&In-Reply-To=%3C5171423A.5000101%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Hash Exchange with temporary queues">emile at rabbitmq.com
       </A><BR>
    <I>Fri Apr 19 14:10:18 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026538.html">[rabbitmq-discuss] Hash Exchange with temporary queues
</A></li>
        <LI>Next message: <A HREF="026526.html">[rabbitmq-discuss] Erlang OTP handle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26580">[ date ]</a>
              <a href="thread.html#26580">[ thread ]</a>
              <a href="subject.html#26580">[ subject ]</a>
              <a href="author.html#26580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

On 17/04/13 18:21, sinsei wrote:
&gt;<i> The problem I've noticed is that when I shut down a consumer, some messages
</I>&gt;<i> are just lost. I wasn't sure how to set this up as dead-letter-exchanges
</I>&gt;<i> won't work for this case. Is there a way I can ensure those messages are
</I>&gt;<i> passed somewhere else?
</I>
The consistent hash exchange is not ideal in cases where queues are
deleted and message loss cannot be tolerated. The documentation makes
clear that messages are delivered to at most one queue. Message loss can
only be prevented by not deleting queues.

It is possible to reduce the chances of message loss: instead of relying
on auto-deletion, consumers could use the if-empty flag of the
queue.delete method to delete their queue prior to shutting down.
Unfortunately this process is not guaranteed to ever complete, because a
new message may have arrived by the time processing of the last one
completes

&gt;<i> Also, what happens if I have no consumers, it appears the messages are just
</I>&gt;<i> gone.  I may have to set up an alternative exchange?
</I>
Yes, or use the mandatory publishing flag:
<A HREF="http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.publish.mandatory">http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.publish.mandatory</A>

&gt;<i> I've also considered adding some grouping as a plugin so I could have a
</I>&gt;<i> single durable, trunk queue, but I'm unsure if it is possible with the
</I>&gt;<i> current plugin model.
</I>
It is possible to create custom exchange and queue implementations as
plugins. The potential for messages en route to a disappearing queue to
be lost will exist regardless of queue implementation.











</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026538.html">[rabbitmq-discuss] Hash Exchange with temporary queues
</A></li>
	<LI>Next message: <A HREF="026526.html">[rabbitmq-discuss] Erlang OTP handle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26580">[ date ]</a>
              <a href="thread.html#26580">[ thread ]</a>
              <a href="subject.html#26580">[ subject ]</a>
              <a href="author.html#26580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
