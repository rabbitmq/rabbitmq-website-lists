<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 3.0.4 extremely unstable in production...?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%203.0.4%20extremely%20unstable%20in%20production...%3F&In-Reply-To=%3C398f5f6d-22c0-49ec-989b-6cfae1416cda%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026627.html">
   <LINK REL="Next"  HREF="026620.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 3.0.4 extremely unstable in production...?</H1>
    <B>Jacques Doubell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%203.0.4%20extremely%20unstable%20in%20production...%3F&In-Reply-To=%3C398f5f6d-22c0-49ec-989b-6cfae1416cda%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] 3.0.4 extremely unstable in production...?">jfdoubell at gmail.com
       </A><BR>
    <I>Fri Apr 19 16:06:16 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026627.html">[rabbitmq-discuss] 3.0.4 extremely unstable in production...?
</A></li>
        <LI>Next message: <A HREF="026620.html">[rabbitmq-discuss] 3.0.4 extremely unstable in production...?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26591">[ date ]</a>
              <a href="thread.html#26591">[ thread ]</a>
              <a href="subject.html#26591">[ subject ]</a>
              <a href="author.html#26591">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have also recently upgraded to 3.0.4 and have since then had 2 outages. 
In the one case the service was running but non functional. The logs didn't 
have errors, but at a certain point just stopped receiving new connections. 
We had to restart the service and all was well until about a week later 
when there were a lot of heaped up messages server side but clients could 
not connect to the queue anymore. (server actively refused connection 
message from the client side). We will be downgrading to 2.8.x in the mean 
time.

On Friday, April 12, 2013 8:36:22 PM UTC+2, Matt Wise wrote:
&gt;<i>
</I>&gt;<i> We've been running RabbitMQ 2.8.x in production in Amazon for about 16 
</I>&gt;<i> months now without very many issues. Last week we ran into an issue where 
</I>&gt;<i> our 2.8.5 cluster nodes hit their high-memory-limit and stopped processing 
</I>&gt;<i> jobs, effectively taking down our entire Celery task queue. We decided to 
</I>&gt;<i> upgrade the software to 3.0.4 (which had been running in staging for a few 
</I>&gt;<i> weeks, as a single instance, without issue) and at the same time beef up 
</I>&gt;<i> the size and redundancy of our farm to 3 machines that were m1.larges.
</I>&gt;<i>
</I>&gt;<i> Old Farm:
</I>&gt;<i>   server1: m1.small, 2.8.5, us-west-1c
</I>&gt;<i>   server2: m1.small, 2.8.5, us-west-1c
</I>&gt;<i>
</I>&gt;<i> New Farm:
</I>&gt;<i>   server1: m1.large, 3.0.4, us-west-1a
</I>&gt;<i>   server2: m1.large, 3.0.4, us-west-1c
</I>&gt;<i>   server3: m1.large, 3.0.4, us-west-1c
</I>&gt;<i>
</I>&gt;<i> Since creating the new server farm though we've had 3 outages. In the 
</I>&gt;<i> first two outages we received a Network Partition Split, and effectively 
</I>&gt;<i> all 3 of the systems decided to run their own queues independently of the 
</I>&gt;<i> other servers. This was the first time we'd ever seen this failure, ever. 
</I>&gt;<i> In the most recent failure we had 2 machines split off, and the 3rd 
</I>&gt;<i> rabbitmq service effectively became unresponsive entirely.
</I>&gt;<i>
</I>&gt;<i> For sanity sake, at this point we've backed down to the following 
</I>&gt;<i> configuration:
</I>&gt;<i>
</I>&gt;<i> New-New Farm:
</I>&gt;<i>   server1: m1.large, 2.8.5, us-west-1c
</I>&gt;<i>   server2: m1.large, 2.8.5, us-west-1a
</I>&gt;<i>
</I>&gt;<i> Up until recently though I had felt extremely comfortable with RabbitMQ's 
</I>&gt;<i> clustering technology and reliability... now ... not so much. Has anyone 
</I>&gt;<i> else seen similar behaviors? Is it simply due to the fact that we're 
</I>&gt;<i> running cross-zone now in Amazon, or is it more likely the 3 servers that 
</I>&gt;<i> caused the problem? Or the 3.0.x upgrade?
</I>&gt;<i>
</I>&gt;<i> --Matt
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130419/98d888cf/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130419/98d888cf/attachment.htm</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026627.html">[rabbitmq-discuss] 3.0.4 extremely unstable in production...?
</A></li>
	<LI>Next message: <A HREF="026620.html">[rabbitmq-discuss] 3.0.4 extremely unstable in production...?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26591">[ date ]</a>
              <a href="thread.html#26591">[ thread ]</a>
              <a href="subject.html#26591">[ subject ]</a>
              <a href="author.html#26591">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
