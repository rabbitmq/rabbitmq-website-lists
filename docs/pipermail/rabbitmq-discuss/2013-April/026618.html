<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Prioritizing Between Queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Prioritizing%20Between%20Queues&In-Reply-To=%3C51751B78.6080604%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026606.html">
   <LINK REL="Next"  HREF="026605.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Prioritizing Between Queues</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Prioritizing%20Between%20Queues&In-Reply-To=%3C51751B78.6080604%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Prioritizing Between Queues">simon at rabbitmq.com
       </A><BR>
    <I>Mon Apr 22 12:14:00 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026606.html">[rabbitmq-discuss] Prioritizing Between Queues
</A></li>
        <LI>Next message: <A HREF="026605.html">[rabbitmq-discuss] Rabbit crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26618">[ date ]</a>
              <a href="thread.html#26618">[ thread ]</a>
              <a href="subject.html#26618">[ subject ]</a>
              <a href="author.html#26618">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/04/13 12:39, Tomer Paz wrote:
&gt;<i> Hi
</I>&gt;<i> Two issues, starting with the simple one:
</I>&gt;<i>
</I>&gt;<i> 1. If a consumer (sub) declared a queue with topic binding key that has
</I>&gt;<i> wild pattern, like &quot;type_a.*&quot;
</I>&gt;<i>      Then a publisher declared a queue that meets this binding key as
</I>&gt;<i> well via routing key &quot;type_a.something&quot;.
</I>
Bear in mind this is not really declaring a queue. Publishers stick 
routing keys on messages. At the moment the message is received by the 
broker, the routing key is compared to the bindings that exist, and the 
message is added to all matching queues.

&gt;<i>      Will the broker dynamically 'subscribe' the consumer above to the
</I>&gt;<i> new queue created by the publisher? even though the consumer did not
</I>&gt;<i> 'declare' such queue specifically, during its queue declaration? i.e.
</I>&gt;<i> will broker push messages to that consumer from the new queue
</I>&gt;<i> dynamically at run time?
</I>
As far as I understand what you mean, the answer is yes.

&gt;<i> 2.I have read everything about AMQP in-queue priority feature requirements.
</I>&gt;<i>    I have not found if there is a way for RabbitMQ broker to do the
</I>&gt;<i> following however:
</I>&gt;<i>
</I>&gt;<i>    let clients subscribe to several queues, But prioritize which queue
</I>&gt;<i> they take messages from, in a fashion different than the simple round-robin.
</I>&gt;<i>    In other words, we wish to have some algo that Broker could decide
</I>&gt;<i> about *prioritizing queues* for consumers, rather than simple
</I>&gt;<i> round-robin to them.
</I>&gt;<i>    Example:
</I>&gt;<i>     we have Q1 responsible for messages of task type A. Type A has
</I>&gt;<i> priority 1
</I>&gt;<i>     we have Q2 responsible for messages of task type B. Type B has
</I>&gt;<i> priority 2
</I>&gt;<i>     .... Q3... Type C.. priority 3.
</I>&gt;<i>    Now consumer client(s) subscribe to consume messages from all Queues
</I>&gt;<i> (1..3).
</I>&gt;<i>    We wish Broker could give different priority for the three queues. It
</I>&gt;<i> would be even more powerful if for example:
</I>&gt;<i>    At some point, there are very little # of messages in Q1. However Q3
</I>&gt;<i> is 'full', or to be more sophisticated, the Rate in which tasks in Q3
</I>&gt;<i>    handled is too slow. We wish to Dynamically change priority for the
</I>&gt;<i> three queues in such case (thus dynamic prioritization of queues)
</I>
Hmm. You can have your application consume from all three queues and 
control its own rate of consumption (possibly cancelling consumption 
from lower priority queues if it is too busy with higher priority ones). 
That does put more onus on the consumer though.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026606.html">[rabbitmq-discuss] Prioritizing Between Queues
</A></li>
	<LI>Next message: <A HREF="026605.html">[rabbitmq-discuss] Rabbit crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26618">[ date ]</a>
              <a href="thread.html#26618">[ thread ]</a>
              <a href="subject.html#26618">[ subject ]</a>
              <a href="author.html#26618">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
