<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ manager and Idle queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20manager%20and%20Idle%20queues&In-Reply-To=%3C516D4B5C.3020606%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026511.html">
   <LINK REL="Next"  HREF="026513.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ manager and Idle queues</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20manager%20and%20Idle%20queues&In-Reply-To=%3C516D4B5C.3020606%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ manager and Idle queues">simon at rabbitmq.com
       </A><BR>
    <I>Tue Apr 16 14:00:12 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026511.html">[rabbitmq-discuss] RabbitMQ manager and Idle queues
</A></li>
        <LI>Next message: <A HREF="026513.html">[rabbitmq-discuss] RabbitMQ manager and Idle queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26512">[ date ]</a>
              <a href="thread.html#26512">[ thread ]</a>
              <a href="subject.html#26512">[ subject ]</a>
              <a href="author.html#26512">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi. There was a bug introduced in 3.0.0 and fixed in 3.0.2 where queues 
would sometimes not hibernate when idle (which is what drives those 
&quot;last_event&quot; fields and the &quot;active&quot; flag). So the short answer is 
&quot;please upgrade&quot;.

But you should be cautious about driving anything from those 
&quot;last_event&quot; fields anyway - you're essentially looking at when the 
queue process last woke up, and something as trivial as &quot;rabbitmqctl 
list_queues&quot; will wake the queue process up.

You might want to look at <A HREF="http://www.rabbitmq.com/ttl.html#queue-ttl">http://www.rabbitmq.com/ttl.html#queue-ttl</A> as 
an alternative.

Cheers, Simon

On 16/04/13 13:50, Antoine Berry wrote:
&gt;<i> Hello everybody,
</I>&gt;<i>
</I>&gt;<i> We have a little problem with the rabbitMQ management plugin. Basically
</I>&gt;<i> we would want to delete the Idle queues. So to do that we send a http
</I>&gt;<i> request to the rabbitMQ management plugin REST API, to get the value of
</I>&gt;<i> the &quot;last_event&quot; field.
</I>&gt;<i> But we always get last_event = now, even though we haven't used  the
</I>&gt;<i> queue nor the virtual host in general for a day... Plus these queues
</I>&gt;<i> don't even have any consumers, and the application is not even running.
</I>&gt;<i> And all the queues are marked as active in the web management page too.
</I>&gt;<i>
</I>&gt;<i> Here are an exemple of request, and a screen shot of the web manager
</I>&gt;<i> page, which shows a queue without any consumers but marked as active :
</I>&gt;<i>
</I>&gt;<i> HTTP/1.1 200 OK
</I>&gt;<i> Server: MochiWeb/1.1 WebMachine/1.9.0 (someone had painted it blue)
</I>&gt;<i> Date: Tue, 16 Apr 2013 09:54:44 GMT
</I>&gt;<i> Content-Type: application/json
</I>&gt;<i> Content-Length: 909
</I>&gt;<i> Cache-Control: no-cache
</I>&gt;<i>
</I>&gt;<i> {&quot;policy&quot;:&quot;&quot;,&quot;exclusive_consumer_tag&quot;:&quot;&quot;,&quot;messages_ready&quot;:0,&quot;messages_unacknowledged&quot;:0,&quot;messages&quot;:0,&quot;consumers&quot;:0,&quot;active_consumers&quot;:0,&quot;memory&quot;:44356,&quot;backing_queue_status&quot;:{&quot;q1&quot;:0,&quot;q2&quot;:0,&quot;delta&quot;&quot;delta&quot;,&quot;undefined&quot;,0,&quot;undefined&quot;],&quot;q3&quot;:0,&quot;q4&quot;:0,&quot;len&quot;:0,&quot;pending_acks&quot;:0,&quot;target_ram_count&quot;:&quot;infinity&quot;,&quot;ram_msg_count&quot;:0,&quot;ram_ack_count&quot;:0,&quot;next_seq_id&quot;:66,&quot;persistent_count&quot;:0,&quot;avg_ingress_rate&quot;:0.0,&quot;avg_egress_rate&quot;:0.0,&quot;avg_ack_ingress_rate&quot;:0.0,&quot;avg_ack_egress_rate&quot;:0.0},&quot;messages_details&quot;:{&quot;rate&quot;:0.0,&quot;interval&quot;:10001924,&quot;last_event&quot;:1366106079385},&quot;messages_ready_details&quot;:{&quot;rate&quot;:0.0,&quot;interval&quot;:10001924,&quot;last_event&quot;:1366106079385},&quot;messages_unacknowledged_details&quot;:{&quot;rate&quot;:0.0,&quot;interval&quot;:10001924,&quot;last_event&quot;:1366106079385},&quot;consumer_details&quot;],&quot;name&quot;:&quot;theQueue&quot;,&quot;vhost&quot;:&quot;myHost&quot;,&quot;durable&quot;:true,&quot;auto_delete&quot;:false,&quot;arguments&quot;:{},&quot;node&quot;:&quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at myServer</A>&quot;}
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Does anybody ever had this kind of problem? We're using RabbitMQ 3.0.1,
</I>&gt;<i> with the java client.
</I>&gt;<i>
</I>&gt;<i> Thank you.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026511.html">[rabbitmq-discuss] RabbitMQ manager and Idle queues
</A></li>
	<LI>Next message: <A HREF="026513.html">[rabbitmq-discuss] RabbitMQ manager and Idle queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26512">[ date ]</a>
              <a href="thread.html#26512">[ thread ]</a>
              <a href="subject.html#26512">[ subject ]</a>
              <a href="author.html#26512">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
