<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queues versus Bindings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queues%20versus%20Bindings&In-Reply-To=%3C517018C1.1080701%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026558.html">
   <LINK REL="Next"  HREF="026564.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queues versus Bindings</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queues%20versus%20Bindings&In-Reply-To=%3C517018C1.1080701%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Queues versus Bindings">simon at rabbitmq.com
       </A><BR>
    <I>Thu Apr 18 17:01:05 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026558.html">[rabbitmq-discuss] Queues versus Bindings
</A></li>
        <LI>Next message: <A HREF="026564.html">[rabbitmq-discuss] Dynamic route
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26561">[ date ]</a>
              <a href="thread.html#26561">[ thread ]</a>
              <a href="subject.html#26561">[ subject ]</a>
              <a href="author.html#26561">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 18/04/13 16:53, danb wrote:
&gt;<i> For my scenario, what's better: a queue with 6000 bindings, or 6000 queues
</I>&gt;<i> each with one binding?
</I>&gt;<i>
</I>&gt;<i> My Scenario:
</I>&gt;<i>
</I>&gt;<i> In my application I'd expect perhaps 1 to 20 messages per &quot;binding&quot; over
</I>&gt;<i> about 3 minutes. So if I take the many queues approach the queues will be
</I>&gt;<i> mostly idle, and I would destroy the queue after around 3 minutes so they
</I>&gt;<i> would be relatively short lived. I only have one process listening to the
</I>&gt;<i> messages using one connection with multiple channels.
</I>
In that scenario I would go for just one queue; it just feels less 
complicated.

&gt;<i> Note: 6000, over 3 minutes means I'll be creating and deleting 33 queues per
</I>&gt;<i> second. Or alternatively adding or removing 33 bindings per second.
</I>
While that rate of binding churn is tolerable I might try to figure out 
if it's possible to live without it - creating / deleting a binding is 
rather more work than publishing / consuming a message. If you must have 
that much churn you might want to ensure at least one of your queue and 
exchange are non-durable, otherwise you will force an fsync after each 
bind / unbind.

&gt;<i> In the thread
</I>&gt;<i> <A HREF="http://rabbitmq.1065348.n5.nabble.com/RabbitMQ-with-many-queues-td26033.html">http://rabbitmq.1065348.n5.nabble.com/RabbitMQ-with-many-queues-td26033.html</A>
</I>&gt;<i> Emile mentions that Rabbit can declare an &quot;enormous number of idle queues
</I>&gt;<i> without difficulty&quot;. But I remember reading that Rabbit uses one Thread per
</I>&gt;<i> Queue, so I'm wondering what an enormous number is?
</I>
It uses one *Erlang process* per queue - but Erlang processes are 
designed to be much more lightweight than native threads. Typically we 
limit the Erlang VM to 1M processes by default, but that limit can be 
exceeded with a reconfigure.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026558.html">[rabbitmq-discuss] Queues versus Bindings
</A></li>
	<LI>Next message: <A HREF="026564.html">[rabbitmq-discuss] Dynamic route
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26561">[ date ]</a>
              <a href="thread.html#26561">[ thread ]</a>
              <a href="subject.html#26561">[ subject ]</a>
              <a href="author.html#26561">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
