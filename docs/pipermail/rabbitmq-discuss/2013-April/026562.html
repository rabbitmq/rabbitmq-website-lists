<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Queues memory leak?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Queues%20memory%20leak%3F&In-Reply-To=%3C517020C9.30803%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026548.html">
   <LINK REL="Next"  HREF="026574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Queues memory leak?</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Queues%20memory%20leak%3F&In-Reply-To=%3C517020C9.30803%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Queues memory leak?">emile at rabbitmq.com
       </A><BR>
    <I>Thu Apr 18 17:35:21 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026548.html">[rabbitmq-discuss] RabbitMQ Queues memory leak?
</A></li>
        <LI>Next message: <A HREF="026574.html">[rabbitmq-discuss] RabbitMQ Queues memory leak?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26562">[ date ]</a>
              <a href="thread.html#26562">[ thread ]</a>
              <a href="subject.html#26562">[ subject ]</a>
              <a href="author.html#26562">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Dmitry,

On 18/04/13 12:52, Dmitry Saprykin wrote:
&gt;<i> Could you take a look at memory consumption of cdaemon4 node. Report
</I>&gt;<i> contains data for both cluster nodes.
</I>&gt;<i> 
</I>&gt;<i> {memory,
</I>&gt;<i>      [{total,859404112},
</I>&gt;<i>       {connection_procs,4832056},
</I>&gt;<i>       {queue_procs,!!!189148496!!!},
</I>&gt;<i> 
</I>
The difference between 1Mb and 180Mb is relatively large, even after
taking expected differences due to garbage collection into account. We
can't rule out a memory leak, but need some assistance from you to confirm.

Do you see the same asymmetry if the master node for the queues switch
from one node to the other? So if you shut the cdaemon2 node, let
cdaemon4 become the master for all the queue, turn cdaemon2 back on (it
will now be a slave node) does the memory on cdaemon2 now grow?

Have you been able to add a third node to the cluster for testing
purposes to see if memory grows on more than one slave node?

How long does it take for the memory use to reach the VM memory high
watermark? Does the memory use increase linearly?

Can you describe your messaging pattern in a bit more detail for us to
reproduce the problem - how often are new channels created when publishing?

In order to investigate further it might be helpful to execute some
diagnostic commands on the broker. Are you able to replicate the problem
in a staging or QA environment where it is safe to do this?



-Emile




</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026548.html">[rabbitmq-discuss] RabbitMQ Queues memory leak?
</A></li>
	<LI>Next message: <A HREF="026574.html">[rabbitmq-discuss] RabbitMQ Queues memory leak?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26562">[ date ]</a>
              <a href="thread.html#26562">[ thread ]</a>
              <a href="subject.html#26562">[ subject ]</a>
              <a href="author.html#26562">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
