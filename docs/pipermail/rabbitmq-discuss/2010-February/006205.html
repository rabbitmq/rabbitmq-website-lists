<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] messages get stuck when using rabbitmq on windows, but not on osx or ubuntu
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20messages%20get%20stuck%20when%20using%20rabbitmq%20on%0A%20windows%2C%20but%20not%20on%20osx%20or%20ubuntu&In-Reply-To=9dbfb671002012125s17c53922n4bda3699b92f3ce4%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006128.html">
   <LINK REL="Next"  HREF="006129.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] messages get stuck when using rabbitmq on windows, but not on osx or ubuntu</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20messages%20get%20stuck%20when%20using%20rabbitmq%20on%0A%20windows%2C%20but%20not%20on%20osx%20or%20ubuntu&In-Reply-To=9dbfb671002012125s17c53922n4bda3699b92f3ce4%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] messages get stuck when using rabbitmq on windows, but not on osx or ubuntu">matthias at lshift.net
       </A><BR>
    <I>Sat Feb  6 17:53:32 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006128.html">[rabbitmq-discuss] messages get stuck when using rabbitmq on	windows, but not on osx or 	ubuntu
</A></li>
        <LI>Next message: <A HREF="006129.html">[rabbitmq-discuss] Garbage Collection Problem in Consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6205">[ date ]</a>
              <a href="thread.html#6205">[ thread ]</a>
              <a href="subject.html#6205">[ subject ]</a>
              <a href="author.html#6205">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthew,

Matthew Scott wrote:
&gt;<i> I'm experiencing a problem with messages getting &quot;stalled&quot; when serving 
</I>&gt;<i> RabbitMQ with Windows XP.
</I>&gt;<i> 
</I>&gt;<i> The context is a distributed job processing system, wherein some message 
</I>&gt;<i> payloads can be around 250-500 kB.  The clients connecting to the broker 
</I>&gt;<i> are several programs written in Python using the txAMQP library and the 
</I>&gt;<i> AMQP 0-8 protocol.  (*)
</I>&gt;<i> 
</I>&gt;<i> We can submit one job in our system, which results in several small 
</I>&gt;<i> messages, and four larger messages being routed through RabbitMQ with 
</I>&gt;<i> the size ranges noted above, and this succeeds.  However, when we submit 
</I>&gt;<i> an identical job, one message with a larger payload is successfully 
</I>&gt;<i> routed, but the second one is not.  I can see that it successfully 
</I>&gt;<i> reaches the broker but never reaches the intended destination, because I 
</I>&gt;<i> get this output:
</I>&gt;<i> 
</I>&gt;<i> C:\rabbitmq_server-1.7.1\sbin&gt;rabbitmqctl list_connections send_oct 
</I>&gt;<i> send_pend
</I>&gt;<i> Listing connections ...
</I>&gt;<i> 594     0
</I>&gt;<i> 1183650 0
</I>&gt;<i> 236655  0
</I>&gt;<i> 616     0
</I>&gt;<i> 610     0
</I>&gt;<i> 2492155 256809    &lt;-- here is the stuck message
</I>&gt;<i> 616     0
</I>&gt;<i> 616     0
</I>&gt;<i> 367     0
</I>
On the surface this does look like a client problem, namely that for
some reason the client has stopped reading data from the socket, causing
the tcp flow control to stall the connection and thus data backing up in
the server's tcp buffers.

It could also be some weird networking problem in the O/S.

I suggest sticking the AMQP tracer
(<A HREF="http://www.rabbitmq.com/examples.html#tracer">http://www.rabbitmq.com/examples.html#tracer</A>) inbetween the broker and
the client, running it on either the client or server machine (it's
worth trying both options). That will tell you what's going on at the
AMQP protocol level. If you need help interpreting the output, feel free
to post it here.

It's possible that inserting the tracer alters the behaviour, and
&quot;fixes&quot; the problem. If so then a lower-level tool to capture the
network traffic, such as wireshark, is your best bet.


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006128.html">[rabbitmq-discuss] messages get stuck when using rabbitmq on	windows, but not on osx or 	ubuntu
</A></li>
	<LI>Next message: <A HREF="006129.html">[rabbitmq-discuss] Garbage Collection Problem in Consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6205">[ date ]</a>
              <a href="thread.html#6205">[ thread ]</a>
              <a href="subject.html#6205">[ subject ]</a>
              <a href="author.html#6205">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
