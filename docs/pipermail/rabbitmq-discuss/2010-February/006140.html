<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Simple client/server running on different OS are lagging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Simple%20client/server%20running%20on%20different%20OS%0A%20are%20lagging&In-Reply-To=20100202162658.GD8318%40mrnibble.lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006139.html">
   <LINK REL="Next"  HREF="006149.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Simple client/server running on different OS are lagging</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Simple%20client/server%20running%20on%20different%20OS%0A%20are%20lagging&In-Reply-To=20100202162658.GD8318%40mrnibble.lshift.net"
       TITLE="[rabbitmq-discuss] Simple client/server running on different OS are lagging">matthew at lshift.net
       </A><BR>
    <I>Tue Feb  2 16:48:17 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006139.html">[rabbitmq-discuss] Simple client/server running on different OS are lagging
</A></li>
        <LI>Next message: <A HREF="006149.html">[rabbitmq-discuss] Simple client/server running on different OS	are lagging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6140">[ date ]</a>
              <a href="thread.html#6140">[ thread ]</a>
              <a href="subject.html#6140">[ subject ]</a>
              <a href="author.html#6140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Frank,

On Tue, Feb 02, 2010 at 04:26:58PM +0000, Matthew Sackman wrote:
&gt;<i> Not really too sure what to suggest, but others on the list have
</I>&gt;<i> reported better throughput when increasing buffers in Rabbit
</I>
Also, you're using the python client, to do performance testing, which
is a little questionable - in our experience the python clients tend to
perform badly. I'd suggest you test using our Java client which contains
an example program called MulticastMain which is pretty flexible for
testing performance and sustainable throughput.

&gt;<i>From the rabbitmq-java-client directory:
</I>ant clean dist
cd build/dist
sh runjava.sh com/rabbitmq/examples/MulticastMain -s 1000000 -r 25 -a -z 20 -q 1

where the -s parameter specifies the size, in bytes, the -r parameter
specifies the sending rate, -a turns on auto-ack, which you may want for
this, -z says how long to run the test for (in seconds) and -q sets the
qos on the consumer to 1.

This will create one producer and one consumer on the same box. You
should vary the rate (-r) until the sending rates and receiving rates
are balanced and sustainable (I tend to watch the reported latencies -
if they keep increasing, then it's not balanced).

Other if you just provide -? then it'll print out all the options. If
you want to use different machines for producer and consumer then you
can use -x 0 to turn off producers, and -y 0 to turn off consumers on
each box respectively. If you do do that, then you'll also need to
specify at least -e to name the exchange, and likely set -t to fanout
otherwise it'll attempt to use a private queue of the default direct
exchange and thus not route messages to the consumer. Also, start the
consumer first.

So, the consumer might look like this:

sh runjava.sh com/rabbitmq/examples/MulticastMain -s 10000000 -r 1 -a -z 20 -q 1 -x 0 -e my_exchage -t fanout

whilst the producer looks like:

sh runjava.sh com/rabbitmq/examples/MulticastMain -s 10000000 -r 1 -a -z 20 -q 1 -y 0 -e my_exchage -t fanout

These certainly work for me.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006139.html">[rabbitmq-discuss] Simple client/server running on different OS are lagging
</A></li>
	<LI>Next message: <A HREF="006149.html">[rabbitmq-discuss] Simple client/server running on different OS	are lagging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6140">[ date ]</a>
              <a href="thread.html#6140">[ thread ]</a>
              <a href="subject.html#6140">[ subject ]</a>
              <a href="author.html#6140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
