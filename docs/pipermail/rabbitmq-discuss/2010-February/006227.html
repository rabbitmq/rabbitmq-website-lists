<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] connecting to multiple rabbitmq servers	(point-multipoint)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20connecting%20to%20multiple%20rabbitmq%20servers%0A%09%28point-multipoint%29&In-Reply-To=4B6DE150.3060201%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006213.html">
   <LINK REL="Next"  HREF="006249.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] connecting to multiple rabbitmq servers	(point-multipoint)</H1>
    <B>Guillem Corominas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20connecting%20to%20multiple%20rabbitmq%20servers%0A%09%28point-multipoint%29&In-Reply-To=4B6DE150.3060201%40lshift.net"
       TITLE="[rabbitmq-discuss] connecting to multiple rabbitmq servers	(point-multipoint)">gcorominas at dexmatech.com
       </A><BR>
    <I>Mon Feb  8 10:58:45 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006213.html">[rabbitmq-discuss] connecting to multiple rabbitmq	servers	(point-multipoint)
</A></li>
        <LI>Next message: <A HREF="006249.html">[rabbitmq-discuss] connecting to multiple rabbitmq servers	(point-multipoint)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6227">[ date ]</a>
              <a href="thread.html#6227">[ thread ]</a>
              <a href="subject.html#6227">[ subject ]</a>
              <a href="author.html#6227">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you Mathias,
Yesterday I noticed that when the consumer stops receiving messages, the
rabbitmqctl list_connections shows that the connection no longer exists.
However in the Java Client, the Connection object and it's associated
Channel objects don't seem to notice about that. I tried logging it's status
by printing if either the Connection or the Channel is null, or if any of
those isOpen(), but they says they are both open. The client doesn't seem to
notice that the connection is down.

How can I ask the client about the connection in order to realize that it's
eventually down and it needs to be reconnected?

thanks in advance for your help,

guillem




On Sat, Feb 6, 2010 at 10:38 PM, Matthias Radestock &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>&gt;wrote:

&gt;<i> Guillem,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Guillem Corominas wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> when I start consuming from a second producer, it works well during a
</I>&gt;&gt;<i> small period of time (about 2h) and then suddenly stops consuming the
</I>&gt;&gt;<i> data from the producers (stops both at the same time) and queues
</I>&gt;&gt;<i> start to fill.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I supose it's a problem with the connection &amp; or channel but there is
</I>&gt;&gt;<i>  nothing on the logs (neither in the java client nor in the
</I>&gt;&gt;<i> rabbitmq).
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I suggest you do a 'rabbitmqctl list_connections peer_address peer_port
</I>&gt;<i> state channels send_pend' on all the brokers to check that you have the
</I>&gt;<i> connections and number of channels you expect to see and that there
</I>&gt;<i> is no send backlog (that's what the send_pend count
</I>&gt;<i> shows).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  If I then try to perform a basicCancel to any of my consumer
</I>&gt;&gt;<i> instances, the call becomes blocked and never returns a response
</I>&gt;&gt;<i> neither an error.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Getting a stack trace of all the Java threads at that point might
</I>&gt;<i> provide some clues as to why things are stuck.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  I have one open connection and one open channel per producer, however
</I>&gt;&gt;<i> I have 3 consumers that consume different kinds of message (topic
</I>&gt;&gt;<i> dependent) that share the Channel. Can this be the problem?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That's perfectly ok.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100208/cb9f828f/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100208/cb9f828f/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006213.html">[rabbitmq-discuss] connecting to multiple rabbitmq	servers	(point-multipoint)
</A></li>
	<LI>Next message: <A HREF="006249.html">[rabbitmq-discuss] connecting to multiple rabbitmq servers	(point-multipoint)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6227">[ date ]</a>
              <a href="thread.html#6227">[ thread ]</a>
              <a href="subject.html#6227">[ subject ]</a>
              <a href="author.html#6227">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
