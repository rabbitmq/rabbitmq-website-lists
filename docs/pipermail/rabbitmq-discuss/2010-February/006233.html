<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd: Client-connection failover workarounds	(ruby)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20Client-connection%20failover%20workarounds%0A%09%28ruby%29&In-Reply-To=4B6DB80B.6040908%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006206.html">
   <LINK REL="Next"  HREF="006234.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd: Client-connection failover workarounds	(ruby)</H1>
    <B>Peter Fitzgibbons</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20Client-connection%20failover%20workarounds%0A%09%28ruby%29&In-Reply-To=4B6DB80B.6040908%40lshift.net"
       TITLE="[rabbitmq-discuss] Fwd: Client-connection failover workarounds	(ruby)">peter.fitzgibbons at gmail.com
       </A><BR>
    <I>Mon Feb  8 12:29:45 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006206.html">[rabbitmq-discuss] Fwd: Client-connection failover workarounds (ruby)
</A></li>
        <LI>Next message: <A HREF="006234.html">[rabbitmq-discuss] Fwd: Client-connection failover workarounds (ruby)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6233">[ date ]</a>
              <a href="thread.html#6233">[ thread ]</a>
              <a href="subject.html#6233">[ subject ]</a>
              <a href="author.html#6233">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>HI Matthias,

Could you direct me to an example of how to set up a &quot;stand alone&quot; shovel?
The only example[1] i found is demonstrating an embedded shovel as rabbitmq
plugin.  This seems to be my degenerate case all over again.  No?

[1]
<A HREF="http://hopper.squarespace.com/blog/2008/6/22/introducing-shovel-an-amqp-relay.html">http://hopper.squarespace.com/blog/2008/6/22/introducing-shovel-an-amqp-relay.html</A>

Peter Fitzgibbons
(847) 859-9550
Email: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">peter.fitzgibbons at gmail.com</A>
IM GTalk: peter.fitzgibbons
IM AOL: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">peter.fitzgibbons at gmail.com</A>


On Sat, Feb 6, 2010 at 12:42 PM, Matthias Radestock &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>&gt;wrote:

&gt;<i> Peter,
</I>&gt;<i>
</I>&gt;<i> Peter Fitzgibbons wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I'm thinking about how to handle client-connection failover.  By this
</I>&gt;&gt;<i> I mean clientA has a producerP that needs to have reliable and
</I>&gt;&gt;<i> tolerant connections to rabbitA and rabbitB.  This is so that if the
</I>&gt;&gt;<i> connection/pid of rabbitA goes down, producerP sends it's next message
</I>&gt;&gt;<i> to rabbitB with as little handling (and wall-clock time) as possible.
</I>&gt;&gt;<i> [...]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The best solution I can think of right now is to have a rabbitP on the
</I>&gt;&gt;<i> same machine as producerP, which is clustered to the &quot;real&quot; cluster,
</I>&gt;&gt;<i> so if rabbitA goes down, the built-in clustering failover will handle
</I>&gt;&gt;<i> the proper interaction.  My issue with this is considering how this is
</I>&gt;&gt;<i> configured and maintained when the farm of servers with producerP gets
</I>&gt;&gt;<i> to be 1000+.  Even if this doesn't scale to the google-farm level,
</I>&gt;&gt;<i> what about farm = 10, 30 ?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Having a local broker is indeed a common approach to get higher resilience,
</I>&gt;<i> particularly since it allows producers to offload messages even when the
</I>&gt;<i> connection to the main brokers is down for prolonged periods of time, e.g.
</I>&gt;<i> in the event the main brokers are across a WAN and there is a WAN failure.
</I>&gt;<i>
</I>&gt;<i> As you suspect, making all these brokers part of a cluster would indeed be
</I>&gt;<i> problematic for high node counts, even more so when going across a WAN.
</I>&gt;<i> Besides, RabbitMQ's clustering is really designed for scaling, not improved
</I>&gt;<i> reliability.
</I>&gt;<i>
</I>&gt;<i> But you do not need to cluster the brokers. Instead you could stick our
</I>&gt;<i> experimental shovel (see
</I>&gt;<i> <A HREF="http://www.lshift.net/blog/2010/02/01/rabbitmq-shovel-message-relocation-equipment">http://www.lshift.net/blog/2010/02/01/rabbitmq-shovel-message-relocation-equipment</A>)
</I>&gt;<i> onto each local node and configure it to shovel messages to the main broker
</I>&gt;<i> pair. The shovel has built-in re-connection and failover logic for that.
</I>&gt;<i>
</I>&gt;<i> Of course having a local broker is no panacea for reliability, since that
</I>&gt;<i> broker itself becomes a point of failure. Whether that is a problem depends
</I>&gt;<i> on how high you place the reliability bar.
</I>&gt;<i>
</I>&gt;<i> An alternative approachh is to make the clients themselves deal with
</I>&gt;<i> re-connection and failover. Check out the experimental
</I>&gt;<i> <A HREF="http://hg.rabbitmq.com/rabbitmq-java-messagepatterns/">http://hg.rabbitmq.com/rabbitmq-java-messagepatterns/</A> and
</I>&gt;<i> <A HREF="http://hg.rabbitmq.com/rabbitmq-dotnet-messagepatterns/">http://hg.rabbitmq.com/rabbitmq-dotnet-messagepatterns/</A> libraries which do
</I>&gt;<i> that for a specific type of messaging (point-to-point, though most of the
</I>&gt;<i> logic should be easily ported to other types).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100208/341412d8/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100208/341412d8/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006206.html">[rabbitmq-discuss] Fwd: Client-connection failover workarounds (ruby)
</A></li>
	<LI>Next message: <A HREF="006234.html">[rabbitmq-discuss] Fwd: Client-connection failover workarounds (ruby)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6233">[ date ]</a>
              <a href="thread.html#6233">[ thread ]</a>
              <a href="subject.html#6233">[ subject ]</a>
              <a href="author.html#6233">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
