<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Poor performance using a single RabbitMQ	connection on high-latency networks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Poor%20performance%20using%20a%20single%20RabbitMQ%0A%09connection%20on%20high-latency%20networks&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006132.html">
   <LINK REL="Next"  HREF="006146.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Poor performance using a single RabbitMQ	connection on high-latency networks</H1>
    <B>Holger Hoffstaette</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Poor%20performance%20using%20a%20single%20RabbitMQ%0A%09connection%20on%20high-latency%20networks&In-Reply-To="
       TITLE="[rabbitmq-discuss] Poor performance using a single RabbitMQ	connection on high-latency networks">holger.hoffstaette at googlemail.com
       </A><BR>
    <I>Tue Feb  2 17:26:54 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006132.html">[rabbitmq-discuss] Poor performance using a single RabbitMQ connection on high-latency networks
</A></li>
        <LI>Next message: <A HREF="006146.html">[rabbitmq-discuss] Poor performance using a single RabbitMQ	connection on high-latency networks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6142">[ date ]</a>
              <a href="thread.html#6142">[ thread ]</a>
              <a href="subject.html#6142">[ subject ]</a>
              <a href="author.html#6142">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 02 Feb 2010 12:35:12 +0000, Matthias Radestock wrote:

&gt;<i> Matthew Sackman wrote:
</I>&gt;&gt;<i> I wonder whether Matthias or Tony may recall why our server options are
</I>&gt;&gt;<i> set as they are.
</I>&gt;<i> 
</I>&gt;<i> We don't want to set very large buffer sizes since we do not want to
</I>&gt;<i> increase the memory footprint of connections unnecessarily. The figures we
</I>&gt;<i> currently use are the minimum numbers above which I saw no significant
</I>&gt;<i> performance improvements in the tests I ran ~2 years ago. But those tests
</I>&gt;<i> weren't very extensive.
</I>
Fair enough, but I'm not sure why the values have to be even smaller than
e.g. Linux' vanilla defaults. Ideally - and given that Rabbit is mostly
used on Linux/Unix - they should not be necessary at all, especially as
they prevent any client-side settings from taking effect (I think - would
have to check with wireshark).

But in principle you're right, there are so many first- and second-order
effects and OS/network permutations at play here that it's impossible to
find the one perfect default. XP is different from Vista from Win7, and
RedHat's kernels have little in common with the mainline release. Even the
latest few mainline releases have seen an insane number of back-and-forth
fixes for all sorts of TCP behaviour, timers, CPU scheduling and whatnot.

That's why I think the defaults should ideally just be removed.
Platform/language-specific tuning recommendations can then be created for
different usage scenarios on the wiki by any users on their respective
platforms..provided it's easy enough to arrive at meaningful numbers and
submit them.

The comment re. memory usage with a lot of connections is interesting
though - is this really a problem even with epoll (aka kernel polling)?
What would be a large number of connections - 100? 1000?

I cannot really afford to take a few weeks off just for this, even if it
is an interesting project. Can't you get an intern or student ;)

Holger




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006132.html">[rabbitmq-discuss] Poor performance using a single RabbitMQ connection on high-latency networks
</A></li>
	<LI>Next message: <A HREF="006146.html">[rabbitmq-discuss] Poor performance using a single RabbitMQ	connection on high-latency networks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6142">[ date ]</a>
              <a href="thread.html#6142">[ thread ]</a>
              <a href="subject.html#6142">[ subject ]</a>
              <a href="author.html#6142">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
