<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Option for surviving connection failure feature	suggestion
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Option%20for%20surviving%20connection%20failure%20feature%0A%09suggestion&In-Reply-To=%3Ce1669d74-68d0-4484-a847-7b7d350bd4b0%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032370.html">
   <LINK REL="Next"  HREF="032383.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Option for surviving connection failure feature	suggestion</H1>
    <B>Wayne Brantley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Option%20for%20surviving%20connection%20failure%20feature%0A%09suggestion&In-Reply-To=%3Ce1669d74-68d0-4484-a847-7b7d350bd4b0%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Option for surviving connection failure feature	suggestion">wayne.brantley at gmail.com
       </A><BR>
    <I>Thu Dec  5 18:17:17 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="032370.html">[rabbitmq-discuss] Memory usage for Durable Queues and Persistent Messages
</A></li>
        <LI>Next message: <A HREF="032383.html">[rabbitmq-discuss] RabbitMq on ESXi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32382">[ date ]</a>
              <a href="thread.html#32382">[ thread ]</a>
              <a href="subject.html#32382">[ subject ]</a>
              <a href="author.html#32382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Disclaimer:  I am new to RabbitMQ.  :-)

When processing long running messages, if the connection drops or gets 
interrupted - the message will be handed to another consumer.
Meanwhile, the original consumer is still doing the work.

I would propose a new option on a queue.

If the connection is dropped, that would not make the message available to 
another consumer.
The message would have a 'processing timeout'.  Only after that time has 
expired would the message become available to other consumers.

There would be several different options that could be set on the message 
for how to determine to deliver the message to another consumer.

1)  You could have an 'absolute processing timeout'.  
    -  RabbitMQ would keep track of how long the consumer has had the 
message.
    -  The client could send 'keep alive' acknowledgements to reset the the 
time RabbitMQ is tracking to zero.
    -  All that matters is has the message been processing longer than the 
timeout value.  (where timeout can be reset by client).  A dropped 
connection would not matter. 

2)  You could have a 'broken connection timeout'
    -  RabbitMQ would keep track of how long the consumer has had the 
message, AFTER the connection is dropped.
    -  The client would NOT ever need to send 'keep alive' acknowledgements.
    -  If a consumer connection is re-established - the consumer should 
somehow indicate they are still working on the message.
    -  Potentially - when the consumer is working on the message, they send 
'keep alive' every so often.  This way if the connection broke and was 
reconnected, the next time a 'keep alive' is sent, it would let RabbitMQ 
know you are still working on the message.

The above options would probably have default values at the queue level, 
and each message could override (for example if you know the message takes 
a long time to process.)

This makes it where any intermittent connection from consumer to publisher 
would not necessarily mean the consumer 'failed' and the message should be 
passed to another consumer.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131205/95630e1e/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131205/95630e1e/attachment.html</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032370.html">[rabbitmq-discuss] Memory usage for Durable Queues and Persistent Messages
</A></li>
	<LI>Next message: <A HREF="032383.html">[rabbitmq-discuss] RabbitMq on ESXi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32382">[ date ]</a>
              <a href="thread.html#32382">[ thread ]</a>
              <a href="subject.html#32382">[ subject ]</a>
              <a href="author.html#32382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
