<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Memory usage for Durable Queues and Persistent	Messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Memory%20usage%20for%20Durable%20Queues%20and%20Persistent%0A%09Messages&In-Reply-To=%3CCALXutY%2B68TXtZK%3DzecoXEXeY9O7tr_5rkGLrkfjYYT3g8crMDA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032398.html">
   <LINK REL="Next"  HREF="032370.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Memory usage for Durable Queues and Persistent	Messages</H1>
    <B>Dan Gritsko</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Memory%20usage%20for%20Durable%20Queues%20and%20Persistent%0A%09Messages&In-Reply-To=%3CCALXutY%2B68TXtZK%3DzecoXEXeY9O7tr_5rkGLrkfjYYT3g8crMDA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Memory usage for Durable Queues and Persistent	Messages">dgritsko at gmail.com
       </A><BR>
    <I>Thu Dec  5 14:14:44 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="032398.html">[rabbitmq-discuss] OpenLDAP-based auth with 'other_bind' option: no DN attribute?
</A></li>
        <LI>Next message: <A HREF="032370.html">[rabbitmq-discuss] Memory usage for Durable Queues and Persistent Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32368">[ date ]</a>
              <a href="thread.html#32368">[ thread ]</a>
              <a href="subject.html#32368">[ subject ]</a>
              <a href="author.html#32368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,


I have a three-node cluster containing a durable queue that is mirrored
across all three nodes. Persistent messages are being published to an
exchange routed to this queue (delivery mode = 2). I have intentionally
disabled all consumers of this queue in order to see how memory and disk
usage are affected. I'd expect the memory usage to remain fairly low, while
the disk usage increases (since all the messages for this queue should be
persisted to disk).



However, after letting several hundred thousand messages accumulate in this
queue, I was surprised to notice that the memory usage on the primary node
for this queue is significantly higher (roughly 3x) than the other two
nodes in the cluster. Shouldn't the memory usage be roughly equivalent,
since the queue is mirrored across all three nodes in the cluster?



Additionally, when I view the &quot;Memory details&quot; for the primary node for
this queue, the majority of the memory is occupied by the &quot;Binaries&quot;
category of the breakdown. The documentation page states that &quot;In-memory
message bodies show up&quot; in this category. But shouldn't the message bodies
all be on the disk, and not in memory and affecting the report in this way?


Any clarification regarding these issues would be greatly appreciated.
Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131205/b855f807/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131205/b855f807/attachment.html</A>&gt;
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032398.html">[rabbitmq-discuss] OpenLDAP-based auth with 'other_bind' option: no DN attribute?
</A></li>
	<LI>Next message: <A HREF="032370.html">[rabbitmq-discuss] Memory usage for Durable Queues and Persistent Messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32368">[ date ]</a>
              <a href="thread.html#32368">[ thread ]</a>
              <a href="subject.html#32368">[ subject ]</a>
              <a href="author.html#32368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
