<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Publisher confirms requires seperate call to	get ack?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publisher%20confirms%20requires%20seperate%20call%20to%0A%09get%20ack%3F&In-Reply-To=%3CCAChGYf8ySwwadyENsyVNquqwLrbx_HZtrxR-gEO8DSmGNb4yBQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032660.html">
   <LINK REL="Next"  HREF="032664.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Publisher confirms requires seperate call to	get ack?</H1>
    <B>Ryan Brown</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publisher%20confirms%20requires%20seperate%20call%20to%0A%09get%20ack%3F&In-Reply-To=%3CCAChGYf8ySwwadyENsyVNquqwLrbx_HZtrxR-gEO8DSmGNb4yBQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Publisher confirms requires seperate call to	get ack?">ryankbrown at gmail.com
       </A><BR>
    <I>Tue Dec 17 23:15:49 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="032660.html">[rabbitmq-discuss] Publisher confirms requires seperate call to get	ack?
</A></li>
        <LI>Next message: <A HREF="032664.html">[rabbitmq-discuss] Publisher confirms requires seperate call to get ack?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32662">[ date ]</a>
              <a href="thread.html#32662">[ thread ]</a>
              <a href="subject.html#32662">[ subject ]</a>
              <a href="author.html#32662">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&lt;&lt;Sorry. Finger hit cmd-enter&gt;&gt;

So, in testing the use of publisher confirms in RabbitMQ I am seeing a
significant (many orders of magnitude) decrease in performance when
requesting publisher confirms. Based on my interpretation of the
documentation, it appears that, in order to confirm each message queued was
written to disc, I need to make a request to get the acknowledgment. In
doing so, my publishing rates look like this:

Without publisher confirms:

~11k/mps

With publisher confirms (including call for ack):

187/mps

I feel that I must be doing something wrong. The servers hosting RabbitMQ
are quite robust with 16 cores, 32gb RAM and SSD drives.

Is anybody aware of a good example doing publisher confirms, preferably in
erlang but any language will do. Also, is it necessary to do it for each
message? I know, theoretically, the answer is no. But I have a wrapper
around Rabbit that must return synchronously to clients publishing messages
so it appears to be the best option.

Thanks in advance for any help.

Best.


On Tue, Dec 17, 2013 at 4:06 PM, Ryan Brown &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ryankbrown at gmail.com</A>&gt; wrote:

&gt;<i> So, in testing the use of publisher confirms in RabbitMQ I am seeing a
</I>&gt;<i> significant (many orders of magnitude) decrease in performance when
</I>&gt;<i> requesting publisher confirms. Based on my interpretation of the
</I>&gt;<i> documentation, it appears that, in order to confrim each message queued was
</I>&gt;<i> written to disc, I need to make a re
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> -rb
</I>&gt;<i>
</I>


-- 
-rb
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131217/47eecb75/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131217/47eecb75/attachment.html</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032660.html">[rabbitmq-discuss] Publisher confirms requires seperate call to get	ack?
</A></li>
	<LI>Next message: <A HREF="032664.html">[rabbitmq-discuss] Publisher confirms requires seperate call to get ack?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32662">[ date ]</a>
              <a href="thread.html#32662">[ thread ]</a>
              <a href="subject.html#32662">[ subject ]</a>
              <a href="author.html#32662">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
