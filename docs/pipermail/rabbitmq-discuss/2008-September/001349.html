<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Creating Queues and Exchanges on the Fly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Creating%20Queues%20and%20Exchanges%20on%20the%20Fly&In-Reply-To=777343D9-D050-4288-BC9C-C4CFF9AD5F5D%40synergy-solutions.biz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001331.html">
   <LINK REL="Next"  HREF="001332.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Creating Queues and Exchanges on the Fly</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Creating%20Queues%20and%20Exchanges%20on%20the%20Fly&In-Reply-To=777343D9-D050-4288-BC9C-C4CFF9AD5F5D%40synergy-solutions.biz"
       TITLE="[rabbitmq-discuss] Creating Queues and Exchanges on the Fly">0x6e6562 at gmail.com
       </A><BR>
    <I>Thu Sep  4 21:04:23 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001331.html">[rabbitmq-discuss] Creating Queues and Exchanges on the Fly
</A></li>
        <LI>Next message: <A HREF="001332.html">[rabbitmq-discuss] Header Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1349">[ date ]</a>
              <a href="thread.html#1349">[ thread ]</a>
              <a href="subject.html#1349">[ subject ]</a>
              <a href="author.html#1349">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Preston,

On Thu, Sep 4, 2008 at 2:28 AM, Preston Marshall
&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">preston at synergy-solutions.biz</A>&gt; wrote:

&gt;<i> Now I have an interesting problem which probably requires and interesting
</I>&gt;<i> solution :).  I can successfully pass events through my different exchanges,
</I>&gt;<i> i have a 'all' queue, along with national, regional, state, and stateregion.
</I>&gt;<i>  They all have different routing keys that can be used to send to them like
</I>&gt;<i> for example one key is events.us.5.al.4, that in particular creates a queue
</I>&gt;<i> named stateregion and binds to it with a key that listens for messages only
</I>&gt;<i> for that state region, for that state, for that region, for that nation. Now
</I>&gt;<i> what I need to do is setup a queue for events that are going on, as the
</I>&gt;<i> queues I have now only pass new event notifications, not actualy
</I>&gt;<i> communications for those events.  Each new event has a UUID assoicated with
</I>&gt;<i> it, so I was thinking that maybe I should create a new queue when a new
</I>&gt;<i> event message comes in, based on the contents of the message.  So I would
</I>&gt;<i> have something like this:
</I>&gt;<i>
</I>&gt;<i> amq.queue('94a2b510-5c4c-012b-a451-001ff34e82f0').bind(amq.topic, :key =&gt;
</I>&gt;<i> &quot;94a2b510-5c4c-012b-a451-001ff34e82f0.posts&quot;).subscribe
</I>&gt;<i>
</I>&gt;<i> where in reality I would have something like this, since new events will be
</I>&gt;<i> created and destroyed on the fly, and base the new queue's key and name on a
</I>&gt;<i> message recieved from a &quot;parent&quot; queue.:
</I>&gt;<i>
</I>&gt;<i> amq.queue(doc.elements['//eventuuid'].to_s).bind(amq.topic, :key =&gt;
</I>&gt;<i> &quot;#{doc.elements['//eventuuid']}.posts&quot;).subscribe
</I>&gt;<i>
</I>&gt;<i> This queue allows for &quot;posts&quot; or basically pieces of information like SMS
</I>&gt;<i> messages to be passed across the network, while referencing an event, which
</I>&gt;<i> is the UUID.
</I>&gt;<i>
</I>&gt;<i> Is this the only way to this, or if not, the best?  Wisdom tells me that if
</I>&gt;<i> you are doing something that seems really complex and hard, there is
</I>&gt;<i> probably a better and easier way that you haven't seen.  I believe that my
</I>&gt;<i> inexperience with AMQP and its nomenclature is causing me massive confusion
</I>&gt;<i> and strife, which of course I'd love for you guys to help me out with.
</I>
Absolutely no offense intended, I've read through your mail twice and
I'm struggling to understand exactly what your problem is.

On face value, it looks like you should be using some kind of topic
exchange, which leads me to ask whether you've looked at the
specification for topic (taken from the spec):

&quot;The routing pattern follows the same rules as the routing key with
the addition that * matches a single word, and # matches zero or more
words. Thus the routing pattern *.stock.# matches the routing keys
usd.stock and
eur.stock.db but not stock.nasdaq&quot;

Of course you can create and delete exchanges, queues and bindings on the fly.

One thing you may want to consider when just creating stuff in an ad
hoc fashion is the associated cost.

Whilst the cost of any these operations is not much, it is definitely
non-zero, so at very high levels of usage, you might find that this is
something you want to economize on.

However, going back to your problem, if you could describe it with
less detail and make it clearer what your focus is, I'm sure that the
Rabbit community will be more than willing to help out.

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001331.html">[rabbitmq-discuss] Creating Queues and Exchanges on the Fly
</A></li>
	<LI>Next message: <A HREF="001332.html">[rabbitmq-discuss] Header Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1349">[ date ]</a>
              <a href="thread.html#1349">[ thread ]</a>
              <a href="subject.html#1349">[ subject ]</a>
              <a href="author.html#1349">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
