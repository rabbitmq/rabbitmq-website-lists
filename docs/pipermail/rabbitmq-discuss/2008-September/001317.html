<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd:  Debugging of Connection.class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20%20Debugging%20of%20Connection.class&In-Reply-To=269388e30809020604k28072619p9e755c24b5731c74%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001316.html">
   <LINK REL="Next"  HREF="001325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd:  Debugging of Connection.class</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20%20Debugging%20of%20Connection.class&In-Reply-To=269388e30809020604k28072619p9e755c24b5731c74%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Fwd:  Debugging of Connection.class">0x6e6562 at gmail.com
       </A><BR>
    <I>Tue Sep  2 19:18:33 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001316.html">[rabbitmq-discuss] Fwd:  Debugging of Connection.class
</A></li>
        <LI>Next message: <A HREF="001325.html">[rabbitmq-discuss] Fwd: Debugging of Connection.class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1317">[ date ]</a>
              <a href="thread.html#1317">[ thread ]</a>
              <a href="subject.html#1317">[ subject ]</a>
              <a href="author.html#1317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>---------- Forwarded message ----------
From: Ben Hood &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A>&gt;
Date: Tue, Sep 2, 2008 at 2:04 PM
Subject: Re: [rabbitmq-discuss] Debugging of Connection.class
To: Pete Kay &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">petedao at gmail.com</A>&gt;
Cc: rabbitmq &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;


Anne,

On Tue, Sep 2, 2008 at 1:31 AM, Pete Kay &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">petedao at gmail.com</A>&gt; wrote:
&gt;<i> The correct bytes were written to the delegate.writeByptes().
</I>&gt;<i>
</I>&gt;<i> Using ngrep, I see that the Flex client sends much less data to the server
</I>&gt;<i> than the Java Client:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ===========================Flex Client ===============================
</I>&gt;<i>
</I>&gt;<i> debian:/home/anne# ngrep  port 5672
</I>&gt;<i> interface: eth0 (192.168.1.0/255.255.255.0)
</I>&gt;<i> filter: (ip or ip6) and ( port 5672 )
</I>&gt;<i> ########
</I>&gt;<i> T 192.168.1.100:58513 -&gt; 192.168.1.104:5672 [AP]
</I>&gt;<i>   AMQP....
</I>&gt;<i> ##
</I>&gt;<i> T 192.168.1.104:5672 -&gt; 192.168.1.100:58513 [AP]
</I>&gt;<i>   ......
</I>&gt;<i> ...........productS....RabbitMQ.versionS....1.4.0.platformS....Erlan
</I>&gt;<i>   g/OTP.copyrightS...gCopyright (C) 2007-2008 LShift Ltd., Cohesive
</I>&gt;<i> Financial
</I>&gt;<i>    Technologies LLC., and Rabbit Technologies Ltd..informationS...5Licensed
</I>&gt;<i> u
</I>&gt;<i>   nder the MPL.  See <A HREF="http://www.rabbitmq.com/....PLAIN">http://www.rabbitmq.com/....PLAIN</A> AMQPLAIN....en_US.
</I>&gt;<i> #####
</I>
So the broker is actually receiving the header. It then sends the
client the Start command and waits for the client's response - in this
case for a long time :-(

OK, now you need to debug into the command exchange that creates an
AMQP connection between the client and the broker. From the client's
perspective, the flow looks like this:

1. Receive connection.Start
2. Send connection.StartOk
3. Receive connection.Tune
4. Send connection.TuneOk
5. Send connection.Open
6. Receive connection.OpenOk

This is handled in the ConnectionStateHandler class, and the event
handling in this class is fairly well documented.

Look at the the onStart function.

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001316.html">[rabbitmq-discuss] Fwd:  Debugging of Connection.class
</A></li>
	<LI>Next message: <A HREF="001325.html">[rabbitmq-discuss] Fwd: Debugging of Connection.class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1317">[ date ]</a>
              <a href="thread.html#1317">[ thread ]</a>
              <a href="subject.html#1317">[ subject ]</a>
              <a href="author.html#1317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
