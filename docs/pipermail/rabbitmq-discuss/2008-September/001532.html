<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Stomp frame not terminated with null	character
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Stomp%20frame%20not%20terminated%20with%20null%0A%09character&In-Reply-To=4cc167ca0809181232x47388866mdc990487e2825339%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001531.html">
   <LINK REL="Next"  HREF="001533.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Stomp frame not terminated with null	character</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Stomp%20frame%20not%20terminated%20with%20null%0A%09character&In-Reply-To=4cc167ca0809181232x47388866mdc990487e2825339%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Stomp frame not terminated with null	character">tonyg at lshift.net
       </A><BR>
    <I>Thu Sep 18 20:37:40 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001531.html">[rabbitmq-discuss] Stomp frame not terminated with null	character
</A></li>
        <LI>Next message: <A HREF="001533.html">[rabbitmq-discuss] Stomp frame not terminated with null	character
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1532">[ date ]</a>
              <a href="thread.html#1532">[ thread ]</a>
              <a href="subject.html#1532">[ subject ]</a>
              <a href="author.html#1532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jonatan,

What I meant is that fgets (at least according to its documentation) 
waits for a newline that will never arrive. Using fread instead will fix 
the problem, but will require you to buffer any unused bytes for use by 
the next invocation of readFrame.

Regards,
   Tony



Jonatan Kallus wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Sep 18, 2008 at 11:53 AM, Tony Garnock-Jones &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A> 
</I>&gt;<i> &lt;mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     Aha!
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     Jonatan Kallus wrote:
</I>&gt;<i> 
</I>&gt;<i>                 $read = fgets($this-&gt;_socket, $rb);
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     fgets() reads lines. Maybe try a plain old read? You'll need to
</I>&gt;<i>     buffer things between calls to readFrame, I guess.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> The difference between fgets and fread in this case is how it decides 
</I>&gt;<i> how big chunks to read at a time. fgets does not drop the characters 
</I>&gt;<i> that makes it stop reading, afaik. Newlines and alike is returned as 
</I>&gt;<i> well. Also, the nulls from other MQs seem to work with fgets. Thanks for 
</I>&gt;<i> your answers though! I will try to make it work once again later. For 
</I>&gt;<i> now I'll just use my own implementation that only connects and sends, 
</I>&gt;<i> and fails on any unexpected answers. That's all I'll need.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     Tony
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001531.html">[rabbitmq-discuss] Stomp frame not terminated with null	character
</A></li>
	<LI>Next message: <A HREF="001533.html">[rabbitmq-discuss] Stomp frame not terminated with null	character
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1532">[ date ]</a>
              <a href="thread.html#1532">[ thread ]</a>
              <a href="subject.html#1532">[ subject ]</a>
              <a href="author.html#1532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
