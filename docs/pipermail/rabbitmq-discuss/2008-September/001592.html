<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] erlang client API: transactions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20erlang%20client%20API%3A%20transactions&In-Reply-To=6c2563b20809231456s5b6242a0m1a1a38a42be3978c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001591.html">
   <LINK REL="Next"  HREF="001594.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] erlang client API: transactions</H1>
    <B>Valentino Volonghi</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20erlang%20client%20API%3A%20transactions&In-Reply-To=6c2563b20809231456s5b6242a0m1a1a38a42be3978c%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] erlang client API: transactions">dialtone at gmail.com
       </A><BR>
    <I>Tue Sep 23 23:29:20 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001591.html">[rabbitmq-discuss] erlang client API: transactions
</A></li>
        <LI>Next message: <A HREF="001594.html">[rabbitmq-discuss] erlang client API: transactions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1592">[ date ]</a>
              <a href="thread.html#1592">[ thread ]</a>
              <a href="subject.html#1592">[ subject ]</a>
              <a href="author.html#1592">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


On Sep 23, 2008, at 2:56 PM, Edwin Fine wrote:

&gt;<i>
</I>&gt;<i> IIRC, the persister is writing to an mnesia database. When you start  
</I>&gt;<i> Rabbit, it defines where the mnesia database is. If you put the  
</I>&gt;<i> database on its own disk or even better on its own controller and  
</I>&gt;<i> disk, it may increase throughput dramatically. Also, is the web  
</I>&gt;<i> server, and maybe even shovel, logging lots of status messages to  
</I>&gt;<i> disk? If it is, the combined I/O could strain your I/O subsystem and  
</I>&gt;<i> create timeouts. If this is the case, perhaps you could reduce the  
</I>&gt;<i> logging level.
</I>
I'm not sure that rabbit is writing to mnesia for logs.

table_definitions() -&gt;
     [{user, [{disc_copies, [node()]},
              {attributes, record_info(fields, user)}]},
      {user_vhost, [{type, bag},
                    {disc_copies, [node()]},
                    {attributes, record_info(fields, user_vhost)},
                    {index, [virtual_host]}]},
      {vhost, [{disc_copies, [node()]},
               {attributes, record_info(fields, vhost)}]},
      {rabbit_config, [{disc_copies, [node()]}]},
      {listener, [{type, bag},
                  {attributes, record_info(fields, listener)}]},
      {binding, [{attributes, record_info(fields, binding)}]},
      {durable_exchanges, [{disc_copies, [node()]},
                           {record_name, exchange},
                           {attributes, record_info(fields,  
exchange)}]},
      {exchange, [{attributes, record_info(fields, exchange)}]},
      {durable_queues, [{disc_copies, [node()]},
                        {record_name, amqqueue},
                        {attributes, record_info(fields, amqqueue)}]},
      {amqqueue, [{attributes, record_info(fields, amqqueue)},
                  {index, [pid]}]}].

This is rabbit_mnesia.erl and I don't see a table that contains the  
messages. It seems it's
mostly used to keep durable stuff and configuration parameters for  
rabbitmq.

It's the log file itself not mnesia. My own computer runs OSX and it  
was running both ab and rabbitmq
so the disk was probably really trashed (And it's already slow enough).

How do I reduce the logging level? I don't see a lot of logging in  
rabbitmq or my webserver except after
startup so I suppose they might be logging somewhere else and in that  
case I wouldn't mind reducing it,
unless it's the persister log, in which case more is better.

&gt;<i> My feeling is to try to remove the cause of the timeouts rather than  
</I>&gt;<i> work around them. vmstat is your friend.
</I>
Well... I'm not really working around them. It's just what I saw and I  
also saw that even in that case no line
was lost, the system then should be robust enough to restore itself  
under this circumstances, the timeout
might even come from network latency actually, so even if my disk is  
the fastest in the world I still need to
care for this other issue.

&gt;<i> I forget - what web server are you using? Is it Yaws?
</I>

mochiweb

- --
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: <A HREF="http://www.twisted.it">http://www.twisted.it</A>
<A HREF="http://www.adroll.com">http://www.adroll.com</A>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)

iEYEARECAAYFAkjZbcAACgkQ9Llz28widGUvWACeOw9AgwSk44+9DVzrJ1/lEKHL
+uoAoJqHSLX0bNJ47C7zr9J1Td4IL8gX
=ME+d
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001591.html">[rabbitmq-discuss] erlang client API: transactions
</A></li>
	<LI>Next message: <A HREF="001594.html">[rabbitmq-discuss] erlang client API: transactions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1592">[ date ]</a>
              <a href="thread.html#1592">[ thread ]</a>
              <a href="subject.html#1592">[ subject ]</a>
              <a href="author.html#1592">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
