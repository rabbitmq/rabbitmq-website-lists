<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Gracefully shutting down rabbitmq
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Gracefully%20shutting%20down%20rabbitmq&In-Reply-To=e1c05edd0809010931v6c47633p7b241140cc709642%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001296.html">
   <LINK REL="Next"  HREF="001299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Gracefully shutting down rabbitmq</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Gracefully%20shutting%20down%20rabbitmq&In-Reply-To=e1c05edd0809010931v6c47633p7b241140cc709642%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Gracefully shutting down rabbitmq">0x6e6562 at gmail.com
       </A><BR>
    <I>Mon Sep  1 21:07:35 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001296.html">[rabbitmq-discuss] Gracefully shutting down rabbitmq
</A></li>
        <LI>Next message: <A HREF="001299.html">[rabbitmq-discuss] Gracefully shutting down rabbitmq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1297">[ date ]</a>
              <a href="thread.html#1297">[ thread ]</a>
              <a href="subject.html#1297">[ subject ]</a>
              <a href="author.html#1297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Aman,

On Mon, Sep 1, 2008 at 5:31 PM, Aman Gupta &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq at tmm1.net</A>&gt; wrote:
&gt;<i> I have approximately 10k durable queues and 5k durable exchanges. These must
</I>&gt;<i> be durable; in addition I also have several other exchanges and queues that
</I>&gt;<i> don't need to be durable and are not marked as such.
</I>
That doesn't seem like much. I just created 5k exchanges and
created/bound 2 queues to each (i.e. 10k queues), which took about 9
secs to complete, and then I shut the broker down, and restarted it.
The recovery phase took about 20 secs, so I'm wondering what is taking
so long when your broker has to recover. Another possibility is that
it is spending the time in playing the log back in, which happens
after the mnesia recovery phase.

&gt;<i> Are there any other commands or options for triggering a shutdown of
</I>&gt;<i> rabbitmq?
</I>
My favourites are Ctrl-C, kill-9 and halt() :-)

On a more official note, you can call use the rabbitmqctl script with
the argument stop, but that just calls the rabbit_control module with
the stop argument, which is what you are effectively doing with the
command you mentioned previously.

If you do have Rabbit running in a shell (or even via a remote shell),
another *cleaner* option is use the OTP application handler i.e.

1&gt; application:stop(rabbit).

I'll try to replicate your problem running the same command as you did.

BTW, when you run this command, do you see an epmd process running in
your activity log?

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001296.html">[rabbitmq-discuss] Gracefully shutting down rabbitmq
</A></li>
	<LI>Next message: <A HREF="001299.html">[rabbitmq-discuss] Gracefully shutting down rabbitmq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1297">[ date ]</a>
              <a href="thread.html#1297">[ thread ]</a>
              <a href="subject.html#1297">[ subject ]</a>
              <a href="author.html#1297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
