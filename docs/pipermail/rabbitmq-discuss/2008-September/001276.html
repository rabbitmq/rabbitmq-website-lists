<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] EOFException when messages in queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20EOFException%20when%20messages%20in%20queue&In-Reply-To=7fa430270808311234q24956417p66124eeea161a9d0%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001294.html">
   <LINK REL="Next"  HREF="001279.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] EOFException when messages in queue</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20EOFException%20when%20messages%20in%20queue&In-Reply-To=7fa430270808311234q24956417p66124eeea161a9d0%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] EOFException when messages in queue">0x6e6562 at gmail.com
       </A><BR>
    <I>Mon Sep  1 01:39:10 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001294.html">[rabbitmq-discuss] UPDATE: Re: Running RabbitMQ as a Windows Service - Having some problems
</A></li>
        <LI>Next message: <A HREF="001279.html">[rabbitmq-discuss] Urgently Need help to get RabbitMQ	publishing to Flex-based subscriber
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1276">[ date ]</a>
              <a href="thread.html#1276">[ thread ]</a>
              <a href="subject.html#1276">[ subject ]</a>
              <a href="author.html#1276">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Bradford,

On Sun, Aug 31, 2008 at 8:34 PM, bradford &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">fingermark at gmail.com</A>&gt; wrote:
&gt;<i> I'm running the AMQPExampleFunPack.actorExample scala example from:
</I>&gt;<i> <A HREF="http://github.com/dpp/liftweb/tree/master/lift-amqp/src/main/scala/net/liftweb/amqp/AMQPSender.scala">http://github.com/dpp/liftweb/tree/master/lift-amqp/src/main/scala/net/liftweb/amqp/AMQPSender.scala</A>
</I>&gt;<i> It was working great until I shutdown the client listeners and
</I>&gt;<i> RabbitMQ queued up 2 messages.
</I>
This would be expected behaviour if a client dies. The broker will
queue up messages for them until they re-connect and start consuming
again.

&gt;<i> Now when I run the
</I>&gt;<i> AMQPExampleFunPack.actorExample scala example I get an EOFException.
</I>&gt;<i> My questions are 1) is it possible to clear a queue (&quot;routeroute&quot;) in
</I>&gt;<i> RabbitMQ w/o writing code for it?
</I>
Using the protocol/API client you can purge a queue using the
queue.purge command.

Other than that, queue purging is not exposed in the rabbitmqctl
script, but there is an ongoing discussion about management within
Rabbit, so you could participate in that with this requirement.

If you would like to issue an Rabbit native call in Erlang, either in
the VM that the server is running in or via a remote shell, you call
rabbitmq_amqueue:lookup/1 to get the PID of a queue and then call
rabbitmq_amqueue:purge/1 with the result.

&gt;<i>2) Is there anything obvious I need
</I>&gt;<i> to do to fix the exception, in the event that messages queue up in the
</I>&gt;<i> future?
</I>
See point above.

&gt;<i>
</I>&gt;<i> [WARNING] Consumer <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">com.newpers.amqp.SerializedConsumer at 337d0f</A> method
</I>&gt;<i> handleDelivery for channel
</I>&gt;<i> AMQChannel(<A HREF="amqp://guest@192.168.2.1:5672/,1">amqp://guest@192.168.2.1:5672/,1</A>) threw an exception:
</I>&gt;<i> [WARNING] java.io.EOFException
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> java.io.ObjectInputStream$PeekInputStream.readFully(ObjectInputStream.java:2281)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> java.io.ObjectInputStream$BlockDataInputStream.readShort(ObjectInputStream.java:2750)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:780)
</I>&gt;<i> [WARNING]       at java.io.ObjectInputStream.&lt;init&gt;(ObjectInputStream.java:280)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> com.newpers.amqp.SerializedConsumer.handleDelivery(AMQPDispatcher.scala:105)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> com.rabbitmq.client.impl.ChannelN.processAsync(ChannelN.java:189)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel.java:146)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:101)
</I>&gt;<i> [WARNING]       at
</I>&gt;<i> com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:440)
</I>
I'm not an expert with this particular scala client but it looks to be
within the context of actually unpacking the payload on the
application layer, so I would have expected the data to have been
buffered up already. Is there any way you can dump the verbatim of the
payload without parsing it to see what is coming in off the wire?

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001294.html">[rabbitmq-discuss] UPDATE: Re: Running RabbitMQ as a Windows Service - Having some problems
</A></li>
	<LI>Next message: <A HREF="001279.html">[rabbitmq-discuss] Urgently Need help to get RabbitMQ	publishing to Flex-based subscriber
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1276">[ date ]</a>
              <a href="thread.html#1276">[ thread ]</a>
              <a href="subject.html#1276">[ subject ]</a>
              <a href="author.html#1276">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
