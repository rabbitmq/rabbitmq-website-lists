<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error code 541
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Error%20code%20541&In-Reply-To=48C91DE6.9090708%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001444.html">
   <LINK REL="Next"  HREF="001569.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error code 541</H1>
    <B>Eran Sandler</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Error%20code%20541&In-Reply-To=48C91DE6.9090708%40gmail.com"
       TITLE="[rabbitmq-discuss] Error code 541">eran.sandler at gmail.com
       </A><BR>
    <I>Mon Sep 22 15:00:49 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001444.html">[rabbitmq-discuss] Error code 541
</A></li>
        <LI>Next message: <A HREF="001569.html">[rabbitmq-discuss] Error code 541
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1568">[ date ]</a>
              <a href="thread.html#1568">[ thread ]</a>
              <a href="subject.html#1568">[ subject ]</a>
              <a href="author.html#1568">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm happy to say that I may have found the problem to this issue.


If I run rabbitmq from the command line and NOT through erlsrv (in 
Windows erlsrv will run as a Windows service) the process is alive and 
well and not having any issues.


If I run it through erlsrv, it dies after less than 24 hours with the 
annoying error code 541.


Since Windows is a bit more annoying with running background processes 
(its not enough to add an &quot;&amp;&quot; character :-) ) I wrote a small Windows 
service that acts as a delegate and executes rabbitmq's batch file 
(rabbitmq-server.bat).


If the real rabbitmq process dies from whatever reason, the Windows 
service will stop as if it died as well. That allows me to mimic the 
behavior one would see if running rabbitmq as a background process or as 
a task during boot on Linux.

So far its running for about 48 hours without a problem.


If you want, I can share the little Windows Service (I called it 
RabbitMQ Executer) with the list.

For ease of use and implementation time I wrote it in C# (in .NET), so 
it requires the .NET runtime, but it can easily be written in native C 
since all it does is open a thread and executes the RabbitMQ process.


Eran


Eran Sandler wrote:

&gt;<i> Here are the tests.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> There is the one project for producing stuff that looks like the 
</I>&gt;<i> messages I'm sending and a very simple consumer.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is VERY crude (I did this very quickly) stuff and I might be 
</I>&gt;<i> wrong in my programming paradigm that I use with RabbitMQ so please 
</I>&gt;<i> let me know of everything I should change.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That's basically what I do.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Be sure to define the username, password and virtual. This sample 
</I>&gt;<i> assumes there is a queue named ActionsQueue and it was already created 
</I>&gt;<i> (creating it with the CreateQueue sample that comes with the .NET 
</I>&gt;<i> library and making it durable will make it exactly how I've defined it).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I don't use the automatic consumer that waits for data because I need 
</I>&gt;<i> some flexibility in that area, that's why I have the sleep part.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hope that will help,
</I>&gt;<i>
</I>&gt;<i> Eran
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ben Hood wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Eran,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Thu, Sep 11, 2008 at 1:57 PM, Eran Sandler &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">eran.sandler at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> I don't use an exchange. I saw that its possible to use this without an
</I>&gt;&gt;&gt;<i> exchange (but perhaps I'm screwing myself with regards to clustering, I
</I>&gt;&gt;&gt;<i> haven't taken a closer look as to how to work well with clustering).
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> No, that's fine. What you are doing is using what is known as the
</I>&gt;&gt;<i> default exchange. This means that message is routed to a queue with
</I>&gt;&gt;<i> the same name as the routing key.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> I think BasicConsume should work just fine. I saw that it can handle the Ack
</I>&gt;&gt;&gt;<i> automatically. The reason I thought using BasicGet was to keep my options
</I>&gt;&gt;&gt;<i> open as to refuse a message for a point in time where my consuming code will
</I>&gt;&gt;&gt;<i> run on a couple of machines that might get upgraded sequentially. This might
</I>&gt;&gt;&gt;<i> lead to scenario in which I have added a new message type I want to handle
</I>&gt;&gt;&gt;<i> and I don't have the new code on all consumers.
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You can ack manually if you want to. Set the no_ack flag to true and
</I>&gt;&gt;<i> then make a application specific decision of whether to ack or not in
</I>&gt;&gt;<i> the onDeliver callback.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> Regarding the sample, I will write something quick based on my original code
</I>&gt;&gt;&gt;<i> and send it so it will make your life (and mine) a lot nicer (and quicker)
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cool, hopefully one of us will get some time to look at it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ben
</I>&gt;&gt;<i>   
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080922/b330ec16/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080922/b330ec16/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001444.html">[rabbitmq-discuss] Error code 541
</A></li>
	<LI>Next message: <A HREF="001569.html">[rabbitmq-discuss] Error code 541
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1568">[ date ]</a>
              <a href="thread.html#1568">[ thread ]</a>
              <a href="subject.html#1568">[ subject ]</a>
              <a href="author.html#1568">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
