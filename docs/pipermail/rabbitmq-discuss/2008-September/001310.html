<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Gracefully shutting down rabbitmq
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Gracefully%20shutting%20down%20rabbitmq&In-Reply-To=e1c05edd0809011444y33cb526wb2ed28e1bfca8c63%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001306.html">
   <LINK REL="Next"  HREF="001311.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Gracefully shutting down rabbitmq</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Gracefully%20shutting%20down%20rabbitmq&In-Reply-To=e1c05edd0809011444y33cb526wb2ed28e1bfca8c63%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Gracefully shutting down rabbitmq">0x6e6562 at gmail.com
       </A><BR>
    <I>Tue Sep  2 07:02:41 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001306.html">[rabbitmq-discuss] Gracefully shutting down rabbitmq
</A></li>
        <LI>Next message: <A HREF="001311.html">[rabbitmq-discuss] This is a test mail - don't bother to read this
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1310">[ date ]</a>
              <a href="thread.html#1310">[ thread ]</a>
              <a href="subject.html#1310">[ subject ]</a>
              <a href="author.html#1310">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Aman,

On Mon, Sep 1, 2008 at 10:44 PM, Aman Gupta &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq at tmm1.net</A>&gt; wrote:
&gt;<i> The error was being thrown by the original rabbitmq daemon, not the
</I>&gt;<i> controller erlang process. The controller process exited cleanly.. the
</I>&gt;<i> rabbitmq daemon received the halt signal and then proceeded to throw that
</I>&gt;<i> duplicate name error.
</I>
Yes, it's really strange that it initiates the shutdown procedure,
gets through it sucessfully (the Rabbit application does actually
stop) and then it barfs.

To try to reproduce this I ran a second Erlang shell with the same
name as the shutdown controller, i.e.

$ erl -sname rabbitmq_controller

and then tried to shutdown:

$ erl -sname rabbitmq_controller -noinput -s rabbit_control -extra -n
rabbit stop

which results in the &quot;Protocol: ~p: register error: ~p~n&quot; that was
orginally reported, but this in the VM that is running the shutdown
command, not in the broker itself.

Also, having TCP connections open to the broker when you send the
shutdown command is handled as well, so having a few clients connected
during shutdown doesn't provoke the problem for me.

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001306.html">[rabbitmq-discuss] Gracefully shutting down rabbitmq
</A></li>
	<LI>Next message: <A HREF="001311.html">[rabbitmq-discuss] This is a test mail - don't bother to read this
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1310">[ date ]</a>
              <a href="thread.html#1310">[ thread ]</a>
              <a href="subject.html#1310">[ subject ]</a>
              <a href="author.html#1310">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
