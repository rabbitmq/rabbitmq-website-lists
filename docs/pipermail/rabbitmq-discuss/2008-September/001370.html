<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [BUG] Erlang RabbitMQ client requires	installed server code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%5BBUG%5D%20Erlang%20RabbitMQ%20client%20requires%0A%09installed%20server%20code&In-Reply-To=48C39615.7070509%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001379.html">
   <LINK REL="Next"  HREF="001366.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [BUG] Erlang RabbitMQ client requires	installed server code</H1>
    <B>Edwin Fine</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%5BBUG%5D%20Erlang%20RabbitMQ%20client%20requires%0A%09installed%20server%20code&In-Reply-To=48C39615.7070509%40lshift.net"
       TITLE="[rabbitmq-discuss] [BUG] Erlang RabbitMQ client requires	installed server code">rabbitmq-discuss_efine at usa.net
       </A><BR>
    <I>Sun Sep  7 22:59:27 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001379.html">[rabbitmq-discuss] [BUG] Erlang RabbitMQ client requires	installed server code
</A></li>
        <LI>Next message: <A HREF="001366.html">[rabbitmq-discuss] Internal services (was Re: Queue info)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1370">[ date ]</a>
              <a href="thread.html#1370">[ thread ]</a>
              <a href="subject.html#1370">[ subject ]</a>
              <a href="author.html#1370">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,


&gt;<i> Bear in mind that the Erlang client code base can operate in both direct
</I>&gt;<i> and networked mode. For the former you definitely need a server.
</I>

I do understand, but there should be separate direct network clients. I
think it's asking for trouble, and untidy, to have references in code to
something that it will never use and will crash if it ever magically does
try to use it. It also confuses dependency analysis tools. I want to build a
release consisting only of modules that are needed for a network client, for
a sort of embedded server scenario. As things stand now, I will have to pull
in some or all of the rabbitmq_server application, and I will have to have
the server code installed on the build system even if I am never going to
use it on that system. Maybe I am being picky here (call me &quot;purist&quot;, if you
must), but that doesn't feel right to me. I didn't need the server code to
build client-related code with WebSphere MQ.

 I respectfully suggest that the above RabbitMQ server modules, and their
&gt;<i> dependencies, be bundled with the Erlang client. Ideally, I would think it
</I>&gt;<i> would be best perhaps to put them a separate Erlang library application
</I>&gt;<i> (maybe &quot;rabbitmq_common&quot;) that is used both by the server and the Erlang
</I>&gt;<i> client.
</I>&gt;<i>
</I>
The above is on our todo list. Refactoring the code is the easy part. The
&gt;<i> challenges are in:
</I>&gt;<i>
</I>&gt;<i> - updating the module structure of the VCS - is rabbitmq_common going to be
</I>&gt;<i> a separate HG module?
</I>

That depends. Is it something that is reusable in a number of contexts? If
so, I would say yes, although I am not sure what the HG-specific
consequences are of having a separate HG module.


&gt;<i> - figuring out how rabbitmq_common will be distributed. This can be a
</I>&gt;<i> combination of all of the following: a) separately, b) as part of the Erlang
</I>&gt;<i> client and server source packages, c) as part of the Erlang client and
</I>&gt;<i> server binary packages. Then there also the Debian and RPM packages to
</I>&gt;<i> consider - are we going to have a separate packages for rabbitmq_common or
</I>&gt;<i> will it be bundled with the existing packages?
</I>

I think of this as a library on which multiple different applications
depend, something like glibc. It needs to be there, in the correct version,
before you can install packages that depend on it. So it needs to be a
separately installable app. rabbitmq_server.app, rabbitmq_direct_client.app,
and rabbitmq_network_client.app will all show rabbitmq_common as an
included_application.

If you do this, I believe it fits in to the Debian/RPM/Yum/YaST/Uncle Tom
Cobbleigh and all's dependency model.

Depending on the above choices a significant amount of work needs to be put
&gt;<i> into revising the build system, the packaging system, our automated
</I>&gt;<i> deployment system, the documentation, and parts of the web site.
</I>&gt;<i>
</I>
That's for sure!


&gt;<i>
</I>&gt;<i> That's why it hasn't happened yet.
</I>&gt;<i>
</I>
I understand. I was just caught by surprise trying to create what is
effectively an embedded client. I've been trying to tease apart the
dependencies of many products for a few days now :(

Regards,
&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080907/2e675e0b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080907/2e675e0b/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001379.html">[rabbitmq-discuss] [BUG] Erlang RabbitMQ client requires	installed server code
</A></li>
	<LI>Next message: <A HREF="001366.html">[rabbitmq-discuss] Internal services (was Re: Queue info)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1370">[ date ]</a>
              <a href="thread.html#1370">[ thread ]</a>
              <a href="subject.html#1370">[ subject ]</a>
              <a href="author.html#1370">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
