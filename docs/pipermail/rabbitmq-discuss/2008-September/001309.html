<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20performance&In-Reply-To=6c2563b20809011523wbec6ebdrc2bf73da01ef9bc7%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001307.html">
   <LINK REL="Next"  HREF="001295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] performance</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20performance&In-Reply-To=6c2563b20809011523wbec6ebdrc2bf73da01ef9bc7%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] performance">matthias at lshift.net
       </A><BR>
    <I>Tue Sep  2 05:08:44 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001307.html">[rabbitmq-discuss] performance
</A></li>
        <LI>Next message: <A HREF="001295.html">[rabbitmq-discuss] Debugging of Connection.class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1309">[ date ]</a>
              <a href="thread.html#1309">[ thread ]</a>
              <a href="subject.html#1309">[ subject ]</a>
              <a href="author.html#1309">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Edwin,

Edwin Fine wrote:
&gt;<i> &lt;snip&gt;Lots of excellent suggestions of how to run tests&lt;/snip&gt;
</I> &gt; ...
&gt;<i> There are so many possible variations that this could become a
</I>&gt;<i> full-time job!
</I>
Indeed, but, as I suggested earlier, we can start with a single test 
scenario and expand later. What's important is that the test is fully 
automated and calculates a max throughput figure that is reasonably 
accurate.

&gt;<i> As Martin points out, measuring throughput can be tricky. I suggest
</I>&gt;<i> some sort of feedback mechanism to adjust the speed at which messages
</I>&gt;<i> are sent. For example, the Erlang client could write its message
</I>&gt;<i> consumption rate each second into an ets table, which the producer
</I>&gt;<i> could read. As long as the rate goes up, the producer keeps pumping
</I>&gt;<i> more through. As soon as the producer sees the rate plateau or even
</I>&gt;<i> drop, averaged over a few measurements to prevent hysteresis, it cuts
</I>&gt;<i> back.
</I>
I tried a different kind of feedback mechanism a while ago. I set up a 
test that keeps a certain number of messages &quot;in flight&quot; - the producer 
sends n messages and then for each message the consumer receives the 
producer sends another message. We wait a while for the system to settle 
down and then we measure the throughput. Then we pick a different 
in-flight count and repeat.

The idea behind this is that by varying the in-flight message count we 
can control how much buffering is taking place in the overall system and 
hence find the sweet spot at which it performs optimally.

Unfortunately it turns out that finding the sweet spot is hard. There 
are local maxima, and it shifts over time.


Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001307.html">[rabbitmq-discuss] performance
</A></li>
	<LI>Next message: <A HREF="001295.html">[rabbitmq-discuss] Debugging of Connection.class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1309">[ date ]</a>
              <a href="thread.html#1309">[ thread ]</a>
              <a href="subject.html#1309">[ subject ]</a>
              <a href="author.html#1309">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
