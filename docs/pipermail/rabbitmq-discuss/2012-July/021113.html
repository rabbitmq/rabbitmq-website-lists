<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Envelop redeliver question ( clustering ha	redelivery question)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Envelop%20redeliver%20question%20%28%20clustering%20ha%0A%09redelivery%20question%29&In-Reply-To=%3Cd4ab5dd6-3062-4b23-a4dd-e6fcd7d97e35%40h9g2000yqi.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021104.html">
   <LINK REL="Next"  HREF="021120.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Envelop redeliver question ( clustering ha	redelivery question)</H1>
    <B>Vikas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Envelop%20redeliver%20question%20%28%20clustering%20ha%0A%09redelivery%20question%29&In-Reply-To=%3Cd4ab5dd6-3062-4b23-a4dd-e6fcd7d97e35%40h9g2000yqi.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Envelop redeliver question ( clustering ha	redelivery question)">mvikasetc at gmail.com
       </A><BR>
    <I>Sun Jul  8 20:32:43 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021104.html">[rabbitmq-discuss] there is a Consumer connected?
</A></li>
        <LI>Next message: <A HREF="021120.html">[rabbitmq-discuss] Envelop redeliver question ( clustering ha redelivery question)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21113">[ date ]</a>
              <a href="thread.html#21113">[ thread ]</a>
              <a href="subject.html#21113">[ subject ]</a>
              <a href="author.html#21113">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello All,

I have setup rabbitmq cluster with 2 nodes and i am using joshdevins
rabbitmq ha client to consume messages - to simulate real scenario of
data processing i have added sleep for 10 seconds before sending ack.
On crashing(stopping) the master node - the connection is re
established with 2nd rabbitmq node However i do received the last un
acknowledged message which was failed to ack due to master node crash.

This is acceptable and expected.  To handle this scenario i thought to
use isRedeliver value from envelop but i observed different behavior
than documented about redeliver flag value.

On restarting the node which was down. I see all messages with
redelivered(delivery.getEnvelope().isRedeliver()) as true in my
consumer. The consumer was also restarted after restarting the node.

Why the redelivery value is true when the messages were not even
attempted to ack by consumer.
Is this a bug or am i doing something wrong?

java doc reference : redeliver - true if this is a redelivery
following a failed ack


Thanks
Vikas
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021104.html">[rabbitmq-discuss] there is a Consumer connected?
</A></li>
	<LI>Next message: <A HREF="021120.html">[rabbitmq-discuss] Envelop redeliver question ( clustering ha redelivery question)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21113">[ date ]</a>
              <a href="thread.html#21113">[ thread ]</a>
              <a href="subject.html#21113">[ subject ]</a>
              <a href="author.html#21113">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
