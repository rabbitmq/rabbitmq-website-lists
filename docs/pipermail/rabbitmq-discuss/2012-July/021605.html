<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Crashes - init terminating?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Crashes%20-%20init%20terminating%3F&In-Reply-To=%3C7CDB61C0-1459-4E33-BB56-ABE641E2F481%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021602.html">
   <LINK REL="Next"  HREF="021603.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Crashes - init terminating?</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Crashes%20-%20init%20terminating%3F&In-Reply-To=%3C7CDB61C0-1459-4E33-BB56-ABE641E2F481%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Crashes - init terminating?">steve at rabbitmq.com
       </A><BR>
    <I>Tue Jul 31 12:22:00 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021602.html">[rabbitmq-discuss] Crashes - init terminating?
</A></li>
        <LI>Next message: <A HREF="021603.html">[rabbitmq-discuss] AMQP Message attributes properties
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21605">[ date ]</a>
              <a href="thread.html#21605">[ thread ]</a>
              <a href="subject.html#21605">[ subject ]</a>
              <a href="author.html#21605">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Don,

Since our last conversation the latest release has become 2.8.4.

&gt;&gt;<i> Did you run `sudo port load rabbitmq-server` which starts the service in
</I>&gt;&gt;<i> the background?
</I>&gt;<i> No - and I've never had to before.
</I>

Well, you don't have to, but if you don't you need to start the server
yourself (`sudo rabbitmq-server` or `sudo rabbitmq-server -detached`)
before running rabbitmqctl etc. Did you? If you didn't then you have an
old version still running -- this may be scuppered because of an Erlang
upgrade during the rabbitmq-server install. So...

I think your problems are probably caused by having two installations
interfering (or possibly an old Erlang version).

If you haven't installed rabbitmq-server or Erlang by any other means
than macports then the following sequence will probably get you working.

(If you have, please ensure that the other installations are correctly
removed (including any plugin directories, environment variable
settings, &amp;c.) before proceeding.)

Execute the following steps:

1) obtain the latest macports version `sudo port selfupdate` (Macports
   2.1.2 is what I get today.)

2) perform `sudo port upgrade outdated` (this might cure everything, but
   just in case...)

3) uninstall all previous versions of rabbitmq-server (`sudo port
   uninstall rabbitmq-server` should do it) check these are all gone:
   `sudo port installed rabbitmq-*`

4) clean up: `sudo port -u -v uninstall` will remove any debris from the
   macports repository

5) check your Erlang version: `sudo port installed erlang*` (should be
   active) upgrade this is it old (should have been done already above)

6) perform a clean install: `sudo port install rabbitmq-server` (check
   what version you get)

7) OBSERVE the instructions issued during this install about `sudo port
   load rabbitmq-server`. You might want to start rabbitmq in the
   background this way, or start it the normal way if you want. But
   start it.

Now everything should work. Come back here if it doesn't. In
particular, the output from when you start the server and the first
rabbitmqctl command.

Hope all goes smoothly for you.

Steve Powell  (a happy bunny)
----------yet more definitions from the SPD----------
corrugate (n.) T.V. soap scandal.
olympic (n.) A camp road-digger.
jamboree (n.) A conserve made from French cheese.

On 31 Jul 2012, at 11:56, Steve Powell wrote:

&gt;<i> Dan,
</I>&gt;<i> Reposting on Discuss.  Please continue correspondence on ths rabbitmq-discuss mailing list.
</I>&gt;<i> 
</I>&gt;<i> From: 	Dan Dart &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dan at canddi.com</A>&gt;
</I>&gt;<i> Subject: 	Re: [rabbitmq-discuss] Crashes - init terminating?
</I>&gt;<i> Date: 	30 July 2012 18:07:05 GMT+01:00
</I>&gt;<i> To: 	Steve Powell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt;
</I>&gt;<i> 
</I>&gt;&gt;<i> Did you run `sudo port load rabbitmq-server` which starts the service in
</I>&gt;&gt;<i> the background?
</I>&gt;<i> No - and I've never had to before.
</I>&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Now accessing the rabbitmqctl and rabbitmq-server scripts from the
</I>&gt;&gt;<i> command line requires that you issue them as root, done with sudo:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>    sudo rabbitmqctl status
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This should give a reasonable response.
</I>&gt;<i> 
</I>&gt;<i> Doesn't look reasonable to me:
</I>&gt;<i> {&quot;init terminating in
</I>&gt;<i> do_boot&quot;,{undef,[{rabbit_control,start,[]},{init,start_it,1},{init,start_em,1}]}}
</I>&gt;<i> 
</I>&gt;<i> Crash dump was written to: erl_crash.dump
</I>&gt;<i> init terminating in do_boot ()
</I>&gt;<i> 
</I>&gt;&gt;<i> To see if the server has problems you should look in the log directory
</I>&gt;&gt;<i> (/opt/local/var/log/rabbitmq/*) where you should have two logs for each
</I>&gt;&gt;<i> rabbitmq node you run. (By default this is rabbit@&lt;hostname&gt;.log and
</I>&gt;&gt;<i> -sasl.log.) I suspect there will be nothing untoward there.
</I>&gt;<i> 
</I>&gt;<i> Getting lots of connection_closed_abruptly - although I suspect this is normal.
</I>&gt;<i> And nothing in the sasl log.
</I>&gt;<i> 
</I>&gt;&gt;<i> I cannot reproduce your symptoms unless I disable the -pa option on the
</I>&gt;&gt;<i> (eventual) erl command, so it looks as though you have an environment
</I>&gt;&gt;<i> problem. Please check the following directory:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>    /opt/local/lib/rabbitmq/lib/rabbitmq_server-2.8.2/
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and see if the scripts are in sbin/, and there are a lot of beam files
</I>&gt;&gt;<i> in ebin/.
</I>&gt;<i> [Dan-Darts-iMac:lib/rabbitmq_server-2.8.2/sbin] DanDart% ls
</I>&gt;<i> rabbitmq-defaults	rabbitmq-env		rabbitmq-plugins	rabbitmq-server		rabbitmqctl
</I>&gt;<i> 
</I>&gt;<i> [Dan-Darts-iMac:lib/rabbitmq_server-2.8.2/ebin] DanDart% ls
</I>&gt;<i> credit_flow.beam
</I>&gt;<i> [...snip...]
</I>&gt;<i> 
</I>&gt;&gt;<i> PS:
</I>&gt;&gt;<i> [You might be using a non-standard prefix for macport install
</I>&gt;&gt;<i> files -- if so, the /opt/local in this directory path might be something
</I>&gt;&gt;<i> different for you -- and we may have a bug, since we are supposed to
</I>&gt;&gt;<i> cope with that.]
</I>&gt;<i> 
</I>&gt;<i> Nope - it's the same. I just used a standard &quot;port install
</I>&gt;<i> rabbitmq-server&quot; and don't remember doing anything that would break
</I>&gt;<i> it.
</I>&gt;<i> 
</I>&gt;<i> Is that any help?
</I>&gt;<i> 
</I>&gt;<i> Regards
</I>&gt;<i> Dan
</I>&gt;<i> 
</I>&gt;<i> Steve Powell  (a happy bunny)
</I>&gt;<i> ----------yet more definitions from the SPD----------
</I>&gt;<i> corrugate (n.) T.V. soap scandal.
</I>&gt;<i> olympic (n.) A camp road-digger.
</I>&gt;<i> jamboree (n.) A conserve made from French cheese.
</I>&gt;<i> 
</I>&gt;<i> On 19 Jun 2012, at 14:04, Steve Powell wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi Dan,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The Erlang crash dumps for rabbitmq-server and rabbitmqctl are because
</I>&gt;&gt;<i> of failures to run these Erlang programs (actually a prelaunch program
</I>&gt;&gt;<i> in the former case). They should not affect the rabbitmq-server service
</I>&gt;&gt;<i> if it is already running (which it appears to be since you say sending
</I>&gt;&gt;<i> and receiving messages are fine).
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I assume that by the latest version of rabbitmq you are running
</I>&gt;&gt;<i> rabbitmq-server 2.8.2, and Erlang R15B, which is what I get from my
</I>&gt;&gt;<i> macports (on OS X 10.6.8, macports 2.1.1). You should check that any
</I>&gt;&gt;<i> earlier version(s) is(are) uninstalled.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Did you run `sudo port load rabbitmq-server` which starts the service in
</I>&gt;&gt;<i> the background?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Now accessing the rabbitmqctl and rabbitmq-server scripts from the
</I>&gt;&gt;<i> command line requires that you issue them as root, done with sudo:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>    sudo rabbitmqctl status
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This should give a reasonable response.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> To see if the server has problems you should look in the log directory
</I>&gt;&gt;<i> (/opt/local/var/log/rabbitmq/*) where you should have two logs for each
</I>&gt;&gt;<i> rabbitmq node you run. (By default this is rabbit@&lt;hostname&gt;.log and
</I>&gt;&gt;<i> -sasl.log.) I suspect there will be nothing untoward there.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I cannot reproduce your symptoms unless I disable the -pa option on the
</I>&gt;&gt;<i> (eventual) erl command, so it looks as though you have an environment
</I>&gt;&gt;<i> problem. Please check the following directory:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>    /opt/local/lib/rabbitmq/lib/rabbitmq_server-2.8.2/
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and see if the scripts are in sbin/, and there are a lot of beam files
</I>&gt;&gt;<i> in ebin/.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> PS: 
</I>&gt;&gt;<i> [You might be using a non-standard prefix for macport install
</I>&gt;&gt;<i> files -- if so, the /opt/local in this directory path might be something
</I>&gt;&gt;<i> different for you -- and we may have a bug, since we are supposed to
</I>&gt;&gt;<i> cope with that.]
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Steve Powell  (a happy bunny)
</I>&gt;&gt;<i> ----------yet more definitions from the SPD----------
</I>&gt;&gt;<i> corrugate (n.) T.V. soap scandal.
</I>&gt;&gt;<i> olympic (n.) A camp road-digger.
</I>&gt;&gt;<i> jamboree (n.) A conserve made from French cheese.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On 19 Jun 2012, at 10:44, Dan Dart wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I'm having a problem in that sending and receiving messages is fine,
</I>&gt;&gt;&gt;<i> but doing either of these commands:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> rabbitmqctl list_exchanges
</I>&gt;&gt;&gt;<i> rabbitmqctl list_queues
</I>&gt;&gt;&gt;<i> rabbitmqctl list_bindings
</I>&gt;&gt;&gt;<i> rabbitmqctl delete_user
</I>&gt;&gt;&gt;<i> rabbitmqctl add_user
</I>&gt;&gt;&gt;<i> rabbitmqctl delete_vhost
</I>&gt;&gt;&gt;<i> rabbitmqctl add_vhost
</I>&gt;&gt;&gt;<i> rabbitmqctl set_permissions
</I>&gt;&gt;&gt;<i> rabbitmqctl stop
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> echoes the following to stderr:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> {&quot;init terminating in
</I>&gt;&gt;&gt;<i> do_boot&quot;,{undef,[{rabbit_control,start,[]},{init,start_it,1},{init,start_em,1}]}}
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Crash dump was written to: erl_crash.dump
</I>&gt;&gt;&gt;<i> init terminating in do_boot ()
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> and rabbitmq-server results in:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> {&quot;init terminating in
</I>&gt;&gt;&gt;<i> do_boot&quot;,{undef,[{rabbit_prelaunch,start,[]},{init,start_it,1},{init,start_em,1}]}}
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Crash dump was written to: erl_crash.dump
</I>&gt;&gt;&gt;<i> init terminating in do_boot ()
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> My Rabbit version is the latest from MacPorts on OSX 10.6 (and will
</I>&gt;&gt;&gt;<i> not tell me itself).
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> My erl_crash.dump:
</I>&gt;&gt;&gt;<i> <A HREF="https://gist.github.com/2953290">https://gist.github.com/2953290</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Cheers
</I>&gt;&gt;&gt;<i> Dan
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120731/8450ffda/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120731/8450ffda/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021602.html">[rabbitmq-discuss] Crashes - init terminating?
</A></li>
	<LI>Next message: <A HREF="021603.html">[rabbitmq-discuss] AMQP Message attributes properties
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21605">[ date ]</a>
              <a href="thread.html#21605">[ thread ]</a>
              <a href="subject.html#21605">[ subject ]</a>
              <a href="author.html#21605">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
