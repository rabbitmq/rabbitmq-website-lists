<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] unable to cluster rabbitmq on ec2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20unable%20to%20cluster%20rabbitmq%20on%20ec2&In-Reply-To=%3C5007DDC7.6080902%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021375.html">
   <LINK REL="Next"  HREF="021379.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] unable to cluster rabbitmq on ec2</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20unable%20to%20cluster%20rabbitmq%20on%20ec2&In-Reply-To=%3C5007DDC7.6080902%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] unable to cluster rabbitmq on ec2">tim at rabbitmq.com
       </A><BR>
    <I>Thu Jul 19 11:13:27 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021375.html">[rabbitmq-discuss] unable to cluster rabbitmq on ec2
</A></li>
        <LI>Next message: <A HREF="021379.html">[rabbitmq-discuss] unable to cluster rabbitmq on ec2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21378">[ date ]</a>
              <a href="thread.html#21378">[ thread ]</a>
              <a href="subject.html#21378">[ subject ]</a>
              <a href="author.html#21378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/19/2012 10:18 AM, avinash0601 wrote:
&gt;<i> hey Tim,
</I>
Hi!

&gt;<i> i have 3 instances for clustering on ec2.
</I>&gt;<i> i dont want to use the hostnames provided by amazon so my hostnames now are
</I>&gt;<i> rabbit1, rabbit2&amp;  rabbit3.
</I>
Ok. You've set this up how? What OS are you running, what does the 
/etc/hosts look like?

&gt;<i> i have restricted epmd communication to ports 9100-9105 in
</I>&gt;<i> /usr/lib/erlang/bin/sys.config by making en entry
</I>&gt;<i> *[{kernel,[{inet_dist_listen_min, 9100},{inet_dist_listen_max,9105}]}].*
</I>
Well that doesn't actually control what ports epmd uses, but the ports 
on which the node started with these kernel parameters will accept 
connections from other nodes that are registered with the port mapper 
daemon. The port on which epmd listens is controlled by either passing 
-port &lt;port-num: default=4369&gt; or setting tghe ERL_EPMD_PORT environment 
variable.

&gt;<i> opened ports 5672, 55672, 4369, 9100-9105 on all 3 instances.
</I>
On each machine that will host distributed Erlang nodes, the naming 
server (epmd) must be running. If you wish to inter-connect nodes 
between these machines, their epmd instances must be accessible to the 
outside world (on whatever port(s) they're running on). These (epmd) 
ports have to be open, and the cookie security system ensures that 
unauthorised connections to nodes on the individual hosts are disallowed.

If the port that epmd is running on for each of these instances is not 
open, then clustering will not work, as the nodes will not be able to 
communicate.
&gt;<i> so on rabbit1 i did stop_app, reset&amp;  then trying to create a cluster by
</I>&gt;<i> *rabbitmqctl cluster <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit2</A> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1</A>* its saying
</I>&gt;<i> *Clustering node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit1</A> with [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit2</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at rabbit1</A>] ...
</I>&gt;<i> Error: {no_running_cluster_nodes,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit2</A>],[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit2</A>]}*
</I>&gt;<i> do i need to do something else.
</I>
Check that epmd on each node is accessible from all the others. You can 
do this by attempting to telnet from the other nodes: `telnet rabbit1 
4369` should succeed.

</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021375.html">[rabbitmq-discuss] unable to cluster rabbitmq on ec2
</A></li>
	<LI>Next message: <A HREF="021379.html">[rabbitmq-discuss] unable to cluster rabbitmq on ec2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21378">[ date ]</a>
              <a href="thread.html#21378">[ thread ]</a>
              <a href="subject.html#21378">[ subject ]</a>
              <a href="author.html#21378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
