<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbitmq-server Fails to Start
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq-server%20Fails%20to%20Start&In-Reply-To=%3C71192ea9-31c8-4903-8912-97edc97fc83e%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021021.html">
   <LINK REL="Next"  HREF="021012.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbitmq-server Fails to Start</H1>
    <B>Joel Friedly</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq-server%20Fails%20to%20Start&In-Reply-To=%3C71192ea9-31c8-4903-8912-97edc97fc83e%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Rabbitmq-server Fails to Start">joelfriedly at gmail.com
       </A><BR>
    <I>Tue Jul  3 00:11:46 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021021.html">[rabbitmq-discuss] lost messages (.NET)
</A></li>
        <LI>Next message: <A HREF="021012.html">[rabbitmq-discuss] Rabbitmq-server Fails to Start
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21006">[ date ]</a>
              <a href="thread.html#21006">[ thread ]</a>
              <a href="subject.html#21006">[ subject ]</a>
              <a href="author.html#21006">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i>
</I>&gt;<i> $ sudo service rabbitmq-server start
</I>&gt;<i> Starting rabbitmq-server: FAILED - check /var/log/rabbitmq/startup_{log, 
</I>&gt;<i> _err}
</I>&gt;<i> rabbitmq-server.
</I>
 
The log file shows that everything started properly, and the error file 
only says that rabbitmq-server failed to start:

Activating RabbitMQ plugins ...
&gt;<i> 0 plugins activated:
</I>&gt;<i>
</I>&gt;<i> +---+   +---+
</I>&gt;<i> |   |   |   |
</I>&gt;<i> |   |   |   |
</I>&gt;<i> |   |   |   |
</I>&gt;<i> |   +---+   +-------+
</I>&gt;<i> |                   |
</I>&gt;<i> | RabbitMQ  +---+   |
</I>&gt;<i> |           |   |   |
</I>&gt;<i> |   v2.5.0  +---+   |
</I>&gt;<i> |                   |
</I>&gt;<i> +-------------------+
</I>&gt;<i> AMQP 0-9-1 / 0-9 / 0-8
</I>&gt;<i> Copyright (C) 2007-2011 VMware, Inc.
</I>&gt;<i> Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/">http://www.rabbitmq.com/</A>
</I>&gt;<i> node           : <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>
</I>&gt;<i> app descriptor : 
</I>&gt;<i> /usr/lib/rabbitmq/lib/rabbitmq_server-2.5.0/sbin/../ebin/rabbit.app
</I>&gt;<i> home dir       : /var/lib/rabbitmq
</I>&gt;<i> config file(s) : (none)
</I>&gt;<i> cookie hash    : Eg8kv9KaWD54peNHomznOw==
</I>&gt;<i> log            : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm.log</A>
</I>&gt;<i> sasl log       : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm-sasl.log</A>
</I>&gt;<i> database dir   : /var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>
</I>&gt;<i> erlang version : 5.8.3
</I>&gt;<i> -- rabbit boot start
</I>&gt;<i> starting file handle cache server                                     
</I>&gt;<i> ...done
</I>&gt;<i> starting worker pool                                                 
</I>&gt;<i>  ...done
</I>&gt;<i> starting database                                                     
</I>&gt;<i> ...done
</I>&gt;<i> starting codec correctness check                                     
</I>&gt;<i>  ...done
</I>&gt;<i> -- external infrastructure ready
</I>&gt;<i> starting plugin registry                                             
</I>&gt;<i>  ...done
</I>&gt;<i> starting auth mechanism cr-demo                                       
</I>&gt;<i> ...done
</I>&gt;<i> starting auth mechanism amqplain                                     
</I>&gt;<i>  ...done
</I>&gt;<i> starting auth mechanism plain                                         
</I>&gt;<i> ...done
</I>&gt;<i> starting statistics event manager                                     
</I>&gt;<i> ...done
</I>&gt;<i> starting logging server                                               
</I>&gt;<i> ...done
</I>&gt;<i> starting exchange type direct                                         
</I>&gt;<i> ...done
</I>&gt;<i> starting exchange type fanout                                         
</I>&gt;<i> ...done
</I>&gt;<i> starting exchange type headers                                       
</I>&gt;<i>  ...done
</I>&gt;<i> starting exchange type topic                                         
</I>&gt;<i>  ...done
</I>&gt;<i> -- kernel ready
</I>&gt;<i> starting alarm handler                                               
</I>&gt;<i>  ...done
</I>&gt;<i> starting node monitor                                                 
</I>&gt;<i> ...done
</I>&gt;<i> starting cluster delegate                                             
</I>&gt;<i> ...done
</I>&gt;<i> starting guid generator                                               
</I>&gt;<i> ...done
</I>&gt;<i> starting memory monitor                                               
</I>&gt;<i> ...done
</I>&gt;<i> -- core initialized
</I>&gt;<i> starting empty DB check                                               
</I>&gt;<i> ...done
</I>&gt;<i> starting exchange, queue and binding recovery                         
</I>&gt;<i> ...done
</I>&gt;<i> -- message delivery logic ready
</I>&gt;<i> starting error log relay                                             
</I>&gt;<i>  ...done
</I>&gt;<i> starting networking                                                   
</I>&gt;<i> ...done
</I>&gt;<i> starting direct_client                                               
</I>&gt;<i>  ...done
</I>&gt;<i> starting notify cluster nodes                                         
</I>&gt;<i> ...done
</I>&gt;<i> broker running
</I>

Error file:

Mon Jul  2 15:29:32 PDT 2012 - rabbitmq failed to start


Running `ps aux | grep rabbit` after a failed start shows that the 
processes seem to be running normally though:

$ ps aux | grep rabbit
&gt;<i> rabbitmq 20611  0.0  0.0   6808   324 ?        S    15:02   0:01 
</I>&gt;<i> /usr/lib/erlang/erts-5.8.3/bin/epmd -daemon
</I>&gt;<i> root     22617  0.0  0.0   4272   580 ?        Ss   15:29   0:00 /bin/sh 
</I>&gt;<i> /usr/sbin/rabbitmq-server
</I>&gt;<i> rabbitmq 22626  0.0  0.0  44804  1388 ?        S    15:29   0:00 su 
</I>&gt;<i> rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmq-server 
</I>&gt;<i> rabbitmq 22627  0.0  0.0   4272   584 ?        S    15:29   0:00 sh -c 
</I>&gt;<i> /usr/lib/rabbitmq/bin/rabbitmq-server 
</I>&gt;<i> rabbitmq 22628  0.9  1.2  97360 26564 ?        Sl   15:29   0:07 
</I>&gt;<i> /usr/lib/erlang/erts-5.8.3/bin/beam.smp -W w -K true -A30 -P 1048576 -- 
</I>&gt;<i> -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -noshell 
</I>&gt;<i> -noinput -sname <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A> -boot 
</I>&gt;<i> /var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm-plugins-expand</A>/rabbit -kernel 
</I>&gt;<i> inet_default_connect_options [{nodelay,true}] -sasl errlog_type error 
</I>&gt;<i> -kernel error_logger {file,&quot;/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm.log</A>&quot;} -sasl 
</I>&gt;<i> sasl_error_logger {file,&quot;/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm-sasl.log</A>&quot;} 
</I>&gt;<i> -os_mon start_cpu_sup true -os_mon start_disksup false -os_mon start_memsup 
</I>&gt;<i> false -mnesia dir &quot;/var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>&quot;
</I>&gt;<i> rabbitmq 22724  0.0  0.0   4164   324 ?        Ss   15:29   0:00 
</I>&gt;<i> /usr/lib/erlang/lib/os_mon-2.2.5/priv/bin/cpu_sup
</I>&gt;<i> rabbitmq 22725  0.0  0.0   6776   344 ?        Ss   15:29   0:00 
</I>&gt;<i> inet_gethost 4
</I>&gt;<i> rabbitmq 22726  0.0  0.0   8876   636 ?        S    15:29   0:00 
</I>&gt;<i> inet_gethost 4
</I>&gt;<i> joel     22805  0.0  0.0   9252   872 pts/0    R+   15:42   0:00 grep 
</I>&gt;<i> rabbit
</I>

(My user is 'joel'.)

Running a `rabbitmqctl status` at this point shows that the broker is 
running:

$ sudo rabbitmqctl status
&gt;<i> Status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>' ...
</I>&gt;<i> [{pid,22628},
</I>&gt;<i>  {running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;2.5.0&quot;},
</I>&gt;<i>                         {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.5&quot;},
</I>&gt;<i>                         {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.9.3&quot;},
</I>&gt;<i>                         {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.17&quot;},
</I>&gt;<i>                         {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.3&quot;},
</I>&gt;<i>                         {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.3&quot;}]},
</I>&gt;<i>  {os,{unix,linux}},
</I>&gt;<i>  {erlang_version,&quot;Erlang R14B02 (erts-5.8.3) [source] [64-bit] [smp:3:3] 
</I>&gt;<i> [rq:3] [async-threads:30] [kernel-poll:true]\n&quot;},
</I>&gt;<i>  {memory,[{total,24305496},
</I>&gt;<i>           {processes,9824640},
</I>&gt;<i>           {processes_used,9821704},
</I>&gt;<i>           {system,14480856},
</I>&gt;<i>           {atom,1108281},
</I>&gt;<i>           {atom_used,1096596},
</I>&gt;<i>           {binary,6944},
</I>&gt;<i>           {code,10828669},
</I>&gt;<i>           {ets,692904}]}]
</I>&gt;<i> ...done.
</I>

At this point, attempting a `sudo service rabbitmq-server restart` fails, 
with the same error message as starting the server.
Stopping the server via any of service rabbitmq-server stop, rabbitmqctl 
stop, or rabbitmqctl stop_app works fine, and I can reset nodes as 
expected, but starting the server always reports failure.

For reference, here's the output from `sudo service rabbitmqctl report`:

$ sudo rabbitmqctl report
&gt;<i> Reporting server status on {{2012,7,2},{22,53,37}}
</I>&gt;<i> Status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>' ...
</I>&gt;<i> [{pid,23209},
</I>&gt;<i>  {running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;2.5.0&quot;},
</I>&gt;<i>                         {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.5&quot;},
</I>&gt;<i>                         {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.9.3&quot;},
</I>&gt;<i>                         {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.17&quot;},
</I>&gt;<i>                         {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.3&quot;},
</I>&gt;<i>                         {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.3&quot;}]},
</I>&gt;<i>  {os,{unix,linux}},
</I>&gt;<i>  {erlang_version,&quot;Erlang R14B02 (erts-5.8.3) [source] [64-bit] [smp:3:3] 
</I>&gt;<i> [rq:3] [async-threads:30] [kernel-poll:true]\n&quot;},
</I>&gt;<i>  {memory,[{total,24464720},
</I>&gt;<i>           {processes,9917040},
</I>&gt;<i>           {processes_used,9914104},
</I>&gt;<i>           {system,14547680},
</I>&gt;<i>           {atom,1108281},
</I>&gt;<i>           {atom_used,1096530},
</I>&gt;<i>           {binary,72472},
</I>&gt;<i>           {code,10828669},
</I>&gt;<i>           {ets,692760}]}]
</I>&gt;<i> Cluster status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>' ...
</I>&gt;<i>
</I>&gt;<i> [{nodes,[{disc,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>']}]},{running_nodes,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>']}]
</I>&gt;<i> Application environment of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ubuntu-vm</A>' ...
</I>&gt;<i> [{auth_backends,[rabbit_auth_backend_internal]},
</I>&gt;<i>  {auth_mechanisms,['PLAIN','AMQPLAIN']},
</I>&gt;<i>  {backing_queue_module,rabbit_variable_queue},
</I>&gt;<i>  {cluster_nodes,[]},
</I>&gt;<i>  {collect_statistics,none},
</I>&gt;<i>  {default_permissions,[&lt;&lt;&quot;.*&quot;&gt;&gt;,&lt;&lt;&quot;.*&quot;&gt;&gt;,&lt;&lt;&quot;.*&quot;&gt;&gt;]},
</I>&gt;<i>  {delegate_count,16},
</I>&gt;<i>  {frame_max,131072},
</I>&gt;<i>  {included_applications,[]},
</I>&gt;<i>  {msg_store_file_size_limit,16777216},
</I>&gt;<i>  {msg_store_index_module,rabbit_msg_store_ets_index},
</I>&gt;<i>  {persister_hibernate_after,10000},
</I>&gt;<i>  {persister_max_wrap_entries,500},
</I>&gt;<i>  {queue_index_max_journal_entries,262144},
</I>&gt;<i>  {server_properties,[]},
</I>&gt;<i>  {ssl_listeners,[]},
</I>&gt;<i>  {ssl_options,[]},
</I>&gt;<i>  {tcp_listen_options,[binary,
</I>&gt;<i>                       {packet,raw},
</I>&gt;<i>                       {reuseaddr,true},
</I>&gt;<i>                       {backlog,128},
</I>&gt;<i>                       {nodelay,true},
</I>&gt;<i>                       {exit_on_close,false}]},
</I>&gt;<i>  {tcp_listeners,[5672]},
</I>&gt;<i>  {trace_vhosts,[]},
</I>&gt;<i>  {vm_memory_high_watermark,0.4}]
</I>&gt;<i> Connections:
</I>&gt;<i> Channels:
</I>&gt;<i> Queues on /:
</I>&gt;<i> Exchanges on /:
</I>&gt;<i> name type durable auto_delete internal arguments
</I>&gt;<i> amq.direct direct true false false []
</I>&gt;<i> amq.topic topic true false false []
</I>&gt;<i> amq.rabbitmq.trace topic true false false []
</I>&gt;<i> amq.rabbitmq.log topic true false false []
</I>&gt;<i> amq.fanout fanout true false false []
</I>&gt;<i> amq.headers headers true false false []
</I>&gt;<i> direct true false false []
</I>&gt;<i> amq.match headers true false false []
</I>&gt;<i> Bindings on /:
</I>&gt;<i> Consumers on /:
</I>&gt;<i> Permissions on /:
</I>&gt;<i> user configure write read
</I>&gt;<i> guest .* .* .*
</I>&gt;<i> End of server status report
</I>&gt;<i> ...done.
</I>

-----------------------------------

This problem started pretty randomly.  I've been using rabbitmq for quite a 
while but running my test suite failed today and I can't think of anything 
different that I've done.  
I've also attempted rebooting and purging/reinstalling.  This is all 
running on an Ubuntu VM, which could potentially cause problems, but 
shouldn't.  If you guys don't have any suggestions, I guess my next step 
will be to try reinstalling the VM.


Thanks for any help,
Joel Friedly
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120702/8c7c39ba/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120702/8c7c39ba/attachment.htm</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021021.html">[rabbitmq-discuss] lost messages (.NET)
</A></li>
	<LI>Next message: <A HREF="021012.html">[rabbitmq-discuss] Rabbitmq-server Fails to Start
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21006">[ date ]</a>
              <a href="thread.html#21006">[ thread ]</a>
              <a href="subject.html#21006">[ subject ]</a>
              <a href="author.html#21006">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
