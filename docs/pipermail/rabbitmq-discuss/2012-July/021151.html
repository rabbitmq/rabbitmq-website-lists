<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Some bugs in management plugin and HA
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Some%20bugs%20in%20management%20plugin%20and%20HA&In-Reply-To=%3CCAHFJS_Vb0tO2Yz8JKfa6aXj%2BRQt%3Dfobbzfe9C6sDjHe-LMBoGA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021146.html">
   <LINK REL="Next"  HREF="021219.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Some bugs in management plugin and HA</H1>
    <B>Micha&#322; Ki&#281;dy&#347;</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Some%20bugs%20in%20management%20plugin%20and%20HA&In-Reply-To=%3CCAHFJS_Vb0tO2Yz8JKfa6aXj%2BRQt%3Dfobbzfe9C6sDjHe-LMBoGA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Some bugs in management plugin and HA">michal at kiedys.net
       </A><BR>
    <I>Tue Jul 10 14:29:55 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021146.html">[rabbitmq-discuss] How Reopen a closed connection?
</A></li>
        <LI>Next message: <A HREF="021219.html">[rabbitmq-discuss] Some bugs in management plugin and HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21151">[ date ]</a>
              <a href="thread.html#21151">[ thread ]</a>
              <a href="subject.html#21151">[ subject ]</a>
              <a href="author.html#21151">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I found some bugs in management plugin and HA:

Configuration:
Cluster with 4 nodes:
arch-task-mq-1 (disk), arch-task-mq-2 (ram), arch-task-mq-3
(disk), arch-task-mq-4 (ram)
Version 2.8.4
Erlang R14A

1.
On node arch-task-mq-3 I execute iptables commands:

iptables -A INPUT -s arch-task-mq-1 -j DROP
iptables -A OUTPUT -p tcp -d arch-task-mq-1 -j DROP

Node mq-1 tells that mq-3 is not running, node mq-3 tells that mq-1 is not
running.
Other nodes raport that every node is running.

After 5 minutes I execute:

iptables -F

After a while the mq-3 returns to normal operation, but nothing change in
state displayed on Overview -&gt; Nodes view on mq-1 and mq-3.
Node mq-3 is still raporting that mq-1 is not running and vice versa.
Information in mq-1 about state of mq-3 changes after mq-3 restart - not
before.

2.
After spliting servers using method described above Im trying to remove
queue &quot;test&quot; which resides only on mq-3 (HA is not used).
I push &quot;Delete&quot; button on &quot;Queues&quot; and after doing that I back to &quot;Queues&quot;
tab. But queue &quot;test&quot; is still there.
After clicking to queue &quot;test&quot; I see:

Ready*undefined*
Unacknowledged*undefined*
Total*undefined*







If I try to delete queue &quot;test&quot; again, server reports that queue not exists.
Screenshot: ss1.png

3.
After spliting servers using method described above and restoring
connection to mq-1 in mq-3, node mq-1 is reporting internal server errors
on &quot;Connections&quot; tab. Errors occurs periodically.
Screenshort: ss2.png

4.
After spliting servers using method described in 1. and restoring
connection to mq-1 from mq-3 Im not able to create HA queue.
I go to mq-3 and create HA queue named &quot;test&quot;. Node mq-1 see that queue,
but is not synchronized.
Screenshots: ss2.png, ss3.png
MQ-1 is not able to deliver messages to that queue. Other nodes do it
without problems.
Restarting mq-3 causes the queue .. disappear. Even if there were
undelivered messages.


Regards,
MK
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ss1.png
Type: image/png
Size: 28506 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ss2.png
Type: image/png
Size: 111077 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment-0001.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment-0001.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ss3.png
Type: image/png
Size: 42796 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment-0002.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment-0002.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ss4.png
Type: image/png
Size: 41259 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment-0003.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120710/3da336df/attachment-0003.png</A>&gt;
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021146.html">[rabbitmq-discuss] How Reopen a closed connection?
</A></li>
	<LI>Next message: <A HREF="021219.html">[rabbitmq-discuss] Some bugs in management plugin and HA
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21151">[ date ]</a>
              <a href="thread.html#21151">[ thread ]</a>
              <a href="subject.html#21151">[ subject ]</a>
              <a href="author.html#21151">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
