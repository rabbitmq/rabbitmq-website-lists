<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20subscriber%20loses%20connection%20across%0A%20firewalls%20after%20long%20idle&In-Reply-To=%3C1341221640243-20487.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020953.html">
   <LINK REL="Next"  HREF="020958.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle</H1>
    <B>Deelo55</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20subscriber%20loses%20connection%20across%0A%20firewalls%20after%20long%20idle&In-Reply-To=%3C1341221640243-20487.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle">dwayne.dsouza at gmail.com
       </A><BR>
    <I>Mon Jul  2 10:34:00 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020953.html">[rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle
</A></li>
        <LI>Next message: <A HREF="020958.html">[rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20955">[ date ]</a>
              <a href="thread.html#20955">[ thread ]</a>
              <a href="subject.html#20955">[ subject ]</a>
              <a href="author.html#20955">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
My test class starts the subscriber...waits 5 minutes than publishes a
message. When I run it locally it works fine...when I run across firewall it
fails.
The hearbeat doesn't help here and when I check on the server it still has
the connection up and running.


public class TimeoutTest {
	private static final Logger log =
LoggerFactory.getLogger(TimeoutTest.class);
	public static void main(String[] args) throws Exception{
		final RabbitMqPublisher&lt;String&gt; publisher=new
RabbitMqPublisher&lt;String&gt;(&quot;xxx.xxx.xxx.xxx&quot;,&quot;EXCHANGE&quot;,&quot;TEST&quot;);
		final RabbitMqSubscriber&lt;String&gt; subscriber=new
RabbitMqSubscriber&lt;String&gt;(&quot;xxx.xxx.xxx.xxx&quot;,&quot;EXCHANGE&quot;, &quot;TEST&quot;);
		subscriber.setListener(new MessageListener&lt;String&gt;() {
			
			@Override
			public void receive(String s) {
				System.out.println(&quot;SUCCESSFUL!!!&quot;); //NEVER GETS CALLED!!!
				
			}
		});
		Executors.newSingleThreadExecutor().execute(new Runnable() {
			public void run() {
				try{
				subscriber.run();
				}catch(Exception e){
					e.printStackTrace();
				}
			}
		});
		
		//start subscriber then wait &gt;5 minutes before publishing first message 
		int timeout=1000*401;
		System.out.println(&quot;timeout=&quot;+timeout);
		Thread.sleep(timeout);
		
		publisher.publish(&quot;MESSAGE PUBLISHED&quot;);
		
	}
	
}

--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/RabbitMQ-subscriber-loses-connection-across-firewalls-after-long-idle-tp20480p20487.html">http://rabbitmq.1065348.n5.nabble.com/RabbitMQ-subscriber-loses-connection-across-firewalls-after-long-idle-tp20480p20487.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020953.html">[rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle
</A></li>
	<LI>Next message: <A HREF="020958.html">[rabbitmq-discuss] RabbitMQ subscriber loses connection across firewalls after long idle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20955">[ date ]</a>
              <a href="thread.html#20955">[ thread ]</a>
              <a href="subject.html#20955">[ subject ]</a>
              <a href="author.html#20955">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
