<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Simple Sender and Receiver in java
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%0A%09%3D%3Futf-8%3Fq%3FSimple_Sender_and_Receiver_in_java%3F%3D&In-Reply-To=%3C201207230937007151504%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021456.html">
   <LINK REL="Next"  HREF="021467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Simple Sender and Receiver in java</H1>
    <B>Zhihui Jiao</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%0A%09%3D%3Futf-8%3Fq%3FSimple_Sender_and_Receiver_in_java%3F%3D&In-Reply-To=%3C201207230937007151504%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Simple Sender and Receiver in java">jzhihui521 at gmail.com
       </A><BR>
    <I>Mon Jul 23 02:37:02 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021456.html">[rabbitmq-discuss] Simple Sender and Receiver in java
</A></li>
        <LI>Next message: <A HREF="021467.html">[rabbitmq-discuss] pile up messages on queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21454">[ date ]</a>
              <a href="thread.html#21454">[ thread ]</a>
              <a href="subject.html#21454">[ subject ]</a>
              <a href="author.html#21454">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> channel.basicConsume(QUEUE_NAME, true, consumer);

The second parameter says that autoAck=true, that means the server consider
the message as acked when it send it out to the cosumer.

 In your test scenario, rabbit will send all the two message to your consumer, but
you only consume one, the other are simple lost(or discarded) because of the 
temination of your consumer.  

------------------				 
Zhihui Jiao
2012-07-23

-------------------------------------------------------------
On 2012-07-23 Praveena Kumara &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">praveena at cumulations.com</A>&gt; wrote:

&gt;<i>hi 
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>  I am trying to understand the RabitMq server with a sender and a receiver 
</I>&gt;<i>program. Now the entire setup works well when the sender sends a single 
</I>&gt;<i>message and the same would be received by the receiver.
</I>&gt;<i>
</I>&gt;<i>however when i send two messages( by running sender twice) and run the 
</I>&gt;<i>receiver program twice i get only the first message. 
</I>&gt;<i>
</I>&gt;<i>Sender
</I>&gt;<i>
</I>&gt;<i>  ConnectionFactory factory = new ConnectionFactory();
</I>&gt;<i>        factory.setHost(&quot;localhost&quot;);
</I>&gt;<i>        Connection connection = factory.newConnection();
</I>&gt;<i>        Channel channel = connection.createChannel();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        channel.queueDeclare(QUEUE_NAME, true, false, false, null);
</I>&gt;<i>        String message = &quot;He12!&quot;;
</I>&gt;<i>        channel.basicPublish(&quot;&quot;, QUEUE_NAME, null, message.getBytes());
</I>&gt;<i>        System.out.println(&quot;Sent &quot;+message);
</I>&gt;<i>        channel.close();
</I>&gt;<i>        connection.close();
</I>&gt;<i>
</I>&gt;<i>Receiver
</I>&gt;<i>
</I>&gt;<i>    ConnectionFactory factory = new ConnectionFactory();
</I>&gt;<i>    factory.setHost(&quot;localhost&quot;);
</I>&gt;<i>    Connection connection = factory.newConnection();
</I>&gt;<i>    Channel channel = connection.createChannel();
</I>&gt;<i>
</I>&gt;<i>    channel.queueDeclare(QUEUE_NAME, true, false, false, null);
</I>&gt;<i>
</I>&gt;<i>    QueueingConsumer consumer = new QueueingConsumer(channel);
</I>&gt;<i>    channel.basicConsume(QUEUE_NAME, true, consumer);
</I>&gt;<i>    QueueingConsumer.Delivery delivery = consumer.nextDelivery();
</I>&gt;<i>   
</I>&gt;<i>
</I>&gt;<i>    String message;
</I>&gt;<i>     if (delivery != null) {
</I>&gt;<i>        message = new String(delivery.getBody());
</I>&gt;<i>        System.out.println(&quot;Reciever ..&quot;+message);
</I>&gt;<i>
</I>&gt;<i>    }
</I>&gt;<i>
</I>&gt;<i>    channel.close();
</I>&gt;<i>    connection.close();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I dont have a  infinite while loop in the receiver code (as shown in the 
</I>&gt;<i>getting started page in the rabbitMq site ) because i want to expose  this 
</I>&gt;<i>receiver as a web service sending one message at a time.
</I>&gt;<i>
</I>&gt;<i>I also noticed by executing the commond rabbitMqctl list_queues that the 
</I>&gt;<i>entire queue contents become zero as and when the control reaches 
</I>&gt;<i>
</I>&gt;<i>    channel.basicConsume(QUEUE_NAME, true, consumer);
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Kindly let me know if i am missing something.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>rabbitmq-discuss mailing list
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021456.html">[rabbitmq-discuss] Simple Sender and Receiver in java
</A></li>
	<LI>Next message: <A HREF="021467.html">[rabbitmq-discuss] pile up messages on queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21454">[ date ]</a>
              <a href="thread.html#21454">[ thread ]</a>
              <a href="subject.html#21454">[ subject ]</a>
              <a href="author.html#21454">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
