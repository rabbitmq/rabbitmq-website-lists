<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Security Exception in IIS using RabbitMQ Client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Security%20Exception%20in%20IIS%20using%20RabbitMQ%20Client&In-Reply-To=%3C1bf0da2d77a8dde3045f42fbb98de912%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021424.html">
   <LINK REL="Next"  HREF="021429.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Security Exception in IIS using RabbitMQ Client</H1>
    <B>Dave Seltzer</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Security%20Exception%20in%20IIS%20using%20RabbitMQ%20Client&In-Reply-To=%3C1bf0da2d77a8dde3045f42fbb98de912%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Security Exception in IIS using RabbitMQ Client">dseltzer at tveyes.com
       </A><BR>
    <I>Fri Jul 20 19:06:55 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021424.html">[rabbitmq-discuss] Frequent crashes on one cluster node but not the other
</A></li>
        <LI>Next message: <A HREF="021429.html">[rabbitmq-discuss] Security Exception in IIS using RabbitMQ	Client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21428">[ date ]</a>
              <a href="thread.html#21428">[ thread ]</a>
              <a href="subject.html#21428">[ subject ]</a>
              <a href="author.html#21428">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm having a bit of trouble using the .NET RabbitMQ client in IIS, maybe
someone knows what I'm running into.

Here's the code I'm trying to run:

    ConnectionFactory rabbitConFactory = new ConnectionFactory();
    rabbitConFactory.Address = &quot;hostname&quot;;
    rabbitConFactory.VirtualHost = &quot;/path&quot;;
    rabbitConFactory.UserName = &quot;user&quot;;
    rabbitConFactory.Password = &quot;password&quot;;

    IConnection connection = rabbitConFactory.CreateConnection();

    IModel channel = connection.CreateModel();

    Dictionary&lt;String, Object&gt; args = new Dictionary&lt;string, object&gt;();
    args.Add(&quot;x-ha-policy&quot;, &quot;all&quot;);
    String ExchangeName = &quot;SearchInstructions&quot;;
    channel.ExchangeDeclare(ExchangeName, &quot;topic&quot;, true, false, args);

    Guid myId = new Guid();
    String RoutingKey = myId.ToString() + &quot;.Instruction&quot;;
    IBasicProperties MessageProperties = channel.CreateBasicProperties();
    MessageProperties.SetPersistent(true);
    MessageProperties.ContentEncoding = &quot;UTF-8&quot;;
    MessageProperties.ContentType = &quot;text/xml&quot;;
    MessageProperties.Headers.Add(&quot;x-origin&quot;,
Request.ServerVariables[&quot;ServerName&quot;]);

    String messageContent = &quot;&lt;foo /&gt;&quot;;
    byte[] data = System.Text.Encoding.UTF8.GetBytes(messageContent);
    channel.BasicPublish(ExchangeName,RoutingKey, MessageProperties,
data);

    channel.Close();
    connection.Close();

When I run the code in an ASPX page I receive the following Security
Exception:
    Security Exception

    Description: The application attempted to perform an operation not
allowed by the security policy.  To grant this application the required
permission please contact your system administrator or change the
application's trust level in the configuration file.

    Exception Details: System.Security.SecurityException: Request for the
permission of type 'System.Security.Permissions.FileIOPermission,
mscorlib, Version=2.0.0.0, Culture=neutral,
PublicKeyToken=b77a5c561934e089' failed.

I'm not really sure how to proceed. This sounds like an IIS issue, but
someone here must have tackled this problem before.

Thanks much!

-Dave
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021424.html">[rabbitmq-discuss] Frequent crashes on one cluster node but not the other
</A></li>
	<LI>Next message: <A HREF="021429.html">[rabbitmq-discuss] Security Exception in IIS using RabbitMQ	Client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21428">[ date ]</a>
              <a href="thread.html#21428">[ thread ]</a>
              <a href="subject.html#21428">[ subject ]</a>
              <a href="author.html#21428">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
