<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] AMQP heartbeat - Expected behaviors
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AMQP%20heartbeat%20-%20Expected%20behaviors&In-Reply-To=%3CCACLE7iz0UDBJhaAUVbrwAvjzYHbkoRaB8nm02iY1%2BkMiR%3Dq%3DkA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021048.html">
   <LINK REL="Next"  HREF="021038.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] AMQP heartbeat - Expected behaviors</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AMQP%20heartbeat%20-%20Expected%20behaviors&In-Reply-To=%3CCACLE7iz0UDBJhaAUVbrwAvjzYHbkoRaB8nm02iY1%2BkMiR%3Dq%3DkA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] AMQP heartbeat - Expected behaviors">mpietrek at skytap.com
       </A><BR>
    <I>Tue Jul  3 20:17:01 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021048.html">[rabbitmq-discuss] STOMP plug-in, HA queues,	and consumer cancelations
</A></li>
        <LI>Next message: <A HREF="021038.html">[rabbitmq-discuss] AMQP heartbeat - Expected behaviors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21037">[ date ]</a>
              <a href="thread.html#21037">[ thread ]</a>
              <a href="subject.html#21037">[ subject ]</a>
              <a href="author.html#21037">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We've recently started using the heartbeat connection option, and I need to
understand them precisely. I understand that both client and server side
can send heartbeat frames, that other activity can substitute for a
heartbeat frame, and that the intervals are negotiated during tuning.

What's confusing me is this:  Some threads such at this one imply that the
server &quot;periodically sends heartbeat frames to the client and waits for its
response.&quot;
<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-August/014491.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-August/014491.html</A>

What exactly is the proper response from the client? I've searched for
hours looking for the format of the response and not found it.

Confounding matters, at least three client libraries I've looked at
(including Pika and .NET) explicitly check for heartbeat frame (i.e., 8)
and then do nothing with them. For instance in the Pika _on_data_available
method():

       while self._frame_buffer:

           # Try and build a frame
           consumed_count, frame =
pika.frame.decode_frame(self._frame_buffer)

           ...

           # We don't check for heartbeat frames because we can not count
           # atomic frames reliably due to different message behaviors
           # such as large content frames being transferred slowly
           elif isinstance(frame, pika.frame.Heartbeat):
               continue


Is this correct behavior or am I simply not understanding how the heartbeat
mechanism is supposed to work.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120703/0440e97e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120703/0440e97e/attachment.htm</A>&gt;
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021048.html">[rabbitmq-discuss] STOMP plug-in, HA queues,	and consumer cancelations
</A></li>
	<LI>Next message: <A HREF="021038.html">[rabbitmq-discuss] AMQP heartbeat - Expected behaviors
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21037">[ date ]</a>
              <a href="thread.html#21037">[ thread ]</a>
              <a href="subject.html#21037">[ subject ]</a>
              <a href="author.html#21037">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
