<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Exchange with throttling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange%20with%20throttling&In-Reply-To=%3C50165355.6010800%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021572.html">
   <LINK REL="Next"  HREF="021587.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Exchange with throttling</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange%20with%20throttling&In-Reply-To=%3C50165355.6010800%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Exchange with throttling">tim at rabbitmq.com
       </A><BR>
    <I>Mon Jul 30 10:26:45 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021572.html">[rabbitmq-discuss] Exchange with throttling
</A></li>
        <LI>Next message: <A HREF="021587.html">[rabbitmq-discuss] Exchange with throttling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21586">[ date ]</a>
              <a href="thread.html#21586">[ thread ]</a>
              <a href="subject.html#21586">[ subject ]</a>
              <a href="author.html#21586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Just to add to Emile's comments, I there are a couple of things to 
consider here.

Firstly, it's important to point out that letting the Channel process 
mailbox fill up could lead to unexpected and unpredictable performance 
characteristics, and doesn't appear to offer anything that 
per-connection flow control isn't already doing. Also, creating an 
mnesia transaction for each routing operation is likely to produce an 
altogether *different* kind of throttling of Rabbit's performance across 
a cluster, and probably (in fact, almost certainly) not the one you 
intended.

I would strongly recommend reconsidering this approach. If you're 
interested in extending the flow control mechanism to support 
alternative measures, then perhaps we should have a collective 
conversation about that instead, as Emile is quite right in suggesting 
that approach makes more sense.

Cheers,
Tim

On 07/28/2012 11:52 AM, F&#233;lix L&#243;pez wrote:
&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> I've finally made a plugin to do that. I think what I wanted to do It 
</I>&gt;<i> cannot be possible with mechanism you sent me in the email.
</I>&gt;<i>
</I>&gt;<i> The plugin is here 
</I>&gt;<i> <A HREF="https://github.com/flopezluis/rabbitmq-throttling-exchange,">https://github.com/flopezluis/rabbitmq-throttling-exchange,</A> It has a 
</I>&gt;<i> lot to improve and certainly I'm not sure of the impact of this 
</I>&gt;<i> exchange in the performance of rabbitmq.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2012/7/24 Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt;&gt;
</I>&gt;<i>
</I>&gt;<i>     Hi,
</I>&gt;<i>
</I>&gt;<i>     On 23/07/12 18:20, F&#233;lix wrote:
</I>&gt;<i>     &gt; Is there anything similar in rabbitmq?
</I>&gt;<i>
</I>&gt;<i>     Yes, the broker has a connection-based flow control mechanism - see
</I>&gt;<i>     <A HREF="http://www.rabbitmq.com/memory.html#per-connection">http://www.rabbitmq.com/memory.html#per-connection</A>
</I>&gt;<i>     and a blog post that explains further:
</I>&gt;<i>     <A HREF="http://www.rabbitmq.com/blog/2012/04/17/rabbitmq-performance-measurements-part-1/">http://www.rabbitmq.com/blog/2012/04/17/rabbitmq-performance-measurements-part-1/</A>
</I>&gt;<i>
</I>&gt;<i>     Bear in mind that blocking an Erlang process will lead to a backlog in
</I>&gt;<i>     its internal mailbox without slowing down the network. Also, the
</I>&gt;<i>     exchange is not a natural control point for bandwidth limiting,
</I>&gt;<i>     because
</I>&gt;<i>     an exchange is not a process. A channel would be a more natural
</I>&gt;<i>     choice.
</I>&gt;<i>     You may be able to adapt the existing flow control mechanism to grant
</I>&gt;<i>     credits based on bandwidth rather than message count.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     -Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> <A HREF="http://www.linkedin.com/in/flopezluis">http://www.linkedin.com/in/flopezluis</A>
</I>&gt;<i>
</I>&gt;<i> It's easier to ask forgiveness than it is to get permission
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &quot;.....it doesn't matter how many times you fail. It doesn't matter how 
</I>&gt;<i> many times you almost get it right. No one is going to know or care 
</I>&gt;<i> about your failures, and either should you. All you have to do is 
</I>&gt;<i> learn from them and those around you because...All that matters in 
</I>&gt;<i> business is that you get it right once. Then everyone can tell you how 
</I>&gt;<i> lucky you are.&quot;
</I>&gt;<i> --Mark Cuban&quot;
</I>&gt;<i>
</I>&gt;<i> &quot;Always be the worst guy in every band you're in.&quot; If you're the best 
</I>&gt;<i> guy there, you need to be in a different band. And I think that works 
</I>&gt;<i> for almost everything that's out there as well.&quot; Pat Metheny
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120730/675fc544/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120730/675fc544/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021572.html">[rabbitmq-discuss] Exchange with throttling
</A></li>
	<LI>Next message: <A HREF="021587.html">[rabbitmq-discuss] Exchange with throttling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21586">[ date ]</a>
              <a href="thread.html#21586">[ thread ]</a>
              <a href="subject.html#21586">[ subject ]</a>
              <a href="author.html#21586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
