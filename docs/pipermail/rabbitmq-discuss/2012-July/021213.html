<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Handle Stale Connections on Clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Handle%20Stale%20Connections%20on%20Clients&In-Reply-To=%3C4FFEC4A0.1010107%40vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021195.html">
   <LINK REL="Next"  HREF="021231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Handle Stale Connections on Clients</H1>
    <B>Gary Russell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Handle%20Stale%20Connections%20on%20Clients&In-Reply-To=%3C4FFEC4A0.1010107%40vmware.com%3E"
       TITLE="[rabbitmq-discuss] Handle Stale Connections on Clients">grussell at vmware.com
       </A><BR>
    <I>Thu Jul 12 13:35:44 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021195.html">[rabbitmq-discuss] Handle Stale Connections on Clients
</A></li>
        <LI>Next message: <A HREF="021231.html">[rabbitmq-discuss] Handle Stale Connections on Clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21213">[ date ]</a>
              <a href="thread.html#21213">[ thread ]</a>
              <a href="subject.html#21213">[ subject ]</a>
              <a href="author.html#21213">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry for the delay.

The current spring-amqp (1.1.1) now supports a 'fixed' reply queue for request/reply scenarios.

See

<A HREF="http://static.springsource.org/spring-amqp/docs/1.1.1.RELEASE/reference/html/#request-reply">http://static.springsource.org/spring-amqp/docs/1.1.1.RELEASE/reference/html/#request-reply</A>

We added this specifically for the performance impact you cite.

Gary


On 07/11/2012 05:38 PM, cogitate wrote:

Thanks Gary!
i also use spring-amqp and amqp inbound listener in spring-integration.
however, my issue is with reply-queue implementation of spring-amqp. i need
pre-made reply-queues that can be re-used (setup by configuration) even for
RPC semantics. i believe spring-amqp for RPC uses anonymous reply-queues and
also does consumer.cancel(benchmarks showed a 5ms delay for this on 24 core
cpu with broker and client running on the same box), which turns out to have
performance impact. thus, this rules out use of RabbitTemplate ( i wish it
had a way to use pre-made reply-queues that could be re-used).

thus, my wrappers around raw rabbitmq apis and even if i use
CachingConnectionFactory, i'd need to register a callback listener to
re-register my channels and reply-queues.

will definitely look at RabbitAdmin to learn how to do this.

thanks and regards,
-monish


Gary Russell wrote



See
<A HREF="http://static.springsource.org/spring-amqp/docs/1.1.1.RELEASE/reference/html/#d0e999">http://static.springsource.org/spring-amqp/docs/1.1.1.RELEASE/reference/html/#d0e999</A>

It shouldn't take much heavy lifting to use spring-amqp instead of the raw
apis, and it will take care of reconnecting, setting up queues etc, via
the ConnectionListener callback in the RabbitAdmin class.

On the receiving side, you don't have to write any special listeners etc
to use spring-amqp; you can just write your code as a POJO and the
container uses an adapter to call your code. On the outbound side just use
a RabbitTemplate; in most cases you can use high-level APIs, while still
having access to the low level APIs (channel) if you ever need them.

If you can't move to spring-amqp, you might be able to leverage some of
the code from RabbitAdmin.

Gary





--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Handle-Stale-Connections-on-Clients-tp20687p20725.html">http://rabbitmq.1065348.n5.nabble.com/Handle-Stale-Connections-on-Clients-tp20687p20725.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>




-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120712/1e097e75/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120712/1e097e75/attachment.htm</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021195.html">[rabbitmq-discuss] Handle Stale Connections on Clients
</A></li>
	<LI>Next message: <A HREF="021231.html">[rabbitmq-discuss] Handle Stale Connections on Clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21213">[ date ]</a>
              <a href="thread.html#21213">[ thread ]</a>
              <a href="subject.html#21213">[ subject ]</a>
              <a href="author.html#21213">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
