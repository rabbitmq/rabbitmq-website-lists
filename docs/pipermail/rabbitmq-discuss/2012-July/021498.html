<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Occasional slow message on a local machine
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Occasional%20slow%20message%20on%20a%20local%20machine&In-Reply-To=%3C878ve9ijm5.wl%25francesco%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021484.html">
   <LINK REL="Next"  HREF="021485.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Occasional slow message on a local machine</H1>
    <B>Francesco Mazzoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Occasional%20slow%20message%20on%20a%20local%20machine&In-Reply-To=%3C878ve9ijm5.wl%25francesco%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Occasional slow message on a local machine">francesco at rabbitmq.com
       </A><BR>
    <I>Tue Jul 24 10:38:58 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021484.html">[rabbitmq-discuss] Occasional slow message on a local machine
</A></li>
        <LI>Next message: <A HREF="021485.html">[rabbitmq-discuss] Publisher Confirms retries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21498">[ date ]</a>
              <a href="thread.html#21498">[ thread ]</a>
              <a href="subject.html#21498">[ subject ]</a>
              <a href="author.html#21498">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Brennan,
At Mon, 23 Jul 2012 15:57:24 -0400,
Brennan Sellner wrote:
&gt;<i> The rabbitmq server (v2.8.2) is running on the same machine, so there aren't
</I>&gt;<i> any external networks involved.  We're still running Fedora 11 (kernel 2.6.29,
</I>&gt;<i> Erlang R12B-5.8) for the moment, if that's relevant.
</I>
Please upgrade both RabbitMQ and Erlang if you can (especially rabbit), or
things will be hard to diagnose for us.

&gt;<i> Time 0.90: The consumer receives and responds to an AMQP heartbeat from 
</I>&gt;<i> the server, and acks the delivery of a prior message.  It again drops 
</I>&gt;<i> into an amqp_simple_wait_frame.
</I>
That does not sound right, heartbeats require no response.
 
&gt;<i> My understanding is that when dealing solely with non-persistent 
</I>&gt;<i> messages, Rabbit won't hit the disk until it runs out of RAM.  Is that 
</I>&gt;<i> accurate?
</I>
It is accurate, but your understanding of &quot;runs out of RAM&quot; might be misguided:
rabbit will start swapping to disc when the RAM used exceeds `total_ram *
vm_memory_high_watermark', where `vm_high_watermark' is a configurable
application variable, with 0.4 as default:
<A HREF="http://www.rabbitmq.com/configure.html">http://www.rabbitmq.com/configure.html</A> .

&gt;<i> Any ideas as to what else might cause this sort of delay, or suggestions on
</I>&gt;<i> how to get further useful information?
</I>
I would say that the most likely thing to be happening is for rabbit to start
paging to disc, so please check that first.  You can monitor your disc space
usage with the rabbitmq management plugin.

You might also be hitting flow control, but that is related to running out of
RAM.  You can check that as well via the management plugin, the connections will
be marked as &quot;blocked&quot;.

Another option could be that you are running out of file descriptors (maybe you
have a large number of connections open?) and rabbit is blocking until some are
available.

--
Francesco * Often in error, never in doubt
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021484.html">[rabbitmq-discuss] Occasional slow message on a local machine
</A></li>
	<LI>Next message: <A HREF="021485.html">[rabbitmq-discuss] Publisher Confirms retries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21498">[ date ]</a>
              <a href="thread.html#21498">[ thread ]</a>
              <a href="subject.html#21498">[ subject ]</a>
              <a href="author.html#21498">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
