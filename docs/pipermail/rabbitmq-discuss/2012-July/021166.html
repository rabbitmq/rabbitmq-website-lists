<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] HA behavior during a network split
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20behavior%20during%20a%20network%20split&In-Reply-To=%3C4FFD4AA3.7060902%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021164.html">
   <LINK REL="Next"  HREF="021163.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] HA behavior during a network split</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20behavior%20during%20a%20network%20split&In-Reply-To=%3C4FFD4AA3.7060902%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] HA behavior during a network split">tim at rabbitmq.com
       </A><BR>
    <I>Wed Jul 11 10:42:59 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021164.html">[rabbitmq-discuss] HA behavior during a network split
</A></li>
        <LI>Next message: <A HREF="021163.html">[rabbitmq-discuss] RabbitMQ shuts itself down every night?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21166">[ date ]</a>
              <a href="thread.html#21166">[ thread ]</a>
              <a href="subject.html#21166">[ subject ]</a>
              <a href="author.html#21166">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/11/2012 10:24 AM, Tim Watson wrote:
&gt;<i>
</I>&gt;<i> AFAIK it is possible for MNesia to heal itself after a netsplit, and 
</I>&gt;<i> therefore getting nodes to rejoin a cluster might work without 
</I>&gt;<i> intervention, possibly depending on what has happened independently on 
</I>&gt;<i> the two 'halves' of the split in the intervening time period. What I 
</I>&gt;<i> would not expect to happen (though I could be wrong here!) is for two 
</I>&gt;<i> distinct GM rings to join up and become one, promoting a new master or 
</I>&gt;<i> demoting an existing one, the latter behaviour being undefined (i.e., 
</I>&gt;<i> not implemented) AFAICT.
</I>&gt;<i>
</I>&gt;<i> When a node rejoins a cluster, mnesia needs to reconcile the 
</I>&gt;<i> differences and I would expect to see mnesia fail when trying to 
</I>&gt;<i> rejoin the cluster if the (Erlang) process ID for the master was 
</I>&gt;<i> different between the two nodes.
</I>&gt;<i>
</I>
And I should probably have pointed out that the message store is 
independent from mnesia as well, and I'm pretty certain that if these 
got out of synch somehow then you'd be in trouble. Currently what 
happens when a node joins a cluster and needs to become a slave (in the 
HA sense) is that the mirror queue coordinator ensures that messages are 
forwarded to that node until its message queue length is the same as 
that of the master, at which point it is considered 'in-sync' with the 
master.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120711/5c6d5d0e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120711/5c6d5d0e/attachment.htm</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021164.html">[rabbitmq-discuss] HA behavior during a network split
</A></li>
	<LI>Next message: <A HREF="021163.html">[rabbitmq-discuss] RabbitMQ shuts itself down every night?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21166">[ date ]</a>
              <a href="thread.html#21166">[ thread ]</a>
              <a href="subject.html#21166">[ subject ]</a>
              <a href="author.html#21166">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
