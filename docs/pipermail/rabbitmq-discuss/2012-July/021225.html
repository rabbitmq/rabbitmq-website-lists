<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Restarting/re-establising failed federation	connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Restarting/re-establising%20failed%20federation%0A%09connections&In-Reply-To=%3C9F05622A-2DB9-4165-AC1D-E550E479B718%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021183.html">
   <LINK REL="Next"  HREF="021343.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Restarting/re-establising failed federation	connections</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Restarting/re-establising%20failed%20federation%0A%09connections&In-Reply-To=%3C9F05622A-2DB9-4165-AC1D-E550E479B718%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Restarting/re-establising failed federation	connections">spowell at rbcon.com
       </A><BR>
    <I>Thu Jul 12 14:50:56 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021183.html">[rabbitmq-discuss] Restarting/re-establising failed federation	connections
</A></li>
        <LI>Next message: <A HREF="021343.html">[rabbitmq-discuss] Restarting/re-establising failed federation	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21225">[ date ]</a>
              <a href="thread.html#21225">[ thread ]</a>
              <a href="subject.html#21225">[ subject ]</a>
              <a href="author.html#21225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi David,

Federated exchanges establish AMQP connections upstream, so it is the
downstream Rabbit server which is connecting to the upstream one, not
the other way around.

What is probably happening when you restart the upstream cluster is that
the downstream federation recovery process is able to re-start. Why it
is blocking, I cannot tell.

Please can you tell me what versions of RabbitMQ you are running on the
upstream and downstream clusters? Although these are allowed to be
different, some changes were made in 2.8.2 which try to take advantage
of upstream exchange mods if they are detected. If the upstream exchange
and downstream exchange have versions which straddle 2.8.2, I might
expect some odd behaviour in recovery scenarios (though we should be
fine :-).

Steve Powell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>
[wrk: +44-2380-111-528] [mob: +44-7815-838-558]

On 11 Jul 2012, at 13:35, David Gillies wrote:

&gt;<i> Hi, 
</I>&gt;<i> 
</I>&gt;<i> So I've got a simple federated setup where we have a bunch of rabbits in various data centres all publishing to a central upstream queue. This works well for most of them, except for one data centre which has particularly bad connectivity. I've found the upstream rabbitmq server gets into a situation where by it loses connectivity to the downstream rabbit and is never able to connect again which results me going to the lengths of restarting the upstream rabbitmq cluster (just two servers in a cluster). Is there a less heavy handed way of re-establising the connection to the downstream cluster for situations where the federation plugin can't seem to reconnect anymore?
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> David.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021183.html">[rabbitmq-discuss] Restarting/re-establising failed federation	connections
</A></li>
	<LI>Next message: <A HREF="021343.html">[rabbitmq-discuss] Restarting/re-establising failed federation	connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21225">[ date ]</a>
              <a href="thread.html#21225">[ thread ]</a>
              <a href="subject.html#21225">[ subject ]</a>
              <a href="author.html#21225">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
