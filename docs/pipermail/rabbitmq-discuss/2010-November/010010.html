<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Doubt%20regarding%20rabbit%20servers%20in%20clustered%0A%09environment&In-Reply-To=%3CAANLkTimDiyBOk2rmQDPmbGwMm%3Ds1Y9k1mqdmrzAZDfWQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010009.html">
   <LINK REL="Next"  HREF="010012.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment</H1>
    <B>Marek Majkowski</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Doubt%20regarding%20rabbit%20servers%20in%20clustered%0A%09environment&In-Reply-To=%3CAANLkTimDiyBOk2rmQDPmbGwMm%3Ds1Y9k1mqdmrzAZDfWQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment">majek04 at gmail.com
       </A><BR>
    <I>Fri Nov 19 17:04:05 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="010009.html">[rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment
</A></li>
        <LI>Next message: <A HREF="010012.html">[rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10010">[ date ]</a>
              <a href="thread.html#10010">[ thread ]</a>
              <a href="subject.html#10010">[ subject ]</a>
              <a href="author.html#10010">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Nov 19, 2010 at 16:46, Kshitiz Garg &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">stephanion2002 at gmail.com</A>&gt; wrote:
&gt;<i> Thanks for the reply Mark,
</I>&gt;<i>
</I>&gt;<i> In our case, we
</I>&gt;<i>
</I>&gt;<i> 1. Create two exchanges A and B
</I>&gt;<i> 2. Create 8 queues a,b,c,d,e,f,g,h
</I>&gt;<i> 3. Bind A,B to these queues.
</I>&gt;<i> 4. Consumer is listening to a,b,c,d,e,f,g,h ......
</I>&gt;<i> 5. For the above operations, we are using two Rabbit MQ nodes in clustered
</I>&gt;<i> mode.
</I>&gt;<i>
</I>&gt;<i> Please let us know the behaviour of clustered RabbitMQs ....
</I>&gt;<i>
</I>&gt;<i> Also, I could not understand the statement &quot;all the traffic to a queue gets
</I>&gt;<i> forwarded to one particular node.&quot;&#160; (we send the messages to an exchange and
</I>&gt;<i> not a queue, isn't it ?)
</I>
Right. I said it's complex :)

All the metadata lives in a replicated Erlang database (mnesia). That includes:
exchanges, bindings, credentials and so on.

So, if you update anything of that - it will be immediately visible
in the whole cluster. In other words: when you create an exchange
A on node 1, that will automatically create exchange A on node 2.

Now, with queues that's more complex. When you connect to node 1
and do queue_declare(xx), you are actually creating a queue on
that particular node. This information (queue xx is created on node 1)
is shared with other nodes. All the nodes know that a location of
queue xx is node1.

Whenever you publish stuff, to whatever node, the message
is pushed to a local exchange (as mentioned before, exchanges
are 'copied' to every node). Next step after the exchange
is the binding. The bindings are also 'copied' to all the nodes.
At that point the node knows: this message should go to a queue xx.

The node looks up where the queue lives and pushes a message to
a particular node that holds queue xx.

So, once again: exchanges and bindings are replicated, they
are the same for every node in the cluster.
Queue on the other hand lives on a particular node (actually
on the node that 'queue_declare' was executed).

Clustering != HA
(the messages (queue contents) live on a single node)

(I'm sure my friends from the team will clarify if I got the details wrong)

Is this description any better?

Cheers,
  Marek
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010009.html">[rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment
</A></li>
	<LI>Next message: <A HREF="010012.html">[rabbitmq-discuss] Doubt regarding rabbit servers in clustered	environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10010">[ date ]</a>
              <a href="thread.html#10010">[ thread ]</a>
              <a href="subject.html#10010">[ subject ]</a>
              <a href="author.html#10010">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
