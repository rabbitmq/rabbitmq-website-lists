<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] beam.smp takes a lot of CPU and memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20beam.smp%20takes%20a%20lot%20of%20CPU%20and%20memory&In-Reply-To=%3CAANLkTimh%2B52PX6%2BeDVYf0FpPQ%2BXVBk17B2yxyiXKQ0nk%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009925.html">
   <LINK REL="Next"  HREF="009970.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] beam.smp takes a lot of CPU and memory</H1>
    <B>Mutaz Qasem</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20beam.smp%20takes%20a%20lot%20of%20CPU%20and%20memory&In-Reply-To=%3CAANLkTimh%2B52PX6%2BeDVYf0FpPQ%2BXVBk17B2yxyiXKQ0nk%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] beam.smp takes a lot of CPU and memory">mutazmq at gmail.com
       </A><BR>
    <I>Sat Nov 13 17:10:40 GMT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009925.html">[rabbitmq-discuss] beam.smp takes a lot of CPU adn memory
</A></li>
        <LI>Next message: <A HREF="009970.html">[rabbitmq-discuss] beam.smp takes a lot of CPU and memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9928">[ date ]</a>
              <a href="thread.html#9928">[ thread ]</a>
              <a href="subject.html#9928">[ subject ]</a>
              <a href="author.html#9928">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matthew

There are few already. a message every hour! Please advise

Thank you
Mutaz


On Sat, Nov 13, 2010 at 4:00 PM, &lt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-request at lists.rabbitmq.com</A>&gt; wrote:

&gt;<i> Send rabbitmq-discuss mailing list submissions to
</I>&gt;<i>        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-request at lists.rabbitmq.com</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-owner at lists.rabbitmq.com</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of rabbitmq-discuss digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>   1. jsonrpc-channel not showing up under      localhost:55672
</I>&gt;<i>      (???? ?????? / Emil Ivanov)
</I>&gt;<i>   2. Re: jsonrpc-channel not showing up        under   localhost:55672
</I>&gt;<i>      (Simon MacMullen)
</I>&gt;<i>   3. beam.smp takes a lot of CPU adn memory (Mutaz Qasem)
</I>&gt;<i>   4. Re: beam.smp takes a lot of CPU adn memory (Matthew Sackman)
</I>&gt;<i>   5. Re: Passing null for 'arguments' to queueBind() (Michael Bridgen)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Fri, 12 Nov 2010 14:08:55 +0200
</I>&gt;<i> From: ???? ?????? / Emil Ivanov         &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emil.vladev at gmail.com</A>&gt;
</I>&gt;<i> Subject: [rabbitmq-discuss] jsonrpc-channel not showing up under
</I>&gt;<i>        localhost:55672
</I>&gt;<i> To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> Message-ID:
</I>&gt;<i>        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">AANLkTinjd6sxv+NSFoOehZXDFS_Am1rx_ZTBiB+RgFnE at mail.gmail.com</A>&lt;AANLkTinjd6sxv%2BNSFoOehZXDFS_Am1rx_ZTBiB%<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">2BRgFnE at mail.gmail.com</A>&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i>
</I>&gt;<i> Good day,
</I>&gt;<i>
</I>&gt;<i> I just installed rabbitmq 2.1.1 via .deb package on Ubuntu 10.10 and
</I>&gt;<i> got the .ez files for the jsonrpc-channel and management plugins. When
</I>&gt;<i> I visit <A HREF="http://localhost:55672/">http://localhost:55672/</A> I see Management Console, HTTP API,
</I>&gt;<i> Command Line Tool entries. However - there is no entry for
</I>&gt;<i> jsonrpc-channel (for the examples). I've managed to get it running
</I>&gt;<i> with rabbitmq 1.7, but no luck with 2.1.1. Attaching the logs.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Emil
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> My place to share my ideas:
</I>&gt;<i> <A HREF="http://bolddream.com">http://bolddream.com</A> (now live :)
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> A non-text attachment was scrubbed...
</I>&gt;<i> Name: rabbit.log
</I>&gt;<i> Type: text/x-log
</I>&gt;<i> Size: 813 bytes
</I>&gt;<i> Desc: not available
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101112/8f19e546/attachment-0001.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101112/8f19e546/attachment-0001.bin</A>
</I>&gt;<i> &gt;
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> A non-text attachment was scrubbed...
</I>&gt;<i> Name: startup_log
</I>&gt;<i> Type: application/octet-stream
</I>&gt;<i> Size: 3232 bytes
</I>&gt;<i> Desc: not available
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101112/8f19e546/attachment-0001.obj">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101112/8f19e546/attachment-0001.obj</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Fri, 12 Nov 2010 12:18:46 +0000
</I>&gt;<i> From: Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] jsonrpc-channel not showing up  under
</I>&gt;<i>        localhost:55672
</I>&gt;<i> To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">4CDD30A6.2050901 at rabbitmq.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8; format=flowed
</I>&gt;<i>
</I>&gt;<i> On 12/11/10 12:08, ???? ?????? / Emil Ivanov wrote:
</I>&gt;<i> &gt; I just installed rabbitmq 2.1.1 via .deb package on Ubuntu 10.10 and
</I>&gt;<i> &gt; got the .ez files for the jsonrpc-channel and management plugins. When
</I>&gt;<i> &gt; I <A HREF="visithttp://localhost:55672/">visithttp://localhost:55672/</A>  I see Management Console, HTTP API,
</I>&gt;<i> &gt; Command Line Tool entries. However - there is no entry for
</I>&gt;<i> &gt; jsonrpc-channel (for the examples). I've managed to get it running
</I>&gt;<i> &gt; with rabbitmq 1.7, but no luck with 2.1.1. Attaching the logs.
</I>&gt;<i>
</I>&gt;<i> Hi Emil. The .ez file for jsonrpc-channel does not install the examples,
</I>&gt;<i> since there would be no obvious way to remove them for production use.
</I>&gt;<i> And the rpc and js_root contexts don't appear in the list since there's
</I>&gt;<i> no point directly clicking on them.
</I>&gt;<i>
</I>&gt;<i> Unfortunately this does mean it's not exactly obvious that anything is
</I>&gt;<i> happening! If you go into the management plugin overview page and expand
</I>&gt;<i> &quot;Applications&quot; you should find rabbit_jsonrpc, rabbit_jsonrpc_channel
</I>&gt;<i> and rfc4627_jsonrpc applications running.
</I>&gt;<i>
</I>&gt;<i> I'll have a think about how we can make this clearer.
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> Staff Engineer, RabbitMQ
</I>&gt;<i> SpringSource, a division of VMware
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Fri, 12 Nov 2010 18:56:28 +0400
</I>&gt;<i> From: Mutaz Qasem &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mutazmq at gmail.com</A>&gt;
</I>&gt;<i> Subject: [rabbitmq-discuss] beam.smp takes a lot of CPU adn memory
</I>&gt;<i> To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> Message-ID:
</I>&gt;<i>        &lt;AANLkTin9_d=<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">PNu6HNet_yGv6yU3z+LnDJR_zZDNsWboj at mail.gmail.com</A>&lt;PNu6HNet_yGv6yU3z%<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">2BLnDJR_zZDNsWboj at mail.gmail.com</A>&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> beam.smp is taking ebtween 70% - 90% of my CPU and around 780M RES and 980
</I>&gt;<i> VIRT.
</I>&gt;<i>
</I>&gt;<i> I'm running rabbitmq-server 1.8.1
</I>&gt;<i> and Erlang R14A (erts-5.8) [source] [64-bit] [smp:2:2] [rq:2]
</I>&gt;<i> [async-threads:0] [hipe] [kernel-poll:false]
</I>&gt;<i>
</I>&gt;<i> Any ideas please?
</I>&gt;<i>
</I>&gt;<i> Thank you in advance
</I>&gt;<i> Mutaz
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101112/5745b5c9/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101112/5745b5c9/attachment-0001.htm</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 4
</I>&gt;<i> Date: Fri, 12 Nov 2010 15:28:00 +0000
</I>&gt;<i> From: Matthew Sackman &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at rabbitmq.com</A>&gt;
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] beam.smp takes a lot of CPU adn memory
</I>&gt;<i> To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">20101112152800.GV22102 at rabbitmq.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=us-ascii
</I>&gt;<i>
</I>&gt;<i> On Fri, Nov 12, 2010 at 06:56:28PM +0400, Mutaz Qasem wrote:
</I>&gt;<i> &gt; beam.smp is taking ebtween 70% - 90% of my CPU and around 780M RES and
</I>&gt;<i> 980
</I>&gt;<i> &gt; VIRT.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm running rabbitmq-server 1.8.1
</I>&gt;<i> &gt; and Erlang R14A (erts-5.8) [source] [64-bit] [smp:2:2] [rq:2]
</I>&gt;<i> &gt; [async-threads:0] [hipe] [kernel-poll:false]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas please?
</I>&gt;<i>
</I>&gt;<i> Send fewer messages?
</I>&gt;<i>
</I>&gt;<i> Matthew
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 5
</I>&gt;<i> Date: Fri, 12 Nov 2010 17:43:38 +0000
</I>&gt;<i> From: Michael Bridgen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mikeb at rabbitmq.com</A>&gt;
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] Passing null for 'arguments' to
</I>&gt;<i>        queueBind()
</I>&gt;<i> To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">4CDD7CCA.30509 at rabbitmq.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i> &gt;&gt; It *is* a problem though when the groups are formed dynamically on
</I>&gt;<i> &gt;&gt; a per message basis, i.e. when each consumer has a unique secret
</I>&gt;<i> &gt;&gt; token, known to the producer, and the producer constructs the
</I>&gt;<i> &gt;&gt; recipient group of the message on the fly by including all the
</I>&gt;<i> &gt;&gt; intended recipient's tokens in the message headers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I understand you now, and above is exactly the situation I have.  I
</I>&gt;<i> &gt; wonder if a custom exchange type can remove headers from a message
</I>&gt;<i> &gt; prior to delivery.
</I>&gt;<i>
</I>&gt;<i> Here is a design:
</I>&gt;<i>
</I>&gt;<i> Allow CC and BCC fields* when publishing.  These are given to exchange
</I>&gt;<i> types** when routing (i.e., they are part of the envelope); and, the
</I>&gt;<i> routing code removes Bcc before actually delivering to queues.
</I>&gt;<i>
</I>&gt;<i> Full semantics left as an exercise*** for the reader.
</I>&gt;<i>
</I>&gt;<i> * They would probably have to be put in message headers, but possibly
</I>&gt;<i> they could be given specific support in our clients.
</I>&gt;<i>
</I>&gt;<i> ** We'd update direct and topic to take account of them; fanout and
</I>&gt;<i> headers don't need to, and other types given be given the fields and do
</I>&gt;<i> what they like.
</I>&gt;<i>
</I>&gt;<i> *** For example, &quot;&quot; is a valid routing key, so how do you send to
</I>&gt;<i> multiple recipients just with BCC field?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Michael
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> End of rabbitmq-discuss Digest, Vol 42, Issue 40
</I>&gt;<i> ************************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101113/c4123be6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101113/c4123be6/attachment.htm</A>&gt;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009925.html">[rabbitmq-discuss] beam.smp takes a lot of CPU adn memory
</A></li>
	<LI>Next message: <A HREF="009970.html">[rabbitmq-discuss] beam.smp takes a lot of CPU and memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9928">[ date ]</a>
              <a href="thread.html#9928">[ thread ]</a>
              <a href="subject.html#9928">[ subject ]</a>
              <a href="author.html#9928">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
