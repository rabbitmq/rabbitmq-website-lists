<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Suddenly dropping all conns?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Suddenly%20dropping%20all%20conns%3F&In-Reply-To=%3C1377269560927-29046.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029691.html">
   <LINK REL="Next"  HREF="029553.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Suddenly dropping all conns?</H1>
    <B>ku3ia</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Suddenly%20dropping%20all%20conns%3F&In-Reply-To=%3C1377269560927-29046.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Suddenly dropping all conns?">demesg at gmail.com
       </A><BR>
    <I>Fri Aug 23 15:52:40 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029691.html">[rabbitmq-discuss] File descriptors slowly reaching 1024...
</A></li>
        <LI>Next message: <A HREF="029553.html">[rabbitmq-discuss] Suddenly dropping all conns?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29552">[ date ]</a>
              <a href="thread.html#29552">[ thread ]</a>
              <a href="subject.html#29552">[ subject ]</a>
              <a href="author.html#29552">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi! I have the same problem. I'm on v. 3.1.5 and haproxy 1.4.18. But my
haproxy and rabbitmq server is on the same machine. I had removed any
servers and leave config as is:

/etc/haproxy/haproxy.cfg
# this config needs haproxy-1.1.28 or haproxy-1.2.1

global
  log 127.0.0.1 local0
  log 127.0.0.1 local1 notice
  #log loghost local0 info
  maxconn 4096
  #chroot /usr/share/haproxy
  user haproxy
  group haproxy
  daemon
  #debug
  #quiet

defaults
  log global
  mode tcp
  option tcplog
  option dontlognull
  retries 3
  option redispatch
  maxconn 2000
  contimeout 5000
  clitimeout 50000
  srvtimeout 50000

listen rabbitmq 0.0.0.0:5670
  mode tcp
  balance leastconn
  server server1 127.0.0.1:5672 check inter 3000 downinter 500

listen stat :80
  mode http
  option httplog
  stats enable
  stats uri /admin/stat
  stats refresh 30s

I'm using .NET client. Starting connection... stating channel. Look at the
management module. Its all ok. But after some seconds, may be 10 or more on
Overview section there are no more connections.

When I'm connecting direct to rabbitmq server without HAProxy everything
looks fine, no losts! Please advice. Thanks.



--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Suddenly-dropping-all-conns-tp16885p29046.html">http://rabbitmq.1065348.n5.nabble.com/Suddenly-dropping-all-conns-tp16885p29046.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029691.html">[rabbitmq-discuss] File descriptors slowly reaching 1024...
</A></li>
	<LI>Next message: <A HREF="029553.html">[rabbitmq-discuss] Suddenly dropping all conns?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29552">[ date ]</a>
              <a href="thread.html#29552">[ thread ]</a>
              <a href="subject.html#29552">[ subject ]</a>
              <a href="author.html#29552">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
