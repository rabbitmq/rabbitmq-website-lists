<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] AutoHeal not working after yanking network cable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AutoHeal%20not%20working%20after%20yanking%20network%0A%20cable&In-Reply-To=%3C5220CE24.4070501%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029734.html">
   <LINK REL="Next"  HREF="029736.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] AutoHeal not working after yanking network cable</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AutoHeal%20not%20working%20after%20yanking%20network%0A%20cable&In-Reply-To=%3C5220CE24.4070501%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] AutoHeal not working after yanking network cable">simon at rabbitmq.com
       </A><BR>
    <I>Fri Aug 30 17:53:56 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029734.html">[rabbitmq-discuss] AutoHeal not working after yanking network cable
</A></li>
        <LI>Next message: <A HREF="029736.html">[rabbitmq-discuss] Lost queue on cluster node shutdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29735">[ date ]</a>
              <a href="thread.html#29735">[ thread ]</a>
              <a href="subject.html#29735">[ subject ]</a>
              <a href="author.html#29735">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There was definitely a bug in autoheal fixed in 3.1.1, but I'm not aware 
of anything since then. However it's possible some other bug that we 
have fixed is causing your problems with autoheal.

So:

1) You might as well try 3.1.5.
2) Are there any crashes in the logs on the minority node?

Cheers, Simon

On 30/08/2013 4:26PM, Chris wrote:
&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> As part of our testing of failovers, we yank the network cable on a
</I>&gt;<i> machine (to simulate a switch going down).  When we plug it back in,
</I>&gt;<i> RabbitMQ goes into the network partition mode.  At first we were using
</I>&gt;<i> the default ('ignore') option for dealing with partitions, but it caused
</I>&gt;<i> problems.
</I>&gt;<i>
</I>&gt;<i> After that we put the nodes into 'autoheal' mode.  This did not improve
</I>&gt;<i> things.  Not only did the minority node not rejoin the partition, but it
</I>&gt;<i> refused to restart without manually killing the process.  It also caused
</I>&gt;<i> problems on the other nodes (in the majority).  They stopped accepting
</I>&gt;<i> connections and I couldn't even log into the web UI.  So clearly,
</I>&gt;<i> 'autoheal' didn't seem to work as intended.
</I>&gt;<i>
</I>&gt;<i> We're using RabbitMQ 3.1.1.  Is there anything fixed since then that
</I>&gt;<i> might help with our situation?  Our end goal is to have everything
</I>&gt;<i> working again without intervention.  I understand that this could cause
</I>&gt;<i> *some* data loss during the autoheal process, but this is probably OK.
</I>&gt;<i>   We'd love just to get all three nodes happy again without having to
</I>&gt;<i> manually restart any nodes.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Chris
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>
-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029734.html">[rabbitmq-discuss] AutoHeal not working after yanking network cable
</A></li>
	<LI>Next message: <A HREF="029736.html">[rabbitmq-discuss] Lost queue on cluster node shutdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29735">[ date ]</a>
              <a href="thread.html#29735">[ thread ]</a>
              <a href="subject.html#29735">[ subject ]</a>
              <a href="author.html#29735">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
