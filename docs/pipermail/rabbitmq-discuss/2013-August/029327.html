<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Orphaned%20channels%20after%20connection%20close%20in%0A%20Rabbit%203.1.4&In-Reply-To=%3CCAFS6ge%3DPW-AFDc93cqaSsm1rdp3%3D5--1ir-Mi85wjvwz7EXkDQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029326.html">
   <LINK REL="Next"  HREF="029328.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4</H1>
    <B>Paul Bowsher</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Orphaned%20channels%20after%20connection%20close%20in%0A%20Rabbit%203.1.4&In-Reply-To=%3CCAFS6ge%3DPW-AFDc93cqaSsm1rdp3%3D5--1ir-Mi85wjvwz7EXkDQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4">paul.bowsher at gmail.com
       </A><BR>
    <I>Thu Aug 15 11:14:11 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029326.html">[rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4
</A></li>
        <LI>Next message: <A HREF="029328.html">[rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29327">[ date ]</a>
              <a href="thread.html#29327">[ thread ]</a>
              <a href="subject.html#29327">[ subject ]</a>
              <a href="author.html#29327">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Oops sorry, premature send. In the connections view they don't say blocked,
flow or running. When you click the connection it doesn't have a &quot;state&quot; at
all. However rabbitmqctl list_connections lists them as blocked.

These publishers are still publishing to node A, and again there's no stuck
connections on node B. Both nodes are identical hardware (not VMs), and are
completely fine in terms of resource.

Paul Bowsher


On Thu, Aug 15, 2013 at 11:11 AM, Paul Bowsher &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">paul.bowsher at gmail.com</A>&gt;wrote:

&gt;<i> Nope, nothing at all. When we have seen this issue &quot;live&quot; all the resource
</I>&gt;<i> indicators on the Overview page are green by a long way. The only error we
</I>&gt;<i> have in the logs is:
</I>&gt;<i>
</I>&gt;<i> =ERROR REPORT==== 15-Aug-2013::11:02:42 ===
</I>&gt;<i> ** Generic server delegate_0 terminating
</I>&gt;<i> ** Last message in was
</I>&gt;<i> {'DOWN',#Ref&lt;0.0.2498.72665&gt;,process,&lt;2986.16099.3104&gt;,
</I>&gt;<i>                                normal}
</I>&gt;<i> ** When Server state == {state,'<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at 428178-data15</A>',
</I>&gt;<i>                                {dict,2,16,16,8,80,48,
</I>&gt;<i>
</I>&gt;<i>  {[],[],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                       [],[],[]},
</I>&gt;<i>                                      {{[],
</I>&gt;<i>                                        [[&lt;2986.16099.3104&gt;|
</I>&gt;<i>                                          {&lt;0.18153.2029&gt;,
</I>&gt;<i>                                           #Ref&lt;0.0.2498.72669&gt;}]],
</I>&gt;<i>                                        [[&lt;2986.15096.3096&gt;|
</I>&gt;<i>                                          {&lt;0.18155.2029&gt;,
</I>&gt;<i>                                           #Ref&lt;0.0.2497.259319&gt;}]],
</I>&gt;<i>                                        [],[],[],[],[],[],[],[],[],[],[],[],
</I>&gt;<i>                                        []}}},
</I>&gt;<i>                                delegate_0}
</I>&gt;<i> ** Reason for termination ==
</I>&gt;<i> ** {{case_clause,{ok,{&lt;0.18153.2029&gt;,#Ref&lt;0.0.2498.72669&gt;}}},
</I>&gt;<i>     [{delegate,handle_info,2,[]},
</I>&gt;<i>      {gen_server2,handle_msg,2,[]},
</I>&gt;<i>      {proc_lib,init_p_do_apply,3,[{file,&quot;proc_lib.erl&quot;},{line,239}]}]}
</I>&gt;<i>
</I>&gt;<i> I've also just noticed now that we have publisher connections that are
</I>&gt;<i> stuck too. In the connections view
</I>&gt;<i>
</I>&gt;<i> Paul Bowsher
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Aug 15, 2013 at 10:54 AM, Matthias Radestock &lt;
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Paul,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 15/08/13 10:50, Paul Bowsher wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks for the reply. When you say resource alarms, do you mean on the
</I>&gt;&gt;&gt;<i> server or from the clients?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Server.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  It seems that we have a sick rabbit on node A. How can we
</I>&gt;&gt;&gt;<i> help diagnose this?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Check the logs and the management UI. For connections to be in the
</I>&gt;&gt;<i> 'blocked' state for any significant duration of time, there must be a
</I>&gt;&gt;<i> triggering memory and/or disk alarm. Which should be very obvious in the
</I>&gt;&gt;<i> logs and UI.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matthias.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130815/339dfbe9/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130815/339dfbe9/attachment.htm</A>&gt;
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029326.html">[rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4
</A></li>
	<LI>Next message: <A HREF="029328.html">[rabbitmq-discuss] Orphaned channels after connection close in Rabbit 3.1.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29327">[ date ]</a>
              <a href="thread.html#29327">[ thread ]</a>
              <a href="subject.html#29327">[ subject ]</a>
              <a href="author.html#29327">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
