<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3	and Erlang R16B01 - Single Node and Cluster Node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Throughput%20observation%20with%20RabbitMQ-3.1.3%0A%09and%20Erlang%20R16B01%20-%20Single%20Node%20and%20Cluster%20Node&In-Reply-To=%3C3B830530-4ED1-46EA-9462-B2DDD8930FA2%40gopivotal.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029395.html">
   <LINK REL="Next"  HREF="029063.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3	and Erlang R16B01 - Single Node and Cluster Node</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Throughput%20observation%20with%20RabbitMQ-3.1.3%0A%09and%20Erlang%20R16B01%20-%20Single%20Node%20and%20Cluster%20Node&In-Reply-To=%3C3B830530-4ED1-46EA-9462-B2DDD8930FA2%40gopivotal.com%3E"
       TITLE="[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3	and Erlang R16B01 - Single Node and Cluster Node">mklishin at gopivotal.com
       </A><BR>
    <I>Fri Aug 16 19:50:12 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029395.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
        <LI>Next message: <A HREF="029063.html">[rabbitmq-discuss] Fwd:  Possible bug in .NET library,	with IConnection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29397">[ date ]</a>
              <a href="thread.html#29397">[ thread ]</a>
              <a href="subject.html#29397">[ subject ]</a>
              <a href="author.html#29397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Priyanki Vashi:

&gt;<i> 1) how good or bad my pika clients efficiciency is and then how exactly my system resources are used by both client and rabbit server.
</I>
The goal really is still to see some evidence about producer being not fast enough. If you get much better results with faster publishers, esp.
if they can use multiple cores (MulticastMain can, I expect the same to be true of amqpc), that
would prove the hypothesis we have.

&gt;<i> So far I can only see that if I send 100 byes of payload, maximum throughput I get is around 30,000 msg/sec and maximum bandwidth usage is 160-170 mbps. Trying to understand what is happening in system with RAM, memory etc. etc.... 
</I>&gt;<i> 
</I>&gt;<i> As you mentioned I see comapritively better bandwidth usage with 500 bytes and 1000 bytes and they are in range of 350 Mbps and 580 Mpbs. Which I don't know is appropriate or not.
</I>&gt;<i> 
</I>&gt;<i> Do you know if one can saturate 8Gbps link with Rabbit ? 
</I>
Start publishing messages of 1-8 MB in size. You will see throughput drop but overall link saturation
should be higher.

&gt;<i> For the earlier question of Micheal on number of cores, here is some more info. 
</I>&gt;<i> 
</I>&gt;<i> I have 10 physical cores and they are hyperthreaded so that's how I have 20 cores. I have such two machines. So then,
</I>&gt;<i> 
</I>&gt;<i> Machine-1 with 20 cores running exclusively my Producer &amp; Receiver based on pika
</I>&gt;<i> Machine-2, again with 20 cores running exclusively RABBITMQ server
</I>
On this kind of machines, you should run 5-20 instances of both producer and consumer and context
switching won't be a problem.

You can always check core saturation and load average (a.k.a. how many processes expect the OS to give it a slice of CPU time) in htop. Increase numbers of producer and consumer until all 10 cores are
busy most of the time.

On the RabbitMQ side, running Erlang R16B01 and using multiple queues
(e.g. at least 1 per consumer) should help saturate more cores given that the runtime actually
needs them.
--
MK

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130816/1a0082a3/attachment.pgp">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130816/1a0082a3/attachment.pgp</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029395.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
	<LI>Next message: <A HREF="029063.html">[rabbitmq-discuss] Fwd:  Possible bug in .NET library,	with IConnection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29397">[ date ]</a>
              <a href="thread.html#29397">[ thread ]</a>
              <a href="subject.html#29397">[ subject ]</a>
              <a href="author.html#29397">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
