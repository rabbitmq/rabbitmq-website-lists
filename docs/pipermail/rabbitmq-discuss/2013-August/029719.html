<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20does%20Messages%20will%20be%20persisted%20in%0A%09RabbitMQ%3F&In-Reply-To=%3C9DE998FC-FB9E-4ACC-9E3E-AA93339EFE30%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029718.html">
   <LINK REL="Next"  HREF="029720.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20does%20Messages%20will%20be%20persisted%20in%0A%09RabbitMQ%3F&In-Reply-To=%3C9DE998FC-FB9E-4ACC-9E3E-AA93339EFE30%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?">tim at rabbitmq.com
       </A><BR>
    <I>Fri Aug 30 13:11:43 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029718.html">[rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?
</A></li>
        <LI>Next message: <A HREF="029720.html">[rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29719">[ date ]</a>
              <a href="thread.html#29719">[ thread ]</a>
              <a href="subject.html#29719">[ subject ]</a>
              <a href="author.html#29719">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What Michael said, plus just to clarify...

On 30 Aug 2013, at 12:49, Michael Klishin wrote:
&gt;&gt;<i> So, you mean we shouldn't use any database where RabbitMQ does for us ,
</I>&gt;&gt;<i> 
</I>
Not only shouldn't you, you *cannot* use an alternative database for the purpose of storing persistent messages.

A vanilla RabbitMQ install (with no plugins in use) uses three different kinds of databases, two of which are persisted to disk:

1. mnesia - used to store &quot;schema&quot; data, such as queue, exchange and binding definitions (as per Michael's earlier explanation), either to disk or in ram
2. the message store - used to store persistent messages to disk (and messages that require paging due to memory pressure)
3. the message store index - stores the position of messages in queues, in memory by default (but can use alternative mechanisms such as tokyo cabinet)

&gt;&gt;<i>    2&gt; even it doesn't use even any file system. 
</I>&gt;&gt;<i> 
</I>
It *does* use the file system. The internal database writes data to a number of files which are (incidentally) stored underneath the root mnesia directory, although they have nothing to do with mnesia (we just store them in the same directory). These files contain data encoded in an internal format which is not human readable and we do not provide any tools for inspecting the contents of these database files.

&gt;&gt;<i> In this case how can we restore the database in case of server crash or some other issue.
</I>&gt;<i> 
</I>&gt;<i> RabbitMQ will recover durable queues/exchanges and persistent messages in those queues
</I>&gt;<i> on start. It will also perform database upgrades when you install a newer version.
</I>&gt;<i> 
</I>
Specifically, RabbitMQ will use the aforementioned files when recovering persistent messages stored in durable queues on startup.

Tim
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029718.html">[rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?
</A></li>
	<LI>Next message: <A HREF="029720.html">[rabbitmq-discuss] How does Messages will be persisted in	RabbitMQ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29719">[ date ]</a>
              <a href="thread.html#29719">[ thread ]</a>
              <a href="subject.html#29719">[ subject ]</a>
              <a href="author.html#29719">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
