<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Docs/Advice on extending HTTP API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Docs/Advice%20on%20extending%20HTTP%20API&In-Reply-To=%3C277EB6AE-9F7C-482E-8BE8-9CA7E0051870%40dushin.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029635.html">
   <LINK REL="Next"  HREF="029625.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Docs/Advice on extending HTTP API</H1>
    <B>Dushin Fred</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Docs/Advice%20on%20extending%20HTTP%20API&In-Reply-To=%3C277EB6AE-9F7C-482E-8BE8-9CA7E0051870%40dushin.net%3E"
       TITLE="[rabbitmq-discuss] Docs/Advice on extending HTTP API">fred at dushin.net
       </A><BR>
    <I>Tue Aug 27 01:27:27 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029635.html">[rabbitmq-discuss] Keeping idle connections alive in EC2
</A></li>
        <LI>Next message: <A HREF="029625.html">[rabbitmq-discuss] Docs/Advice on extending HTTP API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29613">[ date ]</a>
              <a href="thread.html#29613">[ thread ]</a>
              <a href="subject.html#29613">[ subject ]</a>
              <a href="author.html#29613">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I have some administrative operations I would like to add, via an additional plugin (OTP application), to a RabbitMQ instance.  I have reasonably successful writing a few generic plugins, which as I understand it are basically just OTP applications that have been registered with RabbitMQ, but I am having some difficulty fully understanding how to interface with mochiweb to add operations to the REST API.  (I am less interested in making changes to the WebUI, but understanding how to do that would be a bonus.)

So far, I have copied the rabbitmq_shovel_management plugin (using the 3.1.5 branch on rabbitmq-public-umbrella), as a guide, and I have managed to insert my own dummy code for get operations, and I can do an HTTP GET to get the data that the plugin is providing, e.g., via

%%--------------------------------------------------------------------

init(_Config) -&gt; {ok, #context{}}.

content_types_provided(ReqData, Context) -&gt;
   {[{&quot;application/json&quot;, to_json}], ReqData, Context}.

to_json(ReqData, Context) -&gt;
    rabbit_mgmt_util:reply(status(), ReqData, Context).

is_authorized(ReqData, Context) -&gt;
    rabbit_mgmt_util:is_authorized_admin(ReqData, Context).

%%--------------------------------------------------------------------

status() -&gt;
	[{name, &lt;&lt;&quot;foo&quot;&gt;&gt;}, {node, &lt;&lt;&quot;bar&quot;&gt;&gt;} ].

I am now interested in using PUT and POST operations to pass parameters to allow state mutation on the server (a la REST principles).

I don't suppose there is any documentation on anything more than the metronome sample plugin.  Is there a simple example to follow, in the umbrella code, that would give me an architectural understanding of how the rabbit_mgmt_extension behavior can be leveraged?

Short of that, can anyone explain the roles of the following functions?

content_types_provided/2
resource_exists/2
to_json/2
is_authorized/2

augmented/2
basic/1

Who calls them?  When are they called?  Can anything general be said about the parameters to these functions?   (Yes, I too can use io:format :)

Sorry for the somewhat vague set of questions, but I haven't gotten cozy with mochiweb (though I have done some work with YAWS), so I am just hunting for a few pointers.

Thanks in advance,

-Fred
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130826/6e196b4a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130826/6e196b4a/attachment.htm</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029635.html">[rabbitmq-discuss] Keeping idle connections alive in EC2
</A></li>
	<LI>Next message: <A HREF="029625.html">[rabbitmq-discuss] Docs/Advice on extending HTTP API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29613">[ date ]</a>
              <a href="thread.html#29613">[ thread ]</a>
              <a href="subject.html#29613">[ subject ]</a>
              <a href="author.html#29613">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
