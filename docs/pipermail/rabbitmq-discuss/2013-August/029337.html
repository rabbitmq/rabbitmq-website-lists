<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Possible memory leak in the management plugin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Possible%20memory%20leak%20in%20the%20management%20plugin&In-Reply-To=%3Cd87c3cff-1260-43d0-8b3a-b505f315ffb5%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029332.html">
   <LINK REL="Next"  HREF="029338.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Possible memory leak in the management plugin</H1>
    <B>harel at thisisglow.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Possible%20memory%20leak%20in%20the%20management%20plugin&In-Reply-To=%3Cd87c3cff-1260-43d0-8b3a-b505f315ffb5%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Possible memory leak in the management plugin">harel at thisisglow.com
       </A><BR>
    <I>Thu Aug 15 11:46:55 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029332.html">[rabbitmq-discuss] RabbitMQ Crash
</A></li>
        <LI>Next message: <A HREF="029338.html">[rabbitmq-discuss] Possible memory leak in the management plugin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29337">[ date ]</a>
              <a href="thread.html#29337">[ thread ]</a>
              <a href="subject.html#29337">[ subject ]</a>
              <a href="author.html#29337">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We're seeing this happening too, though I did not think to check if the 
management plugin  was the culprit. We started using the plugin and its web 
interface around the time our rabbitmq crashes started happneing - all due 
to out of memory and being killed by the kernel.  We've disabled the 
management plugin and haven't seen the crashes yet though its too early to 
call. 


On Saturday, 15 June 2013 03:09:21 UTC+1, Travis Mehlinger wrote:
&gt;<i>
</I>&gt;<i> We recently upgraded RabbitMQ from 3.0.4 to 3.1.1 after noticing two bug 
</I>&gt;<i> fixes in 3.1.0 related to our RabbitMQ deployment:
</I>&gt;<i>
</I>&gt;<i>    - 25524 fix memory leak in mirror queue slave with many short-lived 
</I>&gt;<i>    publishing channel
</I>&gt;<i>    - 25290 fix per-queue memory leak recording stats for mirror queue 
</I>&gt;<i>    slaves
</I>&gt;<i>
</I>&gt;<i> However, in our case, it seems that the management plugin may still have a 
</I>&gt;<i> memory leak. We have a monitoring agent that hits the REST API to gather 
</I>&gt;<i> information about the broker (number of queues, queue depth, etc.). With 
</I>&gt;<i> the monitoring agent running and making requests against the API, memory 
</I>&gt;<i> consumption steadily increased; when we stopped the agent, memory 
</I>&gt;<i> consumption in the management plugin leveled off.
</I>&gt;<i>
</I>&gt;<i> Here a couple graphs detailing memory consumption in the broker (the 
</I>&gt;<i> figures are parsed from rabbitmqctl report). The first graph shows the 
</I>&gt;<i> ebb and flow of memory consumption in a number of components and the second 
</I>&gt;<i> shows just consumption by the management plugin. You can see pretty clearly 
</I>&gt;<i> where we stopped the monitoring agent at 1:20.
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://dl.dropboxusercontent.com/u/7022167/Screenshots/n-np6obt-m9f.png">https://dl.dropboxusercontent.com/u/7022167/Screenshots/n-np6obt-m9f.png</A>
</I>&gt;<i> <A HREF="https://dl.dropboxusercontent.com/u/7022167/Screenshots/an6dpup33xvx.png">https://dl.dropboxusercontent.com/u/7022167/Screenshots/an6dpup33xvx.png</A>
</I>&gt;<i>
</I>&gt;<i> We have two clustered brokers, both running RabbitMQ 3.1.1 on Erlang 
</I>&gt;<i> R14B-04.1. There are typically around 200 queues, about 20 of which are 
</I>&gt;<i> mirrored. There are generally about 200 consumers. Messages are rarely 
</I>&gt;<i> queued and most queues typically sit idle.
</I>&gt;<i>
</I>&gt;<i> I'll be happy to provide any further diagnostic information.
</I>&gt;<i>
</I>&gt;<i> Thanks!
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130815/d6ed7bac/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130815/d6ed7bac/attachment-0001.htm</A>&gt;
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029332.html">[rabbitmq-discuss] RabbitMQ Crash
</A></li>
	<LI>Next message: <A HREF="029338.html">[rabbitmq-discuss] Possible memory leak in the management plugin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29337">[ date ]</a>
              <a href="thread.html#29337">[ thread ]</a>
              <a href="subject.html#29337">[ subject ]</a>
              <a href="author.html#29337">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
