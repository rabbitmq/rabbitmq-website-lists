<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3	and Erlang R16B01 - Single Node and Cluster Node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Throughput%20observation%20with%20RabbitMQ-3.1.3%0A%09and%20Erlang%20R16B01%20-%20Single%20Node%20and%20Cluster%20Node&In-Reply-To=%3C032B5CE5-5D1E-402A-A4DF-90D0AF66883B%40gopivotal.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029386.html">
   <LINK REL="Next"  HREF="029393.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3	and Erlang R16B01 - Single Node and Cluster Node</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Throughput%20observation%20with%20RabbitMQ-3.1.3%0A%09and%20Erlang%20R16B01%20-%20Single%20Node%20and%20Cluster%20Node&In-Reply-To=%3C032B5CE5-5D1E-402A-A4DF-90D0AF66883B%40gopivotal.com%3E"
       TITLE="[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3	and Erlang R16B01 - Single Node and Cluster Node">mklishin at gopivotal.com
       </A><BR>
    <I>Fri Aug 16 16:45:46 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029386.html">[rabbitmq-discuss] Fwd: Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
        <LI>Next message: <A HREF="029393.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29392">[ date ]</a>
              <a href="thread.html#29392">[ thread ]</a>
              <a href="subject.html#29392">[ subject ]</a>
              <a href="author.html#29392">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Priyanki Vashi:

&gt;<i> content header = 88 bytes ( does not show any direct info so not sure)
</I>&gt;<i> basic.publish frame = 85 bytes ( shows details of queue, exchange, routing key etc) 
</I>&gt;<i> content body = 137 bytes ( in this my payload is 100 bytes of string + 37 bytes might be checksum etc.)
</I>&gt;<i> basic.ack = 87 bytes (shows delivery tag number) 
</I>&gt;<i> 
</I>&gt;<i> so from this I interpreted as 297 bytes  non-payload + 100 bytes of actual payload = 397 total bytes for every message on wire. 
</I>&gt;<i> 
</I>&gt;<i> Is this not normal ? 
</I>
I'd need to sit down and calculate how many bytes would a bare content header be packed into
but it's about right, except that

 * content header and body will vary depending on what you publish, what values the properties have, etc
 * basic.ack is optional, that is, you can publish without acks (which trades safety for improved throughput)

I'm slightly surprised that basic.publish frame is almost 90 bytes but it may be the case if e.g.
exchange name is unusually long.

&gt;<i> My publisher and consumer code looks like this. 
</I>
I assume it wasn't pasted by accident?

&gt;<i> 2) Regarding Interrupts and context switches point:
</I>&gt;<i> I agree and understand what you said about context switch but I wanted to bring this up since I felt my CPU was spending lot of time in doing context switches and that could be one of the reason that I don't get any higher throughput even if I increase number of producer and receiver. 
</I>
How many cores (logical) does your CPU have? Do you only run a publisher and RabbitMQ on this machine?

&gt;<i> 3) Regarding changing to faster clients like Java or amqpc:
</I>&gt;<i> My current concern is not that I don't have sufficinet throughout, I would like to understand given the fact later project need to use python based client and not java based client, would like to understand how system resources are used by rabbitmq. 
</I>
Seeing what kind of throughput you get with MulticastMain and/or amqpc will show you
how fast your hardware, network and RabbitMQ node can go. This can prove if you
are limited by your publisher's performance.

Then you can profile your publisher to see what takes time. I wasn't suggesting that you
should just use Java for your project, only to see if you can get a noticeably better
throughput with a different client.
--
MK

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130816/f1d5315a/attachment.pgp">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130816/f1d5315a/attachment.pgp</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029386.html">[rabbitmq-discuss] Fwd: Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
	<LI>Next message: <A HREF="029393.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29392">[ date ]</a>
              <a href="thread.html#29392">[ thread ]</a>
              <a href="subject.html#29392">[ subject ]</a>
              <a href="author.html#29392">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
