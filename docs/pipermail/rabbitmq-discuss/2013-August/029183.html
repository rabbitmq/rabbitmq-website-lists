<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20fail%20upgrade%20from%203.1.3%20to%203.1.4&In-Reply-To=%3C5203B2FB.2010707%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029178.html">
   <LINK REL="Next"  HREF="029184.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20fail%20upgrade%20from%203.1.3%20to%203.1.4&In-Reply-To=%3C5203B2FB.2010707%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4">simon at rabbitmq.com
       </A><BR>
    <I>Thu Aug  8 16:02:19 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029178.html">[rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4
</A></li>
        <LI>Next message: <A HREF="029184.html">[rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29183">[ date ]</a>
              <a href="thread.html#29183">[ thread ]</a>
              <a href="subject.html#29183">[ subject ]</a>
              <a href="author.html#29183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You can pull records out of Mnesia, but bear in mind that messages are 
stored in RabbitMQ's message store, not Mnesia. And really RabbitMQ is 
the only thing that can read that in a practical sense.

Cheers, Simon

On 08/08/2013 1:08PM, Guillaume Vernat wrote:
&gt;<i> Ok. I will try and let you know...
</I>&gt;<i>
</I>&gt;<i> And my other question is there a way to export datas from mnesia db ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2013/8/8 Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;&gt;
</I>&gt;<i>
</I>&gt;<i>     Hi.
</I>&gt;<i>
</I>&gt;<i>     It looks like we managed to release a version 3.1.4 which is not
</I>&gt;<i>     compatible with other 3.1.x versions in the same cluster. Damn.
</I>&gt;<i>
</I>&gt;<i>     So if you upgrade *all* the nodes in the cluster to 3.1.4, and
</I>&gt;<i>     restore the /var/lib/rabbitmq/mnesia on all the nodes, then things
</I>&gt;<i>     should work.
</I>&gt;<i>
</I>&gt;<i>     Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     On 08/08/2013 11:54AM, Guillaume Vernat wrote:
</I>&gt;<i>
</I>&gt;<i>         Hy Simon,
</I>&gt;<i>
</I>&gt;<i>         I really needed this cluster up. So, after making a copy of
</I>&gt;<i>         /var/lib/rabbitmq/mnesia I rebuild cluster.
</I>&gt;<i>         Now it's ok going on 3.1.4
</I>&gt;<i>
</I>&gt;<i>         How can I export messages from the copy in order to have them
</I>&gt;<i>         back in
</I>&gt;<i>         the cluster ?
</I>&gt;<i>
</I>&gt;<i>         Guillaume VERNAT
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         2013/8/8 Guillaume Vernat &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">verenate at verenate.com</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">verenate at verenate.com</A>&gt;
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">verenate at verenate.com</A> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">verenate at verenate.com</A>&gt;&gt;__&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>              Hy Simmons, thank you for your answer.
</I>&gt;<i>
</I>&gt;<i>              The cluster was : amqp105/amqp107 and amqp108 (ram). Main
</I>&gt;<i>         node is
</I>&gt;<i>              105 and I stated update with it.
</I>&gt;<i>              107 and 108 were runnning during update. I join the log file
</I>&gt;<i>              starting errors where :
</I>&gt;<i>
</I>&gt;<i>              Error description:
</I>&gt;<i>                  {error,{incompatible_bytecode,__&quot;Incompatible Erlang
</I>&gt;<i>         bytecode
</I>&gt;<i>              found on nodes&quot;}}
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>              2013/8/8 Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
</I>&gt;<i>              &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;&gt;&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                  Huh. You should not need to stop the cluster to do a minor
</I>&gt;<i>                  version upgrade like that. What error are you seeing?
</I>&gt;<i>
</I>&gt;<i>                  Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                  On 08/08/2013 9:25AM, Guillaume Vernat wrote:
</I>&gt;<i>
</I>&gt;<i>                      Hy,
</I>&gt;<i>
</I>&gt;<i>                      I try to up upgrade a cluster from 3.1.3 to 3.1.4
</I>&gt;<i>         on debian
</I>&gt;<i>                      wheezy.
</I>&gt;<i>                      apt-get update
</I>&gt;<i>                      apt-get dist-upgrade
</I>&gt;<i>
</I>&gt;<i>                      but upgrade fail because I did not stop the cluster
</I>&gt;<i>         nodes :(
</I>&gt;<i>                      I finally stop the other cluster nodes but it was
</I>&gt;<i>         too late
</I>&gt;<i>                      for the first
</I>&gt;<i>                      one.
</I>&gt;<i>
</I>&gt;<i>                      How can I start back the first node ?
</I>&gt;<i>                      I already touch
</I>&gt;<i>
</I>&gt;<i>         /var/lib/rabbitmq/mnesia/&lt;____node&gt;/nodes_running_at_____shutdown,
</I>&gt;<i>
</I>&gt;<i>                      rabbit_serial, cluster_nodes.config but it fail again.
</I>&gt;<i>
</I>&gt;<i>                      Guillaume
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                      ___________________________________________________
</I>&gt;<i>                      rabbitmq-discuss mailing list
</I>&gt;<i>                      <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.__rabbi__tmq.com</A>
</I>&gt;<i>         &lt;<A HREF="http://rabbitmq.com">http://rabbitmq.com</A>&gt;
</I>&gt;<i>                      &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at __lists.rabbitmq.com</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
</I>&gt;<i>         <A HREF="https://lists.rabbitmq.com/____cgi-bin/mailman/listinfo/____rabbitmq-discuss">https://lists.rabbitmq.com/____cgi-bin/mailman/listinfo/____rabbitmq-discuss</A>
</I>&gt;<i>         &lt;<A HREF="https://lists.rabbitmq.com/__cgi-bin/mailman/listinfo/__rabbitmq-discuss">https://lists.rabbitmq.com/__cgi-bin/mailman/listinfo/__rabbitmq-discuss</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         &lt;<A HREF="https://lists.rabbitmq.com/__cgi-bin/mailman/listinfo/__rabbitmq-discuss">https://lists.rabbitmq.com/__cgi-bin/mailman/listinfo/__rabbitmq-discuss</A>
</I>&gt;<i>         &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>                  --
</I>&gt;<i>                  Simon MacMullen
</I>&gt;<i>                  RabbitMQ, Pivotal
</I>&gt;<i>
</I>
-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029178.html">[rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4
</A></li>
	<LI>Next message: <A HREF="029184.html">[rabbitmq-discuss] fail upgrade from 3.1.3 to 3.1.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29183">[ date ]</a>
              <a href="thread.html#29183">[ thread ]</a>
              <a href="subject.html#29183">[ subject ]</a>
              <a href="author.html#29183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
