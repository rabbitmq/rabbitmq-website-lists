<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Throughput%20observation%20with%20RabbitMQ-3.1.3%0A%20and%20Erlang%20R16B01%20-%20Single%20Node%20and%20Cluster%20Node&In-Reply-To=%3C520E4EE7.4090401%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029393.html">
   <LINK REL="Next"  HREF="029395.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Throughput%20observation%20with%20RabbitMQ-3.1.3%0A%20and%20Erlang%20R16B01%20-%20Single%20Node%20and%20Cluster%20Node&In-Reply-To=%3C520E4EE7.4090401%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node">simon at rabbitmq.com
       </A><BR>
    <I>Fri Aug 16 17:10:15 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029393.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
        <LI>Next message: <A HREF="029395.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29394">[ date ]</a>
              <a href="thread.html#29394">[ thread ]</a>
              <a href="subject.html#29394">[ subject ]</a>
              <a href="author.html#29394">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm not completely sure where this discussion is going :-) but I'll 
pitch in anyway...

On 16/08/13 10:33, Priyanki Vashi wrote:
&gt;<i> In my wireshark traces, I see following frames for every message I send.
</I>&gt;<i> I have publisher confirm and consumer ack enabled with prefetch_count
</I>&gt;<i> not set.
</I>
Of course publisher confirm is optional. Also if the broker is busy 
enough it can start to issue acks with multiple=true. So you don't have 
to pay the cost of an ack for every message published.

&gt;<i> content header = 88 bytes ( does not show any direct info so not sure)
</I>&gt;<i> basic.publish frame = 85 bytes ( shows details of queue, exchange,
</I>&gt;<i> routing key etc)
</I>&gt;<i> content body = 137 bytes ( in this my payload is 100 bytes of string +
</I>&gt;<i> 37 bytes might be checksum etc.)
</I>
I don't see this much. Publishing with:

$ runjava.sh com.rabbitmq.examples.MulticastMain -C 1 -y0 -s 100

(i.e. publish 1 message of 100 bytes, don't consume anything, then stop)

I get a 255 byte (Ethernet) frame sent for the publish:

14 bytes Ethernet II header
20 bytes IPv4 header
32 bytes TCP header
59 bytes AMQP basic.publish method (variable size, including exchange 
name and routing key)
22 bytes content header (i.e. minimal basic.properties)
108 bytes content (100 bytes payload)

So I suspect there's something different with your client and / or test 
app. Note that things like whether you set anything in basic.properties 
can make quite a difference here, the AMQP encoding is designed to be 
shorter in the common case.

For most people the framing costs per message are not excessive. I don't 
think there is any particular waste there. If the costs are excessive 
for you, then MQTT would offer lower (but still present) per-message 
framing costs.

But you can't expect to send tiny messages and fill your network 
bandwidth anyway. Each message's framing has a fixed cost to decode, and 
then each message has a fixed cost for routing logic as well. (Even with 
fanout exchanges we still have to look up bindings after all.)

tl;dr: you'll notice much higher bandwidth utilisation if you start 
sending longer messages.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029393.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
	<LI>Next message: <A HREF="029395.html">[rabbitmq-discuss] Throughput observation with RabbitMQ-3.1.3 and Erlang R16B01 - Single Node and Cluster Node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29394">[ date ]</a>
              <a href="thread.html#29394">[ thread ]</a>
              <a href="subject.html#29394">[ subject ]</a>
              <a href="author.html#29394">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
