<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Crashes with Out Of Memory errors.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Crashes%20with%20Out%20Of%20Memory%20errors.&In-Reply-To=%3C11f752fb-bdef-47d8-b3bd-6c4160dd3791%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029323.html">
   <LINK REL="Next"  HREF="029334.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Crashes with Out Of Memory errors.</H1>
    <B>harel at thisisglow.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Crashes%20with%20Out%20Of%20Memory%20errors.&In-Reply-To=%3C11f752fb-bdef-47d8-b3bd-6c4160dd3791%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Crashes with Out Of Memory errors.">harel at thisisglow.com
       </A><BR>
    <I>Thu Aug 15 10:58:53 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029323.html">[rabbitmq-discuss] Management API and Access control.
</A></li>
        <LI>Next message: <A HREF="029334.html">[rabbitmq-discuss] RabbitMQ Crashes with Out Of Memory errors.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29324">[ date ]</a>
              <a href="thread.html#29324">[ thread ]</a>
              <a href="subject.html#29324">[ subject ]</a>
              <a href="author.html#29324">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, 

We've been using RabbitMQ Since early 1.x days and it has been a great and 
reliable queueing system. In the last few months we've started experiencing 
severe rabbit crashes, all due to 'out of memory' errors, where rabbit is 
killed by the kernel. We're using rabbit with celery in a python 
application.

We did go through some infrastructure changes when those crashes began - we 
moved to a different data centre and upgraded rabbit from 2.x to latest 3.x 
(as well as celery to the latest 3.x version). The spec of the machine 
running rabbit did not change though - the old and new servers had 16GB of 
ram and both had a few other things running on them - a few celery nodes 
and memcached (limited to 2GB). 
In our old setup, no matter how big the queues become rabbit stayed alive 
and well. In the new setup once memory usage spikes too high, rabbit dies. 

As an intermediate solution we've prepared a 32GB ram machine and will use 
the old 16GB one as a secondary (i.e., run rabbit in a cluster). However it 
is very important to us to understand why we are experiencing those crashes 
- adding hardware only solves the symptom but not the problem. 
Why does rabbit fail when memory is spiking? What causes the kernel to kill 
it? The error message is always a cryptic Out Of Memory and Killed by 
Kernel though I'm convinced there is something trivial we are missing in 
our new setup that causes the kernel to terminate rabbit in those cases. 

Any help is highly appreciated. 

Harel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130815/04db12d5/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130815/04db12d5/attachment.htm</A>&gt;
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029323.html">[rabbitmq-discuss] Management API and Access control.
</A></li>
	<LI>Next message: <A HREF="029334.html">[rabbitmq-discuss] RabbitMQ Crashes with Out Of Memory errors.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29324">[ date ]</a>
              <a href="thread.html#29324">[ thread ]</a>
              <a href="subject.html#29324">[ subject ]</a>
              <a href="author.html#29324">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
