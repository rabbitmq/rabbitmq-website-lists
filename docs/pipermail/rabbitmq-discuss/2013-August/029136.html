<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Question%20on%20RabbitMQ%20and%20file%20I/O%0A%09characteristics&In-Reply-To=%3C52021FD1.50906%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029120.html">
   <LINK REL="Next"  HREF="029354.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Question%20on%20RabbitMQ%20and%20file%20I/O%0A%09characteristics&In-Reply-To=%3C52021FD1.50906%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics">simon at rabbitmq.com
       </A><BR>
    <I>Wed Aug  7 11:22:09 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029120.html">[rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics
</A></li>
        <LI>Next message: <A HREF="029354.html">[rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29136">[ date ]</a>
              <a href="thread.html#29136">[ thread ]</a>
              <a href="subject.html#29136">[ subject ]</a>
              <a href="author.html#29136">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/08/13 18:42, Matt Pietrek wrote:
&gt;<i> The net effect is that messages 'ping-pong' between the two ioloop
</I>&gt;<i> threads as fast as possible. In the 'main' ioloop init, it sends an
</I>&gt;<i> initial message to kick things off.
</I>
&lt;snip&gt;

&gt;<i> I also have a global switch (USE_TRANSACTIONS) that lets me switch
</I>&gt;<i> between using transactions and not. When set, it adds tx_select() when
</I>&gt;<i> opening the channels and tx_commit after publishing messages. For the
</I>&gt;<i> tests I was running, I wasn't using transactions. If I do run with
</I>&gt;<i> transactions the numbers are very similar (surprising I know, but I
</I>&gt;<i> stepped through the code to verify that the tx_xxx calls are only made
</I>&gt;<i> when I intend them to be.)
</I>
Ah, I see. The thing is that transactions are quite lightweight in and 
of themselves, the reason they tend to slow things down is they form a 
barrier across which we can't coalesce writes / have to wait for a 
synchronous network round trip.

But your ping-pong test is doing the same thing! If it can't send 
another message until the previous one has been received, we can't 
coalesce together two writes. And it also ensures there's only one 
message on the wire at once.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029120.html">[rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics
</A></li>
	<LI>Next message: <A HREF="029354.html">[rabbitmq-discuss] Question on RabbitMQ and file I/O	characteristics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29136">[ date ]</a>
              <a href="thread.html#29136">[ thread ]</a>
              <a href="subject.html#29136">[ subject ]</a>
              <a href="author.html#29136">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
