<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq erlang client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbitmq%20erlang%20client&In-Reply-To=269388e30811061513j7a2fcbadrcfc99c20c78e06a5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001870.html">
   <LINK REL="Next"  HREF="001886.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq erlang client</H1>
    <B>Orion Henry</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20rabbitmq%20erlang%20client&In-Reply-To=269388e30811061513j7a2fcbadrcfc99c20c78e06a5%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] rabbitmq erlang client">orion.henry at gmail.com
       </A><BR>
    <I>Fri Nov  7 07:09:23 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001870.html">[rabbitmq-discuss] rabbitmq erlang client
</A></li>
        <LI>Next message: <A HREF="001886.html">[rabbitmq-discuss] rabbitmq erlang client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1872">[ date ]</a>
              <a href="thread.html#1872">[ thread ]</a>
              <a href="subject.html#1872">[ subject ]</a>
              <a href="author.html#1872">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Ben,

Thanks so much for talking the time to help me work through this...

I decided to start over and wrote a shell script that did the whole
install and test....  here it is.

----------------------------------------
#!/bin/sh

tar xzvf rabbitmq-server-1.4.0.tar.gz
cd rabbitmq-server-1.4.0 ; make ; cd ..
sudo mv rabbitmq-server-1.4.0 /opt/local/lib/erlang/lib/rabbitmq_server-1.4.0
LOG_BASE=/tmp SKIP_HEART=true SKIP_LOG_ARGS=true
MNESIA_DIR=/tmp/rabbitmq_rabbit_test_direct_mnesia
RABBIT_ARGS=&quot;-detached -pa ./ebin&quot; NODENAME=rabbit_test_direct
/opt/local/lib/erlang/lib/rabbitmq_server-1.4.0/scripts/rabbitmq-server

tar xzvf rabbitmq-erlang-client-3a9ce636e283.tar.gz
cd rabbitmq-erlang-client-3a9ce636e283; make; cd ..
sudo mv rabbitmq-erlang-client-3a9ce636e283
/opt/local/lib/erlang/lib/rabbitmq_client-3a9ce636e283

erl -noshell -eval 'network_client_test:test(),halt().'
----------------------------------------

I've attached its output to this email (its very long as a text file).
 It contains the 6 failed tests from network_client_test:test/0

Also I started doing a binary search of old releases of the client
software.  I found that very old versions worked and very new versions
didn't.  My search lead 16194802fe02 being the newest version of the
client to pass the tests as per my install script.  I'm working off
this build now.


On Thu, Nov 6, 2008 at 6:13 PM, Ben Hood &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">0x6e6562 at gmail.com</A>&gt; wrote:
&gt;<i> [Orion|Henry],
</I>&gt;<i>
</I>&gt;<i> On Thu, Nov 6, 2008 at 9:19 PM, Orion Henry &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">orion.henry at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> My test code looks like this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> test_client() -&gt;
</I>&gt;&gt;<i>    io:format(&quot;--- begin~n&quot;),
</I>&gt;&gt;<i>    Connection =
</I>&gt;&gt;<i> amqp_connection:start_link(&quot;mylogin&quot;,&quot;mypass&quot;,&quot;127.0.0.1&quot;,&lt;&lt;&quot;/myvhost&quot;&gt;&gt;),
</I>&gt;&gt;<i>    io:format(&quot;--- got Connection = ~p.~n&quot;,[Connection]),
</I>&gt;&gt;<i>    Channel = amqp_connection:open_channel(Connection),
</I>&gt;&gt;<i>    io:format(&quot;--- got Channel = ~p.~n&quot;,[Channel]).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> this seems to work ok but I get a &quot;Have a look into this one: closed&quot;
</I>&gt;&gt;<i> message a split second later.   If I add anymore code, such as a
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    X2 = lib_amqp:declare_exchange(Channel, &lt;&lt;&quot;abc&quot;&gt;&gt;),
</I>&gt;<i>
</I>&gt;<i> I've run your test code with the client version you specified and it
</I>&gt;<i> seems fine :-(
</I>&gt;<i>
</I>&gt;<i> The error log you are seeing &quot;Have a look into this one: closed&quot;
</I>&gt;<i> indicates that the TCP connection between the client and the broker
</I>&gt;<i> has been closed for some reason.
</I>&gt;<i>
</I>&gt;<i> Maybe you can elaborate on your setup, like how you installed Rabbit,
</I>&gt;<i> the client and look into the server logs.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> I'm currently using erlang client 3a9ce636e283 and rabbitmq_server
</I>&gt;&gt;<i> 200803291005.  That said I have not been able to get the erlang make
</I>&gt;&gt;<i> all_tests work against the rabbitmq server.
</I>&gt;<i>
</I>&gt;<i> What do you get when you run network_client_test:test/0 ?
</I>&gt;<i>
</I>&gt;<i> Ben
</I>&gt;<i>
</I>-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: erlang_client_output.txt
Url: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20081107/3a50eaa1/attachment.txt">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20081107/3a50eaa1/attachment.txt</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001870.html">[rabbitmq-discuss] rabbitmq erlang client
</A></li>
	<LI>Next message: <A HREF="001886.html">[rabbitmq-discuss] rabbitmq erlang client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1872">[ date ]</a>
              <a href="thread.html#1872">[ thread ]</a>
              <a href="subject.html#1872">[ subject ]</a>
              <a href="author.html#1872">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
