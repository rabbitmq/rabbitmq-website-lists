<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Last value cache for pub/sub pattern
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Last%20value%20cache%20for%20pub/sub%20pattern&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001878.html">
   <LINK REL="Next"  HREF="001885.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Last value cache for pub/sub pattern</H1>
    <B>Bill Soudan</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Last%20value%20cache%20for%20pub/sub%20pattern&In-Reply-To="
       TITLE="[rabbitmq-discuss] Last value cache for pub/sub pattern">bill at soudan.net
       </A><BR>
    <I>Fri Nov  7 16:08:33 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001878.html">[rabbitmq-discuss] IOExceptions and the java client api
</A></li>
        <LI>Next message: <A HREF="001885.html">[rabbitmq-discuss] Last value cache for pub/sub pattern
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1880">[ date ]</a>
              <a href="thread.html#1880">[ thread ]</a>
              <a href="subject.html#1880">[ subject ]</a>
              <a href="author.html#1880">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I see in the FAQ that support for a last value cache is planned:

<A HREF="http://www.rabbitmq.com/faq.html#last-message-on-topic">http://www.rabbitmq.com/faq.html#last-message-on-topic</A>

I'd like to use AMQP and I need this feature, so I'm going to take a crack at implementing it.

I do have one question though:  isn't there a race with the described implementation?  It seems possible to me that a new message may arrive from the bound exchange before the 'last-value' cache service responds with the most recent value.  Yes, I could fix this with some some of timestamp value or sequence value, but I would rather not push that responsibility onto the client.

Another idea: provide a new exchange type, 'x-rabbitmq.last-value-topic', which would store the most recent message published for each topic in an Mnesia table.  During exchange.bind, the value in the cache would be retrieved and delivered to the queue immediately.  If no cached value was present, a special 'no value' message would be delivered instead.  Thoughts?  I am relatively new to both AMQP and RabbitMQ, so I'd appreciate any guidance here.

Thanks,
Bill


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001878.html">[rabbitmq-discuss] IOExceptions and the java client api
</A></li>
	<LI>Next message: <A HREF="001885.html">[rabbitmq-discuss] Last value cache for pub/sub pattern
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1880">[ date ]</a>
              <a href="thread.html#1880">[ thread ]</a>
              <a href="subject.html#1880">[ subject ]</a>
              <a href="author.html#1880">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
