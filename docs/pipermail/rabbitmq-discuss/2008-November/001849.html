<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] question about cluster failover
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20question%20about%20cluster%20failover&In-Reply-To=167204d20811031348l70c2ce79ra31f397582dff815%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001846.html">
   <LINK REL="Next"  HREF="001857.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] question about cluster failover</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20question%20about%20cluster%20failover&In-Reply-To=167204d20811031348l70c2ce79ra31f397582dff815%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] question about cluster failover">0x6e6562 at gmail.com
       </A><BR>
    <I>Mon Nov  3 23:42:33 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001846.html">[rabbitmq-discuss] question about cluster failover
</A></li>
        <LI>Next message: <A HREF="001857.html">[rabbitmq-discuss] question about cluster failover
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1849">[ date ]</a>
              <a href="thread.html#1849">[ thread ]</a>
              <a href="subject.html#1849">[ subject ]</a>
              <a href="author.html#1849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Anonymous,

On Mon, Nov 3, 2008 at 9:48 PM, Alexis Richardson
&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis.richardson at cohesiveft.com</A>&gt; wrote:
&gt;<i> What host parameter do I specify in ConnectionFactory API?
</I>
The host name or IP address of one of the brokers in the cluster. DNS
round robins may be a suitable strategy in this scenario.

There is no transparent failover mechanism in the Java client. For
architectural reasons, this problem *should* be handled by higher
level application or supervision code. Although this thread
(<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2008-October/002105.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2008-October/002105.html</A>)
centers around the Erlang client, the reasoning is analogous for the
Java client.

&gt;<i> Assume subscriber application creates a number of subscriptions and
</I>&gt;<i> publisher application publishes on them. One of the hosts in the
</I>&gt;<i> cluster goes down. Is this transparent to my Java applications?
</I>
Not from the client library perspective, as indicated above.

&gt;<i> Are
</I>&gt;<i> the subscriptions preserved on the second host in the cluster?
</I>
No, the subscriptions are local to the queue process, which may have
died if the queue resides on the node that died. There is a concept of
persistent sessions in 0-10, but I have no knowledge of this version.

&gt;<i> Assume I have many publishers messaging with many consumers at some
</I>&gt;<i> constant rate for each publisher. Will adding hosts to the cluster
</I>&gt;<i> increase the capacity of the system linearly in terms of max number of
</I>&gt;<i> consumers and producers? Can you explain?
</I>
I am not aware of any empirical evidence about Rabbit that could
support such a claim.

However, by clustering, you can spread the load of ingress routing. On
egress, queues are not load balanced, meaning that queue entities
reside on one particular node, so in a pathological scenario, where
the entire message load is routed to one particular queue, clustering
will balance not balance this out. Wisely chosen routing keys or a
custom exchange may be able to solve this.

I recently answered a question that is related to this - the prospect
of a custom load balancing exchange in a global scale scenario - see
<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2008-October/002136.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2008-October/002136.html</A>

As indicated in that thread, at global scale you may face the eventual
consistency dilemma.

But just to make sure that I understand your question correctly, are
you primarily interested in load balancing end to end message routing
or are you more concerned about the maximum number of clients that can
connect to the cluster (as indicated in your question)?

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001846.html">[rabbitmq-discuss] question about cluster failover
</A></li>
	<LI>Next message: <A HREF="001857.html">[rabbitmq-discuss] question about cluster failover
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1849">[ date ]</a>
              <a href="thread.html#1849">[ thread ]</a>
              <a href="subject.html#1849">[ subject ]</a>
              <a href="author.html#1849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
