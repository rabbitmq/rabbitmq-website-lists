<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Flow Control
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Flow%20Control&In-Reply-To=269388e30811100936m22335278lb21c0c3ae18228b0%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001944.html">
   <LINK REL="Next"  HREF="001951.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Flow Control</H1>
    <B>Edwin Fine</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Flow%20Control&In-Reply-To=269388e30811100936m22335278lb21c0c3ae18228b0%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Flow Control">rabbitmq-discuss_efine at usa.net
       </A><BR>
    <I>Mon Nov 10 18:56:46 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001944.html">[rabbitmq-discuss] Flow Control
</A></li>
        <LI>Next message: <A HREF="001951.html">[rabbitmq-discuss] Flow Control
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1946">[ date ]</a>
              <a href="thread.html#1946">[ thread ]</a>
              <a href="subject.html#1946">[ subject ]</a>
              <a href="author.html#1946">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> &gt; == 8-Nov-2008::20:08:59 == ERROR -  emulator
</I>&gt;<i> &gt; Error in process &lt;0.191.0&gt; on node '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">xhg_rel at ender</A>' with exit value:
</I>&gt;<i> &gt; {badarg,[{erlang,list_to_binary,[{frame_rec,&lt;&lt;217
</I>&gt;<i> &gt; bytes&gt;&gt;,1226192940,0,active,ok,0,undefined,0,&lt;&lt;33
</I>&gt;<i> &gt;
</I>&gt;<i> bytes&gt;&gt;}]},{rabbit_binary_generator,create_frame,3},{rabbit_binary_generator,build_content_frames,5},{rabbit_binary_generator,build_simple_content_frames...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That is a fair point. May I suggest that we let the application choose
</I>&gt;<i> what it wants to do - adding an equivalent call command would be
</I>&gt;<i> trivial. What do you think?
</I>&gt;<i>
</I>
I think that's a very fair compromise.


&gt;<i> &gt; What I was trying to describe was having a gen_server or gen_fsm that has
</I>&gt;<i> a
</I>&gt;<i> &gt; clause something like this;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; handle_info(#'channel.flow'{active = false}, State) -&gt;
</I>&gt;<i> &gt;     {noreply, State#state{channel_flow = false}};
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; handle_info(#'channel.flow'{active = true}, State) -&gt;
</I>&gt;<i> &gt;     {noreply, State#state{channel_flow = true}};
</I>&gt;<i>
</I>&gt;<i> Sure, but this is all on the receiving process' side, so whether it
</I>&gt;<i> handles it as a gen_server or as a plain jane receive block *should*
</I>&gt;<i> be irrelevant. Furthermore, the receiving process may just ignore the
</I>&gt;<i> notification or it may not register itself in the first place.
</I>&gt;<i>
</I>&gt;<i> So I think the more important side of things is how the channel
</I>&gt;<i> process propagates the event that it receives from the broker.
</I>&gt;<i>
</I>&gt;<i> And this is what I have done - when the amqp_channel receives the
</I>&gt;<i> #'channel.flow'{active = false} from the broker, it sends the
</I>&gt;<i> registered listener a pause atom - in the reverse it sends it a resume
</I>&gt;<i> atom.
</I>&gt;<i>
</I>&gt;<i> Hence what you are suggesting is equivalent to what I have already done :-)
</I>

So does that mean that when a consumer wants to perform a channel.flow,
there will be a call made available on the channel, say
amqp_channel:flow(true|false)? Otherwise, if the consumer sends a
channel.flow command directly, it is inconsistent on an API level with the
producer, which only receives  pause and resume atoms. (a) Do you agree and
(b) How do you plan to handle that side of it?

Is this a re-transmission issue in your mail ;-)

No, it's a re-transmission issue in my brain :)

Ed
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20081110/8437835d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20081110/8437835d/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001944.html">[rabbitmq-discuss] Flow Control
</A></li>
	<LI>Next message: <A HREF="001951.html">[rabbitmq-discuss] Flow Control
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1946">[ date ]</a>
              <a href="thread.html#1946">[ thread ]</a>
              <a href="subject.html#1946">[ subject ]</a>
              <a href="author.html#1946">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
