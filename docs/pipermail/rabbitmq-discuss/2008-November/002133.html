<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Strange behavior found under Mac OS X
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Strange%20behavior%20found%20under%20Mac%20OS%20X&In-Reply-To=19728F05-A125-46A9-9D16-F39DC8F2A903%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002132.html">
   <LINK REL="Next"  HREF="002134.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Strange behavior found under Mac OS X</H1>
    <B>Andres Rodriguez</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Strange%20behavior%20found%20under%20Mac%20OS%20X&In-Reply-To=19728F05-A125-46A9-9D16-F39DC8F2A903%40gmail.com"
       TITLE="[rabbitmq-discuss] Strange behavior found under Mac OS X">andresr83 at gmail.com
       </A><BR>
    <I>Mon Nov 24 03:57:08 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002132.html">[rabbitmq-discuss] Strange behavior found under Mac OS X
</A></li>
        <LI>Next message: <A HREF="002134.html">[rabbitmq-discuss] Strange behavior found under Mac OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2133">[ date ]</a>
              <a href="thread.html#2133">[ thread ]</a>
              <a href="subject.html#2133">[ subject ]</a>
              <a href="author.html#2133">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Additional info, Rabbitmq logs:

=CRASH REPORT==== 19-Nov-2008::17:31:58 ===
   crasher:
     pid: &lt;0.217.0&gt;
     registered_name: []
     exception error: bad argument in an arithmetic expression
       in function  rabbit_load:pick/0
       in call from rabbit_reader:compute_redirects/1
       in call from rabbit_reader:handle_method0/2
       in call from rabbit_reader:handle_method0/3
       in call from rabbit_reader:handle_input/3
       in call from rabbit_reader:mainloop/3
       in call from rabbit_reader:start_connection/3
     initial call: rabbit_reader:init(&lt;0.185.0&gt;)
     ancestors: [rabbit_tcp_client_sup,rabbit_sup,&lt;0.81.0&gt;]
     messages: []
     links: [#Port&lt;0.277&gt;,&lt;0.185.0&gt;]
     dictionary: []
     trap_exit: true
     status: running
     heap_size: 987
     stack_size: 23
     reductions: 706
   neighbours:

=SUPERVISOR REPORT==== 19-Nov-2008::17:31:58 ===
      Supervisor: {local,rabbit_tcp_client_sup}
      Context:    child_terminated
      Reason:     badarith
      Offender:   [{pid,&lt;0.217.0&gt;},
                   {name,tcp_client},
                   {mfa,{rabbit_reader,start_link,[]}},
                   {restart_type,temporary},
                   {shutdown,brutal_kill},
                   {child_type,worker}]


=INFO REPORT==== 19-Nov-2008::17:28:01 ===
accepted TCP connection on 0.0.0.0:5672 from 127.0.0.1:56603

=INFO REPORT==== 19-Nov-2008::17:28:01 ===
starting TCP connection &lt;0.212.0&gt; from 127.0.0.1:56603

=ERROR REPORT==== 19-Nov-2008::17:28:01 ===
Error in process &lt;0.195.0&gt; on node '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at andres-rodriguezs-macbook</A>'  
with exit value: {{badmatch,{error,{fread,float}}}, 
[{cpu_sup,get_uint32_measurement,2},{cpu_sup,measurement_server_loop, 
1}]}


=INFO REPORT==== 19-Nov-2008::17:28:06 ===
closing TCP connection &lt;0.212.0&gt; from 127.0.0.1:56603



On Nov 23, 2008, at 10:54 PM, Andres Rodriguez wrote:

&gt;<i> Hi, I found something pretty interesting when trying to run any kind  
</I>&gt;<i> of AMQP client under Max OS X. I tried with java, python and ruby  
</I>&gt;<i> clients and none of them were working.
</I>&gt;<i>
</I>&gt;<i> Suspecting it could be my Rabbitmq or Erlang installs I tried  
</I>&gt;<i> different setups:
</I>&gt;<i>
</I>&gt;<i> * Erlang from source and macports
</I>&gt;<i> * Rabbitmq from source, tarball and macports
</I>&gt;<i>
</I>&gt;<i> Same result with any combination.
</I>&gt;<i>
</I>&gt;<i> With the help of tmm1 (AMQP client ruby gem creator) we discovered  
</I>&gt;<i> that in line 67 of rabbitmq-server:
</I>&gt;<i>
</I>&gt;<i>    -os_mon start_cpu_sup true \
</I>&gt;<i>
</I>&gt;<i> Changing start_cpu_sup to false:
</I>&gt;<i>
</I>&gt;<i>    -os_mon start_cpu_sup false \
</I>&gt;<i>
</I>&gt;<i> made everything to work.
</I>&gt;<i>
</I>&gt;<i> Now my Rabbitmq broker is running pretty nice.
</I>&gt;<i>
</I>&gt;<i> Since I'm a newbie in these Erlang topics I wanted to share this  
</I>&gt;<i> info and would like to know if someone expert at this subject could  
</I>&gt;<i> identify an incompatibility in my machine's hardware since I already  
</I>&gt;<i> found out that this cpu_sup thing is related to the processor (<A HREF="http://www.erlang.org/doc/man/cpu_sup.html">http://www.erlang.org/doc/man/cpu_sup.html</A> 
</I>&gt;<i> ).
</I>&gt;<i>
</I>&gt;<i> FWIW, I have a white macbook with a 2.4GHz Core 2 Duo (T8300).
</I>&gt;<i>
</I>&gt;<i> Thanks a lot!
</I>&gt;<i>
</I>&gt;<i> Andres.
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002132.html">[rabbitmq-discuss] Strange behavior found under Mac OS X
</A></li>
	<LI>Next message: <A HREF="002134.html">[rabbitmq-discuss] Strange behavior found under Mac OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2133">[ date ]</a>
              <a href="thread.html#2133">[ thread ]</a>
              <a href="subject.html#2133">[ subject ]</a>
              <a href="author.html#2133">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
