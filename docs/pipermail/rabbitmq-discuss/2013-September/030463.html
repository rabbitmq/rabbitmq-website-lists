<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumer slows down (a lot) after producer exceeds a certain publish rate, why?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20slows%20down%20%28a%20lot%29%20after%20producer%0A%20exceeds%20a%20certain%20publish%20rate%2C%20why%3F&In-Reply-To=%3CCABMzP9N79aMX3o0BsoYWApkWY1KBqAtPmaqozj05fD3BZfiecw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030521.html">
   <LINK REL="Next"  HREF="030503.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumer slows down (a lot) after producer exceeds a certain publish rate, why?</H1>
    <B>Zhibo Wei</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20slows%20down%20%28a%20lot%29%20after%20producer%0A%20exceeds%20a%20certain%20publish%20rate%2C%20why%3F&In-Reply-To=%3CCABMzP9N79aMX3o0BsoYWApkWY1KBqAtPmaqozj05fD3BZfiecw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Consumer slows down (a lot) after producer exceeds a certain publish rate, why?">zweicmu at gmail.com
       </A><BR>
    <I>Fri Sep 27 08:44:07 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030521.html">[rabbitmq-discuss] Can one consumer listen to 2 queues
</A></li>
        <LI>Next message: <A HREF="030503.html">[rabbitmq-discuss] Consumer slows down (a lot) after producer exceeds a certain publish rate, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30463">[ date ]</a>
              <a href="thread.html#30463">[ thread ]</a>
              <a href="subject.html#30463">[ subject ]</a>
              <a href="author.html#30463">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>3.15 rabbitmq-server
3.15 java-client (consumer)
3.04 erlang (producer)
ec2 m1.large
1 durable queue. no exchange.
Producer has 5 connections, each connection holds 20 channels.
Consumer has only 1 connection, who holds 20 channels, autoack = true.

If the publish rate is equal or below 15000msgs/sec, then the consumer can
hold it up (Queue never grows). However, if the publish rate exceeds
15,000, say 18,000 msgs/sec, then the delivery rate will drop to
400~2000/sec, then queue starts paging, blocks producer, and then
everything crashes.

The CPU and memory usages are just fine, but I'm not sure what else could
cause such problem. Bandwidth? Socket buffer size?

Anyone saw this kind of issue before? Any clues? Any other things I should
check?

Thanks,
Zhibo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130927/227e7e42/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130927/227e7e42/attachment.htm</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030521.html">[rabbitmq-discuss] Can one consumer listen to 2 queues
</A></li>
	<LI>Next message: <A HREF="030503.html">[rabbitmq-discuss] Consumer slows down (a lot) after producer exceeds a certain publish rate, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30463">[ date ]</a>
              <a href="thread.html#30463">[ thread ]</a>
              <a href="subject.html#30463">[ subject ]</a>
              <a href="author.html#30463">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
