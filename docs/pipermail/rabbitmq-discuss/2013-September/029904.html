<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java/dotnet drivers short-string field type
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java/dotnet%20drivers%20short-string%20field%20type&In-Reply-To=%3C52299BC9.4010108%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029901.html">
   <LINK REL="Next"  HREF="029905.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java/dotnet drivers short-string field type</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java/dotnet%20drivers%20short-string%20field%20type&In-Reply-To=%3C52299BC9.4010108%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Java/dotnet drivers short-string field type">simon at rabbitmq.com
       </A><BR>
    <I>Fri Sep  6 10:09:29 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029901.html">[rabbitmq-discuss] Scaling with Queues: Redis,	RabbitMQ and Openresty/Lua
</A></li>
        <LI>Next message: <A HREF="029905.html">[rabbitmq-discuss] ANN Bunny 0.10.6 is released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29904">[ date ]</a>
              <a href="thread.html#29904">[ thread ]</a>
              <a href="subject.html#29904">[ subject ]</a>
              <a href="author.html#29904">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>See:

<A HREF="http://www.rabbitmq.com/amqp-0-9-1-errata.html#section_3">http://www.rabbitmq.com/amqp-0-9-1-errata.html#section_3</A>

In short, the spec was changed at the very last minute before release, 
breaking existing implementations. Rather than break all the clients at 
that point we stuck with the existing meanings.

It's certainly unfortunate.

As a result we try to avoid using these types for headers we add to 
messages.

Cheers, Simon

On 06/09/2013 12:48AM, Fawad Halim wrote:
&gt;<i> Hi Simon,
</I>&gt;<i>    I'm emailing you because I noticed a little discrepancy between the
</I>&gt;<i> AMQP 0.9.1 spec and how the Java/dotnet drivers seems to work. I
</I>&gt;<i> apologize in advance if you're not the correct person for this.
</I>&gt;<i>
</I>&gt;<i>   I was looking at the drivers to try to figure out the correct behavior
</I>&gt;<i> of a consumer of the .NET library (NServiceBus). From the spec
</I>&gt;<i> specification section 4.2.1, field values with kind 's' should be
</I>&gt;<i> treated as short-strings (an octet worth of string data).
</I>&gt;<i> However, the Java driver
</I>&gt;<i> (<A HREF="https://github.com/rabbitmq/rabbitmq-java-client/blob/master/src/com/rabbitmq/client/impl/ValueReader.java#L194">https://github.com/rabbitmq/rabbitmq-java-client/blob/master/src/com/rabbitmq/client/impl/ValueReader.java#L194</A>)
</I>&gt;<i> and the .NET driver
</I>&gt;<i> (<A HREF="https://github.com/rabbitmq/rabbitmq-dotnet-client/blob/master/projects/client/RabbitMQ.Client/src/client/impl/WireFormatting.cs#L192">https://github.com/rabbitmq/rabbitmq-dotnet-client/blob/master/projects/client/RabbitMQ.Client/src/client/impl/WireFormatting.cs#L192</A>)
</I>&gt;<i> both seem to read the value of kind 's' as integers. Other random
</I>&gt;<i> third-party drivers I've been using like pika
</I>&gt;<i> (<A HREF="https://github.com/pika/pika/blob/master/pika/data.py#L192">https://github.com/pika/pika/blob/master/pika/data.py#L192</A>) or the
</I>&gt;<i> golang driver
</I>&gt;<i> (<A HREF="https://github.com/streadway/amqp/blob/master/read.go#L261">https://github.com/streadway/amqp/blob/master/read.go#L261</A>) on the
</I>&gt;<i> other interpret the values as strings like I thought they should be.
</I>&gt;<i>
</I>&gt;<i> Could you tell me which interpretation is correct?
</I>&gt;<i>
</I>&gt;<i> I'd really appreciate your help with this.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i> -fawad
</I>
-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029901.html">[rabbitmq-discuss] Scaling with Queues: Redis,	RabbitMQ and Openresty/Lua
</A></li>
	<LI>Next message: <A HREF="029905.html">[rabbitmq-discuss] ANN Bunny 0.10.6 is released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29904">[ date ]</a>
              <a href="thread.html#29904">[ thread ]</a>
              <a href="subject.html#29904">[ subject ]</a>
              <a href="author.html#29904">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
