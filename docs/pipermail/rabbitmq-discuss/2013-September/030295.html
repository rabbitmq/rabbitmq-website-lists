<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Can't Bind After Upgrading from 3.1.1 to 3.1.5
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Can%27t%20Bind%20After%20Upgrading%20from%203.1.1%20to%203.1.5&In-Reply-To=%3CCAHEpgBDSJYrjocFPxbcoehu1n_JtD7MLXtn9QK8tyeiYKMn8iQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030324.html">
   <LINK REL="Next"  HREF="030296.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Can't Bind After Upgrading from 3.1.1 to 3.1.5</H1>
    <B>Chris</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Can%27t%20Bind%20After%20Upgrading%20from%203.1.1%20to%203.1.5&In-Reply-To=%3CCAHEpgBDSJYrjocFPxbcoehu1n_JtD7MLXtn9QK8tyeiYKMn8iQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Can't Bind After Upgrading from 3.1.1 to 3.1.5">stuff at moesel.net
       </A><BR>
    <I>Fri Sep 20 18:14:12 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030324.html">[rabbitmq-discuss] Federation setup query
</A></li>
        <LI>Next message: <A HREF="030296.html">[rabbitmq-discuss] Can't Bind After Upgrading from 3.1.1 to	3.1.5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30295">[ date ]</a>
              <a href="thread.html#30295">[ thread ]</a>
              <a href="subject.html#30295">[ subject ]</a>
              <a href="author.html#30295">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello RabbitMQ gurus,

After upgrading a customer site from RabbitMQ 3.1.1 to 3.1.5 (on RHEL 6.2),
we had a few durable queues that did not seem to be working correctly (they
weren't receiving any messages).  It should be noted that this is a cluster
of 5 servers with queue mirroring set to exactly 2 nodes.

During troubleshooting, we deleted and recreated the queues.  After
creating the queues, we attempted to rebind them to the exchange (in the
web management GUI), but this always failed.

[In the following example, names have been changed to protect the
innocent].  After attempting to bind durable mirrored 'my.queue' to durable
direct exchange 'my.exchange' using routing key 'my.queue' (in vhost
'abc'), we get the following error:

NOT_FOUND - no binding my.queue between exchange 'my.exchange' in vhost
&gt;<i> 'abc' and queue 'my.queue' in vhost 'abc'
</I>

This behavior in the web console confirms the behavior we see when trying
to bind programmatically in our app (we get an AMQP 404 error).

Here is the kicker-- if we change the routing key by just one character, it
works flawlessly!  Or if we don't change anything, but add &quot;foo=bar&quot; to the
binding arguments, it also works!  So it seems that because we did this
binding in the past, and it was somehow corrupted, it won't allow us to
re-bind with the same arguments now.  As noted above, even after deleting
and re-creating the queue, it still won't let us do that one binding we
need.

Is there any way we can fix this easily without interrupting the customer
too much?  Or is it likely we will have to wipe mnesia on all the nodes and
rebuild the cluster (my fear is that this may be the only way)?

Is there anything I can or should do on my end to further debug /
investigate?

Thanks for your help!

-Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130920/55fae66e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130920/55fae66e/attachment.htm</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030324.html">[rabbitmq-discuss] Federation setup query
</A></li>
	<LI>Next message: <A HREF="030296.html">[rabbitmq-discuss] Can't Bind After Upgrading from 3.1.1 to	3.1.5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30295">[ date ]</a>
              <a href="thread.html#30295">[ thread ]</a>
              <a href="subject.html#30295">[ subject ]</a>
              <a href="author.html#30295">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
