<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20up%20and%20running%20but%0A%09connection_closed_abruptly&In-Reply-To=%3CCAAm3oPuNRVZVL_kPnrDmfQxk9kW5n8ax%3DBHD4vscacT-VWP6uw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029928.html">
   <LINK REL="Next"  HREF="029943.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly</H1>
    <B>Ken Henry</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20up%20and%20running%20but%0A%09connection_closed_abruptly&In-Reply-To=%3CCAAm3oPuNRVZVL_kPnrDmfQxk9kW5n8ax%3DBHD4vscacT-VWP6uw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly">kenhen93 at gmail.com
       </A><BR>
    <I>Fri Sep  6 18:20:05 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="029928.html">[rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly
</A></li>
        <LI>Next message: <A HREF="029943.html">[rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29942">[ date ]</a>
              <a href="thread.html#29942">[ thread ]</a>
              <a href="subject.html#29942">[ subject ]</a>
              <a href="author.html#29942">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Simon,

I am not trying to monitor rabbitmq. Rabbitmq is part of the new version of
Zenoss.

I setup my new Zenoss installation in a Veritas cluster that has a SAN and
VIP that fail back and forth between the hosts.

Zenoss and RabbitMQ work fine on Node A but not on Node B. I don't see any
difference in the setup from Node A to Node B.

If this were working right, I could failover to Node B and RabbitMQ would
allow Zenhub (a zenoss service) to connect to it. Zenhub logs tell me
RabbitMQ is refusing its connection.

Thank you for any help!

Cheers


On Fri, Sep 6, 2013 at 11:49 AM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:

&gt;<i> On 06/09/2013 3:51PM, Ken Henry wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Simon,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Anything else you can think of to troubleshoot more?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  You are essential saying that Zenoss is at fault?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I still don't think I am 100% sure what you are saying your problem is.
</I>&gt;<i> Are you saying:
</I>&gt;<i>
</I>&gt;<i> 1) Zenoss should be connecting to node A and node B to monitor them
</I>&gt;<i> 2) It should also be routing connections from clients to node A but not
</I>&gt;<i> node B since node A has not failed
</I>&gt;<i> 3) But you're seeing long-lived connections to node B, which shouldn't be
</I>&gt;<i> happening
</I>&gt;<i>
</I>&gt;<i> That's what I've understood from you.
</I>&gt;<i>
</I>&gt;<i> However, I've just Googled &quot;zenoss rabbitmq&quot; and they claim their plugin
</I>&gt;<i> monitors RabbitMQ by invoking rabbitmqctl over ssh. So I don't think that
</I>&gt;<i> adds up with what I've understood.
</I>&gt;<i>
</I>&gt;<i> So please can you explain what you expect to be happening, and why the
</I>&gt;<i> results you're seeing don't match your expectations?
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Fri, Sep 6, 2013 at 9:30 AM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     On 06/09/2013 2:23PM, Ken Henry wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Simon, thank you very much for your help!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Yes I figured that if my connection was closed those connections
</I>&gt;&gt;<i>         would
</I>&gt;&gt;<i>         not listed
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         I actually killed the connections yesterday and they kept coming
</I>&gt;&gt;<i>         back
</I>&gt;&gt;<i>         under different pids
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         I started the zenoss service that connects to rabbitmq and it
</I>&gt;&gt;<i>         looks like
</I>&gt;&gt;<i>         its trying to connect to a PID that does not exist which it
</I>&gt;&gt;<i>         sounds like
</I>&gt;&gt;<i>         from your e-mail that that is ok?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     The pid is effectively just a connection identifier in this case. So
</I>&gt;&gt;<i>     if the connections logging as &quot;closed_abruptly&quot; don't show up under
</I>&gt;&gt;<i>     &quot;rabbitmqctl list_connections&quot; I'd say you're good.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         sorry I am running a little slow this morning but I couldn't get
</I>&gt;&gt;<i>         that
</I>&gt;&gt;<i>         command to work all together but was able to just run it with
</I>&gt;&gt;<i>         pid option
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         rabbitmqctl list_connections zenoss localhost client_properties
</I>&gt;&gt;<i> pid
</I>&gt;&gt;<i>         Listing connections ...
</I>&gt;&gt;<i>         Error: {bad_argument,zenoss}
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     You don't need to make substitutions there - I mean literally
</I>&gt;&gt;<i>     &quot;rabbitmqctl list_connections user peer_host peer_port
</I>&gt;&gt;<i>     client_properties pid&quot;. That command means &quot;give me a listing with
</I>&gt;&gt;<i>     columns for user, peer host, etc&quot;. See
</I>&gt;&gt;<i>     <A HREF="http://www.rabbitmq.com/man/__**rabbitmqctl.1.man.html#list___**">http://www.rabbitmq.com/man/__**rabbitmqctl.1.man.html#list___**</A>
</I>&gt;&gt;<i> connections&lt;<A HREF="http://www.rabbitmq.com/man/__rabbitmqctl.1.man.html#list___connections">http://www.rabbitmq.com/man/__rabbitmqctl.1.man.html#list___connections</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     &lt;<A HREF="http://www.rabbitmq.com/man/**rabbitmqctl.1.man.html#list_**">http://www.rabbitmq.com/man/**rabbitmqctl.1.man.html#list_**</A>
</I>&gt;&gt;<i> connections&lt;<A HREF="http://www.rabbitmq.com/man/rabbitmqctl.1.man.html#list_connections">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html#list_connections</A>&gt;&gt;
</I>&gt;&gt;<i> for
</I>&gt;&gt;<i>     more details.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Is there anyway to turn on more logging?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Afraid not.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Cheers, Simon
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     --
</I>&gt;&gt;<i>     Simon MacMullen
</I>&gt;&gt;<i>     RabbitMQ, Pivotal
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, Pivotal
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130906/be67a710/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130906/be67a710/attachment.htm</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029928.html">[rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly
</A></li>
	<LI>Next message: <A HREF="029943.html">[rabbitmq-discuss] Rabbitmq up and running but	connection_closed_abruptly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29942">[ date ]</a>
              <a href="thread.html#29942">[ thread ]</a>
              <a href="subject.html#29942">[ subject ]</a>
              <a href="author.html#29942">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
