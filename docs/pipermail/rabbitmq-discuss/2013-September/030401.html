<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Clustering - just can't get it going
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20-%20just%20can%27t%20get%20it%20going&In-Reply-To=%3CCAMxG3ZOR%3DBULgWqdJhbFP0yzqWfyaBHPcDtPb4RkXoiWpcKjhA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030399.html">
   <LINK REL="Next"  HREF="030400.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Clustering - just can't get it going</H1>
    <B>Derek Wyatt</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20-%20just%20can%27t%20get%20it%20going&In-Reply-To=%3CCAMxG3ZOR%3DBULgWqdJhbFP0yzqWfyaBHPcDtPb4RkXoiWpcKjhA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Clustering - just can't get it going">derek at derekwyatt.org
       </A><BR>
    <I>Wed Sep 25 15:51:08 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030399.html">[rabbitmq-discuss] Clustering - just can't get it going
</A></li>
        <LI>Next message: <A HREF="030400.html">[rabbitmq-discuss] Clustering - just can't get it going
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30401">[ date ]</a>
              <a href="thread.html#30401">[ thread ]</a>
              <a href="subject.html#30401">[ subject ]</a>
              <a href="author.html#30401">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I forgot to mention that, sorry.  Everything is wide open.

*01*:~$ sudo iptables --list
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination


*02*:~$ sudo iptables --list
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination






On 25 September 2013 10:41, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:

&gt;<i> Are other ports firewalled? If so please read <A HREF="http://www.rabbitmq.com/**">http://www.rabbitmq.com/**</A>
</I>&gt;<i> clustering.html#firewall&lt;<A HREF="http://www.rabbitmq.com/clustering.html#firewall">http://www.rabbitmq.com/clustering.html#firewall</A>&gt;
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> On 25/09/13 15:36, Derek Wyatt wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Thanks Jason.  The cookies are the same.  Running anything from
</I>&gt;&gt;<i> rabbitmqctl to the remote host fails, unfortunately.  The list_queues
</I>&gt;&gt;<i> call fails to connect, the same as join_cluster.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As I indicated, the telnets all work just fine, so I'm stuck for what to
</I>&gt;&gt;<i> diagnose next.  Any ideas would be great.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 25 September 2013 09:57, Jason McIntosh &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mcintoshj at gmail.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mcintoshj at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Check your erlang cookie on both servers to make sure it matches I
</I>&gt;&gt;<i>     think it's in - /var/lib/rabbitmq/ - then you can use rabbitmqctl
</I>&gt;&gt;<i>     from one machine and see if you can connect to another to list
</I>&gt;&gt;<i>     queues.  I THINK that's rabbitmqctl -n &lt;servernode&gt; list_queues for
</I>&gt;&gt;<i>     example.  If both servers can talk to each other then it should be
</I>&gt;&gt;<i>     rabbitmqctl stop_app, join_cluster, start_app.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Jason
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     On Wed, Sep 25, 2013 at 8:50 AM, Derek Wyatt &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">derek at derekwyatt.org</A>
</I>&gt;&gt;<i>     &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">derek at derekwyatt.org</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         I've seen a number of people failing to get clustering running
</I>&gt;&gt;<i>         and, unfortunately, I can't get it going either.  Here's the
</I>&gt;&gt;<i>         summary of what I've got:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>           * Two nodes - RMQ1 and RMQ2
</I>&gt;&gt;<i>           * I can ping RMQ1 from RMQ2, and vice versa
</I>&gt;&gt;<i>           * I can telnet from RMQ1 to RMQ2:epmd, and vice versa
</I>&gt;&gt;<i>           * I can telnet from RMQ1 to RMQ2:amqp, and vice versa
</I>&gt;&gt;<i>           * The cookie file is identical, as is clear from the startup
</I>&gt;&gt;<i> INFO
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         My goal is to have RMQ2 join RMQ1 in a cluster.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         The servers are started using the init script in Ubuntu (i.e.
</I>&gt;&gt;<i>         service rabbitmq-server start).  This is different than the
</I>&gt;&gt;<i>         script at <A HREF="http://www.rabbitmq.com/**clustering.html&lt;http://www.rabbitmq.com/clustering.html">http://www.rabbitmq.com/**clustering.html&lt;http://www.rabbitmq.com/clustering.html</A>&gt;,
</I>&gt;&gt;<i> which says to
</I>&gt;&gt;<i>         start with &quot;rabbitmq-server -detached&quot;.  I've tried that and it
</I>&gt;&gt;<i>         doesn't seem to make any difference so I always use the init
</I>&gt;&gt;<i>         script instead.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         So, the script says to stop the RMQ2 server and then join the
</I>&gt;&gt;<i>         cluster.  The following transcript shows how well all this goes:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         02:~$ sudo rabbitmqctl stop_app
</I>&gt;&gt;<i>         Stopping node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RMQ2</A>' ...
</I>&gt;&gt;<i>         ...done.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         02:~$ sudo rabbitmqctl join_cluster --ram <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RMQ1</A>
</I>&gt;&gt;<i>         Clustering node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RMQ2</A>' with '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RMQ1</A>' ...
</I>&gt;&gt;<i>         Error: {cannot_discover_cluster,&quot;The nodes provided are either
</I>&gt;&gt;<i>         offline or not running&quot;}
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         However, as I said above, telnetting to the ports works just fine:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         02:~$ telnet RMQ1 epmd
</I>&gt;&gt;<i>         Trying &lt;ip address&gt;...
</I>&gt;&gt;<i>         Connected to RMQ1
</I>&gt;&gt;<i>         Escape character is '^]'.
</I>&gt;&gt;<i>         booger!
</I>&gt;&gt;<i>         Connection closed by foreign host.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         02:~$ telnet RMQ1 amqp
</I>&gt;&gt;<i>         Trying &lt;ip address&gt;...
</I>&gt;&gt;<i>         Connected to RMQ1
</I>&gt;&gt;<i>         Escape character is '^]'.
</I>&gt;&gt;<i>         booger!
</I>&gt;&gt;<i>         AMQPConnection closed by foreign host.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         I'm stuck for what else to test.  Does anyone know how to
</I>&gt;&gt;<i>         troubleshoot this thing further?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Thanks,
</I>&gt;&gt;<i>         Derek
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         ______________________________**_________________
</I>&gt;&gt;<i>         rabbitmq-discuss mailing list
</I>&gt;&gt;<i>         <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.</A>**rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i>         &lt;mailto:rabbitmq-discuss@**lists.rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>         <A HREF="https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**">https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**</A>
</I>&gt;&gt;<i> rabbitmq-discuss&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     --
</I>&gt;&gt;<i>     Jason McIntosh
</I>&gt;&gt;<i>     <A HREF="http://mcintosh.poetshome.com/**blog/&lt;http://mcintosh.poetshome.com/blog/">http://mcintosh.poetshome.com/**blog/&lt;http://mcintosh.poetshome.com/blog/</A>&gt;
</I>&gt;&gt;<i>     573-424-7612 &lt;tel:573-424-7612&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     ______________________________**_________________
</I>&gt;&gt;<i>     rabbitmq-discuss mailing list
</I>&gt;&gt;<i>     <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.</A>**rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i>     &lt;mailto:rabbitmq-discuss@**lists.rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>     <A HREF="https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**">https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**</A>
</I>&gt;&gt;<i> rabbitmq-discuss&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ______________________________**_________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.</A>**rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, Pivotal
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130925/ab4f5b1a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130925/ab4f5b1a/attachment.htm</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030399.html">[rabbitmq-discuss] Clustering - just can't get it going
</A></li>
	<LI>Next message: <A HREF="030400.html">[rabbitmq-discuss] Clustering - just can't get it going
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30401">[ date ]</a>
              <a href="thread.html#30401">[ thread ]</a>
              <a href="subject.html#30401">[ subject ]</a>
              <a href="author.html#30401">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
