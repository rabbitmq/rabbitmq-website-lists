<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Mirrored Queue Failover takes longer than expected
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Mirrored%20Queue%20Failover%20takes%20longer%20than%0A%20expected&In-Reply-To=%3C52445B5E.50105%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030454.html">
   <LINK REL="Next"  HREF="030464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Mirrored Queue Failover takes longer than expected</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Mirrored%20Queue%20Failover%20takes%20longer%20than%0A%20expected&In-Reply-To=%3C52445B5E.50105%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Mirrored Queue Failover takes longer than expected">simon at rabbitmq.com
       </A><BR>
    <I>Thu Sep 26 17:05:50 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030454.html">[rabbitmq-discuss] Mirrored Queue Failover takes longer than	expected
</A></li>
        <LI>Next message: <A HREF="030464.html">[rabbitmq-discuss] java.io.IOException,	when factory call newConnection function
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30455">[ date ]</a>
              <a href="thread.html#30455">[ thread ]</a>
              <a href="subject.html#30455">[ subject ]</a>
              <a href="author.html#30455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You should probably read <A HREF="http://www.rabbitmq.com/ha.html#flow-control">http://www.rabbitmq.com/ha.html#flow-control</A> 
and <A HREF="http://www.rabbitmq.com/nettick.html.">http://www.rabbitmq.com/nettick.html.</A>

In short, we have to treat the slave as slow (meaning we wait for it) 
until we have decided it is definitely down. You can configure how long 
that takes.

Cheers, Simon

On 26/09/2013 4:48PM, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">robin.cox at esendex.com</A> wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am currently testing out some RabbitMQ cluster configurations and have
</I>&gt;<i> come across some behaviour that is undesirable in an otherwise useful
</I>&gt;<i> set up.
</I>&gt;<i> The amount of time the cluster takes to promote a mirrored slave queue
</I>&gt;<i> to become the master seems quite long.
</I>&gt;<i>
</I>&gt;<i> I have a cluster with two instances of RabbitMQ sat behind a load
</I>&gt;<i> balancer in order to handle reconnection when one of the boxes fails.
</I>&gt;<i> I have a publisher publishing persistent messages to a durable mirrored
</I>&gt;<i> queue.
</I>&gt;<i> If one box dies, the publisher will attempt to reconnect via the load
</I>&gt;<i> balancer. The load balancer, knowing one box is down, directs the
</I>&gt;<i> traffic to the healthy RabbitMQ instance.
</I>&gt;<i> This reconnection is very fast, however, when attempting to publish to
</I>&gt;<i> the healthy RabbitMQ exceptions are thrown for a period of between 40-80
</I>&gt;<i> seconds before messages are published as normal again.
</I>&gt;<i>
</I>&gt;<i> Has anyone else experienced similar behaviour when using RabbitMQ
</I>&gt;<i> clustering in this way? Ideally, the failover time for my implementation
</I>&gt;<i> needs to be negligible.
</I>&gt;<i>
</I>&gt;<i> Having implemented this using both the .NET and Java SDKs I believe I
</I>&gt;<i> have ruled out the implementation of the SDKs being the cause.
</I>&gt;<i> I have also run tests that do not use the load balancer to be sure it
</I>&gt;<i> isn't the cause of the issue so my current understanding is that this
</I>&gt;<i> must be a limitation of RabbitMQ.
</I>&gt;<i>
</I>&gt;<i> If anyone has any knowledge they can share on this topic I would greatly
</I>&gt;<i> appreciate it.
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i>
</I>&gt;<i> Confidentiality: This e-mail (and any associated files) is intended only
</I>&gt;<i> for the use of the intended recipient and may contain information that
</I>&gt;<i> is confidential, subject to copyright or constitutes a trade secret. If
</I>&gt;<i> you are not the intended recipient you are hereby notified that any
</I>&gt;<i> disclosure, copying or distribution of this message, or files associated
</I>&gt;<i> with this message, is strictly prohibited. If you have received this
</I>&gt;<i> message in error, please notify us immediately by replying to the
</I>&gt;<i> message and then delete it from your computer. Messages sent to and from
</I>&gt;<i> us may be monitored. The views expressed in this message are those of
</I>&gt;<i> the author and do not necessarily represent the views of Esendex Ltd.
</I>&gt;<i>
</I>&gt;<i> Security: This e-mail and any attachments are believed to be free from
</I>&gt;<i> any virus but it is the responsibility of the recipient to ensure this
</I>&gt;<i> is so. E-mail is not a 100% secure communications medium. We recommend
</I>&gt;<i> you observe this when e-mailing us.
</I>&gt;<i>
</I>&gt;<i> Esendex Ltd is a limited company registered in the UK, with company
</I>&gt;<i> number 04217280 and having its registered office at 15 Warwick Road &#8226;
</I>&gt;<i> Stratford Upon Avon &#8226; Warwickshire &#8226; CV37 6YW.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>
-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030454.html">[rabbitmq-discuss] Mirrored Queue Failover takes longer than	expected
</A></li>
	<LI>Next message: <A HREF="030464.html">[rabbitmq-discuss] java.io.IOException,	when factory call newConnection function
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30455">[ date ]</a>
              <a href="thread.html#30455">[ thread ]</a>
              <a href="subject.html#30455">[ subject ]</a>
              <a href="author.html#30455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
