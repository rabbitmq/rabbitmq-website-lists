<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Mirrored Queue Failover takes longer than	expected
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Mirrored%20Queue%20Failover%20takes%20longer%20than%0A%09expected&In-Reply-To=%3Cf7d45644-bc0f-4726-beb6-a92246815e33%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030448.html">
   <LINK REL="Next"  HREF="030455.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Mirrored Queue Failover takes longer than	expected</H1>
    <B>robin.cox at esendex.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Mirrored%20Queue%20Failover%20takes%20longer%20than%0A%09expected&In-Reply-To=%3Cf7d45644-bc0f-4726-beb6-a92246815e33%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Mirrored Queue Failover takes longer than	expected">robin.cox at esendex.com
       </A><BR>
    <I>Thu Sep 26 16:48:24 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030448.html">[rabbitmq-discuss] How to check is some bind present or no?
</A></li>
        <LI>Next message: <A HREF="030455.html">[rabbitmq-discuss] Mirrored Queue Failover takes longer than expected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30454">[ date ]</a>
              <a href="thread.html#30454">[ thread ]</a>
              <a href="subject.html#30454">[ subject ]</a>
              <a href="author.html#30454">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I am currently testing out some RabbitMQ cluster configurations and have 
come across some behaviour that is undesirable in an otherwise useful set 
up.
The amount of time the cluster takes to promote a mirrored slave queue to 
become the master seems quite long.

I have a cluster with two instances of RabbitMQ sat behind a load balancer 
in order to handle reconnection when one of the boxes fails. 
I have a publisher publishing persistent messages to a durable mirrored 
queue.
If one box dies, the publisher will attempt to reconnect via the load 
balancer. The load balancer, knowing one box is down, directs the traffic 
to the healthy RabbitMQ instance.
This reconnection is very fast, however, when attempting to publish to the 
healthy RabbitMQ exceptions are thrown for a period of between 40-80 
seconds before messages are published as normal again.

Has anyone else experienced similar behaviour when using RabbitMQ 
clustering in this way? Ideally, the failover time for my implementation 
needs to be negligible. 

Having implemented this using both the .NET and Java SDKs I believe I have 
ruled out the implementation of the SDKs being the cause.
I have also run tests that do not use the load balancer to be sure it isn't 
the cause of the issue so my current understanding is that this must be a 
limitation of RabbitMQ.

If anyone has any knowledge they can share on this topic I would greatly 
appreciate it.

Cheers

-- 
Confidentiality: This e-mail (and any associated files) is intended only 
for the use of the intended recipient and may contain information that is 
confidential, subject to copyright or constitutes a trade secret. If you 
are not the intended recipient you are hereby notified that any disclosure, 
copying or distribution of this message, or files associated with this 
message, is strictly prohibited. If you have received this message in 
error, please notify us immediately by replying to the message and then 
delete it from your computer. Messages sent to and from us may be 
monitored. The views expressed in this message are those of the author and 
do not necessarily represent the views of Esendex Ltd.

Security: This e-mail and any attachments are believed to be free from any 
virus but it is the responsibility of the recipient to ensure this is so. 
E-mail is not a 100% secure communications medium. We recommend you observe 
this when e-mailing us.

Esendex Ltd is a limited company registered in the UK, with company number 
04217280 and having its registered office at 15 Warwick Road &#8226; Stratford 
Upon Avon &#8226; Warwickshire &#8226; CV37 6YW.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130926/91544d59/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130926/91544d59/attachment.htm</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030448.html">[rabbitmq-discuss] How to check is some bind present or no?
</A></li>
	<LI>Next message: <A HREF="030455.html">[rabbitmq-discuss] Mirrored Queue Failover takes longer than expected
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30454">[ date ]</a>
              <a href="thread.html#30454">[ thread ]</a>
              <a href="subject.html#30454">[ subject ]</a>
              <a href="author.html#30454">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
