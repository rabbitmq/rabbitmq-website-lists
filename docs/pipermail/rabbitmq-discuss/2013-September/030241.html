<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] When using rabbitmq-jms javax.jms.Message.getJMSDestination does not return the actual destination when it is received from a consumer listening on a Topic with a wild card
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20When%20using%20rabbitmq-jms%0A%20javax.jms.Message.getJMSDestination%20does%20not%20return%20the%20actual%20destination%0A%20when%20it%20is%20received%20from%20a%20consumer%20listening%20on%20a%20Topic%20with%20a%20wild%20card&In-Reply-To=%3C851fdb0f-10a7-4041-a297-983923b2e978%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030252.html">
   <LINK REL="Next"  HREF="030257.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] When using rabbitmq-jms javax.jms.Message.getJMSDestination does not return the actual destination when it is received from a consumer listening on a Topic with a wild card</H1>
    <B>Josh Carlson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20When%20using%20rabbitmq-jms%0A%20javax.jms.Message.getJMSDestination%20does%20not%20return%20the%20actual%20destination%0A%20when%20it%20is%20received%20from%20a%20consumer%20listening%20on%20a%20Topic%20with%20a%20wild%20card&In-Reply-To=%3C851fdb0f-10a7-4041-a297-983923b2e978%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] When using rabbitmq-jms javax.jms.Message.getJMSDestination does not return the actual destination when it is received from a consumer listening on a Topic with a wild card">josh.carlson at kaazing.com
       </A><BR>
    <I>Tue Sep 17 20:21:39 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="030252.html">[rabbitmq-discuss] Is rabbitmq-jms for vFabric RabbitMQ	opensource?
</A></li>
        <LI>Next message: <A HREF="030257.html">[rabbitmq-discuss] When using rabbitmq-jms	javax.jms.Message.getJMSDestination does not return the	actual destination when it is received from a consumer	listening on a Topic with a wild card
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30241">[ date ]</a>
              <a href="thread.html#30241">[ thread ]</a>
              <a href="subject.html#30241">[ subject ]</a>
              <a href="author.html#30241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I posted this same question on the VMWare forum: 
<A HREF="https://communities.vmware.com/thread/457362.">https://communities.vmware.com/thread/457362.</A> I am not sure what the best 
community to use for questions. So I'm copying and pasting that question 
here. 

When using rabbitmq-jms for vFabric RabbitMQ 
javax.jms.Message.getJMSDestination does not return the actual destination 
when it is received from a consumer listening on a Topic with a wild card. 
I have tested with both 1.0.3 and 1.0.5 clients with RabbitMQ 3.1.5.

 

I was wondering if the community was aware of this problem and if there are 
any workarounds? If not what is the proper channel to file a bug report. An 
example code snippet is below. The test fails because the 
TextMessageMatcher expects the destination passed in on construction 
(second parameter) to equal the desination on the message received (aquired 
from getJMSDestination).

 

        Mockery context = new Mockery();

        final MessageListener messageListener = 
context.mock(MessageListener.class);

 

        final Latch latch = new LatchImpl();

        final String prefix = &quot;test&quot; + System.currentTimeMillis();

 

 

 

        context.checking(new Expectations() {

            {

                oneOf(messageListener).onMessage(with(new 
TextMessageMatcher(&quot;MSG1&quot;, prefix + &quot;.1234&quot;)));

                will(new CustomAction(&quot;release latch&quot;) {

                    @Override

                    public Object invoke(Invocation invocation) throws 
Throwable {

                        latch.unlatch();

                        return null;

                    }

                });

            }

        });

 

        final Connection connection = createConnection(null, null);

        Session session = connection.createSession(false, 
Session.AUTO_ACKNOWLEDGE);

        connection.start();

 

        Topic wildcardTopic = (Topic) getInitialContext().lookup(prefix + 
&quot;.&quot; + &quot;#&quot;);

        Topic destination = (Topic) getInitialContext().lookup(prefix + 
&quot;.1234&quot;);

 

        final MessageConsumer consumer = 
session.createConsumer(wildcardTopic);

        consumer.setMessageListener(messageListener);

 

        MessageProducer producer = session.createProducer(null);

        producer.send(destination, session.createTextMessage(&quot;MSG1&quot;));

 

        latch.await(5000);

 

 

        connection.close();

 

 

        Thread.sleep(5);

 

 

        context.assertIsSatisfied();

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130917/f5ef5de9/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130917/f5ef5de9/attachment.htm</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030252.html">[rabbitmq-discuss] Is rabbitmq-jms for vFabric RabbitMQ	opensource?
</A></li>
	<LI>Next message: <A HREF="030257.html">[rabbitmq-discuss] When using rabbitmq-jms	javax.jms.Message.getJMSDestination does not return the	actual destination when it is received from a consumer	listening on a Topic with a wild card
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30241">[ date ]</a>
              <a href="thread.html#30241">[ thread ]</a>
              <a href="subject.html#30241">[ subject ]</a>
              <a href="author.html#30241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
