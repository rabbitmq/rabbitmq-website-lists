<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> No subject
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.24.1317777026.2895.rabbitmq-discuss%40lists.rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015342.html">
   <LINK REL="Next"  HREF="015589.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>No subject</H1>
    <B></B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.24.1317777026.2895.rabbitmq-discuss%40lists.rabbitmq.com%3E"
       TITLE="No subject">
       </A><BR>
    <I>Tue Apr 12 10:32:41 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015342.html">No subject
</A></li>
        <LI>Next message: <A HREF="015589.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15370">[ date ]</a>
              <a href="thread.html#15370">[ thread ]</a>
              <a href="subject.html#15370">[ subject ]</a>
              <a href="author.html#15370">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Cluster status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-39-06-72-50</A>' ...
[{nodes,[{disc,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-07-18-A6</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-202-209-83</A>',
                '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-39-06-72-50</A>']}]},
 {running_nodes,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-07-18-A6</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-202-209-83</A>',
                 '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-39-06-72-50</A>']}]
...done.

rabbitmqctl list_queues has the same behavior on the other nodes (never
returns).

How big were the queues? We recently fixed some bugs which had
&gt;<i> previously been causing queue recovery to take a _very_ long time so it
</I>&gt;<i> might be one of those that's afflicting you. What is the CPU/disk doing
</I>&gt;<i> of the &quot;stuck&quot; node? If it's spinning then it's probably just taking a
</I>&gt;<i> very long time to recover.
</I>&gt;<i>
</I>&gt;<i> Matthew
</I>&gt;<i>
</I>
Maybe 10-20 queues, probably about 15 messages queued at the time.  This
environment is a very *low* volume but very *critical* part of our
application.  I'd be surprised if the production servers saw more than a
couple hundred messages total per day and this was our test environment.

Right now the node is idle and it's been sitting there for four hours:

 01:08:33 up 8 days,  5:33,  1 user,  load average: 0.00, 0.01, 0.05

A bunch of messages were in an allocated but not-acked state as I was
testing some of our server processes at the time and they were crashing
before they could ack the messages.  I originally went to restart the node
to try and get those messages flowing again.

Thanks,
Bryan

--0015176f09c88e29da04ae82ded6
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

&lt;div class=3D&quot;gmail_quote&quot;&gt;On Tue, Oct 4, 2011 at 4:59 PM, Matthew Sackman =
&lt;span dir=3D&quot;ltr&quot;&gt;&amp;lt;&lt;a href=3D&quot;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at rabbitmq.com</A>&quot;&gt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at rabbi</A>=
tmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt; wrote:&lt;br&gt;&lt;blockquote class=3D&quot;gmail_quote&quot; style=3D=
&quot;margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;&quot;&gt;
&lt;div class=3D&quot;im&quot;&gt;Ok, well you can Ctl-C the list_queues. On one of the oth=
er nodes, what&lt;/div&gt;
does rabbitmqctl cluster_status return?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div=
&gt;<i>From another node:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cluster status of node &amp;#39;ra=
</I><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">bbit at domU-12-31-39-06-72-50</A>&amp;#39; ...&lt;/div&gt;&lt;div&gt;[{nodes,[{disc,[&amp;#39;rabbit@=
domU-12-31-38-07-18-A6&amp;#39;,&amp;#39;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-202-209-83</A>&amp;#39;,&lt;/div&gt;
&lt;div&gt;=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 &amp;#39;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-39-06-72-50</A>&amp;#39=
;]}]},&lt;/div&gt;&lt;div&gt;=A0{running_nodes,[&amp;#39;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-07-18-A6</A>&amp;#39;=
,&amp;#39;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-202-209-83</A>&amp;#39;,&lt;/div&gt;&lt;div&gt;=A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0&amp;#39;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-39-06-72-50</A>&amp;#39;]}]&lt;/div&gt;
&lt;div&gt;...done.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;rabbitmqctl list_queues has the same=
 behavior on the other nodes (never returns).=A0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;block=
quote class=3D&quot;gmail_quote&quot; style=3D&quot;margin:0 0 0 .8ex;border-left:1px #ccc=
 solid;padding-left:1ex;&quot;&gt;

How big were the queues? We recently fixed some bugs which had&lt;br&gt;
previously been causing queue recovery to take a _very_ long time so it&lt;br&gt;
might be one of those that&amp;#39;s afflicting you. What is the CPU/disk doing=
&lt;br&gt;
of the &amp;quot;stuck&amp;quot; node? If it&amp;#39;s spinning then it&amp;#39;s probably =
just taking a&lt;br&gt;
very long time to recover.&lt;br&gt;
&lt;br&gt;
Matthew&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Maybe 10-20 queues, probably ab=
out 15 messages queued at the time. =A0This environment is a very *low* vol=
ume but very *critical* part of our application. =A0I&amp;#39;d be surprised if=
 the production servers saw more than a couple hundred messages total per d=
ay and this was our test environment.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Right now the node is idle and it&amp;#39;s been sitting th=
ere for four hours:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=A001:08:33 up 8 days, =A05:33=
, =A01 user, =A0load average: 0.00, 0.01, 0.05&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A b=
unch of messages were in an allocated but not-acked state as I was testing =
some of our server processes at the time and they were crashing before they=
 could ack the messages. =A0I originally went to restart the node to try an=
d get those messages flowing again.&lt;/div&gt;
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Bryan&lt;/div&gt;&lt;/div&gt;

--0015176f09c88e29da04ae82ded6--
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015342.html">No subject
</A></li>
	<LI>Next message: <A HREF="015589.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15370">[ date ]</a>
              <a href="thread.html#15370">[ thread ]</a>
              <a href="subject.html#15370">[ subject ]</a>
              <a href="author.html#15370">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
