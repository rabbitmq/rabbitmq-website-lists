<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Using .NET types as routing keys
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Using%20.NET%20types%20as%20routing%20keys&In-Reply-To=%3CBANLkTimBbn%2BmApi1pT99n5AFkY-2-nzLBw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012379.html">
   <LINK REL="Next"  HREF="012390.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Using .NET types as routing keys</H1>
    <B>Steven Taylor</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Using%20.NET%20types%20as%20routing%20keys&In-Reply-To=%3CBANLkTimBbn%2BmApi1pT99n5AFkY-2-nzLBw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Using .NET types as routing keys">taylste at gmail.com
       </A><BR>
    <I>Thu Apr 14 06:18:46 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012379.html">[rabbitmq-discuss] Using .NET types as routing keys
</A></li>
        <LI>Next message: <A HREF="012390.html">[rabbitmq-discuss] Using .NET types as routing keys
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12382">[ date ]</a>
              <a href="thread.html#12382">[ thread ]</a>
              <a href="subject.html#12382">[ subject ]</a>
              <a href="author.html#12382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nice summary.


&gt;<i> 2. To instance your handlers with IoC  (using Castle Project for
</I>&gt;<i> example) depending on your routing keys. This is the choice I tested
</I>&gt;<i> and works good.
</I>&gt;<i>
</I>Not sure what you mean here.  Like with a property of some kind?  What
configuration mechanism are you plugging in via IoC.  How is it selected?


&gt;<i> 4. Not using routing keys: To send your entities encapsulated in a
</I>&gt;<i> fixed container with at least 2 fields (messageBody, messageType).
</I>&gt;<i> Every time you receive a message you need to deserialize the envelope
</I>&gt;<i> and read the &quot;messageType&quot; field and deserialize the messageBody (it
</I>&gt;<i> should be an array of bytes) which holds your business entity. This
</I>&gt;<i> approach is not faster as others due to the need of deserialize twice.
</I>&gt;<i>
</I>
you could always do both, and deserialising a messageType could be very
fast.  For example, a 4 byte short integer could be: a. unencoded,  b. we
know that it starts in byte array position zero, and  c. the messageBody
starts in position 4 and stops at length-1.  Sounds fast.

Likewise a fixed length string of 10 or 20 chars is going to be fast too if
an int isn't meaningful enough.

Maybe version the message in an AQMP header... or version it yourself (byte
0).

This &quot;packet&quot; approach worked for TCP/IP... and I *think* TCP/IP did okay in
the end.

Once you decide, you've got to leave it baked in.  Otherwise, you've only
got (2^8) chances to change your mind assuming a 1 byte version number.

The advantage of not using an AQMP header is just that my read on the spec
was that they only guaranteed that the body field would be there in the
future.  Are these tags getting more cetain yet?

-Steven
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110414/708d0ce6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110414/708d0ce6/attachment.htm</A>&gt;
</PRE>

































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012379.html">[rabbitmq-discuss] Using .NET types as routing keys
</A></li>
	<LI>Next message: <A HREF="012390.html">[rabbitmq-discuss] Using .NET types as routing keys
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12382">[ date ]</a>
              <a href="thread.html#12382">[ thread ]</a>
              <a href="subject.html#12382">[ subject ]</a>
              <a href="author.html#12382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
