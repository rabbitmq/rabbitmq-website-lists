<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Introducing bunny_farm: an erlang client for	RabbitMQ
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Introducing%20bunny_farm%3A%20an%20erlang%20client%20for%0A%09RabbitMQ&In-Reply-To=%3C2AB2AE1D-46C7-40D5-9639-13EBB9A9F825%40muxspace.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012521.html">
   <LINK REL="Next"  HREF="012569.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Introducing bunny_farm: an erlang client for	RabbitMQ</H1>
    <B>Brian Rowe</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Introducing%20bunny_farm%3A%20an%20erlang%20client%20for%0A%09RabbitMQ&In-Reply-To=%3C2AB2AE1D-46C7-40D5-9639-13EBB9A9F825%40muxspace.com%3E"
       TITLE="[rabbitmq-discuss] Introducing bunny_farm: an erlang client for	RabbitMQ">rowe at muxspace.com
       </A><BR>
    <I>Sat Apr 23 23:29:02 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012521.html">[rabbitmq-discuss] pika behavior when server die
</A></li>
        <LI>Next message: <A HREF="012569.html">[rabbitmq-discuss] Introducing bunny_farm: an erlang client for	RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12523">[ date ]</a>
              <a href="thread.html#12523">[ thread ]</a>
              <a href="subject.html#12523">[ subject ]</a>
              <a href="author.html#12523">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

For any erlang users out there, I wanted to introduce a rabbitmq client library I've been working on for a little while called bunny_farm. This library wraps up the wiring for connecting to a message queue and provides queue-based implementations of gen_server and gen_fsm behaviors. These behaviors (called gen_qserver and gen_qfsm, respectively) can subscribe to multiple exchanges with different routing keys and will dispatch messages received from the queue to handle_cast and Module:StateName/2 for standard messages, wrapping the payload in a tuple for the sake of pattern matching.

handle_cast({&lt;&lt;RoutingKey/binary&gt;&gt;, Payload}, State)

These behaviors also understand RPC semantics (if the reply_to field is populated) and will instead dispatch to handle_call and Module:StateName/3 instead. Under this scenario, the reply is automatically sent to the caller based on the contents of the routing key, which can be to a different exchange. I introduce a special format for the reply_to field so that if the key is colon-separated, the first token is used as the exchange: &lt;&lt;&quot;exchange:routing_key&quot;&gt;&gt;. If no exchange is specified, then it defaults to the exchange the message was received on.

Publishing messages are as easy as consuming messages:
  BusHandle = bunny_farm:open(&lt;&lt;&quot;exchange&quot;&gt;&gt;)
  bunny_farm:publish([{key1,message}], &lt;&lt;&quot;routing_key.1&quot;&gt;&gt;, BusHandle)

Messages can be encoded as either erlang binaries or BSON, depending on the need. When receiving messages, the library auto-detects the format.

The bunny_farm library is available on github at <A HREF="https://github.com/muxspace/bunny_farm.">https://github.com/muxspace/bunny_farm.</A> There is an example gen_qserver implementation and gen_qfsm implementation in the test directory. I'm hopeful this is useful for the community and any feedback is warmly appreciated.


Regards,
Brian Rowe

P.S. Apologies if this is not the right list for this announcement.

</PRE>













































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012521.html">[rabbitmq-discuss] pika behavior when server die
</A></li>
	<LI>Next message: <A HREF="012569.html">[rabbitmq-discuss] Introducing bunny_farm: an erlang client for	RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12523">[ date ]</a>
              <a href="thread.html#12523">[ thread ]</a>
              <a href="subject.html#12523">[ subject ]</a>
              <a href="author.html#12523">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
