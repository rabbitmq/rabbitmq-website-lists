<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] message routing by consistent hash?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20message%20routing%20by%20consistent%20hash%3F&In-Reply-To=%3CCECD2B06-10D6-49F9-A85B-3DF91E71F1BD%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012545.html">
   <LINK REL="Next"  HREF="012547.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] message routing by consistent hash?</H1>
    <B>Alvaro Videla</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20message%20routing%20by%20consistent%20hash%3F&In-Reply-To=%3CCECD2B06-10D6-49F9-A85B-3DF91E71F1BD%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] message routing by consistent hash?">videlalvaro at gmail.com
       </A><BR>
    <I>Tue Apr 26 19:36:42 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012545.html">[rabbitmq-discuss] message routing by consistent hash?
</A></li>
        <LI>Next message: <A HREF="012547.html">[rabbitmq-discuss] another scalability nugget: echo exchange?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12546">[ date ]</a>
              <a href="thread.html#12546">[ thread ]</a>
              <a href="subject.html#12546">[ subject ]</a>
              <a href="author.html#12546">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon,

I think this could be pretty cool for distributing messages over a cluster. So:

Queue content is not replicated in a cluster but AFAIK the Exchange information and the bindings are. So you could have *node_a* and *node_b* both with *exchange_a* declared on them. Then you could declare *queue_a*  in *node_a* and *queue_b* in *node_b* and bound them to the *exchange_a* using the same routing key.

If you publish messages to the *exchange_a* then it will chose to route the message to either of those queues. In case of one node going down and if the exchange somehow notices that the binding to the queue that is gone disappeared then the messages won't get lost because they will be routed to the other node. Of course this is not replication, but I think it could be somehow useful. For example messages won't get duplicated and delivered twice, issue that could happen with a broken replication.

Cheers,

Alvaro

Twitter: @old_sound
On Apr 26, 2011, at 8:29 PM, Alexis Richardson wrote:

&gt;<i> Folks have used hashing to distribute keys with the direct exchange in
</I>&gt;<i> the past.  Under certain assumptions, this can work quite well.  For
</I>&gt;<i> example: usernames for social network activity streams.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Tue, Apr 26, 2011 at 7:26 PM, Jon Brisbin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jon at jbrisbin.com</A>&gt; wrote:
</I>&gt;&gt;<i> I'm chewing on a scalability problem and trying to use consistent hashing to solve it. Would it be possible to implement message routing based on a consistent hash of the routing key in a way similar to how Riak and riak_core uses it to distribute data/work?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It would basically be an extension of the random direct exchange I just put on my GitHub but instead of using a uniform random function, it would use a consistent hash.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thanks!
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Jon Brisbin
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> <A HREF="http://jbrisbin.com">http://jbrisbin.com</A>
</I>&gt;&gt;<i> Twitter: @j_brisbin
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
Sent form my Nokia 1100



</PRE>
























































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012545.html">[rabbitmq-discuss] message routing by consistent hash?
</A></li>
	<LI>Next message: <A HREF="012547.html">[rabbitmq-discuss] another scalability nugget: echo exchange?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12546">[ date ]</a>
              <a href="thread.html#12546">[ thread ]</a>
              <a href="subject.html#12546">[ subject ]</a>
              <a href="author.html#12546">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
