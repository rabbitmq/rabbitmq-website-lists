<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Transactions &amp; Routing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Transactions%20%26%20Routing&In-Reply-To=%3C4D9CE2CD.8020808%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012288.html">
   <LINK REL="Next"  HREF="012290.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Transactions &amp; Routing</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Transactions%20%26%20Routing&In-Reply-To=%3C4D9CE2CD.8020808%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Transactions &amp; Routing">matthias at rabbitmq.com
       </A><BR>
    <I>Wed Apr  6 23:01:49 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012288.html">[rabbitmq-discuss] Transactions &amp; Routing
</A></li>
        <LI>Next message: <A HREF="012290.html">[rabbitmq-discuss] Transactions &amp; Routing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12289">[ date ]</a>
              <a href="thread.html#12289">[ thread ]</a>
              <a href="subject.html#12289">[ subject ]</a>
              <a href="author.html#12289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jason,

Jason J. W. Williams wrote:
&gt;<i> The desire is generally for durable messages to survive a broker
</I>&gt;<i> crash.
</I>
Only if they need to be delivered to somebody, eventually.

&gt;<i> Since publishes return no status, that leaves ambiguity as to whether
</I>&gt;<i> a durable message has been persisted to disk should  a broker crash
</I>&gt;<i> occur directly after publishing. My understanding with transactions
</I>&gt;<i> were that they were how to confirm that Rabbit had the message in
</I>&gt;<i> custody safely. Should a broker crash occur before the transaction
</I>&gt;<i> returned a success, you knew you should republish. However, if the
</I>&gt;<i> crash occurred after the transaction returned success then you could
</I>&gt;<i> trust that Rabbit had persisted it to disk and move on to the next
</I>&gt;<i> message.
</I>
tx.commit-ok indicates that rabbit has successfully processed the 
messages. If there is no queue for the messages to go to then 
&quot;sucessfully processed&quot; means dropping the message.

&gt;<i> Since I now understand that inside of Rabbit and exchange is not
</I>&gt;<i> router but simply a routing table, the fact that the exchange is
</I>&gt;<i> durable makes no guarantees a durable message in the middle of being
</I>&gt;<i> routed will survive a broker crash. The only place it will be
</I>&gt;<i> persisted is the queue, so the guarantee I think people are looking
</I>&gt;<i> for with a transaction is that the durable message has made it far
</I>&gt;<i> enough into Rabbit's custody to be persisted to disk.
</I>
Transactions and the new 'confirms' let the producer know that the 
broker has take responsibility for the message. It is perfectly ok for a 
message not to go anywhere during routing and thus be dropped. Indeed, 
leaving transactions and confirms aside, what is supposed to happen to 
persistent messages which do not get routed to any queues? Should the 
broker hold on to them in the hope that some queue will turn up eventually?


Regards,

Matthias.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012288.html">[rabbitmq-discuss] Transactions &amp; Routing
</A></li>
	<LI>Next message: <A HREF="012290.html">[rabbitmq-discuss] Transactions &amp; Routing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12289">[ date ]</a>
              <a href="thread.html#12289">[ thread ]</a>
              <a href="subject.html#12289">[ subject ]</a>
              <a href="author.html#12289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
