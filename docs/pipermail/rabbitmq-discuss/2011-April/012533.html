<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Scheduled/postponed messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Scheduled/postponed%20messages&In-Reply-To=%3C52C6BA97-6F3B-4A68-A4AF-AFA3CA6D65A1%40jbrisbin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012573.html">
   <LINK REL="Next"  HREF="012574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Scheduled/postponed messages</H1>
    <B>Jon Brisbin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Scheduled/postponed%20messages&In-Reply-To=%3C52C6BA97-6F3B-4A68-A4AF-AFA3CA6D65A1%40jbrisbin.com%3E"
       TITLE="[rabbitmq-discuss] Scheduled/postponed messages">jon at jbrisbin.com
       </A><BR>
    <I>Mon Apr 25 15:53:18 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012573.html">[rabbitmq-discuss] Blog post on SpringAMQP and RabbitMQ
</A></li>
        <LI>Next message: <A HREF="012574.html">[rabbitmq-discuss] Scheduled/postponed messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12533">[ date ]</a>
              <a href="thread.html#12533">[ thread ]</a>
              <a href="subject.html#12533">[ subject ]</a>
              <a href="author.html#12533">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Apr 25, 2011, at 9:47 AM, Konstantin Tjuterev wrote:

&gt;<i> So, until this feature is implemented, which strategy do you think would be best as a workaround?
</I>
This is completely off-the-cuff, but by using the new Riak RabbitMQ postcommit hook, you could store your messages in Riak first with the &quot;ignore&quot; flag set to true. At 8:00 a cron job could simply roll through all the entries in that bucket and turn off the ignore flag, which would cause all those messages to be sent out at once.

jb


&gt;<i> 
</I>&gt;<i> Thanks!
</I>&gt;<i> 
</I>&gt;<i> Konstantin.
</I>&gt;<i> 
</I>&gt;<i> On Mon, Apr 25, 2011 at 4:58 PM, Jon Brisbin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jon at jbrisbin.com</A>&gt; wrote:
</I>&gt;<i> This sounds to me like the function of a queue type that buffers messages until a specific threshold is reached (either of number or of time window). Ideally, this should be implemented in the broker.
</I>&gt;<i> 
</I>&gt;<i> That wouldn't be an immediate fix, unfortunately, as implementing a new queue type is non-trivial.
</I>&gt;<i> 
</I>&gt;<i> jb
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Apr 25, 2011, at 6:02 AM, Konstantin Tjuterev wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi, I'm trying to implement the following scenario with RabbitMQ:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - a site which generates various emails according to user actions (like registration, ordering etc.), or according to schedule (daily announcements); emails are published into an RabbitMQ exchange
</I>&gt;<i> &gt; - a set of workers which read the queue and send out emails, do some logging
</I>&gt;<i> &gt; - some emails need to be sent immediately
</I>&gt;<i> &gt; - some should be sent precisely at specific time (or as close as possible), like daily announcement should go out exactly at 8:00AM
</I>&gt;<i> &gt; - generating daily announcements involves complex logic and takes some time (more than actual delivery), so there is a job which prepares it before time X and publishes into an exchange
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So, my question is if there is a native way to schedule messages to be delivered to workers exactly at specific time? If there is not, which strategy do you think would be the best:
</I>&gt;<i> &gt; - declaring a separate queue for such scheduled/postponed messages and starting workers at required time (by cron)
</I>&gt;<i> &gt; - having a check-what-time-is-it/sleep cycle in the workers (which are always running)
</I>&gt;<i> &gt; - having workers consume the message, check time and do NOT send acknowledgement if it's not yet the time to process it (this is the only strategy I see, NOT requiring separate workers, but it will use a lot of resources for retrying message delivery)
</I>&gt;<i> &gt; - anything else?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks in advance,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Konstantin.
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Thanks!
</I>&gt;<i> 
</I>&gt;<i> Jon Brisbin
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://jbrisbin.com">http://jbrisbin.com</A>
</I>&gt;<i> Twitter: @j_brisbin
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

Thanks!

Jon Brisbin

<A HREF="http://jbrisbin.com">http://jbrisbin.com</A>
Twitter: @j_brisbin


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110425/9bd6cfcf/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110425/9bd6cfcf/attachment.htm</A>&gt;
</PRE>



























































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012573.html">[rabbitmq-discuss] Blog post on SpringAMQP and RabbitMQ
</A></li>
	<LI>Next message: <A HREF="012574.html">[rabbitmq-discuss] Scheduled/postponed messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12533">[ date ]</a>
              <a href="thread.html#12533">[ thread ]</a>
              <a href="subject.html#12533">[ subject ]</a>
              <a href="author.html#12533">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
