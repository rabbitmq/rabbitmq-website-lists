<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> No subject
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.3.1305303251.2895.rabbitmq-discuss%40lists.rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015923.html">
   <LINK REL="Next"  HREF="015935.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>No subject</H1>
    <B></B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.3.1305303251.2895.rabbitmq-discuss%40lists.rabbitmq.com%3E"
       TITLE="No subject">
       </A><BR>
    <I>Tue Apr 12 10:32:41 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015923.html">No subject
</A></li>
        <LI>Next message: <A HREF="015935.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12858">[ date ]</a>
              <a href="thread.html#12858">[ thread ]</a>
              <a href="subject.html#12858">[ subject ]</a>
              <a href="author.html#12858">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Regards,

Gavin


On Friday, May 13, 2011 at 8:10 AM, Matthew Sackman wrote: 
&gt;<i> On Fri, May 13, 2011 at 10:58:34AM +0100, Simon MacMullen wrote:
</I>&gt;<i> &gt; Depends how you define &quot;bad idea&quot;. In terms of today's
</I>&gt;<i> &gt; implementation you should be fine, as long as you don't expect (for
</I>&gt;<i> &gt; example) to be able to flip the durability field and have that mean
</I>&gt;<i> &gt; something.
</I>&gt;<i> 
</I>&gt;<i> It's a very bad idea. For one thing, Rabbit assumes that the queue
</I>&gt;<i> record is unaltered after the queue has been created. Consequently the
</I>&gt;<i> amqqueue_process process takes a copy of the #amqqueue record and holds
</I>&gt;<i> it in its state. It never updates it. So if you change the copy in
</I>&gt;<i> mnesia, then you subsquently have divergence between the queue process's
</I>&gt;<i> copy, and the mnesia copy. This can lead to suprising results.
</I>&gt;<i> 
</I>&gt;<i> For example if you issue amqqueue:info on a queue then it'll go through
</I>&gt;<i> to the queue and not mnesia. Thus you'll find that results in management
</I>&gt;<i> and in rabbitmqctl now don't match.
</I>&gt;<i> 
</I>&gt;<i> You then have things like the property that queue redeclaration should
</I>&gt;<i> fail if arguments do not match (semantically) the original declaration.
</I>&gt;<i> But this only goes as far as mnesia. Consequently, you will have the
</I>&gt;<i> queue, if you interrogate it, claiming its arguments are one thing, but
</I>&gt;<i> if you try to redeclare the queue with those arguments, you can find
</I>&gt;<i> it'll fail because the mnesia copy is different.
</I>&gt;<i> 
</I>&gt;<i> Finally, you'll have the fact that if the broker is restarted, you'll
</I>&gt;<i> have the queues recovered with their arguments taken from mnesia. So
</I>&gt;<i> suddenly on startup, you'll have queues being restarted with different
</I>&gt;<i> arguments from that which they were last running with.
</I>&gt;<i> 
</I>&gt;<i> Matthew
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>
--4dcd5899_79838cb2_19f6
Content-Type: text/html; charset=&quot;utf-8&quot;
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

&lt;div&gt;
            &lt;div&gt;
                &lt;span&gt;Matthew,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;d=
iv&gt;&lt;span&gt;=46rom your perspective is there any way to do this that's not a=
 bad idea while not impacting production queue use=3F Your points are val=
id, however since they're arguments and Rabbit doesn't care about or use =
arguments, I wonder how impacting it can be=3F&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div=
&gt;<i>&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gavin&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;=
</I>&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;
                &lt;span&gt;&lt;/span&gt;
               =20
                &lt;=21-- &lt;p style=3D=22color: =23a0a0a0;=22&gt;On =46riday, Ma=
y 13, 2011 at 8:10 AM, Matthew Sackman wrote:&lt;/p&gt; --&gt;
                &lt;p style=3D=22color: =23a0a0a0;=22&gt;On =46riday, May 13, 2=
011 at 8:10 AM, Matthew Sackman wrote:&lt;/p&gt;
                &lt;blockquote type=3D=22cite=22 style=3D=22border-left-styl=
e:solid;border-width:1px;margin-left:0px;padding-left:10px;=22&gt;
                    &lt;span&gt;&lt;div&gt;&lt;div&gt;On =46ri, May 13, 2011 at 10:58:34AM =
+0100, Simon MacMullen wrote:&lt;br&gt;&lt;blockquote type=3D=22cite=22&gt;&lt;div&gt;Depen=
ds how you define =22bad idea=22. In terms of today's&lt;br&gt;implementation y=
ou should be fine, as long as you don't expect (for&lt;br&gt;example) to be abl=
e to flip the durability field and have that mean&lt;br&gt;something.&lt;br&gt;&lt;/div&gt;=
&lt;/blockquote&gt;&lt;br&gt;It's a very bad idea. =46or one thing, Rabbit assumes th=
at the queue&lt;br&gt;record is unaltered after the queue has been created. Con=
sequently the&lt;br&gt;amqqueue=5Fprocess process takes a copy of the =23amqque=
ue record and holds&lt;br&gt;it in its state. It never updates it. So if you ch=
ange the copy in&lt;br&gt;mnesia, then you subsquently have divergence between =
the queue process's&lt;br&gt;copy, and the mnesia copy. This can lead to supris=
ing results.&lt;br&gt;&lt;br&gt;=46or example if you issue amqqueue:info on a queue t=
hen it'll go through&lt;br&gt;to the queue and not mnesia. Thus you'll find tha=
t results in management&lt;br&gt;and in rabbitmqctl now don't match.&lt;br&gt;&lt;br&gt;You=
 then have things like the property that queue redeclaration should&lt;br&gt;fa=
il if arguments do not match (semantically) the original declaration.&lt;br&gt;=
But this only goes as far as mnesia. Consequently, you will have the&lt;br&gt;q=
ueue, if you interrogate it, claiming its arguments are one thing, but&lt;br=
&gt;<i>if you try to redeclare the queue with those arguments, you can find&lt;br&gt;=
</I>it'll fail because the mnesia copy is different.&lt;br&gt;&lt;br&gt;=46inally, you'll=
 have the fact that if the broker is restarted, you'll&lt;br&gt;have the queues=
 recovered with their arguments taken from mnesia. So&lt;br&gt;suddenly on star=
tup, you'll have queues being restarted with different&lt;br&gt;arguments from =
that which they were last running with.&lt;br&gt;&lt;br&gt;Matthew&lt;br&gt;=5F=5F=5F=5F=5F=
=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=
=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F=5F&lt;br&gt;rabbitmq-discuss m=
ailing list&lt;br&gt;&lt;a href=3D=22mailto:rabbitmq-discuss=40lists.rabbitmq.com=22=
&gt;<i>rabbitmq-discuss=40lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;&lt;a href=3D=<A HREF="22https://lists.=">22https://lists.=</A>
</I>rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss=22&gt;<A HREF="https://lists.r=">https://lists.r=</A>
abbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;=
&lt;/span&gt;
               =20
               =20
               =20
               =20
                &lt;/blockquote&gt;
               =20
                &lt;div&gt;
                    &lt;br&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
--4dcd5899_79838cb2_19f6--

</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015923.html">No subject
</A></li>
	<LI>Next message: <A HREF="015935.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12858">[ date ]</a>
              <a href="thread.html#12858">[ thread ]</a>
              <a href="subject.html#12858">[ subject ]</a>
              <a href="author.html#12858">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
