<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Meez status.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Meez%20status.&In-Reply-To=4A46C022-CA6D-4C51-87ED-80D45C9AAEC5%40corp.meez.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000314.html">
   <LINK REL="Next"  HREF="000318.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Meez status.</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Meez%20status.&In-Reply-To=4A46C022-CA6D-4C51-87ED-80D45C9AAEC5%40corp.meez.com"
       TITLE="[rabbitmq-discuss] Meez status.">matthias at lshift.net
       </A><BR>
    <I>Fri Nov  9 09:17:21 GMT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000314.html">[rabbitmq-discuss] Meez status.
</A></li>
        <LI>Next message: <A HREF="000318.html">[rabbitmq-discuss] Queue clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#315">[ date ]</a>
              <a href="thread.html#315">[ thread ]</a>
              <a href="subject.html#315">[ subject ]</a>
              <a href="author.html#315">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt,

matt wrote:
&gt;<i> Ok, I think we *might* be out of the woods.
</I>
Excellent. Keep us posted.

&gt;<i> We think that the frames were getting clobbered and 
</I>&gt;<i> as a result killing the connection and giving us socket closed 
</I>&gt;<i> exceptions.
</I>
It's not actually the frames themselves that are getting clobbered - 
their assembly and transmission is atomic - but the sequencing of them. 
Some commands, notably basic.publish, span multiple frames. These must 
all be sent back-to-back on the channel, though they can be interleaved 
with frames from other channels on the connection.

When you have multiple threads issuing commands on a channel, and some 
of these commands are multi-frame commands you can get interleaving on 
the channel itself, which results in the UnexpectedFrameError you have seen.

&gt;<i> This was our biggest traffic day in history - a ton of which is coming 
</I>&gt;<i> from AOL.  In the last hour or so we've pushed about 48k requests 
</I>&gt;<i> through a single broker and the payload is about 5k each.
</I>&gt;<i> 
</I>&gt;<i> That said, things are looking better.  Now we have sluggish publish 
</I>&gt;<i> times because everyone's blocked on the publish.
</I>
The traffic levels you are reporting - averaging 13.3 msgs/s - are 
nowhere near the capacity of the broker. You should be able to publish 
thousands of messages per second on a single channel. So, with your 
current load, the chances of two publishes contending for the lock 
should actually be quite small.

Perhaps tasks other than the raw basicPublish call, such as preparation 
of the message, are consuming a lot of time?

&gt;<i> We also have a subset of export requests that should get processed
</I>&gt;<i> first before others, so we'll be leveraging the priority level in the
</I>&gt;<i> protocol.
</I>
Unfortunately RabbitMQ does not yet support message priorities. It's 
listed as a planned feature at 
<A HREF="http://www.rabbitmq.com/compatibility.html.">http://www.rabbitmq.com/compatibility.html.</A> Let us know if you really 
need it and we will try to add this feature in the next release.

&gt;<i> Many thanks to the rabbitMQ team.  You guys have a responsiveness that's 
</I>&gt;<i> unheard of!  
</I>
Glad to have been of assistance.


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000314.html">[rabbitmq-discuss] Meez status.
</A></li>
	<LI>Next message: <A HREF="000318.html">[rabbitmq-discuss] Queue clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#315">[ date ]</a>
              <a href="thread.html#315">[ thread ]</a>
              <a href="subject.html#315">[ subject ]</a>
              <a href="author.html#315">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
