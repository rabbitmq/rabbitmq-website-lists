<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue inspector.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Queue%20inspector.&In-Reply-To=6ce0ac130711071242y60e9ba9ewaab6f77c638cdf5e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000308.html">
   <LINK REL="Next"  HREF="000297.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue inspector.</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Queue%20inspector.&In-Reply-To=6ce0ac130711071242y60e9ba9ewaab6f77c638cdf5e%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Queue inspector.">alexis.richardson at cohesiveft.com
       </A><BR>
    <I>Fri Nov  9 11:46:39 GMT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000308.html">[rabbitmq-discuss] Queue inspector.
</A></li>
        <LI>Next message: <A HREF="000297.html">[rabbitmq-discuss] Queue inspector.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#317">[ date ]</a>
              <a href="thread.html#317">[ thread ]</a>
              <a href="subject.html#317">[ subject ]</a>
              <a href="author.html#317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Brian

Very interesting stuff :-)

I'm addressing a subset of your questions since Ben has sensibly
forked off the conversation about conversational messaging.


On Nov 7, 2007 8:42 PM, Brian Granger &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ellisonbg.net at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> We are using this architecture for parallel computing in Python.  Our
</I>&gt;<i> workers are basically Python interpreters exposed to the network.  Our
</I>&gt;<i> &quot;clients&quot; are also python scripts that submit python code/objects to
</I>&gt;<i> the workers to be performed.  As you can imagine I am looking at the
</I>&gt;<i> qpid python amqp client.  We have run already with up to 256 workers
</I>&gt;<i> and we already see scaling problems.
</I>
Is this with RabbitMQ as is?  Can you shed a little more light on this please.



&gt;<i> Our stuff works just fine on
</I>&gt;<i> supercomputers, so we would like to scale up to.....2**10, 2**11,
</I>&gt;<i> 2**12, etc.  We hit scaling problems in a number of ways:
</I>&gt;<i>
</I>&gt;<i> 1) # of file descriptors per process.
</I>&gt;<i> 2) broadcasting/multicasting to all (or large subsets) of workers.
</I>&gt;<i> 3) Latency - the latency determines the grain size of work, which we
</I>&gt;<i> would like to be as small as possible.
</I>
If you could share some of the numbers with the list, that would be
very interesting.


&gt;<i> 4) Large messages.  In some cases, the messages can be very large
</I>&gt;<i> (files or large data sets).  It is not uncommon for people to want to
</I>&gt;<i> distribute 100 MB messages to subsets of workers.  Our current
</I>&gt;<i> solution generates a short lived temporary copy of the large objects
</I>&gt;<i> for each worker they are sent to.  This means if we have 128 workers,
</I>&gt;<i> we use 128*msg_size memory for a short period of time.
</I>
Eek.  And does each worker need to have a local copy of the whole
message, every time, to work from?

(As an aside one fun idea we have looked at is bittorrent style
sharing of data between broker peers, essentially implementing a DHT).


&gt;<i> We know how to
</I>&gt;<i> fix this in Python, but it still doesn't solve the other scalability
</I>&gt;<i> problems.  All that to say, any solution that we come up with must
</I>&gt;<i> also be able to handle large messages well.  Does rabbitmq have any
</I>&gt;<i> streaming support?
</I>
I shall leave this one for Tony.


&gt;<i> I would love to avoid the lower level stuff, but I also realize we
</I>&gt;<i> have a somewhat unusual set of design requirements (scalability,
</I>&gt;<i> low-latency &amp;&amp; ability to handle large messages).  In various
</I>&gt;<i> prototypes we even implemented custom protocols on top of TCP.  Once
</I>&gt;<i> you start doing that Erlang becomes a &quot;high-level&quot; solution :)
</I>
Indeed :-)

I still think you should be ok staying above the waterline and coding
to RabbitMQ, at least for now.


&gt;<i> &gt; Cool.  Please let us know if you need help, eg with the deregistration methods.
</I>&gt;<i>
</I>&gt;<i> Ahh yes, the deregistration methods could be subtle.  The main concern
</I>&gt;<i> there is if a worker dies without notifying the server that they are
</I>&gt;<i> going to die.  What facilities does rabbitmq/amqp have to handle this
</I>&gt;<i> type of stuff?
</I>
Do you mean in the sense of leasing?  I'll see what we can say about that.

One point to note in passing is that Erlang/OTP provides the notion of
a 'supervisor', see eg here:
<A HREF="http://www.computer.org/portal/site/dsonline/menuitem.9ed3d9924aeb0dcd82ccc6716bbe36ec/index.jsp?&amp;pName=dso_level1&amp;path=dsonline/2007/12&amp;file=w6tow.xml&amp;xsl=article.xsl&amp;;jsessionid=Hp7BjTtbB6JYdhP2H6p6v61x4GFCfp0CF6lXF59Y7dTvjCdGFLPG!1017941068">http://www.computer.org/portal/site/dsonline/menuitem.9ed3d9924aeb0dcd82ccc6716bbe36ec/index.jsp?&amp;pName=dso_level1&amp;path=dsonline/2007/12&amp;file=w6tow.xml&amp;xsl=article.xsl&amp;;jsessionid=Hp7BjTtbB6JYdhP2H6p6v61x4GFCfp0CF6lXF59Y7dTvjCdGFLPG!1017941068</A>

alexis




-- 
Alexis Richardson
+44 20 7617 7339 (UK)
+44 77 9865 2911 (cell)
+1 650 206 2517 (US)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000308.html">[rabbitmq-discuss] Queue inspector.
</A></li>
	<LI>Next message: <A HREF="000297.html">[rabbitmq-discuss] Queue inspector.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#317">[ date ]</a>
              <a href="thread.html#317">[ thread ]</a>
              <a href="subject.html#317">[ subject ]</a>
              <a href="author.html#317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
