<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Lack of Ack, Failure and Re-delivery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Lack%20of%20Ack%2C%20Failure%20and%20Re-delivery&In-Reply-To=%3CCAOn7oW_j8qmHhmmtg%2B8gnUTy3MZ2N1m%2BeiBc05x8jJZ%2BGy_EFw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017542.html">
   <LINK REL="Next"  HREF="017650.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Lack of Ack, Failure and Re-delivery</H1>
    <B>Simone Busoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Lack%20of%20Ack%2C%20Failure%20and%20Re-delivery&In-Reply-To=%3CCAOn7oW_j8qmHhmmtg%2B8gnUTy3MZ2N1m%2BeiBc05x8jJZ%2BGy_EFw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Lack of Ack, Failure and Re-delivery">simone.busoli at gmail.com
       </A><BR>
    <I>Sat Jan 21 22:47:44 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017542.html">[rabbitmq-discuss] Lack of Ack, Failure and Re-delivery
</A></li>
        <LI>Next message: <A HREF="017650.html">[rabbitmq-discuss] Lack of Ack, Failure and Re-delivery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17543">[ date ]</a>
              <a href="thread.html#17543">[ thread ]</a>
              <a href="subject.html#17543">[ subject ]</a>
              <a href="author.html#17543">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>By the way, I suggest you to set up some exploratory tests, they are very
useful to figure out how the broker behaves under certain circumstances. In
this case it may not be obvious the order in which unacked messages will be
redelivered. Just recently the behavior of the broker has changed whereby
messages are put at the top of the queue, while it used to be at the end.
On Jan 21, 2012 11:39 PM, &quot;Bell, Paul M.&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pbell at syncsort.com</A>&gt; wrote:

&gt;<i> Thank you both.
</I>&gt;<i>
</I>&gt;<i> -Paul
</I>&gt;<i>
</I>&gt;<i> On Jan 21, 2012, at 5:24 PM, &quot;Simone Busoli&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simone.busoli at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> Also in case 2 the broker will redeliver all messages that were not acked,
</I>&gt;<i> although it doesn't necessarily mean that the consumer didn't really
</I>&gt;<i> consume them already. For that you should look at the redelivered flag.
</I>&gt;<i> On Jan 21, 2012 11:20 PM, &quot;Bell, Paul M.&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pbell at syncsort.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I apologize. I should have stated up front that the queues and messages
</I>&gt;&gt;<i> are durable.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What happens in case 2, where the consumer bounces?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks, Jason.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Paul
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ________________________________________
</I>&gt;&gt;<i> From: Jason J. W. Williams [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jasonjwwilliams at gmail.com</A>]
</I>&gt;&gt;<i> Sent: Saturday, January 21, 2012 5:05 PM
</I>&gt;&gt;<i> To: Bell, Paul M.
</I>&gt;&gt;<i> Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> Subject: Re: [rabbitmq-discuss] Lack of Ack, Failure and Re-delivery
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi Paul,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If the messages were published with the durable flag and the queues are
</I>&gt;&gt;<i> durable, the messages will survive the broker restart and be re-presented
</I>&gt;&gt;<i> to consumers. If the messages or the queues were not durable they will
</I>&gt;&gt;<i> disappear after restart.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -J
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sent via iPhone
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is your email Premiere?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Jan 21, 2012, at 14:57, &quot;Bell, Paul M.&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pbell at syncsort.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Hi,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Suppose I have a producer on NodeP, a broker on NodeB, and a consumer
</I>&gt;&gt;<i> on NodeC. Suppose further that explicit acks are required (i.e., if I've
</I>&gt;&gt;<i> understood the docs, that &quot;noack&quot; is not in effect) and that after
</I>&gt;&gt;<i> consuming a message from the queue, NodeC.consumer dispatches some other
</I>&gt;&gt;<i> work in order to process that message. IOW: NodeC.consumer doesn't respond
</I>&gt;&gt;<i> immediately with an ack.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; So, from NodeB.broker's point of view, the message has been moved from
</I>&gt;&gt;<i> the exchange to the queue, consumed, but not yet ack-ed.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; What will happen under these two scenarios:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; 1. NodeB.broker bounces - when broker restarts what will he do with
</I>&gt;&gt;<i> un-acked messages that have been delivered to queue and haven't been
</I>&gt;&gt;<i> ack-ed; e.g., will these be again delivered to the queue?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; 2. NodeC.consumer bounces - when consumer restarts is there any way he
</I>&gt;&gt;<i> can again consume the un-acked message, and begin again the work that this
</I>&gt;&gt;<i> message represents? (I suppose that NodeB.broker might be implicated here
</I>&gt;&gt;<i> because it might detect the loss of connection to the NodeC.consumer....).
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; When I say &quot;bounces,&quot; I mean at a minimum that the application (broker,
</I>&gt;&gt;<i> consumer) crashed and restarted. But I am also interested in the case where
</I>&gt;&gt;<i> the node's OS is for whatever reason rebooted. Perhaps it looks no
</I>&gt;&gt;<i> different.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks for your help.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; -Paul
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; ATTENTION: -----
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; The information contained in this message (including any files
</I>&gt;&gt;<i> transmitted with this message) may contain proprietary, trade secret or
</I>&gt;&gt;<i> other  confidential and/or legally privileged information. Any pricing
</I>&gt;&gt;<i> information contained in this message or in any files transmitted with this
</I>&gt;&gt;<i> message is always confidential and cannot be shared with any third parties
</I>&gt;&gt;<i> without prior written approval from Syncsort. This message is intended to
</I>&gt;&gt;<i> be read only by the individual or entity to whom it is addressed or by
</I>&gt;&gt;<i> their designee. If the reader of this message is not the intended
</I>&gt;&gt;<i> recipient, you are on notice that any use, disclosure, copying or
</I>&gt;&gt;<i> distribution of this message, in any form, is strictly prohibited. If you
</I>&gt;&gt;<i> have received this message in error, please immediately notify the sender
</I>&gt;&gt;<i> and/or Syncsort and destroy all copies of this message in your possession,
</I>&gt;&gt;<i> custody or control.
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120121/31fecda0/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120121/31fecda0/attachment.htm</A>&gt;
</PRE>












































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017542.html">[rabbitmq-discuss] Lack of Ack, Failure and Re-delivery
</A></li>
	<LI>Next message: <A HREF="017650.html">[rabbitmq-discuss] Lack of Ack, Failure and Re-delivery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17543">[ date ]</a>
              <a href="thread.html#17543">[ thread ]</a>
              <a href="subject.html#17543">[ subject ]</a>
              <a href="author.html#17543">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
