<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] does rabbitmq server close connections?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20does%20rabbitmq%20server%20close%20connections%3F&In-Reply-To=%3CCAH24rBONoy6YmJugja21d5APK0GMbQAA2Cud3%2BLR3RE5txNPaQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017097.html">
   <LINK REL="Next"  HREF="017111.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] does rabbitmq server close connections?</H1>
    <B>Mark Steele</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20does%20rabbitmq%20server%20close%20connections%3F&In-Reply-To=%3CCAH24rBONoy6YmJugja21d5APK0GMbQAA2Cud3%2BLR3RE5txNPaQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] does rabbitmq server close connections?">msteele at beringmedia.com
       </A><BR>
    <I>Tue Jan  3 15:47:43 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017097.html">[rabbitmq-discuss] does rabbitmq server close connections?
</A></li>
        <LI>Next message: <A HREF="017111.html">[rabbitmq-discuss] does rabbitmq server close connections?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17108">[ date ]</a>
              <a href="thread.html#17108">[ thread ]</a>
              <a href="subject.html#17108">[ subject ]</a>
              <a href="author.html#17108">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We've been bitten by this with firewalls that close connections after idle
timeouts. Best solution I can come up with is to use TCP keepalives.

If you client supports setting TCP options during the connection, that's
all you need to do for the client side part. For the server side, I
couldn't find any options for this in the rabbit config, so we implemented
libkeepalive to force the server to use keepalives.

Rabbit folks, please add this as an option to the server.

Cheers,

Mark Steele, CISSP, CSM
Bering Media Inc.

On Tue, Jan 3, 2012 at 9:41 AM, Alexandru Scvor&#355;ov
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexandru at rabbitmq.com</A>&gt;wrote:

&gt;<i> &gt; With 100's of computers connected to rabbitmq with persistent
</I>&gt;<i> connections,
</I>&gt;<i> &gt; would this pose any problems?
</I>&gt;<i>
</I>&gt;<i> Not unless you run out of free file handles.  On normal installations,
</I>&gt;<i> it should handle up to thousands of connections without difficulty.  You
</I>&gt;<i> could further configure it to support more connections.
</I>&gt;<i>
</I>&gt;<i> &gt; Does it time-out by default?
</I>&gt;<i>
</I>&gt;<i> No.  Connections are not timed out.
</I>&gt;<i>
</I>&gt;<i> &gt; Why use a heartbeat?  Is it to re-establish if the heartbeat fails?
</I>&gt;<i>
</I>&gt;<i> If the network fails between a client and the broker, and there's no
</I>&gt;<i> traffic between them at that point, both will think the connection is
</I>&gt;<i> still open, even though it isn't.  Heartbeats ensure that both broker
</I>&gt;<i> and client are notified fairly quickly if the connection fails.
</I>&gt;<i>
</I>&gt;<i> &gt; Would it be better for clients to close connections and only open a
</I>&gt;<i> &gt; connection when necessary?
</I>&gt;<i>
</I>&gt;<i> It depends on your use case.
</I>&gt;<i>
</I>&gt;<i> &gt; For reading messages we need persistent connections.
</I>&gt;<i> &gt; But for writing, and I can see how we could potentially only open a
</I>&gt;<i> &gt; connection to write a message when required.
</I>&gt;<i>
</I>&gt;<i> For consuming messages *efficiently*, you need persistent connections.
</I>&gt;<i> If you only get messages very rarely, you could open a connection, poll
</I>&gt;<i> the broker with basic.get and then close the connection.  But, if you
</I>&gt;<i> need to consume a lot of messages, you probably want persistent
</I>&gt;<i> connections anyway.
</I>&gt;<i>
</I>&gt;<i> Hope this helps.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Alex
</I>&gt;<i>
</I>&gt;<i> On Thu, Dec 29, 2011 at 05:21:26PM -0500, S Ahmed wrote:
</I>&gt;<i> &gt; With 100's of computers connected to rabbitmq with persistent
</I>&gt;<i> connections,
</I>&gt;<i> &gt; would this pose any problems?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Does it time-out by default?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Why use a heartbeat?  Is it to re-establish if the heartbeat fails?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Would it be better for clients to close connections and only open a
</I>&gt;<i> &gt; connection when necessary?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For reading messages we need persistent connections.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; But for writing, and I can see how we could potentially only open a
</I>&gt;<i> &gt; connection to write a message when required.
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120103/385f0ffa/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120103/385f0ffa/attachment.htm</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017097.html">[rabbitmq-discuss] does rabbitmq server close connections?
</A></li>
	<LI>Next message: <A HREF="017111.html">[rabbitmq-discuss] does rabbitmq server close connections?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17108">[ date ]</a>
              <a href="thread.html#17108">[ thread ]</a>
              <a href="subject.html#17108">[ subject ]</a>
              <a href="author.html#17108">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
