<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Archetecture for multi-datacenters
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Archetecture%20for%20multi-datacenters&In-Reply-To=%3CCAOn7oW-Y-e6FuBR2dHLXJSX%2BLg1U7d3nNQBYfV2brzKaOotfWw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017679.html">
   <LINK REL="Next"  HREF="017683.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Archetecture for multi-datacenters</H1>
    <B>Simone Busoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Archetecture%20for%20multi-datacenters&In-Reply-To=%3CCAOn7oW-Y-e6FuBR2dHLXJSX%2BLg1U7d3nNQBYfV2brzKaOotfWw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Archetecture for multi-datacenters">simone.busoli at gmail.com
       </A><BR>
    <I>Thu Jan 26 06:47:34 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017679.html">[rabbitmq-discuss] Archetecture for multi-datacenters
</A></li>
        <LI>Next message: <A HREF="017683.html">[rabbitmq-discuss] Vhost concept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17684">[ date ]</a>
              <a href="thread.html#17684">[ thread ]</a>
              <a href="subject.html#17684">[ subject ]</a>
              <a href="author.html#17684">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Wes, shovel will indeed enter an endless loop if you set it up
symmetrically between two brokers. Federation instead has been designed
with an option maxHops which prevents messages from looping. You should
check it out.
On Jan 26, 2012 1:23 AM, &quot;Wes Smith&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Wes_Smith at echopass.com</A>&gt; wrote:

&gt;<i> Situation:****
</I>&gt;<i>
</I>&gt;<i> Each RabbitMQ cluster has multiple nodes (2). My platform I&#8217;m working with
</I>&gt;<i> has 2 datacenters each with a RabbitMQ cluster. I need to configure
</I>&gt;<i> RabbitMQ such that any message published to any exchange on any node can be
</I>&gt;<i> consumed by a queue on either cluster.****
</I>&gt;<i>
</I>&gt;<i> ** **
</I>&gt;<i>
</I>&gt;<i> From the web and also a support ticket/question with VMWare I am to
</I>&gt;<i> understand that clustering across the WAN should not be done. I&#8217;ve been
</I>&gt;<i> pointed at the shovel plugin to handle communications from one data center
</I>&gt;<i> to the other. I&#8217;ve been experimenting with shovel a little to figure out
</I>&gt;<i> how to do this, but I seem to have a loop going on where a published
</I>&gt;<i> message from datacenter A goes to datacenter B, but then B goes ahead and
</I>&gt;<i> shovels it right back to A (more than 800 times per second).****
</I>&gt;<i>
</I>&gt;<i> ** **
</I>&gt;<i>
</I>&gt;<i> I&#8217;ve seen a video from 2009 (Tony Garnock-Jones) that discusses this and
</I>&gt;<i> indicated that shovel was being modified to only handle this scenario to
</I>&gt;<i> look at some labels to determine if the message has been to the current
</I>&gt;<i> node, and just drop it if it has.  This change does not appear to have
</I>&gt;<i> happened, unless I&#8217;m missing something.****
</I>&gt;<i>
</I>&gt;<i> ** **
</I>&gt;<i>
</I>&gt;<i> Does anyone have a similar scenario or know how to handle high
</I>&gt;<i> availability peer-to-peer connections across a WAN with RabbitMQ?****
</I>&gt;<i>
</I>&gt;<i> ** **
</I>&gt;<i>
</I>&gt;<i> -Wes****
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120126/023797fe/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120126/023797fe/attachment.htm</A>&gt;
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017679.html">[rabbitmq-discuss] Archetecture for multi-datacenters
</A></li>
	<LI>Next message: <A HREF="017683.html">[rabbitmq-discuss] Vhost concept
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17684">[ date ]</a>
              <a href="thread.html#17684">[ thread ]</a>
              <a href="subject.html#17684">[ subject ]</a>
              <a href="author.html#17684">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
