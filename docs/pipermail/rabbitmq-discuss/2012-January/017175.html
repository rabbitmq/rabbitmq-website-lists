<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Federation Configuration and Duplicate	Messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20Configuration%20and%20Duplicate%0A%09Messages&In-Reply-To=%3C4F057F10.4020002%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017141.html">
   <LINK REL="Next"  HREF="017104.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Federation Configuration and Duplicate	Messages</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20Configuration%20and%20Duplicate%0A%09Messages&In-Reply-To=%3C4F057F10.4020002%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Federation Configuration and Duplicate	Messages">simon at rabbitmq.com
       </A><BR>
    <I>Thu Jan  5 10:44:32 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017141.html">[rabbitmq-discuss] Federation Configuration and Duplicate Messages
</A></li>
        <LI>Next message: <A HREF="017104.html">[rabbitmq-discuss] Messaging using both ActiveMQ and RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17175">[ date ]</a>
              <a href="thread.html#17175">[ thread ]</a>
              <a href="subject.html#17175">[ subject ]</a>
              <a href="author.html#17175">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We'd like to make managing big federated networks easier. At some point 
we will want to make it possible to modify the federation config of a 
broker without restarting it. In terms of managing the federation as a 
whole, you may want to look into something like puppet or chef.

Another thing we'd like to add in the future (as always, subject to 
resource constraints) is loop detection in federation - this would 
alleviate your problem I imagine.

Cheers, Simon

On 04/01/12 12:27, Letourneau, John P (John) wrote:
&gt;<i> Simone,
</I>&gt;<i>
</I>&gt;<i> Ah, sorry I missed the suggestion to configure a fully interconnected
</I>&gt;<i> network.
</I>&gt;<i>
</I>&gt;<i> Yes that would work. However it becomes an administrative nightmare as
</I>&gt;<i> nodes are added to the network.
</I>&gt;<i>
</I>&gt;<i> Therefore I don&#8217;t think this is viable.
</I>&gt;<i>
</I>&gt;<i> -John
</I>&gt;<i>
</I>&gt;<i> *From:*Busoli, Simone [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Simone.Busoli at ferrari.com</A>]
</I>&gt;<i> *Sent:* Wednesday, January 04, 2012 7:02 AM
</I>&gt;<i> *To:* Letourneau, John P (John); Simone Busoli
</I>&gt;<i> *Cc:* <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> *Subject:* RE: [rabbitmq-discuss] Federation Configuration and Duplicate
</I>&gt;<i> Messages
</I>&gt;<i>
</I>&gt;<i> That&#8217;s true with your current configuration, but if you federate each
</I>&gt;<i> broker with the other two like I suggested it is going to work.
</I>&gt;<i>
</I>&gt;<i> *From:*Letourneau, John P (John)
</I>&gt;<i> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">john.letourneau at alcatel-lucent.com</A>]
</I>&gt;<i> *Sent:* mercoled&#236; 4 gennaio 2012 12:54
</I>&gt;<i> *To:* Simone Busoli
</I>&gt;<i> *Cc:* Busoli, Simone; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> *Subject:* RE: [rabbitmq-discuss] Federation Configuration and Duplicate
</I>&gt;<i> Messages
</I>&gt;<i>
</I>&gt;<i> Simone,
</I>&gt;<i>
</I>&gt;<i> If I were to set hops=1, then a message posted at N1 would go to N2 but
</I>&gt;<i> will NOT go to N3. This has been verified.
</I>&gt;<i>
</I>&gt;<i> Similarly a message posted at N3 would go to N2 but NOT go to N1.
</I>&gt;<i>
</I>&gt;<i> -John
</I>&gt;<i>
</I>&gt;<i> *From:*Simone Busoli [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simone.busoli at gmail.com</A>]
</I>&gt;<i> *Sent:* Tuesday, January 03, 2012 3:16 PM
</I>&gt;<i> *To:* Letourneau, John P (John)
</I>&gt;<i> *Cc:* Busoli, Simone; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> *Subject:* Re: [rabbitmq-discuss] Federation Configuration and Duplicate
</I>&gt;<i> Messages
</I>&gt;<i>
</I>&gt;<i> Inline
</I>&gt;<i>
</I>&gt;<i> On Jan 3, 2012 4:52 PM, &quot;Letourneau, John P (John)&quot;
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">john.letourneau at alcatel-lucent.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">john.letourneau at alcatel-lucent.com</A>&gt;&gt; wrote:
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; Well, perhaps a bit more about my configuration 8-)
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; 3 nodes&#8230;call them N1, N2, N3.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; On each I have federation configured.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; N2 &#8211; exchange log, connects to N1/log and N3/log
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; N3 &#8211; exchange log, connects to N2/log
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; Right now I cannot seem to have the N1 exchange log connect to
</I>&gt;<i> N2/log; will need to find out why sometime.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; I do it this way so that regardless of where the producer of the log
</I>&gt;<i> message is, everyone everywhere will see it.
</I>&gt;<i>
</I>&gt;<i> If this is your aim, can't you simply federate the log exchange on each
</I>&gt;<i> broker with the other two and set max hops to 1?
</I>&gt;<i>
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; Each layer in the hierarchy only knows about nodes in adjacent
</I>&gt;<i> layers&#8230;N2 being the busy one with a layer above and below.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; If everyone has hops=1, sending a log message to N1/log will only go
</I>&gt;<i> to N2 and not N3 [this is correct].
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; Setting hops=4, sending a log to N1/log will go to N2 and N3&#8230;it will
</I>&gt;<i> also be returned to N2 thus a consumer on N2 will see the original msg
</I>&gt;<i> AND the one sent via N2/N3 federation link. Also N3 sees it twice also
</I>&gt;<i> for a total of once on N1, twice on N2, and twice on N3&#8230;the message took
</I>&gt;<i> a total of 4 hops.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; So, this is what I mean by &#8216;one might expect&#8217; 8-)
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; -John
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; From: Busoli, Simone [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Simone.Busoli at ferrari.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Simone.Busoli at ferrari.com</A>&gt;]
</I>&gt;<i>  &gt; Sent: Tuesday, January 03, 2012 10:23 AM
</I>&gt;<i>  &gt; To: Letourneau, John P (John); <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>  &gt; Subject: RE: Federation Configuration and Duplicate Messages
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; Hi John, I&#8217;m not sure about this:
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; As one might expect, this sometimes results in the message being seen
</I>&gt;<i>  &gt;1 time at some clients.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; It shouldn&#8217;t be the expected behavior except for certain scenarios
</I>&gt;<i> (i.e. disconnection of the brokers). Am I missing something perhaps?
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i> _________________________________________________________________________________________________________________
</I>&gt;<i>  &gt; Questo messaggio e da intendersi esclusivamente ad uso del
</I>&gt;<i> destinatario e puo contenere informazioni che sono di natura
</I>&gt;<i> privilegiata, confidenziale
</I>&gt;<i>  &gt; o non divulgabile secondo le leggi vigenti. Se il lettore del
</I>&gt;<i> presente messaggio non e il destinatario designato, o il
</I>&gt;<i> dipendente/agente responsabile
</I>&gt;<i>  &gt; per la consegna del messaggio al destinatario designato, si informa
</I>&gt;<i> che ogni disseminazione, distribuzione o copiatura di questa
</I>&gt;<i> comunicazione e
</I>&gt;<i>  &gt; strettamente proibita anche ai sensi del decreto legislativo 196/03 .
</I>&gt;<i> Se avete ricevuto questo messaggio per errore, vi preghiamo di notificarcelo
</I>&gt;<i>  &gt; immediatamente a mezzo e-mail di risposta e successivamente di
</I>&gt;<i> procedere alla cancellazione di questa e-mail e relativi allegati dal
</I>&gt;<i> vostro sistema.
</I>&gt;<i>  &gt;
</I>&gt;<i> _________________________________________________________________________________________________________________
</I>&gt;<i>  &gt; This message is intended only for the use of the addressee and may
</I>&gt;<i> contain information that is privileged, confidential and exempt from
</I>&gt;<i>  &gt; disclosure under applicable law. If the reader of this message is not
</I>&gt;<i> the intended recipient, or the employee or agent responsible for
</I>&gt;<i> delivering the
</I>&gt;<i>  &gt; message to the intended recipient, you are hereby notified that any
</I>&gt;<i> dissemination, distribution or copying of this communication is strictly
</I>&gt;<i>  &gt; prohibited. If you have received this e-mail in error, please notify
</I>&gt;<i> us immediately by return e-mail and delete this e-mail and all
</I>&gt;<i> attachments from
</I>&gt;<i>  &gt; your system.
</I>&gt;<i>  &gt;
</I>&gt;<i> _________________________________________________________________________________________________________________
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; _______________________________________________
</I>&gt;<i>  &gt; rabbitmq-discuss mailing list
</I>&gt;<i>  &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i>  &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>  &gt;
</I>&gt;<i>
</I>&gt;<i> _________________________________________________________________________________________________________________
</I>&gt;<i> Questo messaggio &#232; da intendersi esclusivamente ad uso del destinatario
</I>&gt;<i> e pu&#242; contenere informazioni che sono di natura privilegiata, confidenziale
</I>&gt;<i> o non divulgabile secondo le leggi vigenti. Se il lettore del presente
</I>&gt;<i> messaggio non &#232; il destinatario designato, o il dipendente/agente
</I>&gt;<i> responsabile
</I>&gt;<i> per la consegna del messaggio al destinatario designato, si informa che
</I>&gt;<i> ogni disseminazione, distribuzione o copiatura di questa comunicazione &#232;
</I>&gt;<i> strettamente proibita anche ai sensi del decreto legislativo 196/03 . Se
</I>&gt;<i> avete ricevuto questo messaggio per errore, vi preghiamo di notificarcelo
</I>&gt;<i> immediatamente a mezzo e-mail di risposta e successivamente di procedere
</I>&gt;<i> alla cancellazione di questa e-mail e relativi allegati dal vostro sistema.
</I>&gt;<i> _________________________________________________________________________________________________________________
</I>&gt;<i> This message is intended only for the use of the addressee and may
</I>&gt;<i> contain information that is privileged, confidential and exempt from
</I>&gt;<i> disclosure under applicable law. If the reader of this message is not
</I>&gt;<i> the intended recipient, or the employee or agent responsible for
</I>&gt;<i> delivering the
</I>&gt;<i> message to the intended recipient, you are hereby notified that any
</I>&gt;<i> dissemination, distribution or copying of this communication is strictly
</I>&gt;<i> prohibited. If you have received this e-mail in error, please notify us
</I>&gt;<i> immediately by return e-mail and delete this e-mail and all attachments
</I>&gt;<i> from
</I>&gt;<i> your system.
</I>&gt;<i> _________________________________________________________________________________________________________________
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017141.html">[rabbitmq-discuss] Federation Configuration and Duplicate Messages
</A></li>
	<LI>Next message: <A HREF="017104.html">[rabbitmq-discuss] Messaging using both ActiveMQ and RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17175">[ date ]</a>
              <a href="thread.html#17175">[ thread ]</a>
              <a href="subject.html#17175">[ subject ]</a>
              <a href="author.html#17175">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
