<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue Lease (x-expires)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20Lease%20%28x-expires%29&In-Reply-To=%3C384f67bd-c561-4728-8796-7528863d9176%40k3g2000pbn.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017402.html">
   <LINK REL="Next"  HREF="017525.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue Lease (x-expires)</H1>
    <B>Yogesh Ketkar</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20Lease%20%28x-expires%29&In-Reply-To=%3C384f67bd-c561-4728-8796-7528863d9176%40k3g2000pbn.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Queue Lease (x-expires)">yogimogi at gmail.com
       </A><BR>
    <I>Mon Jan 16 15:56:30 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017402.html">[rabbitmq-discuss] Queue Lease (x-expires)
</A></li>
        <LI>Next message: <A HREF="017525.html">[rabbitmq-discuss] Queue Lease (x-expires)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17405">[ date ]</a>
              <a href="thread.html#17405">[ thread ]</a>
              <a href="subject.html#17405">[ subject ]</a>
              <a href="author.html#17405">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Simon for the response.
This is what I am trying to achieve.

I am going to get events from an external system on RabbitMQ queue.
Event payload looks something like

Payload-1
&lt;Info&gt;
   &lt;AppId&gt;10&lt;/AppId&gt;
   &lt;Action&gt;Create&lt;/Action&gt;
&lt;/Info&gt;

Payload-2
&lt;Info&gt;
   &lt;AppId&gt;10&lt;/AppId&gt;
   &lt;Action&gt;Delete&lt;/Action&gt;
&lt;/Info&gt;

Payload-3
&lt;Info&gt;
   &lt;AppId&gt;11&lt;/AppId&gt;
   &lt;Action&gt;Create&lt;/Action&gt;
&lt;/Info&gt;

Events which have same AppId have to be processed sequentially. So I
was planning to have just one consumer on this queue, this consumer
will create queues on the fly with names like AppId-10, AppId-10 etc
and move those corresponding events to those queues. Each of these
queues will have only one consumer so as to guarantee sequential
processing of the events.
There could be thousands of queues which would get created, each with
probably on 10 to 20 messages.
I would like to delete the queue with no messages in it and so asked
the question.

Can you suggest an alternative to achieve
1. Delete the queue when last event processed from the queue has
&lt;Action&gt;Delete&lt;/Action&gt; as this implies that
   no more events with same &lt;AppId&gt; would ever get created.
2. Delete the queue when it is IDLE for certain period, meaning it is
empty and no more event was added to it for certain time period.

regards, Yogesh


On Jan 16, 8:26&#160;pm, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">si... at rabbitmq.com</A>&gt; wrote:
&gt;<i> On 16/01/12 07:15, Yogesh Ketkar wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Is there a way to ensure that queue with x-expires option set, in
</I>&gt;<i> &gt; addition to not being unused, will not get deleted if there is at-
</I>&gt;<i> &gt; least one message on the queue?
</I>&gt;<i>
</I>&gt;<i> I'm afraid not. What are you trying to do?
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I></PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017402.html">[rabbitmq-discuss] Queue Lease (x-expires)
</A></li>
	<LI>Next message: <A HREF="017525.html">[rabbitmq-discuss] Queue Lease (x-expires)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17405">[ date ]</a>
              <a href="thread.html#17405">[ thread ]</a>
              <a href="subject.html#17405">[ subject ]</a>
              <a href="author.html#17405">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
