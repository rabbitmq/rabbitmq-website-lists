<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Keeping track of exchanges -- Any Advice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Keeping%20track%20of%20exchanges%20--%20Any%20Advice&In-Reply-To=%3C94a5f80b-b18a-4a7e-aa6f-de7a74cd2f22%40m5g2000yqk.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017465.html">
   <LINK REL="Next"  HREF="017760.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Keeping track of exchanges -- Any Advice</H1>
    <B>MarcusR</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Keeping%20track%20of%20exchanges%20--%20Any%20Advice&In-Reply-To=%3C94a5f80b-b18a-4a7e-aa6f-de7a74cd2f22%40m5g2000yqk.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Keeping track of exchanges -- Any Advice">marcus_rubeus at hotmail.com
       </A><BR>
    <I>Mon Jan 30 06:31:34 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017465.html">[rabbitmq-discuss] Keeping track of exchanges -- Any Advice
</A></li>
        <LI>Next message: <A HREF="017760.html">[rabbitmq-discuss] Keeping track of exchanges -- Any Advice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17750">[ date ]</a>
              <a href="thread.html#17750">[ thread ]</a>
              <a href="subject.html#17750">[ subject ]</a>
              <a href="author.html#17750">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Simon, thanks for the response.

I am not really sure to be honest. I am not very familiar with message
brokers and their performance characteristics. I suppose I could have
a topic exchange and then bind queues to various topics... Such as
have a queue for user1.queu1, user2.queue1, user3.queue1, etc

My question is how expensive is routing? Also, regarding the routing,
is it more performant to have one master topic exchange for all the
users or to distribute users across multiple topic exchanges or does
it not matter?

I assume rabbitmq first looks up the exchange and then goes through
each queue to see if there is a match for routing. If this is the
case, I imagine it would be more performant to create a thousand such
topic exchanges and divide all the users across them as opposed to one
topic exchange for all users.


In the end, I plan to run several rabbitmq nodes with a bucket of
users assigned to each rabbit node. Assigning each user to a node
based on a hash. Is this best practice for scaling rabbitmq for this
type of scenerio? Currently rabbitmq is the bottle neck in my
application benchmarks so this was my plan to scale it. Please correct
me if there is a better practice.


On Jan 18, 5:38 am, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">si... at rabbitmq.com</A>&gt; wrote:
&gt;<i> First of all, can you get the routing you need without every user
</I>&gt;<i> requiring their own exchange? What routing do you need to do?
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> On 17/01/12 20:27,MarcusRwrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I have a  setup where I need to use a LOT of unique exchanges /
</I>&gt;<i> &gt; queues.
</I>&gt;<i>
</I>&gt;<i> &gt; To explain. Essentially, think that every &quot;user&quot; has their own
</I>&gt;<i> &gt; exchange and then 3 queues on that exchange. These users may be active
</I>&gt;<i> &gt; for a few minutes to days. The time they exist is unknown (depends on
</I>&gt;<i> &gt; the user). There are hundreds of thousands of users at a time.
</I>&gt;<i> &gt; Periodically, another user may send a message to a user. However, that
</I>&gt;<i> &gt; user may or may not be active (have an exchange / queue associated
</I>&gt;<i> &gt; with it).
</I>&gt;<i>
</I>&gt;<i> &gt; The x-expires feature is great for the queue. If a user is not active
</I>&gt;<i> &gt; in 15 minutes, then all their queues can be deleted. If I set
</I>&gt;<i> &gt; auto_delete on exchanges to be true, it is my understanding that that
</I>&gt;<i> &gt; exchanges will also be deleted once the queues are. Thats great too.
</I>&gt;<i>
</I>&gt;<i> &gt; The problem is when user A sends a message to user B and user B has
</I>&gt;<i> &gt; had their exchange deleted. This will create an error. Ideally, what
</I>&gt;<i> &gt; would happen is rabbitmq would just ignore the message. If the user is
</I>&gt;<i> &gt; not active, then it does not matter if the message just goes to /dev/
</I>&gt;<i> &gt; null.
</I>&gt;<i>
</I>&gt;<i> &gt; Is there a way around this or a way to get the desired behavior? If
</I>&gt;<i> &gt; not, what strategies do people use to determine in real time what
</I>&gt;<i> &gt; exchanges are active or not or what exchanges need to be deleted or
</I>&gt;<i> &gt; not?
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.com</A>
</I>&gt;<i> &gt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I></PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017465.html">[rabbitmq-discuss] Keeping track of exchanges -- Any Advice
</A></li>
	<LI>Next message: <A HREF="017760.html">[rabbitmq-discuss] Keeping track of exchanges -- Any Advice
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17750">[ date ]</a>
              <a href="thread.html#17750">[ thread ]</a>
              <a href="subject.html#17750">[ subject ]</a>
              <a href="author.html#17750">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
