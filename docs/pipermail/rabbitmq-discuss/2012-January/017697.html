<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] priority of the messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20priority%20of%20the%20messages&In-Reply-To=%3C75291187-3a52-4ebc-9815-27389c2a66e1%40ucimail1.uci.cu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017731.html">
   <LINK REL="Next"  HREF="017698.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] priority of the messages</H1>
    <B>Yurisleidy Hern&#225;ndez Moya</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20priority%20of%20the%20messages&In-Reply-To=%3C75291187-3a52-4ebc-9815-27389c2a66e1%40ucimail1.uci.cu%3E"
       TITLE="[rabbitmq-discuss] priority of the messages">ymoya at uci.cu
       </A><BR>
    <I>Thu Jan 26 16:26:57 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017731.html">[rabbitmq-discuss] Uneven file descriptor use on HA Cluster
</A></li>
        <LI>Next message: <A HREF="017698.html">[rabbitmq-discuss] priority of the messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17697">[ date ]</a>
              <a href="thread.html#17697">[ thread ]</a>
              <a href="subject.html#17697">[ subject ]</a>
              <a href="author.html#17697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello 
i'm new in rabbitmq. can i to send messages with a specific priority of the producer for the consumer? 

that is, if the queue has more than one message, the consumer must first receive the message that has the highest priority 

we tested the property of the message &quot;priority&quot; but i not obtained a good result. i send my code. 

Producer.java 
public class Producer { 

private static final String TASK_QUEUE_NAME = &quot;task_queue&quot;; 

public static void main(String[] argv) 
throws java.io.IOException { 

ConnectionFactory factory = new ConnectionFactory(); 
factory.setHost(&quot;localhost&quot;); 
Connection connection = factory.newConnection(); 
Channel channel = connection.createChannel(); 
boolean durable = true; 
channel.queueDeclare(TASK_QUEUE_NAME, durable, false, false, null); 
BasicProperties props = new BasicProperties.Builder().priority(0).build(); 

String message; 

for (int i = 0; i &lt; 3; i++) { 
message = &quot;cerooo&quot;; 

channel.basicPublish(&quot;&quot;, TASK_QUEUE_NAME, props, message.getBytes()); 

System.out.println(&quot; [x] Sent '&quot; + message + &quot;'&quot;); 
} 
channel.close(); 
connection.close(); 
} 
} 

Consumer.java 
public class Consumer { 

private static final String TASK_QUEUE_NAME = &quot;task_queue&quot;; 

public static void main(String[] argv) 
throws java.io.IOException, 
java.lang.InterruptedException { 

ConnectionFactory factory = new ConnectionFactory(); 
factory.setHost(&quot;localhost&quot;); 
Connection connection = factory.newConnection(); 
Channel channel = connection.createChannel(); 

channel.queueDeclare(TASK_QUEUE_NAME, true, false, false, null); 
System.out.println(&quot; [*] Waiting for messages. To exit press CTRL+C&quot;); 

channel.basicQos(1); 

QueueingConsumer consumer = new QueueingConsumer(channel); 
channel.basicConsume(TASK_QUEUE_NAME, false, consumer); 

while (true) { 
QueueingConsumer.Delivery delivery = consumer.nextDelivery(); 
String message = new String(delivery.getBody()); 

System.out.println(&quot; [x] Received '&quot; + message + &quot;'&quot;); 
Thread.sleep(2000); 
System.out.println(&quot; [x] Done&quot;); 

channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); 
} 
} 
} 


Any ideas how I can do this? 

thanks in advance. 



Saludos, 
Yuri. 





Fin a la injusticia, LIBERTAD AHORA A NUESTROS CINCO COMPATRIOTAS QUE SE ENCUENTRAN INJUSTAMENTE EN PRISIONES DE LOS EEUU!
<A HREF="http://www.antiterroristas.cu">http://www.antiterroristas.cu</A>
<A HREF="http://justiciaparaloscinco.wordpress.com">http://justiciaparaloscinco.wordpress.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120126/00d22603/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120126/00d22603/attachment.htm</A>&gt;
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017731.html">[rabbitmq-discuss] Uneven file descriptor use on HA Cluster
</A></li>
	<LI>Next message: <A HREF="017698.html">[rabbitmq-discuss] priority of the messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17697">[ date ]</a>
              <a href="thread.html#17697">[ thread ]</a>
              <a href="subject.html#17697">[ subject ]</a>
              <a href="author.html#17697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
