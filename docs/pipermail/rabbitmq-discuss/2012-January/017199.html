<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Irregular service failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Irregular%20service%20failure&In-Reply-To=%3CCAFHLqDJSGhpfXf1UwD0PcLh0%3D7khdcOhFX4seotrku9LkCNFiw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017207.html">
   <LINK REL="Next"  HREF="017203.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Irregular service failure</H1>
    <B>Michael Nye</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Irregular%20service%20failure&In-Reply-To=%3CCAFHLqDJSGhpfXf1UwD0PcLh0%3D7khdcOhFX4seotrku9LkCNFiw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Irregular service failure">michael.nye1 at gmail.com
       </A><BR>
    <I>Thu Jan  5 23:57:21 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017207.html">[rabbitmq-discuss] Problem with transaction handling on high availability queues
</A></li>
        <LI>Next message: <A HREF="017203.html">[rabbitmq-discuss] Irregular service failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17199">[ date ]</a>
              <a href="thread.html#17199">[ thread ]</a>
              <a href="subject.html#17199">[ subject ]</a>
              <a href="author.html#17199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I am currently using RabbitMQ in a reasonably high throughput manner, I
would guess 100,000+ messages per day being sent through it.  The install
is on a Windows Server 2008 R2 box and all applications are in C# with
everything running on the same machine.

The service will run fine for weeks, months but then randomly (so far it
has happened 2 or 3 times) it appears the service just stops working.  All
applications will start throwing an exception AlreadyClosedException, and
stop being able to send messages.  To get things working again, I stop all
applications, restart the rabbitmq service, and start the applications
again.

I am not sure where to start in terms of debugging this, so am interested
in hearing what people would suggest to try to track down why this is
happening (I am only a basic user of rabbit).  I believe the RabbitMQ
service install is a stock standard install of version 2.6.1, so
potentially an upgrade to 2.7.1 may clear things up.

For the record here is the exception being thrown,

The AMQP operation was interrupted: AMQP close-reason, initiated by
Library, code=541, text=&quot;Unexpected Exception&quot;, classId=0, methodId=0,
cause=System.IO.IOException: Unable to read data from the transport
connection: An existing connection was forcibly closed by the remote host.
---&gt; System.Net.Sockets.SocketException: An existing connection was
forcibly closed by the remote host
  at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset,
Int32 size)
  --- End of inner exception stack trace ---
  at RabbitMQ.Client.Impl.Frame.ReadFrom(NetworkBinaryReader reader)
  at RabbitMQ.Client.Impl.SocketFrameHandler_0_9.ReadFrame()
  at RabbitMQ.Client.Impl.ConnectionBase.MainLoopIteration()
  at RabbitMQ.Client.Impl.ConnectionBase.MainLoop()
 Source = RabbitMQ.Client

 StackTrace:
      at RabbitMQ.Client.Impl.SessionBase.Transmit(Command cmd)
  at RabbitMQ.Client.Impl.ModelBase.ModelSend(MethodBase method,
ContentHeaderBase header, Byte[] body)
  at RabbitMQ.Client.Impl.ModelBase.BasicPublish(String exchange, String
routingKey, Boolean mandatory, Boolean immediate, IBasicProperties
basicProperties, Byte[] body)
  at RabbitMQ.Client.Impl.ModelBase.BasicPublish(String exchange, String
routingKey, IBasicProperties basicProperties, Byte[] body)
  at ...

Any help to track down the cause of this problem is appreciated!

Thanks,

Michael.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120106/b6e9d6af/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120106/b6e9d6af/attachment.htm</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017207.html">[rabbitmq-discuss] Problem with transaction handling on high availability queues
</A></li>
	<LI>Next message: <A HREF="017203.html">[rabbitmq-discuss] Irregular service failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17199">[ date ]</a>
              <a href="thread.html#17199">[ thread ]</a>
              <a href="subject.html#17199">[ subject ]</a>
              <a href="author.html#17199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
