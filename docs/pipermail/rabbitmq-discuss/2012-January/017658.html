<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20Issues%3A%20Disconnects%20and%20Failures%0A%20on%09Queue%20Bind%20-%202012-01-20&In-Reply-To=%3C4F2029AC.6010502%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017628.html">
   <LINK REL="Next"  HREF="017661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20Issues%3A%20Disconnects%20and%20Failures%0A%20on%09Queue%20Bind%20-%202012-01-20&In-Reply-To=%3C4F2029AC.6010502%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20">simon at rabbitmq.com
       </A><BR>
    <I>Wed Jan 25 16:11:24 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017628.html">[rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20
</A></li>
        <LI>Next message: <A HREF="017661.html">[rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17658">[ date ]</a>
              <a href="thread.html#17658">[ thread ]</a>
              <a href="subject.html#17658">[ subject ]</a>
              <a href="author.html#17658">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 24/01/12 18:37, DawgTool wrote:
&gt;<i> What I was hoping to see that Cluster(002) would be about half the cpu
</I>&gt;<i> consumption as Cluster(001).
</I>&gt;<i> Or something like the scenario of publishing to a cluster on host 1 with
</I>&gt;<i> the queue on host 2.
</I>&gt;<i> Host 1 would take on the message handling from the publisher and hand it
</I>&gt;<i> off to host 2 which writes to the queue (spreads the load across the
</I>&gt;<i> cluster, but adds a little overhead).
</I>
Remember that when you publish across federation there is more than one 
publish involved! The federation plugin:

* Binds a queue to the upstream exchange
* Consumes messages from this queue
* Republishes them downstream

and then presumably something consumes them downstream too.

So there is more work going on. I'm surprised it's 4x though, but the 
federation plugin has not received any performance testing yet.

I'm also surprised both nodes in both clusters were equally busy - or 
does your test load balance across them?

&gt;<i> Please let me know if I have missed something, or if you can think of
</I>&gt;<i> any tricks to reduce the cpu usage.
</I>
Have you turned on hipe_compile? That should help at least.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017628.html">[rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20
</A></li>
	<LI>Next message: <A HREF="017661.html">[rabbitmq-discuss] Federation Issues: Disconnects and Failures on	Queue Bind - 2012-01-20
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17658">[ date ]</a>
              <a href="thread.html#17658">[ thread ]</a>
              <a href="subject.html#17658">[ subject ]</a>
              <a href="author.html#17658">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
