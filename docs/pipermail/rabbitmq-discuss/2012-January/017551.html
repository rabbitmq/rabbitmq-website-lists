<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Determining age of queue contents
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Determining%20age%20of%20queue%20contents&In-Reply-To=%3C91B22DD70758443E8B45B1B44739CE7E%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017614.html">
   <LINK REL="Next"  HREF="017559.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Determining age of queue contents</H1>
    <B>Alexander Staubo</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Determining%20age%20of%20queue%20contents&In-Reply-To=%3C91B22DD70758443E8B45B1B44739CE7E%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Determining age of queue contents">alex at purefiction.net
       </A><BR>
    <I>Sun Jan 22 14:23:45 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017614.html">[rabbitmq-discuss] Shovel questions
</A></li>
        <LI>Next message: <A HREF="017559.html">[rabbitmq-discuss] Determining age of queue contents
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17551">[ date ]</a>
              <a href="thread.html#17551">[ thread ]</a>
              <a href="subject.html#17551">[ subject ]</a>
              <a href="author.html#17551">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[Please CC as I am not on the list.]

The fine-grained stats plugin provides information about message processing rate and queue lengths, which can be used to infer whether a queue is &quot;lagging&quot;. Two problems:

1. The only way to reliably infer the true processing rate of a queue is to implement a stateful watching algorithm, being a function both of the current processing rate as well as the *growth rate* of the queue; a queue that grows faster than messages are processes is a potential bottleneck. While fairly trivial to write, when you merely want to monitor queues from a Nagios plugin, I would wish this was something built into RabbitMQ itself, closest to where the information is stored. A Nagios plugin would have to store state data in the file system.

2. Even when looking at processing rate and growth rate, there is not enough sufficient information to determine a realistic churn rate. What's really needed is to track the age of the newest and last messages in the queue. If you have this age difference, you can define acceptables deadline for message processing in a monitoring system, which is a better heuristic than the processing rate.

Would it be possible to implement a way to extract a per-queue age value (in a performant way)?
</PRE>



















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017614.html">[rabbitmq-discuss] Shovel questions
</A></li>
	<LI>Next message: <A HREF="017559.html">[rabbitmq-discuss] Determining age of queue contents
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17551">[ date ]</a>
              <a href="thread.html#17551">[ thread ]</a>
              <a href="subject.html#17551">[ subject ]</a>
              <a href="author.html#17551">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
