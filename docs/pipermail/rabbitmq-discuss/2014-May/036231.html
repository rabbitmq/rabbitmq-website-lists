<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] frame size eror: source F5 Loadbalancer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20frame%20size%20eror%3A%20source%20F5%20Loadbalancer&In-Reply-To=%3C6789221D917755409AD829E5EF0EAF5B7F7AD8B5%40venmail01.vistaprint.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036232.html">
   <LINK REL="Next"  HREF="036295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] frame size eror: source F5 Loadbalancer</H1>
    <B>Stephen Ehlas</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20frame%20size%20eror%3A%20source%20F5%20Loadbalancer&In-Reply-To=%3C6789221D917755409AD829E5EF0EAF5B7F7AD8B5%40venmail01.vistaprint.net%3E"
       TITLE="[rabbitmq-discuss] frame size eror: source F5 Loadbalancer">s.ehlas at albumprinter.com
       </A><BR>
    <I>Fri May 23 10:22:10 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036232.html">[rabbitmq-discuss] RabbitMQ 3.3.0 .NET producer/STOMP consumer: bad content-length possible?
</A></li>
        <LI>Next message: <A HREF="036295.html">[rabbitmq-discuss] frame size eror: source F5 Loadbalancer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36231">[ date ]</a>
              <a href="thread.html#36231">[ thread ]</a>
              <a href="subject.html#36231">[ subject ]</a>
              <a href="author.html#36231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

We have a curious situation with RabbitMQ. When the clients try to connect directly to a rabbitMQ node, all is ok. When we pass them through our F5 load balancer, the 3rd connection attempt is aborted. The load balancer is set to round robin. In the RabbitMQ logs we see this:

=ERROR REPORT==== 22-May-2014::15:25:36 ===
AMQP connection &lt;0.13650.16&gt; (closed), channel 19793 - error:
{amqp_error,frame_error,
            &quot;type 65, all octets = &lt;&lt;&gt;&gt;: {frame_too_large,1342177289,131064}&quot;,
            none}

=ERROR REPORT==== 22-May-2014::15:25:39 ===
closing AMQP connection &lt;0.13650.16&gt; (192.168.x.x:50614 -&gt; 192.168.x.x:5672):
fatal_frame_error

=ERROR REPORT==== 22-May-2014::15:25:39 ===
AMQP connection &lt;0.13665.16&gt; (closed), channel 19793 - error:
{amqp_error,frame_error,
            &quot;type 65, all octets = &lt;&lt;&gt;&gt;: {frame_too_large,1342177289,131064}&quot;,
            none}

=ERROR REPORT==== 22-May-2014::15:25:42 ===
closing AMQP connection &lt;0.13665.16&gt; (192.168.x.x:50615 -&gt; 192.168.x.x:5672):
fatal_frame_error

On the client side we see this error:

15867 ERROR MassTransit.Context.ServiceBusReceiveContext - Consumer Exception Exposed
None of the specified endpoints were reachable
Endpoints attempted:
------------------------------------------------
endpoint=amqp-0-9://&lt;HOSTNAME&gt;:5672, attempts=1
RabbitMQ.Client.Exceptions.ProtocolVersionMismatchException: AMQP server protocol negotiation failure: server version unknown-unknown, client version 0-9

Has anyone seen this before?

Regards

Stephen Ehlas
Senior IT Systems Engineer
T:             +31 (0)20 521 89 50
M:           +31 (0)6 239 084 15
E:             <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">stephen.ehlas at albumprinter.com</A>
W:           www.albumprinter.org&lt;<A HREF="http://www.albumprinter.org/">http://www.albumprinter.org/</A>&gt; / www.werkenbijalbelli.nl&lt;<A HREF="http://www.werkenbijalbelli.nl/">http://www.werkenbijalbelli.nl/</A>&gt;
[cid:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">image001.png at 01CE607F.9C048CA0</A>]
Create your own photo book &amp; make moments last a lifetime!
Silver Tower
Stationsplein 53-57, 1012 AB Amsterdam, The Netherlands
P.O. box 14606, 1001 LC Amsterdam, The Netherlands
Albumprinter operates with its consumer brand Albelli in The Netherlands&lt;<A HREF="http://www.albelli.nl/">http://www.albelli.nl/</A>&gt;, Belgium&lt;<A HREF="http://www.albelli.be/">http://www.albelli.be/</A>&gt;, Germany&lt;<A HREF="http://www.albelli.de/">http://www.albelli.de/</A>&gt;, France&lt;<A HREF="http://www.albelli.fr/">http://www.albelli.fr/</A>&gt;, Norway&lt;<A HREF="http://www.allfoto.no/">http://www.allfoto.no/</A>&gt;, Sweden&lt;<A HREF="http://www.onskefoto.se/">http://www.onskefoto.se/</A>&gt; and the United Kingdom&lt;<A HREF="http://www.albelli.co.uk/">http://www.albelli.co.uk/</A>&gt;
[cid:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">image002.png at 01CE607F.9C048CA0</A>]&lt;<A HREF="http://nl-nl.facebook.com/AlbelliNL">http://nl-nl.facebook.com/AlbelliNL</A>&gt;   [cid:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">image003.png at 01CE607F.9C048CA0</A>] &lt;<A HREF="http://twitter.com/#!/albelli_nl">http://twitter.com/#!/albelli_nl</A>&gt;    [cid:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">image004.png at 01CE607F.9C048CA0</A>] &lt;<A HREF="http://blog.albelli.nl/">http://blog.albelli.nl/</A>&gt;     [cid:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">image005.png at 01CE607F.9C048CA0</A>] &lt;<A HREF="http://albellinl.hyves.nl/">http://albellinl.hyves.nl/</A>&gt;     [cid:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">image006.png at 01CE607F.9C048CA0</A>] &lt;<A HREF="http://www.youtube.com/watch?v=dhSmjKmmKn0">http://www.youtube.com/watch?v=dhSmjKmmKn0</A>&gt;



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 9640 bytes
Desc: image001.png
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 1846 bytes
Desc: image002.png
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0001.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0001.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 1803 bytes
Desc: image003.png
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0002.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0002.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 2038 bytes
Desc: image004.png
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0003.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0003.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.png
Type: image/png
Size: 1577 bytes
Desc: image005.png
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0004.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0004.png</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image006.png
Type: image/png
Size: 1896 bytes
Desc: image006.png
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0005.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140523/f742673e/attachment-0005.png</A>&gt;
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036232.html">[rabbitmq-discuss] RabbitMQ 3.3.0 .NET producer/STOMP consumer: bad content-length possible?
</A></li>
	<LI>Next message: <A HREF="036295.html">[rabbitmq-discuss] frame size eror: source F5 Loadbalancer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36231">[ date ]</a>
              <a href="thread.html#36231">[ thread ]</a>
              <a href="subject.html#36231">[ subject ]</a>
              <a href="author.html#36231">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
