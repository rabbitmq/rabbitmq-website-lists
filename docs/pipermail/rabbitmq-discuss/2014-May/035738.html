<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ LDAP Configuration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20LDAP%20Configuration&In-Reply-To=%3CCDC7045479A93A4FB2E32D4B83A22B5F39ABBD77%40W12112.ldschurch.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035719.html">
   <LINK REL="Next"  HREF="035743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ LDAP Configuration</H1>
    <B>Mark Soderquist</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20LDAP%20Configuration&In-Reply-To=%3CCDC7045479A93A4FB2E32D4B83A22B5F39ABBD77%40W12112.ldschurch.org%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ LDAP Configuration">SoderquistMV at ldschurch.org
       </A><BR>
    <I>Thu May  1 20:04:40 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035719.html">[rabbitmq-discuss] Hostname Verification for SSL connections
</A></li>
        <LI>Next message: <A HREF="035743.html">[rabbitmq-discuss] RabbitMQ LDAP Configuration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35738">[ date ]</a>
              <a href="thread.html#35738">[ thread ]</a>
              <a href="subject.html#35738">[ subject ]</a>
              <a href="author.html#35738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We are trying to connect Rabbit with our Active Directory LDAP server but still have not found the right configuration. Let me give you the use case:

We want to be able to authenticate administrative users against LDAP for the management console. Our LDAP server is ldschurch.org. We are required to authenticate using the svc-ldap account before making queries. We have tried several different configuration options but nothing has worked so far. Here is the configuration we thought most likely to work:

[
  {rabbit, [{auth_backends, [rabbit_auth_backend_ldap, rabbit_auth_backend_internal]}]},
  {rabbitmq_auth_backend_ldap,
   [ {servers,               [&quot;ldschurch.org&quot;]},
     {dn_lookup_bind,        {&quot;cn=svc-ldap,ou=srv-app-accts,dc=ldschurch,dc=org&quot;, &quot;password&quot;}},
     {dn_lookup_base,        &quot;dc=ldschurch,dc=org&quot;},
     {dn_lookup_attribute,   &quot;cn&quot;},
     {use_ssl,               false},
     {port,                  389},
     {log,                   false}
   ]
  }
].

We can tell by watching the TCP traffic that the bind user is not part of the request, only the authenticating user, which is admmvs1 in our situation.

Here is the log output:
=INFO REPORT==== 1-May-2014::11:22:29 ===
LDAP CHECK: login for admmvs1

=INFO REPORT==== 1-May-2014::11:22:29 ===
        LDAP filling template &quot;${username}&quot; with
            [{username,&lt;&lt;&quot;admmvs1&quot;&gt;&gt;}]

=INFO REPORT==== 1-May-2014::11:22:29 ===
        LDAP template result: &quot;admmvs1&quot;

=INFO REPORT==== 1-May-2014::11:22:29 ===
    LDAP bind returned &quot;invalid credentials&quot;: admmvs1

=INFO REPORT==== 1-May-2014::11:22:29 ===
LDAP DECISION: login for admmvs1: denied

What did we do wrong in our configuration?


 NOTICE: This email message is for the sole use of the intended recipient(s) and may contain confidential and privileged information. Any unauthorized review, use, disclosure or distribution is prohibited. If you are not the intended recipient, please contact the sender by reply email and destroy all copies of the original message.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140501/125f4290/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140501/125f4290/attachment.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035719.html">[rabbitmq-discuss] Hostname Verification for SSL connections
</A></li>
	<LI>Next message: <A HREF="035743.html">[rabbitmq-discuss] RabbitMQ LDAP Configuration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35738">[ date ]</a>
              <a href="thread.html#35738">[ thread ]</a>
              <a href="subject.html#35738">[ subject ]</a>
              <a href="author.html#35738">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
