<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20JNDI%20/%20.bindings%20with%20RabbitMQ%20JMS%20Client%3F&In-Reply-To=%3C1400370019523-35631.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036072.html">
   <LINK REL="Next"  HREF="036075.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?</H1>
    <B>scguy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20JNDI%20/%20.bindings%20with%20RabbitMQ%20JMS%20Client%3F&In-Reply-To=%3C1400370019523-35631.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?">npetrace at gmail.com
       </A><BR>
    <I>Sun May 18 00:40:19 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036072.html">[rabbitmq-discuss] using autorecovery in case of broken connection
</A></li>
        <LI>Next message: <A HREF="036075.html">[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36058">[ date ]</a>
              <a href="thread.html#36058">[ thread ]</a>
              <a href="subject.html#36058">[ subject ]</a>
              <a href="author.html#36058">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Question...I'm trying to use the RabbitMQ JMS client with an existing JMS
client application.  

I have written a sample java program, and am referencing a .bindings file
(below).  I have the following plugins installed on my RabbitMQ server (this
is on Windows):

C:\dev\rabbitmq330\rabbit\sbin&gt;rabbitmq-plugins list
[e] amqp_client                       3.3.0
[ ] cowboy                            0.5.0-rmq3.3.0-git4b93c2d
[ ] eldap                             3.3.0-gite309de4
[e] mochiweb                          2.7.0-rmq3.3.0-git680dba8
[ ] rabbitmq_amqp1_0                  3.3.0
[ ] rabbitmq_auth_backend_ldap        3.3.0
[ ] rabbitmq_auth_mechanism_ssl       3.3.0
[ ] rabbitmq_consistent_hash_exchange 3.3.0
[ ] rabbitmq_federation               3.3.0
[ ] rabbitmq_federation_management    3.3.0
[E] rabbitmq_jms_topic_exchange       1.2.0-rmq3.3.0
[e] rabbitmq_jsonrpc                  3.3.x-24fb08eb
[E] rabbitmq_jsonrpc_channel          3.3.x-40bdb08c
[E] rabbitmq_management               3.3.0
[e] rabbitmq_management_agent         3.3.0
[E] rabbitmq_management_visualiser    3.3.0
[ ] rabbitmq_mqtt                     3.3.0
[ ] rabbitmq_shovel                   3.3.0
[ ] rabbitmq_shovel_management        3.3.0
[E] rabbitmq_stomp                    3.3.0
[ ] rabbitmq_tracing                  3.3.0
[e] rabbitmq_web_dispatch             3.3.0
[ ] rabbitmq_web_stomp                3.3.0
[ ] rabbitmq_web_stomp_examples       3.3.0
[e] rfc4627_jsonrpc                   3.3.x-git5e67120
[ ] sockjs                            0.3.4-rmq3.3.0-git3132eb9
[e] webmachine                        1.10.3-rmq3.3.0-gite9359c7

I have the following on my classpath:

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;classpath&gt;
    &lt;classpathentry kind=&quot;src&quot; path=&quot;src&quot;/&gt;
    &lt;classpathentry kind=&quot;con&quot;
path=&quot;org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/jdk1.7.0_25&quot;/&gt;
    &lt;classpathentry kind=&quot;lib&quot;
path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/amqp-client-3.3.0.jar&quot;/&gt;
    &lt;classpathentry kind=&quot;lib&quot;
path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/fscontext.jar&quot;/&gt;
    &lt;classpathentry kind=&quot;lib&quot;
path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/geronimo-jms_1.1_spec-1.1.1.jar&quot;/&gt;
    &lt;classpathentry kind=&quot;lib&quot;
path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/providerutil.jar&quot;/&gt;
    &lt;classpathentry kind=&quot;lib&quot;
path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/slf4j-api-1.7.5.jar&quot;/&gt;
    &lt;classpathentry kind=&quot;lib&quot;
path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/rabbitmq-jms-1.2.0.jar&quot;/&gt;
    &lt;classpathentry kind=&quot;output&quot; path=&quot;bin&quot;/&gt;
&lt;/classpath&gt;

However, when I attempt to run my java program, I get the following error. 
This is where I am stuck...I'm not sure what is wrong...as the mentioned
class is in the rabbitmq-jms-1.2.0.jar file, and that jar is on my
classpath.  Any thoughts on what I have done wrong?  I need to use the JMS
client...otherwise I would just use the AMQP library.

Code snippet (the error occurs on the connection factory lookup):

Hashtable&lt;String, String&gt; env = new Hashtable&lt;String, String&gt;();
env.put(Context.INITIAL_CONTEXT_FACTORY,
&quot;com.sun.jndi.fscontext.RefFSContextFactory&quot;);
env.put(Context.PROVIDER_URL, &quot;file:/rabbitmq&quot;); // directory where the
.bindings file is located
      
mContext = new InitialContext(env);

ConnectionFactory connectionFactory = (ConnectionFactory)
mContext.lookup(&quot;ConnectionFactory&quot;);
mConnection = connectionFactory.createConnection();
mConnection.start();      

.bindings file:

ConnectionFactory/ClassName=com.rabbitmq.jms.admin.RMQConnectionFactory
ConnectionFactory/FactoryName=com.rabbitmq.jms.admin.RMQObjectFactory
 
ConnectionFactory/RefAddr/0/Content=jms/ConnectionFactory
ConnectionFactory/RefAddr/0/Type=name
ConnectionFactory/RefAddr/0/Encoding=String
 
ConnectionFactory/RefAddr/1/Content=javax.jms.ConnectionFactory
ConnectionFactory/RefAddr/1/Type=type
ConnectionFactory/RefAddr/1/Encoding=String
 
ConnectionFactory/RefAddr/2/Content=com.rabbitmq.jms.admin.RMQObjectFactory
ConnectionFactory/RefAddr/2/Type=factory
ConnectionFactory/RefAddr/2/Encoding=String
 
# Change this line accordingly if the broker is not at localhost
ConnectionFactory/RefAddr/3/Content=localhost
ConnectionFactory/RefAddr/3/Type=host
ConnectionFactory/RefAddr/3/Encoding=String

#Destinations
TempQueue/ClassName=com.rabbitmq.jms.admin.RMQDestination
TempQueue/FactoryName=com.rabbitmq.jms.admin.RMQObjectFactory
 
TempQueue/RefAddr/0/Content=jms/Queue
TempQueue/RefAddr/0/Type=name
TempQueue/RefAddr/0/Encoding=String
 
TempQueue/RefAddr/1/Content=javax.jms.Queue
TempQueue/RefAddr/1/Type=type
TempQueue/RefAddr/1/Encoding=String
 
TempQueue/RefAddr/2/Content=com.rabbitmq.jms.admin.RMQObjectFactory
TempQueue/RefAddr/2/Type=factory
TempQueue/RefAddr/2/Encoding=String
 
TempQueue/RefAddr/3/Content=TempQueue
TempQueue/RefAddr/3/Type=destinationName
TempQueue/RefAddr/3/Encoding=String

C:\TEMP&gt;java -jar rabbitmqjms.jar
SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See <A HREF="http://www.slf4j.org/codes.html#StaticLoggerBinder">http://www.slf4j.org/codes.html#StaticLoggerBinder</A> for further
details.
Exception in thread &quot;main&quot; java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at
org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:58)
Caused by: javax.naming.NamingException: Unknown class
[com.rabbitmq.jms.admin.RMQConnectionFactory]
        at
com.rabbitmq.jms.admin.RMQObjectFactory.getObjectInstance(RMQObjectFactory.java:132)
        at
javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:321)
        at com.sun.jndi.fscontext.RefFSContext.lookup(RefFSContext.java:146)
        at com.sun.jndi.fscontext.FSContext.lookup(FSContext.java:127)
        at javax.naming.InitialContext.lookup(InitialContext.java:411)
        at rabbitMQJMSTestDriver.&lt;init&gt;(rabbitMQJMSTestDriver.java:31)
        at rabbitMQJMSTestDriver.main(rabbitMQJMSTestDriver.java:107)
        ... 5 more



--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/JNDI-bindings-with-RabbitMQ-JMS-Client-tp35631.html">http://rabbitmq.1065348.n5.nabble.com/JNDI-bindings-with-RabbitMQ-JMS-Client-tp35631.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036072.html">[rabbitmq-discuss] using autorecovery in case of broken connection
</A></li>
	<LI>Next message: <A HREF="036075.html">[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36058">[ date ]</a>
              <a href="thread.html#36058">[ thread ]</a>
              <a href="subject.html#36058">[ subject ]</a>
              <a href="author.html#36058">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
