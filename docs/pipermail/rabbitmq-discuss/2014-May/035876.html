<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Network partition queue issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Network%20partition%20queue%20issues&In-Reply-To=%3CAD8BDDA3D61AC241BA02DED7063643BAB3D3786A%40osl02-exc-001%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035930.html">
   <LINK REL="Next"  HREF="035901.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Network partition queue issues</H1>
    <B>Jon Bergli Heier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Network%20partition%20queue%20issues&In-Reply-To=%3CAD8BDDA3D61AC241BA02DED7063643BAB3D3786A%40osl02-exc-001%3E"
       TITLE="[rabbitmq-discuss] Network partition queue issues">jon.bergli.heier at zisson.no
       </A><BR>
    <I>Fri May  9 12:26:11 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035930.html">[rabbitmq-discuss] silent crashes
</A></li>
        <LI>Next message: <A HREF="035901.html">[rabbitmq-discuss] Network partition queue issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35876">[ date ]</a>
              <a href="thread.html#35876">[ thread ]</a>
              <a href="subject.html#35876">[ subject ]</a>
              <a href="author.html#35876">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Yesterday we had two unfortunate network partitions on one of our two-node
clusters, about an hour apart. After the second partition, when we restarted
one of the nodes, we encountered some issues:

1) one of the queues disappeared, including any queued messages.
2) two other queues appears hung and doesn't respond to anything.

We've managed to resolve 1) by recreating the queue and bindings and
republishing the messages, but 2) is still a problem, as we can't do anything
with these queues, not even delete them (the management interface and API just
hangs when trying to delete). Any consumers also appears to hang when
interacting with these queues. Restarting the entire cluster also didn't help.

Is there any way to prevent 1), and can we somehow solve 2) without resetting
the entire cluster? We're currently running RabbitMQ 3.2.4. I have logs
available, but I'd rather not post these publicly since there's some sensitive
data in there.

FTR we're using autoheal and all queues on the cluster have ha-mode=all and
ha-sync-mode=automatic. Also, according to heartbeat, the nodes only appears to
have lost contact for a few seconds (nothing seems to be logged during the
second split).

Thanks,
Jon
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035930.html">[rabbitmq-discuss] silent crashes
</A></li>
	<LI>Next message: <A HREF="035901.html">[rabbitmq-discuss] Network partition queue issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35876">[ date ]</a>
              <a href="thread.html#35876">[ thread ]</a>
              <a href="subject.html#35876">[ subject ]</a>
              <a href="author.html#35876">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
