<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Basic.Acks terribly slow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Basic.Acks%20terribly%20slow&In-Reply-To=%3C536CB1B6.3000101%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035870.html">
   <LINK REL="Next"  HREF="035877.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Basic.Acks terribly slow</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Basic.Acks%20terribly%20slow&In-Reply-To=%3C536CB1B6.3000101%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Basic.Acks terribly slow">simon at rabbitmq.com
       </A><BR>
    <I>Fri May  9 11:45:10 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035870.html">[rabbitmq-discuss] Basic.Acks terribly slow
</A></li>
        <LI>Next message: <A HREF="035877.html">[rabbitmq-discuss] Basic.Acks terribly slow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35874">[ date ]</a>
              <a href="thread.html#35874">[ thread ]</a>
              <a href="subject.html#35874">[ subject ]</a>
              <a href="author.html#35874">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/05/14 02:19, Arun Rao wrote:
&gt;<i> Hi guys -
</I>&gt;<i>
</I>&gt;<i> Producers (.NET clients) are publishing messages to RabbitMQ cluster at
</I>&gt;<i> a rate of 800 to 900 messages/sec. At this rate, RabbitMQ response times
</I>&gt;<i> to Ack producers goes significantly higher. It takes longer than 500ms
</I>&gt;<i> to ack with a delivery-tag, per channel. (Total Connections: 3000+ at
</I>&gt;<i> all times.)
</I>
Fundamentally latency is likely to go up when you push the server 
harder; when any given piece of work needs to be done the component that 
needs to do it is doing something else that's unlikely to be avoidable.

&gt;<i> Objective: Reduce RabbitMQ server response time to less than 100ms when
</I>&gt;<i> acknowledging messages on each channel. (Please see we are reusing
</I>&gt;<i> connections.)
</I>
You don't say whether the messages are persistent but I would guess from 
the performance numbers you give that they are. In that case you could 
lower latency by moving to an SSD.

But really, if it's a problem that publish confirms are taking 500ms to 
come back then you might have the wrong expectations; RabbitMQ tries to 
optimise for throughput rather than latency when deciding when to send 
confirms.

Is each producer waiting for each confirm to come back before publishing 
the next message? If so I suggest not doing that; allow publishers to 
have multiple outstanding messages and handle confirms as they come in. 
If you are already doing that, why is waiting 500ms a big deal?

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035870.html">[rabbitmq-discuss] Basic.Acks terribly slow
</A></li>
	<LI>Next message: <A HREF="035877.html">[rabbitmq-discuss] Basic.Acks terribly slow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35874">[ date ]</a>
              <a href="thread.html#35874">[ thread ]</a>
              <a href="subject.html#35874">[ subject ]</a>
              <a href="author.html#35874">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
