<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ and batch processing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20and%20batch%20processing&In-Reply-To=%3CCANpjuCvmydt%3DUJxj0MfeCJB9pDnr-JzG8FaY1AOw0guqLkYDkA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036096.html">
   <LINK REL="Next"  HREF="036127.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ and batch processing</H1>
    <B>Greg Poirier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20and%20batch%20processing&In-Reply-To=%3CCANpjuCvmydt%3DUJxj0MfeCJB9pDnr-JzG8FaY1AOw0guqLkYDkA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ and batch processing">greg.poirier at opower.com
       </A><BR>
    <I>Tue May 20 01:02:28 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036096.html">[rabbitmq-discuss] RabbitMQ and batch processing
</A></li>
        <LI>Next message: <A HREF="036127.html">[rabbitmq-discuss] RabbitMQ and batch processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36099">[ date ]</a>
              <a href="thread.html#36099">[ thread ]</a>
              <a href="subject.html#36099">[ subject ]</a>
              <a href="author.html#36099">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, May 19, 2014 at 2:32 PM, Laing, Michael
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.laing at nytimes.com</A>&gt;wrote:

&gt;<i> snip:
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So do you persist every messages sent via Fabrik? I think we could do
</I>&gt;&gt;<i> this for some things, but we would have to have TTLs for others. We could
</I>&gt;&gt;<i> even have our persistence store honor TTLs that are assigned during queue
</I>&gt;&gt;<i> creation, I think. I wonder if Cassandra has something built in that would
</I>&gt;&gt;<i> make this easy for us.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Yes. We allow internal clients to assign a 'cache_ttl' for each message.
</I>&gt;<i> When we persist the message in Cassandra we set that ttl. By default the
</I>&gt;<i> cache_ttl is 3 days, max is 30 days.
</I>&gt;<i>
</I>&gt;<i> The above applies to persistence by 'path' - each message may have
</I>&gt;<i> multiple paths - think of a path as a folder for the message that is
</I>&gt;<i> formatted like a routing key, e.g. 'feeds-item.breaking-news.1224'. Within
</I>&gt;<i> each path/folder messages are stored latest-first by a timeuuid (uuid
</I>&gt;<i> version 1). Searches for the 'latest' n messages in a path subtree are very
</I>&gt;<i> efficient.
</I>&gt;<i>
</I>
Aha! This is really cool!

I like the idea of being able to keep a large &quot;buffer&quot; so to speak of
recently sent messages available for analysis. So, a failed batch job could
very easily inspect the actual messages that were persisted/sent in an
effort to debug. That is pretty sweet. Cassandra is very nice for this as
well, since persistence to C* is can be delegated to a consumer in the
buffer layer or core. Do you simply shovel everything to a particular path
queue for something to persist to Cassandra? Or is that done inline
somewhere before publishing to RabbitMQ? I assume that that kind of thing
is done out-of-band of the client.


&gt;<i> We also 'journal' all messages with ttl of 30 days. It has worked well for
</I>&gt;<i> us and we can easily scale up and down. The fast generalized cache makes it
</I>&gt;<i> possible to support quite interesting apps.
</I>&gt;<i>
</I>
Hmm. I'm not sure I follow. What do you mean by journal?

I am also curious about some of the things you do with Fabrik... For
example, is persistence handled by the client (indirectly via the Fabrik
library) or some other component service that listens to RabbitMQ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140519/7aa78a32/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140519/7aa78a32/attachment.html</A>&gt;
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036096.html">[rabbitmq-discuss] RabbitMQ and batch processing
</A></li>
	<LI>Next message: <A HREF="036127.html">[rabbitmq-discuss] RabbitMQ and batch processing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36099">[ date ]</a>
              <a href="thread.html#36099">[ thread ]</a>
              <a href="subject.html#36099">[ subject ]</a>
              <a href="author.html#36099">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
