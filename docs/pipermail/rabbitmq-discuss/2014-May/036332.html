<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Scaling to large number of bindings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Scaling%20to%20large%20number%20of%20bindings&In-Reply-To=%3C53870E49.4070309%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036303.html">
   <LINK REL="Next"  HREF="036305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Scaling to large number of bindings</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Scaling%20to%20large%20number%20of%20bindings&In-Reply-To=%3C53870E49.4070309%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Scaling to large number of bindings">simon at rabbitmq.com
       </A><BR>
    <I>Thu May 29 11:39:05 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036303.html">[rabbitmq-discuss] Scaling to large number of bindings
</A></li>
        <LI>Next message: <A HREF="036305.html">[rabbitmq-discuss] Run RabbitMQ Service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36332">[ date ]</a>
              <a href="thread.html#36332">[ thread ]</a>
              <a href="subject.html#36332">[ subject ]</a>
              <a href="author.html#36332">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27/05/14 22:17, Aaron Dufour wrote:
&gt;<i> On the other end, I would have an exchange on each outgoing server that
</I>&gt;<i> the queues would bind to (a direct exchange - they are binding to exact
</I>&gt;<i> routing keys).  However, when I federate this to the outgoing exchanges
</I>&gt;<i> on the routing servers, every binding is stored on every routing server,
</I>&gt;<i> which puts a hard ceiling on the number of bindings I can make.  Ideally
</I>&gt;<i> the outgoing servers would only tell each routing server about the
</I>&gt;<i> bindings it cares about (since each routing server is only dealing with
</I>&gt;<i> a known subset of messages, based on routing keys), but I can't see a
</I>&gt;<i> way to make this happen.
</I>
I am not sure I fully understand your explanation here, but: exchange 
federation will reproduce a binding on the upstream for every 
{exchange,routing key,arguments} combination on the downstream - i.e. it 
will only collapse bindings together if they are identical in everything 
but the destination.

The rationale for this is that it considers it more important that only 
messages which are known to be needed downstream get transmitted over 
the federation link than that the number of bindings in use be limited.

&gt;<i> Do I need something other than federation?
</I>
If you're trying not to transmit bindings upstream, then yes. You should 
be able to set up a very similar link (except without the automatic 
binding propagation) using the shovel.

&gt;<i> Am I thinking about the
</I>&gt;<i> whole problem wrong?  I could use some help figuring out the right
</I>&gt;<i> topology to allow the system to scale for the foreseeable future.
</I>
Your plan sounds reasonable assuming that you really do need to have 
hundreds of thousands of bindings around.

But since that number of bindings is awkward to deal with, it's really 
worth investigating whether that is true. Obviously I don't know why you 
need so many, but I can think of a couple of antipatterns that would 
lead to use of many bindings:

* Binding all possible routing keys with a fixed prefix / suffix 
instead of using wildcards (i.e. bind &quot;a.b&quot;, &quot;a.c&quot;, &quot;a.d&quot; etc instead of 
&quot;a.*&quot;).

* Binding nearly all possible routing keys in order to exclude one and 
match everything else (investigate the alternate-exchange feature instead).

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036303.html">[rabbitmq-discuss] Scaling to large number of bindings
</A></li>
	<LI>Next message: <A HREF="036305.html">[rabbitmq-discuss] Run RabbitMQ Service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36332">[ date ]</a>
              <a href="thread.html#36332">[ thread ]</a>
              <a href="subject.html#36332">[ subject ]</a>
              <a href="author.html#36332">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
