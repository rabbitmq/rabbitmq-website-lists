<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20JNDI%20/%20.bindings%20with%20RabbitMQ%20JMS%20Client%3F&In-Reply-To=%3CCAD6m6fFd2Ps6k95XOMu68ULSr78Xg%2BmkLrXhLVT8Vvbvy6woDw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036058.html">
   <LINK REL="Next"  HREF="036088.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?</H1>
    <B>Jason McIntosh</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20JNDI%20/%20.bindings%20with%20RabbitMQ%20JMS%20Client%3F&In-Reply-To=%3CCAD6m6fFd2Ps6k95XOMu68ULSr78Xg%2BmkLrXhLVT8Vvbvy6woDw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?">mcintoshj at gmail.com
       </A><BR>
    <I>Mon May 19 15:29:17 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="036058.html">[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
</A></li>
        <LI>Next message: <A HREF="036088.html">[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36075">[ date ]</a>
              <a href="thread.html#36075">[ thread ]</a>
              <a href="subject.html#36075">[ subject ]</a>
              <a href="author.html#36075">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Off hand, it appears that you're missing some libraries.  I'm not sure what
rabbitmqjms.jar is as I've not looked at the JMS stuff personally but
you're missing whatever library provides &quot;com.rabbitmq.jms.admin.
RMQConnectionFactory&quot;.  What's interesting is that it's in the same class
structure as the instance loader (the RMQObjectFactory) - so I'd guess
there could be an issue someplace with URL class loading or similar.  If
the ObjectFactory and ConnectionFactory are with-in the same jar you
shouldn't be getting this, but if they're in a different jar file you'll
very likely have issues.  Java doesn't support loading JAR files from
with-in a JAR file for dependencies.

Jason


On Sat, May 17, 2014 at 6:40 PM, scguy &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">npetrace at gmail.com</A>&gt; wrote:

&gt;<i> Question...I'm trying to use the RabbitMQ JMS client with an existing JMS
</I>&gt;<i> client application.
</I>&gt;<i>
</I>&gt;<i> I have written a sample java program, and am referencing a .bindings file
</I>&gt;<i> (below).  I have the following plugins installed on my RabbitMQ server
</I>&gt;<i> (this
</I>&gt;<i> is on Windows):
</I>&gt;<i>
</I>&gt;<i> C:\dev\rabbitmq330\rabbit\sbin&gt;rabbitmq-plugins list
</I>&gt;<i> [e] amqp_client                       3.3.0
</I>&gt;<i> [ ] cowboy                            0.5.0-rmq3.3.0-git4b93c2d
</I>&gt;<i> [ ] eldap                             3.3.0-gite309de4
</I>&gt;<i> [e] mochiweb                          2.7.0-rmq3.3.0-git680dba8
</I>&gt;<i> [ ] rabbitmq_amqp1_0                  3.3.0
</I>&gt;<i> [ ] rabbitmq_auth_backend_ldap        3.3.0
</I>&gt;<i> [ ] rabbitmq_auth_mechanism_ssl       3.3.0
</I>&gt;<i> [ ] rabbitmq_consistent_hash_exchange 3.3.0
</I>&gt;<i> [ ] rabbitmq_federation               3.3.0
</I>&gt;<i> [ ] rabbitmq_federation_management    3.3.0
</I>&gt;<i> [E] rabbitmq_jms_topic_exchange       1.2.0-rmq3.3.0
</I>&gt;<i> [e] rabbitmq_jsonrpc                  3.3.x-24fb08eb
</I>&gt;<i> [E] rabbitmq_jsonrpc_channel          3.3.x-40bdb08c
</I>&gt;<i> [E] rabbitmq_management               3.3.0
</I>&gt;<i> [e] rabbitmq_management_agent         3.3.0
</I>&gt;<i> [E] rabbitmq_management_visualiser    3.3.0
</I>&gt;<i> [ ] rabbitmq_mqtt                     3.3.0
</I>&gt;<i> [ ] rabbitmq_shovel                   3.3.0
</I>&gt;<i> [ ] rabbitmq_shovel_management        3.3.0
</I>&gt;<i> [E] rabbitmq_stomp                    3.3.0
</I>&gt;<i> [ ] rabbitmq_tracing                  3.3.0
</I>&gt;<i> [e] rabbitmq_web_dispatch             3.3.0
</I>&gt;<i> [ ] rabbitmq_web_stomp                3.3.0
</I>&gt;<i> [ ] rabbitmq_web_stomp_examples       3.3.0
</I>&gt;<i> [e] rfc4627_jsonrpc                   3.3.x-git5e67120
</I>&gt;<i> [ ] sockjs                            0.3.4-rmq3.3.0-git3132eb9
</I>&gt;<i> [e] webmachine                        1.10.3-rmq3.3.0-gite9359c7
</I>&gt;<i>
</I>&gt;<i> I have the following on my classpath:
</I>&gt;<i>
</I>&gt;<i> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</I>&gt;<i> &lt;classpath&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;src&quot; path=&quot;src&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;con&quot;
</I>&gt;<i>
</I>&gt;<i> path=&quot;org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/jdk1.7.0_25&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;lib&quot;
</I>&gt;<i>
</I>&gt;<i> path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/amqp-client-3.3.0.jar&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;lib&quot;
</I>&gt;<i> path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/fscontext.jar&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;lib&quot;
</I>&gt;<i>
</I>&gt;<i> path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/geronimo-jms_1.1_spec-1.1.1.jar&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;lib&quot;
</I>&gt;<i> path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/providerutil.jar&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;lib&quot;
</I>&gt;<i>
</I>&gt;<i> path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/dependencies/slf4j-api-1.7.5.jar&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;lib&quot;
</I>&gt;<i> path=&quot;C:/dev/rabbitmq330/jms-package1.2.0/rabbitmq-jms-1.2.0.jar&quot;/&gt;
</I>&gt;<i>     &lt;classpathentry kind=&quot;output&quot; path=&quot;bin&quot;/&gt;
</I>&gt;<i> &lt;/classpath&gt;
</I>&gt;<i>
</I>&gt;<i> However, when I attempt to run my java program, I get the following error.
</I>&gt;<i> This is where I am stuck...I'm not sure what is wrong...as the mentioned
</I>&gt;<i> class is in the rabbitmq-jms-1.2.0.jar file, and that jar is on my
</I>&gt;<i> classpath.  Any thoughts on what I have done wrong?  I need to use the JMS
</I>&gt;<i> client...otherwise I would just use the AMQP library.
</I>&gt;<i>
</I>&gt;<i> Code snippet (the error occurs on the connection factory lookup):
</I>&gt;<i>
</I>&gt;<i> Hashtable&lt;String, String&gt; env = new Hashtable&lt;String, String&gt;();
</I>&gt;<i> env.put(Context.INITIAL_CONTEXT_FACTORY,
</I>&gt;<i> &quot;com.sun.jndi.fscontext.RefFSContextFactory&quot;);
</I>&gt;<i> env.put(Context.PROVIDER_URL, &quot;file:/rabbitmq&quot;); // directory where the
</I>&gt;<i> .bindings file is located
</I>&gt;<i>
</I>&gt;<i> mContext = new InitialContext(env);
</I>&gt;<i>
</I>&gt;<i> ConnectionFactory connectionFactory = (ConnectionFactory)
</I>&gt;<i> mContext.lookup(&quot;ConnectionFactory&quot;);
</I>&gt;<i> mConnection = connectionFactory.createConnection();
</I>&gt;<i> mConnection.start();
</I>&gt;<i>
</I>&gt;<i> .bindings file:
</I>&gt;<i>
</I>&gt;<i> ConnectionFactory/ClassName=com.rabbitmq.jms.admin.RMQConnectionFactory
</I>&gt;<i> ConnectionFactory/FactoryName=com.rabbitmq.jms.admin.RMQObjectFactory
</I>&gt;<i>
</I>&gt;<i> ConnectionFactory/RefAddr/0/Content=jms/ConnectionFactory
</I>&gt;<i> ConnectionFactory/RefAddr/0/Type=name
</I>&gt;<i> ConnectionFactory/RefAddr/0/Encoding=String
</I>&gt;<i>
</I>&gt;<i> ConnectionFactory/RefAddr/1/Content=javax.jms.ConnectionFactory
</I>&gt;<i> ConnectionFactory/RefAddr/1/Type=type
</I>&gt;<i> ConnectionFactory/RefAddr/1/Encoding=String
</I>&gt;<i>
</I>&gt;<i> ConnectionFactory/RefAddr/2/Content=com.rabbitmq.jms.admin.RMQObjectFactory
</I>&gt;<i> ConnectionFactory/RefAddr/2/Type=factory
</I>&gt;<i> ConnectionFactory/RefAddr/2/Encoding=String
</I>&gt;<i>
</I>&gt;<i> # Change this line accordingly if the broker is not at localhost
</I>&gt;<i> ConnectionFactory/RefAddr/3/Content=localhost
</I>&gt;<i> ConnectionFactory/RefAddr/3/Type=host
</I>&gt;<i> ConnectionFactory/RefAddr/3/Encoding=String
</I>&gt;<i>
</I>&gt;<i> #Destinations
</I>&gt;<i> TempQueue/ClassName=com.rabbitmq.jms.admin.RMQDestination
</I>&gt;<i> TempQueue/FactoryName=com.rabbitmq.jms.admin.RMQObjectFactory
</I>&gt;<i>
</I>&gt;<i> TempQueue/RefAddr/0/Content=jms/Queue
</I>&gt;<i> TempQueue/RefAddr/0/Type=name
</I>&gt;<i> TempQueue/RefAddr/0/Encoding=String
</I>&gt;<i>
</I>&gt;<i> TempQueue/RefAddr/1/Content=javax.jms.Queue
</I>&gt;<i> TempQueue/RefAddr/1/Type=type
</I>&gt;<i> TempQueue/RefAddr/1/Encoding=String
</I>&gt;<i>
</I>&gt;<i> TempQueue/RefAddr/2/Content=com.rabbitmq.jms.admin.RMQObjectFactory
</I>&gt;<i> TempQueue/RefAddr/2/Type=factory
</I>&gt;<i> TempQueue/RefAddr/2/Encoding=String
</I>&gt;<i>
</I>&gt;<i> TempQueue/RefAddr/3/Content=TempQueue
</I>&gt;<i> TempQueue/RefAddr/3/Type=destinationName
</I>&gt;<i> TempQueue/RefAddr/3/Encoding=String
</I>&gt;<i>
</I>&gt;<i> C:\TEMP&gt;java -jar rabbitmqjms.jar
</I>&gt;<i> SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
</I>&gt;<i> SLF4J: Defaulting to no-operation (NOP) logger implementation
</I>&gt;<i> SLF4J: See <A HREF="http://www.slf4j.org/codes.html#StaticLoggerBinder">http://www.slf4j.org/codes.html#StaticLoggerBinder</A> for further
</I>&gt;<i> details.
</I>&gt;<i> Exception in thread &quot;main&quot; java.lang.reflect.InvocationTargetException
</I>&gt;<i>         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
</I>&gt;<i>         at
</I>&gt;<i>
</I>&gt;<i> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
</I>&gt;<i>         at
</I>&gt;<i>
</I>&gt;<i> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
</I>&gt;<i>         at java.lang.reflect.Method.invoke(Method.java:606)
</I>&gt;<i>         at
</I>&gt;<i>
</I>&gt;<i> org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:58)
</I>&gt;<i> Caused by: javax.naming.NamingException: Unknown class
</I>&gt;<i> [com.rabbitmq.jms.admin.RMQConnectionFactory]
</I>&gt;<i>         at
</I>&gt;<i>
</I>&gt;<i> com.rabbitmq.jms.admin.RMQObjectFactory.getObjectInstance(RMQObjectFactory.java:132)
</I>&gt;<i>         at
</I>&gt;<i> javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:321)
</I>&gt;<i>         at
</I>&gt;<i> com.sun.jndi.fscontext.RefFSContext.lookup(RefFSContext.java:146)
</I>&gt;<i>         at com.sun.jndi.fscontext.FSContext.lookup(FSContext.java:127)
</I>&gt;<i>         at javax.naming.InitialContext.lookup(InitialContext.java:411)
</I>&gt;<i>         at rabbitMQJMSTestDriver.&lt;init&gt;(rabbitMQJMSTestDriver.java:31)
</I>&gt;<i>         at rabbitMQJMSTestDriver.main(rabbitMQJMSTestDriver.java:107)
</I>&gt;<i>         ... 5 more
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> View this message in context:
</I>&gt;<i> <A HREF="http://rabbitmq.1065348.n5.nabble.com/JNDI-bindings-with-RabbitMQ-JMS-Client-tp35631.html">http://rabbitmq.1065348.n5.nabble.com/JNDI-bindings-with-RabbitMQ-JMS-Client-tp35631.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
Jason McIntosh
<A HREF="https://github.com/jasonmcintosh/">https://github.com/jasonmcintosh/</A>
573-424-7612
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140519/b42441db/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140519/b42441db/attachment.html</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036058.html">[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
</A></li>
	<LI>Next message: <A HREF="036088.html">[rabbitmq-discuss] JNDI / .bindings with RabbitMQ JMS Client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36075">[ date ]</a>
              <a href="thread.html#36075">[ thread ]</a>
              <a href="subject.html#36075">[ subject ]</a>
              <a href="author.html#36075">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
