<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Low performance when there are many messages in ready or unacked state
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Low%20performance%20when%20there%20are%20many%20messages%20in%0A%20ready%20or%20unacked%20state&In-Reply-To=%3Cf675da02-eb67-4a54-b12c-aee889b52eff%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033265.html">
   <LINK REL="Next"  HREF="033275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Low performance when there are many messages in ready or unacked state</H1>
    <B>Anahi Hojnadel</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Low%20performance%20when%20there%20are%20many%20messages%20in%0A%20ready%20or%20unacked%20state&In-Reply-To=%3Cf675da02-eb67-4a54-b12c-aee889b52eff%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Low performance when there are many messages in ready or unacked state">anahi.hojnadel at gmail.com
       </A><BR>
    <I>Wed Jan 22 20:51:44 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033265.html">[rabbitmq-discuss] Looking for tips on upgrading from RMQ 2.x to 3.x
</A></li>
        <LI>Next message: <A HREF="033275.html">[rabbitmq-discuss] Low performance when there are many messages in ready or unacked state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33274">[ date ]</a>
              <a href="thread.html#33274">[ thread ]</a>
              <a href="subject.html#33274">[ subject ]</a>
              <a href="author.html#33274">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi guys!

We have an application that has a publisher which sends messages to a 
consumer which process those messages and then stores them in the DB. 
Everything is working fine up to now, but the number of messages we're 
receiving is getting bigger and performance is quite bad. We started to 
analize where the bottleneck was and it seems to be in rabbit queues.

I've been reading many posts in Rabbit's blog about optimization but I 
couldn't find how to solve the problem.

The main problem is that we're publishing messages faster than we can 
consume them. When the number of messages in ready state (or in unacked 
state) increases, the deliver ratio decrease considerably.

I've tried adding more consumers, sending messages more slowly (with time 
sleep)... without luck.

I've seen that sending an ack for each message make things slower but we 
actually need to ensure they're delivered. Our current ack ratio is too 
low, so every time the number of unacked messages increases, the deliver 
ratio decreases.

Do you have any ideas of what could I try to improve our process 
performance? Or should I just make sure not to send more messages than my 
current ack ratio? Is stacking acks and sending them in batches a safe 
strategy to try out?

Adding more queues is not an option since it will add too much complexity 
to our app.

Thanks!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140122/ca23af3f/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140122/ca23af3f/attachment.html</A>&gt;
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033265.html">[rabbitmq-discuss] Looking for tips on upgrading from RMQ 2.x to 3.x
</A></li>
	<LI>Next message: <A HREF="033275.html">[rabbitmq-discuss] Low performance when there are many messages in ready or unacked state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33274">[ date ]</a>
              <a href="thread.html#33274">[ thread ]</a>
              <a href="subject.html#33274">[ subject ]</a>
              <a href="author.html#33274">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
