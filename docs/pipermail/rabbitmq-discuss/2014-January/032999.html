<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit Mq 3.0.2 memory leak
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20Mq%203.0.2%20memory%20leak&In-Reply-To=%3CCAPK6Oes0fTravUJHcXb3xfPD0B8UpO7ik%2BRpODOpdLsWyQ1Zyg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032838.html">
   <LINK REL="Next"  HREF="032839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit Mq 3.0.2 memory leak</H1>
    <B>shridharan muthu</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20Mq%203.0.2%20memory%20leak&In-Reply-To=%3CCAPK6Oes0fTravUJHcXb3xfPD0B8UpO7ik%2BRpODOpdLsWyQ1Zyg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbit Mq 3.0.2 memory leak">shridharan.m at gmail.com
       </A><BR>
    <I>Mon Jan 13 17:47:53 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="032838.html">[rabbitmq-discuss] Rabbit Mq 3.0.2 memory leak
</A></li>
        <LI>Next message: <A HREF="032839.html">[rabbitmq-discuss] RabbitMQ for ARM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32999">[ date ]</a>
              <a href="thread.html#32999">[ thread ]</a>
              <a href="subject.html#32999">[ subject ]</a>
              <a href="author.html#32999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello again,

       I built a new recommended rabbit mq cluster with version 3.2.1
(Erlang R16B) to avoid the the memory leak issue that I mentioned in the
mail below. After building this cluster, I migrated 50% traffic on highest
volume queue (this queue constitutes to 70% of the total our traffic).

Cluster Version           v3.0.2                                  v3.2.1
Erlang                           R13B                                   R16B
# nodes                         2
2
# Connections             850                                      250
Erlang process            2900                                   1500
Publish/Delivery rate  230 / sec                            160 / sec
*Cpu Usage                   15%                                    25%*
*# Running process     2                                           3-4*


After the migration, I am noticing higher cpu usage and total number of
running processes on new cluster for less traffic than the original
cluster.  Also, when is there is an increase in traffic on both clusters,
cpu on new cluster increases significantly than increase in old cluster.
For instance, an increase in 0.4 MB network traffic over 2 mins caused an
increase in cpu of 2% in old cluster vs 6% increase in new cluster.

So I would like to understand why I am noticing increase in cpu and total
number of running processes before migration the whole traffic to new
cluster. Is this expected with new cluster?  I tried searching but couldn't
find any posts/blogs explaining this scenario.

Pls let me know if you need more info on cluster configs.

Thanks,
Shri


On Thu, Jan 2, 2014 at 6:44 AM, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> On 27/12/13 16:55, shridharan muthu wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I know the quick answer is &quot;upgrade&quot; but is there a short term solution
</I>&gt;<i> &gt; to fix this before we upgrade?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Please check whether you can reproduce the problem on the latest version
</I>&gt;<i> of the broker. There have been numerous improvements to the broker since
</I>&gt;<i> 3.0.2. If you can reproduce the problem then please supply the output of
</I>&gt;<i> &quot;rabbitmqctl report&quot; while the memory usage is normal and again when it
</I>&gt;<i> is abnormal.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140113/0f6d71a4/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140113/0f6d71a4/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032838.html">[rabbitmq-discuss] Rabbit Mq 3.0.2 memory leak
</A></li>
	<LI>Next message: <A HREF="032839.html">[rabbitmq-discuss] RabbitMQ for ARM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32999">[ date ]</a>
              <a href="thread.html#32999">[ thread ]</a>
              <a href="subject.html#32999">[ subject ]</a>
              <a href="author.html#32999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
