<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Behaviour of Federated Queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Behaviour%20of%20Federated%20Queues&In-Reply-To=%3C52E1407B.8060901%40one.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033297.html">
   <LINK REL="Next"  HREF="033317.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Behaviour of Federated Queues</H1>
    <B>Josh West</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Behaviour%20of%20Federated%20Queues&In-Reply-To=%3C52E1407B.8060901%40one.com%3E"
       TITLE="[rabbitmq-discuss] Behaviour of Federated Queues">jsw at one.com
       </A><BR>
    <I>Thu Jan 23 16:16:59 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033297.html">[rabbitmq-discuss] What time the rabbitmq to support AMQP 1.0 version protocol?
</A></li>
        <LI>Next message: <A HREF="033317.html">[rabbitmq-discuss] Behaviour of Federated Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33294">[ date ]</a>
              <a href="thread.html#33294">[ thread ]</a>
              <a href="subject.html#33294">[ subject ]</a>
              <a href="author.html#33294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey folks,

I have a question regarding the behaviour of federated queues...

For this question, assume I have 3 RabbitMQ brokers federated with each 
other in a complete graph fashion (they all talk to each other).  
Broker1 has a federated queue policy to federate queue's having pattern 
^broker1.* with upstreams.  Broker2 does the same, but with pattern 
^broker2.* and Broker3 has pattern ^broker3.* ... this way any client 
can send messages to any client on another broker just by placing a 
message into a queue beginning with the destination broker's name :-)

I have noticed that if I create a queue on broker1 with name 
&quot;broker1.foo.bar&quot; (for example), the queue is automatically created on 
broker2 and broker3.  Should this occur?  Or should federation only 
create the queue on upstream brokers when needed (ad-hoc)?

I ask for two reasons:

1. This could be a waste of resources if one has lots of queues matching 
federation patterns or if one has say 200+ brokers federated with each 
other.

2. When queues are created with the Auto Delete parameter, that 
parameter is of course properly propagated.  But say a client puts a 
message into the queue &quot;broker1.foo.bar&quot; on broker2 and say a client 
retrieves the message from that same queue on broker1.  The Auto Delete 
parameter behaviour would be triggered and the queue is then deleted 
from broker1 and broker2 (upon client disconnection). But... Since 
nobody has ever put any messages into the queue &quot;broker1.foo.bar&quot; 
residing on broker3, the queue will remain defined possibly indefinitely.

Hope somebody can clarify this for me!

Thanks.

--
Josh West
One.com - <A HREF="http://www.one.com">http://www.one.com</A>

</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033297.html">[rabbitmq-discuss] What time the rabbitmq to support AMQP 1.0 version protocol?
</A></li>
	<LI>Next message: <A HREF="033317.html">[rabbitmq-discuss] Behaviour of Federated Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33294">[ date ]</a>
              <a href="thread.html#33294">[ thread ]</a>
              <a href="subject.html#33294">[ subject ]</a>
              <a href="author.html#33294">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
