<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] A question on federation status reporting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20A%20question%20on%20federation%20status%20reporting&In-Reply-To=%3C52D42EA8.7060203%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033000.html">
   <LINK REL="Next"  HREF="033005.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] A question on federation status reporting</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20A%20question%20on%20federation%20status%20reporting&In-Reply-To=%3C52D42EA8.7060203%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] A question on federation status reporting">simon at rabbitmq.com
       </A><BR>
    <I>Mon Jan 13 18:21:28 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033000.html">[rabbitmq-discuss] A question on federation status reporting
</A></li>
        <LI>Next message: <A HREF="033005.html">[rabbitmq-discuss] A question on federation status reporting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33001">[ date ]</a>
              <a href="thread.html#33001">[ thread ]</a>
              <a href="subject.html#33001">[ subject ]</a>
              <a href="author.html#33001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matt.

Federated exchanges declare queues for internal use. These are the 
queues with names beginning &quot;federation: &quot; which you have probably 
already seen.

It looks like in your case those internal queues are themselves becoming 
federated. This is unlikely to be a useful thing.

You should review your federation policies and make sure those queues 
are not included in them. If you don't intend to federate queues at all 
then the easiest way is to set the federation policy to only apply to 
exchanges.

I'll also file a bug to prevent those queues from ever federating, 
regardless of policy...

Cheers, Simon

On 13/01/2014 18:08, Matt Pietrek wrote:
&gt;<i> We have a bi-directional federation setup between three nodes like this
</I>&gt;<i> on RabbitMQ 3.2.2:
</I>&gt;<i>
</I>&gt;<i> mq_integ/sea &lt;===&gt; mq_integ &lt;===&gt; mq_integ/tuk
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> All three nodes use a &quot;skytap&quot; exchange and the mq_integ/sea
</I>&gt;<i> and mq_integ/tuk are *_not_* federated with each other
</I>&gt;<i>
</I>&gt;<i> Here's what's interesting. In the *mq_integ/sea* broker, the &quot;Federation
</I>&gt;<i> Upstreams&quot; page is what I'd expect it to be, that is, a connection to
</I>&gt;<i> mq_integ:
</I>&gt;<i> Name	URI	Expiry	Message TTL	Max Hops	Prefetch Count	Reconnect Delay
</I>&gt;<i> Ack mode	Trust User-ID
</I>&gt;<i> upstream-integ
</I>&gt;<i> &lt;<A HREF="http://tuk5r1mq1.mgt.integ.skytap.com:15672/#/federation-upstreams/%2F/upstream-integ">http://tuk5r1mq1.mgt.integ.skytap.com:15672/#/federation-upstreams/%2F/upstream-integ</A>&gt;
</I>&gt;<i> <A HREF="amqp://foo:bar@sea_m2:5672">amqp://foo:bar@sea_m2:5672</A>						?	?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> However, in the &quot;Federation Status&quot; page for *mq_integ/sea* looks
</I>&gt;<i> strange (see below). In particular, I see four entries, whereas in
</I>&gt;<i> RabbitMQ 3.0.2 I only saw one line.
</I>&gt;<i>
</I>&gt;<i> In addition, the third entry references the mq_integ/tuk broker, even
</I>&gt;<i> though I haven't configured mq_integ/sea to know anything about
</I>&gt;<i> mq_integ/tuk:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Connection	URI	Exchange / Queue	Node	State	Inbound message rate	Last
</I>&gt;<i> changed
</I>&gt;<i> upstream-integ	<A HREF="amqp://sea_m2:5672">amqp://sea_m2:5672</A>	federation: skytap -&gt; mq_integ_queue
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at sea_r2</A>	
</I>&gt;<i> running
</I>&gt;<i> 		2014-01-11 1:35:28
</I>&gt;<i> upstream-integ	<A HREF="amqp://sea5_m2:5672">amqp://sea5_m2:5672</A>	federation: skytap -&gt;
</I>&gt;<i> mq_integ/sea_queue 	<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at sea_r2</A>	
</I>&gt;<i> running
</I>&gt;<i> 		2014-01-11 1:35:28
</I>&gt;<i> upstream-integ	<A HREF="amqp://sea_m2:5672">amqp://sea_m2:5672</A>	federation: skytap -&gt;
</I>&gt;<i> mq_integ/tuk_queue 	<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at sea_r2</A>	
</I>&gt;<i> running
</I>&gt;<i> 		2014-01-11 1:35:29
</I>&gt;<i> upstream-integ	<A HREF="amqp://sea_m2:5672">amqp://sea_m2:5672</A>	skytap_exchange 	<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at sea_r2</A>	
</I>&gt;<i> running
</I>&gt;<i> 	0.00/s	2014-01-11 1:35:29
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Is this what you'd expect to see? Am I not understanding something?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Matt
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033000.html">[rabbitmq-discuss] A question on federation status reporting
</A></li>
	<LI>Next message: <A HREF="033005.html">[rabbitmq-discuss] A question on federation status reporting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33001">[ date ]</a>
              <a href="thread.html#33001">[ thread ]</a>
              <a href="subject.html#33001">[ subject ]</a>
              <a href="author.html#33001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
