<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Federation and Stomp
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20and%20Stomp&In-Reply-To=%3C1389676138553-32536.post%40n5.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033033.html">
   <LINK REL="Next"  HREF="033008.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Federation and Stomp</H1>
    <B>joshua__lim</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Federation%20and%20Stomp&In-Reply-To=%3C1389676138553-32536.post%40n5.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Federation and Stomp">joshua__lim at hotmail.com
       </A><BR>
    <I>Tue Jan 14 05:08:59 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033033.html">[rabbitmq-discuss] RPM install not detectingErlang
</A></li>
        <LI>Next message: <A HREF="033008.html">[rabbitmq-discuss] Federation and Stomp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33007">[ date ]</a>
              <a href="thread.html#33007">[ thread ]</a>
              <a href="subject.html#33007">[ subject ]</a>
              <a href="author.html#33007">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Steve, I've been trying to get Durable Exchange to work without success,
both topic and direct exchange.  Here's my findings:

I read somewhere that says to create durable subscription for exchange, I'd
need to set the client-id header on the CONNECT and the id header to a
unique string and set persistent: true.  This doesn't appear to work at this
moment as subscribed-clients will lose messages sent to the exchange if they
are not connected.

What I've observed from the web management console is that the messages are
being sent to and buffered on the &quot;amq.gen-random-characters-here&quot; queue
created when the client was last connected.  Note: This
&quot;amq.gen-random-characters-here&quot; queue is durable.

When the consumer reconnects using the same client-id header and
re-subscribes using the same id, a new queue is generated and this queue has
no messages.

Here's what I did:

Consumer:

ncat localhost 61613
CONNECT
login:joshua
passcode:joshua
client-id:connect-03

^@
CONNECTED
session:session-a5K-Wxdgg0TzUn9Ym6bKgg
heart-beat:0,0
server:RabbitMQ/3.2.1
version:1.0

 SUBSCRIBE
destination:/exchange/topic-x/high.*
ack:client-individual
id:subscribe-03
persistent:true
receipt:001

^@
RECEIPT
receipt-id:001

 MESSAGE
subscription:subscribe-03
destination:/exchange/topic-x/high.alarm
message-id:T_subscribe-03@@session-a5K-Wxdgg0TzUn9Ym6bKgg@@1
delivery-mode:2
receipt:002
app-id:guest
persistent:true
content-length:6

test3
 ^C

Producer:

ncat localhost 61613
CONNECT
login:guest
passcode:guest
client-id:guest

^@
CONNECTED
session:session-Q1Di3bc_DBXPHPT90h55NQ
heart-beat:0,0
server:RabbitMQ/3.2.1
version:1.0

 SEND
destination:/exchange/topic-x2/high.alarm
receipt:001
persistent:true
delivery-mode:2
app-id:guest

test1
^@
RECEIPT
receipt-id:001


Finally, I've tried the Durable Topic Subscription - /topic/&lt;name&gt; using a
unique id in the subscribe header + persistent: true.  It appears that only
the first or first two message that is queued when the subscriber is offline
is delivered when the subscriber is back online.  So even if I sent 10-20
messages, only 1 or 2 messages is successfully delivered.

Rgds,
Joshua



--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/Federation-and-Stomp-tp20052p32536.html">http://rabbitmq.1065348.n5.nabble.com/Federation-and-Stomp-tp20052p32536.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033033.html">[rabbitmq-discuss] RPM install not detectingErlang
</A></li>
	<LI>Next message: <A HREF="033008.html">[rabbitmq-discuss] Federation and Stomp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33007">[ date ]</a>
              <a href="thread.html#33007">[ thread ]</a>
              <a href="subject.html#33007">[ subject ]</a>
              <a href="author.html#33007">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
