<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL acknowledgements within handleMessage() method at consumer end?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20handle%20AcknowledgeMode.MANUAL%0A%20acknowledgements%20within%20handleMessage%28%29%20method%20at%20consumer%20end%3F&In-Reply-To=%3CCAH75Yb7v_gxdaQ08C%3D--GxQ5DgcBR3V_1J6dBJUtxJ5KgAzROQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032927.html">
   <LINK REL="Next"  HREF="032931.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL acknowledgements within handleMessage() method at consumer end?</H1>
    <B>Rajasekhar P</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20handle%20AcknowledgeMode.MANUAL%0A%20acknowledgements%20within%20handleMessage%28%29%20method%20at%20consumer%20end%3F&In-Reply-To=%3CCAH75Yb7v_gxdaQ08C%3D--GxQ5DgcBR3V_1J6dBJUtxJ5KgAzROQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL acknowledgements within handleMessage() method at consumer end?">sekhar434145 at gmail.com
       </A><BR>
    <I>Thu Jan  9 10:13:58 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="032927.html">[rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL acknowledgements within handleMessage() method at consumer end?
</A></li>
        <LI>Next message: <A HREF="032931.html">[rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL	acknowledgements within handleMessage() method at consumer end?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32930">[ date ]</a>
              <a href="thread.html#32930">[ thread ]</a>
              <a href="subject.html#32930">[ subject ]</a>
              <a href="author.html#32930">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here, after catching the exception I want send it back to the producer, so
that my client will know what kind of error occurred at backend system. As
mentioned above if exception occurred inside the handleMessag method
message will not deleted from the queue, that is fine and to printing that
error message by registering ErrorHandler with the listener container. But,
I want to send that exception to the producer, can you please tell me how
can we send it back to producer?

Error handling at consumer end -

@Override
public void handleError(Throwable t) {
t.printStackTrace();
}


Thanks in advance.



On Thu, Jan 9, 2014 at 10:50 AM, Rajasekhar P &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sekhar434145 at gmail.com</A>&gt;wrote:

&gt;<i> Am using ackMode=AUTO and if any exception occurs in handleMessage()
</I>&gt;<i> method message will be deleted from the queue, it requeued as you mentioned
</I>&gt;<i> in the above mail.
</I>&gt;<i>
</I>&gt;<i> Thank you for your support.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Wed, Jan 8, 2014 at 7:29 PM, Gary Russell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">grussell at gopivotal.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> However, if you use ackMode=AUTO, the container will take care of your
</I>&gt;&gt;<i> needs - if you throw an exception, the default behavior is to reject (and
</I>&gt;&gt;<i> requeue). If you don't throw an exception, the message will be ack'd.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Jan 8, 2014 at 8:57 AM, Gary Russell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">grussell at gopivotal.com</A>&gt;wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt;public void handleMessage(String message) {
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;}
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This is a MessageListener and doesn't have access to the Channel.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt;&gt;Section 3.11 in [1] suggests you are supposed to use Channel#basicAck
</I>&gt;&gt;&gt;<i> from RabbitMQ Java client directly.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Right, and to do that, you have to use a ChannelAwareMessageListenerthat has a different signature...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> void onMessage(Message message, Channel channel) throws Exception;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Wed, Jan 8, 2014 at 6:25 AM, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt;wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> On 8 Jan 2014, at 14:41, Rajasekhar P &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sekhar434145 at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &gt; I want to handle acknowledgements manually, because, if any error
</I>&gt;&gt;&gt;&gt;<i> occurs while processing message it should not be deleted from the queue.
</I>&gt;&gt;&gt;&gt;<i> For this I have used AcknowledgeMode.MANUAL , but am not getting how to set
</I>&gt;&gt;&gt;&gt;<i> the acknowledgement after processing the message in handleMessage method.
</I>&gt;&gt;&gt;&gt;<i> Can anyone tell me how to do that?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Section 3.11 in [1] suggests you are supposed to use Channel#basicAck
</I>&gt;&gt;&gt;&gt;<i> from RabbitMQ Java client
</I>&gt;&gt;&gt;&gt;<i> directly.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> 1.
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://docs.spring.io/spring-amqp/docs/1.2.1.BUILD-SNAPSHOT/reference/html/amqp.html#d4e329">http://docs.spring.io/spring-amqp/docs/1.2.1.BUILD-SNAPSHOT/reference/html/amqp.html#d4e329</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> MK
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Software Engineer, Pivotal/RabbitMQ
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140109/4ac029a6/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140109/4ac029a6/attachment.html</A>&gt;
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032927.html">[rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL acknowledgements within handleMessage() method at consumer end?
</A></li>
	<LI>Next message: <A HREF="032931.html">[rabbitmq-discuss] How to handle AcknowledgeMode.MANUAL	acknowledgements within handleMessage() method at consumer end?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32930">[ date ]</a>
              <a href="thread.html#32930">[ thread ]</a>
              <a href="subject.html#32930">[ subject ]</a>
              <a href="author.html#32930">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
