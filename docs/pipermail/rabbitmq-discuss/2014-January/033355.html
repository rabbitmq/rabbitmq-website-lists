<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Not able to get ssl working with rabbitMQ server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Not%20able%20to%20get%20ssl%20working%20with%20rabbitMQ%0A%20server&In-Reply-To=%3CetPan.52e68197.66ef438d.aba4%40gmr-home.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033348.html">
   <LINK REL="Next"  HREF="033358.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Not able to get ssl working with rabbitMQ server</H1>
    <B>Gavin M. Roy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Not%20able%20to%20get%20ssl%20working%20with%20rabbitMQ%0A%20server&In-Reply-To=%3CetPan.52e68197.66ef438d.aba4%40gmr-home.local%3E"
       TITLE="[rabbitmq-discuss] Not able to get ssl working with rabbitMQ server">gavinmroy at gmail.com
       </A><BR>
    <I>Mon Jan 27 15:56:07 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033348.html">[rabbitmq-discuss] Not able to get ssl working with rabbitMQ	server
</A></li>
        <LI>Next message: <A HREF="033358.html">[rabbitmq-discuss] Not able to get ssl working with rabbitMQ server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33355">[ date ]</a>
              <a href="thread.html#33355">[ thread ]</a>
              <a href="subject.html#33355">[ subject ]</a>
              <a href="author.html#33355">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Your ssl_options are a pretty important part of the SSL connection in this code and they are omitted, same with your other email thread. Without them, it&#8217;s hard to debug for you. The underlying code is the same regardless of the connection adapter. If we can see what those are, it should help.

Also, any related snippets from rabbit@[NODE].log could be helpful.

Gavin

From:&#160;Kausik Chattopadhyay Kausik Chattopadhyay
Reply:&#160;Kausik Chattopadhyay <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">connect_kausik at yahoo.com</A>, Discussions about RabbitMQ <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Date:&#160;January 27, 2014 at 6:03:05 AM
To:&#160;Michael Klishin <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>
Subject:&#160; Re: [rabbitmq-discuss] Not able to get ssl working with rabbitMQ server  
Hi Michael,
So far I &#160;was working with SelectConnection using pika and it is good.
Today I tried to get a publisher working with BlockingConnection with SSL. Normal connection works however failing with SSL. The same setup works with SelectConnection. Any idea ?

My publisher code is as follows:

&#160;parameters = ConnectionParameters(HOST, PORT,
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ssl=True,
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ssl_options=ssl_options)
connection = pika.BlockingConnection(parameters)




I am getting the following error:
------------------------------------------
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,901 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;161 : Added: {'callback': &lt;bound method BlockingConnection._on_connection_error of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': False, 'arguments': None}
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,901 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;161 : Added: {'callback': &lt;bound method BlockingConnection._on_connection_start of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 1}
INFO &#160; &#160; &#160; 2014-01-27 16:25:27,901 pika.adapters.base_connection &#160;_create_and_connect_to_socket &#160; &#160; &#160; &#160;164 : Connecting to 172.16.47.133:5671 with SSL
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,925 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;process &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;217 : Processing 0:Connection.Start
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,925 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_use_one_shot_callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; 390 : Processing use of oneshot callback
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,925 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_use_one_shot_callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; 392 : 0 registered uses left
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,925 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;remove &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 260 : Removing callback #0: {'callback': &lt;bound method BlockingConnection._on_connection_start of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 0}
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;process &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;231 : Calling &lt;bound method BlockingConnection._on_connection_start of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt; for &quot;0:Connection.Start&quot;
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;161 : Added: {'callback': &lt;bound method BlockingConnection._on_connection_tune of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 1}
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;process &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;217 : Processing 0:Connection.Tune
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_use_one_shot_callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; 390 : Processing use of oneshot callback
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_use_one_shot_callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; 392 : 0 registered uses left
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;remove &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 260 : Removing callback #0: {'callback': &lt;bound method BlockingConnection._on_connection_tune of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 0}
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;process &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;231 : Calling &lt;bound method BlockingConnection._on_connection_tune of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt; for &quot;0:Connection.Tune&quot;
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.connection &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_create_heartbeat_checker &#160; &#160; &#160; &#160; &#160; &#160;946 : Creating a HeartbeatChecker: 600
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,926 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;161 : Added: {'callback': &lt;bound method BlockingConnection._on_connection_open of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 1}
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,927 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;process &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;217 : Processing 0:Connection.OpenOk
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,927 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_use_one_shot_callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; 390 : Processing use of oneshot callback
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,927 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;_use_one_shot_callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; 392 : 0 registered uses left
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,927 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;remove &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 260 : Removing callback #0: {'callback': &lt;bound method BlockingConnection._on_connection_open of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 0}
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,927 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;process &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;231 : Calling &lt;bound method BlockingConnection._on_connection_open of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt; for &quot;0:Connection.OpenOk&quot;
DEBUG &#160; &#160; &#160;2014-01-27 16:25:27,927 pika.callback &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;161 : Added: {'callback': &lt;bound method BlockingConnection._on_connection_closed of &lt;pika.adapters.blocking_connection.BlockingConnection object at 0x2d6be90&gt;&gt;, 'only': None, 'one_shot': True, 'arguments': None, 'calls': 1}

---------------------------------------&#160;

Serverside log shows:

=INFO REPORT==== 27-Jan-2014::05:55:47 ===
accepting AMQP connection &lt;0.6427.1&gt; (172.16.47.1:56458 -&gt; 172.16.47.133:5671)

=WARNING REPORT==== 27-Jan-2014::05:55:47 ===
closing AMQP connection &lt;0.6427.1&gt; (172.16.47.1:56458 -&gt; 172.16.47.133:5671):
connection_closed_abruptly




On Wednesday, January 22, 2014 8:07 PM, Kausik Chattopadhyay &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">connect_kausik at yahoo.com</A>&gt; wrote:
Hi Michael,
Thanks.
&#160;Actually the certificates were owned by root.&#160;
I tried the followings:
1. Adding user rabbitmq to group root &#160;--- didnt work
2. Changing the ownership of all the certficates to rabbitmq:rabbitmq --- didnt work

Finally I tried this. Created a &quot;rabbitmq&quot; sudoer. Installing rabbitmq server. Generating the certificates as a &quot;rabbitmq&quot; user --&gt; this worked

Thanks
Kausik


On Wednesday, January 22, 2014 4:54 PM, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt; wrote:

On 22 Jan 2014, at 14:59, Kausik Chattopadhyay &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">connect_kausik at yahoo.com</A>&gt; wrote:

&gt;<i> Interestingly, this is the log from <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at master1-sasl.log</A>
</I>
There is nothing new in the SASL log.

ecacertfile indicates there was an issue with the CA certificate, which cannot
be loaded due to eaccess (according to the other log file).

--
MK

Software Engineer, Pivotal/RabbitMQ




_______________________________________________  
rabbitmq-discuss mailing list  
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>  
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140127/be91ac05/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140127/be91ac05/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033348.html">[rabbitmq-discuss] Not able to get ssl working with rabbitMQ	server
</A></li>
	<LI>Next message: <A HREF="033358.html">[rabbitmq-discuss] Not able to get ssl working with rabbitMQ server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33355">[ date ]</a>
              <a href="thread.html#33355">[ thread ]</a>
              <a href="subject.html#33355">[ subject ]</a>
              <a href="author.html#33355">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
