<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] looking for a design pattern for an	aggregator (AMQP)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20looking%20for%20a%20design%20pattern%20for%20an%0A%09aggregator%20%28AMQP%29&In-Reply-To=%3CCAKgmDnFEgjDVap2yCzNCLEHh%2BGooxfSd8yPmohhB2E0LVCiWAQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033163.html">
   <LINK REL="Next"  HREF="033167.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] looking for a design pattern for an	aggregator (AMQP)</H1>
    <B>Laing, Michael</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20looking%20for%20a%20design%20pattern%20for%20an%0A%09aggregator%20%28AMQP%29&In-Reply-To=%3CCAKgmDnFEgjDVap2yCzNCLEHh%2BGooxfSd8yPmohhB2E0LVCiWAQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] looking for a design pattern for an	aggregator (AMQP)">michael.laing at nytimes.com
       </A><BR>
    <I>Sat Jan 18 12:41:24 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033163.html">[rabbitmq-discuss] looking for a design pattern for an aggregator	(AMQP)
</A></li>
        <LI>Next message: <A HREF="033167.html">[rabbitmq-discuss] retransmiting of failed messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33165">[ date ]</a>
              <a href="thread.html#33165">[ thread ]</a>
              <a href="subject.html#33165">[ subject ]</a>
              <a href="author.html#33165">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I do this sort of thing in pika using an asynchronous connection. I would
suggest tornado_connection.

Then use pika's connection.add_timeout method.

While doing any operation, like the summarization, you won't be yielding to
pika's event loop. This can cause heartbeat problems if the time taken goes
over the heartbeat interval, so watch for that.

ml


On Fri, Jan 17, 2014 at 8:07 PM, &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">kgoess at bepress.com</A>&gt; wrote:

&gt;<i> We've been wrestling with this for a couple days and aren't any nearer a
</I>&gt;<i> solution, so any suggestions would be helpful.
</I>&gt;<i>
</I>&gt;<i> We have a queue of unaggregated data, hits per article.  We'd like to have
</I>&gt;<i> a listener on that queue collect messages for, say 10,000 messages, or ten
</I>&gt;<i> minutes, whichever comes first, before aggregating/coalescing the data and
</I>&gt;<i> submitting that to a second queue.
</I>&gt;<i>
</I>&gt;<i> We've been working with python AMQP (pika) code using the
</I>&gt;<i> pika.BlockingConnection and basic_consume, using a SIGALRM timer. We're
</I>&gt;<i> seeing lots of conflicts between the basic_consume callback, the SIGALRM
</I>&gt;<i> callback, sending acknowledgments on the incoming data, and sending the
</I>&gt;<i> outgoing aggregated data to the second queue.
</I>&gt;<i>
</I>&gt;<i> After a couple days experimenting with different approaches, we thought it
</I>&gt;<i> might be productive to ask if anybody else has already solved this problem
</I>&gt;<i> and can suggest a strategy, or if anybody things pika.BlockingConnection is
</I>&gt;<i> even the right tool for this?
</I>&gt;<i>
</I>&gt;<i> Thanks for any suggestions...
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140118/14e86282/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140118/14e86282/attachment.html</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033163.html">[rabbitmq-discuss] looking for a design pattern for an aggregator	(AMQP)
</A></li>
	<LI>Next message: <A HREF="033167.html">[rabbitmq-discuss] retransmiting of failed messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33165">[ date ]</a>
              <a href="thread.html#33165">[ thread ]</a>
              <a href="subject.html#33165">[ subject ]</a>
              <a href="author.html#33165">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
