<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] flow control in rabbitmq
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20flow%20control%20in%20rabbitmq&In-Reply-To=%3CCAC3dgDc%3DrY__ViKcEBtjZS1EGVd9MuGvtv9cyJ0LDwRA3UyWBg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032828.html">
   <LINK REL="Next"  HREF="032878.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] flow control in rabbitmq</H1>
    <B>sandeep kumar</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20flow%20control%20in%20rabbitmq&In-Reply-To=%3CCAC3dgDc%3DrY__ViKcEBtjZS1EGVd9MuGvtv9cyJ0LDwRA3UyWBg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] flow control in rabbitmq">sandy.sandeeep at gmail.com
       </A><BR>
    <I>Fri Jan  3 13:56:25 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="032828.html">[rabbitmq-discuss] flow control in rabbitmq
</A></li>
        <LI>Next message: <A HREF="032878.html">[rabbitmq-discuss] flow control in rabbitmq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32861">[ date ]</a>
              <a href="thread.html#32861">[ thread ]</a>
              <a href="subject.html#32861">[ subject ]</a>
              <a href="author.html#32861">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi ,

I m using rabbitmqserver v 3.2.0
Scenario 1:
I continously sent messages to rabbitMQ Server using basic publish()
without &quot;publisher confirms&quot;.
when the memory limit is breached by the server, the connections are
getting blocked.
Even after the connections are blocked, for some interval of time, i see
publish() being successful .
Those successfully published messages which are sent after blocked
connection are neither in queue nor in rdq files

Is the message loss expected?

Scenario 2:

I continously sent messages to server using basic publish() with &quot;publisher
confirms&quot; for each message.
when the memory limit is breached by the server the connections are getting
blocked.
Even after the connections are blocked, for some interval of time, i see
publish() being successful .
Those successfully published messages which are sent after blocked
connection are neither in queue nor in rdq files
There is message loss and the rate of message publishing is dropping
drastically by 80 to 90 percent if we use &quot; publisher confirms&quot;

Is this expected?

If these  are expected behaviours, how do we avoid message loss ?




On Mon, Dec 30, 2013 at 3:33 PM, sandeep kumar &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sandy.sandeeep at gmail.com</A>&gt;wrote:

&gt;<i> Hi ,
</I>&gt;<i>
</I>&gt;<i> I have used single rabbitmq node , And I set  memory_high_watermark to a
</I>&gt;<i> small value(0.05)
</I>&gt;<i> and messages are being sent to the rabbitmq node at a higher rate.
</I>&gt;<i> When memory is about to be breached because of higher rate of messages to
</I>&gt;<i> the node creation of .rdq files is observed.
</I>&gt;<i> when the memory consumtion crosses the limit all connections to the node
</I>&gt;<i> getting blocked is observed.
</I>&gt;<i> At this point of time there is neither increase in queue size nor .rdq
</I>&gt;<i> size, but publish to queue statemt is getting executed.
</I>&gt;<i>
</I>&gt;<i> Questions are :
</I>&gt;<i>
</I>&gt;<i> where are the published messages are getting store when connections to
</I>&gt;<i> queue are in blocked state
</I>&gt;<i>
</I>&gt;<i> how to handle this kind of scenario gracefully
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140103/fbf562c8/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140103/fbf562c8/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032828.html">[rabbitmq-discuss] flow control in rabbitmq
</A></li>
	<LI>Next message: <A HREF="032878.html">[rabbitmq-discuss] flow control in rabbitmq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32861">[ date ]</a>
              <a href="thread.html#32861">[ thread ]</a>
              <a href="subject.html#32861">[ subject ]</a>
              <a href="author.html#32861">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
