<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Bug w/ Federated Queue's &amp; Clustering
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Bug%20w/%20Federated%20Queue%27s%20%26%20Clustering&In-Reply-To=%3C52DF3680.4080506%40one.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033251.html">
   <LINK REL="Next"  HREF="033242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Bug w/ Federated Queue's &amp; Clustering</H1>
    <B>Josh West</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Bug%20w/%20Federated%20Queue%27s%20%26%20Clustering&In-Reply-To=%3C52DF3680.4080506%40one.com%3E"
       TITLE="[rabbitmq-discuss] Bug w/ Federated Queue's &amp; Clustering">jsw at one.com
       </A><BR>
    <I>Wed Jan 22 03:09:52 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033251.html">[rabbitmq-discuss] Federation Upstream Set Policy
</A></li>
        <LI>Next message: <A HREF="033242.html">[rabbitmq-discuss] Bug w/ Federated Queue's &amp; Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33231">[ date ]</a>
              <a href="thread.html#33231">[ thread ]</a>
              <a href="subject.html#33231">[ subject ]</a>
              <a href="author.html#33231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi folks,

I'm having an issue with RabbitMQ 3.2.2 (Erlang R15B01).

I have 3 clusters (2-nodes per cluster) configured for federation in a 
complete graph fashion (they all federate with each other).  Each 
cluster has a policy to federate queues with pattern ^cluster1.* (for 
cluster1), ^cluster2.* (for cluster2), and ^cluster3.* (for cluster3).  
So in other words, if clusters #2 or #3 have a queue with a name 
beginning with &quot;cluster1&quot;, it will be federated (pulled down to) 
cluster1 upon request.  The policy for federation also has the attribute 
&quot;ha-mode&quot; set to &quot;all&quot;, so that messages sent between clusters are not 
lost upon a failure.

The queue's I'm working with have the Auto Delete and Durable flags set.

Without much effort, I'm seeing errors on cluster1 after using the queue 
a few times.  The error is visible within the management console:

TypeError: Cannot read property 'ram_msg_count' of undefined

And federation from that point on for that queue fails.

When I do this complete graph scenario without making use of clusters I 
do not experience this problem.

I've seen mentions on the list that this was an issue with clusters and 
durable queues, but fixed in 3.2.1.  Perhaps it is still an issue?  Or 
still an issue just when federation is involved?

Thanks.

-- 
Josh West
One.com - <A HREF="http://www.one.com">http://www.one.com</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140121/c98a69f5/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140121/c98a69f5/attachment.html</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033251.html">[rabbitmq-discuss] Federation Upstream Set Policy
</A></li>
	<LI>Next message: <A HREF="033242.html">[rabbitmq-discuss] Bug w/ Federated Queue's &amp; Clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33231">[ date ]</a>
              <a href="thread.html#33231">[ thread ]</a>
              <a href="subject.html#33231">[ subject ]</a>
              <a href="author.html#33231">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
