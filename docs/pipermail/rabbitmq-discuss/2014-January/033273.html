<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbitmq crashing every 90 minutes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20crashing%20every%2090%20minutes&In-Reply-To=%3CCAHdxdCdSBGPYAOuabh2OiA3uPXpeROGnu9v%3DLbVbQPCemKHfZg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033272.html">
   <LINK REL="Next"  HREF="033276.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbitmq crashing every 90 minutes</H1>
    <B>Daniel Bason</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbitmq%20crashing%20every%2090%20minutes&In-Reply-To=%3CCAHdxdCdSBGPYAOuabh2OiA3uPXpeROGnu9v%3DLbVbQPCemKHfZg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbitmq crashing every 90 minutes">daniel.bason at telogis.com
       </A><BR>
    <I>Wed Jan 22 22:27:07 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="033272.html">[rabbitmq-discuss] Rabbitmq crashing every 90 minutes
</A></li>
        <LI>Next message: <A HREF="033276.html">[rabbitmq-discuss] Rabbitmq crashing every 90 minutes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33273">[ date ]</a>
              <a href="thread.html#33273">[ thread ]</a>
              <a href="subject.html#33273">[ subject ]</a>
              <a href="author.html#33273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>For the meantime I have left the FD as they are.  After renaming the mnesia
database the server has been running for the last two hours with no issues,
but that could also be that I rebooted the machine earlier as well, and
 there may be a FD leak somewhere.

I also found the following error in the rabbit log as part of the crashes;
not sure if this relates to FDs:


=ERROR REPORT==== 22-Jan-2014::14:54:02 ===
** Generic server &lt;0.197.0&gt; terminating
** Last message in was {'$gen_cast',{combine,29089,29088}}
** When Server state == {state,
                            {dict,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            [],
                            {gc_state,
                                &quot;/var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at queue1</A>
/msg_store_persistent&quot;,
                                rabbit_msg_store_ets_index,
                                {state,233541,
                                    &quot;/var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at queue1</A>
/msg_store_persistent&quot;},
                                229444,237638,&lt;0.194.0&gt;}}
** Reason for termination ==
** {{badmatch,{error,system_limit}},
    [{rabbit_msg_store,combine_files,3},
     {rabbit_msg_store_gc,attempt_action,3},
     {rabbit_msg_store_gc,handle_cast,2},
     {gen_server2,handle_msg,2},
     {proc_lib,wake_up,3}]}

=ERROR REPORT==== 22-Jan-2014::14:54:02 ===
** Generic server msg_store_persistent terminating
** Last message in was {'EXIT',&lt;0.197.0&gt;,
                               {{badmatch,{error,system_limit}},
                                [{rabbit_msg_store,combine_files,3},
                                 {rabbit_msg_store_gc,attempt_action,3},
                                 {rabbit_msg_store_gc,handle_cast,2},
                                 {gen_server2,handle_msg,2},
                                 {proc_lib,wake_up,3}]}}
** When Server state == {msstate,
                            &quot;/var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at queue1</A>
/msg_store_persistent&quot;,
                            rabbit_msg_store_ets_index,



On Thu, Jan 23, 2014 at 10:54 AM, Matthias Radestock
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;wrote:

&gt;<i> On 22/01/14 21:38, Daniel Bason wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I have raised the limits now to 4096.  I'm not sure why this started
</I>&gt;&gt;<i> becoming an issue now after 6 months of stability, but we'll try it out.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It would be good to get a status report after 90 minutes, to see what the
</I>&gt;<i> file descriptor situation looks like then.
</I>&gt;<i>
</I>&gt;<i> It is quite unusual for rabbit to actually die due to insufficient FDs;
</I>&gt;<i> normally it will just refuse to accept more connections.
</I>&gt;<i>
</I>&gt;<i> I do notice that you are running quite an old Erlang. Definitely worth
</I>&gt;<i> upgrading.
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
*Dan Bason *
Infrastructure Engineer &#8211; Telogis
www.telogis.com  www.telogis.co.nz
+1 201 477-1448 (USA)  +64 3 281-8065 (NZ)

&lt;<A HREF="http://www.google.com/url?q=http%3A%2F%2Fwww.telogis.com%2F&amp;sa=D&amp;sntz=1&amp;usg=AFrqEze6z4qIWKcAMjgXqM25xkuw9JMysQ">http://www.google.com/url?q=http%3A%2F%2Fwww.telogis.com%2F&amp;sa=D&amp;sntz=1&amp;usg=AFrqEze6z4qIWKcAMjgXqM25xkuw9JMysQ</A>&gt;

*One Platform for Location Intelligence*

-- 


This e-mail, and any attachments, is intended only for use by the 
addressee(s) named herein and may contain legally privileged and/or 
confidential information.  It is the property of Telogis.  If you are not 
the intended recipient of this e-mail, you are hereby notified that any 
dissemination, distribution or copying of this e-mail, any attachments 
thereto, and use of the information contained, is strictly prohibited.  If 
you have received this e-mail in error, please notify the sender and 
permanently delete the original and any copy thereof.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140123/eed0a2f8/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140123/eed0a2f8/attachment.html</A>&gt;
</PRE>


































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033272.html">[rabbitmq-discuss] Rabbitmq crashing every 90 minutes
</A></li>
	<LI>Next message: <A HREF="033276.html">[rabbitmq-discuss] Rabbitmq crashing every 90 minutes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33273">[ date ]</a>
              <a href="thread.html#33273">[ thread ]</a>
              <a href="subject.html#33273">[ subject ]</a>
              <a href="author.html#33273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
