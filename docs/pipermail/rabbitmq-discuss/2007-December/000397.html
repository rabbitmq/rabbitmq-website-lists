<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RPC Client side timeout
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RPC%20Client%20side%20timeout&In-Reply-To=79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000399.html">
   <LINK REL="Next"  HREF="000371.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RPC Client side timeout</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RPC%20Client%20side%20timeout&In-Reply-To=79AFF3E7-3FFE-4BA6-8B83-5DB9C90C3ECC%40gmail.com"
       TITLE="[rabbitmq-discuss] RPC Client side timeout">tonyg at lshift.net
       </A><BR>
    <I>Thu Dec 27 14:32:58 GMT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000399.html">[rabbitmq-discuss] RPC Client side timeout
</A></li>
        <LI>Next message: <A HREF="000371.html">[rabbitmq-discuss] Fwd: [lift] Announcing AMQP support in liftweb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#397">[ date ]</a>
              <a href="thread.html#397">[ thread ]</a>
              <a href="subject.html#397">[ subject ]</a>
              <a href="author.html#397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ben,

Ben Hood wrote:
&gt;<i> When you send the top half you can specify an expiration property, but  
</I>&gt;<i> I can't see how this gets processed on the server side (from looking  
</I>&gt;<i> at the processing code). Furthermore this is a string value and I  
</I>&gt;<i> haven't seen an example of it or an explanation in the spec.
</I>
It isn't processed at all in the server at the moment, precisely because
the spec doesn't define it properly. A future release of the spec will
fix the problem.

&gt;<i> On the client, one easy to way to do this would be just to add a get()  
</I>&gt;<i> method on the blocking cell that passes in a timeout value, but I'm  
</I>&gt;<i> not sure what should happen once it times out. Should the consume be  
</I>&gt;<i> cancelled or should an appropriate property be set during the  
</I>&gt;<i> initialization of the consume that indicates to the server that it  
</I>&gt;<i> should clean unattended queues up after a while?
</I>
I'd suggest supplying, at RPC tophalf time, a default reply value as
well as the timeout, and then starting a timer task that, when it
expires, uses setIfUnset(defaultReplyValue) to release the RPC caller.
Also, the current use of set(receivedValue) in the consumer should be
replaced by setIfUnset(receivedValue).

At the moment, RpcClient itself doesn't queueDelete. Maybe it should
have the option of doing so, at the application's discretion. Then the
application can use the defaultReplyValue to decide what to do, and can
choose to delete the RpcClient and possibly the RpcClient's queue, at
its option.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] <A HREF="http://www.lshift.net/">http://www.lshift.net/</A> | Email: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000399.html">[rabbitmq-discuss] RPC Client side timeout
</A></li>
	<LI>Next message: <A HREF="000371.html">[rabbitmq-discuss] Fwd: [lift] Announcing AMQP support in liftweb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#397">[ date ]</a>
              <a href="thread.html#397">[ thread ]</a>
              <a href="subject.html#397">[ subject ]</a>
              <a href="author.html#397">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
