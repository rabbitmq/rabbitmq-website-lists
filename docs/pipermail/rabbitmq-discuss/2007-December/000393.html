<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Persisting Data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Persisting%20Data&In-Reply-To=2674C3FB-434E-46FB-BD95-8A3B884B54DA%40cornell.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000392.html">
   <LINK REL="Next"  HREF="000389.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Persisting Data</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Persisting%20Data&In-Reply-To=2674C3FB-434E-46FB-BD95-8A3B884B54DA%40cornell.edu"
       TITLE="[rabbitmq-discuss] Persisting Data">matthias at lshift.net
       </A><BR>
    <I>Tue Dec 25 10:54:03 GMT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000392.html">[rabbitmq-discuss] Persisting Data
</A></li>
        <LI>Next message: <A HREF="000389.html">[rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#393">[ date ]</a>
              <a href="thread.html#393">[ thread ]</a>
              <a href="subject.html#393">[ subject ]</a>
              <a href="author.html#393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Varun,

Varun Samuel wrote:
&gt;<i> I wrote a small program to create and send persistent messages to a
</I>&gt;<i> durable queue. Once it had sent the messages it would try to read
</I>&gt;<i> them immediately using basicGet. This seems to be the problem. Once I
</I>&gt;<i> had a separate client try to read the messages, everything was fine.
</I>&gt;<i> But one program sending messages to the queue then immediately trying
</I>&gt;<i> to read them doesn't work.
</I>
basic.publish is an asynchronous operation. There is no way to tell when 
the messages thus published will be available via basic.get. Whether you 
perform the publish and get on the same or different connections does 
not change that, but it does alter the timing, which means you can (but 
are not guaranteed to) get different results.

&gt;<i> With regards to the other issue- reading the last n messages in a  
</I>&gt;<i> queue, you wrote:
</I>&gt;<i> 
</I>&gt;<i> ---
</I>&gt;<i> To simulate a last-value cache, you could write a simple &quot;replay&quot;
</I>&gt;<i> service that keeps a log of recent chat messages, and sends them out
</I>&gt;<i> when asked by a new chat participant.
</I>&gt;<i> ---
</I>&gt;<i> 
</I>&gt;<i> I wasn't sure if you meant this was done inside rabbitmq. I just  
</I>&gt;<i> settled on sticking every sent message in a LIFO data
</I>&gt;<i> structure, outside of rabbitmq. Any client connecting to rabbitmq  
</I>&gt;<i> would first get the messages from that
</I>&gt;<i> 
</I>&gt;<i> This is a very basic way to do it. I read a bit of the AMQP spec and  
</I>&gt;<i> didn't see anything about doing it in there. Does the
</I>&gt;<i> method you describe make use of rabbitmq to log recent chat messages?
</I>
What you implemented is exactly what Tony suggested. There is no way to 
do this inside AMQP 0-8/9. AMQP 0-10 will offer queue browsing, allowing 
clients to read messages from a queue without consuming them. There have 
also been some discussions in the working group about supporting last 
value caches more directly.

&gt;<i> Thanks, and Happy Holidays!
</I>
Thank you, and the same to you.


Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000392.html">[rabbitmq-discuss] Persisting Data
</A></li>
	<LI>Next message: <A HREF="000389.html">[rabbitmq-discuss] Disk/Memory Usage with RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#393">[ date ]</a>
              <a href="thread.html#393">[ thread ]</a>
              <a href="subject.html#393">[ subject ]</a>
              <a href="author.html#393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
