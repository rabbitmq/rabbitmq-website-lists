<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Channel thread safety in Java Client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Channel%20thread%20safety%20in%20Java%20Client&In-Reply-To=84fb38e30907031334p56ac5affuf5d92c9428779477%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003999.html">
   <LINK REL="Next"  HREF="004009.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Channel thread safety in Java Client</H1>
    <B>Ben Hood</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Channel%20thread%20safety%20in%20Java%20Client&In-Reply-To=84fb38e30907031334p56ac5affuf5d92c9428779477%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Channel thread safety in Java Client">0x6e6562 at gmail.com
       </A><BR>
    <I>Sat Jul  4 09:33:56 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003999.html">[rabbitmq-discuss] Channel thread safety in Java Client
</A></li>
        <LI>Next message: <A HREF="004009.html">[rabbitmq-discuss] Channel thread safety in Java Client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4000">[ date ]</a>
              <a href="thread.html#4000">[ thread ]</a>
              <a href="subject.html#4000">[ subject ]</a>
              <a href="author.html#4000">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tsuraan,

On Fri, Jul 3, 2009 at 9:34 PM, tsuraan&lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tsuraan at gmail.com</A>&gt; wrote:
&gt;<i> In the Java client guide, it states that channels should not be used
</I>&gt;<i> by more than one thread simultaneously. &#160;How can I guarantee this when
</I>&gt;<i> I have a consumer on a channel? &#160;I'd like to have a consumer that puts
</I>&gt;<i> messages into a local java BlockingQueue, and then once the messages
</I>&gt;<i> are handled by other threads, they are acked on the channel that they
</I>&gt;<i> came from. &#160;I can easily ensure that none of my acks coincide with
</I>&gt;<i> each other, but how can I ensure that the Connection thread isn't
</I>&gt;<i> using the Channel while I'm trying to do an ack?
</I>
The race condition can occur within a single channel is when message
sending gets interleaved and hence sends jumbled frames to the broker.
The connection thread OTOH is not using the channel to transmit
messages, rather, it is the channel that is using the connection to
transmit messages, so I don't think you'll run into an issue if you
are, as I assume, maintaining a mutex around the shared channel
instance.

BTW (I know that app might not permit this), but have you considered
using a channel per consumer?

HTH,

Ben


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003999.html">[rabbitmq-discuss] Channel thread safety in Java Client
</A></li>
	<LI>Next message: <A HREF="004009.html">[rabbitmq-discuss] Channel thread safety in Java Client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4000">[ date ]</a>
              <a href="thread.html#4000">[ thread ]</a>
              <a href="subject.html#4000">[ subject ]</a>
              <a href="author.html#4000">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
