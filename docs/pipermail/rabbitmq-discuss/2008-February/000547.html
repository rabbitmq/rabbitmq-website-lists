<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue info
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Queue%20info&In-Reply-To=47C7FB1B.2060403%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000543.html">
   <LINK REL="Next"  HREF="000545.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue info</H1>
    <B>Ying He</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Queue%20info&In-Reply-To=47C7FB1B.2060403%40lshift.net"
       TITLE="[rabbitmq-discuss] Queue info">yhe at usatech.com
       </A><BR>
    <I>Fri Feb 29 16:47:54 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000543.html">[rabbitmq-discuss] Queue info
</A></li>
        <LI>Next message: <A HREF="000545.html">[rabbitmq-discuss] Queue info
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#547">[ date ]</a>
              <a href="thread.html#547">[ thread ]</a>
              <a href="subject.html#547">[ subject ]</a>
              <a href="author.html#547">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, Tony,
Thanks for your advice. erl works for Solaris(I have it on solaris too)
for rabbit_amqqueue:stat_all() (Note: on solaris <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost</A> will
not work, I have to use machine name)

For werl, it works once on windows XP, and the second time I run it. I
got a erl crush dump. Here is a snippet of the dump file:

=erl_crash_dump:0.1
Fri Feb 29 11:11:51 2008
Slogan: Kernel pid terminated (application_controller)
({application_start_failure,kernel,{shutdown,{kernel,start,[normal,[]]}}
})
System version: Erlang (BEAM) emulator version 5.5.5 [async-threads:0]
Compiled: Tue Jun 12 12:44:20 2007

After this crash, I am not able to run werl -sname yhe -remsh <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at yhe</A>
again successfully. Please advise if you know more about this.

As to the &quot;failure of delivery&quot;, what I mean is if a delivery happens
but the client does not acknowledge it, then according to the AMQP spec,
the server needs to redeliver it if the client start a new session. And
if after all redeliver try of eg 5 times, the server still cannot
deliver the message and get acknowledgement. It should  put the message
to the dead letter queue and cause the client to abort. It will be
helpful to see how many messages are being redelivered because of no
acknowledgement and find a way to examine the message content( I don't
know how though at this moment) 

Best,
Ying


-----Original Message-----
From: Tony Garnock-Jones [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>] 
Sent: Friday, February 29, 2008 7:31 AM
To: Ying He
Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Queue info

Hi Ying,

Ying He wrote:
&gt;<i> I was running rabbitmq-server.bat and I do have some queues with
</I>&gt;<i> producers and consumers and they are working fine running in the
</I>&gt;<i> backgroud. However this command does not show me the right info, when
</I>I
&gt;<i> start in another cmd 
</I>&gt;<i> 
</I>&gt;<i> C:\Program Files\erl5.5.5\bin&gt;erl -sname yhe -remsh <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost</A>
</I>&gt;<i> Eshell V5.5.5  (abort with ^G)
</I>&gt;<i> (<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">yhe at yhe</A>)1&gt; rabbit_amqqueue:stat_all().
</I>&gt;<i> ** exited: {aborted,{no_exists,[amqqueue,[{'$1',[],['$1']}]]}} **
</I>
This is really interesting. I haven't tried the &quot;-remsh&quot; option on
Windows yet, but it looks like it's not registered that it's supposed to
connect to the running broker. For comparison, here's what I see on my
Linux machine:

~$ erl -sname foo -remsh <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at shortstop</A>
Erlang (BEAM) emulator version 5.5.5 [source] [async-threads:0] [hipe]
[kernel-poll:false]

Eshell V5.5.5  (abort with ^G)
(<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at shortstop</A>)1&gt;


Notice how I said &quot;-sname foo&quot;, and the *prompt* I'm given says
&quot;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at shortstop</A>&quot;, indicating that I am issuing commands into a remote
erlang instance, not the local one. In the text you copied into your
email, above, we see &quot;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">yhe at yhe</A>&quot; as the prompt, indicating that commands
you enter are being targetted at the *local* erlang instance, not the
remote one named in the &quot;-remsh&quot; command-line option.

I'll try to find a windows machine upon which to experiment.

&gt;<i> Please advise. Anything I did wrong? 'yhe' is the username.
</I>
If it's also the machine name, perhaps the following will do the trick?

erl -sname temp -remsh <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at yhe</A>

&gt;<i> As to the management interface, it will be good to see the number of
</I>&gt;<i> messages that has been through the queue and the number of messages
</I>that
&gt;<i> still sit on the queue and error log for failure of delivery etc( this
</I>&gt;<i> could be optional)
</I>
The number-of-messages-seen could be added fairly easily. The number of
messages currently on the queue is already present. What do you mean by
&quot;failure of delivery&quot;, in this case?

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] <A HREF="http://www.lshift.net/">http://www.lshift.net/</A> | Email: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000543.html">[rabbitmq-discuss] Queue info
</A></li>
	<LI>Next message: <A HREF="000545.html">[rabbitmq-discuss] Queue info
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#547">[ date ]</a>
              <a href="thread.html#547">[ thread ]</a>
              <a href="subject.html#547">[ subject ]</a>
              <a href="author.html#547">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
