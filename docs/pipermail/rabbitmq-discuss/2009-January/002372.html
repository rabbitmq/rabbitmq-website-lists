<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd: question on the faq
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20question%20on%20the%20faq&In-Reply-To=167204d20901050455g6a8415c8t6a69f1b3ba8107e0%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002391.html">
   <LINK REL="Next"  HREF="002382.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd: question on the faq</H1>
    <B>Tim Coote</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20question%20on%20the%20faq&In-Reply-To=167204d20901050455g6a8415c8t6a69f1b3ba8107e0%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Fwd: question on the faq">tim+rabbitmq.com at coote.org
       </A><BR>
    <I>Mon Jan  5 15:11:09 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002391.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
        <LI>Next message: <A HREF="002382.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2372">[ date ]</a>
              <a href="thread.html#2372">[ thread ]</a>
              <a href="subject.html#2372">[ subject ]</a>
              <a href="author.html#2372">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hullo
Remember, I'm new to messaging technology. I'm coming at this area  
from a more general perspective. Starting with Gray and Reuter's  
definition of a Transaction (an ACID unit of work). My guess is that  
the term's used in a different way in the messaging community, so I'm  
likely to make mistakes.  My background is mostly about understanding  
how to control technology and its use, so I focus on understanding the  
limits first.

Atomic means either everything happens or nothing happens as far as  
the system using a transactional interface is concerned. At minimum,  
I'd expect that if my app sends a message to n recipients, they either  
all get it or none of them do and my app is reliably informed what the  
outcome was. I interpreted Gordon's comment to mean that there were  
side effects that could be abused by programmers to mean that the  
message had got through.  My concern would be that some programmer  
would use a side effect and come to the wrong conclusion.  I probably  
need to read the specs before I make more of a fool of myself.  I'll  
try to read them before I make any comment after this.

 From your bottom example, I'd say that if one of the queues  
disappeared before the tx had been committed, then it should fail and  
rollback. It sounds like a 'theoretically' simple example in  
distributed systems :-)  There seems to be a bigger problem in  
assuring consistent arrival of messages at a destination in a unicast  
case, let alone a multicast model.

I know some of the guys in JPMC at that time.  They knew what they  
were doing.  Of course, they could have been different people from the  
ones that were working on what became RabbitMQ, although one did tell  
me that he was sponsoring some open source messaging work.

Tim


On 5 Jan 2009, at 12:55, Alexis Richardson wrote:

&gt;<i>
</I>&gt;<i> Tim,
</I>&gt;<i>
</I>&gt;<i> On Mon, Jan 5, 2009 at 12:36 PM, Tim Coote &lt;tim 
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">+rabbitmq.com at coote.org</A>&gt; wrote:
</I>&gt;&gt;<i> Mostly the value comes from
</I>&gt;&gt;<i> not having application programmers try to fix errors that they
</I>&gt;&gt;<i> misunderstand, leading to increased cost and decreased quality and
</I>&gt;&gt;<i> performance.
</I>&gt;<i>
</I>&gt;<i> I agree this is a key benefit of ACID in a system with side effects.
</I>&gt;<i> But it is also important to be clear about what sorts of consistency
</I>&gt;<i> (etc) are promised.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> your description implies to me that RabbitMQ message delivery cannot
</I>&gt;&gt;<i> be Atomic, even at the single message level,
</I>&gt;<i>
</I>&gt;<i> I don't understand how you can draw this conclusion from what I said
</I>&gt;<i> (note that the comment below is from Gordon).
</I>&gt;<i>
</I>&gt;<i> My statement included the assertion that at the single message level
</I>&gt;<i> RabbitMQ delivery *is* atomic.  Without single message atomicity it
</I>&gt;<i> would be very hard to reason about consistency *at all*.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> let alone defining units
</I>&gt;&gt;<i> of work that span messages.
</I>&gt;<i>
</I>&gt;<i> RabbitMQ provides a correct implementation of the TX class which
</I>&gt;<i> enables work to be grouped.  It is the TX class to which Gordon refers
</I>&gt;<i> in his email below.  The problem is that the definition of TX is open
</I>&gt;<i> to *some* interpretation in edge cases, and is implemented slightly
</I>&gt;<i> differently by the various brokers.  When we discussed the differences
</I>&gt;<i> in the working group we agreed that it would be more useful to clarify
</I>&gt;<i> how each 'correct' interpretation actually works for pre 1.0 specs,
</I>&gt;<i> pending AMQP 1.0.
</I>&gt;<i>
</I>&gt;<i> We would welcome a discussion of the subtleties of TX on this list.
</I>&gt;<i> If you can find holes in our implementation we would be delighted to
</I>&gt;<i> make it better!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Shame.  Promising that it's even been discussed tho'.
</I>&gt;<i>
</I>&gt;<i> TX was defined in the period 2004-2006 before AMQP became a public
</I>&gt;<i> spec, when it was in incubation at JPMorgan Chase with the assistance
</I>&gt;<i> of several groups of software professionals.  But it's not yet
</I>&gt;<i> perfect.
</I>&gt;<i>
</I>&gt;<i> The complexity of TX arises due to the fact that messaging is about
</I>&gt;<i> routing and delivery as much as it is about enforcing various forms of
</I>&gt;<i> seriality in the presence of change.  For example consider the case
</I>&gt;<i> where N messages are sent in a TX transaction, over multiple queues,
</I>&gt;<i> and during this operation one queue disappears (eg due to failure).  A
</I>&gt;<i> proper treatment of this requires a proper treatment of multiple
</I>&gt;<i> failure cases, and a clear definition of ordering.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> I'll see if I
</I>&gt;&gt;<i> can find the spec that you refer to.
</I>&gt;<i>
</I>&gt;<i> Please do take a look and let us know what you think.
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i>
</I>&gt;<i> alexis
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Tim
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 5 Jan 2009, at 11:35, Gordon Sim wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Alexis Richardson wrote:
</I>&gt;&gt;&gt;&gt;<i> On Wed, Dec 31, 2008 at 12:17 PM, Tim Coote &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim+rabbitmq.com at coote.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> A neophyte's question:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The  faq includes 'is rabbitmq transactional?'
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The answer is 'yes' and then says that it has atomicity and
</I>&gt;&gt;&gt;&gt;&gt;<i> durability
</I>&gt;&gt;&gt;&gt;&gt;<i> guarantees. What about Isolation and consistency?
</I>&gt;&gt;&gt;&gt;<i> There are senses in which AMQP, and RabbitMQ, behaviour can be
</I>&gt;&gt;&gt;&gt;<i> described as ACID, following the wikipedia definition:
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://en.wikipedia.org/wiki/ACID">http://en.wikipedia.org/wiki/ACID</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In recent discussions on improving the text for the tx 'class' in
</I>&gt;&gt;&gt;<i> the 0-9-1 spec there appeared to be some disagreement around the
</I>&gt;&gt;&gt;<i> atomicity guarantee.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In particular, I understood from comments by members of the RabbitMQ
</I>&gt;&gt;&gt;<i> team that though effects of all contained (publish and ack)
</I>&gt;&gt;&gt;<i> operations are visible if the the commit is successful, RabbitMQ
</I>&gt;&gt;&gt;<i> does not guarantee that none of them would be visible in the event
</I>&gt;&gt;&gt;<i> of a failure.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Tim Coote
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>
Tim Coote
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at coote.org</A>
vincit veritas





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002391.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
	<LI>Next message: <A HREF="002382.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2372">[ date ]</a>
              <a href="thread.html#2372">[ thread ]</a>
              <a href="subject.html#2372">[ subject ]</a>
              <a href="author.html#2372">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
