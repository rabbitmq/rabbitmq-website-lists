<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Net::AMQP Perl Client - Status?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Net%3A%3AAMQP%20Perl%20Client%20-%20Status%3F&In-Reply-To=50c8ffe90901111053u50e8c32l7839ed3be310641f%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002475.html">
   <LINK REL="Next"  HREF="002561.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Net::AMQP Perl Client - Status?</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Net%3A%3AAMQP%20Perl%20Client%20-%20Status%3F&In-Reply-To=50c8ffe90901111053u50e8c32l7839ed3be310641f%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Net::AMQP Perl Client - Status?">tonyg at lshift.net
       </A><BR>
    <I>Sun Jan 11 22:38:39 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002475.html">[rabbitmq-discuss] Net::AMQP Perl Client - Status?
</A></li>
        <LI>Next message: <A HREF="002561.html">[rabbitmq-discuss] Net::AMQP Perl Client - Status?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2476">[ date ]</a>
              <a href="thread.html#2476">[ thread ]</a>
              <a href="subject.html#2476">[ subject ]</a>
              <a href="author.html#2476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Darien,

Exchanges have to be declared out-of-band ahead of time (though a clean 
approach to doing the declarations via STOMP would be a great 
contribution), but Queues are declared at the point of subscription.

  1. A queue.declare is done as part of SUBSCRIBE. The boolean STOMP
     headers &quot;passive&quot;, &quot;durable&quot;, &quot;exclusive&quot; and &quot;auto-delete&quot; are used
     as part of the declaration. (They all default &quot;false&quot; except
     &quot;auto-delete&quot;, which defaults &quot;true&quot;.)

  2. If the &quot;exchange&quot; STOMP header is present, a queue.bind is done
     (using also STOMP header &quot;routing_key&quot;).

  3. Finally, a basic.consume is done.

So, to address your second question: it has actually declared and 
started consuming from the queue! So the waiting is expected behaviour.

Regards,
   Tony

Darien Kindlund wrote:
&gt;<i> Hi Tony,
</I>&gt;<i> 
</I>&gt;<i> Great!  That answers most of my questions.... Lastly, I assume you
</I>&gt;<i> still have to pre-declare all your exchanges and queues *outside* of
</I>&gt;<i> Net::Stomp (through some other AMQP interface) -- correct?  I got the
</I>&gt;<i> impression that if any of the exchanges or queues were torn down
</I>&gt;<i> between successive executions of a Net::Stomp client, that any
</I>&gt;<i> messages sent would be silently dropped.
</I>&gt;<i> 
</I>&gt;<i> That leads me to another question -- apparently, when subscribing to a
</I>&gt;<i> non-existent queue, the Net::Stomp client does not kick back any type
</I>&gt;<i> of exception.  Instead, it appears to blindly sit and wait forever,
</I>&gt;<i> with no notification that the bind was unsuccessful.  I assume this is
</I>&gt;<i> a known limitation, right?
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> -- Darien
</I>&gt;<i> 
</I>&gt;<i> On Sun, Jan 11, 2009 at 1:41 PM, Tony Garnock-Jones &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>&gt; wrote:
</I>&gt;&gt;<i> Hi Darien,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (CCs trimmed)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Darien Kindlund wrote:
</I>&gt;&gt;&gt;<i> Additionally, I was curious if the STOMP adapter provides a way for a
</I>&gt;&gt;&gt;<i> Net::Stomp perl client to connect to a different vhost (other than
</I>&gt;&gt;&gt;<i> '/').
</I>&gt;&gt;<i> Yes: supply a custom header, &quot;virtual-host&quot;, to the CONNECT command. I'm not
</I>&gt;&gt;<i> 100% certain, but I suspect you can do this by
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  $stomp-&gt;connect({login=&gt;'guest', passcode=&gt;'guest',
</I>&gt;&gt;<i>                   &quot;virtual-host&quot;=&gt;'/my-virtual-host'})
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There are a couple of other extension headers available; I'm afraid I
</I>&gt;&gt;<i> haven't gotten around to the dreaded documentation yet, so reading
</I>&gt;&gt;<i> rabbit_stomp.erl is the only way to discover them. A quick grep provides:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  CONNECT virtual-host
</I>&gt;&gt;<i>  CONNECT realm
</I>&gt;&gt;<i>  SEND exchange
</I>&gt;&gt;<i>  SUBSCRIBE exchange
</I>&gt;&gt;<i>  SUBSCRIBE routing_key
</I>&gt;&gt;<i>  various message properties in SEND
</I>&gt;&gt;<i>  queue and binding attributes in various methods
</I>&gt;&gt;<i>    (X-, X-Q-, X-B- prefixes)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i>  Tony
</I>&gt;&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002475.html">[rabbitmq-discuss] Net::AMQP Perl Client - Status?
</A></li>
	<LI>Next message: <A HREF="002561.html">[rabbitmq-discuss] Net::AMQP Perl Client - Status?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2476">[ date ]</a>
              <a href="thread.html#2476">[ thread ]</a>
              <a href="subject.html#2476">[ subject ]</a>
              <a href="author.html#2476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
