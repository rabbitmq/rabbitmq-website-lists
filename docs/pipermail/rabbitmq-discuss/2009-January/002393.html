<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd: question on the faq
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20question%20on%20the%20faq&In-Reply-To=4962407A.2040708%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002388.html">
   <LINK REL="Next"  HREF="002394.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd: question on the faq</H1>
    <B>Gordon Sim</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20question%20on%20the%20faq&In-Reply-To=4962407A.2040708%40lshift.net"
       TITLE="[rabbitmq-discuss] Fwd: question on the faq">gsim at redhat.com
       </A><BR>
    <I>Mon Jan  5 20:51:09 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002388.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
        <LI>Next message: <A HREF="002394.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2393">[ date ]</a>
              <a href="thread.html#2393">[ thread ]</a>
              <a href="subject.html#2393">[ subject ]</a>
              <a href="author.html#2393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias Radestock wrote:
&gt;<i> Alexis Richardson wrote:
</I>&gt;&gt;<i> In fact one can take two different views of transactions in the sense
</I>&gt;&gt;<i> of AMQP TX:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. Operations are operations on *resources* - so more like databases
</I>&gt;&gt;<i> (Jim Gray et al.).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. Operations are about control of a *stream*.
</I>&gt;<i> 
</I>&gt;<i> I reckon this distinction is at the heart of some of the confusion on 
</I>&gt;<i> this issue.
</I>&gt;<i> 
</I>&gt;<i> RabbitMQ is firmly in the second camp. And it *is* ACID under that 
</I>&gt;<i> interpretation 
</I>
I'm not sure I follow you. If, as I understood your earlier comment to 
imply, the various transactional operations cannot be atomically 
aborted, it would seem to me that it is not ACID under either 
interpretation.

E.g. if a transaction where I publish a message and acknowledge another 
is aborted, is it possible that the published message is delivered to a 
subscriber of some matching queue and the acknowledged message is left 
on the queue and is subsequently redelivered to another subscriber? If 
so it is not atomic.

Personally I'm not convinced the stream/resource distinction alters the 
issue which for me relates to the success of operations. A successful 
publish operation causes a message to become available for delivery to 
subscribers on all matching queues; a successful ack operation prevents 
the referenced message from being redelivered. Atomicity means that 
either all the are 'successful', or none of them have any effect.

&gt;<i> And because ...
</I>&gt;<i> 
</I>&gt;&gt;<i> Routing to a queue is acceptable streaming behaviour.  So
</I>&gt;&gt;<i> if the queue fails after being routed to, then it is not unreasonable
</I>&gt;&gt;<i> to treat something as having 'happened'.
</I>
A bug (or indeed some hardware failure) may prevent a message from being 
accepted by the queue. Thats a different case from the queue not 
existing. In the current AMQP routing model publishing a message for 
which no binding matches is not an error, but the failure or a bound 
queue to accept a message routed to it is in my view an error and should 
be signaled as such.

&gt;<i> ... arguably, to be fully consistent with the second interpretation a 
</I>&gt;<i> tx.commit (and rollback) should *succeed* even if some of the queues to 
</I>&gt;<i> which messages/acks were delivered disappears. RabbitMQ's tx.commit 
</I>&gt;<i> currently returns an error for this, which is something we may want to 
</I>&gt;<i> change.
</I>
If the queue is explicitly deleted by the application, I think thats 
fair enough. If it 'disappears' due to some failure condition I think 
that should cause an error which would in turn abort the transaction.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002388.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
	<LI>Next message: <A HREF="002394.html">[rabbitmq-discuss] Fwd: question on the faq
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2393">[ date ]</a>
              <a href="thread.html#2393">[ thread ]</a>
              <a href="subject.html#2393">[ subject ]</a>
              <a href="author.html#2393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
