<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Mnesia db integrity
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Mnesia%20db%20integrity&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002776.html">
   <LINK REL="Next"  HREF="002783.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Mnesia db integrity</H1>
    <B>Valentino Volonghi</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Mnesia%20db%20integrity&In-Reply-To="
       TITLE="[rabbitmq-discuss] Mnesia db integrity">dialtone at gmail.com
       </A><BR>
    <I>Fri Jan 30 20:13:22 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002776.html">[rabbitmq-discuss] Work distribution
</A></li>
        <LI>Next message: <A HREF="002783.html">[rabbitmq-discuss] Mnesia db integrity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2782">[ date ]</a>
              <a href="thread.html#2782">[ thread ]</a>
              <a href="subject.html#2782">[ subject ]</a>
              <a href="author.html#2782">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I'm doing some deployment testing on EC2 in these days using EBS to  
store
the mnesia directory for rabbitmq and I found a problem that I need to  
solve.

Basically the issue is something that was already discussed an year on  
this
list. After a simulated crash (basically just shutdown the system  
without stopping
services) and a restart rabbitmq reacts by crashing on the mnesia  
directory.

The error is essentially timeout_waiting_for_tables  which I suppose  
means that
the system crashed while everything was in the middle of a transaction  
of some
kind (the server though wasn't hit with any traffic and no messages  
were around).

I thought that by saving rabbitmq log files and removing the mnesia  
files rabbitmq
would have picked up the undelivered messages but apparently all I get  
from
the logs is a:

Rolling persister log to &quot;/mnt/ebs/adrollserver/mnesia/adserverrmq/ 
rabbit_persister.LOG.previous&quot;

Which basically means that it discards my messages that won't be  
transmitted again.

Is there any way to automatically or manually fix this issue or to  
have rabbitmq
not choke on it?

- --
Valentino Volonghi aka Dialtone
Now running MacOS X 10.5
Home Page: <A HREF="http://www.twisted.it">http://www.twisted.it</A>
<A HREF="http://www.adroll.com">http://www.adroll.com</A>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)

iEYEARECAAYFAkmDX2IACgkQ9Llz28widGVj1gCdEwwmKS4Bdx7pDS82yBSWLnJq
CusAn0Nm7s4StRx+kVfaf25hZSiMmcAW
=w0tx
-----END PGP SIGNATURE-----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002776.html">[rabbitmq-discuss] Work distribution
</A></li>
	<LI>Next message: <A HREF="002783.html">[rabbitmq-discuss] Mnesia db integrity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2782">[ date ]</a>
              <a href="thread.html#2782">[ thread ]</a>
              <a href="subject.html#2782">[ subject ]</a>
              <a href="author.html#2782">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
