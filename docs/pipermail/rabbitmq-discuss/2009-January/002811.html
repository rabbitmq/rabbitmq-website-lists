<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] getting started, broker runs;	can't get status
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20getting%20started%2C%20broker%20runs%3B%0A%09can%27t%20get%20status&In-Reply-To=4984C4DC.1080105%40cohesiveft.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002810.html">
   <LINK REL="Next"  HREF="002809.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] getting started, broker runs;	can't get status</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20getting%20started%2C%20broker%20runs%3B%0A%09can%27t%20get%20status&In-Reply-To=4984C4DC.1080105%40cohesiveft.com"
       TITLE="[rabbitmq-discuss] getting started, broker runs;	can't get status">matthias at lshift.net
       </A><BR>
    <I>Sat Jan 31 23:48:33 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002810.html">[rabbitmq-discuss] getting started, broker runs;	can't get status
</A></li>
        <LI>Next message: <A HREF="002809.html">[rabbitmq-discuss] getting started, broker runs;	can't get status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2811">[ date ]</a>
              <a href="thread.html#2811">[ thread ]</a>
              <a href="subject.html#2811">[ subject ]</a>
              <a href="author.html#2811">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dmitriy, Dave, Christopher,

Dmitriy Samovskiy wrote:
&gt;<i> Yep, the way I am reading this, ALIVE_REQ is alone on its connection, 
</I>&gt;<i> other commands use their own connections. So looks like the second 
</I>&gt;<i> connection always fails (and I assume ALIVE_REQ will always be the first 
</I>&gt;<i> one)?
</I>
Hmmm. This particular FIXME in the epmd code caught my attention.

&gt;<i> * FIXME: In this code we assume that the packets we send on each
</I>&gt;<i> * socket is so small that a &quot;write()&quot; never block
</I>
...and looking a the code I don't think it deals with partial packets on 
read particularly well either. I could be wrong though.

I wonder whether the disabling of Nagle in 1.5.1 (which was enabled in 
1.5.0 due to a bug) might cause the server to fragment packets and thus 
upset epmd.

This might also explain the problems Christopher was seeing. So ...


Dave, Christopher, to test the above theory, please re-enable Nagle by 
changing the following lines in the rabbitmq-server script from

[ &quot;x&quot; = &quot;x$RABBITMQ_SERVER_ERL_ARGS&quot; ] &amp;&amp; RABBITMQ_SERVER_ERL_ARGS=&quot;+K 
true +A30 \
-kernel inet_default_listen_options 
[{nodelay,true},{sndbuf,16384},{recbuf,4096}] \
-kernel inet_default_connect_options [{nodelay,true}]&quot;

to

[ &quot;x&quot; = &quot;x$RABBITMQ_SERVER_ERL_ARGS&quot; ] &amp;&amp; RABBITMQ_SERVER_ERL_ARGS=&quot;+K 
true +A30&quot;

(Alternatively you can override the value by setting 
RABBITMQ_SERVER_ERL_ARGS in your shell or SERVER_ERL_ARGS in 
/etc/default/rabbitmq)


Then try starting the server and invoking rabbitmqctl.


Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002810.html">[rabbitmq-discuss] getting started, broker runs;	can't get status
</A></li>
	<LI>Next message: <A HREF="002809.html">[rabbitmq-discuss] getting started, broker runs;	can't get status
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2811">[ date ]</a>
              <a href="thread.html#2811">[ thread ]</a>
              <a href="subject.html#2811">[ subject ]</a>
              <a href="author.html#2811">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
