<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fwd: Fwd: Fw: Errors using Windows .NET	Client Library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20Fwd%3A%20Fw%3A%20Errors%20using%20Windows%20.NET%0A%09Client%20Library&In-Reply-To=47F0987C.3050401%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000641.html">
   <LINK REL="Next"  HREF="000643.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fwd: Fwd: Fw: Errors using Windows .NET	Client Library</H1>
    <B>BillC</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Fwd%3A%20Fwd%3A%20Fw%3A%20Errors%20using%20Windows%20.NET%0A%09Client%20Library&In-Reply-To=47F0987C.3050401%40lshift.net"
       TITLE="[rabbitmq-discuss] Fwd: Fwd: Fw: Errors using Windows .NET	Client Library">billc at inworksol.com
       </A><BR>
    <I>Mon Mar 31 09:56:40 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000641.html">[rabbitmq-discuss] Fwd: Fwd: Fw: Errors using Windows .NET Client Library
</A></li>
        <LI>Next message: <A HREF="000643.html">[rabbitmq-discuss] basic public-subscribe model with erlang-client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#642">[ date ]</a>
              <a href="thread.html#642">[ thread ]</a>
              <a href="subject.html#642">[ subject ]</a>
              <a href="author.html#642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,
   
  Thanks for your response.  I cleared everything in my Mnesia and Log files and restarted the broker.  I also changed my props.DeliveryMode = 1 to make non persistent messages on basicpublish.   I also ensured that my basicpublisher closes both the channel and connections properly in the basicpublisher code. 
   
  I tried running this code on multiple computers and still get the same problem.  I also ran it against your dev environment hoping that maybe it was a problem with my installed broker but it still did not work.  Earlier today I also took the SimpleSubscriber Java solution and build that sample.  And the Java one just works perfectly without any problems.  I used the same simple publisher and the java simplesubscriber just blocked and received msgs whenever I sent them via the simplepublisher.  So I am thinking probably the one thing left to verify is whether or not we are running the same RabbitMQ.Client DLL file. I sent you the version that I am running, please let me know if we are running the same one.
   
  Here is the sequence of events to explain the attached log file:
   
  1)  Start broker and broker rebuilds fresh cope of both db and log directories after I had deleted the old ones
  2) Run my basicpublisher program twice to publish two simple &quot;hello&quot; msgs
  3) Rum my basicsubscriber program which dequeues the two msgs and immediately throws the EndOfStream Exception and I think in the log results in the &quot;abrupt socket closure&quot;.
  4)  I again run my basicsubscriber program and this time there is no msg in the queue so when it tries to deque .. there is nothing ... and it immediately causes another &quot;abrupt socket closure&quot; in log.  Here is the log:
   
  
=INFO REPORT==== 31-Mar-2008::03:29:00 ===
    application: mnesia
    exited: stopped
    type: temporary
  =INFO REPORT==== 31-Mar-2008::03:29:00 ===
Added vhost &lt;&lt;&quot;/&quot;&gt;&gt;
  =INFO REPORT==== 31-Mar-2008::03:29:00 ===
Created user &lt;&lt;&quot;guest&quot;&gt;&gt;
  =INFO REPORT==== 31-Mar-2008::03:29:00 ===
Rolling persister log to &quot;c:/Documents and Settings/Development/rabbitmq/db/rabbit-mnesia/rabbit_persister.LOG.previous&quot;
  =INFO REPORT==== 31-Mar-2008::03:29:00 ===
started TCP listener on 0.0.0.0:5672
  =INFO REPORT==== 31-Mar-2008::03:30:50 ===
accepted TCP connection on 0.0.0.0:5672 from 10.10.10.25:2581
  =INFO REPORT==== 31-Mar-2008::03:30:50 ===
closing TCP connection from 10.10.10.25:2581
  =INFO REPORT==== 31-Mar-2008::03:30:53 ===
accepted TCP connection on 0.0.0.0:5672 from 10.10.10.25:2582
  =INFO REPORT==== 31-Mar-2008::03:30:53 ===
closing TCP connection from 10.10.10.25:2582
  =INFO REPORT==== 31-Mar-2008::03:31:13 ===
accepted TCP connection on 0.0.0.0:5672 from 10.10.10.25:2583
  =INFO REPORT==== 31-Mar-2008::03:31:14 ===
Connection closed abruptly.
  =INFO REPORT==== 31-Mar-2008::03:31:14 ===
closing TCP connection from 10.10.10.25:2583
  =INFO REPORT==== 31-Mar-2008::03:34:45 ===
accepted TCP connection on 0.0.0.0:5672 from 10.10.10.25:2584
  =INFO REPORT==== 31-Mar-2008::03:34:46 ===
Connection closed abruptly.
  =INFO REPORT==== 31-Mar-2008::03:34:46 ===
closing TCP connection from 10.10.10.25:2584

   
  

Matthias Radestock &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>&gt; wrote:
  Bill,,

BillC wrote:
&gt;<i> Here is the log on RabbitMQ:
</I>&gt;<i> 
</I>&gt;<i> Thanks for your help. I just cleaned up the old log. Ran the publish 
</I>&gt;<i> program twice to enque two messages. Then I ran the subscriber program 
</I>&gt;<i> to deque twice.
</I>&gt;<i> 
</I>&gt;<i> I see a lot of abrupt connection closures but no real explanations as to 
</I>&gt;<i> the reason.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 30-Mar-2008::16:25:40 ===
</I>&gt;<i> disk_log: repairing &quot;c:/Documents and 
</I>&gt;<i> Settings/Development/rabbitmq/db/rabbit-mnesia/rabbit_persister.LOG&quot; ...
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 30-Mar-2008::16:25:40 ===
</I>&gt;<i> Repaired persister log - 22 recovered, 0 bad
</I>
That is an odd error. Do you get it every time you start the broker? How 
are you stopping the broker?

That plus the tracer log you sent previously indicate that your test 
uses persistent messages. There is nothing wrong with that but it may 
explain why you are seeing errors when we don't. Try running your tests 
with transient messages, after clearing out the previously persisted 
messages (stop the broker, remove the persister log file mentioned above 
and then restart the broker).


Matthias.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080331/b4ad4bf9/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20080331/b4ad4bf9/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000641.html">[rabbitmq-discuss] Fwd: Fwd: Fw: Errors using Windows .NET Client Library
</A></li>
	<LI>Next message: <A HREF="000643.html">[rabbitmq-discuss] basic public-subscribe model with erlang-client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#642">[ date ]</a>
              <a href="thread.html#642">[ thread ]</a>
              <a href="subject.html#642">[ subject ]</a>
              <a href="author.html#642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
