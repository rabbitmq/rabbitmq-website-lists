<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss]  RabbitMQ on EC2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20RabbitMQ%20on%20EC2&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000598.html">
   <LINK REL="Next"  HREF="000586.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss]  RabbitMQ on EC2</H1>
    <B>Kyle Salasko</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20RabbitMQ%20on%20EC2&In-Reply-To="
       TITLE="[rabbitmq-discuss]  RabbitMQ on EC2">ksalasko at gmail.com
       </A><BR>
    <I>Fri Mar 14 02:10:51 GMT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000598.html">[rabbitmq-discuss] NPE in RpcClient
</A></li>
        <LI>Next message: <A HREF="000586.html">[rabbitmq-discuss] RabbitMQ on EC2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#585">[ date ]</a>
              <a href="thread.html#585">[ thread ]</a>
              <a href="subject.html#585">[ subject ]</a>
              <a href="author.html#585">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I'm trying to create a cluster of RabbitMQ nodes on EC2 and I've been running
into some trouble. Using the cluster command succeeds, but the nodes end up
in an inconsistent state. It's easier to give an example than to explain the
results, so I'll post them below.

There are 3 nodes:
Node A calls itself <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-D1</A>
Node B calls itself <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>
Node C calls itself <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2.</A>

First I clustered A and B, as disk nodes. This worked fine. Then I tried to
add Node C.

Node A says:
Status of node '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-D1</A>' ...
[{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;1.2.0&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.3.3&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.1.1&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.4&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.14.2&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.11.2&quot;}]},
 {nodes,['<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-D1</A>',
         '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>',
         '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2</A>']},

{running_nodes,['<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>','<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-D1</A>']}]

Node B says:
Status of node '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>' ...
[{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;1.2.0&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.3.3&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.1.1&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.4&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.14.2&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.11.2&quot;}]},
 {nodes,['<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-D1</A>',
         '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>',
         '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2</A>']},
 {running_nodes,['<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-D1</A>',
                 '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2</A>',
                 '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>']}]

Node C says:
Status of node '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2</A>' ...
[{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;1.2.0&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.3.3&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.1.1&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.4&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.14.2&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.11.2&quot;}]},
 {nodes,['<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>','<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2</A>']},

{running_nodes,['<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-251-159-160</A>','<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at domU-12-31-38-00-48-A2</A>']}]

If I reset A, then cluster it with C and B, I get a situation where A and C
switch: C can see all 3, but thinks A is down, and A can only see itself and
B.

I'm hoping someone has seen a similar problem before and can either point me
to where to look for either pointers on what may be wrong with my EC2 or
RabbitMQ setups. I know port 4369 is open, and the nodes can reach each
other via ping. I've managed to replicate this with additional boxes and
entire new setups.

Thanks for the help.

Kyle Salasko
-- 
View this message in context: <A HREF="http://www.nabble.com/RabbitMQ-on-EC2-tp16042914p16042914.html">http://www.nabble.com/RabbitMQ-on-EC2-tp16042914p16042914.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000598.html">[rabbitmq-discuss] NPE in RpcClient
</A></li>
	<LI>Next message: <A HREF="000586.html">[rabbitmq-discuss] RabbitMQ on EC2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#585">[ date ]</a>
              <a href="thread.html#585">[ thread ]</a>
              <a href="subject.html#585">[ subject ]</a>
              <a href="author.html#585">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
