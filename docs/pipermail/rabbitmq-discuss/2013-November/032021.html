<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Very slow basic_publish
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Very%20slow%20basic_publish&In-Reply-To=%3Cf438e0f9-340b-436a-ad60-f2405f47c4cc%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032017.html">
   <LINK REL="Next"  HREF="032024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Very slow basic_publish</H1>
    <B>Ian Adams</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Very%20slow%20basic_publish&In-Reply-To=%3Cf438e0f9-340b-436a-ad60-f2405f47c4cc%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Very slow basic_publish">ian.forrest.adams at gmail.com
       </A><BR>
    <I>Tue Nov 19 18:12:19 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="032017.html">[rabbitmq-discuss] does topic exchange route messages to different queues in the same order ?
</A></li>
        <LI>Next message: <A HREF="032024.html">[rabbitmq-discuss] Very slow basic_publish
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32021">[ date ]</a>
              <a href="thread.html#32021">[ thread ]</a>
              <a href="subject.html#32021">[ subject ]</a>
              <a href="author.html#32021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All,

Im pretty new to RMQ, been messing about with it and noticed that 
publishing messages via pika seems quite slow.

Im using a default configuration of the broker, all produces and consumers 
running on the same machine as the broker.

What I'm noticing is that its (relatively) extremely slow to publish 
messages to the broker, but the once the broker has them, it goes blazingly 
fast in getting them to various consumers.

For example, the below code (ripped off from then RMQ tutorials) can 
publish messages at around 250-300 messages per second, this is both in an 
ubuntu vm and on a 'bare metal' Mac running OS X 10.8 ( I can provide more 
detailed hardware info if needed)

<A HREF="http://pastebin.com/JNXwmYx7">http://pastebin.com/JNXwmYx7</A>

The consumer, on the other hand (which doesn't do anything with them 
really, this is just testing), can receive them at up to 20k messages a 
second if I let the queue build up. 

When I profiled my message producer, it seems to be spending the vast 
majority of its time polling. cProf sees:

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
----
308    3.202    0.010    3.202    0.010 {built-in method poll}
----

Is there some configuration I'm missing? Or am I abusing some 
functionality? Im making sure that there is no acks, and no durability so 
it should be the disk at least.

Thanks guys!


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131119/6061ca13/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131119/6061ca13/attachment.htm</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032017.html">[rabbitmq-discuss] does topic exchange route messages to different queues in the same order ?
</A></li>
	<LI>Next message: <A HREF="032024.html">[rabbitmq-discuss] Very slow basic_publish
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32021">[ date ]</a>
              <a href="thread.html#32021">[ thread ]</a>
              <a href="subject.html#32021">[ subject ]</a>
              <a href="author.html#32021">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
