<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] badmatch in rabbit_channel? (RabbitMQ 3.2.0)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20badmatch%20in%20rabbit_channel%3F%20%28RabbitMQ%203.2.0%29&In-Reply-To=%3C527BC6CE.7020001%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031770.html">
   <LINK REL="Next"  HREF="031772.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] badmatch in rabbit_channel? (RabbitMQ 3.2.0)</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20badmatch%20in%20rabbit_channel%3F%20%28RabbitMQ%203.2.0%29&In-Reply-To=%3C527BC6CE.7020001%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] badmatch in rabbit_channel? (RabbitMQ 3.2.0)">simon at rabbitmq.com
       </A><BR>
    <I>Thu Nov  7 16:58:54 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031770.html">[rabbitmq-discuss] badmatch in rabbit_channel? (RabbitMQ 3.2.0)
</A></li>
        <LI>Next message: <A HREF="031772.html">[rabbitmq-discuss] RabbitMQ 3.2.1 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31774">[ date ]</a>
              <a href="thread.html#31774">[ thread ]</a>
              <a href="subject.html#31774">[ subject ]</a>
              <a href="author.html#31774">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Huh. That's puzzling. The broker maintains some extra tables for 
bindings to topic exchanges which turned out not to contain any records 
for the binding when it was deleted.

So I'd like to get to the bottom of this. It's weird though because that 
code was written for RabbitMQ 2.4.0 and hasn't changed in a long time, 
and everybody who uses topic exchanges uses it - so I would not expect 
to be finding bugs now.

So are you able to replicate this? Could anything be messing with these 
tables?

Cheers, Simon

On 07/11/13 13:59, Gotthard, Petr wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I&#8217;m not sure if this is a bug, but I encountered a badmatch in RabbitMQ
</I>&gt;<i> 3.2.0 when removing bindings shortly before closing connection (during
</I>&gt;<i> application shutdown).
</I>&gt;<i>
</I>&gt;<i> 2013-11-07 14:14:16.583 [debug] &lt;0.674.0&gt; Supervisor
</I>&gt;<i> {&lt;0.674.0&gt;,rabbit_channel_sup} started rabbit_channel:start_link(1,
</I>&gt;<i> &lt;0.669.0&gt;, &lt;0.675.0&gt;, &lt;0.669.0&gt;, &lt;&lt;&quot;192.168.80.1:17459 -&gt;
</I>&gt;<i> 192.168.80.128:5672&quot;&gt;&gt;, rabbit_framing_amqp_0_9_1,
</I>&gt;<i> {user,&lt;&lt;&quot;guest&quot;&gt;&gt;,[administrator],rabbit_auth_backend_internal,{internal_user,&lt;&lt;&quot;guest&quot;&gt;&gt;,&lt;&lt;38,...&gt;&gt;,...}},
</I>&gt;<i> &lt;&lt;&quot;/&quot;&gt;&gt;,
</I>&gt;<i> [{&lt;&lt;&quot;publisher_confirms&quot;&gt;&gt;,bool,true},{&lt;&lt;&quot;consumer_cancel_notify&quot;&gt;&gt;,bool,true},{&lt;&lt;&quot;basic.nack&quot;&gt;&gt;,...},...],
</I>&gt;<i> &lt;0.670.0&gt;, &lt;0.676.0&gt;) at pid &lt;0.677.0&gt;
</I>&gt;<i>
</I>&gt;<i> 2013-11-07 14:14:21.798 [error] &lt;0.677.0&gt; CRASH REPORT Process &lt;0.677.0&gt;
</I>&gt;<i> with 0 neighbours exited with reason:
</I>&gt;<i> {error,{{badmatch,{error,[{root,none}],[&quot;turbulence&quot;]}},[{rabbit_exchange_type_topic,follow_down_get_path,2,[]},{rabbit_exchange_type_topic,'-remove_bindings/3-lc$^1/1-1-',1,[]},{rabbit_exchange_type_topic,remove_bindings,3,[]},{rabbit_binding,x_callback,4,[]},{rabbit_binding,'-process_deletions/1-fun-0-',2,[]},{dict,map_bucket,2,[{file,&quot;dict.erl&quot;},{line,459}]},{dict,map_bkt_list,2,[{file,&quot;dict.erl&quot;},{line,455}]},{dict,map_bkt_list,2,[{file,&quot;dict.erl&quot;},{line,455}]}]}}
</I>&gt;<i> in rabbit_misc:execute_mnesia_transaction/1 in gen_server2:terminate/3
</I>&gt;<i>
</I>&gt;<i> If this is not desirable I can provide you with more details and/or help
</I>&gt;<i> hunting the problem.
</I>&gt;<i>
</I>&gt;<i> Petr
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031770.html">[rabbitmq-discuss] badmatch in rabbit_channel? (RabbitMQ 3.2.0)
</A></li>
	<LI>Next message: <A HREF="031772.html">[rabbitmq-discuss] RabbitMQ 3.2.1 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31774">[ date ]</a>
              <a href="thread.html#31774">[ thread ]</a>
              <a href="subject.html#31774">[ subject ]</a>
              <a href="author.html#31774">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
