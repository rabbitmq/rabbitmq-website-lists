<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Exchange Feature request: Drop Duplicates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange%20Feature%20request%3A%20Drop%20Duplicates&In-Reply-To=%3C52812E91.2020806%40reik.se%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031838.html">
   <LINK REL="Next"  HREF="031860.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Exchange Feature request: Drop Duplicates</H1>
    <B>Matthias Reik</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange%20Feature%20request%3A%20Drop%20Duplicates&In-Reply-To=%3C52812E91.2020806%40reik.se%3E"
       TITLE="[rabbitmq-discuss] Exchange Feature request: Drop Duplicates">maze at reik.se
       </A><BR>
    <I>Mon Nov 11 19:22:57 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031838.html">[rabbitmq-discuss] Exchange Feature request: Drop Duplicates
</A></li>
        <LI>Next message: <A HREF="031860.html">[rabbitmq-discuss] Exchange Feature request: Drop Duplicates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31859">[ date ]</a>
              <a href="thread.html#31859">[ thread ]</a>
              <a href="subject.html#31859">[ subject ]</a>
              <a href="author.html#31859">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Even though it sounds like a nice feature, it is probably difficult to 
really implement, if not done on the client side. The duplicates might 
happen when delivering to the client side. but on the client side it 
should be quite easy to do the filtering:
* get a message from the queue,
* check against memcached (couchbase, or some other cache technology) 
whether the messageID exists.
* Add the new message to memcached (can be done with the previous step)
* Set the timeout in memcached to your window size.

This should be straight forward, would scale up to quite a lot of 
messages) and should remove (depending on your window size) all duplicates.

Is there a good reason why you wouldn't want to do this on the client 
side as described?

Cheers
Matthias

PS: as a caching technology you could of course do your own 
in-memory-solution but that's probably more work than to use an 
out-of-the-box solution.

On 2013-11-11 12:35 , Laing, Michael wrote:
&gt;<i> In our scenarios, messages are ultimately delivered to a 'retail' 
</I>&gt;<i> rabbitmq instance to be delivered to a client. The pipelines that 
</I>&gt;<i> process and deliver messages are purposefully redundant, hence there 
</I>&gt;<i> may be multiple replicas of each message 'racing' to the endpoint.
</I>&gt;<i>
</I>&gt;<i> Usually, the replicas are resolved before getting to the retail 
</I>&gt;<i> rabbit. When components fail, however, duplicates can leak through 
</I>&gt;<i> during a small window of time. We eliminate those duplicates at the 
</I>&gt;<i> retail layer by looking at each message_id. Ultimately, our client 
</I>&gt;<i> contract allows duplicates as well in case one slips by.
</I>&gt;<i>
</I>&gt;<i> It seems to me that this is a generic issue.
</I>&gt;<i>
</I>&gt;<i> What would be useful in our case, and hopefully for many others, would 
</I>&gt;<i> be a 'Duplicate Message ID Window' in milliseconds, as an exchange 
</I>&gt;<i> attribute.
</I>&gt;<i>
</I>&gt;<i> If non-zero, the exchange would drop any message with a duplicate 
</I>&gt;<i> message_id that appeared within the specified window of time, possibly 
</I>&gt;<i> routing it to the alternate exchange, if set.
</I>&gt;<i>
</I>&gt;<i> In our case, a window of a few seconds, perhaps up to a minute would 
</I>&gt;<i> suffice.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Michael
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131111/7fd1f05c/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131111/7fd1f05c/attachment.htm</A>&gt;
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031838.html">[rabbitmq-discuss] Exchange Feature request: Drop Duplicates
</A></li>
	<LI>Next message: <A HREF="031860.html">[rabbitmq-discuss] Exchange Feature request: Drop Duplicates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31859">[ date ]</a>
              <a href="thread.html#31859">[ thread ]</a>
              <a href="subject.html#31859">[ subject ]</a>
              <a href="author.html#31859">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
