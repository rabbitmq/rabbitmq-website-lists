<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cluster capability?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20capability%3F&In-Reply-To=%3C52947007.9060903%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032135.html">
   <LINK REL="Next"  HREF="032199.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cluster capability?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cluster%20capability%3F&In-Reply-To=%3C52947007.9060903%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Cluster capability?">simon at rabbitmq.com
       </A><BR>
    <I>Tue Nov 26 09:55:19 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="032135.html">[rabbitmq-discuss] Cluster capability?
</A></li>
        <LI>Next message: <A HREF="032199.html">[rabbitmq-discuss] Cluster capability?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32156">[ date ]</a>
              <a href="thread.html#32156">[ thread ]</a>
              <a href="subject.html#32156">[ subject ]</a>
              <a href="author.html#32156">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/11/2013 18:10, Paul Bell wrote:
&gt;<i> &quot;Virtual hosts, exchanges, users, and permissions are automatically
</I>&gt;<i> mirrored across all nodes in a cluster. Queues may be located on a
</I>&gt;<i> single node, or mirrored across multiple nodes
</I>&gt;<i> &lt;<A HREF="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</A>&gt;. A client connecting to any node in a
</I>&gt;<i> cluster can see all queues in the cluster, even if they are not located
</I>&gt;<i> on that node.&quot;
</I>&gt;<i>
</I>&gt;<i> Question: does the last sentence apply to both queues located on a
</I>&gt;<i> single node and to mirrored (HA) queues?
</I>
Yes.

&gt;<i> The last clause of that
</I>&gt;<i> sentence, e.g., &quot;..even if they are not located on that node&quot; suggests
</I>&gt;<i> that whether or not the queues are mirrored shouldn't matter, i.e.,
</I>&gt;<i> client will see the queues regardless of the cluster it connects to.
</I>
Yes. And of course just because a queue is mirrored doesn't mean it has 
to be on *every* node in the cluster - you don't have to use ha-mode: all.

&gt;<i> The cluster approach &quot;feels&quot; complex to me but that is, at least in
</I>&gt;<i> part, due to the fact that my once modest Rabbit skills have atrophied
</I>&gt;<i> over the last couple of year. So, here's some thinking out loud with
</I>&gt;<i> attendant questions:
</I>&gt;<i>
</I>&gt;<i> 1. Let's see, so, the several computers on which my (Java) RabbitMQ
</I>&gt;<i> component runs will be joined together in a cluster.
</I>&gt;<i> 2. What happens if Computer A creates some exchanges and then computer
</I>&gt;<i> B, either before or after joining the cluster, creates the same
</I>&gt;<i> exchanges? Maybe the usual Rabbit idempotency holds here; i.e., if
</I>&gt;<i> exchange exists within the cluster, it's not going to be re-created...?
</I>
Yes, the exchange (along with other metadata) is held in a distributed 
database and created atomically.

&gt;<i> 3. And if the component publishes to an exchange that message should (I
</I>&gt;<i> think) be visible on the mirrored exchanges on all of the other nodes in
</I>&gt;<i> the cluster, right?
</I>
Yes. We don't normally talk about &quot;mirrored exchanges&quot; since all 
exchanges are inherently mirrored.

&gt;<i> 4. And, moreover, once a consumer on any cluster node reads that
</I>&gt;<i> message, no other consumer will be able to read it. I sure hope this is
</I>&gt;<i> true.
</I>
If it only got routed to one queue. Obviously if it was routed to two 
queues it can be read twice, and so on.

Also the message can be seen by two consumers if one consumer is 
consuming in ack mode, then sees the message and either rejects it or 
crashes before acknowledging it. That's true on a single node though, 
nothing to do with clustering.

Cheers, Simon

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032135.html">[rabbitmq-discuss] Cluster capability?
</A></li>
	<LI>Next message: <A HREF="032199.html">[rabbitmq-discuss] Cluster capability?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32156">[ date ]</a>
              <a href="thread.html#32156">[ thread ]</a>
              <a href="subject.html#32156">[ subject ]</a>
              <a href="author.html#32156">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
