<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Stomp, subscriptions, and forward slashes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Stomp%2C%20subscriptions%2C%20and%20forward%20slashes&In-Reply-To=%3C52782144.3090007%40seegrid.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031623.html">
   <LINK REL="Next"  HREF="031671.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Stomp, subscriptions, and forward slashes</H1>
    <B>Brennan Sellner</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Stomp%2C%20subscriptions%2C%20and%20forward%20slashes&In-Reply-To=%3C52782144.3090007%40seegrid.com%3E"
       TITLE="[rabbitmq-discuss] Stomp, subscriptions, and forward slashes">bsellner at seegrid.com
       </A><BR>
    <I>Mon Nov  4 22:35:48 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031623.html">[rabbitmq-discuss] Stomp, subscriptions, and forward slashes
</A></li>
        <LI>Next message: <A HREF="031671.html">[rabbitmq-discuss] Stomp, subscriptions, and forward slashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31666">[ date ]</a>
              <a href="thread.html#31666">[ thread ]</a>
              <a href="subject.html#31666">[ subject ]</a>
              <a href="author.html#31666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 11/04/2013 05:21 AM, Emile Joubert wrote:
&gt;<i>
</I>&gt;<i> On 02/11/13 22:04, Brennan Sellner wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Is there any way to escape the slash in the exchange name when
</I>&gt;&gt;<i> subscribing via web-stomp?  I've blindly tried a few options (i.e. '\\/'
</I>&gt;&gt;<i> or '%47'),
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You can use %2F as an escaped forward-slash character in STOMP.
</I>&gt;<i>
</I>
&lt;facepalm&gt; My bad: URL encoding, not HTML encoding.  Thanks!

One more STOMP / WebSockets-related question: The STOMP 1.1 spec states
that it's possible to transmit binary messages
(<A HREF="http://stomp.github.io/stomp-specification-1.1.html,">http://stomp.github.io/stomp-specification-1.1.html,</A> 'Protocol Overview').

However, when I try to consume a binary protobuf from Javascript,
RabbitMQ drops my connection with the bad_utf8_character_code error
report quoted below.  Browser-side, I'm using SockJS and stomp.js
(<A HREF="http://www.jmesnil.net/stomp-websocket/doc/">http://www.jmesnil.net/stomp-websocket/doc/</A>).

<A HREF="https://github.com/sockjs/sockjs-protocol/issues/74">https://github.com/sockjs/sockjs-protocol/issues/74</A> makes it clear that
SockJS (at least) doesn't yet support binary payloads.  What's not clear
to me is whether rabbitmq_web_stomp does: is it worth fiddling around
with SockJS replacements, or should I just bite the bullet and add a
relay to re-encode everything going to and from the browser as base64?

Thanks,

-Brennan

=ERROR REPORT==== 4-Nov-2013::17:15:03 ===
** Handler sockjs_cowboy_handler terminating in websocket_info/3
    for the reason exit:{ucs,{bad_utf8_character_code}}
** Message was go
** Options were {service,&quot;/stomp&quot;,#Fun&lt;rabbit_ws_sockjs.1.120271989&gt;,{},
                          &quot;<A HREF="http://cdn.sockjs.org/sockjs-0.2.js&quot;,false,true,">http://cdn.sockjs.org/sockjs-0.2.js&quot;,false,true,</A>

5000,25000,131072,#Fun&lt;rabbit_ws_sockjs.0.116551930&gt;}
** Handler state was {websocket,&lt;0.4058.0&gt;}
** Request was {http_req,#Port&lt;0.20033&gt;,cowboy_tcp_transport,keepalive,
                    &lt;0.4057.0&gt;,'GET',
                    {1,1},
                    {{127,0,0,1},33666},
                    [&lt;&lt;&quot;localhost&quot;&gt;&gt;],
                    undefined,&lt;&lt;&quot;localhost&quot;&gt;&gt;,15674,
                    [&lt;&lt;&quot;stomp&quot;&gt;&gt;,&lt;&lt;&quot;615&quot;&gt;&gt;,&lt;&lt;&quot;38_dv47k&quot;&gt;&gt;,&lt;&lt;&quot;websocket&quot;&gt;&gt;],
                    [&lt;&lt;&quot;615&quot;&gt;&gt;,&lt;&lt;&quot;38_dv47k&quot;&gt;&gt;,&lt;&lt;&quot;websocket&quot;&gt;&gt;],
                    &lt;&lt;&quot;/stomp/615/38_dv47k/websocket&quot;&gt;&gt;,undefined,&lt;&lt;&gt;&gt;,[],
                    [{'Cookie',
                         &lt;&lt;&quot;sessionid=600fbdc35df07db74bf4067b38702643;
csrftoken=ae2bc9d9535ef8f220a0eb467883ea4e&quot;&gt;&gt;},
                     {'User-Agent',
                         &lt;&lt;&quot;Mozilla/5.0 (X11; Linux x86_64)
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.110
Safari/537.36&quot;&gt;&gt;},
                     {&lt;&lt;&quot;Sec-Websocket-Extensions&quot;&gt;&gt;,
                      &lt;&lt;&quot;x-webkit-deflate-frame&quot;&gt;&gt;},
                     {&lt;&lt;&quot;Sec-Websocket-Version&quot;&gt;&gt;,&lt;&lt;&quot;13&quot;&gt;&gt;},

{&lt;&lt;&quot;Sec-Websocket-Key&quot;&gt;&gt;,&lt;&lt;&quot;dJr61dUXL0ilQiqpgALD3w==&quot;&gt;&gt;},
                     {'Cache-Control',&lt;&lt;&quot;no-cache&quot;&gt;&gt;},
                     {'Pragma',&lt;&lt;&quot;no-cache&quot;&gt;&gt;},
                     {&lt;&lt;&quot;Origin&quot;&gt;&gt;,&lt;&lt;&quot;<A HREF="http://localhost:8000&quot;">http://localhost:8000&quot;</A>&gt;&gt;},
                     {'Host',&lt;&lt;&quot;localhost&quot;&gt;&gt;},
                     {'Connection',&lt;&lt;&quot;Upgrade&quot;&gt;&gt;},
                     {'Upgrade',&lt;&lt;&quot;websocket&quot;&gt;&gt;}],
                    [{'Upgrade',[&lt;&lt;&quot;websocket&quot;&gt;&gt;]},
                     {'Connection',[&lt;&lt;&quot;upgrade&quot;&gt;&gt;]}],
                    undefined,
                    [{websocket_version,13}],
                    waiting,&lt;&lt;&gt;&gt;,done,[],&lt;&lt;&gt;&gt;,
                    {#Fun&lt;cowboy_http.urldecode.2&gt;,crash}}
** Stacktrace: [{xmerl_ucs,from_utf8,1},
                 {mochijson2_fork,json_encode_string,2},
                 {mochijson2_fork,'-json_encode_array/2-fun-0-',3},
                 {lists,foldl,3},
                 {mochijson2_fork,json_encode_array,2},
                 {sockjs_util,encode_frame,1},
                 {sockjs_ws_handler,reply,2},
                 {sockjs_cowboy_handler,websocket_info,3}]



My apologies for the below:


Email Confidentiality Notice

The information contained in this transmission is confidential, proprietary or privileged and may be subject to protection under the law. This message is intended for the sole use of the individual or entity to whom it's addressed. If you are not the intended recipient, you are notified that any use, distribution or copying of the message is strictly prohibited and may subject you to criminal or civil penalties. If you received this transmission in error, please contact the sender immediately by replying to this email and delete the material from any computer.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031623.html">[rabbitmq-discuss] Stomp, subscriptions, and forward slashes
</A></li>
	<LI>Next message: <A HREF="031671.html">[rabbitmq-discuss] Stomp, subscriptions, and forward slashes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31666">[ date ]</a>
              <a href="thread.html#31666">[ thread ]</a>
              <a href="subject.html#31666">[ subject ]</a>
              <a href="author.html#31666">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
