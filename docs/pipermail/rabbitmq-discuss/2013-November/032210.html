<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] HA Clustering fails to keep message when node	turn down.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20Clustering%20fails%20to%20keep%20message%20when%20node%0A%09turn%20down.&In-Reply-To=%3C3c64d0ff-4d09-480e-924b-b00fc2ce8d6e%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032202.html">
   <LINK REL="Next"  HREF="032219.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] HA Clustering fails to keep message when node	turn down.</H1>
    <B>Normand B&#233;dard</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20Clustering%20fails%20to%20keep%20message%20when%20node%0A%09turn%20down.&In-Reply-To=%3C3c64d0ff-4d09-480e-924b-b00fc2ce8d6e%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] HA Clustering fails to keep message when node	turn down.">normand.bedard at gmail.com
       </A><BR>
    <I>Thu Nov 28 19:46:28 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="032202.html">[rabbitmq-discuss] ANN Langohr 1.7.0 is released
</A></li>
        <LI>Next message: <A HREF="032219.html">[rabbitmq-discuss] HA Clustering fails to keep message when node turn down.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32210">[ date ]</a>
              <a href="thread.html#32210">[ thread ]</a>
              <a href="subject.html#32210">[ subject ]</a>
              <a href="author.html#32210">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am using RabbitMQ 3.1.5 Erlang R15B03. I have two nodes (Node1 and 
Node2). Both are Disc Type. Also, there is a ha-all policy on my virtual 
host.

When I manually create a queue via the Node1 Web Console, I see the &quot;+1&quot; 
label indicating that my queue is mirrored on the two nodes (Node: Node 1, 
Mirrors: Node 2).

Via the Node 1 Web Console, I manually created a message on the queue. 
After that, from both web consoles, I can access my message from the queue. 

When I reboot the server where Node 2 is hosted, the Node 2 Web Console is 
unreachable, and from the Node 1 Web Console, I can confirm the node is 
down. Still from the Node 1 Web Console, I can access my message from the 
mirrored queue. When the Node 2 server is back online, I see that the nodes 
are not synchronized, meaning that new messages arrived on Node 1 during 
the Node 2 shutdown won't be replicated on Node 2. This is the normal 
behavior. Also from the Node 2 Web Console, I can still access my initial 
message. Everything is fine!

Here is my problem...

When I reboot the Node 1 server, I observe all the same behaviors as in my 
previous test where I shutdown Node 2 server, but during the time the Node 
1 is down, there is no messages available from the Node Web Console (but 
the queue is still accessible). 

Why this is happening? The message is not supposed to be persisted on each 
nodes when they are mirrored?





-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131128/ddc292ff/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131128/ddc292ff/attachment.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032202.html">[rabbitmq-discuss] ANN Langohr 1.7.0 is released
</A></li>
	<LI>Next message: <A HREF="032219.html">[rabbitmq-discuss] HA Clustering fails to keep message when node turn down.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32210">[ date ]</a>
              <a href="thread.html#32210">[ thread ]</a>
              <a href="subject.html#32210">[ subject ]</a>
              <a href="author.html#32210">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
