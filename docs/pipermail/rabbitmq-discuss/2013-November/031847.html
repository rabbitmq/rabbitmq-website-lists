<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to configure reply queue?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20configure%20reply%20queue%3F&In-Reply-To=%3CCAH75Yb7Ff40yF3ZQ0iu3ycUexH0xvhs5%3D-SZuH28nYhsnmMg1g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031799.html">
   <LINK REL="Next"  HREF="031849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to configure reply queue?</H1>
    <B>Rajasekhar P</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20configure%20reply%20queue%3F&In-Reply-To=%3CCAH75Yb7Ff40yF3ZQ0iu3ycUexH0xvhs5%3D-SZuH28nYhsnmMg1g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] How to configure reply queue?">sekhar434145 at gmail.com
       </A><BR>
    <I>Mon Nov 11 14:56:30 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031799.html">[rabbitmq-discuss] How to configure reply queue?
</A></li>
        <LI>Next message: <A HREF="031849.html">[rabbitmq-discuss] How to configure reply queue?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31847">[ date ]</a>
              <a href="thread.html#31847">[ thread ]</a>
              <a href="subject.html#31847">[ subject ]</a>
              <a href="author.html#31847">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you Russell for the response. Still am stuck with achieving above
program, could please tell where am failing while doing above code. Below
is the code at producer end.



CONFIGURATION -

public RabbitTemplate rabbitTemplate() {
RabbitTemplate template = new RabbitTemplate(connectionFactory());
template.setRoutingKey(this.queueName);
template.setQueue(this.queueName);
template.setMessageConverter(new JsonMessageConverter());
return template;
}

public ConnectionFactory connectionFactory() {
CachingConnectionFactory connectionFactory = new CachingConnectionFactory(
&quot;localhost&quot;);
connectionFactory.setUsername(&quot;guest&quot;);
connectionFactory.setPassword(&quot;guest&quot;);
return connectionFactory;
}


PRODUCER CODE -


String corrId = UUID.randomUUID().toString();
String replyQueueName = *channel*.queueDeclare().getQueue();
 MessageProperties prop = new MessageProperties();
prop.setCorrelationId(corrId.getBytes());
prop.setReplyTo(replyQueueName);
Message message = new Message(query.getBytes(), prop);
Message msg = rabbitTemplate.sendAndReceive(message);


Is this correct at producer end? Here how to Channel to retrieve
reqplyQueueName? Could you please correct me on this and please tell me how
to write consumer code to send the result(List of Objects) in JSON format
back to that particular request in replyqueue? Thanks in advance.


On Fri, Nov 8, 2013 at 7:20 PM, Gary Russell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">grussell at gopivotal.com</A>&gt; wrote:

&gt;<i> <A HREF="http://docs.spring.io/spring-amqp/reference/html/amqp.html#request-reply">http://docs.spring.io/spring-amqp/reference/html/amqp.html#request-reply</A>
</I>&gt;<i>
</I>&gt;<i> The simplest is to configure the RabbitTemplate to use a fixed reply
</I>&gt;<i> queue, with a reply listener, and use one of it's
</I>&gt;<i> convertSendAndReceive(...) (or sendAndReceive) methods; the template will
</I>&gt;<i> take care of the correlation.
</I>&gt;<i>
</I>&gt;<i> If you want to do it asynchronously and do your own correlation (get the
</I>&gt;<i> reply asynchronously on another thread) just use one of the send() methods
</I>&gt;<i> and wire up a listener container to get the results.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Nov 8, 2013 at 12:36 AM, Rajasekhar P &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">sekhar434145 at gmail.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Team,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We are trying to make asynchronous call in RabbitMQ using Spring AMQP,
</I>&gt;&gt;<i> could any one please tell me how to configure *replyqueue,
</I>&gt;&gt;<i> correlationId, (properties) *using spring amqp?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  String corrId = java.util.UUID.randomUUID().toString();
</I>&gt;&gt;<i>  BasicProperties props = new BasicProperties
</I>&gt;&gt;<i>                                 .Builder()
</I>&gt;&gt;<i>                                 .correlationId(corrId)
</I>&gt;&gt;<i>                                 .replyTo(replyQueueName)
</I>&gt;&gt;<i>                                 .build();
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  channel.basicPublish(&quot;&quot;, requestQueueName, props, message.getBytes());
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks in advance.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131111/42fb0ee1/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131111/42fb0ee1/attachment.htm</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031799.html">[rabbitmq-discuss] How to configure reply queue?
</A></li>
	<LI>Next message: <A HREF="031849.html">[rabbitmq-discuss] How to configure reply queue?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31847">[ date ]</a>
              <a href="thread.html#31847">[ thread ]</a>
              <a href="subject.html#31847">[ subject ]</a>
              <a href="author.html#31847">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
