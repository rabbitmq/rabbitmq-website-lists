<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] previous connection is NOT automatically closed if IP different
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20previous%20connection%20is%20NOT%20automatically%0A%20closed%20if%20IP%20different&In-Reply-To=%3CCAGDK9bmZU2yQoDBLap-oCzvUV38Q-%2BqixAGSjKoEs1onFtSFSQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031620.html">
   <LINK REL="Next"  HREF="031624.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] previous connection is NOT automatically closed if IP different</H1>
    <B>L H, Wong </B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20previous%20connection%20is%20NOT%20automatically%0A%20closed%20if%20IP%20different&In-Reply-To=%3CCAGDK9bmZU2yQoDBLap-oCzvUV38Q-%2BqixAGSjKoEs1onFtSFSQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] previous connection is NOT automatically closed if IP different">lhwong at gmail.com
       </A><BR>
    <I>Mon Nov  4 09:56:19 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="031620.html">[rabbitmq-discuss] previous connection is NOT automatically	closed if IP different
</A></li>
        <LI>Next message: <A HREF="031624.html">[rabbitmq-discuss] previous connection is NOT automatically	closed if IP different
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31622">[ date ]</a>
              <a href="thread.html#31622">[ thread ]</a>
              <a href="subject.html#31622">[ subject ]</a>
              <a href="author.html#31622">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I believe the port number shown on rabbitmq console (see below) is the
client port. This shows different IP and port is being used by the new
connection.

Consumers
Channel     Consumer tag     Ack required     Exclusive
210.19.225.88:36920 (1)     amq.ctag-ma8QOXnZ_UAK-
R7wddQGXA     &#9679;     &#9675;
210.19.225.3:60659 (1)     amq.ctag-igoa2WysTs79WAk969UFJg     &#9679;     &#9675;


I manage to reconnect from the same device on a different IP by
disconnecting from a Wifi router and connecting to another Wifi router. I
think this is a very common scenario including switching from 3G network to
Wifi network.

--Nick



On Mon, Nov 4, 2013 at 4:11 PM, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt;wrote:

&gt;<i> On nov 4, 2013, at 5:24 AM, L H, Wong &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lhwong at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I am wondering why if IP for first and second connections are the same
</I>&gt;<i> (in the scenarios in which the connection lost and resumed almost
</I>&gt;<i> immediately via same network) the first connection gets closed almost
</I>&gt;<i> immediately after the second connection was established.
</I>&gt;<i>
</I>&gt;<i> I don&#8217;t have an immediate answer but IP connections are not identified by
</I>&gt;<i> IP&#8217;s. They are
</I>&gt;<i> identified by a tuple of {protocol, client IP, client port, server IP,
</I>&gt;<i> server port}.
</I>&gt;<i>
</I>&gt;<i> Unless Android tries to be smart and reuse ports in their TCP/IP stack
</I>&gt;<i> implementation,
</I>&gt;<i> client ports should be ephemeral (randomly taken from a pool of tens of
</I>&gt;<i> thousands
</I>&gt;<i> available ports).
</I>&gt;<i>
</I>&gt;<i> May I ask how you manage to reconnect from the same device on a different
</I>&gt;<i> IP?
</I>&gt;<i> --
</I>&gt;<i> MK
</I>&gt;<i>
</I>&gt;<i> Software Engineer, Pivotal/RabbitMQ
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131104/c3b791be/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20131104/c3b791be/attachment.htm</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031620.html">[rabbitmq-discuss] previous connection is NOT automatically	closed if IP different
</A></li>
	<LI>Next message: <A HREF="031624.html">[rabbitmq-discuss] previous connection is NOT automatically	closed if IP different
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31622">[ date ]</a>
              <a href="thread.html#31622">[ thread ]</a>
              <a href="subject.html#31622">[ subject ]</a>
              <a href="author.html#31622">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
