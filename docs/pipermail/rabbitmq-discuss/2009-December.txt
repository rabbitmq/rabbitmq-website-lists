From matthias at lshift.net  Tue Dec  1 07:38:39 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Tue, 01 Dec 2009 07:38:39 +0000
Subject: [rabbitmq-discuss] Channel.Close w/ subscribed consumers
In-Reply-To: <4B1433E2.702@lshift.net>
References: <e1c05edd0911281949l1dc5af48qe8e992ade8942802@mail.gmail.com>	<4B13B9EE.7030309@lshift.net>	<e1c05edd0911301143o76830c2i5bf083d2b66ce803@mail.gmail.com>
	<4B1433E2.702@lshift.net>
Message-ID: <4B14C7FF.3090607@lshift.net>

Aman,

Matthias Radestock wrote:
> I'm not sure when I will find time to look into this.

Have done so now. I cannot reproduce the problem.

With two terminals, one running 'ruby subscriber.rb' and the other 
running 'ruby publisher.rb', I can ^C the subscriber and the program 
terminates almost instantly.

I have tried this with both ruby 1.8 and 1.9.1, and versions 0.6.5 of 
the amqp gem and 0-12.10 of em, all running against the head of 
'default' of the rabbitmq-server.


Regards,

Matthias.



From rabbitmq at tmm1.net  Tue Dec  1 09:04:08 2009
From: rabbitmq at tmm1.net (Aman Gupta)
Date: Tue, 1 Dec 2009 04:04:08 -0500
Subject: [rabbitmq-discuss] Channel.Close w/ subscribed consumers
In-Reply-To: <4B14C7FF.3090607@lshift.net>
References: <e1c05edd0911281949l1dc5af48qe8e992ade8942802@mail.gmail.com> 
	<4B13B9EE.7030309@lshift.net>
	<e1c05edd0911301143o76830c2i5bf083d2b66ce803@mail.gmail.com> 
	<4B1433E2.702@lshift.net> <4B14C7FF.3090607@lshift.net>
Message-ID: <e1c05edd0912010104ge358b98kaa84a9d16ccee8c3@mail.gmail.com>

On Tue, Dec 1, 2009 at 2:38 AM, Matthias Radestock <matthias at lshift.net> wrote:
> Aman,
>
> Matthias Radestock wrote:
>>
>> I'm not sure when I will find time to look into this.
>
> Have done so now. I cannot reproduce the problem.
>
> With two terminals, one running 'ruby subscriber.rb' and the other running
> 'ruby publisher.rb', I can ^C the subscriber and the program terminates
> almost instantly.
>
> I have tried this with both ruby 1.8 and 1.9.1, and versions 0.6.5 of the
> amqp gem and 0-12.10 of em, all running against the head of 'default' of the
> rabbitmq-server.

Thanks for taking the time to test this. I tried on linux with R12 and
R13 and you're right, it stops almost instantaneously. On my mac, it
takes a bit longer but still stops within 5-10 seconds.

The original bug report came with the 'sleep 1' which was commented
out in my version of subscriber.rb. The sleep exposes the issue, but
some digging shows the cause to be EventMachine and not rabbitmq.

The problem is that EM reads up to 16k from the socket during each
reactor tick. This can account for several hundred messages, each of
which is passed to the subscribe block. If each message causes a
sleep(1), the reactor is essentially blocked for several seconds. Once
all 16k worth of messages are processed, the reactor finally has a
chance to flush its outbound buffers, which contain the Channel.Close
command.

The solution to this problem is to set a prefetch window on the
channel, such that the reactor is not flooded with incoming messages.

  Aman

>
>
> Regards,
>
> Matthias.
>



From majek04 at gmail.com  Tue Dec  1 09:35:15 2009
From: majek04 at gmail.com (majek04)
Date: Tue, 1 Dec 2009 09:35:15 +0000
Subject: [rabbitmq-discuss] Bleeding edge persister and Erlang R13B03
In-Reply-To: <20091130174247.GK22260@mrnibble.lshift.net>
References: <20091130174247.GK22260@mrnibble.lshift.net>
Message-ID: <3bb0d9710912010135t206cf4b4y8a859d0dfd92df77@mail.gmail.com>

On Mon, Nov 30, 2009 at 17:42, Matthew Sackman <matthew at lshift.net> wrote:
> The reason is that in R13B02 and earlier, the garbage collector doesn't
> seem to do much. This has a very bad effect on the new persister. R13B03
> behaves quite wonderfully in comparison.

>From R13B03 release notes [1]:

   OTP-8202  A new garbage collecting strategy for binaries which is more
	      aggressive than the previous implementation. Binaries now has
	      a virtual binary heap tied to each process. When binaries are
	      created or received to a process it will check if the heap
	      limit has been reached and if a reclaim should be done. This
	      imitates the behavior of ordinary Erlang terms. The virtual
	      heaps are grown and shrunk like ordinary heaps. This will
	      lessen the memory footprint of binaries in a system.


[1] http://www.erlang.org/download/otp_src_R13B03.readme



From m.nacos at gmail.com  Tue Dec  1 09:42:33 2009
From: m.nacos at gmail.com (Michael Nacos)
Date: Tue, 1 Dec 2009 09:42:33 +0000
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <4B143B24.4020600@lshift.net>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com>
	<4B143B24.4020600@lshift.net>
Message-ID: <407fa4640912010142n54bcbbb7l413148848b85e5c2@mail.gmail.com>

is this read-only?
<feature-request> it'd be nice if it supported writing, too (changing
bindings, purging queues etc.) </feature-request>

:-)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/9e175366/attachment.htm 

From matthias at lshift.net  Tue Dec  1 10:05:51 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Tue, 01 Dec 2009 10:05:51 +0000
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <407fa4640912010142n54bcbbb7l413148848b85e5c2@mail.gmail.com>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com>	<4B143B24.4020600@lshift.net>
	<407fa4640912010142n54bcbbb7l413148848b85e5c2@mail.gmail.com>
Message-ID: <4B14EA7F.5080507@lshift.net>

Michael,

Michael Nacos wrote:
> is this read-only?
> <feature-request> it'd be nice if it supported writing, too (changing 
> bindings, purging queues etc.) </feature-request>

How would you envisage "purging queues" to work over SNMP? Setting the 
queue's message count to zero? Yuck.


Matthias.



From lars at worldlingo.com  Tue Dec  1 10:41:38 2009
From: lars at worldlingo.com (Lars George)
Date: Tue, 01 Dec 2009 11:41:38 +0100
Subject: [rabbitmq-discuss] Queue Status
Message-ID: <4B14F2E2.2020907@worldlingo.com>

Hi,

Is there a way to query a queues status, as in queued elements, how many 
not ack'ed yet etc.?

Lars



From matthew at lshift.net  Tue Dec  1 10:49:50 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Tue, 1 Dec 2009 10:49:50 +0000
Subject: [rabbitmq-discuss] Queue Status
In-Reply-To: <4B14F2E2.2020907@worldlingo.com>
References: <4B14F2E2.2020907@worldlingo.com>
Message-ID: <20091201104950.GA15232@mrnibble.lshift.net>

On Tue, Dec 01, 2009 at 11:41:38AM +0100, Lars George wrote:
> Is there a way to query a queues status, as in queued elements, how many 
> not ack'ed yet etc.?

Not via the protocol - all you can get there is the number of messages
ready in a queue through eg queue.declare. However, if you use the
rabbitmqctl command, you can get messages_ready and
messages_unacknowledged, and other goodies too.

Matthew



From lars at worldlingo.com  Tue Dec  1 12:13:19 2009
From: lars at worldlingo.com (Lars George)
Date: Tue, 01 Dec 2009 13:13:19 +0100
Subject: [rabbitmq-discuss] Queue Status
In-Reply-To: <20091201104950.GA15232@mrnibble.lshift.net>
References: <4B14F2E2.2020907@worldlingo.com>
	<20091201104950.GA15232@mrnibble.lshift.net>
Message-ID: <4B15085F.7040801@worldlingo.com>

Hi Matthew,

Bummer. Yes, I meant using the API. Is there a reason for not making
this info available? It would help to make decisions within the app
based on if a queue is considered full (more than n entries) etc.

The SNMP interface is very nice and a good start, but that is for
Nagios/Cacti to check really. Otherwise I would have to implement an
SNMP get into the app to get the meta data.

Just wondering.

Lars

Matthew Sackman schrieb:
> On Tue, Dec 01, 2009 at 11:41:38AM +0100, Lars George wrote:
>   
>> Is there a way to query a queues status, as in queued elements, how many 
>> not ack'ed yet etc.?
>>     
>
> Not via the protocol - all you can get there is the number of messages
> ready in a queue through eg queue.declare. However, if you use the
> rabbitmqctl command, you can get messages_ready and
> messages_unacknowledged, and other goodies too.
>
> Matthew
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>   




From gmr at myyearbook.com  Tue Dec  1 15:58:54 2009
From: gmr at myyearbook.com (Gavin M. Roy)
Date: Tue, 1 Dec 2009 10:58:54 -0500
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <407fa4640912010142n54bcbbb7l413148848b85e5c2@mail.gmail.com>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com> 
	<4B143B24.4020600@lshift.net>
	<407fa4640912010142n54bcbbb7l413148848b85e5c2@mail.gmail.com>
Message-ID: <af1bce590912010758v5db3457ds946fd62d95f8e8ce@mail.gmail.com>

While not directly what you're asking for, we released this little CLI app
for managing that stuff in Rabbit:

http://github.com/bkjones/bunny

Regards,

Gavin

On Tue, Dec 1, 2009 at 4:42 AM, Michael Nacos <m.nacos at gmail.com> wrote:

> is this read-only?
> <feature-request> it'd be nice if it supported writing, too (changing
> bindings, purging queues etc.) </feature-request>
>
> :-)
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/e03e3c9e/attachment.htm 

From scott.brooks at epicadvertising.com  Tue Dec  1 17:06:04 2009
From: scott.brooks at epicadvertising.com (Scott Brooks)
Date: Tue, 1 Dec 2009 11:06:04 -0600
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <4B143B24.4020600@lshift.net>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com>
	<4B143B24.4020600@lshift.net>
Message-ID: <BF7C8A76-0171-45F6-9B19-8FD49760270A@epicadvertising.com>

Here is the mib.  I certainly don't claim to be an expert mib designer so there is probably room for improvement.

It passes an erlc, smilint, and works with net-snmp, but beyond that I guarantee nothing.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: RABBITMQ-MIB.mib
Type: application/octet-stream
Size: 5725 bytes
Desc: RABBITMQ-MIB.mib
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/3461b78d/attachment.obj 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ATT00001.c
Url: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/3461b78d/attachment.txt 

From alexis.richardson at gmail.com  Tue Dec  1 19:24:22 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 1 Dec 2009 11:24:22 -0800
Subject: [rabbitmq-discuss] Queue Status
In-Reply-To: <4B15085F.7040801@worldlingo.com>
References: <4B14F2E2.2020907@worldlingo.com>
	<20091201104950.GA15232@mrnibble.lshift.net>
	<4B15085F.7040801@worldlingo.com>
Message-ID: <167204d20912011124t58eb1e00v973b0c122f829e71@mail.gmail.com>

Lars,

Is there any reason why using rabbitmqctl won't give you what you
want?  Also, have you looked at Alice and Wonderland which wrap
rabbitmqctl in HTTP..?

Putting all this stuff into the protocol itself will make it more
complex.  Though, it may be necessary...

alexis


On Tue, Dec 1, 2009 at 4:13 AM, Lars George <lars at worldlingo.com> wrote:
> Hi Matthew,
>
> Bummer. Yes, I meant using the API. Is there a reason for not making
> this info available? It would help to make decisions within the app
> based on if a queue is considered full (more than n entries) etc.
>
> The SNMP interface is very nice and a good start, but that is for
> Nagios/Cacti to check really. Otherwise I would have to implement an
> SNMP get into the app to get the meta data.
>
> Just wondering.
>
> Lars
>
> Matthew Sackman schrieb:
>> On Tue, Dec 01, 2009 at 11:41:38AM +0100, Lars George wrote:
>>
>>> Is there a way to query a queues status, as in queued elements, how many
>>> not ack'ed yet etc.?
>>>
>>
>> Not via the protocol - all you can get there is the number of messages
>> ready in a queue through eg queue.declare. However, if you use the
>> rabbitmqctl command, you can get messages_ready and
>> messages_unacknowledged, and other goodies too.
>>
>> Matthew
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>
>>
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From gmr at myyearbook.com  Tue Dec  1 19:30:47 2009
From: gmr at myyearbook.com (Gavin M. Roy)
Date: Tue, 1 Dec 2009 14:30:47 -0500
Subject: [rabbitmq-discuss] Queue Status
In-Reply-To: <167204d20912011124t58eb1e00v973b0c122f829e71@mail.gmail.com>
References: <4B14F2E2.2020907@worldlingo.com>
	<20091201104950.GA15232@mrnibble.lshift.net> 
	<4B15085F.7040801@worldlingo.com>
	<167204d20912011124t58eb1e00v973b0c122f829e71@mail.gmail.com>
Message-ID: <af1bce590912011130x7af8d45ag75556b1ed8a3960e@mail.gmail.com>

I thought Alice plugged into the erlang process for rabbitmq, and did not
wrap rabbitmqctl.

On Tue, Dec 1, 2009 at 2:24 PM, Alexis Richardson <
alexis.richardson at gmail.com> wrote:

> Lars,
>
> Is there any reason why using rabbitmqctl won't give you what you
> want?  Also, have you looked at Alice and Wonderland which wrap
> rabbitmqctl in HTTP..?
>
> Putting all this stuff into the protocol itself will make it more
> complex.  Though, it may be necessary...
>
> alexis
>
>
> On Tue, Dec 1, 2009 at 4:13 AM, Lars George <lars at worldlingo.com> wrote:
> > Hi Matthew,
> >
> > Bummer. Yes, I meant using the API. Is there a reason for not making
> > this info available? It would help to make decisions within the app
> > based on if a queue is considered full (more than n entries) etc.
> >
> > The SNMP interface is very nice and a good start, but that is for
> > Nagios/Cacti to check really. Otherwise I would have to implement an
> > SNMP get into the app to get the meta data.
> >
> > Just wondering.
> >
> > Lars
> >
> > Matthew Sackman schrieb:
> >> On Tue, Dec 01, 2009 at 11:41:38AM +0100, Lars George wrote:
> >>
> >>> Is there a way to query a queues status, as in queued elements, how
> many
> >>> not ack'ed yet etc.?
> >>>
> >>
> >> Not via the protocol - all you can get there is the number of messages
> >> ready in a queue through eg queue.declare. However, if you use the
> >> rabbitmqctl command, you can get messages_ready and
> >> messages_unacknowledged, and other goodies too.
> >>
> >> Matthew
> >>
> >> _______________________________________________
> >> rabbitmq-discuss mailing list
> >> rabbitmq-discuss at lists.rabbitmq.com
> >> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >>
> >>
> >
> >
> > _______________________________________________
> > rabbitmq-discuss mailing list
> > rabbitmq-discuss at lists.rabbitmq.com
> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/8f3423a2/attachment.htm 

From alexis.richardson at gmail.com  Tue Dec  1 19:32:09 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 1 Dec 2009 11:32:09 -0800
Subject: [rabbitmq-discuss] Queue Status
In-Reply-To: <af1bce590912011130x7af8d45ag75556b1ed8a3960e@mail.gmail.com>
References: <4B14F2E2.2020907@worldlingo.com>
	<20091201104950.GA15232@mrnibble.lshift.net>
	<4B15085F.7040801@worldlingo.com>
	<167204d20912011124t58eb1e00v973b0c122f829e71@mail.gmail.com>
	<af1bce590912011130x7af8d45ag75556b1ed8a3960e@mail.gmail.com>
Message-ID: <167204d20912011132y17e1211dref0502e115a43289@mail.gmail.com>

It may do that, I am not sure.  But it does expose similar functions afaict.


On Tue, Dec 1, 2009 at 11:30 AM, Gavin M. Roy <gmr at myyearbook.com> wrote:
> I thought Alice plugged into the erlang process for rabbitmq, and did not
> wrap rabbitmqctl.
>
> On Tue, Dec 1, 2009 at 2:24 PM, Alexis Richardson
> <alexis.richardson at gmail.com> wrote:
>>
>> Lars,
>>
>> Is there any reason why using rabbitmqctl won't give you what you
>> want? ?Also, have you looked at Alice and Wonderland which wrap
>> rabbitmqctl in HTTP..?
>>
>> Putting all this stuff into the protocol itself will make it more
>> complex. ?Though, it may be necessary...
>>
>> alexis
>>
>>
>> On Tue, Dec 1, 2009 at 4:13 AM, Lars George <lars at worldlingo.com> wrote:
>> > Hi Matthew,
>> >
>> > Bummer. Yes, I meant using the API. Is there a reason for not making
>> > this info available? It would help to make decisions within the app
>> > based on if a queue is considered full (more than n entries) etc.
>> >
>> > The SNMP interface is very nice and a good start, but that is for
>> > Nagios/Cacti to check really. Otherwise I would have to implement an
>> > SNMP get into the app to get the meta data.
>> >
>> > Just wondering.
>> >
>> > Lars
>> >
>> > Matthew Sackman schrieb:
>> >> On Tue, Dec 01, 2009 at 11:41:38AM +0100, Lars George wrote:
>> >>
>> >>> Is there a way to query a queues status, as in queued elements, how
>> >>> many
>> >>> not ack'ed yet etc.?
>> >>>
>> >>
>> >> Not via the protocol - all you can get there is the number of messages
>> >> ready in a queue through eg queue.declare. However, if you use the
>> >> rabbitmqctl command, you can get messages_ready and
>> >> messages_unacknowledged, and other goodies too.
>> >>
>> >> Matthew
>> >>
>> >> _______________________________________________
>> >> rabbitmq-discuss mailing list
>> >> rabbitmq-discuss at lists.rabbitmq.com
>> >> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >>
>> >>
>> >
>> >
>> > _______________________________________________
>> > rabbitmq-discuss mailing list
>> > rabbitmq-discuss at lists.rabbitmq.com
>> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From gmr at myyearbook.com  Tue Dec  1 19:36:23 2009
From: gmr at myyearbook.com (Gavin M. Roy)
Date: Tue, 1 Dec 2009 14:36:23 -0500
Subject: [rabbitmq-discuss] Queue Status
In-Reply-To: <167204d20912011132y17e1211dref0502e115a43289@mail.gmail.com>
References: <4B14F2E2.2020907@worldlingo.com>
	<20091201104950.GA15232@mrnibble.lshift.net> 
	<4B15085F.7040801@worldlingo.com>
	<167204d20912011124t58eb1e00v973b0c122f829e71@mail.gmail.com> 
	<af1bce590912011130x7af8d45ag75556b1ed8a3960e@mail.gmail.com> 
	<167204d20912011132y17e1211dref0502e115a43289@mail.gmail.com>
Message-ID: <af1bce590912011136n3c9aabp3f33e830d21bf05@mail.gmail.com>

On Tue, Dec 1, 2009 at 2:32 PM, Alexis Richardson <
alexis.richardson at gmail.com> wrote:

> It may do that, I am not sure.  But it does expose similar functions
> afaict.


It does expose all the same data.  I checked, it works via rpc, not by
shelling out to the rabbitmq command.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/4699816a/attachment.htm 

From gojko-yahoolist at gojko.com  Tue Dec  1 21:49:27 2009
From: gojko-yahoolist at gojko.com (Gojko Adzic)
Date: Tue, 01 Dec 2009 21:49:27 +0000
Subject: [rabbitmq-discuss] intermittent disconnects under load
In-Reply-To: <4B13AFDE.3060401@lshift.net>
References: <4B0F249D.8050903@gojko.com> <4B13AFDE.3060401@lshift.net>
Message-ID: <4B158F67.7030301@gojko.com>

 > Is the above reproducible, and if so, can you send us the code &
 > instructions?

It is reproducible - not every time but under stress test scripts that 
we set up, it happened three out of five times after a few minutes of 
test under load. I'll get someone to clean up and send the scripts.

gojko



From m.nacos at gmail.com  Tue Dec  1 22:57:51 2009
From: m.nacos at gmail.com (Michael Nacos)
Date: Tue, 1 Dec 2009 22:57:51 +0000
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <4B14EA7F.5080507@lshift.net>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com>
	<4B143B24.4020600@lshift.net>
	<407fa4640912010142n54bcbbb7l413148848b85e5c2@mail.gmail.com>
	<4B14EA7F.5080507@lshift.net>
Message-ID: <407fa4640912011457r3d8d91b2n19356c4337ad95c7@mail.gmail.com>

@Matthias

I admit setting the queue count to zero is a bit of a yucky way of purging a
queue. :-)
Serves me right for being a smart-*rse

however...

We already monitor our tiny rabbitmq infrastructure through nagios. Nagios
allows custom commands to be run when certain thresholds are reached, being
able to do that directly via SNMP is probably a cleaner way than
writing/debugging/deploying and calling custom scripts. Purging queues is
probably as inelegant as it gets, I don't think the same applies to altering
queue/exchange types, bindings and the like. And such functionality paves
the way for the official gumstix-sized rabbit appliance, look ma no hands or
web interface!

@Gavin

interesting link, it'll come in handy for future experiments
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091201/ca577359/attachment.htm 

From mabrek at gmail.com  Wed Dec  2 13:29:52 2009
From: mabrek at gmail.com (mabrek)
Date: Wed, 2 Dec 2009 16:29:52 +0300
Subject: [rabbitmq-discuss] rabbitmq-status plugin sources?
Message-ID: <c26271fb0912020529p25b5429bjf52ef1bdf2018275@mail.gmail.com>

Hello,

There is wonderful rabbitmq-status plugin
(http://www.lshift.net/blog/2009/11/30/introducing-rabbitmq-status-plugin).
Blog post says that it works with 1.7.0 and default branch but I need
to get it working with new persister branch (bug21673).
I'm ready to make appropriate modifications by myself but I can't find
sources of the plugin.

Another question: is there any way to embed plugins into rabbitmq
debian package to make single .deb to deploy?

Regards,
Anton Lebedevich.



From majek04 at gmail.com  Wed Dec  2 13:44:56 2009
From: majek04 at gmail.com (majek04)
Date: Wed, 2 Dec 2009 13:44:56 +0000
Subject: [rabbitmq-discuss] rabbitmq-status plugin sources?
In-Reply-To: <c26271fb0912020529p25b5429bjf52ef1bdf2018275@mail.gmail.com>
References: <c26271fb0912020529p25b5429bjf52ef1bdf2018275@mail.gmail.com>
Message-ID: <3bb0d9710912020544w541fa21end8902d34d00efde6@mail.gmail.com>

On Wed, Dec 2, 2009 at 13:29, mabrek <mabrek at gmail.com> wrote:
> There is wonderful rabbitmq-status plugin
> (http://www.lshift.net/blog/2009/11/30/introducing-rabbitmq-status-plugin).
> Blog post says that it works with 1.7.0 and default branch but I need
> to get it working with new persister branch (bug21673).
> I'm ready to make appropriate modifications by myself but I can't find
> sources of the plugin.

I haven't shared the sources yet, but I will do it shortly.

Rabbitmq-status plugin doesn't use any complicated internal apis.
The binary version from the blog post should just work with this branch.

> Another question: is there any way to embed plugins into rabbitmq
> debian package to make single .deb to deploy?

Yes, there is a way but we haven't done it yet. We actually intend
do release plugins as .debs, but it requires a lot of work and
is not our priority at the moment.


Cheers!
  Marek Majkowski



From matthew at lshift.net  Wed Dec  2 18:00:34 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Wed, 2 Dec 2009 18:00:34 +0000
Subject: [rabbitmq-discuss] Bleeding edge persister and Erlang R13B03
In-Reply-To: <001401ca736f$df395100$9dabf300$@com>
References: <20091130174247.GK22260@mrnibble.lshift.net>
	<009d01ca7205$03dfc500$0b9f4f00$@com>
	<20091130220830.GA1905@wellquite.org>
	<001401ca736f$df395100$9dabf300$@com>
Message-ID: <20091202180034.GE15232@mrnibble.lshift.net>

Hi Kalpesh,

On Wed, Dec 02, 2009 at 10:52:45AM -0600, Kalpesh wrote:
> Pardon my ignorance but is there a link to a binary available somewhere or I
> have to get it from mercurial on tag bug21673. I have never built rabbit
> from source, a link to build from source will definitely help me.

We only make binaries for stable releases. Experimental development
branches have to be compiled by hand. If you're not comfortable doing
this then I would suggest you wait for a stable release as you may well
otherwise end up wasting your own time testing unstable and likely buggy
development branches.

To compile from source, please see our guide at:
http://www.rabbitmq.com/build-server.html

Matthew



From kpatel at egnyte.com  Wed Dec  2 21:25:00 2009
From: kpatel at egnyte.com (Kalpesh)
Date: Wed, 2 Dec 2009 15:25:00 -0600
Subject: [rabbitmq-discuss] Bleeding edge persister and Erlang R13B03
In-Reply-To: <20091202180034.GE15232@mrnibble.lshift.net>
References: <20091130174247.GK22260@mrnibble.lshift.net>
	<009d01ca7205$03dfc500$0b9f4f00$@com>
	<20091130220830.GA1905@wellquite.org>
	<001401ca736f$df395100$9dabf300$@com>
	<20091202180034.GE15232@mrnibble.lshift.net>
Message-ID: <001201ca7395$e7d137d0$b773a770$@com>

Thanks Matthew, I will try to build from source. This is exactly what I
needed.

------------------------------------------------
Kalpesh Patel 
Egnyte - your On Demand File Server
Big Technology; Small Price
sign up at http://www.egnyte.com


-----Original Message-----
From: Matthew Sackman [mailto:matthew at lshift.net] 
Sent: Wednesday, December 02, 2009 12:01 PM
To: Kalpesh
Cc: rabbitmq-discuss at lists.rabbitmq.com
Subject: Re: [rabbitmq-discuss] Bleeding edge persister and Erlang R13B03

Hi Kalpesh,

On Wed, Dec 02, 2009 at 10:52:45AM -0600, Kalpesh wrote:
> Pardon my ignorance but is there a link to a binary available somewhere or
I
> have to get it from mercurial on tag bug21673. I have never built rabbit
> from source, a link to build from source will definitely help me.

We only make binaries for stable releases. Experimental development
branches have to be compiled by hand. If you're not comfortable doing
this then I would suggest you wait for a stable release as you may well
otherwise end up wasting your own time testing unstable and likely buggy
development branches.

To compile from source, please see our guide at:
http://www.rabbitmq.com/build-server.html

Matthew





From diclophis at gmail.com  Wed Dec  2 23:17:15 2009
From: diclophis at gmail.com (Jon Bardin)
Date: Wed, 2 Dec 2009 15:17:15 -0800
Subject: [rabbitmq-discuss] Stalled SSL Upgrading
Message-ID: <c1d41d540912021517j6f05546chfde909d27c1f65@mail.gmail.com>

Has anyone experienced SSL upgrading stalling?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091202/53222484/attachment.htm 

From theczintheroc2007 at gmail.com  Wed Dec  2 23:44:08 2009
From: theczintheroc2007 at gmail.com (Colin Z)
Date: Wed, 2 Dec 2009 18:44:08 -0500
Subject: [rabbitmq-discuss] Rabbit Erlang Client on Windows
Message-ID: <ce47f6b80912021544q19fa6b24xce7ac640353af6f0@mail.gmail.com>

Hey guys, I'm trying to upgrade all my Erlang and Rabbit components and am
completely baffled at the complexity of changes since the last time I
upgraded. Previously, everything seemed to "just work."

Trying to target:
 Erlang 13B03
 RabbitMQ server 1.7.0
 Latest version of RabbitMQ Erlang client

I cannot get RabbitMQ to build from source, so I defaulted to using the
pre-built version:
http://www.rabbitmq.com/releases/rabbitmq-server/v1.7.0/rabbitmq-server-windows-1.7.0.zip


The client does not seem to come in a pre-built version, and I cannot get it
to build from source either. It seems to want to build RabbitMQ itself and
the pre-built version of MQ doesn't come with a Makefile, unfortunately.

I have Python30 installed, if that matters.

Theres seems to be an issue auto-generating some of the AMQP spec stuff.

This is with RabbitMQ pre-built and in lib/rabbitmq-server:

Admin at myhost /cygdrive/f/Program
Files/erl5.7.4/lib/rabbitmq-erlang-client-default
$ make
sed -e 's:%%VSN%%:0.0.0:g' < rabbit_common.app.in > rabbit_common.app
f:/Program Files/GnuWin32/bin/make -C ../rabbitmq-server
make[1]: Entering directory `f:/Program Files/erl5.7.4/lib/rabbitmq-server'
make[1]: *** No targets specified and no makefile found.  Stop.
make[1]: Leaving directory `f:/Program Files/erl5.7.4/lib/rabbitmq-server'
make: *** [dist/rabbit_common.ez] Error 2

If I instead grab Rabbit from Mercurial:

hg clone http://hg.rabbitmq.com/rabbitmq-codegen

hg clone http://hg.rabbitmq.com/rabbitmq-server

cd rabbitmq-server

make

I get this:

Admin at myhost /cygdrive/f/Program
Files/erl5.7.4/lib/rabbitmq-erlang-client-default
$ make
f:/Program Files/GnuWin32/bin/make -C ../rabbitmq-server
make[1]: Entering directory `f:/Program Files/erl5.7.4/lib/rabbitmq-server'
python codegen.py body   ../rabbitmq-codegen//amqp-0.8.json
src/rabbit_framing.erl
  File "codegen.py", line 60
    else: raise 'Non-empty table defaults not supported', d
                                                        ^
SyntaxError: invalid syntax
make[1]: *** [src/rabbit_framing.erl] Error 1
make[1]: Leaving directory `f:/Program Files/erl5.7.4/lib/rabbitmq-server'
make: *** [dist/rabbit_common.ez] Error 2

I get the same codegen error if I try to just build RabbitMQ directly, too.

Any ideas?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091202/924fc3f2/attachment.htm 

From essiene at gmail.com  Thu Dec  3 10:36:17 2009
From: essiene at gmail.com (Essien Essien)
Date: Thu, 3 Dec 2009 11:36:17 +0100
Subject: [rabbitmq-discuss] Stalled SSL Upgrading
In-Reply-To: <c1d41d540912021517j6f05546chfde909d27c1f65@mail.gmail.com>
References: <c1d41d540912021517j6f05546chfde909d27c1f65@mail.gmail.com>
Message-ID: <88b82c90912030236p5742380do3f3c1d87fc2b0a57@mail.gmail.com>

Hi Jon,

On Thu, Dec 3, 2009 at 12:17 AM, Jon Bardin <diclophis at gmail.com> wrote:
> Has anyone experienced SSL upgrading stalling?
>

Stalling in what sense? Does it give you any other error messages on
the server side? Does the client report any error messages?

cheers,
Essien



From matthew at lshift.net  Thu Dec  3 11:43:51 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Thu, 3 Dec 2009 11:43:51 +0000
Subject: [rabbitmq-discuss] Stalled SSL Upgrading
In-Reply-To: <c1d41d540912021517j6f05546chfde909d27c1f65@mail.gmail.com>
References: <c1d41d540912021517j6f05546chfde909d27c1f65@mail.gmail.com>
Message-ID: <20091203114351.GA17349@mrnibble.lshift.net>

On Wed, Dec 02, 2009 at 03:17:15PM -0800, Jon Bardin wrote:
> Has anyone experienced SSL upgrading stalling?

By the way, R13B03 fixes a few more SSL bugs. If you're having issues
with SSL, we would strongly suggest using at least R13B02 and probably
R13B03 - getting SSL to work under R12 or earlier is rather akin to
black magic.

Matthew



From sh at defuze.org  Thu Dec  3 08:21:29 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Thu, 3 Dec 2009 09:21:29 +0100 (CET)
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
Message-ID: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>

Hi there,

I've been using for the past few months the erlang client lib but I hadn't
updated for a while and it seems things have quite changed since
September. For the best I'm sure.

However, I find a little tedious to work with the library as it critically
lack any sort of documentation.

For instance the test suite seems to suggest one should be using
amqp_connection:start(Params) to create a new connection but, unless I'm
mistaken, that function doesn't exist and you must use directly either
start_network or start_direct.

Also, it's unclear whether or not you can safely reuse Connections across
several erlang nodes concurrently or if there are some issues in doing so.
Can I use one connection and cretae as many channels as I want? Should
channel be on a per erlang process basis?

Another blurry point is whether or not one can use amqp_channel_util
functions or if they are rather internals to the lib. If the former, how
to use them the best?

My use case is probably common:

I have a gen_server where I direct all my AMQP calls (publish, etc.) and
within that gen_server I create a pool of connections. Should this pool
reside in its own gen_server so that each connection belongs to one single
supervised erlang process? Currently I keep the pool within the
gen_server's state. But this means I'm concurrently using the same
connection for different channels. Is that safe?

To be honest, I would be more than happy if the lib could come with its
own pool so that I'm sure I'm not doing something stupid.

In any case, a bit more info about dos and donts would be quite
appreciated :)

Cheers,
- Sylvain
-- 
Sylvain Hellegouarch
http://www.defuze.org



From vlad at lshift.net  Thu Dec  3 17:24:10 2009
From: vlad at lshift.net (Vlad Alexandru Ionescu)
Date: Thu, 03 Dec 2009 17:24:10 +0000
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
Message-ID: <4B17F43A.4050603@lshift.net>

Hi Sylvain,


I will try to answer your questions.

> it seems things have quite changed since
> September
As far as I know, apart from replacing the amqp_connection:start with 
start_direct and start_network and the new approach with #amqp_params{}, 
the API remained the same.
Yes, there has been a lot of refactoring behind the scenes, but we 
didn't touch the API.

> For instance the test suite seems to suggest one should be using
> amqp_connection:start(Params) to create a new connection but, unless I'm
> mistaken, that function doesn't exist and you must use directly either
> start_network or start_direct.
The right way of starting a connection is using either of the functions 
start_network or start_direct in amqp_connection. The start function has 
been removed quite some time ago.

> Also, it's unclear whether or not you can safely reuse Connections across
> several erlang nodes concurrently or if there are some issues in doing so.
> Can I use one connection and cretae as many channels as I want? Should
> channel be on a per erlang process basis?
As far as I am aware both the connection and the channel processes have 
been designed to be used from multiple processes. They are in fact 
gen_server's.
Not only that creating a single connection with as many channels as you 
like is possible, but it is also the recommended style. The maximum 
number of channels is 65535 I think, unless it is specified otherwise by 
the server (RabbitMQ server doesn't specify another limit). That should 
probably be more than enough.

> Another blurry point is whether or not one can use amqp_channel_util
> functions or if they are rather internals to the lib. If the former, how
> to use them the best?
amqp_channel_util is strictly for internal use. You shouldn't use 
functions in it.

The new modules amqp_network_connection and amqp_direct_connection are 
also for internal use. User apps should use amqp_connection instead.

> I have a gen_server where I direct all my AMQP calls (publish, etc.) and
> within that gen_server I create a pool of connections. Should this pool
> reside in its own gen_server so that each connection belongs to one single
> supervised erlang process? Currently I keep the pool within the
> gen_server's state. But this means I'm concurrently using the same
> connection for different channels. Is that safe?
As answered above, you don't need to worry about using the connection 
from different processes. The connection process itself is a gen_server, 
and what you get with amqp_connection:start_network() is just the pid of 
the spawned connection process, that you can use from anywhere (any 
process) in your application.
I'm not sure about your exact use case, but I think using a gen_server 
to interface with the RabbitMQ Erlang client is unnecessary.

Perhaps, at the moment, the best place to see how the client is used is 
the test_util module in the test folder. It is not very clean, but some 
of the tests should be fairly easy to understand.


HTH,
Vlad.


-- 

 [][][] Vlad Alexandru Ionescu | Developer
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] www.lshift.net         | Email: vlad at lshift.net





From cremes.devlist at mac.com  Thu Dec  3 19:01:50 2009
From: cremes.devlist at mac.com (Chuck Remes)
Date: Thu, 03 Dec 2009 13:01:50 -0600
Subject: [rabbitmq-discuss] [Q] fanout exchange same as direct with blank
	routing key?
Message-ID: <DD8BA593-585F-43E4-9714-8E51C3562B3C@mac.com>

My question is in the subject.

I think it might be the same to publish to a direct exchange with an  
empty string routing key as it is to publish to a fanout exchange  
(since fanouts don't honor routing keys). The only difference I can  
think of would be that there might be some matching done against the  
empty string routing key for delivery through the direct exchange that  
is skipped for the fanout exchange. Therefore, a fanout exchange would  
have *slightly* better performance versus a direct exchange with an  
empty routing key.

Anyone know?

cr




From sh at defuze.org  Thu Dec  3 19:49:53 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Thu, 03 Dec 2009 20:49:53 +0100
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <4B17F43A.4050603@lshift.net>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net>
Message-ID: <4B181661.4070001@defuze.org>

Hi Vlad,

>
>
> I will try to answer your questions.

Thanks for your swift reply.

>
>> it seems things have quite changed since
>> September
> As far as I know, apart from replacing the amqp_connection:start with 
> start_direct and start_network and the new approach with 
> #amqp_params{}, the API remained the same.
> Yes, there has been a lot of refactoring behind the scenes, but we 
> didn't touch the API.
>
>> For instance the test suite seems to suggest one should be using
>> amqp_connection:start(Params) to create a new connection but, unless I'm
>> mistaken, that function doesn't exist and you must use directly either
>> start_network or start_direct.
> The right way of starting a connection is using either of the 
> functions start_network or start_direct in amqp_connection. The start 
> function has been removed quite some time ago.

Thanks for clarifying this. I think there is one of the test module 
which might need some updates then.

>
>> Also, it's unclear whether or not you can safely reuse Connections 
>> across
>> several erlang nodes concurrently or if there are some issues in 
>> doing so.
>> Can I use one connection and cretae as many channels as I want? Should
>> channel be on a per erlang process basis?
> As far as I am aware both the connection and the channel processes 
> have been designed to be used from multiple processes. They are in 
> fact gen_server's.
> Not only that creating a single connection with as many channels as 
> you like is possible, but it is also the recommended style. The 
> maximum number of channels is 65535 I think, unless it is specified 
> otherwise by the server (RabbitMQ server doesn't specify another 
> limit). That should probably be more than enough.

Should channels be on per process basis? Say I create a channel, can I 
publish more than once without having to wait for each ack? Or is there 
a sequential constraint so that the channel knows where to propagate the 
potential ack from the server

>
>
>> I have a gen_server where I direct all my AMQP calls (publish, etc.) and
>> within that gen_server I create a pool of connections. Should this pool
>> reside in its own gen_server so that each connection belongs to one 
>> single
>> supervised erlang process? Currently I keep the pool within the
>> gen_server's state. But this means I'm concurrently using the same
>> connection for different channels. Is that safe?
> As answered above, you don't need to worry about using the connection 
> from different processes. The connection process itself is a 
> gen_server, and what you get with amqp_connection:start_network() is 
> just the pid of the spawned connection process, that you can use from 
> anywhere (any process) in your application.
> I'm not sure about your exact use case, but I think using a gen_server 
> to interface with the RabbitMQ Erlang client is unnecessary.

Meaning I don't need a connection pool I suppose. Cool.


Thanks Vlad,
- Sylvain



From vlad at lshift.net  Thu Dec  3 21:24:06 2009
From: vlad at lshift.net (Vlad Alexandru Ionescu)
Date: Thu, 03 Dec 2009 21:24:06 +0000
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <4B181661.4070001@defuze.org>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net> <4B181661.4070001@defuze.org>
Message-ID: <4B182C76.9070704@lshift.net>

Sylvain,

> I think there is one of the test module which might need some updates 
> then. 
The tests work for us. They should work for you too. Type the following 
while in the rabbitmq-erlang-client folder:

  $ make all_tests

(you should keep rabbitmq-server, rabbitmq-erlang-client and 
rabbitmq-codegen in the same folder for this to work; do not start the 
server for this, it is started by the tests).
If the tests fail there's probably a problem with your copy. If you post 
the output we may be able to help.

> Should channels be on per process basis? Say I create a channel, can I 
> publish more than once without having to wait for each ack? Or is 
> there a sequential constraint so that the channel knows where to 
> propagate the potential ack from the server
You can use a channel from more than one process. The channel process 
queues up the calls and sends them to the server one by one (sends one, 
waits for reply, sends the next, waits for reply etc). While a call is 
in the queue to be sent to the server, the (user) process which 
initiated the call is blocked while the methods in front in the queue 
are processed plus the time for our actual call.
So the channel takes care of serializing the methods and remembers which 
process sent which method so it can reply (return value) to user 
processes accordingly.
However, due to the synchronous nature of this mechanism, just one 
channel will not utilize the entire bandwidth available (e.g. while the 
channel is waiting for the reply, it does not send the next call). For 
this reason, it is advisable to split tasks that have no relation to 
each other (the order of the events does not matter between tasks) so 
that they use separate channels.

All the above applies to synchronous methods (like basic.get for example).
Asynchronous methods (like basic.publish) are not queued up. They are 
sent immediately no matter what is in the queue (a call may end up after 
a cast at the server even though the call was made before the cast, if 
the call has to wait in line).

You can use amqp_channel:call/{2,3} for both sync and async methods 
(async methods return 'ok' immediately) and amqp_channel:cast/{2,3} only 
for async methods.


Vlad.


-- 

 [][][] Vlad Alexandru Ionescu | Developer
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] www.lshift.net         | Email: vlad at lshift.net





From sh at defuze.org  Thu Dec  3 21:38:48 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Thu, 03 Dec 2009 22:38:48 +0100
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <4B182C76.9070704@lshift.net>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net> <4B181661.4070001@defuze.org>
	<4B182C76.9070704@lshift.net>
Message-ID: <4B182FE8.3090309@defuze.org>

Vlad Alexandru Ionescu a ?crit :
> Sylvain,
>
>> I think there is one of the test module which might need some updates 
>> then. 
> The tests work for us. They should work for you too. Type the 
> following while in the rabbitmq-erlang-client folder:
>
>  $ make all_tests
>
> (you should keep rabbitmq-server, rabbitmq-erlang-client and 
> rabbitmq-codegen in the same folder for this to work; do not start the 
> server for this, it is started by the tests).
> If the tests fail there's probably a problem with your copy. If you 
> post the output we may be able to help.

The tests are okay, it's one of the few comments within the test:

http://hg.rabbitmq.com/rabbitmq-erlang-client/file/179c76eb4087/test/test_util.erl#l49

Since that was one of the only spot where I could find documentation... 
well I thought to mention it wasn't correct :)

>
>> Should channels be on per process basis? Say I create a channel, can 
>> I publish more than once without having to wait for each ack? Or is 
>> there a sequential constraint so that the channel knows where to 
>> propagate the potential ack from the server
> You can use a channel from more than one process. The channel process 
> queues up the calls and sends them to the server one by one (sends 
> one, waits for reply, sends the next, waits for reply etc). While a 
> call is in the queue to be sent to the server, the (user) process 
> which initiated the call is blocked while the methods in front in the 
> queue are processed plus the time for our actual call.
> So the channel takes care of serializing the methods and remembers 
> which process sent which method so it can reply (return value) to user 
> processes accordingly.
> However, due to the synchronous nature of this mechanism, just one 
> channel will not utilize the entire bandwidth available (e.g. while 
> the channel is waiting for the reply, it does not send the next call). 
> For this reason, it is advisable to split tasks that have no relation 
> to each other (the order of the events does not matter between tasks) 
> so that they use separate channels.
>
> All the above applies to synchronous methods (like basic.get for 
> example).
> Asynchronous methods (like basic.publish) are not queued up. They are 
> sent immediately no matter what is in the queue (a call may end up 
> after a cast at the server even though the call was made before the 
> cast, if the call has to wait in line).
>
> You can use amqp_channel:call/{2,3} for both sync and async methods 
> (async methods return 'ok' immediately) and amqp_channel:cast/{2,3} 
> only for async methods.
>
>

Thanks that's really useful to know.

- Sylvain




From vlad at lshift.net  Thu Dec  3 21:51:12 2009
From: vlad at lshift.net (Vlad Alexandru Ionescu)
Date: Thu, 03 Dec 2009 21:51:12 +0000
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <4B182FE8.3090309@defuze.org>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net> <4B181661.4070001@defuze.org>
	<4B182C76.9070704@lshift.net> <4B182FE8.3090309@defuze.org>
Message-ID: <4B1832D0.4000604@lshift.net>


Sylvain,

> it's one of the few comments within the test:
>
> http://hg.rabbitmq.com/rabbitmq-erlang-client/file/179c76eb4087/test/test_util.erl#l49 
>
You're right, thanks. That needs to be updated.

There is currently some work in progress here on the client's 
documentation. Hopefully it will make the client much easier to use than 
it is now, when it will be released.


Vlad.


-- 

 [][][] Vlad Alexandru Ionescu | Developer
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] www.lshift.net         | Email: vlad at lshift.net





From sh at defuze.org  Fri Dec  4 08:08:43 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Fri, 4 Dec 2009 09:08:43 +0100 (CET)
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <4B182C76.9070704@lshift.net>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net> <4B181661.4070001@defuze.org>
	<4B182C76.9070704@lshift.net>
Message-ID: <53808.193.253.216.132.1259914123.squirrel@mail1.webfaction.com>

Vlad,

>> Should channels be on per process basis? Say I create a channel, can I
>> publish more than once without having to wait for each ack? Or is
>> there a sequential constraint so that the channel knows where to
>> propagate the potential ack from the server
> You can use a channel from more than one process. The channel process
> queues up the calls and sends them to the server one by one (sends one,
> waits for reply, sends the next, waits for reply etc). While a call is
> in the queue to be sent to the server, the (user) process which
> initiated the call is blocked while the methods in front in the queue
> are processed plus the time for our actual call.
> So the channel takes care of serializing the methods and remembers which
> process sent which method so it can reply (return value) to user
> processes accordingly.
> However, due to the synchronous nature of this mechanism, just one
> channel will not utilize the entire bandwidth available (e.g. while the
> channel is waiting for the reply, it does not send the next call). For
> this reason, it is advisable to split tasks that have no relation to
> each other (the order of the events does not matter between tasks) so
> that they use separate channels.
>
> All the above applies to synchronous methods (like basic.get for example).
> Asynchronous methods (like basic.publish) are not queued up. They are
> sent immediately no matter what is in the queue (a call may end up after
> a cast at the server even though the call was made before the cast, if
> the call has to wait in line).
>
> You can use amqp_channel:call/{2,3} for both sync and async methods
> (async methods return 'ok' immediately) and amqp_channel:cast/{2,3} only
> for async methods.
>
>


Thanks for all of this. There is one point I'm uncertain about. In my use
case I'm using mochiweb to push HTTP body requests into AMQP. I've looked
at the rabbitmq-mochiweb project but I couldn't find any point in the
source where they would actually be calling AMQP at all (as teh doc says
it's mainly a placeholder project).

Anyway, currently I have one single connection and I'm opening a channel
for each HTTP request, publishing and immediatly closing that channel. Is
that the most efficient usage of the erlang lib? If not, any hints to
improve it if you don't mind?

Cheers again,
- Sylvain
-- 
Sylvain Hellegouarch
http://www.defuze.org



From sh at defuze.org  Fri Dec  4 16:31:54 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Fri, 4 Dec 2009 17:31:54 +0100 (CET)
Subject: [rabbitmq-discuss] Error compiling erlang client
Message-ID: <44035.193.253.216.132.1259944314.squirrel@mail1.webfaction.com>

Hi all,

Whilst compiling the latest trunk of the RabbitMQ erlang library, I got
this error:


Archive:  dist/rabbit_common.ez
  inflating: deps/rabbit_common/include/rabbit_exchange_behaviour_spec.hrl
  inflating: deps/rabbit_common/include/rabbit_framing.hrl
  inflating: deps/rabbit_common/include/rabbit.hrl
  inflating: deps/rabbit_common/include/rabbit_framing_spec.hrl
  inflating: deps/rabbit_common/ebin/rabbit_channel.beam
  inflating: deps/rabbit_common/ebin/rabbit_binary_parser.beam
  inflating: deps/rabbit_common/ebin/rabbit_exchange_behaviour.beam
  inflating: deps/rabbit_common/ebin/rabbit_net.beam
  inflating: deps/rabbit_common/ebin/rabbit_framing_channel.beam
  inflating: deps/rabbit_common/ebin/rabbit_writer.beam
  inflating: deps/rabbit_common/ebin/gen_server2.beam
  inflating: deps/rabbit_common/ebin/rabbit_basic.beam
  inflating: deps/rabbit_common/ebin/rabbit_common.app
  inflating: deps/rabbit_common/ebin/rabbit_reader.beam
  inflating: deps/rabbit_common/ebin/rabbit_heartbeat.beam
  inflating: deps/rabbit_common/ebin/rabbit_binary_generator.beam
  inflating: deps/rabbit_common/ebin/rabbit_misc.beam
  inflating: deps/rabbit_common/ebin/rabbit_framing.beam
make: Warning: File `deps/rabbit_common/include/rabbit_framing.hrl' has
modification time 97 s in the future
ERL_LIBS=deps:dist: erlc -I include -o ebin -Wall -v +debug_info 
src/amqp_channel.erl
{error_logger,{{2009,12,4},{16,28,36}},"~s~n",["Error in process <0.11.0>
with exit value:
{{badmatch,error},[{code_server,get_user_lib_dirs_1,1},{code_server,get_user_lib_dirs_1,1},{code_server,init,3}]}\n"]}


I'm using R12b3 so perhaps it doesn't support that version (Debian Lenny).

Anyone has seen this error before? Google doesn't know.

Thanks,
- Sylvain
-- 
Sylvain Hellegouarch
http://www.defuze.org



From matthew at lshift.net  Fri Dec  4 17:09:42 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Fri, 4 Dec 2009 17:09:42 +0000
Subject: [rabbitmq-discuss] Error compiling erlang client
In-Reply-To: <44035.193.253.216.132.1259944314.squirrel@mail1.webfaction.com>
References: <44035.193.253.216.132.1259944314.squirrel@mail1.webfaction.com>
Message-ID: <20091204170942.GB17349@mrnibble.lshift.net>

Hi Sylvian,

On Fri, Dec 04, 2009 at 05:31:54PM +0100, Sylvain Hellegouarch wrote:
> ERL_LIBS=deps:dist: erlc -I include -o ebin -Wall -v +debug_info 
> src/amqp_channel.erl
> {error_logger,{{2009,12,4},{16,28,36}},"~s~n",["Error in process <0.11.0>
> with exit value:
> {{badmatch,error},[{code_server,get_user_lib_dirs_1,1},{code_server,get_user_lib_dirs_1,1},{code_server,init,3}]}\n"]}
> 
> I'm using R12b3 so perhaps it doesn't support that version (Debian Lenny).

Diffing R12B3 with R13B01 on code_server reveals:

108,112c116,124
<     {ok, Dirs} = erl_prim_loader:list_dir(Dir),
<     {Paths,_Libs} = make_path(Dir, Dirs),
<     %% Only add paths trailing with ./ebin.
<     [P || P <- Paths, filename:basename(P) =:= "ebin"] ++
<       get_user_lib_dirs_1(DirList);
---
>     case erl_prim_loader:list_dir(Dir) of
>       {ok, Dirs} ->
>           {Paths,_Libs} = make_path(Dir, Dirs),
>           %% Only add paths trailing with ./ebin.
>           [P || P <- Paths, filename:basename(P) =:= "ebin"] ++
>               get_user_lib_dirs_1(DirList);
>       error ->
>           get_user_lib_dirs_1(DirList)
>     end;

I.e. it was changed so that if it encounters an error, it just skips
onto the next element in the list.

My suspicion is it's upset about the trailing colon on the ERL_LIBS.
This is really a bug in the makefile that I introduced about a week ago
and have just fixed - please pull and try again.

If it still doesn't work do let us know. However, R12B03 is rather
ancient and whilst rabbit itself should work fine, other things like the
erlang client and the plugins may not work with such an old version of
Erlang - if you run into trouble, we'd recommend upgrading to a more
recent version of Erlang.

Best wishes,

Matthew



From vlad at lshift.net  Fri Dec  4 17:49:13 2009
From: vlad at lshift.net (Vlad Alexandru Ionescu)
Date: Fri, 04 Dec 2009 17:49:13 +0000
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <53808.193.253.216.132.1259914123.squirrel@mail1.webfaction.com>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net> <4B181661.4070001@defuze.org>
	<4B182C76.9070704@lshift.net>
	<53808.193.253.216.132.1259914123.squirrel@mail1.webfaction.com>
Message-ID: <4B194B99.5040309@lshift.net>

Sylvain,

> Anyway, currently I have one single connection and I'm opening a channel
> for each HTTP request, publishing and immediatly closing that channel. Is
> that the most efficient usage of the erlang lib? If not, any hints to
> improve it if you don't mind?

I think you're better off keeping the channel open as well, and using it 
(just one channel) for all your requests, since you're sending only 
basic.publish (which is an async method). This way you can avoid the 
delay of sending channel.open and then waiting for channel.open_ok for 
every request.
Nagle is turned off in the Erlang client so the methods are sent promptly.
Also, I suggest you use amqp_channel:cast/3 rather than 
amqp_channel:call/3. The cast function returns a bit quicker than the 
call function (lets your process continue quicker).


Vlad.


-- 

 [][][] Vlad Alexandru Ionescu | Developer
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] www.lshift.net         | Email: vlad at lshift.net





From sh at defuze.org  Fri Dec  4 21:51:11 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Fri, 04 Dec 2009 22:51:11 +0100
Subject: [rabbitmq-discuss] RabbitMQ erlang client documentation
In-Reply-To: <4B194B99.5040309@lshift.net>
References: <47775.193.253.216.132.1259828489.squirrel@mail1.webfaction.com>
	<4B17F43A.4050603@lshift.net> <4B181661.4070001@defuze.org>
	<4B182C76.9070704@lshift.net>
	<53808.193.253.216.132.1259914123.squirrel@mail1.webfaction.com>
	<4B194B99.5040309@lshift.net>
Message-ID: <4B19844F.8080803@defuze.org>

Vlad Alexandru Ionescu a ?crit :
> Sylvain,
>
>> Anyway, currently I have one single connection and I'm opening a channel
>> for each HTTP request, publishing and immediatly closing that 
>> channel. Is
>> that the most efficient usage of the erlang lib? If not, any hints to
>> improve it if you don't mind?
>
> I think you're better off keeping the channel open as well, and using 
> it (just one channel) for all your requests, since you're sending only 
> basic.publish (which is an async method). This way you can avoid the 
> delay of sending channel.open and then waiting for channel.open_ok for 
> every request.
> Nagle is turned off in the Erlang client so the methods are sent 
> promptly.
> Also, I suggest you use amqp_channel:cast/3 rather than 
> amqp_channel:call/3. The cast function returns a bit quicker than the 
> call function (lets your process continue quicker).
>
>
> Vlad.
>
>
Thanks Vlad.

Before your reply I had opted for a pool of channels opened on one 
connection. That pool is created once when I start my process and passed 
along. Each time I publish I just get one random channel from that pool. 
It has been working great, anything in particular against this idea?

Since I need to get the actual result of the publish op, I thought I 
needed to use call rather than cast (as a per my gen_server expectation 
anyway).

- Sylvain



From sh at defuze.org  Fri Dec  4 21:52:06 2009
From: sh at defuze.org (Sylvain Hellegouarch)
Date: Fri, 04 Dec 2009 22:52:06 +0100
Subject: [rabbitmq-discuss] Error compiling erlang client
In-Reply-To: <20091204170942.GB17349@mrnibble.lshift.net>
References: <44035.193.253.216.132.1259944314.squirrel@mail1.webfaction.com>
	<20091204170942.GB17349@mrnibble.lshift.net>
Message-ID: <4B198486.90905@defuze.org>

Matthew Sackman a ?crit :
> Hi Sylvian,
>
> On Fri, Dec 04, 2009 at 05:31:54PM +0100, Sylvain Hellegouarch wrote:
>   
>> ERL_LIBS=deps:dist: erlc -I include -o ebin -Wall -v +debug_info 
>> src/amqp_channel.erl
>> {error_logger,{{2009,12,4},{16,28,36}},"~s~n",["Error in process <0.11.0>
>> with exit value:
>> {{badmatch,error},[{code_server,get_user_lib_dirs_1,1},{code_server,get_user_lib_dirs_1,1},{code_server,init,3}]}\n"]}
>>
>> I'm using R12b3 so perhaps it doesn't support that version (Debian Lenny).
>>     
>
> Diffing R12B3 with R13B01 on code_server reveals:
>
> 108,112c116,124
> <     {ok, Dirs} = erl_prim_loader:list_dir(Dir),
> <     {Paths,_Libs} = make_path(Dir, Dirs),
> <     %% Only add paths trailing with ./ebin.
> <     [P || P <- Paths, filename:basename(P) =:= "ebin"] ++
> <       get_user_lib_dirs_1(DirList);
> ---
>   
>>     case erl_prim_loader:list_dir(Dir) of
>>       {ok, Dirs} ->
>>           {Paths,_Libs} = make_path(Dir, Dirs),
>>           %% Only add paths trailing with ./ebin.
>>           [P || P <- Paths, filename:basename(P) =:= "ebin"] ++
>>               get_user_lib_dirs_1(DirList);
>>       error ->
>>           get_user_lib_dirs_1(DirList)
>>     end;
>>     
>
> I.e. it was changed so that if it encounters an error, it just skips
> onto the next element in the list.
>
> My suspicion is it's upset about the trailing colon on the ERL_LIBS.
> This is really a bug in the makefile that I introduced about a week ago
> and have just fixed - please pull and try again.
>
> If it still doesn't work do let us know. However, R12B03 is rather
> ancient and whilst rabbit itself should work fine, other things like the
> erlang client and the plugins may not work with such an old version of
> Erlang - if you run into trouble, we'd recommend upgrading to a more
> recent version of Erlang.
>
> Best wishes,
>   

Thanks for the reply. I'll see if it's a problem for us to upgrade.

- Sylvain



From wilson.ke at wealthcraft.com  Mon Dec  7 03:42:27 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 7 Dec 2009 11:42:27 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>
	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>
	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>

Hi Alexis,

     I installed rabbitmq and alice in my linux server.



When I use "curl -i http://localhost:9999/conn"  to test,It respond me that:

curl: (52) Empty reply from server



When I use "curl -XPOST -i http://localhost:9999/control/start_app" to test, it respond me that:



HTTP/1.1 200 OK

Server: MochiWeb/1.0 (Any of you quaids got a smint?)

Date: Mon, 07 Dec 2009 11:35:00 GMT

Content-Type: text/json

Content-Length: 20



My mochiweb and alice can run normal and can connect to rabbitmq server.



Starting...------------- Alice ------------

Copyright (C) 2009 Ari Lerner, Nate Murray, Michael Fairchild, CloudTeam



rabbit node : rabbitmq at centos

connected   : true





I have try hard to settle it for 2 weeks, but nothing to get. Could you tell me why I can't get conn correctly responded result?

Thanks very much!



Wilson


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091207/d1c0692f/attachment.htm 

From mabrek at gmail.com  Mon Dec  7 05:00:40 2009
From: mabrek at gmail.com (mabrek)
Date: Mon, 07 Dec 2009 08:00:40 +0300
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
Message-ID: <4B1C8BF8.4040408@gmail.com>

Wilson Ke wrote:
> Hi Alexis,
>      I installed rabbitmq and alice in my linux server.
> 
> When I use "curl -i http://localhost:9999/conn"  to test,It respond me
> that:
> 
> curl: (52) Empty reply from server

It looks like a crash. Is there any useful information in alice log and stdout? It may contain crash report with stacktrace.

Regards,
Anton.



From wilson.ke at wealthcraft.com  Mon Dec  7 05:20:06 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 7 Dec 2009 13:20:06 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <4B1C8BF8.4040408@gmail.com>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>
	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>
	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
	<4B1C8BF8.4040408@gmail.com>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD010392E1AD86@EXMBX01.wealthcraft.local>

Below is alice log:



=INFO REPORT==== 7-Dec-2009::21:25:28 ==

Using controller: conn ('GET')



=CRASH REPORT==== 7-Dec-2009::21:25:28 ==

  crasher:

    initial call: mochiweb_socket_server:acceptor_loop/1

    pid: <0.67.0>

    registered_name: []

    exception error: no function clause matching

                     lists:map(#Fun<conn.0.81991811>,

                               {badrpc,

                                {'EXIT',

                                 {undef,

                                  [{rabbit_networking,connection_info_all,[]},

                                   {rpc,local_call,3},

                                   {conn,get,1},

                                   {rest_server,handle,2},

                                   {mochiweb_http,headers,5},

                                   {proc_lib,init_p_do_apply,3}]}}})

      in function  conn:get/1

      in call from rest_server:handle/2

      in call from mochiweb_http:headers/5

    ancestors: [mochiweb_http,rest_server,rest_server_sup,<0.58.0>,<0.57.0>]

    messages: []

    links: [<0.64.0>,#Port<0.766>]

    dictionary: []

    trap_exit: false

    status: running

    heap_size: 377

    stack_size: 24

    reductions: 861

  neighbours:



=ERROR REPORT==== 7-Dec-2009::21:25:28 ==

{mochiweb_socket_server,235,{child_error,function_clause}}





Hope the information can help you find the crash reason.



Regards,

Wilson



-----Original Message-----
From: mabrek [mailto:mabrek at gmail.com]
Sent: 2009?12?7? 13:01
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson Ke wrote:

> Hi Alexis,

>      I installed rabbitmq and alice in my linux server.

>

> When I use "curl -i http://localhost:9999/conn"  to test,It respond me

> that:

>

> curl: (52) Empty reply from server



It looks like a crash. Is there any useful information in alice log and stdout? It may contain crash report with stacktrace.



Regards,

Anton.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091207/6784cb64/attachment.htm 

From anthony-rabbitmq at hogan.id.au  Tue Dec  8 13:01:33 2009
From: anthony-rabbitmq at hogan.id.au (Anthony)
Date: Wed, 9 Dec 2009 00:01:33 +1100
Subject: [rabbitmq-discuss] of queues, memory and heartbeats...
In-Reply-To: <1bf8be120909020509y6be25628t4c03c5134ac883b3@mail.gmail.com>
References: <1bf8be120909010036lf5ad8e5r97801898214397@mail.gmail.com>
	<269388e30909010119r19b69f0ep3bbbbf79824bafed@mail.gmail.com>
	<1bf8be120909020509y6be25628t4c03c5134ac883b3@mail.gmail.com>
Message-ID: <1bf8be120912080501p5814e87ewbc27d79a30163c87@mail.gmail.com>

For the sake of anyone who tried this script, I realised I fluffed the
logic..

MEMFREEEQN="`egrep "^(MemTotal|MemFree|Buffers|Cached):" /proc/meminfo |\
>         awk '{print $1 " " $2}' |\
>         sed -r 's/^MemTotal:/+/g
>                 s/^(MemFree|Buffers|Cached):/-/g'`"
>
> MEMFREE="$(( ${MEMFREEEQN} ))"
> MEMPCFREE="$(( ( ${MEMFREE} * 100 ) / ${MEMTOTAL} ))"
>

This should do the trick :)

#!/bin/bash

STATE_OK=0
STATE_WARNING=1
STATE_CRITICAL=2
STATE_UNKNOWN=3
STATE_DEPENDENT=4

MEMTOTAL="`grep "^MemTotal: " /proc/meminfo |\
        awk '{print $2}'`"

MEMUSEDEQN="`egrep "^(MemTotal|MemFree|Buffers|Cached):" /proc/meminfo |\
        awk '{print $1 " " $2}' |\
        sed -r 's/^MemTotal:/+/g
                s/^(MemFree|Buffers|Cached):/-/g'`"

MEMUSED="$(( ${MEMUSEDEQN} ))"
MEMPCUSED="$(( ( ${MEMUSED} * 100 ) / ${MEMTOTAL} ))"
MEMPCFREE="$(( 100 - ${MEMPCUSED} ))"

MEMPCFREECRIT=5
MEMPCFREEWARN=10

if [ ${MEMPCFREE} -gt ${MEMPCFREEWARN} ]; then
        echo "OK: ${MEMUSED} (${MEMPCUSED}%) used, ${MEMPCFREE}% free"
        exit $STATE_OK
elif [ ${MEMPCFREE} -gt ${MEMPCFREECRIT} ]; then
        echo "WARNING: ${MEMUSED} (${MEMPCUSED}%) used, ${MEMPCFREE}% free"
        exit $STATE_WARNING
elif [ ${MEMPCFREE} -le ${MEMPCFREECRIT} ]; then
        echo "CRITICAL: ${MEMUSED} (${MEMPCUSED}%) used, ${MEMPCFREE}% free"
        exit $STATE_CRITICAL
fi

echo "UNKNOWN: Something went awry!"
exit $STATE_UNKNOWN
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091209/4565e8f3/attachment.htm 

From matthew at lshift.net  Wed Dec  9 12:08:06 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Wed, 9 Dec 2009 12:08:06 +0000
Subject: [rabbitmq-discuss] Rabbit Erlang Client on Windows
In-Reply-To: <ce47f6b80912021544q19fa6b24xce7ac640353af6f0@mail.gmail.com>
References: <ce47f6b80912021544q19fa6b24xce7ac640353af6f0@mail.gmail.com>
Message-ID: <20091209120806.GG2704@mrnibble.lshift.net>

Hi Colin,

Sorry for the delayed response, we've been somewhat snowed under here.
Or more accurately, meteorologically, drowned.

On Wed, Dec 02, 2009 at 06:44:08PM -0500, Colin Z wrote:
> Hey guys, I'm trying to upgrade all my Erlang and Rabbit components and am
> completely baffled at the complexity of changes since the last time I
> upgraded. Previously, everything seemed to "just work."
> 
> Trying to target:
>  Erlang 13B03
>  RabbitMQ server 1.7.0
>  Latest version of RabbitMQ Erlang client
> 
> I cannot get RabbitMQ to build from source, so I defaulted to using the
> pre-built version:
> http://www.rabbitmq.com/releases/rabbitmq-server/v1.7.0/rabbitmq-server-windows-1.7.0.zip

Right, that's your problem. The Erlang client shares code with the
server. Now in the past we did have a big push to make sure you could
compile the client without needing the source of the server, and it did
work correctly like that for a while. I have a horrible feeling though
that this is broken, maybe this happened when plugins came in. There is
no fundmental reason, as far as I know, why the client requires the
server sources.

> The client does not seem to come in a pre-built version, and I cannot get it
> to build from source either. It seems to want to build RabbitMQ itself and
> the pre-built version of MQ doesn't come with a Makefile, unfortunately.

Yup indeed.

> If I instead grab Rabbit from Mercurial:
> I get this:
> 
> Admin at myhost /cygdrive/f/Program
> Files/erl5.7.4/lib/rabbitmq-erlang-client-default
> $ make
> f:/Program Files/GnuWin32/bin/make -C ../rabbitmq-server
> make[1]: Entering directory `f:/Program Files/erl5.7.4/lib/rabbitmq-server'
> python codegen.py body   ../rabbitmq-codegen//amqp-0.8.json
> src/rabbit_framing.erl
>   File "codegen.py", line 60
>     else: raise 'Non-empty table defaults not supported', d

Hmm. I'm not a python expert so I don't know. I'm using Python 2.5 here
and that works fine. I wonder whether this is python 3000 issue.

> SyntaxError: invalid syntax
> make[1]: *** [src/rabbit_framing.erl] Error 1
> make[1]: Leaving directory `f:/Program Files/erl5.7.4/lib/rabbitmq-server'
> make: *** [dist/rabbit_common.ez] Error 2
> 
> Any ideas?

I'm afraid, I'd suggest trying a python before 3000. If that does work
for you then please let us know. I guess we're going to have to rewrite
all our python scripts for python 3000. Joy.

Matthew



From matthew at lshift.net  Wed Dec  9 12:14:22 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Wed, 9 Dec 2009 12:14:22 +0000
Subject: [rabbitmq-discuss] [Q] fanout exchange same as direct with
 blank routing key?
In-Reply-To: <DD8BA593-585F-43E4-9714-8E51C3562B3C@mac.com>
References: <DD8BA593-585F-43E4-9714-8E51C3562B3C@mac.com>
Message-ID: <20091209121422.GH2704@mrnibble.lshift.net>

On Thu, Dec 03, 2009 at 01:01:50PM -0600, Chuck Remes wrote:
> My question is in the subject.

The answer is no. ;)

They are the same only if every binding to the direct exchange uses an
empty binding key, and, as you say, all the publishes are with a
blank routing key.

In many ways, you can think of a direct exchange as a cluster of fanout
exchanges where there is implicitly a fanout for every routing key and
binding key.

> The only difference I can  
> think of would be that there might be some matching done against the  
> empty string routing key for delivery through the direct exchange that  
> is skipped for the fanout exchange. Therefore, a fanout exchange would  
> have *slightly* better performance versus a direct exchange with an  
> empty routing key.

Correct, and the greater the number of different binding keys the direct
exchange has, the slower it will be. So if performance is important to
you, and you can get away with using a fanout, do so.

Matthew



From adam.ciganek at gmail.com  Wed Dec  9 13:58:52 2009
From: adam.ciganek at gmail.com (=?ISO-8859-1?Q?Adam_Cig=E1nek?=)
Date: Wed, 9 Dec 2009 14:58:52 +0100
Subject: [rabbitmq-discuss] How to set full nodename
Message-ID: <798686260912090558i120846cdr447dd01c7b8e3690@mail.gmail.com>

Hello there,

How to tell rabbitmq to use nodename like "rabbit at localhost"? If I put
this into /etc/rabbitmq/rabbitmq.conf (i'm on debian based distro):

NODENAME=rabbit at localhost

then it seems to insist on connecting to "rabbit at localhost@blahblah"
(where blahblah is the hostname of the machine it is running on). I
tried also setting the environment variable RABBITMQ_NODENAME, but
with the same results.

The reason I want to do this is that I want to be able to change the
hostname of my machine while rabbitmq is running without it going
crazy.



From mwilhelm at vz.net  Wed Dec  9 14:25:34 2009
From: mwilhelm at vz.net (Martin Wilhelm)
Date: Wed, 9 Dec 2009 15:25:34 +0100
Subject: [rabbitmq-discuss] How to set full nodename
In-Reply-To: <798686260912090558i120846cdr447dd01c7b8e3690@mail.gmail.com>
References: <798686260912090558i120846cdr447dd01c7b8e3690@mail.gmail.com>
Message-ID: <4B1FB35E.8050300@vz.net>

Adam Cig?nek wrote:
> Hello there,
> 
> How to tell rabbitmq to use nodename like "rabbit at localhost"? If I put
> this into /etc/rabbitmq/rabbitmq.conf (i'm on debian based distro):
> 
> NODENAME=rabbit at localhost
> 
> then it seems to insist on connecting to "rabbit at localhost@blahblah"
> (where blahblah is the hostname of the machine it is running on). I
> tried also setting the environment variable RABBITMQ_NODENAME, but
> with the same results.
> 
> The reason I want to do this is that I want to be able to change the
> hostname of my machine while rabbitmq is running without it going
> crazy.

There was a experimental fix under the branch: "bug21771". This
one could help you. Try it. :)


Martin



VZnet Netzwerke Ltd. || Saarbruecker Str. 38 || D - 10405 Berlin

Tel:    
Fax:    
Mobil: 	+49 (176) 14050444

MWilhelm at vz.net

www.studivz.net, www.meinvz.net, www.schuelervz.net

VZnet Netzwerke Limited, Registered Office Berlin, Registration Court Charlottenburg, HRB 101454
Executive Directors: Markus Berger-de Leon, Clemens Riedl
Non-Executive Directors: Dr. Jochen Gutbrod Martin Weber, Claas van Delden
Headquarters: VZnet Netzwerke Limited, 5 New Street Square, London EC4A 3TW, United Kingdom
Companies House Cardiff No. 5607971, Place of Registration: England and Wales




From matthew at lshift.net  Wed Dec  9 14:26:08 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Wed, 9 Dec 2009 14:26:08 +0000
Subject: [rabbitmq-discuss] How to set full nodename
In-Reply-To: <798686260912090558i120846cdr447dd01c7b8e3690@mail.gmail.com>
References: <798686260912090558i120846cdr447dd01c7b8e3690@mail.gmail.com>
Message-ID: <20091209142608.GI2704@mrnibble.lshift.net>

Hi there,

On Wed, Dec 09, 2009 at 02:58:52PM +0100, Adam Cig?nek wrote:
> How to tell rabbitmq to use nodename like "rabbit at localhost"? If I put
> this into /etc/rabbitmq/rabbitmq.conf (i'm on debian based distro):
> 
> NODENAME=rabbit at localhost
> 
> then it seems to insist on connecting to "rabbit at localhost@blahblah"
> (where blahblah is the hostname of the machine it is running on). I
> tried also setting the environment variable RABBITMQ_NODENAME, but
> with the same results.

This has been fixed on our default branch (i.e. the fix has been made
and it's been through our QA), but there is no release that fixes this
problem. I'm afraid the only way for you to get around this is to
compile Rabbit from source. Please see our compilation guide at:
http://www.rabbitmq.com/build-server.html

Needless to say, the fix will be included in our next stable release.

Matthew



From adam.ciganek at gmail.com  Wed Dec  9 14:30:58 2009
From: adam.ciganek at gmail.com (=?ISO-8859-1?Q?Adam_Cig=E1nek?=)
Date: Wed, 9 Dec 2009 15:30:58 +0100
Subject: [rabbitmq-discuss] How to set full nodename
In-Reply-To: <20091209142608.GI2704@mrnibble.lshift.net>
References: <798686260912090558i120846cdr447dd01c7b8e3690@mail.gmail.com>
	<20091209142608.GI2704@mrnibble.lshift.net>
Message-ID: <798686260912090630p4275607av3ee8c69f9be37ad7@mail.gmail.com>

Ok, I'll wait for the next release then (not worth for me to go
through the compilation really). Thanks!

adam.

2009/12/9 Matthew Sackman <matthew at lshift.net>:
> Hi there,
>
> On Wed, Dec 09, 2009 at 02:58:52PM +0100, Adam Cig?nek wrote:
>> How to tell rabbitmq to use nodename like "rabbit at localhost"? If I put
>> this into /etc/rabbitmq/rabbitmq.conf (i'm on debian based distro):
>>
>> NODENAME=rabbit at localhost
>>
>> then it seems to insist on connecting to "rabbit at localhost@blahblah"
>> (where blahblah is the hostname of the machine it is running on). I
>> tried also setting the environment variable RABBITMQ_NODENAME, but
>> with the same results.
>
> This has been fixed on our default branch (i.e. the fix has been made
> and it's been through our QA), but there is no release that fixes this
> problem. I'm afraid the only way for you to get around this is to
> compile Rabbit from source. Please see our compilation guide at:
> http://www.rabbitmq.com/build-server.html
>
> Needless to say, the fix will be included in our next stable release.
>
> Matthew
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From michael.justin at gmx.net  Wed Dec  9 14:39:29 2009
From: michael.justin at gmx.net (Michael Justin)
Date: Wed, 09 Dec 2009 15:39:29 +0100
Subject: [rabbitmq-discuss] Amazon Images (AMI) for RabbitMQ
Message-ID: <4B1FB6A1.4040004@gmx.net>

Hello,

currently I have an Amazon AWS account but no experience with AMI. Is it 
possible to take a public RabbitMQ AMI (listed on 
http://www.rabbitmq.com/ec2.html), copy it and install the Stomp client 
so that I can use it for development and testing? Would this copy be 
free of charge while it is not running?

Many thanks in advance,

-- 
Michael Justin
SCJP, SCJA
betasoft - Software for Delphi? and for the Java? platform
http://www.mikejustin.com - http://www.betabeans.de




From michael.dehaan at gmail.com  Wed Dec  9 16:49:18 2009
From: michael.dehaan at gmail.com (Michael DeHaan)
Date: Wed, 9 Dec 2009 11:49:18 -0500
Subject: [rabbitmq-discuss] Example of Fully-Loaded rabbitmq.config?
Message-ID: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com>

Hi folks,

I'm interested in finding out how to deploy Rabbit MQ reasonably well
with a configuration management system or with config RPMs.

Ideally I would be looking to be able to configure the following
programatically, without needing to invoke rabbitmqcontrol:   user
additions, queue/exchange setup, cluster setup, and port/access
control.   Basically everything that can be done with
/sbin/rabbitmqctl.

Can someone share we me an example of a fully loaded rabbitmq config,
or tell me how I might dump the current settings of RabbitMQ to a
config file that could be deployed in an automated batch fashion?

I'm *very* impressed with app, though I see that the config file notes
in the FAQ are a bit sparse and was looking for pointers.

Thanks very much!

--Michael DeHaan



From kevin at hypotheticalabs.com  Wed Dec  9 17:19:31 2009
From: kevin at hypotheticalabs.com (Kevin A. Smith)
Date: Wed, 9 Dec 2009 12:19:31 -0500
Subject: [rabbitmq-discuss] Example of Fully-Loaded rabbitmq.config?
In-Reply-To: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com>
References: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com>
Message-ID: <14FA3708-E30E-4018-8A77-A04C546B2C49@hypotheticalabs.com>

Ben Black recently released his recipes for Opscode's chef:

http://github.com/b/cookbooks/tree/master/rabbitmq/

There's probably a good thing or two in there...

--Kevin
On Dec 9, 2009, at 11:49 AM, Michael DeHaan wrote:

> Hi folks,
> 
> I'm interested in finding out how to deploy Rabbit MQ reasonably well
> with a configuration management system or with config RPMs.
> 
> Ideally I would be looking to be able to configure the following
> programatically, without needing to invoke rabbitmqcontrol:   user
> additions, queue/exchange setup, cluster setup, and port/access
> control.   Basically everything that can be done with
> /sbin/rabbitmqctl.
> 
> Can someone share we me an example of a fully loaded rabbitmq config,
> or tell me how I might dump the current settings of RabbitMQ to a
> config file that could be deployed in an automated batch fashion?
> 
> I'm *very* impressed with app, though I see that the config file notes
> in the FAQ are a bit sparse and was looking for pointers.
> 
> Thanks very much!
> 
> --Michael DeHaan
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss




From michael.dehaan at gmail.com  Wed Dec  9 18:37:13 2009
From: michael.dehaan at gmail.com (Michael DeHaan)
Date: Wed, 9 Dec 2009 13:37:13 -0500
Subject: [rabbitmq-discuss] Example of Fully-Loaded rabbitmq.config?
In-Reply-To: <14FA3708-E30E-4018-8A77-A04C546B2C49@hypotheticalabs.com>
References: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com>
	<14FA3708-E30E-4018-8A77-A04C546B2C49@hypotheticalabs.com>
Message-ID: <838ec8ff0912091037o7598eca6v9ee0f38b355f1416@mail.gmail.com>

Thanks Kevin,

I see this does a fair chunk of the things I'd want... anyone know if
users and queues can also be done via a configuration file?

Example from Chef above:
http://github.com/b/cookbooks/blob/master/rabbitmq/templates/default/rabbitmq.config.erb

--Michael



On Wed, Dec 9, 2009 at 12:19 PM, Kevin A. Smith
<kevin at hypotheticalabs.com> wrote:
> Ben Black recently released his recipes for Opscode's chef:
>
> http://github.com/b/cookbooks/tree/master/rabbitmq/
>
> There's probably a good thing or two in there...
>
> --Kevin
> On Dec 9, 2009, at 11:49 AM, Michael DeHaan wrote:
>
>> Hi folks,
>>
>> I'm interested in finding out how to deploy Rabbit MQ reasonably well
>> with a configuration management system or with config RPMs.
>>
>> Ideally I would be looking to be able to configure the following
>> programatically, without needing to invoke rabbitmqcontrol: ? user
>> additions, queue/exchange setup, cluster setup, and port/access
>> control. ? Basically everything that can be done with
>> /sbin/rabbitmqctl.
>>
>> Can someone share we me an example of a fully loaded rabbitmq config,
>> or tell me how I might dump the current settings of RabbitMQ to a
>> config file that could be deployed in an automated batch fashion?
>>
>> I'm *very* impressed with app, though I see that the config file notes
>> in the FAQ are a bit sparse and was looking for pointers.
>>
>> Thanks very much!
>>
>> --Michael DeHaan
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From alexis.richardson at gmail.com  Wed Dec  9 21:30:36 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 9 Dec 2009 21:30:36 +0000
Subject: [rabbitmq-discuss] Example of Fully-Loaded rabbitmq.config?
In-Reply-To: <838ec8ff0912091037o7598eca6v9ee0f38b355f1416@mail.gmail.com>
References: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com>
	<14FA3708-E30E-4018-8A77-A04C546B2C49@hypotheticalabs.com>
	<838ec8ff0912091037o7598eca6v9ee0f38b355f1416@mail.gmail.com>
Message-ID: <167204d20912091330g8fd23d2ud1573910b9d2cf0@mail.gmail.com>

Hi all,

I've been thinking about the question "what is a Rabbit application",
from a number of points of view.  The idea is that a full RabbitMQ
system should be definable as "application plus data".  There are
several configuration elements that could together 'be' an
application.  Also, we could look at fate sharing issues (security,
durability, availability).

Anyone got any ideas?  I would love to hear them.

Cheers

alexis


On Wed, Dec 9, 2009 at 6:37 PM, Michael DeHaan <michael.dehaan at gmail.com> wrote:
> Thanks Kevin,
>
> I see this does a fair chunk of the things I'd want... anyone know if
> users and queues can also be done via a configuration file?
>
> Example from Chef above:
> http://github.com/b/cookbooks/blob/master/rabbitmq/templates/default/rabbitmq.config.erb
>
> --Michael
>
>
>
> On Wed, Dec 9, 2009 at 12:19 PM, Kevin A. Smith
> <kevin at hypotheticalabs.com> wrote:
>> Ben Black recently released his recipes for Opscode's chef:
>>
>> http://github.com/b/cookbooks/tree/master/rabbitmq/
>>
>> There's probably a good thing or two in there...
>>
>> --Kevin
>> On Dec 9, 2009, at 11:49 AM, Michael DeHaan wrote:
>>
>>> Hi folks,
>>>
>>> I'm interested in finding out how to deploy Rabbit MQ reasonably well
>>> with a configuration management system or with config RPMs.
>>>
>>> Ideally I would be looking to be able to configure the following
>>> programatically, without needing to invoke rabbitmqcontrol: ? user
>>> additions, queue/exchange setup, cluster setup, and port/access
>>> control. ? Basically everything that can be done with
>>> /sbin/rabbitmqctl.
>>>
>>> Can someone share we me an example of a fully loaded rabbitmq config,
>>> or tell me how I might dump the current settings of RabbitMQ to a
>>> config file that could be deployed in an automated batch fashion?
>>>
>>> I'm *very* impressed with app, though I see that the config file notes
>>> in the FAQ are a bit sparse and was looking for pointers.
>>>
>>> Thanks very much!
>>>
>>> --Michael DeHaan
>>>
>>> _______________________________________________
>>> rabbitmq-discuss mailing list
>>> rabbitmq-discuss at lists.rabbitmq.com
>>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>
>>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From alexis.richardson at gmail.com  Wed Dec  9 22:07:34 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 9 Dec 2009 22:07:34 +0000
Subject: [rabbitmq-discuss] Example of Fully-Loaded rabbitmq.config?
In-Reply-To: <2a8d4a710912091404v51988ea3w9111752fa2cc53ac@mail.gmail.com>
References: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com>
	<14FA3708-E30E-4018-8A77-A04C546B2C49@hypotheticalabs.com>
	<838ec8ff0912091037o7598eca6v9ee0f38b355f1416@mail.gmail.com>
	<167204d20912091330g8fd23d2ud1573910b9d2cf0@mail.gmail.com>
	<2a8d4a710912091404v51988ea3w9111752fa2cc53ac@mail.gmail.com>
Message-ID: <167204d20912091407h541f19ffn7edf688c404e14c7@mail.gmail.com>

Matt

I'm asking about how to package everything so that:

- I can send you an 'app' file like a .war file in the world of java,
and you could boot your rabbitmq server to run it

- Potentially, it could be used to snapshot state and perform recovery
or pre-fetch apps prior to data recovery

alexis

On Wed, Dec 9, 2009 at 10:04 PM, Matt Todd <mtodd at highgroove.com> wrote:
> Sorry, I'm a little confused as to what exactly you're asking for...
> If I were to hazard a guess, you're asking what we as users picture RabbitMQ
> as when we refer to RabbitMQ applications?
> I guess I imagine it as a simple service used to route messages between
> components of my overall architecture, so it really is just a single package
> instead of many smaller ones.
> This feels like a really dumb and awkward answer, though, which leads me to
> question whether I understood your proposition.
> Matt
>
>
> On Wed, Dec 9, 2009 at 4:30 PM, Alexis Richardson
> <alexis.richardson at gmail.com> wrote:
>>
>> Hi all,
>>
>> I've been thinking about the question "what is a Rabbit application",
>> from a number of points of view. ?The idea is that a full RabbitMQ
>> system should be definable as "application plus data". ?There are
>> several configuration elements that could together 'be' an
>> application. ?Also, we could look at fate sharing issues (security,
>> durability, availability).
>>
>> Anyone got any ideas? ?I would love to hear them.
>>
>> Cheers
>>
>> alexis
>>
>>
>> On Wed, Dec 9, 2009 at 6:37 PM, Michael DeHaan <michael.dehaan at gmail.com>
>> wrote:
>> > Thanks Kevin,
>> >
>> > I see this does a fair chunk of the things I'd want... anyone know if
>> > users and queues can also be done via a configuration file?
>> >
>> > Example from Chef above:
>> >
>> > http://github.com/b/cookbooks/blob/master/rabbitmq/templates/default/rabbitmq.config.erb
>> >
>> > --Michael
>> >
>> >
>> >
>> > On Wed, Dec 9, 2009 at 12:19 PM, Kevin A. Smith
>> > <kevin at hypotheticalabs.com> wrote:
>> >> Ben Black recently released his recipes for Opscode's chef:
>> >>
>> >> http://github.com/b/cookbooks/tree/master/rabbitmq/
>> >>
>> >> There's probably a good thing or two in there...
>> >>
>> >> --Kevin
>> >> On Dec 9, 2009, at 11:49 AM, Michael DeHaan wrote:
>> >>
>> >>> Hi folks,
>> >>>
>> >>> I'm interested in finding out how to deploy Rabbit MQ reasonably well
>> >>> with a configuration management system or with config RPMs.
>> >>>
>> >>> Ideally I would be looking to be able to configure the following
>> >>> programatically, without needing to invoke rabbitmqcontrol: ? user
>> >>> additions, queue/exchange setup, cluster setup, and port/access
>> >>> control. ? Basically everything that can be done with
>> >>> /sbin/rabbitmqctl.
>> >>>
>> >>> Can someone share we me an example of a fully loaded rabbitmq config,
>> >>> or tell me how I might dump the current settings of RabbitMQ to a
>> >>> config file that could be deployed in an automated batch fashion?
>> >>>
>> >>> I'm *very* impressed with app, though I see that the config file notes
>> >>> in the FAQ are a bit sparse and was looking for pointers.
>> >>>
>> >>> Thanks very much!
>> >>>
>> >>> --Michael DeHaan
>> >>>
>> >>> _______________________________________________
>> >>> rabbitmq-discuss mailing list
>> >>> rabbitmq-discuss at lists.rabbitmq.com
>> >>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >>
>> >>
>> >
>> > _______________________________________________
>> > rabbitmq-discuss mailing list
>> > rabbitmq-discuss at lists.rabbitmq.com
>> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>
>
> --
> Matt Todd
> Highgroove Studios
> www.highgroove.com
> cell: 404-314-2612
> blog: maraby.org
>
> Scout - Web Monitoring and Reporting Software
> www.scoutapp.com
>



From mtodd at highgroove.com  Wed Dec  9 22:13:41 2009
From: mtodd at highgroove.com (Matt Todd)
Date: Wed, 9 Dec 2009 17:13:41 -0500
Subject: [rabbitmq-discuss] Example of Fully-Loaded rabbitmq.config?
In-Reply-To: <167204d20912091407h541f19ffn7edf688c404e14c7@mail.gmail.com>
References: <838ec8ff0912090849n448f37dei737ce67312aede46@mail.gmail.com> 
	<14FA3708-E30E-4018-8A77-A04C546B2C49@hypotheticalabs.com> 
	<838ec8ff0912091037o7598eca6v9ee0f38b355f1416@mail.gmail.com> 
	<167204d20912091330g8fd23d2ud1573910b9d2cf0@mail.gmail.com> 
	<2a8d4a710912091404v51988ea3w9111752fa2cc53ac@mail.gmail.com> 
	<167204d20912091407h541f19ffn7edf688c404e14c7@mail.gmail.com>
Message-ID: <2a8d4a710912091413o2090827bjfc7024cfbff34429@mail.gmail.com>

Ah, apologies, missed that point. That's a great idea.

I hadn't thought of it in these terms before, and consequently I don't have
any feedback just yet. I'll see if I can put some together.

Matt



On Wed, Dec 9, 2009 at 5:07 PM, Alexis Richardson <
alexis.richardson at gmail.com> wrote:

> Matt
>
> I'm asking about how to package everything so that:
>
> - I can send you an 'app' file like a .war file in the world of java,
> and you could boot your rabbitmq server to run it
>
> - Potentially, it could be used to snapshot state and perform recovery
> or pre-fetch apps prior to data recovery
>
> alexis
>
> On Wed, Dec 9, 2009 at 10:04 PM, Matt Todd <mtodd at highgroove.com> wrote:
> > Sorry, I'm a little confused as to what exactly you're asking for...
> > If I were to hazard a guess, you're asking what we as users picture
> RabbitMQ
> > as when we refer to RabbitMQ applications?
> > I guess I imagine it as a simple service used to route messages between
> > components of my overall architecture, so it really is just a single
> package
> > instead of many smaller ones.
> > This feels like a really dumb and awkward answer, though, which leads me
> to
> > question whether I understood your proposition.
> > Matt
> >
> >
> > On Wed, Dec 9, 2009 at 4:30 PM, Alexis Richardson
> > <alexis.richardson at gmail.com> wrote:
> >>
> >> Hi all,
> >>
> >> I've been thinking about the question "what is a Rabbit application",
> >> from a number of points of view.  The idea is that a full RabbitMQ
> >> system should be definable as "application plus data".  There are
> >> several configuration elements that could together 'be' an
> >> application.  Also, we could look at fate sharing issues (security,
> >> durability, availability).
> >>
> >> Anyone got any ideas?  I would love to hear them.
> >>
> >> Cheers
> >>
> >> alexis
> >>
> >>
> >> On Wed, Dec 9, 2009 at 6:37 PM, Michael DeHaan <
> michael.dehaan at gmail.com>
> >> wrote:
> >> > Thanks Kevin,
> >> >
> >> > I see this does a fair chunk of the things I'd want... anyone know if
> >> > users and queues can also be done via a configuration file?
> >> >
> >> > Example from Chef above:
> >> >
> >> >
> http://github.com/b/cookbooks/blob/master/rabbitmq/templates/default/rabbitmq.config.erb
> >> >
> >> > --Michael
> >> >
> >> >
> >> >
> >> > On Wed, Dec 9, 2009 at 12:19 PM, Kevin A. Smith
> >> > <kevin at hypotheticalabs.com> wrote:
> >> >> Ben Black recently released his recipes for Opscode's chef:
> >> >>
> >> >> http://github.com/b/cookbooks/tree/master/rabbitmq/
> >> >>
> >> >> There's probably a good thing or two in there...
> >> >>
> >> >> --Kevin
> >> >> On Dec 9, 2009, at 11:49 AM, Michael DeHaan wrote:
> >> >>
> >> >>> Hi folks,
> >> >>>
> >> >>> I'm interested in finding out how to deploy Rabbit MQ reasonably
> well
> >> >>> with a configuration management system or with config RPMs.
> >> >>>
> >> >>> Ideally I would be looking to be able to configure the following
> >> >>> programatically, without needing to invoke rabbitmqcontrol:   user
> >> >>> additions, queue/exchange setup, cluster setup, and port/access
> >> >>> control.   Basically everything that can be done with
> >> >>> /sbin/rabbitmqctl.
> >> >>>
> >> >>> Can someone share we me an example of a fully loaded rabbitmq
> config,
> >> >>> or tell me how I might dump the current settings of RabbitMQ to a
> >> >>> config file that could be deployed in an automated batch fashion?
> >> >>>
> >> >>> I'm *very* impressed with app, though I see that the config file
> notes
> >> >>> in the FAQ are a bit sparse and was looking for pointers.
> >> >>>
> >> >>> Thanks very much!
> >> >>>
> >> >>> --Michael DeHaan
> >> >>>
> >> >>> _______________________________________________
> >> >>> rabbitmq-discuss mailing list
> >> >>> rabbitmq-discuss at lists.rabbitmq.com
> >> >>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >> >>
> >> >>
> >> >
> >> > _______________________________________________
> >> > rabbitmq-discuss mailing list
> >> > rabbitmq-discuss at lists.rabbitmq.com
> >> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >> >
> >>
> >> _______________________________________________
> >> rabbitmq-discuss mailing list
> >> rabbitmq-discuss at lists.rabbitmq.com
> >> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >
> >
> >
> > --
> > Matt Todd
> > Highgroove Studios
> > www.highgroove.com
> > cell: 404-314-2612
> > blog: maraby.org
> >
> > Scout - Web Monitoring and Reporting Software
> > www.scoutapp.com
> >
>



-- 
Matt Todd
Highgroove Studios
www.highgroove.com
cell: 404-314-2612
blog: maraby.org

Scout - Web Monitoring and Reporting Software
www.scoutapp.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091209/2d67b2f0/attachment.htm 

From Mark.Geib at echostar.com  Wed Dec  9 23:19:12 2009
From: Mark.Geib at echostar.com (Geib, Mark)
Date: Wed, 9 Dec 2009 16:19:12 -0700
Subject: [rabbitmq-discuss] Does a RabbitMq broker ever initiate connections
	to client ?
Message-ID: <4B203070.80404@echostar.com>

I am seeing some unexpected network traffic that appears to originate
from a debian machine running an instance of rabbitmq. Can someone
confirm a rabbitmq broker never tries to initiate any kind of tcp socket
connection please.

Thanks,
Mark.



From majek04 at gmail.com  Thu Dec 10 11:06:13 2009
From: majek04 at gmail.com (majek04)
Date: Thu, 10 Dec 2009 11:06:13 +0000
Subject: [rabbitmq-discuss] Amazon Images (AMI) for RabbitMQ
In-Reply-To: <4B1FB6A1.4040004@gmx.net>
References: <4B1FB6A1.4040004@gmx.net>
Message-ID: <3bb0d9710912100306g5a6da7fbl67b09faa88314fac@mail.gmail.com>

On Wed, Dec 9, 2009 at 14:39, Michael Justin <michael.justin at gmx.net> wrote:
> Hello,
>
> currently I have an Amazon AWS account but no experience with AMI. Is it
> possible to take a public RabbitMQ AMI (listed on
> http://www.rabbitmq.com/ec2.html), copy it and install the Stomp client
> so that I can use it for development and testing?

Stomp plugin can be installed on rabbit AMI's as described here:
http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2009-November/005567.html

> Would this copy be free of charge while it is not running?

Once you stop (halt) Amazon instance you stop paying.

Cheers!
  Marek Majkowski



From 0x6e6562 at gmail.com  Thu Dec 10 14:17:31 2009
From: 0x6e6562 at gmail.com (Ben Hood)
Date: Thu, 10 Dec 2009 14:17:31 +0000
Subject: [rabbitmq-discuss] Survey: RPC volumentrics + Uptime stats
Message-ID: <269388e30912100617u27819061y1fe9aa172d5541ba@mail.gmail.com>

Hi,

I'm just wondering if anybody in the community has any statistics that
they could about production deployments of Rabbit.

Basically I'd like to get a feel for some volumetrics of real
production instances using Rabbit as an RPC mechanism such as:

- What is the peak and average of number of RPC rountrips per second?
- How many clients and brokers was this achieved with?
- What is the Rabbit portion of the overall roundtrip latency?
- How many RPC timeouts were observed?
- Is RPC over Rabbit a good idea anyway?

Also, on an unrelated note, can anybody share any experiences of their
typical uptimes for Rabbit? Is there any feeling that a heavily used
Rabbit needs to be rebooted periodically?

Cheers,

Ben



From g at rre.tt  Thu Dec 10 16:48:59 2009
From: g at rre.tt (Garrett Smith)
Date: Thu, 10 Dec 2009 10:48:59 -0600
Subject: [rabbitmq-discuss] Survey: RPC volumentrics + Uptime stats
In-Reply-To: <269388e30912100617u27819061y1fe9aa172d5541ba@mail.gmail.com>
References: <269388e30912100617u27819061y1fe9aa172d5541ba@mail.gmail.com>
Message-ID: <ce2570e20912100848x2736e15cyd737f37612eb7e2e@mail.gmail.com>

On Thu, Dec 10, 2009 at 8:17 AM, Ben Hood <0x6e6562 at gmail.com> wrote:
> Hi,
>
> I'm just wondering if anybody in the community has any statistics that
> they could about production deployments of Rabbit.
>
> Basically I'd like to get a feel for some volumetrics of real
> production instances using Rabbit as an RPC mechanism such as:
>
> - What is the peak and average of number of RPC rountrips per second?

Our volume is low relative to Rabbit's capacity. I might see as many
as 30 calls per second, but latency is high (our apps).

> - How many clients and brokers was this achieved with?
> - What is the Rabbit portion of the overall roundtrip latency?

Negligible a percent as our call roundtrip latency is typically quite high.

> - How many RPC timeouts were observed?
> - Is RPC over Rabbit a good idea anyway?

It's overkill if you can by with a simple client/server topology. If a
system is likely to grow in complexity, the investment in messaging
patterns may well pay for itself with the flexibility it gains.

> Also, on an unrelated note, can anybody share any experiences of their
> typical uptimes for Rabbit? Is there any feeling that a heavily used
> Rabbit needs to be rebooted periodically?

My only problem with Rabbit server has been when we're letting
messages pile up in queues. A couple issues here:

1. The boolean flags for exclusive, autodelete, etc. have, some subtle
(IMO) implications on some very important memory issues in the broker.
Once you get them sorted out, it's smooth sailing, but there is that
important learning curve.

2. Not having a message time to live or expiration means that you
*really* need to make sure that either your queues are auto deleted or
that you're keeping up with the inflow.

I understand that there are features planned (or have landed) that
help with these issues. But that's really the only set of problems
I've faced.

Garrett



From theczintheroc2007 at gmail.com  Thu Dec 10 21:00:02 2009
From: theczintheroc2007 at gmail.com (Colin Z)
Date: Thu, 10 Dec 2009 16:00:02 -0500
Subject: [rabbitmq-discuss] Rabbit Erlang Client on Windows
In-Reply-To: <20091209120806.GG2704@mrnibble.lshift.net>
References: <ce47f6b80912021544q19fa6b24xce7ac640353af6f0@mail.gmail.com>
	<20091209120806.GG2704@mrnibble.lshift.net>
Message-ID: <ce47f6b80912101300g1f638cc3v30e27533a784bbf3@mail.gmail.com>

Hi Matthew,

Thanks for the response! Lots of work is better than no work ;)

Here's what I ended up having to do to get everything to compile and work
under Windows + Cygwin:

Use python26
Install zip and unzip packages in Cygwin via Cygwin's setup.exe
Change the line in common.mk to
LIBS_PATH=ERL_LIBS="$(DEPS_DIR)/$(DIST_DIR)/$(ERL_LIBS)/"
Copy the dist/rabbit_common directory that gets generated to the Erlang
/lib/ directory

I can't remember if I had to run "make" again after copying the
rabbit_common directory, but the above should get Windows users 95% there.

Might be useful to throw up on an FAQ somewhere until a later release makes
it more streamlined.

-Colin

On Wed, Dec 9, 2009 at 7:08 AM, Matthew Sackman <matthew at lshift.net> wrote:

> Hi Colin,
>
> Sorry for the delayed response, we've been somewhat snowed under here.
> Or more accurately, meteorologically, drowned.
>
> On Wed, Dec 02, 2009 at 06:44:08PM -0500, Colin Z wrote:
> > Hey guys, I'm trying to upgrade all my Erlang and Rabbit components and
> am
> > completely baffled at the complexity of changes since the last time I
> > upgraded. Previously, everything seemed to "just work."
> >
> > Trying to target:
> >  Erlang 13B03
> >  RabbitMQ server 1.7.0
> >  Latest version of RabbitMQ Erlang client
> >
> > I cannot get RabbitMQ to build from source, so I defaulted to using the
> > pre-built version:
> >
> http://www.rabbitmq.com/releases/rabbitmq-server/v1.7.0/rabbitmq-server-windows-1.7.0.zip
>
> Right, that's your problem. The Erlang client shares code with the
> server. Now in the past we did have a big push to make sure you could
> compile the client without needing the source of the server, and it did
> work correctly like that for a while. I have a horrible feeling though
> that this is broken, maybe this happened when plugins came in. There is
> no fundmental reason, as far as I know, why the client requires the
> server sources.
>
> > The client does not seem to come in a pre-built version, and I cannot get
> it
> > to build from source either. It seems to want to build RabbitMQ itself
> and
> > the pre-built version of MQ doesn't come with a Makefile, unfortunately.
>
> Yup indeed.
>
> > If I instead grab Rabbit from Mercurial:
> > I get this:
> >
> > Admin at myhost /cygdrive/f/Program
> > Files/erl5.7.4/lib/rabbitmq-erlang-client-default
> > $ make
> > f:/Program Files/GnuWin32/bin/make -C ../rabbitmq-server
> > make[1]: Entering directory `f:/Program
> Files/erl5.7.4/lib/rabbitmq-server'
> > python codegen.py body   ../rabbitmq-codegen//amqp-0.8.json
> > src/rabbit_framing.erl
> >   File "codegen.py", line 60
> >     else: raise 'Non-empty table defaults not supported', d
>
> Hmm. I'm not a python expert so I don't know. I'm using Python 2.5 here
> and that works fine. I wonder whether this is python 3000 issue.
>
> > SyntaxError: invalid syntax
> > make[1]: *** [src/rabbit_framing.erl] Error 1
> > make[1]: Leaving directory `f:/Program
> Files/erl5.7.4/lib/rabbitmq-server'
> > make: *** [dist/rabbit_common.ez] Error 2
> >
> > Any ideas?
>
> I'm afraid, I'd suggest trying a python before 3000. If that does work
> for you then please let us know. I guess we're going to have to rewrite
> all our python scripts for python 3000. Joy.
>
> Matthew
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091210/00cc9fe5/attachment.htm 

From cremes.devlist at mac.com  Thu Dec 10 21:04:27 2009
From: cremes.devlist at mac.com (Chuck Remes)
Date: Thu, 10 Dec 2009 15:04:27 -0600
Subject: [rabbitmq-discuss] [Q] periodic queue delivery
Message-ID: <DF8FDFD3-7316-45A2-B5C9-995824EC562B@mac.com>

I have a system that generates a lot of signals each second (between  
200 and 1000). I would like to offer a "display panel" that shows the  
current value.

So far this is pretty easy to solve. However, I only want to sample  
the signal stream 5 times a second to update the display because  
bandwidth to the display is "expensive."

A naive approach would be to send every signal to the display and have  
it cherry pick the most recent value every 200ms. But as I said,  
bandwidth is expensive so this approach won't work. Is there a  
combination of exchanges & queues that could consume the entire stream  
but only deliver an update every 200ms? Do I need to put a proxy  
server in between the signal generator and the display to throttle the  
message rate?

I am curious to know how others have solved this or a similar problem.

cr




From mabrek at gmail.com  Fri Dec 11 13:04:40 2009
From: mabrek at gmail.com (mabrek)
Date: Fri, 11 Dec 2009 16:04:40 +0300
Subject: [rabbitmq-discuss] persistent messages can't survive restart with
	new persister b6324e288cfd (bug21673)
Message-ID: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>

Hello.

I've got strange error with new persister revision b6324e288cfd
(bug21673). If I send several persistent messages (delivery mode 2) to
queue (about 10-100 message 10kb each) without consumers and restart
rabbitmq then queued messages would disappear from queue as if they
are not persistent.
It reproduces only if number of messages is low. When I tryed to
restart rabbit with 1000 messages in queue all messages stayed in
queue.

Regards,
Anton Lebedevich.



From matthew at lshift.net  Fri Dec 11 14:20:18 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Fri, 11 Dec 2009 14:20:18 +0000
Subject: [rabbitmq-discuss] persistent messages can't survive restart
 with new persister b6324e288cfd (bug21673)
In-Reply-To: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
References: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
Message-ID: <20091211142018.GB31393@wellquite.org>

Hello Anton,

This is entirely correct. When you publish a message with delivery
mode 2 you are *not* _guaranteed_ that it hits disk. Publishing is an
async operation and you get no confirmation that it goes to disk. The
new persister does very aggressive caching in order to avoid doing lots
of tiny and expensive writes. As such, there will frequently be times
where if you restart the broker, you will lose several (maybe hundreds)
of messages.

If you really want a guarantee that the message has hit disk then you
must, as with the old persister, use a transaction. When you receive the
tx.commit-ok back from the broke, you have a guarantee that the messages
have been flushed to disk and appropriate fsync's called.

Whilst this behaviour may seem different from the old persister, it is
in fact not different, it's simply that the window of time in which a
message now waits before being sent to disk is probably bigger. There is
certainly no concerted effort in either the new or old persister to
offer any sort of guarantee that messages published outside of a
transaction, with delivery mode 2, are "promptly" written to disk.

Matthew



From g at rre.tt  Fri Dec 11 15:30:29 2009
From: g at rre.tt (Garrett Smith)
Date: Fri, 11 Dec 2009 09:30:29 -0600
Subject: [rabbitmq-discuss] persistent messages can't survive restart
	with new persister b6324e288cfd (bug21673)
In-Reply-To: <20091211142018.GB31393@wellquite.org>
References: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
	<20091211142018.GB31393@wellquite.org>
Message-ID: <ce2570e20912110730x34c2cea7xdeddd68d1e647218@mail.gmail.com>

Hi Matthew,

On Fri, Dec 11, 2009 at 8:20 AM, Matthew Sackman <matthew at lshift.net> wrote:
> Hello Anton,
>
> This is entirely correct. When you publish a message with delivery
> mode 2 you are *not* _guaranteed_ that it hits disk. Publishing is an
> async operation and you get no confirmation that it goes to disk. The
> new persister does very aggressive caching in order to avoid doing lots
> of tiny and expensive writes. As such, there will frequently be times
> where if you restart the broker, you will lose several (maybe hundreds)
> of messages.

If you shut down gracefully the caches aren't flushed to disk?

Garrett



From matthew at lshift.net  Fri Dec 11 15:38:08 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Fri, 11 Dec 2009 15:38:08 +0000
Subject: [rabbitmq-discuss] persistent messages can't survive restart
 with new persister b6324e288cfd (bug21673)
In-Reply-To: <ce2570e20912110730x34c2cea7xdeddd68d1e647218@mail.gmail.com>
References: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
	<20091211142018.GB31393@wellquite.org>
	<ce2570e20912110730x34c2cea7xdeddd68d1e647218@mail.gmail.com>
Message-ID: <20091211153808.GC31393@wellquite.org>

Hi Garrett,

On Fri, Dec 11, 2009 at 09:30:29AM -0600, Garrett Smith wrote:
> On Fri, Dec 11, 2009 at 8:20 AM, Matthew Sackman <matthew at lshift.net> wrote:
> > This is entirely correct. When you publish a message with delivery
> > mode 2 you are *not* _guaranteed_ that it hits disk. Publishing is an
> > async operation and you get no confirmation that it goes to disk. The
> > new persister does very aggressive caching in order to avoid doing lots
> > of tiny and expensive writes. As such, there will frequently be times
> > where if you restart the broker, you will lose several (maybe hundreds)
> > of messages.
> 
> If you shut down gracefully the caches aren't flushed to disk?

No no, if it's a safe shutdown then yes, everything gets flushed out and
sync'd correctly. I should have made that clear above. You should only
lose messages in the event of a hard kill.

Matthew



From mabrek at gmail.com  Fri Dec 11 16:05:20 2009
From: mabrek at gmail.com (mabrek)
Date: Fri, 11 Dec 2009 19:05:20 +0300
Subject: [rabbitmq-discuss] persistent messages can't survive restart
	with new persister b6324e288cfd (bug21673)
In-Reply-To: <20091211153808.GC31393@wellquite.org>
References: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
	<20091211142018.GB31393@wellquite.org>
	<ce2570e20912110730x34c2cea7xdeddd68d1e647218@mail.gmail.com>
	<20091211153808.GC31393@wellquite.org>
Message-ID: <c26271fb0912110805q3e8361bo565808f8569d33ab@mail.gmail.com>

On Fri, Dec 11, 2009 at 6:38 PM, Matthew Sackman <matthew at lshift.net> wrote:
> Hi Garrett,
>
> On Fri, Dec 11, 2009 at 09:30:29AM -0600, Garrett Smith wrote:
>> On Fri, Dec 11, 2009 at 8:20 AM, Matthew Sackman <matthew at lshift.net> wrote:
>> > This is entirely correct. When you publish a message with delivery
>> > mode 2 you are *not* _guaranteed_ that it hits disk. Publishing is an
>> > async operation and you get no confirmation that it goes to disk. The
>> > new persister does very aggressive caching in order to avoid doing lots
>> > of tiny and expensive writes. As such, there will frequently be times
>> > where if you restart the broker, you will lose several (maybe hundreds)
>> > of messages.
>>
>> If you shut down gracefully the caches aren't flushed to disk?
>
> No no, if it's a safe shutdown then yes, everything gets flushed out and
> sync'd correctly. I should have made that clear above. You should only
> lose messages in the event of a hard kill.
>

Yes, it's logical to lose messages after kill -9.
But in in my case messages got lost after safe shutdown
(/etc/init.d/rabbitmq restart or
rabbitmqctl stop)

Regards,
Anton Lebedevich.


PS Matthew, sorry for message doubling, I've forgot to reply to list



From matthew at lshift.net  Fri Dec 11 16:59:03 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Fri, 11 Dec 2009 16:59:03 +0000
Subject: [rabbitmq-discuss] persistent messages can't survive restart
 with new persister b6324e288cfd (bug21673)
In-Reply-To: <c26271fb0912110805q3e8361bo565808f8569d33ab@mail.gmail.com>
References: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
	<20091211142018.GB31393@wellquite.org>
	<ce2570e20912110730x34c2cea7xdeddd68d1e647218@mail.gmail.com>
	<20091211153808.GC31393@wellquite.org>
	<c26271fb0912110805q3e8361bo565808f8569d33ab@mail.gmail.com>
Message-ID: <20091211165903.GD31393@wellquite.org>

Hi Anton,

On Fri, Dec 11, 2009 at 07:05:20PM +0300, mabrek wrote:
> On Fri, Dec 11, 2009 at 6:38 PM, Matthew Sackman <matthew at lshift.net> wrote:
> > On Fri, Dec 11, 2009 at 09:30:29AM -0600, Garrett Smith wrote:
> >> If you shut down gracefully the caches aren't flushed to disk?
> >
> > No no, if it's a safe shutdown then yes, everything gets flushed out and
> > sync'd correctly. I should have made that clear above. You should only
> > lose messages in the event of a hard kill.
> 
> Yes, it's logical to lose messages after kill -9.
> But in in my case messages got lost after safe shutdown
> (/etc/init.d/rabbitmq restart or
> rabbitmqctl stop)

Thank you very much for this bug report. I'm afraid that's the risk with
testing code before it's gone through QA. I was able to reproduce this
and have fixed it, in revision 166365bd96ef. The problem was actually
nothing to do with flushing data out - that was happening correctly, and
the queue was also recovering correctly. However, it was then ignoring
some counts and thus erroneously reporting a length of 0.

Please update to the latest on bug21673 and let me know if you see it
fixed.

Btw, I also tested hard killing Rabbit and that did lose messages.
However, with just 10 messages in the queue, a safe shutdown and restart
now correctly picks up the 10 messages in the queue, whereas before it
didn't.

Thanks once again,

Matthew



From alexis.richardson at gmail.com  Fri Dec 11 21:49:43 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Fri, 11 Dec 2009 21:49:43 +0000
Subject: [rabbitmq-discuss] [Q] periodic queue delivery
In-Reply-To: <DF8FDFD3-7316-45A2-B5C9-995824EC562B@mac.com>
References: <DF8FDFD3-7316-45A2-B5C9-995824EC562B@mac.com>
Message-ID: <167204d20912111349g4cc2f789r1fce7f215087fcce@mail.gmail.com>

Chuck

RabbitMQ does not (yet) support any internal behaviours where time is
a parameter.

This points you to sampling and batching at the:

* Client
* "Proxy" (see Client)
* Plugin

The first approach is just fine for many cases.  The last has the
strongest fate sharing properties.

alexis


On Thu, Dec 10, 2009 at 9:04 PM, Chuck Remes <cremes.devlist at mac.com> wrote:
> I have a system that generates a lot of signals each second (between
> 200 and 1000). I would like to offer a "display panel" that shows the
> current value.
>
> So far this is pretty easy to solve. However, I only want to sample
> the signal stream 5 times a second to update the display because
> bandwidth to the display is "expensive."
>
> A naive approach would be to send every signal to the display and have
> it cherry pick the most recent value every 200ms. But as I said,
> bandwidth is expensive so this approach won't work. Is there a
> combination of exchanges & queues that could consume the entire stream
> but only deliver an update every 200ms? Do I need to put a proxy
> server in between the signal generator and the display to throttle the
> message rate?
>
> I am curious to know how others have solved this or a similar problem.
>
> cr
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From cremes.devlist at mac.com  Fri Dec 11 23:58:09 2009
From: cremes.devlist at mac.com (Chuck Remes)
Date: Fri, 11 Dec 2009 17:58:09 -0600
Subject: [rabbitmq-discuss] [Q] periodic queue delivery
In-Reply-To: <167204d20912111349g4cc2f789r1fce7f215087fcce@mail.gmail.com>
References: <DF8FDFD3-7316-45A2-B5C9-995824EC562B@mac.com>
	<167204d20912111349g4cc2f789r1fce7f215087fcce@mail.gmail.com>
Message-ID: <66F22E21-5A16-47B3-92DB-7C2CE00B98E6@mac.com>

Alexis,

thank you for your answer. I think at this time I'll go the proxy route since I can bang that code out pretty rapidly. I'll look at doing a plugin down the road unless someone else beats me to it.

cr

On Dec 11, 2009, at 3:49 PM, Alexis Richardson wrote:

> Chuck
> 
> RabbitMQ does not (yet) support any internal behaviours where time is
> a parameter.
> 
> This points you to sampling and batching at the:
> 
> * Client
> * "Proxy" (see Client)
> * Plugin
> 
> The first approach is just fine for many cases.  The last has the
> strongest fate sharing properties.
> 
> alexis
> 
> 
> On Thu, Dec 10, 2009 at 9:04 PM, Chuck Remes <cremes.devlist at mac.com> wrote:
>> I have a system that generates a lot of signals each second (between
>> 200 and 1000). I would like to offer a "display panel" that shows the
>> current value.
>> 
>> So far this is pretty easy to solve. However, I only want to sample
>> the signal stream 5 times a second to update the display because
>> bandwidth to the display is "expensive."
>> 
>> A naive approach would be to send every signal to the display and have
>> it cherry pick the most recent value every 200ms. But as I said,
>> bandwidth is expensive so this approach won't work. Is there a
>> combination of exchanges & queues that could consume the entire stream
>> but only deliver an update every 200ms? Do I need to put a proxy
>> server in between the signal generator and the display to throttle the
>> message rate?
>> 
>> I am curious to know how others have solved this or a similar problem.
>> 
>> cr
>> 
>> 
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> 




From mabrek at gmail.com  Sat Dec 12 10:34:08 2009
From: mabrek at gmail.com (mabrek)
Date: Sat, 12 Dec 2009 13:34:08 +0300
Subject: [rabbitmq-discuss] persistent messages can't survive restart
 with new persister b6324e288cfd (bug21673)
In-Reply-To: <20091211165903.GD31393@wellquite.org>
References: <c26271fb0912110504w4216ddd9gb0311c417cf2fa96@mail.gmail.com>
	<20091211142018.GB31393@wellquite.org>
	<ce2570e20912110730x34c2cea7xdeddd68d1e647218@mail.gmail.com>
	<20091211153808.GC31393@wellquite.org>
	<c26271fb0912110805q3e8361bo565808f8569d33ab@mail.gmail.com>
	<20091211165903.GD31393@wellquite.org>
Message-ID: <4B2371A0.6070709@gmail.com>

Matthew Sackman wrote:
> On Fri, Dec 11, 2009 at 07:05:20PM +0300, mabrek wrote:
>> On Fri, Dec 11, 2009 at 6:38 PM, Matthew Sackman <matthew at lshift.net> wrote:
>>> On Fri, Dec 11, 2009 at 09:30:29AM -0600, Garrett Smith wrote:
>>>> If you shut down gracefully the caches aren't flushed to disk?
>>> No no, if it's a safe shutdown then yes, everything gets flushed out and
>>> sync'd correctly. I should have made that clear above. You should only
>>> lose messages in the event of a hard kill.
>> Yes, it's logical to lose messages after kill -9.
>> But in in my case messages got lost after safe shutdown
>> (/etc/init.d/rabbitmq restart or
>> rabbitmqctl stop)
> 
> Thank you very much for this bug report. I'm afraid that's the risk with
> testing code before it's gone through QA. I was able to reproduce this
> and have fixed it, in revision 166365bd96ef. The problem was actually
> nothing to do with flushing data out - that was happening correctly, and
> the queue was also recovering correctly. However, it was then ignoring
> some counts and thus erroneously reporting a length of 0.
> 
> Please update to the latest on bug21673 and let me know if you see it
> fixed.

I updated to rev c3f5c66513b6 and it fixed the problem.
rabbitmqctl list_queues correctly reports number of messages in queue after safe shutdown/restart.

Many thanks for your help.

Regards,
Anton Lebedevich.



From ahussein.abdelrahman at gmail.com  Sun Dec 13 11:41:27 2009
From: ahussein.abdelrahman at gmail.com (bido)
Date: Sun, 13 Dec 2009 03:41:27 -0800 (PST)
Subject: [rabbitmq-discuss]  clustering rabbitmq using ip addresses
Message-ID: <26765353.post@talk.nabble.com>


Hello all, 
i want to deploy a cluster of rabbitmq nodes, the thing is that i dont have
dns server(no to plan to have one) and i want to use the ip address of
machine to configure the cluster.

any ideas ? 

p.s: the cluster will be inside a LAN

-- 
View this message in context: http://old.nabble.com/clustering-rabbitmq-using-ip-addresses-tp26765353p26765353.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From matthew at lshift.net  Sun Dec 13 14:34:30 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Sun, 13 Dec 2009 14:34:30 +0000
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <26765353.post@talk.nabble.com>
References: <26765353.post@talk.nabble.com>
Message-ID: <20091213143430.GA17883@wellquite.org>

On Sun, Dec 13, 2009 at 03:41:27AM -0800, bido wrote:
> i want to deploy a cluster of rabbitmq nodes, the thing is that i dont have
> dns server(no to plan to have one) and i want to use the ip address of
> machine to configure the cluster.

If you're using the latest default from mercurial, you can set the
nodename as an IP address. That *may* help you, but I must admit
I've not tested clustering using that.

Matthew



From ahussein.abdelrahman at gmail.com  Sun Dec 13 14:59:05 2009
From: ahussein.abdelrahman at gmail.com (bido)
Date: Sun, 13 Dec 2009 06:59:05 -0800 (PST)
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <20091213143430.GA17883@wellquite.org>
References: <26765353.post@talk.nabble.com>
	<20091213143430.GA17883@wellquite.org>
Message-ID: <26766783.post@talk.nabble.com>


do you mean that i can set the nodename to be something like
rabbit at 192.168.1.3 for example ???
if you have the information, can you elaborate on how the nodes talk to each
others ? 

Matthew Sackman wrote:
> 
> On Sun, Dec 13, 2009 at 03:41:27AM -0800, bido wrote:
>> i want to deploy a cluster of rabbitmq nodes, the thing is that i dont
>> have
>> dns server(no to plan to have one) and i want to use the ip address of
>> machine to configure the cluster.
> 
> If you're using the latest default from mercurial, you can set the
> nodename as an IP address. That *may* help you, but I must admit
> I've not tested clustering using that.
> 
> Matthew
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 
> 

-- 
View this message in context: http://old.nabble.com/clustering-rabbitmq-using-ip-addresses-tp26765353p26766783.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From gmr at myyearbook.com  Sun Dec 13 19:59:36 2009
From: gmr at myyearbook.com (Gavin M. Roy)
Date: Sun, 13 Dec 2009 14:59:36 -0500
Subject: [rabbitmq-discuss] rejected.py 0.2 released
Message-ID: <af1bce590912131159j31bb3797x42d862974022b755@mail.gmail.com>

I've just bundled up rejected 0.2 and uploaded it to Github:

http://cloud.github.com/downloads/gmr/rejected.py/rejected-0.2.tar.bz2

 rejected.py is a python based multi-threaded consumer daemon and framework
for RabbitMQ

Features include:

   - Multithreaded consumer daemon, core application manages connections
   - Elastic threading based upon demand when using Alice
   - Safety mechanism to auto-unsubscribe consumers when encountering errors
   - Message rate limiting / throttling
   - Allows for multiple brokers per binding and multiple bindings per
   instance

Thanks to Shane Caraveo and Brian Jones for updates, advice and patches.

Regards,

Gavin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091213/dfafd9b9/attachment.htm 

From matthias at lshift.net  Sun Dec 13 20:00:53 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Sun, 13 Dec 2009 20:00:53 +0000
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <26765353.post@talk.nabble.com>
References: <26765353.post@talk.nabble.com>
Message-ID: <4B2547F5.708@lshift.net>

bido wrote:
> i want to deploy a cluster of rabbitmq nodes, the thing is that i dont have
> dns server(no to plan to have one) and i want to use the ip address of
> machine to configure the cluster.
> 
> any ideas ? 
> 
> p.s: the cluster will be inside a LAN

you could simply add all the cluster machines to /etc/hosts. That should 
be enough to keep Erlang happy.


Matthias.



From ahussein.abdelrahman at gmail.com  Sun Dec 13 21:42:00 2009
From: ahussein.abdelrahman at gmail.com (bido)
Date: Sun, 13 Dec 2009 13:42:00 -0800 (PST)
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <4B2547F5.708@lshift.net>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
Message-ID: <26770022.post@talk.nabble.com>


well this will require me to have all the machines names/ipaddress
beforehand, and thats is not feasible in my deployment, i want to be able to
add machines to the cluster on the fly.
I am wondering why i cannot use rabbit at 192.168.1.3 as nodename for example
??
i am a python/java kinda guy so, i dont really know how erlang handle it
message passing and communications between nodes.


Matthias Radestock-2 wrote:
> 
> bido wrote:
>> i want to deploy a cluster of rabbitmq nodes, the thing is that i dont
>> have
>> dns server(no to plan to have one) and i want to use the ip address of
>> machine to configure the cluster.
>> 
>> any ideas ? 
>> 
>> p.s: the cluster will be inside a LAN
> 
> you could simply add all the cluster machines to /etc/hosts. That should 
> be enough to keep Erlang happy.
> 
> 
> Matthias.
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 
> 

-- 
View this message in context: http://old.nabble.com/clustering-rabbitmq-using-ip-addresses-tp26765353p26770022.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From matthias at lshift.net  Mon Dec 14 09:28:29 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Mon, 14 Dec 2009 09:28:29 +0000
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <26770022.post@talk.nabble.com>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com>
Message-ID: <4B26053D.1010801@lshift.net>

bido wrote:
> I am wondering why i cannot use rabbit at 192.168.1.3 as nodename for example
> ??

To do that you need to change the various rabbit scripts to use "long 
names" instead of "short names" by replacing the "-sname" flag with "-name".


Matthias.



From matthew at lshift.net  Mon Dec 14 10:30:55 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Mon, 14 Dec 2009 10:30:55 +0000
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <4B26053D.1010801@lshift.net>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com> <4B26053D.1010801@lshift.net>
Message-ID: <20091214103054.GA12724@mrnibble.lshift.net>

On Mon, Dec 14, 2009 at 09:28:29AM +0000, Matthias Radestock wrote:
> bido wrote:
> > I am wondering why i cannot use rabbit at 192.168.1.3 as nodename for example
> > ??
> 
> To do that you need to change the various rabbit scripts to use "long 
> names" instead of "short names" by replacing the "-sname" flag with "-name".

There are previous posts on this list how to do this. It's slightly
involved at the moment and not entirely straight forward. This would
indeed allow you to have a node name of rabbit at 192.168.3.2 or whatever,
but as I've said, I've not tested this in a clustered setup and I'm not
100% sure it'll help. To start with, you'll need to edit the
rabbitmq-multi, rabbitmq-server and rabbitmqctl shell scripts (assuming
you're on a unix of some sort) and replace all occurrences of -sname
with -name. You'll also need to be using the latest on our default
branch otherwise you'll likely end up with rabbit.192.168.3.2 at localhost
or somesuch.

It's quite likely that getting your DNS or hosts sorted out will be the
easier route.

Matthew



From ahussein.abdelrahman at gmail.com  Mon Dec 14 13:47:06 2009
From: ahussein.abdelrahman at gmail.com (bido)
Date: Mon, 14 Dec 2009 05:47:06 -0800 (PST)
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <20091214103054.GA12724@mrnibble.lshift.net>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com> <4B26053D.1010801@lshift.net>
	<20091214103054.GA12724@mrnibble.lshift.net>
Message-ID: <26778000.post@talk.nabble.com>


Hello all,
First of all, thank you all for you quick response it was really helpful
Here is the result of my test:
With the latest code from mercurial and using -name instead of -sname in all
the occurrences(rabbitmq-server/rabbitmqctl/rabbitmq-multi...) i can use
rabbit at ipadress as the node name and i can use that node name to join a
cluster.

Regards,
Abdelrahaman
 

Matthew Sackman wrote:
> 
> On Mon, Dec 14, 2009 at 09:28:29AM +0000, Matthias Radestock wrote:
>> bido wrote:
>> > I am wondering why i cannot use rabbit at 192.168.1.3 as nodename for
>> example
>> > ??
>> 
>> To do that you need to change the various rabbit scripts to use "long 
>> names" instead of "short names" by replacing the "-sname" flag with
>> "-name".
> 
> There are previous posts on this list how to do this. It's slightly
> involved at the moment and not entirely straight forward. This would
> indeed allow you to have a node name of rabbit at 192.168.3.2 or whatever,
> but as I've said, I've not tested this in a clustered setup and I'm not
> 100% sure it'll help. To start with, you'll need to edit the
> rabbitmq-multi, rabbitmq-server and rabbitmqctl shell scripts (assuming
> you're on a unix of some sort) and replace all occurrences of -sname
> with -name. You'll also need to be using the latest on our default
> branch otherwise you'll likely end up with rabbit.192.168.3.2 at localhost
> or somesuch.
> 
> It's quite likely that getting your DNS or hosts sorted out will be the
> easier route.
> 
> Matthew
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 
> 

-- 
View this message in context: http://old.nabble.com/clustering-rabbitmq-using-ip-addresses-tp26765353p26778000.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From matthew at lshift.net  Mon Dec 14 14:29:47 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Mon, 14 Dec 2009 14:29:47 +0000
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <26778000.post@talk.nabble.com>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com> <4B26053D.1010801@lshift.net>
	<20091214103054.GA12724@mrnibble.lshift.net>
	<26778000.post@talk.nabble.com>
Message-ID: <20091214142947.GB12724@mrnibble.lshift.net>

Hi,

On Mon, Dec 14, 2009 at 05:47:06AM -0800, bido wrote:
> First of all, thank you all for you quick response it was really helpful
> Here is the result of my test:
> With the latest code from mercurial and using -name instead of -sname in all
> the occurrences(rabbitmq-server/rabbitmqctl/rabbitmq-multi...) i can use
> rabbit at ipadress as the node name and i can use that node name to join a
> cluster.

That's good to hear. Thanks for letting us know, and I'm glad it works
for you.

Matthew



From alexis.richardson at gmail.com  Mon Dec 14 15:01:26 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Mon, 14 Dec 2009 15:01:26 +0000
Subject: [rabbitmq-discuss] rejected.py 0.2 released
In-Reply-To: <af1bce590912131159j31bb3797x42d862974022b755@mail.gmail.com>
References: <af1bce590912131159j31bb3797x42d862974022b755@mail.gmail.com>
Message-ID: <167204d20912140701m919b90aj18604d8196be47f4@mail.gmail.com>

Thanks very much Gavin.



On Sun, Dec 13, 2009 at 7:59 PM, Gavin M. Roy <gmr at myyearbook.com> wrote:

> I've just bundled up rejected 0.2 and uploaded it to Github:
>
> http://cloud.github.com/downloads/gmr/rejected.py/rejected-0.2.tar.bz2
>
>  rejected.py is a python based multi-threaded consumer daemon and
> framework for RabbitMQ
>
> Features include:
>
>    - Multithreaded consumer daemon, core application manages connections
>    - Elastic threading based upon demand when using Alice
>    - Safety mechanism to auto-unsubscribe consumers when encountering
>    errors
>    - Message rate limiting / throttling
>    - Allows for multiple brokers per binding and multiple bindings per
>    instance
>
> Thanks to Shane Caraveo and Brian Jones for updates, advice and patches.
>
> Regards,
>
> Gavin
>
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091214/3bfcbd18/attachment.htm 

From rborkowski at ideeli.com  Mon Dec 14 22:13:02 2009
From: rborkowski at ideeli.com (Robert Borkowski)
Date: Mon, 14 Dec 2009 17:13:02 -0500
Subject: [rabbitmq-discuss] Cluster failover behaviour
Message-ID: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>

Hi,

Can you please help me understand what is going on when I lose a member of a
cluster?
I'm seeing an odd behaviour that makes me worry. This queue is supposed to
hold
credit card transactions, so we _really_ want to avoid double-processing
messages.

Cluster consists of 2 members: (rabbit at mq1, rabbit at mq2).

1) client connects to mq1, creates durable queue, pushes 100 persistent
messages in
    root at mq1:~# rabbitmqctl list_queues
    Listing queues ...
    testqueue       100
    ...done.

2) mq1 rabbitmq is stopped

3) client connects to mq2, creates durable queue, pushes 100 persistent
messages in
    root at mq2:~# rabbitmqctl list_queues
    Listing queues ...
    testqueue       100
    ...done.

4) mq1 rabbitmq is started
    root at mq2:~# rabbitmqctl list_queues
    Listing queues ...
    testqueue       200
    ...done.

5) client drains the queue
    rborkows at mq1:~/client/bunny$ ./bunny-subscriber
    Drained 200 messages in 0.475371 seconds

6) queue is now empty
    root at mq2:~# rabbitmqctl list_queues
    Listing queues ...
    testqueue       0
    ...done.

7) mq1 rabbitmq is restarted, 100 credit card transactions pop back into
existence, unhappy customers, etc.
    root at mq1:~# /etc/init.d/rabbitmq-server restart
    Restarting rabbitmq-server: SUCCESS
    rabbitmq-server.
    root at mq1:~# rabbitmqctl list_queues
    Listing queues ...
    testqueue       100
    ...done.

The expected behaviour is that after step 5 the messages are _gone_ from the
queue, never to be seen again.
What's going on here?

-- 
Robert Borkowski
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091214/8159bc19/attachment.htm 

From b at b3k.us  Mon Dec 14 22:34:45 2009
From: b at b3k.us (Benjamin Black)
Date: Mon, 14 Dec 2009 14:34:45 -0800
Subject: [rabbitmq-discuss] Cluster failover behaviour
In-Reply-To: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>
References: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>
Message-ID: <4B26BD85.3070501@b3k.us>

I apologize for not answering your Rabbit question.  What you are
describing is why you need an application-layer notion of idempotence.
It is at best frustrating and at worst dangerous to rely on a lower
level component, especially one written by someone else without this
exact use case in mind, to implement and enforce this sort of policy.


Best of luck,
b

On 12/14/09 2:13 PM, Robert Borkowski wrote:
> Hi,
> 
> Can you please help me understand what is going on when I lose a member of a
> cluster?
> I'm seeing an odd behaviour that makes me worry. This queue is supposed to
> hold
> credit card transactions, so we _really_ want to avoid double-processing
> messages.
> 
> Cluster consists of 2 members: (rabbit at mq1, rabbit at mq2).
> 
> 1) client connects to mq1, creates durable queue, pushes 100 persistent
> messages in
>     root at mq1:~# rabbitmqctl list_queues
>     Listing queues ...
>     testqueue       100
>     ...done.
> 
> 2) mq1 rabbitmq is stopped
> 
> 3) client connects to mq2, creates durable queue, pushes 100 persistent
> messages in
>     root at mq2:~# rabbitmqctl list_queues
>     Listing queues ...
>     testqueue       100
>     ...done.
> 
> 4) mq1 rabbitmq is started
>     root at mq2:~# rabbitmqctl list_queues
>     Listing queues ...
>     testqueue       200
>     ...done.
> 
> 5) client drains the queue
>     rborkows at mq1:~/client/bunny$ ./bunny-subscriber
>     Drained 200 messages in 0.475371 seconds
> 
> 6) queue is now empty
>     root at mq2:~# rabbitmqctl list_queues
>     Listing queues ...
>     testqueue       0
>     ...done.
> 
> 7) mq1 rabbitmq is restarted, 100 credit card transactions pop back into
> existence, unhappy customers, etc.
>     root at mq1:~# /etc/init.d/rabbitmq-server restart
>     Restarting rabbitmq-server: SUCCESS
>     rabbitmq-server.
>     root at mq1:~# rabbitmqctl list_queues
>     Listing queues ...
>     testqueue       100
>     ...done.
> 
> The expected behaviour is that after step 5 the messages are _gone_ from the
> queue, never to be seen again.
> What's going on here?
> 
> 
> 
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 550 bytes
Desc: OpenPGP digital signature
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091214/e1237238/attachment.pgp 

From rborkowski at ideeli.com  Mon Dec 14 22:57:03 2009
From: rborkowski at ideeli.com (Robert Borkowski)
Date: Mon, 14 Dec 2009 17:57:03 -0500
Subject: [rabbitmq-discuss] Cluster failover behaviour
In-Reply-To: <4B26BD85.3070501@b3k.us>
References: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>
	<4B26BD85.3070501@b3k.us>
Message-ID: <8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>

Agreed, and that's why I'm testing failure scenarios.

It would be nice to not to have to re-invent the wheel :-)

Isn't this a somewhat common use-case? A work queue filled with
tasks that can only be run once, running on real hardware which
means that at some point parts of the system WILL fail.

--
Robert Borkowski

On Mon, Dec 14, 2009 at 5:34 PM, Benjamin Black <b at b3k.us> wrote:

> I apologize for not answering your Rabbit question.  What you are
> describing is why you need an application-layer notion of idempotence.
> It is at best frustrating and at worst dangerous to rely on a lower
> level component, especially one written by someone else without this
> exact use case in mind, to implement and enforce this sort of policy.
>
>
> Best of luck,
> b
>
> On 12/14/09 2:13 PM, Robert Borkowski wrote:
> > Hi,
> >
> > Can you please help me understand what is going on when I lose a member
> of a
> > cluster?
> > I'm seeing an odd behaviour that makes me worry. This queue is supposed
> to
> > hold
> > credit card transactions, so we _really_ want to avoid double-processing
> > messages.
> >
> > Cluster consists of 2 members: (rabbit at mq1, rabbit at mq2).
> >
> > 1) client connects to mq1, creates durable queue, pushes 100 persistent
> > messages in
> >     root at mq1:~# rabbitmqctl list_queues
> >     Listing queues ...
> >     testqueue       100
> >     ...done.
> >
> > 2) mq1 rabbitmq is stopped
> >
> > 3) client connects to mq2, creates durable queue, pushes 100 persistent
> > messages in
> >     root at mq2:~# rabbitmqctl list_queues
> >     Listing queues ...
> >     testqueue       100
> >     ...done.
> >
> > 4) mq1 rabbitmq is started
> >     root at mq2:~# rabbitmqctl list_queues
> >     Listing queues ...
> >     testqueue       200
> >     ...done.
> >
> > 5) client drains the queue
> >     rborkows at mq1:~/client/bunny$ ./bunny-subscriber
> >     Drained 200 messages in 0.475371 seconds
> >
> > 6) queue is now empty
> >     root at mq2:~# rabbitmqctl list_queues
> >     Listing queues ...
> >     testqueue       0
> >     ...done.
> >
> > 7) mq1 rabbitmq is restarted, 100 credit card transactions pop back into
> > existence, unhappy customers, etc.
> >     root at mq1:~# /etc/init.d/rabbitmq-server restart
> >     Restarting rabbitmq-server: SUCCESS
> >     rabbitmq-server.
> >     root at mq1:~# rabbitmqctl list_queues
> >     Listing queues ...
> >     testqueue       100
> >     ...done.
> >
> > The expected behaviour is that after step 5 the messages are _gone_ from
> the
> > queue, never to be seen again.
> > What's going on here?
> >
> >
> >
> >
> > _______________________________________________
> > rabbitmq-discuss mailing list
> > rabbitmq-discuss at lists.rabbitmq.com
> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091214/94810b2d/attachment.htm 

From b at b3k.us  Mon Dec 14 23:27:18 2009
From: b at b3k.us (Benjamin Black)
Date: Mon, 14 Dec 2009 15:27:18 -0800
Subject: [rabbitmq-discuss] Cluster failover behaviour
In-Reply-To: <8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>
References: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>	
	<4B26BD85.3070501@b3k.us>
	<8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>
Message-ID: <4B26C9D6.2020906@b3k.us>

On 12/14/09 2:57 PM, Robert Borkowski wrote:
> Agreed, and that's why I'm testing failure scenarios.
> 
> It would be nice to not to have to re-invent the wheel :-)
> 
> Isn't this a somewhat common use-case? A work queue filled with
> tasks that can only be run once, running on real hardware which
> means that at some point parts of the system WILL fail.
> 

No doubt, great candidate for a plugin.  Not something appropriate for
core of Rabbit, imo.


b


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 550 bytes
Desc: OpenPGP digital signature
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091214/aad05242/attachment.pgp 

From matthias at lshift.net  Mon Dec 14 23:29:51 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Mon, 14 Dec 2009 23:29:51 +0000
Subject: [rabbitmq-discuss] Cluster failover behaviour
In-Reply-To: <8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>
References: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>	<4B26BD85.3070501@b3k.us>
	<8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>
Message-ID: <4B26CA6F.8000305@lshift.net>

Robert Borkowski wrote:
> Agreed, and that's why I'm testing failure scenarios.
> 
> It would be nice to not to have to re-invent the wheel :-)
> 
> Isn't this a somewhat common use-case? A work queue filled with
> tasks that can only be run once, running on real hardware which
> means that at some point parts of the system WILL fail.

"at-least once" and "at-most once" execution are quite easy to do. 
"exactly once" is generally impossible. In case that is not obvious, 
think about what precisely it is that you want to happen exactly once. 
Then try to figure out how you'd perform that action *and record the 
fact that it has happened* in one atomic action.

By far the easiest way to get around that is to make the desired action 
idempotent. Then it is sufficient to guarantee "at-least once" 
execution, which is easy to do in AMQP by ack'ing messages after the 
actions that they trigger have been completed.


Regards,

Matthias.



From rborkowski at ideeli.com  Mon Dec 14 23:33:03 2009
From: rborkowski at ideeli.com (Robert Borkowski)
Date: Mon, 14 Dec 2009 18:33:03 -0500
Subject: [rabbitmq-discuss] Cluster failover behaviour
In-Reply-To: <4B26CA6F.8000305@lshift.net>
References: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>
	<4B26BD85.3070501@b3k.us>
	<8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>
	<4B26CA6F.8000305@lshift.net>
Message-ID: <8644f17a0912141533w3d0a4c93tedcfdd69617f095a@mail.gmail.com>

So what is going on in my test case?

I restart rabbitmq and I suddenly have a bunch of old messages in the queue.
Surely that's not expected

--
Robert Borkowski

On Mon, Dec 14, 2009 at 6:29 PM, Matthias Radestock <matthias at lshift.net>wrote:

> Robert Borkowski wrote:
>
>> Agreed, and that's why I'm testing failure scenarios.
>>
>> It would be nice to not to have to re-invent the wheel :-)
>>
>> Isn't this a somewhat common use-case? A work queue filled with
>> tasks that can only be run once, running on real hardware which
>> means that at some point parts of the system WILL fail.
>>
>
> "at-least once" and "at-most once" execution are quite easy to do. "exactly
> once" is generally impossible. In case that is not obvious, think about what
> precisely it is that you want to happen exactly once. Then try to figure out
> how you'd perform that action *and record the fact that it has happened* in
> one atomic action.
>
> By far the easiest way to get around that is to make the desired action
> idempotent. Then it is sufficient to guarantee "at-least once" execution,
> which is easy to do in AMQP by ack'ing messages after the actions that they
> trigger have been completed.
>
>
> Regards,
>
> Matthias.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091214/684cb7c8/attachment.htm 

From matthias at lshift.net  Tue Dec 15 00:23:00 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Tue, 15 Dec 2009 00:23:00 +0000
Subject: [rabbitmq-discuss] Cluster failover behaviour
In-Reply-To: <8644f17a0912141533w3d0a4c93tedcfdd69617f095a@mail.gmail.com>
References: <8644f17a0912141413x2fa08df2n491586c611510230@mail.gmail.com>	
	<4B26BD85.3070501@b3k.us>	
	<8644f17a0912141457g54b2bbedi3b7ae52627fbe667@mail.gmail.com>	
	<4B26CA6F.8000305@lshift.net>
	<8644f17a0912141533w3d0a4c93tedcfdd69617f095a@mail.gmail.com>
Message-ID: <4B26D6E4.7010803@lshift.net>

Robert,

Robert Borkowski wrote:
> So what is going on in my test case?
> 
> I restart rabbitmq and I suddenly have a bunch of old messages in the 
> queue. Surely that's not expected

Things actually went wrong way before then, namely when the client 
created a queue with the same name on mq2. Rabbit is a bit schizophrenic 
as to whether it considers that queue to be the same queue or a 
different queue.

That is something we've known about for a while. See, for example, Jason 
William's post and my follow-up at 
http://old.nabble.com/Clustering-Question-td23888965.html#a23932367

What I didn't realise then is that the acknowledgements for the messages 
from the queue on the first node will go astray, which is why those 
message pop up again when that node is restarted. That clearly is 
perplexing, so I have raised the priority of this bug in our issue tracker.


Regards,

Matthias.



From ahussein.abdelrahman at gmail.com  Tue Dec 15 09:44:38 2009
From: ahussein.abdelrahman at gmail.com (bido)
Date: Tue, 15 Dec 2009 01:44:38 -0800 (PST)
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <20091214142947.GB12724@mrnibble.lshift.net>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com> <4B26053D.1010801@lshift.net>
	<20091214103054.GA12724@mrnibble.lshift.net>
	<26778000.post@talk.nabble.com>
	<20091214142947.GB12724@mrnibble.lshift.net>
Message-ID: <26792126.post@talk.nabble.com>


Hi, one last question, do you know what is the version of the server this
feature will be available ? wanna document this on my side.

Regards,
Abdelrahman


Matthew Sackman wrote:
> 
> Hi,
> 
> On Mon, Dec 14, 2009 at 05:47:06AM -0800, bido wrote:
>> First of all, thank you all for you quick response it was really helpful
>> Here is the result of my test:
>> With the latest code from mercurial and using -name instead of -sname in
>> all
>> the occurrences(rabbitmq-server/rabbitmqctl/rabbitmq-multi...) i can use
>> rabbit at ipadress as the node name and i can use that node name to join a
>> cluster.
> 
> That's good to hear. Thanks for letting us know, and I'm glad it works
> for you.
> 
> Matthew
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 
> 

-- 
View this message in context: http://old.nabble.com/clustering-rabbitmq-using-ip-addresses-tp26765353p26792126.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From matthew at lshift.net  Tue Dec 15 10:27:40 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Tue, 15 Dec 2009 10:27:40 +0000
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <26792126.post@talk.nabble.com>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com> <4B26053D.1010801@lshift.net>
	<20091214103054.GA12724@mrnibble.lshift.net>
	<26778000.post@talk.nabble.com>
	<20091214142947.GB12724@mrnibble.lshift.net>
	<26792126.post@talk.nabble.com>
Message-ID: <20091215102740.GD12724@mrnibble.lshift.net>

Hi,

On Tue, Dec 15, 2009 at 01:44:38AM -0800, bido wrote:
> Hi, one last question, do you know what is the version of the server this
> feature will be available ? wanna document this on my side.

Well it's unlikely that we'll switch to using -name over -sname. Using
-sname has its own advantages though as you've found doesn't work in all
cases, so it's likely you'll still have to do some editing, though we
could somehow work it into a config file.

The general fixes that allow you to use an IP address as the nodename,
when using -name will appear in the next stable release. That'll either
be 1.7.1 or 1.8. It's very likely 1.7.1 will happen, but there's a small
chance we'll jump right to 1.8. It depends on when various things get
through QA.

Matthew



From ahussein.abdelrahman at gmail.com  Tue Dec 15 10:35:18 2009
From: ahussein.abdelrahman at gmail.com (bido)
Date: Tue, 15 Dec 2009 02:35:18 -0800 (PST)
Subject: [rabbitmq-discuss] clustering rabbitmq using ip addresses
In-Reply-To: <20091215102740.GD12724@mrnibble.lshift.net>
References: <26765353.post@talk.nabble.com> <4B2547F5.708@lshift.net>
	<26770022.post@talk.nabble.com> <4B26053D.1010801@lshift.net>
	<20091214103054.GA12724@mrnibble.lshift.net>
	<26778000.post@talk.nabble.com>
	<20091214142947.GB12724@mrnibble.lshift.net>
	<26792126.post@talk.nabble.com>
	<20091215102740.GD12724@mrnibble.lshift.net>
Message-ID: <26792682.post@talk.nabble.com>


thnx

Matthew Sackman wrote:
> 
> Hi,
> 
> On Tue, Dec 15, 2009 at 01:44:38AM -0800, bido wrote:
>> Hi, one last question, do you know what is the version of the server this
>> feature will be available ? wanna document this on my side.
> 
> Well it's unlikely that we'll switch to using -name over -sname. Using
> -sname has its own advantages though as you've found doesn't work in all
> cases, so it's likely you'll still have to do some editing, though we
> could somehow work it into a config file.
> 
> The general fixes that allow you to use an IP address as the nodename,
> when using -name will appear in the next stable release. That'll either
> be 1.7.1 or 1.8. It's very likely 1.7.1 will happen, but there's a small
> chance we'll jump right to 1.8. It depends on when various things get
> through QA.
> 
> Matthew
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 
> 

-- 
View this message in context: http://old.nabble.com/clustering-rabbitmq-using-ip-addresses-tp26765353p26792682.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From msteele at beringmedia.com  Tue Dec 15 16:38:22 2009
From: msteele at beringmedia.com (Mark Steele)
Date: Tue, 15 Dec 2009 11:38:22 -0500
Subject: [rabbitmq-discuss] TCP/SSL Listeners stuck, not responding
Message-ID: <aa3794b0912150838h3e622b2bn7e9144cfb731248d@mail.gmail.com>

Hi folks,

I'm trying to troubleshoot an issue I'm having. For unknown reasons
after a certain amount of time the SSL listener just seems to stop
working. The logs have:

=ERROR REPORT==== 15-Dec-2009::09:31:00 ===
Error in process <0.55.0> on node 'rabbit at d1750-1' with exit value:
{{badmatch,{error,system_limit}},[{cpu_sup,get_uint32_measurement,2},{cpu_sup,measurement_server_loop,1}]}

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.19037.10> from 1.2.3.4:44437

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.18940.10> from 1.2.3.4:44433

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.18962.10> from 1.2.3.4:44434

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.19156.10> from 1.2.3.4:44442

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.19178.10> from 1.2.3.4:44443

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.19059.10> from 1.2.3.4:44438

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.19081.10> from 1.2.3.4:44439

=INFO REPORT==== 15-Dec-2009::09:31:00 ===
closing TCP connection <0.19245.10> from 1.2.3.4:44446
<snip>

# cat /etc/rabbitmq/rabbitmq.conf
SERVER_START_ARGS='-rabbit ssl_listeners [{"2.3.4.5",9000}] -rabbit
ssl_options [{cacertfile,"/etc/rabbitmq/ca.crt"},{certfile,"/etc/rabbitmq/cert.crt"},{keyfile,"/etc/rabbitmq/cert.key"},{fail_if_no_peer_cert,true}]'
NODE_IP_ADDRESS=127.0.0.1
CONSOLE_LOG=reuse

# netstat -nlp
Proto Recv-Q Send-Q Local Address ? ? ? ? ? Foreign Address
State ? ? ? PID/Program name
tcp ? ? ? ?3 ? ? ?0 2.3.4.5:9000 ? ? ? 0.0.0.0:* ? ? ? ? ? ? ? LISTEN
 ? ?7943/beam.smp
tcp??????? 0????? 0 127.0.0.1:5672????????? 0.0.0.0:*
LISTEN????? 7943/beam.smp
tcp??????? 0????? 0 0.0.0.0:54160?????????? 0.0.0.0:*
LISTEN????? 7943/beam.smp
tcp??????? 0????? 0 0.0.0.0:4369??????????? 0.0.0.0:*
LISTEN????? 11107/epmd
<snip>

Looking at what's going on with strace doesn't seem to help either:

# strace -p 7943
Process 7943 attached - interrupt to quit
select(0, NULL, NULL, NULL, NULL
<no more output, stuck here>

# tcpdump 'tcp src port 9000 and (((ip[2:2] - ((ip[0]&0xf)<<2)) -
((tcp[12]&0xf0)>>2)) != 0)' -A -s 0 -vv -i eth1
tcpdump: listening on eth1, link-type EN10MB (Ethernet), capture size
65535 bytes
^C <no output...>
0 packets captured
0 packets received by filter
0 packets dropped by kernel


# tcpdump 'tcp dst port 9000 and (((ip[2:2] - ((ip[0]&0xf)<<2)) -
((tcp[12]&0xf0)>>2)) != 0)' -A -s 0 -vv -i eth1
tcpdump: listening on eth1, link-type EN10MB (Ethernet), capture size
65535 bytes
11:06:54.496422 IP (tos 0x0, ttl 50, id 61746, offset 0, flags [DF],
proto TCP (6), length 113)
    68.230.240.91.58871 > 208.94.50.28.9000: Flags [P.], cksum 0x4897
(correct), seq 620713031:620713092, ack 967624400, win 114, options
[nop,nop,TS val 69409028 ecr 404972440], length 61
<snip, lots of output>
..s7..B..')8.p..>b.O...Vd............Y.3WT....I.&C...Q....:c....g'...$........4.....
................}.s........Z.pp.h.7..D.J..,..s
....c.b6<U...73oB.W...H.E.A.....$P..S..E.]...6!j...[D....I.2......o1.>.
^C
5 packets captured
5 packets received by filter
0 packets dropped by kernel

There are clients trying to connect to the server, and there is no
response being sent to the clients.

However when I connect to the localhost (non-ssl) interface, it works fine.

# erl -version
Erlang (SMP,ASYNC_THREADS,HIPE) (BEAM) emulator version 5.7.4

# rabbitmqctl status
Status of node 'rabbit at d1750-1' ...
[{running_applications,[{rabbit,"RabbitMQ","1.7.0"},
                        {ssl,"Erlang/OTP SSL application","3.10.7"},
                        {crypto,"CRYPTO version 1","1.6.3"},
                        {mnesia,"MNESIA  CXC 138 12","4.4.12"},
                        {os_mon,"CPO  CXC 138 46","2.2.4"},
                        {sasl,"SASL  CXC 138 11","2.1.8"},
                        {stdlib,"ERTS  CXC 138 10","1.16.4"},
                        {kernel,"ERTS  CXC 138 10","2.13.4"}]},
 {nodes,['rabbit at d1750-1']},
 {running_nodes,['rabbit at d1750-1']}]
...done.

# openssl
OpenSSL> version
OpenSSL 0.9.8l 5 Nov 2009

# uname -a
Linux D1750-1 2.6.31-gentoo-r6 #1 SMP Thu Nov 26 16:30:46 EST 2009
i686 Intel(R) Xeon(TM) CPU 3.20GHz GenuineIntel GNU/Linux

We're running this on Gentoo and have tried various combinations of
compile time options (without hipe, without SMP, without kpoll) with
the same results.

Does anyone have an idea on how we can go about to troubleshoot this?
The amount of time it stays up appears to be random (sometimes hours,
sometime minutes). I'm guessing it's SSL related otherwise I'd imagine
it would have been caught by other users already.

When it does crash, I get this on the console:

Erlang has closed

Cheers,

--
Mark Steele
Director of development
Bering Media Inc.



From michael.justin at gmx.net  Wed Dec 16 16:05:06 2009
From: michael.justin at gmx.net (mjustin)
Date: Wed, 16 Dec 2009 08:05:06 -0800 (PST)
Subject: [rabbitmq-discuss] RabbitMQ/Stomp on Windows
In-Reply-To: <4B13ABA1.7000806@lshift.net>
References: <4B0E41CD.6020909@gmx.net> <4B13ABA1.7000806@lshift.net>
Message-ID: <26813626.post@talk.nabble.com>


Hello Matthias,

many thanks for the link. I understand that I have to create a new
configuration file on Windows and add the required parameters.

If I start RabbitMQ (on Ubuntu), the startup script (makefile) seems to pass
parameters and logs then to the console. I am not sure what the
configuration file should look like, I have only the output of the startup

make: Entering directory
`/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-stomp'
make -C ../rabbitmq-server run \
		RABBITMQ_SERVER_START_ARGS='-pa '"$(pwd)/ebin"' -rabbit \
			stomp_listeners [{\"10.0.2.15\",61613}] \
			extra_startup_steps [{\"STOMP-listeners\",rabbit_stomp,kickstart,[]}]'
make[1]: Entering directory
`/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-server'
RABBITMQ_NODE_IP_ADDRESS="" RABBITMQ_NODE_PORT="" RABBITMQ_LOG_BASE="/tmp"
RABBITMQ_MNESIA_DIR="/tmp/rabbitmq-rabbit-mnesia" \
		RABBITMQ_NODE_ONLY=true \
		RABBITMQ_SERVER_START_ARGS="-pa
/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-stomp/ebin -rabbit \
		stomp_listeners [{\"10.0.2.15\",61613}] \
		extra_startup_steps [{\"STOMP-listeners\",rabbit_stomp,kickstart,[]}] -s
rabbit" \
		./scripts/rabbitmq-server


I guess it is something like this:

  [
    {rabbit, 
	[{stomp_listeners [{"10.0.2.15",61613}]},
	  extra_startup_steps [{"STOMP-listeners",	  rabbit_stomp,kickstart}]}
             ]}
  ].

However, the server startup fails with 

"{"could not start kernel pid",application_controller,"error in config file
\"c:/
Users/mj/AppData/Roaming/RabbitMQ/rabbitmq.config\" (3): syntax error
before: '[
'"}"

So I guess the file contains a syntax error.

How will the server find the stomp adapter, can I just place the
rabbitmq-stomp folder (copied from the Ubuntu box) in the parent folder of
rabbitmq_server-1.7.0 on the windows box?

Many thanks in advance,
Michael Justin



Matthias Radestock-2 wrote:
> 
> Michael,
> 
> Michael Justin wrote:
>> is it possible to transfer the compiled code of the Stomp adapter to a 
>> Windows box,
> 
> Yes, as long as the version of Erlang you are running on the Windows box 
> is the same or more recent than the one where you did the compilation.
> 
>> and modify the startup script for the the Windows  distribution so
>> that it uses the Stomp adapter?
> 
> There is no need to modify any startup scripts; the required 
> configuration for the stomp plug-in can be added to the configuration 
> file - see http://www.rabbitmq.com/install.html#configfile.
> 
> 
> Regards,
> 
> Matthias.
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> 
> 


-----
Michael Justin
SCJP, SCJA
betasoft - Software for Delphi? and for the Java? platform
http://www.mikejustin.com - http://www.betabeans.de
-- 
View this message in context: http://old.nabble.com/RabbitMQ-Stomp-on-Windows-tp26526258p26813626.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From matthias at lshift.net  Wed Dec 16 16:43:57 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Wed, 16 Dec 2009 16:43:57 +0000
Subject: [rabbitmq-discuss] TCP/SSL Listeners stuck, not responding
In-Reply-To: <aa3794b0912150838h3e622b2bn7e9144cfb731248d@mail.gmail.com>
References: <aa3794b0912150838h3e622b2bn7e9144cfb731248d@mail.gmail.com>
Message-ID: <4B290E4D.5030502@lshift.net>

Mark,

Mark Steele wrote:
> For unknown reasons after a certain amount of time the SSL listener
> just seems to stop working.

In what way does it "stop working"? Does the ssl port refuse 
connections? Or can you connect but then the ssl negotiation fails? Or 
does all the connection establishment work fine but then the connection 
gets dropped at some later point?


Regards,

Matthias.



From msteele at beringmedia.com  Wed Dec 16 18:35:37 2009
From: msteele at beringmedia.com (Mark Steele)
Date: Wed, 16 Dec 2009 13:35:37 -0500
Subject: [rabbitmq-discuss] TCP/SSL Listeners stuck, not responding
In-Reply-To: <4B290E4D.5030502@lshift.net>
References: <aa3794b0912150838h3e622b2bn7e9144cfb731248d@mail.gmail.com> 
	<4B290E4D.5030502@lshift.net>
Message-ID: <aa3794b0912161035m5cc98c97ydd21dd8449683ea0@mail.gmail.com>

Hi Matthias,

By stop working:
 - SSL port is still open (see netstat output from previous email)
 - SSL client sending data to the server (see tcpdump output from
previous email)
 - Rabbit/erlang is not responding with any data (see tcpdump/strace
output from previous email)

It appears like the three-way TCP handshake works, then nothing...

I've got a erl crash dump if that would help.

Regards,

Mark

On Wed, Dec 16, 2009 at 11:43 AM, Matthias Radestock
<matthias at lshift.net> wrote:
> Mark,
>
> Mark Steele wrote:
>>
>> For unknown reasons after a certain amount of time the SSL listener
>> just seems to stop working.
>
> In what way does it "stop working"? Does the ssl port refuse connections? Or
> can you connect but then the ssl negotiation fails? Or does all the
> connection establishment work fine but then the connection gets dropped at
> some later point?
>
>
> Regards,
>
> Matthias.
>



From matthias at lshift.net  Wed Dec 16 23:28:56 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Wed, 16 Dec 2009 23:28:56 +0000
Subject: [rabbitmq-discuss] TCP/SSL Listeners stuck, not responding
In-Reply-To: <aa3794b0912161035m5cc98c97ydd21dd8449683ea0@mail.gmail.com>
References: <aa3794b0912150838h3e622b2bn7e9144cfb731248d@mail.gmail.com>
	<4B290E4D.5030502@lshift.net>
	<aa3794b0912161035m5cc98c97ydd21dd8449683ea0@mail.gmail.com>
Message-ID: <4B296D38.50908@lshift.net>

Mark,

Mark Steele wrote:
> By stop working:
>  - SSL port is still open (see netstat output from previous email)
>  - SSL client sending data to the server (see tcpdump output from
> previous email)
>  - Rabbit/erlang is not responding with any data (see tcpdump/strace
> output from previous email)
> 
> It appears like the three-way TCP handshake works, then nothing...

We recently fixed a bug in the ssl acceptor code that could cause it to 
block, i.e. a client could still connect to the port but nothing would 
happen. That seems to match your symptoms.

So, if you can, please try the most recent 'default' branch of the 
server from our mercurial repository.


Regards,

Matthias.



From matthew at lshift.net  Thu Dec 17 11:32:21 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Thu, 17 Dec 2009 11:32:21 +0000
Subject: [rabbitmq-discuss] is it possible to have broker listen on
 multiple ports
In-Reply-To: <4B0588A2.9030704@echostar.com>
References: <4B0588A2.9030704@echostar.com>
Message-ID: <20091217113220.GA3870@mrnibble.lshift.net>

Hi Mark,

On Thu, Nov 19, 2009 at 11:04:18AM -0700, Mark Geib wrote:
> Is is possible to somehow configure a rabbitmq broker to listen on
> multiple network ports.
> 
> I am running 1.6 and 1.7.

Just to let you know, the bug for this has just been QA+'d and merged
into the default branch. You can now in the rabbitmq.config file have
the following:

[{rabbit,
	[{tcp_listeners, [{"myhostname", 8787}, {"my.ip.ad.dy", 7676}]}]
 }].

and variations on that theme. Make sure you *don't* have env vars set
for either RABBITMQ_NODE_IP_ADDRESS or RABBITMQ_NODE_PORT.

Note that both hostnames (or fqdns) and IP addresses need to be
"quoted".

Best wishes,

Matthew



From tonyg at lshift.net  Thu Dec 17 18:32:10 2009
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Thu, 17 Dec 2009 18:32:10 +0000
Subject: [rabbitmq-discuss] rabbitmq through firewall (rabbitmq-server
 patch)
In-Reply-To: <348bc1a20905071235n3a51a80cxfdf77bd628cbc1e1@mail.gmail.com>
References: <348bc1a20905071235n3a51a80cxfdf77bd628cbc1e1@mail.gmail.com>
Message-ID: <4B2A792A.3020704@lshift.net>

Hi Adam,

Adam Wentz wrote:
> I'm clustering rabbitmq through a firewall and made the following change
> to /usr/lib/rabbitmq/bin/rabbitmq-server so we can specify the ports
> erlang will use to do the cluster to cluster communication: [...]

Thanks for this. I've filed a bug for trying to find a good place to put
this info in the server documentation.

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] http://www.lshift.net/ | Email: tonyg at lshift.net



From wilson.ke at wealthcraft.com  Fri Dec 18 06:50:13 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Fri, 18 Dec 2009 14:50:13 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>
	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>
	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
	<4B1C8BF8.4040408@gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>

Somebody can tell me any conceivable reasons?

________________________________
From: Wilson Ke
Sent: 2009?12?7? 13:20
To: 'mabrek'
Cc: 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Below is alice log:



=INFO REPORT==== 7-Dec-2009::21:25:28 ==

Using controller: conn ('GET')



=CRASH REPORT==== 7-Dec-2009::21:25:28 ==

  crasher:

    initial call: mochiweb_socket_server:acceptor_loop/1

    pid: <0.67.0>

    registered_name: []

    exception error: no function clause matching

                     lists:map(#Fun<conn.0.81991811>,

                               {badrpc,

                                {'EXIT',

                                 {undef,

                                  [{rabbit_networking,connection_info_all,[]},

                                   {rpc,local_call,3},

                                   {conn,get,1},

                                   {rest_server,handle,2},

                                   {mochiweb_http,headers,5},

                                   {proc_lib,init_p_do_apply,3}]}}})

      in function  conn:get/1

      in call from rest_server:handle/2

      in call from mochiweb_http:headers/5

    ancestors: [mochiweb_http,rest_server,rest_server_sup,<0.58.0>,<0.57.0>]

    messages: []

    links: [<0.64.0>,#Port<0.766>]

    dictionary: []

    trap_exit: false

    status: running

    heap_size: 377

    stack_size: 24

    reductions: 861

  neighbours:



=ERROR REPORT==== 7-Dec-2009::21:25:28 ==

{mochiweb_socket_server,235,{child_error,function_clause}}





Hope the information can help you find the crash reason.



Regards,

Wilson



-----Original Message-----
From: mabrek [mailto:mabrek at gmail.com]
Sent: 2009?12?7? 13:01
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson Ke wrote:

> Hi Alexis,

>      I installed rabbitmq and alice in my linux server.

>

> When I use "curl -i http://localhost:9999/conn"  to test,It respond me

> that:

>

> curl: (52) Empty reply from server



It looks like a crash. Is there any useful information in alice log and stdout? It may contain crash report with stacktrace.



Regards,

Anton.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091218/9a2de080/attachment.htm 

From matthias at lshift.net  Fri Dec 18 09:22:05 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Fri, 18 Dec 2009 09:22:05 +0000
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>	<4B1C8BF8.4040408@gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
Message-ID: <4B2B49BD.7020108@lshift.net>

Wilson,

Wilson Ke wrote:
> =CRASH REPORT==== 7-Dec-2009::21:25:28 ==
>   crasher:
>     initial call: mochiweb_socket_server:acceptor_loop/1
>     pid: <0.67.0>
>     registered_name: []
>     exception error: no function clause matching
>                      lists:map(#Fun<conn.0.81991811>,
>                                {badrpc,
>                                 {'EXIT',
>                                  {undef,
>                                   [{rabbit_networking,connection_info_all,[]},

The above indicates that something fails to find a function in the
RabbitMQ code base. Does your rabbit installation function normally? And
what version of RabbitMQ are you running?


Matthias.



From tonyg at lshift.net  Fri Dec 18 12:06:17 2009
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Fri, 18 Dec 2009 12:06:17 +0000
Subject: [rabbitmq-discuss] [Q] fanout exchange same as direct with
 blank routing key?
In-Reply-To: <20091209121422.GH2704@mrnibble.lshift.net>
References: <DD8BA593-585F-43E4-9714-8E51C3562B3C@mac.com>
	<20091209121422.GH2704@mrnibble.lshift.net>
Message-ID: <4B2B7039.9080801@lshift.net>

Matthew Sackman wrote:
> Correct, and the greater the number of different binding keys the direct
> exchange has, the slower it will be. So if performance is important to
> you, and you can get away with using a fanout, do so.

Hmm, this shouldn't be the case; fanout exchanges query the binding
table with a pattern of (name=ExchangeName, key=_), whereas direct
exchanges query it with (name=ExchangeName, key=RoutingKey). The
internal mnesia logic and indexing should be almost identical, as should
the performance; hmm, I'll see if I can measure it this afternoon.

Tony



From tonyg at lshift.net  Fri Dec 18 12:08:33 2009
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Fri, 18 Dec 2009 12:08:33 +0000
Subject: [rabbitmq-discuss] Does a RabbitMq broker ever initiate
 connections to client ?
In-Reply-To: <4B203070.80404@echostar.com>
References: <4B203070.80404@echostar.com>
Message-ID: <4B2B70C1.9050603@lshift.net>

Hi Mark,

Plain RabbitMQ, without any plugins, doesn't open outbound sockets for
AMQP traffic. However, if you have it clustered, it will open outbound
sockets for Erlang distribution traffic. Furthermore, even in a
non-clustered setup, there will be Erlang-related localhost traffic to
epmd. Finally, some plugins (e.g. shovel) open outbound sockets to other
hosts.

Regards,
  Tony


Geib, Mark wrote:
> I am seeing some unexpected network traffic that appears to originate
> from a debian machine running an instance of rabbitmq. Can someone
> confirm a rabbitmq broker never tries to initiate any kind of tcp socket
> connection please.
> 
> Thanks,
> Mark.
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss



From wilson.ke at wealthcraft.com  Mon Dec 21 01:51:41 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 09:51:41 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <4B2B49BD.7020108@lshift.net>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>
	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>
	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
	<4B1C8BF8.4040408@gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
	<4B2B49BD.7020108@lshift.net>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>

The rabbitmq  version is 1.7.0,it can work normal.

-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net] 
Sent: 2009?12?18? 17:22
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Wilson Ke wrote:
> =CRASH REPORT==== 7-Dec-2009::21:25:28 ==
>   crasher:
>     initial call: mochiweb_socket_server:acceptor_loop/1
>     pid: <0.67.0>
>     registered_name: []
>     exception error: no function clause matching
>                      lists:map(#Fun<conn.0.81991811>,
>                                {badrpc,
>                                 {'EXIT',
>                                  {undef,
>                                   [{rabbit_networking,connection_info_all,[]},

The above indicates that something fails to find a function in the
RabbitMQ code base. Does your rabbit installation function normally? And
what version of RabbitMQ are you running?


Matthias.

From matthias at lshift.net  Mon Dec 21 07:54:09 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Mon, 21 Dec 2009 07:54:09 +0000
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>	<4B1C8BF8.4040408@gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
	<4B2B49BD.7020108@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>
Message-ID: <4B2F29A1.7040907@lshift.net>

Wilson,

Wilson Ke wrote:
> The rabbitmq  version is 1.7.0,it can work normal.

Does rabbitmqctl work too?

AFAICT from looking at the Alice code, the error would most likely be
caused by Alice connecting to an Erlang node that isn't running rabbit.

What's the name of your rabbit node, as displayed by rabbit during startup?

Have you got the RABBIT_HOST shell environment variable or 'rabbithost'
alice application environment variable set (e.g. by specifying it in
"./start.sh -alice rabbithost <host>")?


Overall this looks like a problem with Alice or your usage of it, rather
than a RabbitMQ problem. So I suggest you ask the Alice developers for help.


Regards,

Matthias.



From wilson.ke at wealthcraft.com  Mon Dec 21 08:16:37 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 16:16:37 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <4B2F29A1.7040907@lshift.net>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>
	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>
	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
	<4B1C8BF8.4040408@gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
	<4B2B49BD.7020108@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>
	<4B2F29A1.7040907@lshift.net>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C51@EXMBX01.wealthcraft.local>

I start the alice with the bellow bash command:



./start.sh -alice rabbithost "alice at centos" -setcookie "UD/8aYoam23kYFz4aWO2bA=="



And the alice can work normal

The start information as bellow:



=INFO REPORT==== 22-Dec-2009::00:12:35 ===

Starting...------------- Alice ------------

Copyright (C) 2009 Ari Lerner, Nate Murray, Michael Fairchild, CloudTeam



rabbit node : alice at centos

connected   : true

---------------------------------





=INFO REPORT==== 22-Dec-2009::00:12:35 ===

Starting mochiwebStarting mochiweb_http with 9999



=PROGRESS REPORT==== 22-Dec-2009::00:12:35 ===

          supervisor: {local,inet_gethost_native_sup}

             started: [{pid,<0.66.0>},{mfa,{inet_gethost_native,init,[[]]}}]



=PROGRESS REPORT==== 22-Dec-2009::00:12:35 ===

          supervisor: {local,kernel_safe_sup}

             started: [{pid,<0.65.0>},

                       {name,inet_gethost_native_sup},

                       {mfa,{inet_gethost_native,start_link,[]}},

                       {restart_type,temporary},

                       {shutdown,1000},

                       {child_type,worker}]



=INFO REPORT==== 22-Dec-2009::00:12:35 ===

Started mochiweb with: [9999]



=PROGRESS REPORT==== 22-Dec-2009::00:12:35 ===

          supervisor: {local,rest_server_sup}

             started: [{pid,<0.63.0>},

                       {name,the_rest_server},

                       {mfa,{rest_server,start_link,[[]]}},

                       {restart_type,permanent},

                       {shutdown,2000},

                       {child_type,worker}]



=PROGRESS REPORT==== 22-Dec-2009::00:12:35 ===

          supervisor: {<0.58.0>,alice_sup}

             started: [{pid,<0.61.0>},

                       {name,rest_server_sup},

                       {mfa,{rest_server_sup,start_link,[[]]}},

                       {restart_type,permanent},

                       {shutdown,2000},

                       {child_type,worker}]



=PROGRESS REPORT==== 22-Dec-2009::00:12:35 ===

         application: alice

          started_at: alice at centos

Eshell V5.7.3  (abort with ^G)

(alice at centos)1>



My rabbitmq work normal,the start information as bellow



node          : rabbit at centos

app descriptor: /usr/wilson/rabbitmq-server-1.7.0/scripts/../ebin/rabbit.app

home dir      : /root

cookie hash   : UD/8aYoam23kYFz4aWO2bA==

log           : /var/log/rabbitmq/rabbit.log

sasl log      : /var/log/rabbitmq/rabbit-sasl.log

database dir  : /var/lib/rabbitmq/mnesia/rabbit



starting database             ...done

starting core processes       ...done

starting recovery             ...done

starting persister            ...done

starting guid generator       ...done

starting builtin applications ...done

starting TCP listeners        ...done

starting SSL listeners        ...done





Thanks and Best Regards,

wilson









-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 15:54
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> The rabbitmq  version is 1.7.0,it can work normal.



Does rabbitmqctl work too?



AFAICT from looking at the Alice code, the error would most likely be

caused by Alice connecting to an Erlang node that isn't running rabbit.



What's the name of your rabbit node, as displayed by rabbit during startup?



Have you got the RABBIT_HOST shell environment variable or 'rabbithost'

alice application environment variable set (e.g. by specifying it in

"./start.sh -alice rabbithost <host>")?





Overall this looks like a problem with Alice or your usage of it, rather

than a RabbitMQ problem. So I suggest you ask the Alice developers for help.





Regards,



Matthias.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/fdcbbfc0/attachment.htm 

From matthias at lshift.net  Mon Dec 21 08:30:56 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Mon, 21 Dec 2009 08:30:56 +0000
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C51@EXMBX01.wealthcraft.local>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>	<4B1C8BF8.4040408@gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
	<4B2B49BD.7020108@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>
	<4B2F29A1.7040907@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C51@EXMBX01.wealthcraft.local>
Message-ID: <4B2F3240.3070204@lshift.net>

Wilson,

Wilson Ke wrote:
> *My rabbitmq work normal,the start information as bellow*
> node          : rabbit at centos

In that case ...

> ./start.sh -alice rabbithost "alice at centos" -setcookie 
> "UD/8aYoam23kYFz4aWO2bA=="

the above should say "rabbit at centos".

Also, the cookie information is wrong; you set it to what rabbit
displays here:

> cookie hash   : UD/8aYoam23kYFz4aWO2bA==

but that is the *hash* of the cookie, not the cookie itself. You can
find the cookie in rabbit's home dir under .erlang.cookie, e.g. given

> home dir      : /root

the cookie should be in /root/.erlang.cookie. The contents of that file
should be supplied to -setcookie.


Regards,

Matthias



From wilson.ke at wealthcraft.com  Mon Dec 21 09:23:41 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 17:23:41 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <4B2F3240.3070204@lshift.net>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>
	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>
	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>
	<4B1C8BF8.4040408@gmail.com>
	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
	<4B2B49BD.7020108@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>
	<4B2F29A1.7040907@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C51@EXMBX01.wealthcraft.local>
	<4B2F3240.3070204@lshift.net>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C59@EXMBX01.wealthcraft.local>

Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/5b15a6c5/attachment.htm 

From wilson.ke at wealthcraft.com  Mon Dec 21 09:27:07 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 17:27:07 +0800
Subject: [rabbitmq-discuss] FW:  Alice wonderland  and RabbitMQ issue
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>

Hi Ari,
         Do you have any suggestions?

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 17:24
To: 'Matthias Radestock'
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/fb3a540b/attachment.htm 

From matthias at lshift.net  Mon Dec 21 09:31:58 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Mon, 21 Dec 2009 09:31:58 +0000
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C59@EXMBX01.wealthcraft.local>
References: <167204d20910070144o5cb286bdne148c6c4323ca42f@mail.gmail.com>	<E1MvSCd-0003fs-00.akalend-mail-ru@f288.mail.ru>	<167204d20910070338k4ff71c7ck364a28ea857414cf@mail.gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E1AD80@EXMBX01.wealthcraft.local>	<4B1C8BF8.4040408@gmail.com>	<8F16BDCC98E64841857E711110AF5EDD010392E60E85@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6BDD@EXMBX01.wealthcraft.local>
	<4B2B49BD.7020108@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C16@EXMBX01.wealthcraft.local>
	<4B2F29A1.7040907@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C51@EXMBX01.wealthcraft.local>
	<4B2F3240.3070204@lshift.net>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C59@EXMBX01.wealthcraft.local>
Message-ID: <4B2F408E.7000800@lshift.net>

Wilson,

Wilson Ke wrote:
>     I did following your suggestions.
> Use rabbit at centos as node name;
> Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;
> ./start.sh -alice rabbithost "rabbit at centos";
> But when is use  the bellow curl command to test.
> *curl -i http://localhost:9999/conn*
> it still throw bellow exception

I have run out of ideas. As I said in my previous email, this isn't a
rabbit problem. I suggest you contact the alice authors.


Regards,

Matthias.



From arilerner at mac.com  Mon Dec 21 10:04:27 2009
From: arilerner at mac.com (Ari Lerner)
Date: Mon, 21 Dec 2009 02:04:27 -0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
Message-ID: <91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>

Wilson,

Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?  

It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).

where rabint rpc_call looks like:

rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).

So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?

Cheers,
Ari Lerner

On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:

> Hi Ari,
>          Do you have any suggestions?
>  
> Best Regards,
> Wilson
>  
> From: Wilson Ke 
> Sent: 2009?12?21? 17:24
> To: 'Matthias Radestock'
> Cc: 'mabrek'; 'RabbitMQ Discuss'
> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Matthias,
>     I did following your suggestions.
> Use rabbit at centos as node name;
> Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;
> ./start.sh -alice rabbithost "rabbit at centos";
>  
> But when is use  the bellow curl command to test.
> curl -i http://localhost:9999/conn
> it still throw bellow exception
>  
> =INFO REPORT==== 22-Dec-2009::01:12:26 ===
> (rest_server:237) Error in rest server: {function_clause,
>                                          [{lists,map,
>                                            [#Fun<conn.0.20985291>,
>                                             {badrpc,
>                                              {'EXIT',
>                                               {undef,
>                                                [{rabbit_networking,
>                                                  connection_info_all,[]},
>                                                 {rpc,local_call,3},
>                                                 {conn,get,1},
>                                                 {rest_server,run_controller,4},
>                                                 {mochiweb_http,headers,5},
>                                                 {proc_lib,init_p_do_apply,
>                                                  3}]}}}]},
>                                           {conn,get,1},
>                                           {rest_server,run_controller,4},
>                                           {mochiweb_http,headers,5},
>                                           {proc_lib,init_p_do_apply,3}]}
>  
>  
> Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.
>  
> Thanks,
> Wilson.
>  
> -----Original Message-----
> From: Matthias Radestock [mailto:matthias at lshift.net] 
> Sent: 2009?12?21? 16:31
> To: Wilson Ke
> Cc: 'mabrek'; 'RabbitMQ Discuss'
> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Wilson,
>  
> Wilson Ke wrote:
> > *My rabbitmq work normal,the start information as bellow*
> > node          : rabbit at centos
>  
> In that case ...
>  
> > ./start.sh -alice rabbithost "alice at centos" -setcookie
> > "UD/8aYoam23kYFz4aWO2bA=="
>  
> the above should say "rabbit at centos".
>  
> Also, the cookie information is wrong; you set it to what rabbit
> displays here:
>  
> > cookie hash   : UD/8aYoam23kYFz4aWO2bA==
>  
> but that is the *hash* of the cookie, not the cookie itself. You can
> find the cookie in rabbit's home dir under .erlang.cookie, e.g. given
>  
> > home dir      : /root
>  
> the cookie should be in /root/.erlang.cookie. The contents of that file
> should be supplied to -setcookie.
>  
>  
> Regards,
>  
> Matthias

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/d3247e7f/attachment.htm 

From wilson.ke at wealthcraft.com  Mon Dec 21 10:15:50 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 18:15:50 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>

Hi Ari,
       When I start alice, and on the erl environment run rabint:rabbit_node().
I can get node information as below.

(rabbit at centos)1> rabint:rabbit_node().
rabbit at centos

Best Regards,
Wilson

________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:04
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?

It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).

where rabint rpc_call looks like:

rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).

So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?

Cheers,
Ari Lerner

On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:


Hi Ari,
         Do you have any suggestions?

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 17:24
To: 'Matthias Radestock'
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/5f745543/attachment.htm 

From wilson.ke at wealthcraft.com  Mon Dec 21 10:23:16 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 18:23:16 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>

Hi Ari,

Do you have mochiweb_server.erl and mochiweb.app sample code?
if have ,please send to me. I think these maybe help me find issue key.

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 18:16
To: 'Ari Lerner'
Cc: 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Hi Ari,
       When I start alice, and on the erl environment run rabint:rabbit_node().
I can get node information as below.

(rabbit at centos)1> rabint:rabbit_node().
rabbit at centos

Best Regards,
Wilson

________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:04
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?

It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).

where rabint rpc_call looks like:

rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).

So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?

Cheers,
Ari Lerner

On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:

Hi Ari,
         Do you have any suggestions?

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 17:24
To: 'Matthias Radestock'
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/2b6c3b85/attachment.htm 

From arilerner at mac.com  Mon Dec 21 10:25:09 2009
From: arilerner at mac.com (Ari Lerner)
Date: Mon, 21 Dec 2009 02:25:09 -0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
Message-ID: <64B9CE49-963F-4850-8219-00EA2416098C@mac.com>

The error is coming from an alice call, not from mochiweb. But you can find those in the mochiweb source: http://code.google.com/p/mochiweb/

Thanks,
Ari

On Dec 21, 2009, at 2:23 AM, Wilson Ke wrote:

> Hi Ari,
>  
> Do you have mochiweb_server.erl and mochiweb.app sample code?
> if have ,please send to me. I think these maybe help me find issue key.
>  
> Best Regards,
> Wilson
>  
> From: Wilson Ke 
> Sent: 2009?12?21? 18:16
> To: 'Ari Lerner'
> Cc: 'RabbitMQ Discuss'
> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Hi Ari,
>        When I start alice, and on the erl environment run rabint:rabbit_node().
> I can get node information as below.
>  
> (rabbit at centos)1> rabint:rabbit_node().
> rabbit at centos
>  
> Best Regards,
> Wilson
>  
> From: Ari Lerner [mailto:arilerner at mac.com] 
> Sent: 2009?12?21? 18:04
> To: Wilson Ke
> Cc: 'RabbitMQ Discuss'
> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Wilson,
>  
> Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?  
>  
> It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).
>  
> where rabint rpc_call looks like:
>  
> rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).
>  
> So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?
>  
> Cheers,
> Ari Lerner
>  
> On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:
>  
> 
> Hi Ari,
>          Do you have any suggestions?
>  
> Best Regards,
> Wilson
>  
> From: Wilson Ke 
> Sent: 2009?12?21? 17:24
> To: 'Matthias Radestock'
> Cc: 'mabrek'; 'RabbitMQ Discuss'
> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Matthias,
>     I did following your suggestions.
> Use rabbit at centos as node name;
> Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;
> ./start.sh -alice rabbithost "rabbit at centos";
>  
> But when is use  the bellow curl command to test.
> curl -i http://localhost:9999/conn
> it still throw bellow exception
>  
> =INFO REPORT==== 22-Dec-2009::01:12:26 ===
> (rest_server:237) Error in rest server: {function_clause,
>                                          [{lists,map,
>                                            [#Fun<conn.0.20985291>,
>                                             {badrpc,
>                                              {'EXIT',
>                                               {undef,
>                                                [{rabbit_networking,
>                                                  connection_info_all,[]},
>                                                 {rpc,local_call,3},
>                                                 {conn,get,1},
>                                                 {rest_server,run_controller,4},
>                                                 {mochiweb_http,headers,5},
>                                                 {proc_lib,init_p_do_apply,
>                                                  3}]}}}]},
>                                           {conn,get,1},
>                                           {rest_server,run_controller,4},
>                                           {mochiweb_http,headers,5},
>                                           {proc_lib,init_p_do_apply,3}]}
>  
>  
> Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.
>  
> Thanks,
> Wilson.
>  
> -----Original Message-----
> From: Matthias Radestock [mailto:matthias at lshift.net] 
> Sent: 2009?12?21? 16:31
> To: Wilson Ke
> Cc: 'mabrek'; 'RabbitMQ Discuss'
> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Wilson,
>  
> Wilson Ke wrote:
> > *My rabbitmq work normal,the start information as bellow*
> > node          : rabbit at centos
>  
> In that case ...
>  
> > ./start.sh -alice rabbithost "alice at centos" -setcookie
> > "UD/8aYoam23kYFz4aWO2bA=="
>  
> the above should say "rabbit at centos".
>  
> Also, the cookie information is wrong; you set it to what rabbit
> displays here:
>  
> > cookie hash   : UD/8aYoam23kYFz4aWO2bA==
>  
> but that is the *hash* of the cookie, not the cookie itself. You can
> find the cookie in rabbit's home dir under .erlang.cookie, e.g. given
>  
> > home dir      : /root
>  
> the cookie should be in /root/.erlang.cookie. The contents of that file
> should be supplied to -setcookie.
>  
>  
> Regards,
>  
> Matthias
>  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/e095554f/attachment.htm 

From zubacdragan at gmail.com  Mon Dec 21 10:27:40 2009
From: zubacdragan at gmail.com (Dragan Zubac)
Date: Mon, 21 Dec 2009 11:27:40 +0100
Subject: [rabbitmq-discuss] Scheduling algorithms
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>
Message-ID: <4B2F4D9C.2030808@gmail.com>

Hello

I was just wondering is there a variety of scheduling algorithms within
RabbitMQ (round robin,fair queueing,etc) ?

What is supported native and what is contributed if any ?

Any case studies or so ?

Sincerely


Dragan Zubac




From arilerner at mac.com  Mon Dec 21 10:32:25 2009
From: arilerner at mac.com (Ari Lerner)
Date: Mon, 21 Dec 2009 02:32:25 -0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
Message-ID: <06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>

Wilson,

Yep, so it's on the rabbit node. Do you have the rabbit console open? Can you try typing this in the rabbit console:

rabbit_networking:connection_info_all().

What does that give you?

Ari Lerner

Hi Ari,
Bellow  is operation and result.
(rabbit at centos)2> rpc:call('rabbit at centos', rabbit_networking, connection_info_all, []).
{badrpc,{'EXIT',{undef,[{rabbit_networking,connection_info_all,
                                           []},
                        {rpc,local_call,3},
                        {erl_eval,do_apply,5},
                        {shell,exprs,6},
                        {shell,eval_exprs,6},
                        {shell,eval_loop,3}]}}}
 
Best Regards,
Wilson

On Dec 21, 2009, at 2:25 AM, Ari Lerner wrote:

> The error is coming from an alice call, not from mochiweb. But you can find those in the mochiweb source: http://code.google.com/p/mochiweb/
> 
> Thanks,
> Ari
> 
> On Dec 21, 2009, at 2:23 AM, Wilson Ke wrote:
> 
>> Hi Ari,
>>  
>> Do you have mochiweb_server.erl and mochiweb.app sample code?
>> if have ,please send to me. I think these maybe help me find issue key.
>>  
>> Best Regards,
>> Wilson
>>  
>> From: Wilson Ke 
>> Sent: 2009?12?21? 18:16
>> To: 'Ari Lerner'
>> Cc: 'RabbitMQ Discuss'
>> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>>  
>> Hi Ari,
>>        When I start alice, and on the erl environment run rabint:rabbit_node().
>> I can get node information as below.
>>  
>> (rabbit at centos)1> rabint:rabbit_node().
>> rabbit at centos
>>  
>> Best Regards,
>> Wilson
>>  
>> From: Ari Lerner [mailto:arilerner at mac.com] 
>> Sent: 2009?12?21? 18:04
>> To: Wilson Ke
>> Cc: 'RabbitMQ Discuss'
>> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>>  
>> Wilson,
>>  
>> Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?  
>>  
>> It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).
>>  
>> where rabint rpc_call looks like:
>>  
>> rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).
>>  
>> So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?
>>  
>> Cheers,
>> Ari Lerner
>>  
>> On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:
>>  
>> 
>> Hi Ari,
>>          Do you have any suggestions?
>>  
>> Best Regards,
>> Wilson
>>  
>> From: Wilson Ke 
>> Sent: 2009?12?21? 17:24
>> To: 'Matthias Radestock'
>> Cc: 'mabrek'; 'RabbitMQ Discuss'
>> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>>  
>> Matthias,
>>     I did following your suggestions.
>> Use rabbit at centos as node name;
>> Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;
>> ./start.sh -alice rabbithost "rabbit at centos";
>>  
>> But when is use  the bellow curl command to test.
>> curl -i http://localhost:9999/conn
>> it still throw bellow exception
>>  
>> =INFO REPORT==== 22-Dec-2009::01:12:26 ===
>> (rest_server:237) Error in rest server: {function_clause,
>>                                          [{lists,map,
>>                                            [#Fun<conn.0.20985291>,
>>                                             {badrpc,
>>                                              {'EXIT',
>>                                               {undef,
>>                                                [{rabbit_networking,
>>                                                  connection_info_all,[]},
>>                                                 {rpc,local_call,3},
>>                                                 {conn,get,1},
>>                                                 {rest_server,run_controller,4},
>>                                                 {mochiweb_http,headers,5},
>>                                                 {proc_lib,init_p_do_apply,
>>                                                  3}]}}}]},
>>                                           {conn,get,1},
>>                                           {rest_server,run_controller,4},
>>                                           {mochiweb_http,headers,5},
>>                                           {proc_lib,init_p_do_apply,3}]}
>>  
>>  
>> Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.
>>  
>> Thanks,
>> Wilson.
>>  
>> -----Original Message-----
>> From: Matthias Radestock [mailto:matthias at lshift.net] 
>> Sent: 2009?12?21? 16:31
>> To: Wilson Ke
>> Cc: 'mabrek'; 'RabbitMQ Discuss'
>> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>>  
>> Wilson,
>>  
>> Wilson Ke wrote:
>> > *My rabbitmq work normal,the start information as bellow*
>> > node          : rabbit at centos
>>  
>> In that case ...
>>  
>> > ./start.sh -alice rabbithost "alice at centos" -setcookie
>> > "UD/8aYoam23kYFz4aWO2bA=="
>>  
>> the above should say "rabbit at centos".
>>  
>> Also, the cookie information is wrong; you set it to what rabbit
>> displays here:
>>  
>> > cookie hash   : UD/8aYoam23kYFz4aWO2bA==
>>  
>> but that is the *hash* of the cookie, not the cookie itself. You can
>> find the cookie in rabbit's home dir under .erlang.cookie, e.g. given
>>  
>> > home dir      : /root
>>  
>> the cookie should be in /root/.erlang.cookie. The contents of that file
>> should be supplied to -setcookie.
>>  
>>  
>> Regards,
>>  
>> Matthias
>>  
> 
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/716468cf/attachment.htm 

From wilson.ke at wealthcraft.com  Mon Dec 21 10:37:27 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 18:37:27 +0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>

Hi Ari,
         See Bellow:

(rabbit at centos)1> rabbit_networking:connection_info_all().
** exception error: undefined function rabbit_networking:connection_info_all/0

Regards,
Wilson
________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:32
To: Ari Lerner
Cc: Wilson Ke; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Yep, so it's on the rabbit node. Do you have the rabbit console open? Can you try typing this in the rabbit console:

rabbit_networking:connection_info_all().

What does that give you?

Ari Lerner

Hi Ari,
Bellow  is operation and result.
(rabbit at centos)2> rpc:call('rabbit at centos', rabbit_networking, connection_info_all, []).
{badrpc,{'EXIT',{undef,[{rabbit_networking,connection_info_all,
                                           []},
                        {rpc,local_call,3},
                        {erl_eval,do_apply,5},
                        {shell,exprs,6},
                        {shell,eval_exprs,6},
                        {shell,eval_loop,3}]}}}

Best Regards,
Wilson

On Dec 21, 2009, at 2:25 AM, Ari Lerner wrote:


The error is coming from an alice call, not from mochiweb. But you can find those in the mochiweb source: http://code.google.com/p/mochiweb/

Thanks,
Ari

On Dec 21, 2009, at 2:23 AM, Wilson Ke wrote:


Hi Ari,

Do you have mochiweb_server.erl and mochiweb.app sample code?
if have ,please send to me. I think these maybe help me find issue key.

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 18:16
To: 'Ari Lerner'
Cc: 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Hi Ari,
       When I start alice, and on the erl environment run rabint:rabbit_node().
I can get node information as below.

(rabbit at centos)1> rabint:rabbit_node().
rabbit at centos

Best Regards,
Wilson

________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:04
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?

It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).

where rabint rpc_call looks like:

rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).

So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?

Cheers,
Ari Lerner

On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:

Hi Ari,
         Do you have any suggestions?

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 17:24
To: 'Matthias Radestock'
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias


_______________________________________________
rabbitmq-discuss mailing list
rabbitmq-discuss at lists.rabbitmq.com<mailto:rabbitmq-discuss at lists.rabbitmq.com>
http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/3274a300/attachment.htm 

From arilerner at mac.com  Mon Dec 21 10:41:35 2009
From: arilerner at mac.com (Ari Lerner)
Date: Mon, 21 Dec 2009 02:41:35 -0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>
Message-ID: <7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>

Wilson,

Did you make the rabbit project? I mean, how did you install rabbit? 

To the rabbit guys, it seems that the rabbit_networking code isn't being loaded into the rabbit path?

Cheers,
Ari Lerner

On Dec 21, 2009, at 2:37 AM, Wilson Ke wrote:

> Hi Ari,
>          See Bellow:
>  
> (rabbit at centos)1> rabbit_networking:connection_info_all().
> ** exception error: undefined function rabbit_networking:connection_info_all/0
>  
> Regards,
> Wilson
> From: Ari Lerner [mailto:arilerner at mac.com] 
> Sent: 2009?12?21? 18:32
> To: Ari Lerner
> Cc: Wilson Ke; 'RabbitMQ Discuss'
> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Wilson,
>  
> Yep, so it's on the rabbit node. Do you have the rabbit console open? Can you try typing this in the rabbit console:
>  
> rabbit_networking:connection_info_all().
>  
> What does that give you?
>  
> Ari Lerner
>  
> Hi Ari,
> Bellow  is operation and result.
> (rabbit at centos)2> rpc:call('rabbit at centos', rabbit_networking, connection_info_all, []).
> {badrpc,{'EXIT',{undef,[{rabbit_networking,connection_info_all,
>                                            []},
>                         {rpc,local_call,3},
>                         {erl_eval,do_apply,5},
>                         {shell,exprs,6},
>                         {shell,eval_exprs,6},
>                         {shell,eval_loop,3}]}}}
>  
> Best Regards,
> Wilson
>  
> On Dec 21, 2009, at 2:25 AM, Ari Lerner wrote:
> 
> 
> The error is coming from an alice call, not from mochiweb. But you can find those in the mochiweb source: http://code.google.com/p/mochiweb/
>  
> Thanks,
> Ari
>  
> On Dec 21, 2009, at 2:23 AM, Wilson Ke wrote:
> 
> 
> Hi Ari,
>  
> Do you have mochiweb_server.erl and mochiweb.app sample code?
> if have ,please send to me. I think these maybe help me find issue key.
>  
> Best Regards,
> Wilson
>  
> From: Wilson Ke 
> Sent: 2009?12?21? 18:16
> To: 'Ari Lerner'
> Cc: 'RabbitMQ Discuss'
> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Hi Ari,
>        When I start alice, and on the erl environment run rabint:rabbit_node().
> I can get node information as below.
>  
> (rabbit at centos)1> rabint:rabbit_node().
> rabbit at centos
>  
> Best Regards,
> Wilson
>  
> From: Ari Lerner [mailto:arilerner at mac.com] 
> Sent: 2009?12?21? 18:04
> To: Wilson Ke
> Cc: 'RabbitMQ Discuss'
> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Wilson,
>  
> Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?  
>  
> It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).
>  
> where rabint rpc_call looks like:
>  
> rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).
>  
> So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?
>  
> Cheers,
> Ari Lerner
>  
> On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:
>  
> 
> Hi Ari,
>          Do you have any suggestions?
>  
> Best Regards,
> Wilson
>  
> From: Wilson Ke 
> Sent: 2009?12?21? 17:24
> To: 'Matthias Radestock'
> Cc: 'mabrek'; 'RabbitMQ Discuss'
> Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Matthias,
>     I did following your suggestions.
> Use rabbit at centos as node name;
> Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;
> ./start.sh -alice rabbithost "rabbit at centos";
>  
> But when is use  the bellow curl command to test.
> curl -i http://localhost:9999/conn
> it still throw bellow exception
>  
> =INFO REPORT==== 22-Dec-2009::01:12:26 ===
> (rest_server:237) Error in rest server: {function_clause,
>                                          [{lists,map,
>                                            [#Fun<conn.0.20985291>,
>                                             {badrpc,
>                                              {'EXIT',
>                                               {undef,
>                                                [{rabbit_networking,
>                                                  connection_info_all,[]},
>                                                 {rpc,local_call,3},
>                                                 {conn,get,1},
>                                                 {rest_server,run_controller,4},
>                                                 {mochiweb_http,headers,5},
>                                                 {proc_lib,init_p_do_apply,
>                                                  3}]}}}]},
>                                           {conn,get,1},
>                                           {rest_server,run_controller,4},
>                                           {mochiweb_http,headers,5},
>                                           {proc_lib,init_p_do_apply,3}]}
>  
>  
> Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.
>  
> Thanks,
> Wilson.
>  
> -----Original Message-----
> From: Matthias Radestock [mailto:matthias at lshift.net] 
> Sent: 2009?12?21? 16:31
> To: Wilson Ke
> Cc: 'mabrek'; 'RabbitMQ Discuss'
> Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue
>  
> Wilson,
>  
> Wilson Ke wrote:
> > *My rabbitmq work normal,the start information as bellow*
> > node          : rabbit at centos
>  
> In that case ...
>  
> > ./start.sh -alice rabbithost "alice at centos" -setcookie
> > "UD/8aYoam23kYFz4aWO2bA=="
>  
> the above should say "rabbit at centos".
>  
> Also, the cookie information is wrong; you set it to what rabbit
> displays here:
>  
> > cookie hash   : UD/8aYoam23kYFz4aWO2bA==
>  
> but that is the *hash* of the cookie, not the cookie itself. You can
> find the cookie in rabbit's home dir under .erlang.cookie, e.g. given
>  
> > home dir      : /root
>  
> the cookie should be in /root/.erlang.cookie. The contents of that file
> should be supplied to -setcookie.
>  
>  
> Regards,
>  
> Matthias
>  
>  
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/ee2fa1f1/attachment.htm 

From matthias at lshift.net  Mon Dec 21 10:52:32 2009
From: matthias at lshift.net (Matthias Radestock)
Date: Mon, 21 Dec 2009 10:52:32 +0000
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>
	<7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>
Message-ID: <4B2F5370.6090204@lshift.net>

Ari,

Ari Lerner wrote:
> Did you make the rabbit project? I mean, how did you install rabbit? 
> 
> To the rabbit guys, it seems that the rabbit_networking code isn't being 
> loaded into the rabbit path?

...which is why I asked the question earlier whether rabbit is
functioning normally, which apparently it is.

>From Wilson's comments I get the impression that there is confusion
about the two nodes. How else would you explain this? ...

> (rabbit at centos)1> rabint:rabbit_node().
> rabbit at centos

rabint is an Alice module. Yet the above is executed on a node called
'rabbit at centos'.

I reckon there is a configuration problem which results in the Alice
node talking to itself instead of the rabbit node.


Matthias.



From arilerner at mac.com  Mon Dec 21 11:01:46 2009
From: arilerner at mac.com (Ari Lerner)
Date: Mon, 21 Dec 2009 03:01:46 -0800
Subject: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue
In-Reply-To: <4B2F5370.6090204@lshift.net>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>
	<7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>
	<4B2F5370.6090204@lshift.net>
Message-ID: <8EF5C619-11B7-4FEC-9D54-98613E684CDB@mac.com>

Good point.

Wilson, do you know the full name of the rabbit node?

Sent from my iPhone

On Dec 21, 2009, at 2:52 AM, Matthias Radestock <matthias at lshift.net>  
wrote:

> Ari,
>
> Ari Lerner wrote:
>> Did you make the rabbit project? I mean, how did you install rabbit?
>>
>> To the rabbit guys, it seems that the rabbit_networking code isn't  
>> being
>> loaded into the rabbit path?
>
> ...which is why I asked the question earlier whether rabbit is
> functioning normally, which apparently it is.
>
> From Wilson's comments I get the impression that there is confusion
> about the two nodes. How else would you explain this? ...
>
>> (rabbit at centos)1> rabint:rabbit_node().
>> rabbit at centos
>
> rabint is an Alice module. Yet the above is executed on a node called
> 'rabbit at centos'.
>
> I reckon there is a configuration problem which results in the Alice
> node talking to itself instead of the rabbit node.
>
>
> Matthias.



From wilson.ke at wealthcraft.com  Mon Dec 21 15:17:05 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 23:17:05 +0800
Subject: [rabbitmq-discuss] =?gb2312?b?tPC4tDogIEFsaWNlIHdvbmRlcmxhbmQg?=
 =?gb2312?b?IGFuZCBSYWJiaXRNUSBpc3N1ZQ==?=
In-Reply-To: <7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>,
	<7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074B04B9EF@EXMBX01.wealthcraft.local>

Ari,

     It is so sorry to write ball your email,chinese traffic conditions is very terrible,i an on road to home for 2 hours.

I use "make and make install" to instlal rabbitmq server 1.7.0, i only install to "/usr/wilson/rabbitmq-server-1.7.0". and do more jobs about path handle.

Best Regards,
Wilson


________________________________
???: Ari Lerner [arilerner at mac.com]
????: 2009?12?21? 18:41
???: Wilson Ke
??: 'RabbitMQ Discuss'
??: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Did you make the rabbit project? I mean, how did you install rabbit?

To the rabbit guys, it seems that the rabbit_networking code isn't being loaded into the rabbit path?

Cheers,
Ari Lerner

On Dec 21, 2009, at 2:37 AM, Wilson Ke wrote:

Hi Ari,
         See Bellow:

(rabbit at centos)1> rabbit_networking:connection_info_all().
** exception error: undefined function rabbit_networking:connection_info_all/0

Regards,
Wilson
________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:32
To: Ari Lerner
Cc: Wilson Ke; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Yep, so it's on the rabbit node. Do you have the rabbit console open? Can you try typing this in the rabbit console:

rabbit_networking:connection_info_all().

What does that give you?

Ari Lerner

Hi Ari,
Bellow  is operation and result.
(rabbit at centos)2> rpc:call('rabbit at centos', rabbit_networking, connection_info_all, []).
{badrpc,{'EXIT',{undef,[{rabbit_networking,connection_info_all,
                                           []},
                        {rpc,local_call,3},
                        {erl_eval,do_apply,5},
                        {shell,exprs,6},
                        {shell,eval_exprs,6},
                        {shell,eval_loop,3}]}}}

Best Regards,
Wilson

On Dec 21, 2009, at 2:25 AM, Ari Lerner wrote:


The error is coming from an alice call, not from mochiweb. But you can find those in the mochiweb source: http://code.google.com/p/mochiweb/

Thanks,
Ari

On Dec 21, 2009, at 2:23 AM, Wilson Ke wrote:


Hi Ari,

Do you have mochiweb_server.erl and mochiweb.app sample code?
if have ,please send to me. I think these maybe help me find issue key.

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 18:16
To: 'Ari Lerner'
Cc: 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Hi Ari,
       When I start alice, and on the erl environment run rabint:rabbit_node().
I can get node information as below.

(rabbit at centos)1> rabint:rabbit_node().
rabbit at centos

Best Regards,
Wilson

________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:04
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?

It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).

where rabint rpc_call looks like:

rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).

So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?

Cheers,
Ari Lerner

On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:

Hi Ari,
         Do you have any suggestions?

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 17:24
To: 'Matthias Radestock'
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias


_______________________________________________
rabbitmq-discuss mailing list
rabbitmq-discuss at lists.rabbitmq.com<mailto:rabbitmq-discuss at lists.rabbitmq.com>
http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/d6c808bb/attachment.htm 

From wilson.ke at wealthcraft.com  Mon Dec 21 15:17:38 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 23:17:38 +0800
Subject: [rabbitmq-discuss] =?gb2312?b?tPC4tDogIEFsaWNlIHdvbmRlcmxhbmQg?=
 =?gb2312?b?IGFuZCBSYWJiaXRNUSBpc3N1ZQ==?=
In-Reply-To: <8EF5C619-11B7-4FEC-9D54-98613E684CDB@mac.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>
	<7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>
	<4B2F5370.6090204@lshift.net>,
	<8EF5C619-11B7-4FEC-9D54-98613E684CDB@mac.com>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074B04B9F0@EXMBX01.wealthcraft.local>


Ari, 
      I am at home this night,my linux server only config short name.i will config full name include domain name tomorrow when i come to company.

Best Regards,
Wilson

________________________________________
???: Ari Lerner [arilerner at mac.com]
????: 2009?12?21? 19:01
???: Matthias Radestock
??: Wilson Ke; RabbitMQ Discuss
??: Re: [rabbitmq-discuss] Alice wonderland  and RabbitMQ issue

Good point.

Wilson, do you know the full name of the rabbit node?

Sent from my iPhone

On Dec 21, 2009, at 2:52 AM, Matthias Radestock <matthias at lshift.net>
wrote:

> Ari,
>
> Ari Lerner wrote:
>> Did you make the rabbit project? I mean, how did you install rabbit?
>>
>> To the rabbit guys, it seems that the rabbit_networking code isn't
>> being
>> loaded into the rabbit path?
>
> ...which is why I asked the question earlier whether rabbit is
> functioning normally, which apparently it is.
>
> From Wilson's comments I get the impression that there is confusion
> about the two nodes. How else would you explain this? ...
>
>> (rabbit at centos)1> rabint:rabbit_node().
>> rabbit at centos
>
> rabint is an Alice module. Yet the above is executed on a node called
> 'rabbit at centos'.
>
> I reckon there is a configuration problem which results in the Alice
> node talking to itself instead of the rabbit node.
>
>
> Matthias.

From wilson.ke at wealthcraft.com  Mon Dec 21 15:24:31 2009
From: wilson.ke at wealthcraft.com (Wilson Ke)
Date: Mon, 21 Dec 2009 23:24:31 +0800
Subject: [rabbitmq-discuss] =?gb2312?b?tPC4tDogIEFsaWNlIHdvbmRlcmxhbmQg?=
 =?gb2312?b?IGFuZCBSYWJiaXRNUSBpc3N1ZQ==?=
In-Reply-To: <8F16BDCC98E64841857E711110AF5EDD01074B04B9EF@EXMBX01.wealthcraft.local>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074B03EE68@EXMBX01.wealthcraft.local>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C64@EXMBX01.wealthcraft.local>
	<64B9CE49-963F-4850-8219-00EA2416098C@mac.com>
	<06A2FD06-C125-4705-AA4F-5BF2E7E27C9D@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C6A@EXMBX01.wealthcraft.local>,
	<7C9A30C8-3E99-4E9E-B8BA-1F0504E208D1@mac.com>,
	<8F16BDCC98E64841857E711110AF5EDD01074B04B9EF@EXMBX01.wealthcraft.local>
Message-ID: <8F16BDCC98E64841857E711110AF5EDD01074B04B9F1@EXMBX01.wealthcraft.local>


________________________________
???: Wilson Ke
????: 2009?12?21? 23:17
???: Ari Lerner
??: 'RabbitMQ Discuss'
??: ??: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Ari,

     It is so sorry to write ball your email,chinese traffic conditions is very terrible,i an on road to home for 2 hours.

I use "make and make install" to instlal rabbitmq server 1.7.0, i only install to "/usr/wilson/rabbitmq-server-1.7.0". and do no more jobs about path handling.

Best Regards,
Wilson


________________________________
???: Ari Lerner [arilerner at mac.com]
????: 2009?12?21? 18:41
???: Wilson Ke
??: 'RabbitMQ Discuss'
??: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Did you make the rabbit project? I mean, how did you install rabbit?

To the rabbit guys, it seems that the rabbit_networking code isn't being loaded into the rabbit path?

Cheers,
Ari Lerner

On Dec 21, 2009, at 2:37 AM, Wilson Ke wrote:

Hi Ari,
         See Bellow:

(rabbit at centos)1> rabbit_networking:connection_info_all().
** exception error: undefined function rabbit_networking:connection_info_all/0

Regards,
Wilson
________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:32
To: Ari Lerner
Cc: Wilson Ke; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Yep, so it's on the rabbit node. Do you have the rabbit console open? Can you try typing this in the rabbit console:

rabbit_networking:connection_info_all().

What does that give you?

Ari Lerner

Hi Ari,
Bellow  is operation and result.
(rabbit at centos)2> rpc:call('rabbit at centos', rabbit_networking, connection_info_all, []).
{badrpc,{'EXIT',{undef,[{rabbit_networking,connection_info_all,
                                           []},
                        {rpc,local_call,3},
                        {erl_eval,do_apply,5},
                        {shell,exprs,6},
                        {shell,eval_exprs,6},
                        {shell,eval_loop,3}]}}}

Best Regards,
Wilson

On Dec 21, 2009, at 2:25 AM, Ari Lerner wrote:


The error is coming from an alice call, not from mochiweb. But you can find those in the mochiweb source: http://code.google.com/p/mochiweb/

Thanks,
Ari

On Dec 21, 2009, at 2:23 AM, Wilson Ke wrote:


Hi Ari,

Do you have mochiweb_server.erl and mochiweb.app sample code?
if have ,please send to me. I think these maybe help me find issue key.

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 18:16
To: 'Ari Lerner'
Cc: 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Hi Ari,
       When I start alice, and on the erl environment run rabint:rabbit_node().
I can get node information as below.

(rabbit at centos)1> rabint:rabbit_node().
rabbit at centos

Best Regards,
Wilson

________________________________
From: Ari Lerner [mailto:arilerner at mac.com]
Sent: 2009?12?21? 18:04
To: Wilson Ke
Cc: 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue

Wilson,

Hey, sorry, I've been away from my email for a little while. Does he have the rabbit source?

It's called in an rpc: rabint:rpc_call(rabbit_networking, connection_info_all, []).

where rabint rpc_call looks like:

rpc_call(Mod, Fun, Args)  -> rpc:call(rabbit_node(), Mod, Fun, Args, ?RPC_TIMEOUT).

So it's coming from the remote node. Wilson, what does: rabint:rabbit_node() look like?

Cheers,
Ari Lerner

On Dec 21, 2009, at 1:27 AM, Wilson Ke wrote:

Hi Ari,
         Do you have any suggestions?

Best Regards,
Wilson

________________________________
From: Wilson Ke
Sent: 2009?12?21? 17:24
To: 'Matthias Radestock'
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: RE: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue


Matthias,

    I did following your suggestions.

Use rabbit at centos as node name;

Set "UD/8aYoam23kYFz4aWO2bA==" as /root/.erlang.cookie content;

./start.sh -alice rabbithost "rabbit at centos";



But when is use  the bellow curl command to test.

curl -i http://localhost:9999/conn

it still throw bellow exception



=INFO REPORT==== 22-Dec-2009::01:12:26 ===

(rest_server:237) Error in rest server: {function_clause,

                                         [{lists,map,

                                           [#Fun<conn.0.20985291>,

                                            {badrpc,

                                             {'EXIT',

                                              {undef,

                                               [{rabbit_networking,

                                                 connection_info_all,[]},

                                                {rpc,local_call,3},

                                                {conn,get,1},

                                                {rest_server,run_controller,4},

                                                {mochiweb_http,headers,5},

                                                {proc_lib,init_p_do_apply,

                                                 3}]}}}]},

                                          {conn,get,1},

                                          {rest_server,run_controller,4},

                                          {mochiweb_http,headers,5},

                                          {proc_lib,init_p_do_apply,3}]}





Do you have mochiweb_server.erl and mochiweb.app sample code,if have ,please send to me. I think these maybe help me find issue key.



Thanks,

Wilson.



-----Original Message-----
From: Matthias Radestock [mailto:matthias at lshift.net]
Sent: 2009?12?21? 16:31
To: Wilson Ke
Cc: 'mabrek'; 'RabbitMQ Discuss'
Subject: Re: [rabbitmq-discuss] Alice wonderland and RabbitMQ issue



Wilson,



Wilson Ke wrote:

> *My rabbitmq work normal,the start information as bellow*

> node          : rabbit at centos



In that case ...



> ./start.sh -alice rabbithost "alice at centos" -setcookie

> "UD/8aYoam23kYFz4aWO2bA=="



the above should say "rabbit at centos".



Also, the cookie information is wrong; you set it to what rabbit

displays here:



> cookie hash   : UD/8aYoam23kYFz4aWO2bA==



but that is the *hash* of the cookie, not the cookie itself. You can

find the cookie in rabbit's home dir under .erlang.cookie, e.g. given



> home dir      : /root



the cookie should be in /root/.erlang.cookie. The contents of that file

should be supplied to -setcookie.





Regards,



Matthias


_______________________________________________
rabbitmq-discuss mailing list
rabbitmq-discuss at lists.rabbitmq.com<mailto:rabbitmq-discuss at lists.rabbitmq.com>
http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091221/74b15c12/attachment.htm 

From cremes.devlist at mac.com  Mon Dec 21 16:07:42 2009
From: cremes.devlist at mac.com (Chuck Remes)
Date: Mon, 21 Dec 2009 10:07:42 -0600
Subject: [rabbitmq-discuss] amqp-js experiences?
Message-ID: <596D337E-633F-4DD3-AF91-336852C803B6@mac.com>

I am doing some client-side (browser) coding these days and need to  
tap into my exchanges and queues. I have downloaded the amqp-js  
project from github but cannot get it to work at all.

Has anyone used this project? Can you help me get the HelloWorld.html  
example working?

cr




From dinabandhu.mitra at tecnotree.com  Tue Dec 22 05:44:32 2009
From: dinabandhu.mitra at tecnotree.com (Dinabandhu)
Date: Mon, 21 Dec 2009 21:44:32 -0800 (PST)
Subject: [rabbitmq-discuss]  Will this work?
Message-ID: <26875409.post@talk.nabble.com>


Hi,

I am new to RabbitMQ. We have a telecoms application. We are looking at
restructuring the application based on RabbitMQ to solve some problems that
we currently have. As we are very new to RabbitMQ (and messaging in general)
I would be grateful if someone can comment/advice on whether we are on the
right track. I have described the scenario below with as much detail as I
can. Any comment/advice is very welcome.

The characteristics of the application
======================================

1. The application has two layers, locators and processors.
2. Each layer has multiple engines; i.e. multiple locator engines (LE) and
multiple processor engines (PE).
3. The clients of the application connect to one (or more) LEs and send
requests.
4. The LEs are deployed in N+1 active/active configuration in the sense that
functionally any LE can process any request.
5. Unlike LEs, the PEs are capable of handling only a subset of the client
requests and are deployed in 1+1 active/passive pairs.
6. Currently all LEs are connected to all PEs (and vice-versa) via point to
point TCP connection.
7. LEs have the intelligence to know which particular PE pair can handle a
particular request and forwards the request to both engines of a PE pair
(i.e. LE does not know which one of a pair is active).
8. The PE that is active, processes (asynchronously) the request and sends
the result back to the LE that originated the request.
9. For simplicity we will assume that each instance of engine (LE/PE) is
deployed in a separate physical machine though in reality multiple engines
are co-located in actual deployments (e.g 4 PEs on a single server).  


Good points of the current structure
====================================
1. As the connection if point to point, there is no single point of failure
(e.g. a message broker) that can bring down the complete cluster. High
availability is a very critical requirement for our application.
2. Messages from LE to PE and vice-versa are delivered from the source to
the target in single hop over the network. 

Bad points of the current structure
===================================
1. The portion of the code that handles the network is fairly complicated as
it needs to handle point to point connections. Ideally we would want to
trivialize the code and push the responsibility out of the application.
2. Again, because of the point to point nature of the connections, the
configuration job of tying up of each LE to PE and vice-versa is fairly
complicated because the number of engines can be quite large.
3. As of now, we do not have any lateral (PE to PE or LE to LE)
communication. In case we need lateral communication in future, then the
complexity of both 1 & 2 (especially 2) will increase exponentially.

Of course, we want to solve the problems without loosing the benefits of
current structure :-). A solution based on message bus looks interesting but
may loose some of the benefits of the current structure. What we have done
is kind of defined a set of design goals/attributes that a messaging based
solution should have for it to work in our environment. I have given those
goals below -

Design Goals
============ 
1. Single point of failure - The message broker must not become a SPOF in
the system. The messaging system must allow N+1 clustered configuration.
2. While clustered configuration should replicate metadata, e.g. exchange
definitions,queue bindings etc, it must not replicate the messages across
the brokers in a cluster. We do not want message replication (and message
persistence) because guaranteed delivery of message is not a requirement for
the application to function. Hence we do not want to take message
replication overheads.
3. We do not want to dedicate additional equipment (with a separate role,
e.g. "broker-server") in the solution stack. Ideally, the broker (cluster)
should share the existing servers in a symmetric manner.
4. Ideally, we would want to retain the single hop delivery. However, we can
loosen the requirement to the following -
   a) There will be at most two hops to deliver a message from source to
destination.
   b) At least one of the hops will be local (within same physical server).

With these requirements on mind, we are looking at the following solution
structure based on RabbitMQ. We have made certain assumptions on how
RabbitMQ works. I have tried to state the assumptions that we have made. If
someone can help in validating the assumptions and whether the structure
would work as expected (or whether the proposed structure is completely
stupid) I would be very obliged.

The proposed solution
=====================
1. Exchanges - The solution will have single topic exchange.
2. Queues and Bindings - Each engine will declare a transient queue. The
queue will be bound to the exchange with the following binding key -
   a) For LEs - The binding key will be LE.<le_id>; e.g. LE.1, LE.2 ... and
so on. Anyone wishing to send a message to a particular LE will send the
message with appropriate routing key.
   b) For PEs - The binding key will be PE.<pe_id>; e.g. PE.1, PE.2 ... and
so on. Anyone wishing to send a message to a particular PE will send the
message with appropriate routing key.
   c) For PEs, there will be two separate queues (one each from active &
passive of PE pairs) with same binding. The assumption is, if a particular
message matches the bindings of multiple queues in a topic exchange, the
message is delivered to all the queues that matched. Is this assumption
correct?
3. Brokers - There will be a broker (RabbitMQ) running on each physical
server and all the will be clustered. Any application engine (LE & PE),
connects only to the "local broker instance" and declares its queue and
binds to the application exchange using appropriate binding keys. If a
broker instance dies, then the application engines running on that physical
server effectively becomes dead from the point of view of rest of the
engines. This is acceptable as the application is already designed to work
under scenarios where some of the engines has failed. However we have made
quite a few assumptions here and not sure whether those are correct. The
assumptions are below -
   a) When a application engine (LE/PE) boots and declares it's queue and
binding using a connection to the local broker, the queue and bindings
becomes visible to all broker instances running in different servers. Is
this correct?
   b) The queues are hosted on the local broker node which is used to
declare them. Is this correct?
   c) When a application engine publishes a message using a connection to
the local broker, then the local broker itself shall apply the routing
filters and deliver the message directly to all the matching queues without
requiring the message to be passed through additional broker instances. Is
this correct?
   d) The message itself will not be replicated to all brokers. Is this
correct?
   e) The queues and the bindings declared by application engines are (or
can be configured as) transient in the sense that they will disappear once
the application engine declaring them dies. Is this correct?
   f) Anyone trying send a message that is immediately non-routable
(possibly mandatory+immediate flag with auto-ack) gets a error and broker
drops the message. Is this correct?


Regards,
Dinabandhu
-- 
View this message in context: http://old.nabble.com/Will-this-work--tp26875409p26875409.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From yrashk at gmail.com  Tue Dec 22 06:43:43 2009
From: yrashk at gmail.com (yrashk)
Date: Mon, 21 Dec 2009 22:43:43 -0800 (PST)
Subject: [rabbitmq-discuss]  amqpfs announcement
Message-ID: <26884573.post@talk.nabble.com>


Hi,

I am happy to announce an early version of aqmpfs (I've been cooking it for
a little bit more than a week). 

AMQPFS is a Filesystem as API that works through AMQPFS, all filesystem
providers are available through AMQP bus and can be distributed in the
network.

What's the point? Why one may need this? Well, this project started as a way
to integrate some third-party software while maintaining no real files or
directories for it. 

For example, it could be used to serve configuration files, receive logs and
such. Itsuse is virtually unlimited.

Plus, it can also utilize multiple instances of providers for the same path
which leads us to interesting fault tolerance and availability algorithms.

Would be glad to know if anybody else will find it useful.

It is available at http://github.com/scallable/amqpfs

Please note that it is very immature and pretty much undocumented. Feel free
to contact
me (yrashk on FreeNode IRC or yrashk at gmail.com by e-mail). 

Cheers,
Yurii
-- 
View this message in context: http://old.nabble.com/amqpfs-announcement-tp26884573p26884573.html
Sent from the RabbitMQ mailing list archive at Nabble.com.




From alexis.richardson at gmail.com  Tue Dec 22 08:21:09 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 22 Dec 2009 08:21:09 +0000
Subject: [rabbitmq-discuss] amqpfs announcement
In-Reply-To: <26884573.post@talk.nabble.com>
References: <26884573.post@talk.nabble.com>
Message-ID: <167204d20912220021i6f721518l4fc5b6b073394e4b@mail.gmail.com>

Neat!  Does this also work with HDFS (or could it)?

alexis


On Tue, Dec 22, 2009 at 6:43 AM, yrashk <yrashk at gmail.com> wrote:
>
> Hi,
>
> I am happy to announce an early version of aqmpfs (I've been cooking it for
> a little bit more than a week).
>
> AMQPFS is a Filesystem as API that works through AMQPFS, all filesystem
> providers are available through AMQP bus and can be distributed in the
> network.
>
> What's the point? Why one may need this? Well, this project started as a way
> to integrate some third-party software while maintaining no real files or
> directories for it.
>
> For example, it could be used to serve configuration files, receive logs and
> such. Itsuse is virtually unlimited.
>
> Plus, it can also utilize multiple instances of providers for the same path
> which leads us to interesting fault tolerance and availability algorithms.
>
> Would be glad to know if anybody else will find it useful.
>
> It is available at http://github.com/scallable/amqpfs
>
> Please note that it is very immature and pretty much undocumented. Feel free
> to contact
> me (yrashk on FreeNode IRC or yrashk at gmail.com by e-mail).
>
> Cheers,
> Yurii
> --
> View this message in context: http://old.nabble.com/amqpfs-announcement-tp26884573p26884573.html
> Sent from the RabbitMQ mailing list archive at Nabble.com.
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From yrashk at gmail.com  Tue Dec 22 08:28:14 2009
From: yrashk at gmail.com (Yurii Rashkovskii)
Date: Tue, 22 Dec 2009 00:28:14 -0800
Subject: [rabbitmq-discuss] amqpfs announcement
In-Reply-To: <167204d20912220021i6f721518l4fc5b6b073394e4b@mail.gmail.com>
References: <26884573.post@talk.nabble.com>
	<167204d20912220021i6f721518l4fc5b6b073394e4b@mail.gmail.com>
Message-ID: <14468952-4752-4ED5-84E1-10F3D3A31779@gmail.com>

Alexis,

Short answer is no.

Long answer is

1) I haven't used HDFS myself so I can't say much about it
2) It does not support HDFS
3) HDFS goal is to provide a distributed and fault-tolerant filesystem, while AMQPFS goal is to expose services available through AMQP bus as filesystems (hence Filesystem as API)
4) I can see how somebody may develop a hdfs_amqpfs_provider that will be available through AMQP and will integrate with HDFS (so, _yes it could_)
5) *However*, I am not sure is there any good reason for doing this

Yurii

On 2009-12-22, at 12:21 AM, Alexis Richardson wrote:

> Neat!  Does this also work with HDFS (or could it)?
> 
> alexis
> 
> 
> On Tue, Dec 22, 2009 at 6:43 AM, yrashk <yrashk at gmail.com> wrote:
>> 
>> Hi,
>> 
>> I am happy to announce an early version of aqmpfs (I've been cooking it for
>> a little bit more than a week).
>> 
>> AMQPFS is a Filesystem as API that works through AMQPFS, all filesystem
>> providers are available through AMQP bus and can be distributed in the
>> network.
>> 
>> What's the point? Why one may need this? Well, this project started as a way
>> to integrate some third-party software while maintaining no real files or
>> directories for it.
>> 
>> For example, it could be used to serve configuration files, receive logs and
>> such. Itsuse is virtually unlimited.
>> 
>> Plus, it can also utilize multiple instances of providers for the same path
>> which leads us to interesting fault tolerance and availability algorithms.
>> 
>> Would be glad to know if anybody else will find it useful.
>> 
>> It is available at http://github.com/scallable/amqpfs
>> 
>> Please note that it is very immature and pretty much undocumented. Feel free
>> to contact
>> me (yrashk on FreeNode IRC or yrashk at gmail.com by e-mail).
>> 
>> Cheers,
>> Yurii
>> --
>> View this message in context: http://old.nabble.com/amqpfs-announcement-tp26884573p26884573.html
>> Sent from the RabbitMQ mailing list archive at Nabble.com.
>> 
>> 
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> 




From alexis.richardson at gmail.com  Tue Dec 22 08:37:29 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 22 Dec 2009 08:37:29 +0000
Subject: [rabbitmq-discuss] amqpfs announcement
In-Reply-To: <14468952-4752-4ED5-84E1-10F3D3A31779@gmail.com>
References: <26884573.post@talk.nabble.com>
	<167204d20912220021i6f721518l4fc5b6b073394e4b@mail.gmail.com>
	<14468952-4752-4ED5-84E1-10F3D3A31779@gmail.com>
Message-ID: <167204d20912220037n73db21b6gb058ddcad3a11aa2@mail.gmail.com>

Yurii

Thank-you.  Makes sense.

As to (5), I am of course not sure if using your FS interface would be
the way to go.  However, various folks have in the past listed issues
with HDFS that could be solved by putting a proper queue in front of
it.

I will show them this thread in case they wish to comment.   Failing
that, I can probably dig around and pull out some examples.

alexis




On Tue, Dec 22, 2009 at 8:28 AM, Yurii Rashkovskii <yrashk at gmail.com> wrote:
> Alexis,
>
> Short answer is no.
>
> Long answer is
>
> 1) I haven't used HDFS myself so I can't say much about it
> 2) It does not support HDFS
> 3) HDFS goal is to provide a distributed and fault-tolerant filesystem, while AMQPFS goal is to expose services available through AMQP bus as filesystems (hence Filesystem as API)
> 4) I can see how somebody may develop a hdfs_amqpfs_provider that will be available through AMQP and will integrate with HDFS (so, _yes it could_)
> 5) *However*, I am not sure is there any good reason for doing this
>
> Yurii
>
> On 2009-12-22, at 12:21 AM, Alexis Richardson wrote:
>
>> Neat! ?Does this also work with HDFS (or could it)?
>>
>> alexis
>>
>>
>> On Tue, Dec 22, 2009 at 6:43 AM, yrashk <yrashk at gmail.com> wrote:
>>>
>>> Hi,
>>>
>>> I am happy to announce an early version of aqmpfs (I've been cooking it for
>>> a little bit more than a week).
>>>
>>> AMQPFS is a Filesystem as API that works through AMQPFS, all filesystem
>>> providers are available through AMQP bus and can be distributed in the
>>> network.
>>>
>>> What's the point? Why one may need this? Well, this project started as a way
>>> to integrate some third-party software while maintaining no real files or
>>> directories for it.
>>>
>>> For example, it could be used to serve configuration files, receive logs and
>>> such. Itsuse is virtually unlimited.
>>>
>>> Plus, it can also utilize multiple instances of providers for the same path
>>> which leads us to interesting fault tolerance and availability algorithms.
>>>
>>> Would be glad to know if anybody else will find it useful.
>>>
>>> It is available at http://github.com/scallable/amqpfs
>>>
>>> Please note that it is very immature and pretty much undocumented. Feel free
>>> to contact
>>> me (yrashk on FreeNode IRC or yrashk at gmail.com by e-mail).
>>>
>>> Cheers,
>>> Yurii
>>> --
>>> View this message in context: http://old.nabble.com/amqpfs-announcement-tp26884573p26884573.html
>>> Sent from the RabbitMQ mailing list archive at Nabble.com.
>>>
>>>
>>> _______________________________________________
>>> rabbitmq-discuss mailing list
>>> rabbitmq-discuss at lists.rabbitmq.com
>>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>>
>
>



From alexis.richardson at gmail.com  Tue Dec 22 16:32:08 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 22 Dec 2009 16:32:08 +0000
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <BF7C8A76-0171-45F6-9B19-8FD49760270A@epicadvertising.com>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com>
	<4B143B24.4020600@lshift.net>
	<BF7C8A76-0171-45F6-9B19-8FD49760270A@epicadvertising.com>
Message-ID: <167204d20912220832k56fcd05h55520ef9bd309372@mail.gmail.com>

Scott

How are you getting on with this?  I'd like to link to it from our
various info pages, on delicious, and on rabbitmq.com/how.html

alexis


On Tue, Dec 1, 2009 at 5:06 PM, Scott Brooks
<scott.brooks at epicadvertising.com> wrote:
> Here is the mib. ?I certainly don't claim to be an expert mib designer so there is probably room for improvement.
>
> It passes an erlc, smilint, and works with net-snmp, but beyond that I guarantee nothing.
>
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From alexis.richardson at gmail.com  Tue Dec 22 17:35:09 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 22 Dec 2009 17:35:09 +0000
Subject: [rabbitmq-discuss] amqp-js experiences?
In-Reply-To: <596D337E-633F-4DD3-AF91-336852C803B6@mac.com>
References: <596D337E-633F-4DD3-AF91-336852C803B6@mac.com>
Message-ID: <167204d20912220935w6072693amca15adb05c9c07c0@mail.gmail.com>

I am very interested in hearing about this too.

Has anyone tried to contact the author?

alexis


On Mon, Dec 21, 2009 at 4:07 PM, Chuck Remes <cremes.devlist at mac.com> wrote:
> I am doing some client-side (browser) coding these days and need to
> tap into my exchanges and queues. I have downloaded the amqp-js
> project from github but cannot get it to work at all.
>
> Has anyone used this project? Can you help me get the HelloWorld.html
> example working?
>
> cr
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From cremes.devlist at mac.com  Tue Dec 22 17:48:12 2009
From: cremes.devlist at mac.com (Chuck Remes)
Date: Tue, 22 Dec 2009 11:48:12 -0600
Subject: [rabbitmq-discuss] amqp-js experiences?
In-Reply-To: <167204d20912220935w6072693amca15adb05c9c07c0@mail.gmail.com>
References: <596D337E-633F-4DD3-AF91-336852C803B6@mac.com>
	<167204d20912220935w6072693amca15adb05c9c07c0@mail.gmail.com>
Message-ID: <94330143-3F74-406C-BF44-832BBDB25CCF@mac.com>


On Dec 22, 2009, at 11:35 AM, Alexis Richardson wrote:

> I am very interested in hearing about this too.
>
> Has anyone tried to contact the author?
>
> alexis
>
>
> On Mon, Dec 21, 2009 at 4:07 PM, Chuck Remes  
> <cremes.devlist at mac.com> wrote:
>> I am doing some client-side (browser) coding these days and need to
>> tap into my exchanges and queues. I have downloaded the amqp-js
>> project from github but cannot get it to work at all.
>>
>> Has anyone used this project? Can you help me get the HelloWorld.html
>> example working?

I just got the examples working with a little help from the author.

I am working on integrating it with a client-side application I am  
writing now with Cappuccino (OSX Cocoa frameworks ported to Javascript  
to run in the browser). I expect to have something functional by  
Monday. I'll let the list know how it went.

cr




From michael.justin at gmx.net  Wed Dec 23 14:06:45 2009
From: michael.justin at gmx.net (Michael Justin)
Date: Wed, 23 Dec 2009 15:06:45 +0100
Subject: [rabbitmq-discuss] RabbitMQ/Stomp on Windows
In-Reply-To: <26813626.post@talk.nabble.com>
References: <4B0E41CD.6020909@gmx.net> <4B13ABA1.7000806@lshift.net>
	<26813626.post@talk.nabble.com>
Message-ID: <4B3223F5.1040403@gmx.net>

Am 16.12.2009 17:05, mjustin wrote:
> Hello Matthias,
>
> many thanks for the link. I understand that I have to create a new
> configuration file on Windows and add the required parameters.
>
> If I start RabbitMQ (on Ubuntu), the startup script (makefile) seems to pass
> parameters and logs then to the console. I am not sure what the
> configuration file should look like, I have only the output of the startup
>
> make: Entering directory
> `/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-stomp'
> make -C ../rabbitmq-server run \
> 		RABBITMQ_SERVER_START_ARGS='-pa '"$(pwd)/ebin"' -rabbit \
> 			stomp_listeners [{\"10.0.2.15\",61613}] \
> 			extra_startup_steps [{\"STOMP-listeners\",rabbit_stomp,kickstart,[]}]'
> make[1]: Entering directory
> `/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-server'
> RABBITMQ_NODE_IP_ADDRESS="" RABBITMQ_NODE_PORT="" RABBITMQ_LOG_BASE="/tmp"
> RABBITMQ_MNESIA_DIR="/tmp/rabbitmq-rabbit-mnesia" \
> 		RABBITMQ_NODE_ONLY=true \
> 		RABBITMQ_SERVER_START_ARGS="-pa
> /home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-stomp/ebin -rabbit \
> 		stomp_listeners [{\"10.0.2.15\",61613}] \
> 		extra_startup_steps [{\"STOMP-listeners\",rabbit_stomp,kickstart,[]}] -s
> rabbit" \
> 		./scripts/rabbitmq-server
>
>
> I guess it is something like this:
>
>    [
>      {rabbit,
> 	[{stomp_listeners [{"10.0.2.15",61613}]},
> 	  extra_startup_steps [{"STOMP-listeners",	  rabbit_stomp,kickstart}]}
>               ]}
>    ].
>
>    

Hello Matthias,

I am still stuck with the Stomp configuration on Windows. Is there an 
example configuration file available somewhere which could be used on 
Windows to start the 1.7.0 binary release, and which activates the Stomp 
listener?


Regards,

-- 
Michael Justin
SCJP, SCJA
betasoft - Software for Delphi? and for the Java? platform
http://www.mikejustin.com - http://www.betabeans.de




From alexis.richardson at gmail.com  Wed Dec 23 16:35:43 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 23 Dec 2009 16:35:43 +0000
Subject: [rabbitmq-discuss] Scheduling algorithms
In-Reply-To: <4B2F4D9C.2030808@gmail.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>
	<4B2F4D9C.2030808@gmail.com>
Message-ID: <167204d20912230835h16432440s9acb2da19fe10dc0@mail.gmail.com>

Dragan

Sorry, do you mean:

* Scheduling used internally by RabbitMQ

Or do you mean:

* Recommended approaches to scheduling work when using RabbitMQ queues

?

alexis


On Mon, Dec 21, 2009 at 10:27 AM, Dragan Zubac <zubacdragan at gmail.com> wrote:
> Hello
>
> I was just wondering is there a variety of scheduling algorithms within
> RabbitMQ (round robin,fair queueing,etc) ?
>
> What is supported native and what is contributed if any ?
>
> Any case studies or so ?
>
> Sincerely
>
>
> Dragan Zubac
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From scott.brooks at epicadvertising.com  Wed Dec 23 17:02:52 2009
From: scott.brooks at epicadvertising.com (Scott Brooks)
Date: Wed, 23 Dec 2009 11:02:52 -0600
Subject: [rabbitmq-discuss] RabbitMQ SNMP Plugin
In-Reply-To: <167204d20912220832k56fcd05h55520ef9bd309372@mail.gmail.com>
References: <92562906-5DA3-452A-B7B1-3EF2B47B11E9@epicadvertising.com>
	<4B143B24.4020600@lshift.net>
	<BF7C8A76-0171-45F6-9B19-8FD49760270A@epicadvertising.com>
	<167204d20912220832k56fcd05h55520ef9bd309372@mail.gmail.com>
Message-ID: <05CF0B5A-249F-4426-BC97-646EB7FF50BA@epicadvertising.com>

I haven't had much of a chance to work on it, but in the new year I'll try and find a home for it on the Internet somewhere(probably github)

Scott

On 2009-12-22, at 11:32 AM, Alexis Richardson wrote:

> Scott
> 
> How are you getting on with this?  I'd like to link to it from our
> various info pages, on delicious, and on rabbitmq.com/how.html
> 
> alexis
> 
> 
> On Tue, Dec 1, 2009 at 5:06 PM, Scott Brooks
> <scott.brooks at epicadvertising.com> wrote:
>> Here is the mib.  I certainly don't claim to be an expert mib designer so there is probably room for improvement.
>> 
>> It passes an erlc, smilint, and works with net-snmp, but beyond that I guarantee nothing.
>> 
>> 
>> 
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> 
>> 

---------------------
Scott Brooks
Web Developer
Epic Advertising - New York, Toronto, San Francisco, London
www.EpicAdvertising.com
60 Columbia Way, Suite 310
Markham, ON L3R 0C9
(905) 946-0300 x2356 - phone
(888) 666-3120 - fax
scott.brooks at epicadvertising.com




From alexis.richardson at gmail.com  Thu Dec 24 08:07:41 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Thu, 24 Dec 2009 08:07:41 +0000
Subject: [rabbitmq-discuss] RabbitMQ/Stomp on Windows
In-Reply-To: <4B3223F5.1040403@gmx.net>
References: <4B0E41CD.6020909@gmx.net> <4B13ABA1.7000806@lshift.net>
	<26813626.post@talk.nabble.com> <4B3223F5.1040403@gmx.net>
Message-ID: <167204d20912240007r7a1d24edkda7e32d2c497f8d9@mail.gmail.com>

Michael

We won't be able to look at this for the next few days.  Initial
investigation suggests that, for Windows, your stomp plugin needs to
be in a different location.  It's a bit of a fiddle and I'm sorry
about that.  Once we have sorted this out for you, we'll document
"using plugins on Windows" better.

alexis



On Wed, Dec 23, 2009 at 2:06 PM, Michael Justin <michael.justin at gmx.net> wrote:
> Am 16.12.2009 17:05, mjustin wrote:
>> Hello Matthias,
>>
>> many thanks for the link. I understand that I have to create a new
>> configuration file on Windows and add the required parameters.
>>
>> If I start RabbitMQ (on Ubuntu), the startup script (makefile) seems to pass
>> parameters and logs then to the console. I am not sure what the
>> configuration file should look like, I have only the output of the startup
>>
>> make: Entering directory
>> `/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-stomp'
>> make -C ../rabbitmq-server run \
>> ? ? ? ? ? ? ? RABBITMQ_SERVER_START_ARGS='-pa '"$(pwd)/ebin"' -rabbit \
>> ? ? ? ? ? ? ? ? ? ? ? stomp_listeners [{\"10.0.2.15\",61613}] \
>> ? ? ? ? ? ? ? ? ? ? ? extra_startup_steps [{\"STOMP-listeners\",rabbit_stomp,kickstart,[]}]'
>> make[1]: Entering directory
>> `/home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-server'
>> RABBITMQ_NODE_IP_ADDRESS="" RABBITMQ_NODE_PORT="" RABBITMQ_LOG_BASE="/tmp"
>> RABBITMQ_MNESIA_DIR="/tmp/rabbitmq-rabbit-mnesia" \
>> ? ? ? ? ? ? ? RABBITMQ_NODE_ONLY=true \
>> ? ? ? ? ? ? ? RABBITMQ_SERVER_START_ARGS="-pa
>> /home/michael/Desktop/rabbitmq-public-umbrella/rabbitmq-stomp/ebin -rabbit \
>> ? ? ? ? ? ? ? stomp_listeners [{\"10.0.2.15\",61613}] \
>> ? ? ? ? ? ? ? extra_startup_steps [{\"STOMP-listeners\",rabbit_stomp,kickstart,[]}] -s
>> rabbit" \
>> ? ? ? ? ? ? ? ./scripts/rabbitmq-server
>>
>>
>> I guess it is something like this:
>>
>> ? ?[
>> ? ? ?{rabbit,
>> ? ? ? [{stomp_listeners [{"10.0.2.15",61613}]},
>> ? ? ? ? extra_startup_steps [{"STOMP-listeners", ? ? ? ?rabbit_stomp,kickstart}]}
>> ? ? ? ? ? ? ? ]}
>> ? ?].
>>
>>
>
> Hello Matthias,
>
> I am still stuck with the Stomp configuration on Windows. Is there an
> example configuration file available somewhere which could be used on
> Windows to start the 1.7.0 binary release, and which activates the Stomp
> listener?
>
>
> Regards,
>
> --
> Michael Justin
> SCJP, SCJA
> betasoft - Software for Delphi? and for the Java? platform
> http://www.mikejustin.com - http://www.betabeans.de
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From zubacdragan at gmail.com  Fri Dec 25 10:41:58 2009
From: zubacdragan at gmail.com (Dragan Zubac)
Date: Fri, 25 Dec 2009 11:41:58 +0100
Subject: [rabbitmq-discuss] Scheduling algorithms
In-Reply-To: <167204d20912230835h16432440s9acb2da19fe10dc0@mail.gmail.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>	
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>	
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>	
	<4B2F4D9C.2030808@gmail.com>
	<167204d20912230835h16432440s9acb2da19fe10dc0@mail.gmail.com>
Message-ID: <4B3496F6.5090301@gmail.com>

Hello

Let me explain it with some examples.

There are processes A,B and C that insert messages into RabbitMQ. All 
this messages should reach point D.

If A,B and C insert various number of messages into RabbitMQ,what 
algorithms will RMQ use to deliver those messages to D ?

Examples :

A inserts 100 messages
B inserts 100 messages
C inserts 100 messages

Will RMQ send all messages toward D in round-robin fashion or the 
delivery order will be undermined ? Or maybe in some other fashion ?

A inserts 100 messages
B inserts 100 messages
C inserts 1000 messages

What mechanisms one might have to deliver all this messages to D in 
desired fashion ? Somebody would like to deliver them in round-robin 
fashion (send 1 A's message,send 1 B's message,send 1 C's 
message),others might want to give higher priority to C's messages or so 
(example : send 10 A's messages,send 10 B's messages,send 100 C's 
messages),or some other model of delivery that business model could desire ?

I'm asking this questions because business model might be changed 
on-the-fly,so it might be very important to be able to change the 
behavior of delivery mechanism to satisfy those business model.

P.S.

I was lazy to add multiply destination points,but I guess You get the 
point with the above examples as well.

Sincerely

Alexis Richardson wrote:
> Dragan
>
> Sorry, do you mean:
>
> * Scheduling used internally by RabbitMQ
>
> Or do you mean:
>
> * Recommended approaches to scheduling work when using RabbitMQ queues
>
> ?
>
> alexis
>
>
> On Mon, Dec 21, 2009 at 10:27 AM, Dragan Zubac <zubacdragan at gmail.com> wrote:
>   
>> Hello
>>
>> I was just wondering is there a variety of scheduling algorithms within
>> RabbitMQ (round robin,fair queueing,etc) ?
>>
>> What is supported native and what is contributed if any ?
>>
>> Any case studies or so ?
>>
>> Sincerely
>>
>>
>> Dragan Zubac
>>
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>
>>     
>
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091225/3bf48b61/attachment.htm 

From matthew at lshift.net  Sat Dec 26 11:37:47 2009
From: matthew at lshift.net (Matthew Sackman)
Date: Sat, 26 Dec 2009 11:37:47 +0000
Subject: [rabbitmq-discuss] Scheduling algorithms
In-Reply-To: <4B3496F6.5090301@gmail.com>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>
	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>
	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>
	<4B2F4D9C.2030808@gmail.com>
	<167204d20912230835h16432440s9acb2da19fe10dc0@mail.gmail.com>
	<4B3496F6.5090301@gmail.com>
Message-ID: <20091226113747.GA374@wellquite.org>

Hi Dragan,

On Fri, Dec 25, 2009 at 11:41:58AM +0100, Dragan Zubac wrote:
> There are processes A,B and C that insert messages into RabbitMQ.
> All this messages should reach point D.

Right, so you have one exchange, and one queue, and you have D
consuming from that queue, and you have A, B and C publishing to the
exchange to which the queue is bound.

> If A,B and C insert various number of messages into RabbitMQ,what
> algorithms will RMQ use to deliver those messages to D ?

Delivery order is not defined except for messages from a single
publisher.

> Examples :
> 
> A inserts 100 messages
> B inserts 100 messages
> C inserts 100 messages

What, in parallel? Sequentially? Interleaved? In Rabbit, within a
one-node cluster, order is only determined once the message gets to the
queue. The exchange is a passive entity and can be used in parallel by
several channels.

> Will RMQ send all messages toward D in round-robin fashion or the
> delivery order will be undermined ? Or maybe in some other fashion ?

Once the messages are in the queue, they are delivered round-robin to
the consumers (with certain caveats). But in your case, you only have
one consumer so this doesn't affect you.

>From your terminology, I suspect you're thinking in a JMS-style way. You
may wish to read some of the introductions to AMQP.

> A inserts 100 messages
> B inserts 100 messages
> C inserts 1000 messages
> 
> What mechanisms one might have to deliver all this messages to D in
> desired fashion ? Somebody would like to deliver them in round-robin
> fashion (send 1 A's message,send 1 B's message,send 1 C's
> message),others might want to give higher priority to C's messages
> or so (example : send 10 A's messages,send 10 B's messages,send 100
> C's messages),or some other model of delivery that business model
> could desire ?

In AMQP, you never ever know to whom you're sending a message. You
publish a message to an exchange. After that, the publisher has (almost)
no idea what happens to the message. This is by design.

If, in the queue, you have A's 100 messages at the start, then B's 100
messages, then C's 1000 messages at the end, then that's the order
they'll come out in. You can't alter that. Also, Rabbit doesn't yet
implement message priorities.

What you could do instead, is to have A, B and C publish in such a way
that their messages get routed to three different queues. Then D can
consume from those queues as it wants - if it just wants all of A's
messages, it can just consume from that, and if it wants to force
round-robin, then by setting QoS prefetch count to 1, and careful use of
acking, it can consume from all three queues in a round robin manner.

Best wishes,

Matthew



From sustrik at imatix.com  Sat Dec 26 11:56:05 2009
From: sustrik at imatix.com (Martin Sustrik)
Date: Sat, 26 Dec 2009 12:56:05 +0100
Subject: [rabbitmq-discuss] Scheduling algorithms
In-Reply-To: <20091226113747.GA374@wellquite.org>
References: <8F16BDCC98E64841857E711110AF5EDD01074AFD6C5A@EXMBX01.wealthcraft.local>	<91F2F22C-F8A0-4CED-9880-DB32000E55DA@mac.com>	<8F16BDCC98E64841857E711110AF5EDD01074AFD6C63@EXMBX01.wealthcraft.local>	<4B2F4D9C.2030808@gmail.com>	<167204d20912230835h16432440s9acb2da19fe10dc0@mail.gmail.com>	<4B3496F6.5090301@gmail.com>
	<20091226113747.GA374@wellquite.org>
Message-ID: <4B35F9D5.2000804@imatix.com>

Matthew Sackman wrote:

> If, in the queue, you have A's 100 messages at the start, then B's 100
> messages, then C's 1000 messages at the end, then that's the order
> they'll come out in. You can't alter that.

Right. The common practice in MQ systems is that messages are placed on 
a queue immediately at their arrival. The queue is a linear list of 
messages, thus the strict message ordering is established at that point. 
The messages are sent further in the same order. While AMQP 
specification doesn't explicitly impose this algorithm, the 
implementations are implicitly assumed to behave this way.

Martin



From bsullivan at lindenlab.com  Mon Dec 28 02:58:19 2009
From: bsullivan at lindenlab.com (Brian Sullivan)
Date: Sun, 27 Dec 2009 21:58:19 -0500
Subject: [rabbitmq-discuss] python client support for channel.flow
Message-ID: <b93cb8620912271858s7f0311dch2f8e18cde9a6d7e3@mail.gmail.com>

Hi,

I wanted to follow up on an issue that's been on our radar for a while, but
I haven't seen any updates on it and wanted to see what our options might be
here.

We have been leveraging the py-amqplib client library with rabbitmq, which
has performed quite well in our application with one main limitation.  The
main issue we have with it is that it does not currently support the
Channel.Flow message from an AMQP broker - which means when the server tries
to prevent a producing client app from overloading the system, the client
ignores the message and continues sending.  Since RabbitMQ will continue to
process until it allocates all of its memory, it dies a horrible death and
all of the messages in the broker are lost (reproduction steps below).

Two basic questions:
1) What are my alternatives here from a python client side?  I have
periodically checked into this with Barry for the py-amqplib, but it appears
to involve a pretty significant code restructuring (if I remember correctly,
it had to do with the synchronous processing of messages).  We need a fully
baked client, and Barry's client works well in normal situations - we just
need it to be more fault-tolerant in the heavy saturation cases to prevent
production failures.

2) If there are no viable options from a python client right now, what
prevents you guys from adding some code to the rabbitmq broker from simply
failing a connection that refuses to honor the Channel.Flow message when it
has been broadcast?  I asked this back in 1.5.0 (or around there), and think
this would be a great safety mechanism to prevent a single rogue client from
bringing down a broker.

Any help here would be greatly appreciated.  This has bitten us a few times
in the past and is the weakest part of our pipeline right now.  We are able
to buffer our messages on disk on the producer side, so any stoppage at the
rabbitmq side would simply cause our producer app to retry a connection and
resume transmission.

I don't read this list as actively as I would like, but I didn't find any
recent posts on this from any searches I was able to come up with.
Hopefully the answer is out there and I have just missed it.  Please let me
know if I need to give more info here to help drive the discussion.

Thanks,
Brian

==== Reproduction steps ====

Attached is my failure case test script.  In a nutshell, the test is as
follows:
- Create non-auto-delete queue, bound to a topic
- Spam that topic using the attached script until it maxes out the memory on
the machine (luckily, my test box is only 2GB so this does not take too
long)
- You can see the alerts fire in the /var/log/rabbitmq/rabbit.log file, but
no active flag is set on the Channel object on the Python client side.
- One note is that I am talking to a 1.5.3 broker, but the Channel.Flow
should be working fine in that version, this is the client's handling that I
am focusing on.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091227/d9ae1653/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rmq-spam.py
Type: application/octet-stream
Size: 2525 bytes
Desc: not available
Url : http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091227/d9ae1653/attachment.obj 

From joe at joetify.com  Mon Dec 28 06:27:17 2009
From: joe at joetify.com (Joe Williams)
Date: Sun, 27 Dec 2009 22:27:17 -0800
Subject: [rabbitmq-discuss] ocaml libs
Message-ID: <4B384FC5.1050305@joetify.com>

I haven't been able to find anything. Anyone know of a good OCaml AMQP 
client library?

Thanks.

-Joe

-- 
Name: Joseph A. Williams
Email: joe at joetify.com
Blog: http://www.joeandmotorboat.com/




From alexis.richardson at gmail.com  Mon Dec 28 10:22:14 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Mon, 28 Dec 2009 10:22:14 +0000
Subject: [rabbitmq-discuss] ocaml libs
In-Reply-To: <4B384FC5.1050305@joetify.com>
References: <4B384FC5.1050305@joetify.com>
Message-ID: <167204d20912280222t2a0cfa9em219ffbd8c0e97e1d@mail.gmail.com>

Joe,

On Mon, Dec 28, 2009 at 6:27 AM, Joe Williams <joe at joetify.com> wrote:
> I haven't been able to find anything. Anyone know of a good OCaml AMQP
> client library?

Ha :-)

Well, the closest I have seen to this on the web is the following
debate on the utility and clarity of STOMP, variously implemented by
RabbitMQ, ActiveMQ and others.
http://eigenclass.org/R2/writings/rabbitmq-STOMP-semantics

Of course that does not really answer your question.

We do know of at least one customer in production with RabbitMQ from
F#.  Would an introduction be helpful?

alexis



>
> Thanks.
>
> -Joe
>
> --
> Name: Joseph A. Williams
> Email: joe at joetify.com
> Blog: http://www.joeandmotorboat.com/
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From tonyg at lshift.net  Mon Dec 28 11:59:26 2009
From: tonyg at lshift.net (Tony Garnock-Jones)
Date: Mon, 28 Dec 2009 11:59:26 +0000
Subject: [rabbitmq-discuss] ocaml libs
In-Reply-To: <4B384FC5.1050305@joetify.com>
References: <4B384FC5.1050305@joetify.com>
Message-ID: <4B389D9E.8030009@lshift.net>

Hi Joe,

I was looking into this over the xmas break. It ought to be possible to
get something working fairly quickly, but whether it'll work well or
efficiently I don't know. The biggest missing piece was integration
between sockets and the Event module. Alternatives like Lwt 2.0 were a
bit disappointing. I suppose plain old threading could work well enough;
I don't know enough of OCaml style and idiom to know what is the right
approach here.

I looked into SML/NJ, as well. What a lovely system! The lightweight
continuations make for good integration between sockets and CML. So, if
it were my spare time, I'd likely build an SML/NJ library rather than an
OCaml one :-)

Regards,
  Tony


Joe Williams wrote:
> I haven't been able to find anything. Anyone know of a good OCaml AMQP 
> client library?
> 
> Thanks.
> 
> -Joe
> 



From joe at joetify.com  Mon Dec 28 18:43:59 2009
From: joe at joetify.com (Joe Williams)
Date: Mon, 28 Dec 2009 10:43:59 -0800
Subject: [rabbitmq-discuss] ocaml libs
In-Reply-To: <167204d20912280222t2a0cfa9em219ffbd8c0e97e1d@mail.gmail.com>
References: <4B384FC5.1050305@joetify.com>
	<167204d20912280222t2a0cfa9em219ffbd8c0e97e1d@mail.gmail.com>
Message-ID: <4B38FC6F.9040103@joetify.com>

Thanks Alexis, an intro might be good to get an idea where to start.

-Joe


On 12/28/09 2:22 AM, Alexis Richardson wrote:
> Joe,
>
> On Mon, Dec 28, 2009 at 6:27 AM, Joe Williams<joe at joetify.com>  wrote:
>    
>> I haven't been able to find anything. Anyone know of a good OCaml AMQP
>> client library?
>>      
> Ha :-)
>
> Well, the closest I have seen to this on the web is the following
> debate on the utility and clarity of STOMP, variously implemented by
> RabbitMQ, ActiveMQ and others.
> http://eigenclass.org/R2/writings/rabbitmq-STOMP-semantics
>
> Of course that does not really answer your question.
>
> We do know of at least one customer in production with RabbitMQ from
> F#.  Would an introduction be helpful?
>
> alexis
>
>
>
>    
>> Thanks.
>>
>> -Joe
>>
>> --
>> Name: Joseph A. Williams
>> Email: joe at joetify.com
>> Blog: http://www.joeandmotorboat.com/
>>
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>
>>      

-- 
Name: Joseph A. Williams
Email: joe at joetify.com
Blog: http://www.joeandmotorboat.com/




From joe at joetify.com  Mon Dec 28 18:47:42 2009
From: joe at joetify.com (Joe Williams)
Date: Mon, 28 Dec 2009 10:47:42 -0800
Subject: [rabbitmq-discuss] ocaml libs
In-Reply-To: <4B389D9E.8030009@lshift.net>
References: <4B384FC5.1050305@joetify.com> <4B389D9E.8030009@lshift.net>
Message-ID: <4B38FD4E.1090309@joetify.com>

Thanks Tony,  I'll take a look at SML/NJ.

-Joe


On 12/28/09 3:59 AM, Tony Garnock-Jones wrote:
> Hi Joe,
>
> I was looking into this over the xmas break. It ought to be possible to
> get something working fairly quickly, but whether it'll work well or
> efficiently I don't know. The biggest missing piece was integration
> between sockets and the Event module. Alternatives like Lwt 2.0 were a
> bit disappointing. I suppose plain old threading could work well enough;
> I don't know enough of OCaml style and idiom to know what is the right
> approach here.
>
> I looked into SML/NJ, as well. What a lovely system! The lightweight
> continuations make for good integration between sockets and CML. So, if
> it were my spare time, I'd likely build an SML/NJ library rather than an
> OCaml one :-)
>
> Regards,
>    Tony
>
>
> Joe Williams wrote:
>    
>> I haven't been able to find anything. Anyone know of a good OCaml AMQP
>> client library?
>>
>> Thanks.
>>
>> -Joe
>>
>>      

-- 
Name: Joseph A. Williams
Email: joe at joetify.com
Blog: http://www.joeandmotorboat.com/




From joe at joetify.com  Mon Dec 28 19:17:48 2009
From: joe at joetify.com (Joe Williams)
Date: Mon, 28 Dec 2009 11:17:48 -0800
Subject: [rabbitmq-discuss] ocaml libs
In-Reply-To: <4B38FD4E.1090309@joetify.com>
References: <4B384FC5.1050305@joetify.com> <4B389D9E.8030009@lshift.net>
	<4B38FD4E.1090309@joetify.com>
Message-ID: <4B39045C.1010802@joetify.com>

Tony,

Looking at Lwt it seems that for an OCaml AMQP lib it might be the 
(only?) way to go. I bet you're right though regarding the inadequacies 
of Lwt and missing piece between sockets and events otherwise there 
would probably already be an AMQP lib. :)

-Joe


On 12/28/09 10:47 AM, Joe Williams wrote:
> Thanks Tony,  I'll take a look at SML/NJ.
>
> -Joe
>
>
> On 12/28/09 3:59 AM, Tony Garnock-Jones wrote:
>    
>> Hi Joe,
>>
>> I was looking into this over the xmas break. It ought to be possible to
>> get something working fairly quickly, but whether it'll work well or
>> efficiently I don't know. The biggest missing piece was integration
>> between sockets and the Event module. Alternatives like Lwt 2.0 were a
>> bit disappointing. I suppose plain old threading could work well enough;
>> I don't know enough of OCaml style and idiom to know what is the right
>> approach here.
>>
>> I looked into SML/NJ, as well. What a lovely system! The lightweight
>> continuations make for good integration between sockets and CML. So, if
>> it were my spare time, I'd likely build an SML/NJ library rather than an
>> OCaml one :-)
>>
>> Regards,
>>     Tony
>>
>>
>> Joe Williams wrote:
>>
>>      
>>> I haven't been able to find anything. Anyone know of a good OCaml AMQP
>>> client library?
>>>
>>> Thanks.
>>>
>>> -Joe
>>>
>>>
>>>        
>    

-- 
Name: Joseph A. Williams
Email: joe at joetify.com
Blog: http://www.joeandmotorboat.com/




From alexis.richardson at gmail.com  Mon Dec 28 21:18:07 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Mon, 28 Dec 2009 21:18:07 +0000
Subject: [rabbitmq-discuss] python client support for channel.flow
In-Reply-To: <b93cb8620912271858s7f0311dch2f8e18cde9a6d7e3@mail.gmail.com>
References: <b93cb8620912271858s7f0311dch2f8e18cde9a6d7e3@mail.gmail.com>
Message-ID: <167204d20912281318v5304f53fud6296818817192b3@mail.gmail.com>

Brian

Have you looked at pika?  http://github.com/tonyg/pika

Sorry to be brief; I hope to reply at greater length in a couple of days.

alexis


On Mon, Dec 28, 2009 at 2:58 AM, Brian Sullivan <bsullivan at lindenlab.com> wrote:
> Hi,
>
> I wanted to follow up on an issue that's been on our radar for a while, but
> I haven't seen any updates on it and wanted to see what our options might be
> here.
>
> We have been leveraging the py-amqplib client library with rabbitmq, which
> has performed quite well in our application with one main limitation.? The
> main issue we have with it is that it does not currently support the
> Channel.Flow message from an AMQP broker - which means when the server tries
> to prevent a producing client app from overloading the system, the client
> ignores the message and continues sending.? Since RabbitMQ will continue to
> process until it allocates all of its memory, it dies a horrible death and
> all of the messages in the broker are lost (reproduction steps below).
>
> Two basic questions:
> 1) What are my alternatives here from a python client side?? I have
> periodically checked into this with Barry for the py-amqplib, but it appears
> to involve a pretty significant code restructuring (if I remember correctly,
> it had to do with the synchronous processing of messages).? We need a fully
> baked client, and Barry's client works well in normal situations - we just
> need it to be more fault-tolerant in the heavy saturation cases to prevent
> production failures.
>
> 2) If there are no viable options from a python client right now, what
> prevents you guys from adding some code to the rabbitmq broker from simply
> failing a connection that refuses to honor the Channel.Flow message when it
> has been broadcast?? I asked this back in 1.5.0 (or around there), and think
> this would be a great safety mechanism to prevent a single rogue client from
> bringing down a broker.
>
> Any help here would be greatly appreciated.? This has bitten us a few times
> in the past and is the weakest part of our pipeline right now.? We are able
> to buffer our messages on disk on the producer side, so any stoppage at the
> rabbitmq side would simply cause our producer app to retry a connection and
> resume transmission.
>
> I don't read this list as actively as I would like, but I didn't find any
> recent posts on this from any searches I was able to come up with.
> Hopefully the answer is out there and I have just missed it.? Please let me
> know if I need to give more info here to help drive the discussion.
>
> Thanks,
> Brian
>
> ==== Reproduction steps ====
>
> Attached is my failure case test script.? In a nutshell, the test is as
> follows:
> - Create non-auto-delete queue, bound to a topic
> - Spam that topic using the attached script until it maxes out the memory on
> the machine (luckily, my test box is only 2GB so this does not take too
> long)
> - You can see the alerts fire in the /var/log/rabbitmq/rabbit.log file, but
> no active flag is set on the Channel object on the Python client side.
> - One note is that I am talking to a 1.5.3 broker, but the Channel.Flow
> should be working fine in that version, this is the client's handling that I
> am focusing on.
>
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From pathsny at gmail.com  Tue Dec 29 04:37:49 2009
From: pathsny at gmail.com (vishnu)
Date: Tue, 29 Dec 2009 10:07:49 +0530
Subject: [rabbitmq-discuss] adjusting timeout for non-acked messages to be
	requeued
Message-ID: <c89c65ea0912282037x7f04d9d6p13da2530eb8ce1e3@mail.gmail.com>

Hi
    I'm trying to use rabbitmq for an web application thats close to
synchronous. The main reason I'm looking at rabbitmq is for the reliability
and transactionality. The idea is for the webapplication to pump messages
into the queue and for a down stream application to subscribe in
acknowledgement mode and for each message start a transaction, attempt to
process the message and if it fails for technical reasons, to rollback the
transaction.

However, I would like to be able to configure the time for non-acked
messages to get requeued to be picked up. Where can this be done?

thanks
Vishnu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091229/66ef28cb/attachment.htm 

From alexis.richardson at gmail.com  Tue Dec 29 13:48:25 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 29 Dec 2009 13:48:25 +0000
Subject: [rabbitmq-discuss] adjusting timeout for non-acked messages to
	be requeued
In-Reply-To: <c89c65ea0912282037x7f04d9d6p13da2530eb8ce1e3@mail.gmail.com>
References: <c89c65ea0912282037x7f04d9d6p13da2530eb8ce1e3@mail.gmail.com>
Message-ID: <167204d20912290548n2bef2766s5d6c00cee28aaf2f@mail.gmail.com>

Vishnu

On Tue, Dec 29, 2009 at 4:37 AM, vishnu <pathsny at gmail.com> wrote:
> Hi
> ? ? I'm trying to use rabbitmq for an web application thats close to
> synchronous. The main reason I'm looking at rabbitmq is for the reliability
> and transactionality. The idea is for the webapplication to pump messages
> into the queue and for a down stream application to subscribe in
> acknowledgement mode and for each message start a transaction, attempt to
> process the message and if it fails for technical reasons, to rollback the
> transaction.

OK.


> However, I would like to be able to configure the time for non-acked
> messages to get requeued to be picked up. Where can this be done?

This and other 'time based' behaviours are frequently requested, but
*alas* are not yet built-in to RabbitMQ.

However, don't give up.  You could create a consumer (in any language)
which managed this for you, eg enforcing a disconnect after some time
has passed.  Or, if you are feeling brave you could create a plugin to
do this 'inside the broker'.  Plugins have to be written in erlang.

I hope that helps.  Perhaps the list will have more immediately useful
suggestions.

Cheers,

alexis



> thanks
> Vishnu
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From jasonjwwilliams at gmail.com  Tue Dec 29 15:17:38 2009
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Tue, 29 Dec 2009 09:17:38 -0600
Subject: [rabbitmq-discuss] python client support for channel.flow
In-Reply-To: <167204d20912281318v5304f53fud6296818817192b3@mail.gmail.com>
References: <b93cb8620912271858s7f0311dch2f8e18cde9a6d7e3@mail.gmail.com>
	<167204d20912281318v5304f53fud6296818817192b3@mail.gmail.com>
Message-ID: <3b949f090912290717x14d77decu50aa1fa8b6c7a044@mail.gmail.com>

When will Pika implement it's own exceptions? Atm, I'd like to start
using it instead of py-amqplib, but I think I'd rather have a root
canal than reverse engineer all the possible exceptions again (like
you have to with py-ampqlib).

-J

On Mon, Dec 28, 2009 at 3:18 PM, Alexis Richardson
<alexis.richardson at gmail.com> wrote:
> Brian
>
> Have you looked at pika? ?http://github.com/tonyg/pika
>
> Sorry to be brief; I hope to reply at greater length in a couple of days.
>
> alexis
>
>
> On Mon, Dec 28, 2009 at 2:58 AM, Brian Sullivan <bsullivan at lindenlab.com> wrote:
>> Hi,
>>
>> I wanted to follow up on an issue that's been on our radar for a while, but
>> I haven't seen any updates on it and wanted to see what our options might be
>> here.
>>
>> We have been leveraging the py-amqplib client library with rabbitmq, which
>> has performed quite well in our application with one main limitation.? The
>> main issue we have with it is that it does not currently support the
>> Channel.Flow message from an AMQP broker - which means when the server tries
>> to prevent a producing client app from overloading the system, the client
>> ignores the message and continues sending.? Since RabbitMQ will continue to
>> process until it allocates all of its memory, it dies a horrible death and
>> all of the messages in the broker are lost (reproduction steps below).
>>
>> Two basic questions:
>> 1) What are my alternatives here from a python client side?? I have
>> periodically checked into this with Barry for the py-amqplib, but it appears
>> to involve a pretty significant code restructuring (if I remember correctly,
>> it had to do with the synchronous processing of messages).? We need a fully
>> baked client, and Barry's client works well in normal situations - we just
>> need it to be more fault-tolerant in the heavy saturation cases to prevent
>> production failures.
>>
>> 2) If there are no viable options from a python client right now, what
>> prevents you guys from adding some code to the rabbitmq broker from simply
>> failing a connection that refuses to honor the Channel.Flow message when it
>> has been broadcast?? I asked this back in 1.5.0 (or around there), and think
>> this would be a great safety mechanism to prevent a single rogue client from
>> bringing down a broker.
>>
>> Any help here would be greatly appreciated.? This has bitten us a few times
>> in the past and is the weakest part of our pipeline right now.? We are able
>> to buffer our messages on disk on the producer side, so any stoppage at the
>> rabbitmq side would simply cause our producer app to retry a connection and
>> resume transmission.
>>
>> I don't read this list as actively as I would like, but I didn't find any
>> recent posts on this from any searches I was able to come up with.
>> Hopefully the answer is out there and I have just missed it.? Please let me
>> know if I need to give more info here to help drive the discussion.
>>
>> Thanks,
>> Brian
>>
>> ==== Reproduction steps ====
>>
>> Attached is my failure case test script.? In a nutshell, the test is as
>> follows:
>> - Create non-auto-delete queue, bound to a topic
>> - Spam that topic using the attached script until it maxes out the memory on
>> the machine (luckily, my test box is only 2GB so this does not take too
>> long)
>> - You can see the alerts fire in the /var/log/rabbitmq/rabbit.log file, but
>> no active flag is set on the Channel object on the Python client side.
>> - One note is that I am talking to a 1.5.3 broker, but the Channel.Flow
>> should be working fine in that version, this is the client's handling that I
>> am focusing on.
>>
>>
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>
>>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From pathsny at gmail.com  Tue Dec 29 20:34:52 2009
From: pathsny at gmail.com (vishnu)
Date: Wed, 30 Dec 2009 02:04:52 +0530
Subject: [rabbitmq-discuss] adjusting timeout for non-acked messages to
	be requeued
In-Reply-To: <167204d20912290706n23d5b13frb1cd02b0802d3b7e@mail.gmail.com>
References: <c89c65ea0912282037x7f04d9d6p13da2530eb8ce1e3@mail.gmail.com>
	<167204d20912290548n2bef2766s5d6c00cee28aaf2f@mail.gmail.com>
	<c89c65ea0912290657v313c8c72te0330365d7aae349@mail.gmail.com>
	<167204d20912290706n23d5b13frb1cd02b0802d3b7e@mail.gmail.com>
Message-ID: <c89c65ea0912291234s1fbbf958nc64e9e91071439b1@mail.gmail.com>

Adding back to the list, sorry stupid email client.

would anyone know how this decision is made? When unacked messages get
requeued to be sent? I know it happens if the client disconnects, but does
it also happen on rollback?

Im trying to setup a system whereby if my subscriber picks up an item from
the queue and for some reason is unable to handle it, the item gets readded
to the queue


On Tue, Dec 29, 2009 at 8:36 PM, Alexis Richardson <
alexis.richardson at gmail.com> wrote:

> Vishnu
>
> On Tue, Dec 29, 2009 at 2:57 PM, vishnu <pathsny at gmail.com> wrote:
> > hi, sorry Im a bit confused. But the behavior of moving the message from
> the
> > unacknowledge queue to the ready queue is already a part of rabbitmq.
>
> In what way?
>
>
> > There
> > must be some magic constant somewhere which governs this musn't there?
>
> If there were then it need not be time-based.
>
> alexis
>
>
> > On Tue, Dec 29, 2009 at 7:18 PM, Alexis Richardson
> > <alexis.richardson at gmail.com> wrote:
> >>
> >> Vishnu
> >>
> >> On Tue, Dec 29, 2009 at 4:37 AM, vishnu <pathsny at gmail.com> wrote:
> >> > Hi
> >> >     I'm trying to use rabbitmq for an web application thats close to
> >> > synchronous. The main reason I'm looking at rabbitmq is for the
> >> > reliability
> >> > and transactionality. The idea is for the webapplication to pump
> >> > messages
> >> > into the queue and for a down stream application to subscribe in
> >> > acknowledgement mode and for each message start a transaction, attempt
> >> > to
> >> > process the message and if it fails for technical reasons, to rollback
> >> > the
> >> > transaction.
> >>
> >> OK.
> >>
> >>
> >> > However, I would like to be able to configure the time for non-acked
> >> > messages to get requeued to be picked up. Where can this be done?
> >>
> >> This and other 'time based' behaviours are frequently requested, but
> >> *alas* are not yet built-in to RabbitMQ.
> >>
> >> However, don't give up.  You could create a consumer (in any language)
> >> which managed this for you, eg enforcing a disconnect after some time
> >> has passed.  Or, if you are feeling brave you could create a plugin to
> >> do this 'inside the broker'.  Plugins have to be written in erlang.
> >>
> >> I hope that helps.  Perhaps the list will have more immediately useful
> >> suggestions.
> >>
> >> Cheers,
> >>
> >> alexis
> >>
> >>
> >>
> >> > thanks
> >> > Vishnu
> >> > _______________________________________________
> >> > rabbitmq-discuss mailing list
> >> > rabbitmq-discuss at lists.rabbitmq.com
> >> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >> >
> >> >
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/f8da8816/attachment.htm 

From alexis.richardson at gmail.com  Tue Dec 29 23:04:06 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Tue, 29 Dec 2009 23:04:06 +0000
Subject: [rabbitmq-discuss] adjusting timeout for non-acked messages to
	be requeued
In-Reply-To: <c89c65ea0912291234s1fbbf958nc64e9e91071439b1@mail.gmail.com>
References: <c89c65ea0912282037x7f04d9d6p13da2530eb8ce1e3@mail.gmail.com>
	<167204d20912290548n2bef2766s5d6c00cee28aaf2f@mail.gmail.com>
	<c89c65ea0912290657v313c8c72te0330365d7aae349@mail.gmail.com>
	<167204d20912290706n23d5b13frb1cd02b0802d3b7e@mail.gmail.com>
	<c89c65ea0912291234s1fbbf958nc64e9e91071439b1@mail.gmail.com>
Message-ID: <167204d20912291504h121bb51bob14a97af735d8d2b@mail.gmail.com>

Vishnu

I am not the best person to answer this question, but I can tell you
that your behaviour can be achieved without requiring timers.

Assuming you are unwilling to simply close the channel and force the
requeue, then:

1. You could explicitly requeue by re-publishing the message.  No need
to use acks here.

2. You could look at what one of the many task management systems do.
For example celery or quebert.

http://ask.github.com/celery/introduction.html
http://bytebucket.org/adroll/quebert/

Or look at the list here: http://delicious.com/alexisrichardson/rabbitmq+work

3. Other ways to force a requeue.  I am not going to try and describe
these yet, in case I say something misleading.

Let me know what you think.

alexis



On Tue, Dec 29, 2009 at 8:34 PM, vishnu <pathsny at gmail.com> wrote:
> Adding back to the list, sorry stupid email client.
>
> would anyone know how this decision is made? When unacked messages get
> requeued to be sent? I know it happens if the client disconnects, but does
> it also happen on rollback?
> Im trying to setup a system whereby if my subscriber picks up an item from
> the queue and for some reason is unable to handle it, the item gets readded
> to the queue
>
> On Tue, Dec 29, 2009 at 8:36 PM, Alexis Richardson
> <alexis.richardson at gmail.com> wrote:
>>
>> Vishnu
>>
>> On Tue, Dec 29, 2009 at 2:57 PM, vishnu <pathsny at gmail.com> wrote:
>> > hi, sorry Im a bit confused. But the behavior of moving the message from
>> > the
>> > unacknowledge queue to the ready queue is already a part of rabbitmq.
>>
>> In what way?
>>
>>
>> > There
>> > must be some magic constant somewhere which governs this musn't there?
>>
>> If there were then it need not be time-based.
>>
>> alexis
>>
>>
>> > On Tue, Dec 29, 2009 at 7:18 PM, Alexis Richardson
>> > <alexis.richardson at gmail.com> wrote:
>> >>
>> >> Vishnu
>> >>
>> >> On Tue, Dec 29, 2009 at 4:37 AM, vishnu <pathsny at gmail.com> wrote:
>> >> > Hi
>> >> > ? ? I'm trying to use rabbitmq for an web application thats close to
>> >> > synchronous. The main reason I'm looking at rabbitmq is for the
>> >> > reliability
>> >> > and transactionality. The idea is for the webapplication to pump
>> >> > messages
>> >> > into the queue and for a down stream application to subscribe in
>> >> > acknowledgement mode and for each message start a transaction,
>> >> > attempt
>> >> > to
>> >> > process the message and if it fails for technical reasons, to
>> >> > rollback
>> >> > the
>> >> > transaction.
>> >>
>> >> OK.
>> >>
>> >>
>> >> > However, I would like to be able to configure the time for non-acked
>> >> > messages to get requeued to be picked up. Where can this be done?
>> >>
>> >> This and other 'time based' behaviours are frequently requested, but
>> >> *alas* are not yet built-in to RabbitMQ.
>> >>
>> >> However, don't give up. ?You could create a consumer (in any language)
>> >> which managed this for you, eg enforcing a disconnect after some time
>> >> has passed. ?Or, if you are feeling brave you could create a plugin to
>> >> do this 'inside the broker'. ?Plugins have to be written in erlang.
>> >>
>> >> I hope that helps. ?Perhaps the list will have more immediately useful
>> >> suggestions.
>> >>
>> >> Cheers,
>> >>
>> >> alexis
>> >>
>> >>
>> >>
>> >> > thanks
>> >> > Vishnu
>> >> > _______________________________________________
>> >> > rabbitmq-discuss mailing list
>> >> > rabbitmq-discuss at lists.rabbitmq.com
>> >> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >> >
>> >> >
>> >
>> >
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From jdunck at gmail.com  Wed Dec 30 00:39:28 2009
From: jdunck at gmail.com (Jeremy Dunck)
Date: Tue, 29 Dec 2009 18:39:28 -0600
Subject: [rabbitmq-discuss] .Net client foreground threads
Message-ID: <2545a92c0912291639j30947627m5636329a0927df83@mail.gmail.com>

Is there a reason for the main loop and heartbeat threads to be
Foreground threads?  I was expecting my process to die when my last
app thread died, but the Rabbit threads are Foreground (the default)
so they keep the process alive.

I know I could do connection.Close, but I'd rather be irresponsible
with my connection lifecycle.



From coolkarthik88 at gmail.com  Wed Dec 30 02:26:41 2009
From: coolkarthik88 at gmail.com (Karthik)
Date: Wed, 30 Dec 2009 07:56:41 +0530
Subject: [rabbitmq-discuss] Deploying RabitMQ for my Application - Questions
	and Doubts
Message-ID: <96f68a7a0912291826x407a2d26nba204be8af49b3d6@mail.gmail.com>

Hi,

I am looking for a solution for the problem that am currently looking
to solve... I am trying to build a scalable AMQP Messaging system,
where multiple bots(in the range of 1 for each country in the world)
push out messages to clients spread all over the world. The
communication will be truly one to one, that is one server bot will
communicate with bots, and each client is assigned one server bot.
Messages are mostly private, i.e. only from the server to client and
vice versa.

There can be anywhere between 10-50 Million Concurrent Clients,
Messages are in the size of 2-3KB(Well formed XML), that can be
transmitted in the both the directions i.e. Client->Server(bots) and
vice versa.... My estimates put at the messages to be going outwards
in either directions somewhere in the range of 50-100 messages/second.

The Clients will need to send/receive all the information as encrypted
data using SSL+TLS and any other scheme..

Will RabbitMQ be a good choice for the kind of the problem I'm trying
to solve..

Any help will be appreciated.. Also how much better is using AMQP
based RabbitMQ in comparison to XMPP based Ejabberd/Openfire etc?

Regards,
Karthik Kastury

http://dailyapps.net/ | +91 9739864254
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/f7368393/attachment.htm 

From pathsny at gmail.com  Wed Dec 30 03:37:53 2009
From: pathsny at gmail.com (vishnu)
Date: Wed, 30 Dec 2009 09:07:53 +0530
Subject: [rabbitmq-discuss] adjusting timeout for non-acked messages to
	be requeued
In-Reply-To: <167204d20912291504h121bb51bob14a97af735d8d2b@mail.gmail.com>
References: <c89c65ea0912282037x7f04d9d6p13da2530eb8ce1e3@mail.gmail.com>
	<167204d20912290548n2bef2766s5d6c00cee28aaf2f@mail.gmail.com>
	<c89c65ea0912290657v313c8c72te0330365d7aae349@mail.gmail.com>
	<167204d20912290706n23d5b13frb1cd02b0802d3b7e@mail.gmail.com>
	<c89c65ea0912291234s1fbbf958nc64e9e91071439b1@mail.gmail.com>
	<167204d20912291504h121bb51bob14a97af735d8d2b@mail.gmail.com>
Message-ID: <c89c65ea0912291937o7b7b6ff8r161222adc358dcbe@mail.gmail.com>

Hi Alexis
   thanks, I think Im getting a better understanding now. Initially I wanted
to look at auto requeueing for circumstances when my client subscribing to
events went down or got disconnected. Now my understanding is that in those
cases, messages get auto requeued.
    However, if I choose not to autoack, then it looks like the
responsibility of requeuing a client, forcing a time delay on the delivery
and also maybe forcing a limit on the number of passes through the queue is
going to have to become subscriber responsibility. I was hoping to handle
that as a configuration on the queue itself outside of code, but I guess
that isn't possible.

(the use case we have requires us to make sure that every message is
processed as far as possible. Meaning actual failures and successes are sent
onward, but failures for technical reasons require us to try again later, by
which time the technical issue might have been resolved).

Im taking a look now at the task management systems now.

Please do describe the other ways of forcing a requeue, I'd love to know
what my options are.

On Wed, Dec 30, 2009 at 4:34 AM, Alexis Richardson <
alexis.richardson at gmail.com> wrote:

> Vishnu
>
> I am not the best person to answer this question, but I can tell you
> that your behaviour can be achieved without requiring timers.
>
> Assuming you are unwilling to simply close the channel and force the
> requeue, then:
>
> 1. You could explicitly requeue by re-publishing the message.  No need
> to use acks here.
>
> 2. You could look at what one of the many task management systems do.
> For example celery or quebert.
>
> http://ask.github.com/celery/introduction.html
> http://bytebucket.org/adroll/quebert/
>
> Or look at the list here:
> http://delicious.com/alexisrichardson/rabbitmq+work
>
> 3. Other ways to force a requeue.  I am not going to try and describe
> these yet, in case I say something misleading.
>
> Let me know what you think.
>
> alexis
>
>
>
> On Tue, Dec 29, 2009 at 8:34 PM, vishnu <pathsny at gmail.com> wrote:
> > Adding back to the list, sorry stupid email client.
> >
> > would anyone know how this decision is made? When unacked messages get
> > requeued to be sent? I know it happens if the client disconnects, but
> does
> > it also happen on rollback?
> > Im trying to setup a system whereby if my subscriber picks up an item
> from
> > the queue and for some reason is unable to handle it, the item gets
> readded
> > to the queue
> >
> > On Tue, Dec 29, 2009 at 8:36 PM, Alexis Richardson
> > <alexis.richardson at gmail.com> wrote:
> >>
> >> Vishnu
> >>
> >> On Tue, Dec 29, 2009 at 2:57 PM, vishnu <pathsny at gmail.com> wrote:
> >> > hi, sorry Im a bit confused. But the behavior of moving the message
> from
> >> > the
> >> > unacknowledge queue to the ready queue is already a part of rabbitmq.
> >>
> >> In what way?
> >>
> >>
> >> > There
> >> > must be some magic constant somewhere which governs this musn't there?
> >>
> >> If there were then it need not be time-based.
> >>
> >> alexis
> >>
> >>
> >> > On Tue, Dec 29, 2009 at 7:18 PM, Alexis Richardson
> >> > <alexis.richardson at gmail.com> wrote:
> >> >>
> >> >> Vishnu
> >> >>
> >> >> On Tue, Dec 29, 2009 at 4:37 AM, vishnu <pathsny at gmail.com> wrote:
> >> >> > Hi
> >> >> >     I'm trying to use rabbitmq for an web application thats close
> to
> >> >> > synchronous. The main reason I'm looking at rabbitmq is for the
> >> >> > reliability
> >> >> > and transactionality. The idea is for the webapplication to pump
> >> >> > messages
> >> >> > into the queue and for a down stream application to subscribe in
> >> >> > acknowledgement mode and for each message start a transaction,
> >> >> > attempt
> >> >> > to
> >> >> > process the message and if it fails for technical reasons, to
> >> >> > rollback
> >> >> > the
> >> >> > transaction.
> >> >>
> >> >> OK.
> >> >>
> >> >>
> >> >> > However, I would like to be able to configure the time for
> non-acked
> >> >> > messages to get requeued to be picked up. Where can this be done?
> >> >>
> >> >> This and other 'time based' behaviours are frequently requested, but
> >> >> *alas* are not yet built-in to RabbitMQ.
> >> >>
> >> >> However, don't give up.  You could create a consumer (in any
> language)
> >> >> which managed this for you, eg enforcing a disconnect after some time
> >> >> has passed.  Or, if you are feeling brave you could create a plugin
> to
> >> >> do this 'inside the broker'.  Plugins have to be written in erlang.
> >> >>
> >> >> I hope that helps.  Perhaps the list will have more immediately
> useful
> >> >> suggestions.
> >> >>
> >> >> Cheers,
> >> >>
> >> >> alexis
> >> >>
> >> >>
> >> >>
> >> >> > thanks
> >> >> > Vishnu
> >> >> > _______________________________________________
> >> >> > rabbitmq-discuss mailing list
> >> >> > rabbitmq-discuss at lists.rabbitmq.com
> >> >> >
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >> >> >
> >> >> >
> >> >
> >> >
> >
> >
> > _______________________________________________
> > rabbitmq-discuss mailing list
> > rabbitmq-discuss at lists.rabbitmq.com
> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/f0a4464a/attachment.htm 

From alexis.richardson at gmail.com  Wed Dec 30 10:22:04 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 30 Dec 2009 10:22:04 +0000
Subject: [rabbitmq-discuss] Deploying RabitMQ for my Application -
	Questions and Doubts
In-Reply-To: <96f68a7a0912291826x407a2d26nba204be8af49b3d6@mail.gmail.com>
References: <96f68a7a0912291826x407a2d26nba204be8af49b3d6@mail.gmail.com>
Message-ID: <167204d20912300222t2af857d1j36e376db1a5699c0@mail.gmail.com>

Karthik

Some questions:

What is the nature of this communication?  Is it pubsub?  Must queues
be involved?  What kind of recovery and failover do you need?

Are you saying that the server(s) must be in one physical location?

Or, are you saying there must be one server "bot" per country?  If so
then can there be communication 'between server bots'?

alexis


On Wed, Dec 30, 2009 at 2:26 AM, Karthik <coolkarthik88 at gmail.com> wrote:
> Hi,
>
> I am looking for a solution for the problem that am currently looking
> to solve... I am trying to build a scalable AMQP Messaging system,
> where multiple bots(in the range of 1 for each country in the world)
> push out messages to clients spread all over the world. The
> communication will be truly one to one, that is one server bot will
> communicate with bots, and each client is assigned one server bot.
> Messages are mostly private, i.e. only from the server to client and
> vice versa.
>
> There can be anywhere between 10-50 Million Concurrent Clients,
> Messages are in the size of 2-3KB(Well formed XML), that can be
> transmitted in the both the directions i.e. Client->Server(bots) and
> vice versa.... My estimates put at the messages to be going outwards
> in either directions somewhere in the range of 50-100 messages/second.
>
> The Clients will need to send/receive all the information as encrypted
> data using SSL+TLS and any other scheme..
>
> Will RabbitMQ be a good choice for the kind of the problem I'm trying
> to solve..
>
> Any help will be appreciated.. Also how much better is using AMQP
> based RabbitMQ in comparison to XMPP based Ejabberd/Openfire etc?
> Regards,
> Karthik Kastury
>
> http://dailyapps.net/ | +91 9739864254
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From pathsny at gmail.com  Wed Dec 30 10:35:59 2009
From: pathsny at gmail.com (vishnu)
Date: Wed, 30 Dec 2009 16:05:59 +0530
Subject: [rabbitmq-discuss] Active/Active failover
Message-ID: <c89c65ea0912300235w2832f250p29595fc105537c91@mail.gmail.com>

While reading the how to's on the faq page at
http://www.rabbitmq.com/faq.html
there's a contact us link that talks about building active/active failover.
Could someone explain how this works?

thanks
Vishnu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/2c4b02d1/attachment.htm 

From alexis.richardson at gmail.com  Wed Dec 30 10:39:11 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 30 Dec 2009 10:39:11 +0000
Subject: [rabbitmq-discuss] Active/Active failover
In-Reply-To: <c89c65ea0912300235w2832f250p29595fc105537c91@mail.gmail.com>
References: <c89c65ea0912300235w2832f250p29595fc105537c91@mail.gmail.com>
Message-ID: <167204d20912300239o5c375760j977e83f5a0bb00d0@mail.gmail.com>

At the moment: You need to set up two brokers with the same exchanges,
queues and bindings, and send every message through both.  You then
need a way to dedup.  This is somewhat complex, and usually
active/passive is preferred.

alexis


On Wed, Dec 30, 2009 at 10:35 AM, vishnu <pathsny at gmail.com> wrote:
> While reading the how to's on the faq page at
> http://www.rabbitmq.com/faq.html
> there's a contact us link that talks about building active/active failover.
> Could someone explain how this works?
> thanks
> Vishnu
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From coolkarthik88 at gmail.com  Wed Dec 30 10:39:31 2009
From: coolkarthik88 at gmail.com (Karthik)
Date: Wed, 30 Dec 2009 16:09:31 +0530
Subject: [rabbitmq-discuss] Deploying RabitMQ for my Application -
	Questions and Doubts
In-Reply-To: <167204d20912300222t2af857d1j36e376db1a5699c0@mail.gmail.com>
References: <96f68a7a0912291826x407a2d26nba204be8af49b3d6@mail.gmail.com> 
	<167204d20912300222t2af857d1j36e376db1a5699c0@mail.gmail.com>
Message-ID: <96f68a7a0912300239k31724876o8467644a10c7c2bf@mail.gmail.com>

Hi Alex,

Thanks for writing in. Here is the scenario.. I need to be running a single
cluster of Servers housed in a single Data Center. The problem I am trying
to solve involves pushing out information to clients spread across the globe
asynchronously aka push the data to them as and when the need arises. The
data to be pushed in will be pumped by a Web Based front end..

The communication will primarily be Private communication, that is server
directly talks to the client.. In my problem none of the clients can talk to
each other.. Information can only be exchanged between the client and server
in both the directions. PubSub or fanout communications will be involved
too, but most communication will be private (connections need to be
encrypted).

To scale my system, I was thinking that splitting the system on a country
wise basis, will allow me to scale easily. I am planning to use Amazon EC2,
so during night times or off peak hours, I'd want the power of different
instances responsible for different countries to be reduced, to save
expenses.

Can you point me to real implementations of this kind that have used
RabbitMQ in the past? Also I'm expecting anywhere between  10-5 M0 Million
clients, so do you think its feasible? Also what would be latencies involved
on an approximate measure...

Regards,
Karthik Kastury

http://dailyapps.net/ | +91 9739864254


On Wed, Dec 30, 2009 at 3:52 PM, Alexis Richardson <
alexis.richardson at gmail.com> wrote:

> Karthik
>
> Some questions:
>
> What is the nature of this communication?  Is it pubsub?  Must queues
> be involved?  What kind of recovery and failover do you need?
>
> Are you saying that the server(s) must be in one physical location?
>
> Or, are you saying there must be one server "bot" per country?  If so
> then can there be communication 'between server bots'?
>
> alexis
>
>
> On Wed, Dec 30, 2009 at 2:26 AM, Karthik <coolkarthik88 at gmail.com> wrote:
> > Hi,
> >
> > I am looking for a solution for the problem that am currently looking
> > to solve... I am trying to build a scalable AMQP Messaging system,
> > where multiple bots(in the range of 1 for each country in the world)
> > push out messages to clients spread all over the world. The
> > communication will be truly one to one, that is one server bot will
> > communicate with bots, and each client is assigned one server bot.
> > Messages are mostly private, i.e. only from the server to client and
> > vice versa.
> >
> > There can be anywhere between 10-50 Million Concurrent Clients,
> > Messages are in the size of 2-3KB(Well formed XML), that can be
> > transmitted in the both the directions i.e. Client->Server(bots) and
> > vice versa.... My estimates put at the messages to be going outwards
> > in either directions somewhere in the range of 50-100 messages/second.
> >
> > The Clients will need to send/receive all the information as encrypted
> > data using SSL+TLS and any other scheme..
> >
> > Will RabbitMQ be a good choice for the kind of the problem I'm trying
> > to solve..
> >
> > Any help will be appreciated.. Also how much better is using AMQP
> > based RabbitMQ in comparison to XMPP based Ejabberd/Openfire etc?
> > Regards,
> > Karthik Kastury
> >
> > http://dailyapps.net/ | +91 9739864254
> >
> > _______________________________________________
> > rabbitmq-discuss mailing list
> > rabbitmq-discuss at lists.rabbitmq.com
> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/c8aca254/attachment.htm 

From alexis.richardson at gmail.com  Wed Dec 30 10:45:12 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 30 Dec 2009 10:45:12 +0000
Subject: [rabbitmq-discuss] Active/Active failover
In-Reply-To: <c89c65ea0912300242q45563129jad8cbc34812df8bd@mail.gmail.com>
References: <c89c65ea0912300235w2832f250p29595fc105537c91@mail.gmail.com>
	<167204d20912300239o5c375760j977e83f5a0bb00d0@mail.gmail.com>
	<c89c65ea0912300242q45563129jad8cbc34812df8bd@mail.gmail.com>
Message-ID: <167204d20912300245t4bbdb03oc18a0091c0cdb9ae@mail.gmail.com>

CC'ing the list - assuming you prefer that :-)

On Wed, Dec 30, 2009 at 10:42 AM, vishnu <pathsny at gmail.com> wrote:
> well its important to us to know that is possible if we need it sometime in
> the future. In the short term we're quite likely to go with active/passive
> :)

Yes it is, and yes that is a good plan.


> So does that just mean, mounting a disk for use on a queue that can be
> remounted on a seperate system?

Currently it combines:

- TCP loadbal
- OS level heartbeats
- A safe, reasonably fast, shared disk store

alexis



> On Wed, Dec 30, 2009 at 4:09 PM, Alexis Richardson
> <alexis.richardson at gmail.com> wrote:
>>
>> At the moment: You need to set up two brokers with the same exchanges,
>> queues and bindings, and send every message through both. ?You then
>> need a way to dedup. ?This is somewhat complex, and usually
>> active/passive is preferred.
>>
>> alexis
>>
>>
>> On Wed, Dec 30, 2009 at 10:35 AM, vishnu <pathsny at gmail.com> wrote:
>> > While reading the how to's on the faq page at
>> > http://www.rabbitmq.com/faq.html
>> > there's a contact us link that talks about building active/active
>> > failover.
>> > Could someone explain how this works?
>> > thanks
>> > Vishnu
>> > _______________________________________________
>> > rabbitmq-discuss mailing list
>> > rabbitmq-discuss at lists.rabbitmq.com
>> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >
>> >
>
>



From alexis.richardson at gmail.com  Wed Dec 30 11:02:12 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 30 Dec 2009 11:02:12 +0000
Subject: [rabbitmq-discuss] Deploying RabitMQ for my Application -
	Questions and Doubts
In-Reply-To: <96f68a7a0912300239k31724876o8467644a10c7c2bf@mail.gmail.com>
References: <96f68a7a0912291826x407a2d26nba204be8af49b3d6@mail.gmail.com>
	<167204d20912300222t2af857d1j36e376db1a5699c0@mail.gmail.com>
	<96f68a7a0912300239k31724876o8467644a10c7c2bf@mail.gmail.com>
Message-ID: <167204d20912300302g71ac8a4aqa303bf215ec881a@mail.gmail.com>

Karthik

Yes that is feasible.  If you were simply talking about a 'chat'
system then I would suggest XMPP would be great for your case.  But,
the mixture of pubsub, fanout and queueing ("pushing .. as and when
the need arises") suggests that you should consider AMQP.

Re use cases:  I cannot talk about *everyone* doing exactly the same
as you, since many of our customers don't like to (or cannot) discuss
their cases in public.   However, here is a reasonably well known
'multi-location multi-datacenter multi-cloud' use case that is
similar:

http://www.oceanobservatories.org/spaces/display/CIDev/Messaging+Service+Specification+V1
http://io9.com/5410036/fleets-of-autonomous-robots-coming-to-an-ocean-near-you
http://www.calit2.net/newsroom/article.php?id=1505

Here is a case that has several data centers, similar to what you are
asking about: http://qconsf.com/sf2009/presentation/Open+Source+at+Unibet.com+-+10x+Scalability+at+Half+the+Cost

Here are some more 'cloud' use cases:
http://delicious.com/alexisrichardson/rabbitmq+cloud+usecase

 More below...


On Wed, Dec 30, 2009 at 10:39 AM, Karthik <coolkarthik88 at gmail.com> wrote:
> Hi Alex,
> Thanks for writing in. Here is the scenario.. I need to be running a single
> cluster of Servers housed in a single Data Center. The problem I am trying
> to solve involves pushing out information to clients spread across the globe
> asynchronously aka push the data to them as and when the need arises.

OK.  I assume that 'as and when the need arises' means that
connections will be somewhat unpredictable, and some data will need to
be queued for offline consumers?  Will it also need to be stored?


> The
> data to be pushed in will be pumped by a Web Based front end..

Would you want to use one of the RabbitMQ web clients for this?



> The communication will primarily be Private communication, that is server
> directly talks to the client.. In my problem none of the clients can talk to
> each other.. Information can only be exchanged between the client and server
> in both the directions. PubSub or fanout communications will be involved
> too, but most communication will be private (connections need to be
> encrypted).

OK.



> To scale my system, I was thinking that splitting the system on a country
> wise basis, will allow me to scale easily.

Would each country server be isolated?  Or could two clients in
different countries exchange messages via the servers, like this:

Client -> Server -> Server -> Client


> I am planning to use Amazon EC2,
> so during night times or off peak hours, I'd want the power of different
> instances responsible for different countries to be reduced, to save
> expenses.

That makes sense.  Of course currently EC2 is in three location (2 in
US, 1 in EU).




> Can you point me to real implementations of this kind that have used
> RabbitMQ in the past?

See above.


> Also I'm expecting anywhere between ?10-5 M0 Million
> clients, so do you think its feasible?

Yes.


> Also what would be latencies involved
> on an approximate measure...

The main contributor to your latency will be the time taken for data
to travel across the wide area between servers and clients or vice
versa.

alexis




> Regards,
> Karthik Kastury
>
> http://dailyapps.net/ | +91 9739864254
>
>
> On Wed, Dec 30, 2009 at 3:52 PM, Alexis Richardson
> <alexis.richardson at gmail.com> wrote:
>>
>> Karthik
>>
>> Some questions:
>>
>> What is the nature of this communication? ?Is it pubsub? ?Must queues
>> be involved? ?What kind of recovery and failover do you need?
>>
>> Are you saying that the server(s) must be in one physical location?
>>
>> Or, are you saying there must be one server "bot" per country? ?If so
>> then can there be communication 'between server bots'?
>>
>> alexis
>>
>>
>> On Wed, Dec 30, 2009 at 2:26 AM, Karthik <coolkarthik88 at gmail.com> wrote:
>> > Hi,
>> >
>> > I am looking for a solution for the problem that am currently looking
>> > to solve... I am trying to build a scalable AMQP Messaging system,
>> > where multiple bots(in the range of 1 for each country in the world)
>> > push out messages to clients spread all over the world. The
>> > communication will be truly one to one, that is one server bot will
>> > communicate with bots, and each client is assigned one server bot.
>> > Messages are mostly private, i.e. only from the server to client and
>> > vice versa.
>> >
>> > There can be anywhere between 10-50 Million Concurrent Clients,
>> > Messages are in the size of 2-3KB(Well formed XML), that can be
>> > transmitted in the both the directions i.e. Client->Server(bots) and
>> > vice versa.... My estimates put at the messages to be going outwards
>> > in either directions somewhere in the range of 50-100 messages/second.
>> >
>> > The Clients will need to send/receive all the information as encrypted
>> > data using SSL+TLS and any other scheme..
>> >
>> > Will RabbitMQ be a good choice for the kind of the problem I'm trying
>> > to solve..
>> >
>> > Any help will be appreciated.. Also how much better is using AMQP
>> > based RabbitMQ in comparison to XMPP based Ejabberd/Openfire etc?
>> > Regards,
>> > Karthik Kastury
>> >
>> > http://dailyapps.net/ | +91 9739864254
>> >
>> > _______________________________________________
>> > rabbitmq-discuss mailing list
>> > rabbitmq-discuss at lists.rabbitmq.com
>> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>> >
>> >
>
>



From alexis.richardson at gmail.com  Wed Dec 30 11:03:33 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 30 Dec 2009 11:03:33 +0000
Subject: [rabbitmq-discuss] Deploying RabitMQ for my Application -
	Questions and Doubts
In-Reply-To: <167204d20912300302g71ac8a4aqa303bf215ec881a@mail.gmail.com>
References: <96f68a7a0912291826x407a2d26nba204be8af49b3d6@mail.gmail.com>
	<167204d20912300222t2af857d1j36e376db1a5699c0@mail.gmail.com>
	<96f68a7a0912300239k31724876o8467644a10c7c2bf@mail.gmail.com>
	<167204d20912300302g71ac8a4aqa303bf215ec881a@mail.gmail.com>
Message-ID: <167204d20912300303k71894350w75b4e2b58deb17a7@mail.gmail.com>

Karthik

Here are some links about XMPP and AMQP:

http://delicious.com/alexisrichardson/rabbitmq+xmpp+amqp

alexis


On Wed, Dec 30, 2009 at 11:02 AM, Alexis Richardson
<alexis.richardson at gmail.com> wrote:
> Karthik
>
> Yes that is feasible. ?If you were simply talking about a 'chat'
> system then I would suggest XMPP would be great for your case. ?But,
> the mixture of pubsub, fanout and queueing ("pushing .. as and when
> the need arises") suggests that you should consider AMQP.
>
> Re use cases: ?I cannot talk about *everyone* doing exactly the same
> as you, since many of our customers don't like to (or cannot) discuss
> their cases in public. ? However, here is a reasonably well known
> 'multi-location multi-datacenter multi-cloud' use case that is
> similar:
>
> http://www.oceanobservatories.org/spaces/display/CIDev/Messaging+Service+Specification+V1
> http://io9.com/5410036/fleets-of-autonomous-robots-coming-to-an-ocean-near-you
> http://www.calit2.net/newsroom/article.php?id=1505
>
> Here is a case that has several data centers, similar to what you are
> asking about: http://qconsf.com/sf2009/presentation/Open+Source+at+Unibet.com+-+10x+Scalability+at+Half+the+Cost
>
> Here are some more 'cloud' use cases:
> http://delicious.com/alexisrichardson/rabbitmq+cloud+usecase
>
> ?More below...
>
>
> On Wed, Dec 30, 2009 at 10:39 AM, Karthik <coolkarthik88 at gmail.com> wrote:
>> Hi Alex,
>> Thanks for writing in. Here is the scenario.. I need to be running a single
>> cluster of Servers housed in a single Data Center. The problem I am trying
>> to solve involves pushing out information to clients spread across the globe
>> asynchronously aka push the data to them as and when the need arises.
>
> OK. ?I assume that 'as and when the need arises' means that
> connections will be somewhat unpredictable, and some data will need to
> be queued for offline consumers? ?Will it also need to be stored?
>
>
>> The
>> data to be pushed in will be pumped by a Web Based front end..
>
> Would you want to use one of the RabbitMQ web clients for this?
>
>
>
>> The communication will primarily be Private communication, that is server
>> directly talks to the client.. In my problem none of the clients can talk to
>> each other.. Information can only be exchanged between the client and server
>> in both the directions. PubSub or fanout communications will be involved
>> too, but most communication will be private (connections need to be
>> encrypted).
>
> OK.
>
>
>
>> To scale my system, I was thinking that splitting the system on a country
>> wise basis, will allow me to scale easily.
>
> Would each country server be isolated? ?Or could two clients in
> different countries exchange messages via the servers, like this:
>
> Client -> Server -> Server -> Client
>
>
>> I am planning to use Amazon EC2,
>> so during night times or off peak hours, I'd want the power of different
>> instances responsible for different countries to be reduced, to save
>> expenses.
>
> That makes sense. ?Of course currently EC2 is in three location (2 in
> US, 1 in EU).
>
>
>
>
>> Can you point me to real implementations of this kind that have used
>> RabbitMQ in the past?
>
> See above.
>
>
>> Also I'm expecting anywhere between ?10-5 M0 Million
>> clients, so do you think its feasible?
>
> Yes.
>
>
>> Also what would be latencies involved
>> on an approximate measure...
>
> The main contributor to your latency will be the time taken for data
> to travel across the wide area between servers and clients or vice
> versa.
>
> alexis
>
>
>
>
>> Regards,
>> Karthik Kastury
>>
>> http://dailyapps.net/ | +91 9739864254
>>
>>
>> On Wed, Dec 30, 2009 at 3:52 PM, Alexis Richardson
>> <alexis.richardson at gmail.com> wrote:
>>>
>>> Karthik
>>>
>>> Some questions:
>>>
>>> What is the nature of this communication? ?Is it pubsub? ?Must queues
>>> be involved? ?What kind of recovery and failover do you need?
>>>
>>> Are you saying that the server(s) must be in one physical location?
>>>
>>> Or, are you saying there must be one server "bot" per country? ?If so
>>> then can there be communication 'between server bots'?
>>>
>>> alexis
>>>
>>>
>>> On Wed, Dec 30, 2009 at 2:26 AM, Karthik <coolkarthik88 at gmail.com> wrote:
>>> > Hi,
>>> >
>>> > I am looking for a solution for the problem that am currently looking
>>> > to solve... I am trying to build a scalable AMQP Messaging system,
>>> > where multiple bots(in the range of 1 for each country in the world)
>>> > push out messages to clients spread all over the world. The
>>> > communication will be truly one to one, that is one server bot will
>>> > communicate with bots, and each client is assigned one server bot.
>>> > Messages are mostly private, i.e. only from the server to client and
>>> > vice versa.
>>> >
>>> > There can be anywhere between 10-50 Million Concurrent Clients,
>>> > Messages are in the size of 2-3KB(Well formed XML), that can be
>>> > transmitted in the both the directions i.e. Client->Server(bots) and
>>> > vice versa.... My estimates put at the messages to be going outwards
>>> > in either directions somewhere in the range of 50-100 messages/second.
>>> >
>>> > The Clients will need to send/receive all the information as encrypted
>>> > data using SSL+TLS and any other scheme..
>>> >
>>> > Will RabbitMQ be a good choice for the kind of the problem I'm trying
>>> > to solve..
>>> >
>>> > Any help will be appreciated.. Also how much better is using AMQP
>>> > based RabbitMQ in comparison to XMPP based Ejabberd/Openfire etc?
>>> > Regards,
>>> > Karthik Kastury
>>> >
>>> > http://dailyapps.net/ | +91 9739864254
>>> >
>>> > _______________________________________________
>>> > rabbitmq-discuss mailing list
>>> > rabbitmq-discuss at lists.rabbitmq.com
>>> > http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>> >
>>> >
>>
>>
>



From bmurphy1976 at gmail.com  Wed Dec 30 23:25:57 2009
From: bmurphy1976 at gmail.com (Bryan Murphy)
Date: Wed, 30 Dec 2009 17:25:57 -0600
Subject: [rabbitmq-discuss] High CPU Usage
Message-ID: <7fd310d10912301525k231677f3j7f1c0b1d627549fc@mail.gmail.com>

I want to set up 3 queues, High, Medium, and Low where I always pull
messages from the higher priority queues first.  Right now, I more or less
do the following:

while (true)
{
  result = null;

  foreach (var queue in queues)
  {
    result = model.BasicGet(queue, false);

    if (result != null)
      break;
  }

  if (result != null)
    DoSomething(result);

  Thread.Sleep(15); // 15ms
}

Functionally this achieves what I'm trying to accomplish, however, the CPU
usage of the RabbitMQ server goes through the roof once I spin up a few
listeners.

Is there another way I can accomplish the same thing that doesn't hit the
RabbitMQ server so hard?

Thanks,
Bryan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091230/f3ef194f/attachment.htm 

From alexis.richardson at gmail.com  Wed Dec 30 23:58:15 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Wed, 30 Dec 2009 23:58:15 +0000
Subject: [rabbitmq-discuss] High CPU Usage
In-Reply-To: <7fd310d10912301525k231677f3j7f1c0b1d627549fc@mail.gmail.com>
References: <7fd310d10912301525k231677f3j7f1c0b1d627549fc@mail.gmail.com>
Message-ID: <167204d20912301558y6f2ab14r74e52a2350833082@mail.gmail.com>

Weird.

In any case: Have you tried using basic.consume?  While not directly
addressing your question, it may help.

alexis



On Wed, Dec 30, 2009 at 11:25 PM, Bryan Murphy <bmurphy1976 at gmail.com> wrote:
> I want to set up 3 queues, High, Medium, and Low where I always pull
> messages from the higher priority queues first.? Right now, I more or less
> do the following:
>
> while (true)
> {
> ? result = null;
>
> ? foreach (var queue in queues)
> ? {
> ? ? result = model.BasicGet(queue, false);
>
> ??? if (result != null)
> ?? ?? break;
> ? }
>
> ? if (result != null)
> ??? DoSomething(result);
>
> ? Thread.Sleep(15); // 15ms
> }
>
> Functionally this achieves what I'm trying to accomplish, however, the CPU
> usage of the RabbitMQ server goes through the roof once I spin up a few
> listeners.
>
> Is there another way I can accomplish the same thing that doesn't hit the
> RabbitMQ server so hard?
>
> Thanks,
> Bryan
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
>



From alexis.richardson at gmail.com  Thu Dec 31 00:00:40 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Thu, 31 Dec 2009 00:00:40 +0000
Subject: [rabbitmq-discuss] High CPU Usage
In-Reply-To: <167204d20912301558y6f2ab14r74e52a2350833082@mail.gmail.com>
References: <7fd310d10912301525k231677f3j7f1c0b1d627549fc@mail.gmail.com>
	<167204d20912301558y6f2ab14r74e52a2350833082@mail.gmail.com>
Message-ID: <167204d20912301600q7d300e8ar2ef78f5ab67fa41e@mail.gmail.com>

Bryan,

Re get vs consume:

http://www.google.co.uk/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=3Io&q=site%3Alists.rabbitmq.com+%22basic.get%22+%22basic.consume%22+rabbitmq&btnG=Search&meta=&aq=f&oq=

alexis



On Wed, Dec 30, 2009 at 11:58 PM, Alexis Richardson
<alexis.richardson at gmail.com> wrote:
> Weird.
>
> In any case: Have you tried using basic.consume? ?While not directly
> addressing your question, it may help.
>
> alexis
>
>
>
> On Wed, Dec 30, 2009 at 11:25 PM, Bryan Murphy <bmurphy1976 at gmail.com> wrote:
>> I want to set up 3 queues, High, Medium, and Low where I always pull
>> messages from the higher priority queues first.? Right now, I more or less
>> do the following:
>>
>> while (true)
>> {
>> ? result = null;
>>
>> ? foreach (var queue in queues)
>> ? {
>> ? ? result = model.BasicGet(queue, false);
>>
>> ??? if (result != null)
>> ?? ?? break;
>> ? }
>>
>> ? if (result != null)
>> ??? DoSomething(result);
>>
>> ? Thread.Sleep(15); // 15ms
>> }
>>
>> Functionally this achieves what I'm trying to accomplish, however, the CPU
>> usage of the RabbitMQ server goes through the roof once I spin up a few
>> listeners.
>>
>> Is there another way I can accomplish the same thing that doesn't hit the
>> RabbitMQ server so hard?
>>
>> Thanks,
>> Bryan
>>
>> _______________________________________________
>> rabbitmq-discuss mailing list
>> rabbitmq-discuss at lists.rabbitmq.com
>> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>>
>>
>



From pathsny at gmail.com  Thu Dec 31 04:51:30 2009
From: pathsny at gmail.com (vishnu)
Date: Thu, 31 Dec 2009 10:21:30 +0530
Subject: [rabbitmq-discuss] Transactions on acks
Message-ID: <c89c65ea0912302051w2ba7b05bra8c775b0d53f9905@mail.gmail.com>

hi
   I'm trying to understand how transactions help on the ack side of things.
I can understand how I'd do a tx_select, a basic ack, my processing and then
a tx_commit.
if my process goes down before the commit, the message gets delivered to the
next consumer

But when would I do a tx_rollback?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091231/98456b43/attachment.htm 

From pathsny at gmail.com  Thu Dec 31 15:15:13 2009
From: pathsny at gmail.com (vishnu)
Date: Thu, 31 Dec 2009 20:45:13 +0530
Subject: [rabbitmq-discuss] Queuing for an application that does a fair
	amount of synchronous processing
Message-ID: <c89c65ea0912310715l7411fd43xfd5d9b8294bd4f1d@mail.gmail.com>

Hi
   We're looking at building an application that does a fair amount of
synchronous processing. However we are investigating using a queuing system
as a messaging bus because some of these processes are meant to be reliable.
Using a queue helps us guarantee that messages are dealt with and avoids us
having to right background processes to clean up after us.

There are, however, a fair number of operations that are not required to be
reliable and we are thinking of implementing these also through the queue
but use non persistent queues. Now the concern we have is the kinds of
latencies we might see. So I'd like to get general feedback on using this
approach.
thanks
Vishnu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091231/49594bae/attachment.htm 

From cremes.devlist at mac.com  Thu Dec 31 15:21:43 2009
From: cremes.devlist at mac.com (Chuck Remes)
Date: Thu, 31 Dec 2009 09:21:43 -0600
Subject: [rabbitmq-discuss] Queuing for an application that does a
	fair	amount of synchronous processing
In-Reply-To: <c89c65ea0912310715l7411fd43xfd5d9b8294bd4f1d@mail.gmail.com>
References: <c89c65ea0912310715l7411fd43xfd5d9b8294bd4f1d@mail.gmail.com>
Message-ID: <29F69053-E0CB-4A9F-B4AE-ECB2F697E106@mac.com>


On Dec 31, 2009, at 9:15 AM, vishnu wrote:

> Hi
>    We're looking at building an application that does a fair amount  
> of synchronous processing. However we are investigating using a  
> queuing system as a messaging bus because some of these processes  
> are meant to be reliable. Using a queue helps us guarantee that  
> messages are dealt with and avoids us having to right background  
> processes to clean up after us.
>
> There are, however, a fair number of operations that are not  
> required to be reliable and we are thinking of implementing these  
> also through the queue but use non persistent queues. Now the  
> concern we have is the kinds of latencies we might see. So I'd like  
> to get general feedback on using this approach.

Give us some idea of the data rates you are expecting. I regularly  
publish 3000+ messages/second using ruby which isn't exactly known for  
its performance. :)  Latency is a millisecond or so for topic  
exchanges, and under 1 millisecond for direct and fanout exchanges.  
(Exchange type matters due to matching overhead.)

However, since you say that all processing is synchronous, the length  
of time to complete that process will be your gating factor.

cr




From g at rre.tt  Thu Dec 31 19:17:33 2009
From: g at rre.tt (Garrett Smith)
Date: Thu, 31 Dec 2009 13:17:33 -0600
Subject: [rabbitmq-discuss] Encoding message payload for multiple languages
Message-ID: <ce2570e20912311117u2587a516oc07b750daef3f63a@mail.gmail.com>

I'm curious what others here use for encoding message payload for
cross-language consumption.

I've used Thrift for quite some time, and it's quite nice I think, but
there's the annoying overhead of IDL maintenance, compiling and
distributing application specific client code, etc.

JSON is an obvious choice, but incurs a pretty high overhead for
encoding/decoding.

XML is similar to JSON in terms of pluses and minuses.

There's Protobuf, which seems like a possibly simpler alternative to
Thrift, but still requires IDL maintenance, etc.

Binary representation of Erlang terms is darned near perfect (fast and
flexible), but it's not as easy to consume from other language
environments.

CSV might be a good approach for some applications.

Obviously there's no "one way" here, but I'm curious what others are doing.

Garrett

P.S. Happy New Year!



From jdunck at gmail.com  Thu Dec 31 19:35:17 2009
From: jdunck at gmail.com (Jeremy Dunck)
Date: Thu, 31 Dec 2009 13:35:17 -0600
Subject: [rabbitmq-discuss] Encoding message payload for multiple
	languages
In-Reply-To: <ce2570e20912311117u2587a516oc07b750daef3f63a@mail.gmail.com>
References: <ce2570e20912311117u2587a516oc07b750daef3f63a@mail.gmail.com>
Message-ID: <D9CD1F7C-3EA3-4063-A77B-1588A2B1F881@gmail.com>



On Dec 31, 2009, at 1:17 PM, Garrett Smith <g at rre.tt> wrote:
> Binary representation of Erlang terms is darned near perfect (fast and
> flexible), but it's not as easy to consume from other language
> environments.
>

Have you seen Bert?
http://github.com/blog/531-introducing-bert-and-bert-rpc



From pathsny at gmail.com  Thu Dec 31 19:36:06 2009
From: pathsny at gmail.com (vishnu)
Date: Fri, 1 Jan 2010 01:06:06 +0530
Subject: [rabbitmq-discuss] Queuing for an application that does a fair
	amount of synchronous processing
In-Reply-To: <29F69053-E0CB-4A9F-B4AE-ECB2F697E106@mac.com>
References: <c89c65ea0912310715l7411fd43xfd5d9b8294bd4f1d@mail.gmail.com>
	<29F69053-E0CB-4A9F-B4AE-ECB2F697E106@mac.com>
Message-ID: <c89c65ea0912311136y2813251ci68a9bc7a3a9002f5@mail.gmail.com>

fair enough, let me come back with some numbers :), I just wanted to first
make sure I'm not doing something brain dead :).

On Thu, Dec 31, 2009 at 8:51 PM, Chuck Remes <cremes.devlist at mac.com> wrote:

>
> On Dec 31, 2009, at 9:15 AM, vishnu wrote:
>
> > Hi
> >    We're looking at building an application that does a fair amount
> > of synchronous processing. However we are investigating using a
> > queuing system as a messaging bus because some of these processes
> > are meant to be reliable. Using a queue helps us guarantee that
> > messages are dealt with and avoids us having to right background
> > processes to clean up after us.
> >
> > There are, however, a fair number of operations that are not
> > required to be reliable and we are thinking of implementing these
> > also through the queue but use non persistent queues. Now the
> > concern we have is the kinds of latencies we might see. So I'd like
> > to get general feedback on using this approach.
>
> Give us some idea of the data rates you are expecting. I regularly
> publish 3000+ messages/second using ruby which isn't exactly known for
> its performance. :)  Latency is a millisecond or so for topic
> exchanges, and under 1 millisecond for direct and fanout exchanges.
> (Exchange type matters due to matching overhead.)
>
> However, since you say that all processing is synchronous, the length
> of time to complete that process will be your gating factor.
>
> cr
>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100101/81b840c1/attachment.htm 

From alexis.richardson at gmail.com  Thu Dec 31 19:41:26 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Thu, 31 Dec 2009 19:41:26 +0000
Subject: [rabbitmq-discuss] Encoding message payload for multiple
	languages
In-Reply-To: <ce2570e20912311117u2587a516oc07b750daef3f63a@mail.gmail.com>
References: <ce2570e20912311117u2587a516oc07b750daef3f63a@mail.gmail.com>
Message-ID: <167204d20912311141g36e8c294u710a7da0878334d4@mail.gmail.com>

Fudge is also quite interesting:

http://kirkwylie.blogspot.com/2009/11/announcing-release-of-fudge-messaging.html



On Thu, Dec 31, 2009 at 7:17 PM, Garrett Smith <g at rre.tt> wrote:
> I'm curious what others here use for encoding message payload for
> cross-language consumption.
>
> I've used Thrift for quite some time, and it's quite nice I think, but
> there's the annoying overhead of IDL maintenance, compiling and
> distributing application specific client code, etc.
>
> JSON is an obvious choice, but incurs a pretty high overhead for
> encoding/decoding.
>
> XML is similar to JSON in terms of pluses and minuses.
>
> There's Protobuf, which seems like a possibly simpler alternative to
> Thrift, but still requires IDL maintenance, etc.
>
> Binary representation of Erlang terms is darned near perfect (fast and
> flexible), but it's not as easy to consume from other language
> environments.
>
> CSV might be a good approach for some applications.
>
> Obviously there's no "one way" here, but I'm curious what others are doing.
>
> Garrett
>
> P.S. Happy New Year!
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



From alexis.richardson at gmail.com  Thu Dec 31 19:51:12 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Thu, 31 Dec 2009 19:51:12 +0000
Subject: [rabbitmq-discuss] Encoding message payload for multiple
	languages
In-Reply-To: <D9CD1F7C-3EA3-4063-A77B-1588A2B1F881@gmail.com>
References: <ce2570e20912311117u2587a516oc07b750daef3f63a@mail.gmail.com>
	<D9CD1F7C-3EA3-4063-A77B-1588A2B1F881@gmail.com>
Message-ID: <167204d20912311151if291ba3h12035c4d7f94c71@mail.gmail.com>

On Thu, Dec 31, 2009 at 7:35 PM, Jeremy Dunck <jdunck at gmail.com> wrote:
>
>
> On Dec 31, 2009, at 1:17 PM, Garrett Smith <g at rre.tt> wrote:
>> Binary representation of Erlang terms is darned near perfect (fast and
>> flexible), but it's not as easy to consume from other language
>> environments.
>>
>
> Have you seen Bert?
> http://github.com/blog/531-introducing-bert-and-bert-rpc

And not wholly unrelatedly: http://github.com/b/bertem



From jdunck at gmail.com  Thu Dec 31 20:42:27 2009
From: jdunck at gmail.com (Jeremy Dunck)
Date: Thu, 31 Dec 2009 14:42:27 -0600
Subject: [rabbitmq-discuss] .Net client foreground threads
In-Reply-To: <2545a92c0912291639j30947627m5636329a0927df83@mail.gmail.com>
References: <2545a92c0912291639j30947627m5636329a0927df83@mail.gmail.com>
Message-ID: <2545a92c0912311242g67f8e41bj3d4b14042d05c4b2@mail.gmail.com>

No opinion on this?  :-/

On Tue, Dec 29, 2009 at 6:39 PM, Jeremy Dunck <jdunck at gmail.com> wrote:
> Is there a reason for the main loop and heartbeat threads to be
> Foreground threads? ?I was expecting my process to die when my last
> app thread died, but the Rabbit threads are Foreground (the default)
> so they keep the process alive.
>
> I know I could do connection.Close, but I'd rather be irresponsible
> with my connection lifecycle.
>



From alexis.richardson at gmail.com  Thu Dec 31 20:47:06 2009
From: alexis.richardson at gmail.com (Alexis Richardson)
Date: Thu, 31 Dec 2009 20:47:06 +0000
Subject: [rabbitmq-discuss] .Net client foreground threads
In-Reply-To: <2545a92c0912311242g67f8e41bj3d4b14042d05c4b2@mail.gmail.com>
References: <2545a92c0912291639j30947627m5636329a0927df83@mail.gmail.com>
	<2545a92c0912311242g67f8e41bj3d4b14042d05c4b2@mail.gmail.com>
Message-ID: <167204d20912311247s4ab2028t8f05f1ad617a14db@mail.gmail.com>

Jeremy

You may need to give this one a few more days to percolate since most
of the engineering team is on vacation atm.

alexis


On Thu, Dec 31, 2009 at 8:42 PM, Jeremy Dunck <jdunck at gmail.com> wrote:
> No opinion on this? ?:-/
>
> On Tue, Dec 29, 2009 at 6:39 PM, Jeremy Dunck <jdunck at gmail.com> wrote:
>> Is there a reason for the main loop and heartbeat threads to be
>> Foreground threads? ?I was expecting my process to die when my last
>> app thread died, but the Rabbit threads are Foreground (the default)
>> so they keep the process alive.
>>
>> I know I could do connection.Close, but I'd rather be irresponsible
>> with my connection lifecycle.
>>
>
> _______________________________________________
> rabbitmq-discuss mailing list
> rabbitmq-discuss at lists.rabbitmq.com
> http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
>



