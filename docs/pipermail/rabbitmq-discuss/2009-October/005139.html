<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Streaming stock prices to long-polling clients
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Streaming%20stock%20prices%20to%20long-polling%20clients&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005165.html">
   <LINK REL="Next"  HREF="005166.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Streaming stock prices to long-polling clients</H1>
    <B>Ben Browitt</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Streaming%20stock%20prices%20to%20long-polling%20clients&In-Reply-To="
       TITLE="[rabbitmq-discuss] Streaming stock prices to long-polling clients">ben.browitt at gmail.com
       </A><BR>
    <I>Thu Oct 15 10:51:33 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005165.html">[rabbitmq-discuss] unknown revision rabbitmq_v1_7_0
</A></li>
        <LI>Next message: <A HREF="005166.html">[rabbitmq-discuss] Streaming stock prices to long-polling	clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5139">[ date ]</a>
              <a href="thread.html#5139">[ thread ]</a>
              <a href="subject.html#5139">[ subject ]</a>
              <a href="author.html#5139">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

In my application I need to stream stock prices to users.
The 'last price' will be retrieved from a separate service when a consumer
connects which simplifies things.
Each user will subscribe to several stocks.
Users are web browsers connecting using long-polling.

Do I create one queue per consumer with several bindings, one for each
stock?
Prices in this case will be sent with a topic routing key.
Another option is to create one queue per stock. each consumer will be
subscribed to several queues.
Messages will be sent with a direct routing key.

Users will connect using a browser with long-polling to the mochiweb plugin.
Each user will be presented at the server side as an erlang AMQP client.
When using long-polling it is possible that the server sent responses to
both connections and have to wait for the user to send a new request.
How do I handle this scenario? Does the erlang client store the messages in
its state?
Every time the erlang client gets a new long-polling request it checks for
messages in the state,
if there are messages it sends them immediately and if there aren't it
keep-alive the request.
Another option is that the erlang client will acknowledge messages only if
it can pass it to the web client.
What will happen in this case? Will the queue keep sending new messages or
will it wait for the erlang client o 'initialize' the channel?
Are there a suspend and resume features?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091015/ab24e5d3/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091015/ab24e5d3/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005165.html">[rabbitmq-discuss] unknown revision rabbitmq_v1_7_0
</A></li>
	<LI>Next message: <A HREF="005166.html">[rabbitmq-discuss] Streaming stock prices to long-polling	clients
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5139">[ date ]</a>
              <a href="thread.html#5139">[ thread ]</a>
              <a href="subject.html#5139">[ subject ]</a>
              <a href="author.html#5139">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
