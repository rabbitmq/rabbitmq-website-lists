<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%201.7%20and%20persistence%20limit%3F&In-Reply-To=004b01ca4bfe%24e9cdde80%24bd699b80%24%40grice%40logosworld.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005120.html">
   <LINK REL="Next"  HREF="005122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%201.7%20and%20persistence%20limit%3F&In-Reply-To=004b01ca4bfe%24e9cdde80%24bd699b80%24%40grice%40logosworld.com"
       TITLE="[rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?">matthew at lshift.net
       </A><BR>
    <I>Tue Oct 13 13:34:07 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005120.html">[rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?
</A></li>
        <LI>Next message: <A HREF="005122.html">[rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5121">[ date ]</a>
              <a href="thread.html#5121">[ thread ]</a>
              <a href="subject.html#5121">[ subject ]</a>
              <a href="author.html#5121">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Lynton,

On Tue, Oct 13, 2009 at 02:15:46PM +0200, Lynton Grice wrote:
&gt;<i> The SYNC transactions are not my concern, I do not really mind if those
</I>&gt;<i> messages get lost, it is the ASYNC ones that I want 100% guarantee they will
</I>&gt;<i> never get lost.
</I>
I'm completely confused by what you mean by this. That is just not
possible. If you send an async message, eg basic.publish, there are
probably a good few dozen buffers in your local computer, the language
you're writing in, the OS network stack, the network card itself, and so
forth, all in which the message can be stored and lost in the event of
power failure. Not to mention buffers in network hubs/switches/routers,
and then in Rabbit itself, all of which can hold the message
temporarily, after it's been &quot;sent&quot; and before it's been written to
disk.

Unless you get some sort of reply from Rabbit, which says that &quot;yes,
I've received the message and it's been written to disk&quot;, there is *no*
guarantee that any message you send has even been received by Rabbit,
let alone safely stored.

&gt;<i> You said &quot; With the persister in 1.7, messages are kept in RAM but are also
</I>&gt;<i> written out to disk.&quot; - are the messages written to disk by default as well?
</I>&gt;<i> As in the choice between &quot;ram_copies&quot;, &quot;disk_copies&quot; and &quot;disc_only_copies&quot;?
</I>&gt;<i> Or are the messages simple written anyway in the 1.7 persister?
</I>
By definition, persistent messages are written to disk. They also happen
to be stored in RAM in the persister in 1.7 (and before), for a variety
of reasons. This has *nothing* to do with the various modes of operation
of mnesia, as the persister does not use mnesia at all.

&gt;<i> Using transactions sounds like the answer for me for now, thanks.
</I>
Right, and thus this is effectively synchronous messaging as you get the
reply back from Rabbit - the commit-ok - when you commit on the channel.

&gt;<i> Last question: Do you ever forsee a day when there is no 2GB limit to DETS?
</I>
It's possible that the Erlang/OTP folks will get round to rewriting it
to make it 64-bit safe, I don't know. Certainly it's not something we're
looking at doing.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005120.html">[rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?
</A></li>
	<LI>Next message: <A HREF="005122.html">[rabbitmq-discuss] RabbitMQ 1.7 and persistence limit?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5121">[ date ]</a>
              <a href="thread.html#5121">[ thread ]</a>
              <a href="subject.html#5121">[ subject ]</a>
              <a href="author.html#5121">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
