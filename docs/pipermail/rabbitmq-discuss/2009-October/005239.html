<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Round-robin queue failover
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Round-robin%20queue%20failover&In-Reply-To=06A7EF6A-AE41-4FBC-8543-7AAC8ECABE7F%40sebastian-latza.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005236.html">
   <LINK REL="Next"  HREF="005240.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Round-robin queue failover</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Round-robin%20queue%20failover&In-Reply-To=06A7EF6A-AE41-4FBC-8543-7AAC8ECABE7F%40sebastian-latza.de"
       TITLE="[rabbitmq-discuss] Round-robin queue failover">alexis.richardson at gmail.com
       </A><BR>
    <I>Mon Oct 26 16:23:27 GMT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005236.html">[rabbitmq-discuss] Round-robin queue failover
</A></li>
        <LI>Next message: <A HREF="005240.html">[rabbitmq-discuss] Round-robin queue failover
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5239">[ date ]</a>
              <a href="thread.html#5239">[ thread ]</a>
              <a href="subject.html#5239">[ subject ]</a>
              <a href="author.html#5239">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sebastian

On Mon, Oct 26, 2009 at 4:04 PM, Sebastian &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mail at sebastian-latza.de</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Kyle Schaffrick:
</I>&gt;<i>
</I>&gt;&gt;<i> Attempting to create two identically-named queues will
</I>&gt;&gt;<i> result in declaring the same queue twice; the two consumers then
</I>&gt;&gt;<i> consuming from that queue will see load-balancing behavior.
</I>&gt;<i>
</I>&gt;<i> Thanks for the clarification. Since this does not work: how do I
</I>&gt;<i> achieve reliable persistent message delivery even if the one node
</I>&gt;<i> holding the queue dies?
</I>
At the risk of being seen as pedantic...

You could achieve it by waiting for the node to recover from disk.  In
other words: RabbitMQ provides &quot;eventual delivery&quot; out of the box.  If
you want to 'persist more reliably' than on one drive using RabbitMQ
out of the box, then use a RAID or a SAN.

I am guessing that what you mean is *availability* in which a message
can always reach a suitable queue even if the sending client loses its
connection with the node that crashed.  The problem with using a
single node is the time it takes to recover, and client reconnection
costs (if any).  The time to recover is partly influenced by how much
state has to recover, and partly by the size of the unavailability
window that you can tolerate.

Many applications don't like to wait more than (say) 1ms, 10ms or 50ms
before they can send their message.  In this case you will typically
want to send a message *before* the crashed node has been able to
recover.  You can achieve this in two ways:

1. You don't care about replicating state and can use any other queue
as a 'suitable queue'.  This is easy - just make sure the right
consumers and routes are wired up.

2. You do care about replicating state - which I think is the case you
have in mind.  Then you can fail over to a passive server.  We can
provide some more info on this if you like -- we have done it for a
few people but it is not yet 'available OOTB'.  (You can also do
active/active but it is much more fiddly atm).



&gt;<i> As stated before my take would be to replicate
</I>&gt;<i> queues client-side on independent brokers, but this seems to be
</I>&gt;<i> getting quite complicated as the queues have to be &quot;double-declared&quot;,
</I>&gt;<i> linked and properly re-initialized on startup of a new empty broker
</I>&gt;<i> (basically doing some kind of client-side clustering).
</I>
Right.  I think you probably want case 2 above.

alexis



&gt;<i> Regards
</I>&gt;<i> Sebastian
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005236.html">[rabbitmq-discuss] Round-robin queue failover
</A></li>
	<LI>Next message: <A HREF="005240.html">[rabbitmq-discuss] Round-robin queue failover
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5239">[ date ]</a>
              <a href="thread.html#5239">[ thread ]</a>
              <a href="subject.html#5239">[ subject ]</a>
              <a href="author.html#5239">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
