<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ throughput
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20throughput&In-Reply-To=376f3e6f0910011340r48d15247m2e529c19e3b07c65%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004993.html">
   <LINK REL="Next"  HREF="004996.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ throughput</H1>
    <B>Suhail Doshi</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20throughput&In-Reply-To=376f3e6f0910011340r48d15247m2e529c19e3b07c65%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ throughput">suhail at mixpanel.com
       </A><BR>
    <I>Thu Oct  1 21:56:35 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004993.html">[rabbitmq-discuss] RabbitMQ throughput
</A></li>
        <LI>Next message: <A HREF="004996.html">[rabbitmq-discuss] RabbitMQ throughput
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4995">[ date ]</a>
              <a href="thread.html#4995">[ thread ]</a>
              <a href="subject.html#4995">[ subject ]</a>
              <a href="author.html#4995">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Turns out I already output info to basically notice if the consumer is
blocking:
2009-10-01 20:55:27,935 INFO [id: 99704402] Processing complete,
acknowledged.
2009-10-01 20:55:27,939 INFO [id: 99704402] Received queue item,
processing...

2009-10-01 20:55:29,215 INFO [id: 99704402] Processing complete,
acknowledged.
2009-10-01 20:55:29,215 INFO [id: 99704402] Received queue item,
processing...

You'll notice there's a gap between receiving and processing so that means
the consumer is just waiting for an item. So it really does look like
rabbitmq is not able to get items to me fast enough with lots of items
backed in the queue.

Suhail

On Thu, Oct 1, 2009 at 1:40 PM, Suhail Doshi &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">suhail at mixpanel.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Oct 1, 2009 at 1:32 PM, Matthias Radestock &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Suhail,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Suhail Doshi wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Does anyone know what rabbitmq throughput is from items sitting in the
</I>&gt;&gt;&gt;<i> queue to sending them to a consumer?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Lets say we're doing 200 items in the queue a second with 50 consumers
</I>&gt;&gt;&gt;<i> waiting to process the item, usually they do in &lt; 30ms.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So that's ~7kHz, which doesn't look unreasonable, but there are many
</I>&gt;&gt;<i> factors at play here which we'd need to know about in order to make a better
</I>&gt;&gt;<i> assessment:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - are these messages persistent or transient? Persistent
</I>&gt;<i>
</I>&gt;<i> - how big are the messages? Less than 500 bytes usually
</I>&gt;&gt;<i> - do the consumer consume in no-ack mode, or ack mode? ack mode
</I>&gt;&gt;<i> - are the consumers sharing a connection (or even channel) or do they all
</I>&gt;&gt;<i> have their separate connection/channel? do not share a channel/connection
</I>&gt;&gt;<i> - where are the consumers in the network topology in relation to the
</I>&gt;&gt;<i> server? very close, same rack presumably
</I>&gt;&gt;<i> - what's the hardware spec of the server machine? quad core, 4 GB of RAM
</I>&gt;&gt;<i> - what version of Erlang are you running? 5.7.2
</I>&gt;&gt;<i> - what AMQP client are you using? Python library created by Barry Pederson
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Watching our consumer logs, it feels like they don't get items fast
</I>&gt;&gt;&gt;<i> enough from rabbitmq, is that possible or is it me?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can you instrument the consumers to measure how long they are blocked
</I>&gt;&gt;<i> waiting for messages from RabbitMQ? Yes possibly, I should check you're
</I>&gt;&gt;<i> right.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also, with 200 messages shared across 50 consumers each consumer will only
</I>&gt;&gt;<i> get four items, which is a rather small figure to do any meaningful
</I>&gt;&gt;<i> statistical analysis with.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matthias.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> <A HREF="http://mixpanel.com">http://mixpanel.com</A>
</I>&gt;<i> Blog: <A HREF="http://blog.mixpanel.com">http://blog.mixpanel.com</A>
</I>&gt;<i>
</I>


-- 
<A HREF="http://mixpanel.com">http://mixpanel.com</A>
Blog: <A HREF="http://blog.mixpanel.com">http://blog.mixpanel.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091001/dccafcca/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20091001/dccafcca/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004993.html">[rabbitmq-discuss] RabbitMQ throughput
</A></li>
	<LI>Next message: <A HREF="004996.html">[rabbitmq-discuss] RabbitMQ throughput
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4995">[ date ]</a>
              <a href="thread.html#4995">[ thread ]</a>
              <a href="subject.html#4995">[ subject ]</a>
              <a href="author.html#4995">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
