<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Client connection to ssl rabbitMQ is very	slow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Client%20connection%20to%20ssl%20rabbitMQ%20is%20very%0A%09slow&In-Reply-To=%3CCAFPidkNoJoK5PqLoaxqntvEs%2BE3X3uYrabVU%2BrkJYsqxyL9ymA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019381.html">
   <LINK REL="Next"  HREF="019436.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Client connection to ssl rabbitMQ is very	slow</H1>
    <B>Carl H&#246;rberg</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Client%20connection%20to%20ssl%20rabbitMQ%20is%20very%0A%09slow&In-Reply-To=%3CCAFPidkNoJoK5PqLoaxqntvEs%2BE3X3uYrabVU%2BrkJYsqxyL9ymA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Client connection to ssl rabbitMQ is very	slow">carl.hoerberg at gmail.com
       </A><BR>
    <I>Thu Apr  5 08:10:15 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019381.html">[rabbitmq-discuss] Client connection to ssl rabbitMQ is very slow
</A></li>
        <LI>Next message: <A HREF="019436.html">[rabbitmq-discuss] Client connection to ssl rabbitMQ is very slow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19396">[ date ]</a>
              <a href="thread.html#19396">[ thread ]</a>
              <a href="subject.html#19396">[ subject ]</a>
              <a href="author.html#19396">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>the DHE key exchange algorithm  is very computational intensive, so
make sure you disable it (<A HREF="http://matt.io/entry/ur">http://matt.io/entry/ur</A>)

this config allows only the AES 128 chiper with RSA (and not DHE) as
key exchange and SHA as hash algoritm (md5 is somewhat weaker but
faster):

{ssl_options, [{cacertfile,&quot;/etc/rabbitmq/ca.pem&quot;},
                    {certfile,&quot;/etc/rabbitmq/cert.pem&quot;},
                    {ciphers,[{rsa,aes_128_cbc,sha}]}]}

for all options, see <A HREF="http://www.erlang.org/doc/man/ssl.html,">http://www.erlang.org/doc/man/ssl.html,</A> as Emile said.

On Wed, Apr 4, 2012 at 12:43, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> On 02/04/12 15:26, Rabbit001 wrote:
</I>&gt;&gt;<i> &#160; I've follow the ssl configuration instructions in rabbitmq page
</I>&gt;&gt;<i> 'www.rabbitmq.com/ssl.html' to configure ssl access to rabbitmq server. I've
</I>&gt;&gt;<i> started rabbitmq server correctly and I've executed the example1 (sample
</I>&gt;&gt;<i> code for ssl java client) and the result is good, but the method
</I>&gt;&gt;<i> factory.newConnection() finish over 5sg. In the other hand, without ssl &#160;the
</I>&gt;&gt;<i> method factory.newConnection() finish in &lt;200 ms.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; How do i increasse the performance in the first scenario (ssl
</I>&gt;&gt;<i> configuration)? any idea?
</I>&gt;<i>
</I>&gt;<i> If your broker CPU has hardware support for certain ciphers and OpenSSL
</I>&gt;<i> can make use of it then try to restrict the SSL connection to those
</I>&gt;<i> ciphers, or to prioritise them. The &quot;ciphers&quot; SSL configuration option
</I>&gt;<i> in the broker is one way of achieving that. For configuration details
</I>&gt;<i> see <A HREF="http://www.erlang.org/doc/man/ssl.html">http://www.erlang.org/doc/man/ssl.html</A>
</I>&gt;<i>
</I>&gt;<i> You might also gain some useful insight by using an SSL traffic analyser
</I>&gt;<i> such as &quot;ssldump&quot;. If long gaps appear in the timeline then the output
</I>&gt;<i> may help you to determine what is responsible for the delay.
</I>&gt;<i>
</I>&gt;<i> Do other SSL clients also take long to connect? Try using the &quot;openssl
</I>&gt;<i> s_client&quot; option as described here:
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/troubleshooting-ssl.html">http://www.rabbitmq.com/troubleshooting-ssl.html</A>
</I>&gt;<i> and check whether such connections also take long.
</I>&gt;<i>
</I>&gt;<i> Does the Java client take long to connect when the SSL layer is provided
</I>&gt;<i> by a different SSL service? You can try this by connecting to the broker
</I>&gt;<i> via stunnel, socat or similar.
</I>&gt;<i>
</I>&gt;<i> The last two questions may help you to focus on whether the problem lies
</I>&gt;<i> on the client or server side.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019381.html">[rabbitmq-discuss] Client connection to ssl rabbitMQ is very slow
</A></li>
	<LI>Next message: <A HREF="019436.html">[rabbitmq-discuss] Client connection to ssl rabbitMQ is very slow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19396">[ date ]</a>
              <a href="thread.html#19396">[ thread ]</a>
              <a href="subject.html#19396">[ subject ]</a>
              <a href="author.html#19396">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
