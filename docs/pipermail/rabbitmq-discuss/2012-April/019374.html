<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ appears to send 0-9-1 formated message	to 0-8 client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20appears%20to%20send%200-9-1%20formated%20message%0A%09to%200-8%20client&In-Reply-To=%3CCAFDmHdOVR6-uNinJR5Gm2gQTTQRvuUdLtPGa-OXkHxLgG2F3Rw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019369.html">
   <LINK REL="Next"  HREF="019379.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ appears to send 0-9-1 formated message	to 0-8 client</H1>
    <B>Elias Levy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20appears%20to%20send%200-9-1%20formated%20message%0A%09to%200-8%20client&In-Reply-To=%3CCAFDmHdOVR6-uNinJR5Gm2gQTTQRvuUdLtPGa-OXkHxLgG2F3Rw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ appears to send 0-9-1 formated message	to 0-8 client">fearsome.lucidity at gmail.com
       </A><BR>
    <I>Wed Apr  4 00:16:58 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019369.html">[rabbitmq-discuss] Running RabbitMQ as a daemon on Suse
</A></li>
        <LI>Next message: <A HREF="019379.html">[rabbitmq-discuss] RabbitMQ appears to send 0-9-1 formated message to 0-8 client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19374">[ date ]</a>
              <a href="thread.html#19374">[ thread ]</a>
              <a href="subject.html#19374">[ subject ]</a>
              <a href="author.html#19374">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good day,

We are running in a problem while deploying a new cluster.  The one node
(dev) cluster is running RabbitMQ 2.71.  We got some Perl Net::AMQP clients
that connect to the cluster and subscribes to a queue.  The clients are
existing with an error, usually after consuming a handful of messages.  The
error is &quot;No way to unpack field 'redelivered' type 't'&quot;.

It seems the client is dying while unpacking the redelivered field in a
message delivery command.  The Net::AMQP client only supports the 0-8
protocol.  I've verified that RabbitMQ believes the client is connected
using AMQP 0-8.  My guess is that RabbitMQ is sending the client a 0-9-1
formated message, instead of a 0-8 message.  The &quot;redelivered&quot; field does
not appear to be defined in 0-8, and its type in 0-9-1 is boolean or &quot;t&quot;,
which is also not defined in 0-8.  Thus, Net::AMQP is throwing an error
when it finds a field of an unknown type.

The client's owner claims the client has worked successfully against the
same messages we are feeding it on a 2.5.1 cluster.  So we are wondering if
something changed between 2.5.1 and 2.7.1 that may cause this behavior.

We've also tested queues as both HA and non-HA and observe the same problem
(we figured it may be related to the new HA code since we we had configured
them as HA queues).

We are going to start downgrading the cluster one version at a time towards
2.5.1 to determine whether some version does not exhibit the problem.

RabbitMQ folks, any suggestions?

Elias Levy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120403/c148debb/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120403/c148debb/attachment.htm</A>&gt;
</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019369.html">[rabbitmq-discuss] Running RabbitMQ as a daemon on Suse
</A></li>
	<LI>Next message: <A HREF="019379.html">[rabbitmq-discuss] RabbitMQ appears to send 0-9-1 formated message to 0-8 client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19374">[ date ]</a>
              <a href="thread.html#19374">[ thread ]</a>
              <a href="subject.html#19374">[ subject ]</a>
              <a href="author.html#19374">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
