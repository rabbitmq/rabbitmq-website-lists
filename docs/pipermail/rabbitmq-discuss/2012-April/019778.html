<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] One message instance in couple of queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20One%20message%20instance%20in%20couple%20of%20queues&In-Reply-To=%3C23F5F7C7-C3F6-42D3-9181-04EFCF71BE0A%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019705.html">
   <LINK REL="Next"  HREF="019781.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] One message instance in couple of queues</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20One%20message%20instance%20in%20couple%20of%20queues&In-Reply-To=%3C23F5F7C7-C3F6-42D3-9181-04EFCF71BE0A%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] One message instance in couple of queues">steve at rabbitmq.com
       </A><BR>
    <I>Fri Apr 27 10:03:02 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="019705.html">[rabbitmq-discuss] One message instance in couple of queues
</A></li>
        <LI>Next message: <A HREF="019781.html">[rabbitmq-discuss] One message instance in couple of queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19778">[ date ]</a>
              <a href="thread.html#19778">[ thread ]</a>
              <a href="subject.html#19778">[ subject ]</a>
              <a href="author.html#19778">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ostin,
It is not clear to me what you are 'watching' these queues for, but if
you want to retrieve the message from the queues after a certain time,
then why not investigate Dead Letter Exchanges(DLX) and queue message
expiry?

If the moderator's private queues have an expiry time (TTL) on them,
then messages that have been on the queue for that time will be deleted
-- if there is a DeadLetterExchange associated with the queues, the
deleted message will be re-published to the new exchange. You can
arrange for the DLX to route the message to a queue of your choice --
the monitor process need only listen on this queue.

Be sure to code the moderator carefully (so as not to drop a message
while moving it) using publisher confirms and acks.

See
(<A HREF="http://www.rabbitmq.com/extensions.html/#dead-letter-exchanges">http://www.rabbitmq.com/extensions.html/#dead-letter-exchanges</A>)
and 
(<A HREF="http://www.rabbitmq.com/extensions.html/#queue-ttl">http://www.rabbitmq.com/extensions.html/#queue-ttl</A>)
for more information.

Steve Powell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>
[wrk: +44-2380-111-528] [mob: +44-7815-838-558]

On 21 Apr 2012, at 00:46, Alexey Ostin wrote:

&gt;<i> Let me show one more example. 
</I>&gt;<i> 
</I>&gt;<i> I've got some moderation queue. Whenever a moderator locks message (or several messages) for moderation, it moves from main queue to personal moderator's queue. Just to perform some long time lock (It can be minute or hour, thus I can't use ack/nack to hold message in main queue). The goal is to monitor all moderators queues as well as main one. The problem is that I do not know all moderator's queues and I can't just monitor some fixed list because it regenerates dynamically. 
</I>&gt;<i> 
</I>&gt;<i> I've just thought about using separate exchange for moderator's queues. It can help with monitoring, I'd watch over whole exchange. 
</I>&gt;<i> But it is still interesting whether I can publish message to several queues and consume it from them all at once. Sounds like gibberish. 
</I>&gt;<i> 
</I>&gt;<i> To be honest I've got one more problem to solve - it is to automatically release these locks (put a message from moderator's queue back to main) by timeout, but it should be other conversation I think :) 
</I>&gt;<i> 
</I>&gt;<i> Best regards, Ostin.
</I>&gt;<i> 
</I>&gt;<i> 20 &#1072;&#1087;&#1088;&#1077;&#1083;&#1103; 2012 &#1075;. 21:00 &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100; Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; &#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1083;:
</I>&gt;<i> On 20/04/12 17:27, ostin wrote:
</I>&gt;<i> Example application with topic exchange:
</I>&gt;<i> I push a message to server1.app1 queue and an other one to
</I>&gt;<i> server1.app2 queue. I monitor server1 queue to determine count of
</I>&gt;<i> processing messages on server 1. After app1 ends processing message it
</I>&gt;<i> shold be deleted from both queues: from app1 to prevent duplicate
</I>&gt;<i> processing, from server1 to have valid stats for monitoring. I assume
</I>&gt;<i> that there can be many applications with random names, so I cant
</I>&gt;<i> monitor just count of messages in app* queues.
</I>&gt;<i> 
</I>&gt;<i> If you want to make sure that a given message is only ever consumed from server1.app1 OR server1.app2, why not have only a single queue and have both applications consume from it?
</I>&gt;<i> 
</I>&gt;<i> Cheers, Simon
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019705.html">[rabbitmq-discuss] One message instance in couple of queues
</A></li>
	<LI>Next message: <A HREF="019781.html">[rabbitmq-discuss] One message instance in couple of queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19778">[ date ]</a>
              <a href="thread.html#19778">[ thread ]</a>
              <a href="subject.html#19778">[ subject ]</a>
              <a href="author.html#19778">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
