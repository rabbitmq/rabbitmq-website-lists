<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Connecting to RabbitMQ on Windows Server Using Wildcard Cert with .NET Client Using SSL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Connecting%20to%20RabbitMQ%20on%20Windows%20Server%20Using%0A%20Wildcard%20Cert%20with%20.NET%20Client%20Using%20SSL&In-Reply-To=%3Cd1e237d1-fdbe-47af-9772-eef3111c6a20%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026088.html">
   <LINK REL="Next"  HREF="026094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Connecting to RabbitMQ on Windows Server Using Wildcard Cert with .NET Client Using SSL</H1>
    <B>Rich Miller</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Connecting%20to%20RabbitMQ%20on%20Windows%20Server%20Using%0A%20Wildcard%20Cert%20with%20.NET%20Client%20Using%20SSL&In-Reply-To=%3Cd1e237d1-fdbe-47af-9772-eef3111c6a20%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Connecting to RabbitMQ on Windows Server Using Wildcard Cert with .NET Client Using SSL">richmiller167 at gmail.com
       </A><BR>
    <I>Wed Mar 20 17:40:27 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026088.html">[rabbitmq-discuss] Scaling Throughput with Highly Available	Queues
</A></li>
        <LI>Next message: <A HREF="026094.html">[rabbitmq-discuss] Connecting to RabbitMQ on Windows Server Using Wildcard Cert with .NET Client Using SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26092">[ date ]</a>
              <a href="thread.html#26092">[ thread ]</a>
              <a href="subject.html#26092">[ subject ]</a>
              <a href="author.html#26092">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The title pretty much says it all. I'm trying quite unsuccessfully to get 
to a RabbitMQ server running as a service on Windows Server 2008 R2 using a 
.NET client.  Server is using a wildcard certificate issued by GeoTrust. 
 GeoTrust is listed in my Trusted Root Certificate Authorities on the 
client box.  I'm simply trying to set up an SSL connection between the 
client and the server, not trying to authenticate using a certificate. 
 I've read the docs on the RabbitMQ website and several other blog posts 
about setting this up, but I've had no success.

Typical error messages reported by the client include &quot;Authentication 
failed because the remote party has closed the transport stream&quot; and 
&quot;Cannot find the requested object&quot; (after trying to pass a .key file in as 
the cert file).

RabbitMQ Server is 2.7.1 and Erlang is R15B03-1.  Client code looks 
basically like this:

            ' configure the connection factory
            Me.Factory.HostName = hostName
            Me.Factory.VirtualHost = virtualHostName
            Me.Factory.UserName = userName
            Me.Factory.Password = password
            Me.Factory.Protocol = Protocols.AMQP_0_9_1
            Me.Factory.Port = AmqpTcpEndpoint.DefaultAmqpSslPort
            Me.Factory.Ssl.ServerName = hostName
            Me.Factory.Ssl.CertPath = 
&quot;C:\Gravic\Development\TestRabbitMQSSL\TestRabbitMQSSL\bin\Debug\Clientcert.pfx&quot;
            Me.Factory.Ssl.CertPassphrase = &quot;thepassphrase&quot;
            Me.Factory.Ssl.Enabled = True

            ' create the connection using the factory
            Return Me.Factory.CreateConnection()

I'd appreciate any tips or pointers from anyone who has successfully made 
the SSL connection from .NET client to RabbitMQ server running on Windows.

Thanks!

Rich
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130320/057fb7f2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130320/057fb7f2/attachment.htm</A>&gt;
</PRE>

























































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026088.html">[rabbitmq-discuss] Scaling Throughput with Highly Available	Queues
</A></li>
	<LI>Next message: <A HREF="026094.html">[rabbitmq-discuss] Connecting to RabbitMQ on Windows Server Using Wildcard Cert with .NET Client Using SSL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26092">[ date ]</a>
              <a href="thread.html#26092">[ thread ]</a>
              <a href="subject.html#26092">[ subject ]</a>
              <a href="author.html#26092">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
