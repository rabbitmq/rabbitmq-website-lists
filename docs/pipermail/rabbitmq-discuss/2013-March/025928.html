<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20node-amqp%3A%20%7B%20%5BError%3A%20COMMAND_INVALID%20-%0A%20second%20%27channel.open%27%20seen%5D%20code%3A%20503%20%7D&In-Reply-To=%3CCAE3HoVS0wZ%3DV3Uqky1D0Ae6EsO%3DOc59gnTvGwVQS5LVAs4LMgQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025925.html">
   <LINK REL="Next"  HREF="025934.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20node-amqp%3A%20%7B%20%5BError%3A%20COMMAND_INVALID%20-%0A%20second%20%27channel.open%27%20seen%5D%20code%3A%20503%20%7D&In-Reply-To=%3CCAE3HoVS0wZ%3DV3Uqky1D0Ae6EsO%3DOc59gnTvGwVQS5LVAs4LMgQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }">michael.s.klishin at gmail.com
       </A><BR>
    <I>Thu Mar 14 14:08:52 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025925.html">[rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }
</A></li>
        <LI>Next message: <A HREF="025934.html">[rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25928">[ date ]</a>
              <a href="thread.html#25928">[ thread ]</a>
              <a href="subject.html#25928">[ subject ]</a>
              <a href="author.html#25928">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2013/3/14 Chris &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">stuff at moesel.net</A>&gt;

&gt;<i> First, the non-node-specific question:  Does anyone have any pointers on
</I>&gt;<i> how to debug such an issue?  I've already looked at logs and found which
</I>&gt;<i> channel is the problem-- but if I comment out the code that creates that
</I>&gt;<i> channel, then it just fails on a different channel the next time (btw-- you
</I>&gt;<i> don't explicitly create channels in node-amqp, they are created for you
</I>&gt;<i> when you subscribe to queues, declare exchanges, etc.).
</I>&gt;<i>
</I>
Using Wireshark or RabbitMQ tracer [1].


&gt;<i>
</I>&gt;<i> And the more node-specific question:  RabbitMQ docs seem to indicate it is
</I>&gt;<i> usually an error in the client (node-amqp in our case), but I wonder if
</I>&gt;<i> perhaps we are making some newbie node-amqp mistake that might lead to this
</I>&gt;<i> 503 error?  Is there anyone with node-amqp experience that has been through
</I>&gt;<i> this before?
</I>&gt;<i>
</I>
This issue indicates a race condition when a library assumes it need to
automatically open a channel after channel.open
has been sent. Or it may be because channel ids are not incremented
properly in the client so two channels end up
having the same id.

Finally, race conditions can originate in your own code but it's impossible
to tell without
seeing the code.

1. See at the bottom of <A HREF="http://www.rabbitmq.com/api-guide.html">http://www.rabbitmq.com/api-guide.html</A>
-- 
MK

<A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
<A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130314/57ea8681/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130314/57ea8681/attachment.htm</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025925.html">[rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }
</A></li>
	<LI>Next message: <A HREF="025934.html">[rabbitmq-discuss] node-amqp: { [Error: COMMAND_INVALID - second 'channel.open' seen] code: 503 }
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25928">[ date ]</a>
              <a href="thread.html#25928">[ thread ]</a>
              <a href="subject.html#25928">[ subject ]</a>
              <a href="author.html#25928">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
