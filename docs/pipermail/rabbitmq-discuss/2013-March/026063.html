<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Autohealing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Autohealing&In-Reply-To=%3C51498FCF.5040306%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026056.html">
   <LINK REL="Next"  HREF="026064.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Autohealing</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Autohealing&In-Reply-To=%3C51498FCF.5040306%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Autohealing">simon at rabbitmq.com
       </A><BR>
    <I>Wed Mar 20 10:30:39 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026056.html">[rabbitmq-discuss] Autohealing
</A></li>
        <LI>Next message: <A HREF="026064.html">[rabbitmq-discuss] Why the rates of deliver/ack has problem in	RabbitMQ management?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26063">[ date ]</a>
              <a href="thread.html#26063">[ thread ]</a>
              <a href="subject.html#26063">[ subject ]</a>
              <a href="author.html#26063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 19/03/13 23:59, Ben Hood wrote:
&gt;<i> I appreciate the development is still speculative, but I was wondering
</I>&gt;<i> what the initial scope of partition autohealing is likely to be.
</I>
My current aim (aims subject to change) is to have three modes for 
dealing with partitions. One mode is &quot;manual intervention required&quot; and 
is essentially the same as 3.0.

The second mode is &quot;pause the minority&quot;. In this mode, if any nodes look 
at the cluster and see that only a minority of nodes are up (from their 
point of view) they essentially hibernate (refusing to accept 
connections or do any other work) until they see they are in a majority 
again. Thus partitions can never form, at the cost of availability (ie. 
it's CP in CAP terms).

The idea is that &quot;pause the minority&quot; mode would be useful if you were 
to have a cluster in something like EC2, spread across three or more 
AZs. Your expected failure mode is for a single AZ to go completely 
offline - in which case you don't really care whether the cluster nodes 
within that AZ are running or not, so taking them down is an easy way to 
ensure we have no partitions.

Obviously &quot;pause the minority&quot; mode is a bad idea with only two cluster 
nodes (or AZs). &quot;Pause the minority&quot; mode is already complete and will 
be in 3.1.

The third mode (currently under development; hopefully in 3.1) is 
autohealing. In this mode partitions can still form, but once the 
cluster becomes connected again a winning partition is chosen and all 
non-winning nodes restarted to heal the partition - in other words 
mimicking what a sysadmin would do with 3.0. The interesting question is 
how to choose the winning node; my current thinking is some heuristic 
based on the number of nodes in the partition, the number of open AMQP 
connections at the moment we decide to heal, and possibly the number of 
changes that have been made in Mnesia (if we can get hold of that 
information sanely).

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>



































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026056.html">[rabbitmq-discuss] Autohealing
</A></li>
	<LI>Next message: <A HREF="026064.html">[rabbitmq-discuss] Why the rates of deliver/ack has problem in	RabbitMQ management?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26063">[ date ]</a>
              <a href="thread.html#26063">[ thread ]</a>
              <a href="subject.html#26063">[ subject ]</a>
              <a href="author.html#26063">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
