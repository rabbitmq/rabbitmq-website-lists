<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Turning off prefetch in the asynchronous_consumer_example
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Turning%20off%20prefetch%20in%20the%0A%20asynchronous_consumer_example&In-Reply-To=%3CCC28B25FDAC5D943B606F46369686C2A35EA9218%40SJC4EXDAG01-02.corp.service-now.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025803.html">
   <LINK REL="Next"  HREF="025822.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Turning off prefetch in the asynchronous_consumer_example</H1>
    <B>Scott Chapman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Turning%20off%20prefetch%20in%20the%0A%20asynchronous_consumer_example&In-Reply-To=%3CCC28B25FDAC5D943B606F46369686C2A35EA9218%40SJC4EXDAG01-02.corp.service-now.com%3E"
       TITLE="[rabbitmq-discuss] Turning off prefetch in the asynchronous_consumer_example">Scott.Chapman at servicenow.com
       </A><BR>
    <I>Fri Mar  8 19:02:07 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025803.html">[rabbitmq-discuss] Turning off prefetch in the	asynchronous_consumer_example
</A></li>
        <LI>Next message: <A HREF="025822.html">[rabbitmq-discuss] Turning off prefetch in the	asynchronous_consumer_example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25821">[ date ]</a>
              <a href="thread.html#25821">[ thread ]</a>
              <a href="subject.html#25821">[ subject ]</a>
              <a href="author.html#25821">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It's not auto-ack. That's disabled. I don't want them auto-ack'd.

I don&#8217;t want it to &quot;check out the message&quot;. That's prefetching. I want it to leave the message alone until it's ready to be processed.

Scott

From: McIntosh Jason &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mcintoshj at gmail.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mcintoshj at gmail.com</A>&gt;&gt;
Reply-To: Discussions about RabbitMQ &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Date: Thursday, March 7, 2013 8:12 PM
To: Discussions about RabbitMQ &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Subject: Re: [rabbitmq-discuss] Turning off prefetch in the asynchronous_consumer_example

Are you sure you're not seeing it as an auto-ack issue?  Not sure enough of what's going on, but if you're only seeing one un-ack'd message when the second comes in, it's just checked out the message and waiting for an ack.  If you want to auto-acknowledge the messages, I believe that's an option to the consumer.

Jason

On Mar 7, 2013, at 12:16 PM, Scott Chapman wrote:

Code from here:
<A HREF="https://github.com/pika/pika/blob/master/docs/examples/asynchronous_consumer_example.rst">https://github.com/pika/pika/blob/master/docs/examples/asynchronous_consumer_example.rst</A>

I've tried putting the qos call here:

    def on_channel_open(self, channel):
        &quot;&quot;&quot;This method is invoked by pika when the channel has been opened.
        The channel object is passed in so we can make use of it.

        Since the channel is now open, we'll declare the exchange to use.

        :param pika.channel.Channel channel: The channel object

        &quot;&quot;&quot;
        LOGGER.debug('Channel opened')
        channel.basic_qos(prefetch_count=1)
        self._channel = channel
        self.add_on_channel_close_callback()
        self.setup_exchange(self.EXCHANGE)

It did not turn off prefetching.  Messages still show up in RabbitMQ as Unacknowledged rather than Ready when I send one and send a 2nd before the 1st is done processing.

What am I missing?

I want to turn off prefetching.
I can't figure out how to turn it off on the Connection. That would be preferable, or turn it off globally.

Any clues GREATLY appreciated.

Thanks,
Scott
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130308/62e51210/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130308/62e51210/attachment.htm</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025803.html">[rabbitmq-discuss] Turning off prefetch in the	asynchronous_consumer_example
</A></li>
	<LI>Next message: <A HREF="025822.html">[rabbitmq-discuss] Turning off prefetch in the	asynchronous_consumer_example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25821">[ date ]</a>
              <a href="thread.html#25821">[ thread ]</a>
              <a href="subject.html#25821">[ subject ]</a>
              <a href="author.html#25821">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
