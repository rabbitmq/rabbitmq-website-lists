<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] basic.qos prefetch across multiple queues - useful?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20basic.qos%20prefetch%20across%20multiple%20queues%20-%0A%20useful%3F&In-Reply-To=%3CCD6CDAFD.89B8%25Michael.Laing%40nytimes.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025990.html">
   <LINK REL="Next"  HREF="025993.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] basic.qos prefetch across multiple queues - useful?</H1>
    <B>Laing, Michael P.</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20basic.qos%20prefetch%20across%20multiple%20queues%20-%0A%20useful%3F&In-Reply-To=%3CCD6CDAFD.89B8%25Michael.Laing%40nytimes.com%3E"
       TITLE="[rabbitmq-discuss] basic.qos prefetch across multiple queues - useful?">Michael.Laing at nytimes.com
       </A><BR>
    <I>Mon Mar 18 19:00:53 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025990.html">[rabbitmq-discuss] basic.qos prefetch across multiple queues -	useful?
</A></li>
        <LI>Next message: <A HREF="025993.html">[rabbitmq-discuss] basic.qos prefetch across multiple queues - useful?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25991">[ date ]</a>
              <a href="thread.html#25991">[ thread ]</a>
              <a href="subject.html#25991">[ subject ]</a>
              <a href="author.html#25991">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We use python - a process normally has several channels open, using pika.SelectConnection and the continuation (event-driven) programming style.

However, we typically use a channel per queue partly so that we can set prefetch on a per queue basis.

So I think it would make more sense for the prefetch limit to be associated directly with the queue.

Michael

From: Alvaro Videla &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">videlalvaro at gmail.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">videlalvaro at gmail.com</A>&gt;&gt;
Reply-To: rabbitmq &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Date: Monday, March 18, 2013 1:36 PM
To: rabbitmq &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;&gt;
Subject: Re: [rabbitmq-discuss] basic.qos prefetch across multiple queues - useful?

Hi,

I think per-queue would be better, at least for the PHP people. Since PHP doesn't support threads is not common to have multiple channels in one process. So basic.qos as is today limits every queue in the channel for most PHP scripts.

I guess other languages like Python are in the same area.

Regards,

Alvaro


On Mon, Mar 18, 2013 at 7:30 PM, Matthias Radestock &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;&gt; wrote:
Is anybody setting a basic.qos prefetch limit on channels with consumers on multiple queues?

If so, are you relying on the fact that the prefetch limit applies *across* queues rather than *per* queue?

That feature entails considerable implementation complexity and has a substantial performance impact on consuming from basic.qos-limited channels in general. And I've just found a bug in that area of the code, fixing of which will make the implementation even more complex and hurt performance even more.

Hence I am trying to gauge people's opinion on whether we could make the prefetch limit apply per-queue instead.

Regards,

Matthias.
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130318/e70e95ff/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130318/e70e95ff/attachment.htm</A>&gt;
</PRE>




































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025990.html">[rabbitmq-discuss] basic.qos prefetch across multiple queues -	useful?
</A></li>
	<LI>Next message: <A HREF="025993.html">[rabbitmq-discuss] basic.qos prefetch across multiple queues - useful?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25991">[ date ]</a>
              <a href="thread.html#25991">[ thread ]</a>
              <a href="subject.html#25991">[ subject ]</a>
              <a href="author.html#25991">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
