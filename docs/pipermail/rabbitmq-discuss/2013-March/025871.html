<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RMQ Erlang Client: Auto reconnections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RMQ%20Erlang%20Client%3A%20Auto%20reconnections&In-Reply-To=%3C6FF70A2E-F101-4BE6-85B0-5397254FEB8A%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025870.html">
   <LINK REL="Next"  HREF="025921.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RMQ Erlang Client: Auto reconnections</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RMQ%20Erlang%20Client%3A%20Auto%20reconnections&In-Reply-To=%3C6FF70A2E-F101-4BE6-85B0-5397254FEB8A%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RMQ Erlang Client: Auto reconnections">tim at rabbitmq.com
       </A><BR>
    <I>Tue Mar 12 09:29:38 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025870.html">[rabbitmq-discuss] RMQ Erlang Client: Auto reconnections
</A></li>
        <LI>Next message: <A HREF="025921.html">[rabbitmq-discuss] Invitacion: Cursos Redes Sociales,	Email Marketing, Posicionamiento web...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25871">[ date ]</a>
              <a href="thread.html#25871">[ thread ]</a>
              <a href="subject.html#25871">[ subject ]</a>
              <a href="author.html#25871">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alex,

On 12 Mar 2013, at 07:05, Alex Hudich wrote:
&gt;<i> ... I can't afford to crash the entire application because of rmq disconnects because it perform a lot of tasks beside rmq messages handling.
</I>&gt;<i> 
</I>
That's quite understandable. In the title of the post you've said 'RMQ Erlang Client' so I'm a little confused. If you have an Erlang 'process' that fails, it will not 'crash the entire application' - only if the top level supervisor fails and the application restart_type is permanent will the whole Erlang node stop. So why is your top level supervisor failing, and if you've made connectivity a pre-requisite for starting a process that sits directly beneath the top level supervisor then this is going to continue to happen. After all, if the network is down and the process keeps trying to restart and failing because it cannot establish a connection, what should we expect to happen? You need to decide how your application will cope with this, and more likely than not write some code to deal with it.

Going back to your previous point...

&gt;<i> ... I wonder if there any way to handle disconnects and automatically reconnect process to rmq server. 
</I>

The canonical approach to noticing disconnection is to enable heartbeats, ensuring timely discovery of network disruptions. This will terminate your gen_connection process if the heartbeat request times out. As for automatic disconnection, regardless of why a gen_connection (or other) process dies, what's wrong with having one of your supervisors restart the relevant process in order to re-establish connectivity? As I mentioned earlier, it might be useful to use a timer to periodically try to re-connect in case you want to prevent network disruption from bringing your application down, since successive restarts by the supervisor will eventually reach max intensity and cause the supervisor to shut down.

Cheers,
Tim
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025870.html">[rabbitmq-discuss] RMQ Erlang Client: Auto reconnections
</A></li>
	<LI>Next message: <A HREF="025921.html">[rabbitmq-discuss] Invitacion: Cursos Redes Sociales,	Email Marketing, Posicionamiento web...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25871">[ date ]</a>
              <a href="thread.html#25871">[ thread ]</a>
              <a href="subject.html#25871">[ subject ]</a>
              <a href="author.html#25871">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
