<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Scaling Throughput with Highly Available	Queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Scaling%20Throughput%20with%20Highly%20Available%0A%09Queues&In-Reply-To=%3CCAO%3D6ox-KkDbxj9v_oCmpz04pfNF7cge-FMXb6KMj_D2S_xVR_g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026046.html">
   <LINK REL="Next"  HREF="026051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Scaling Throughput with Highly Available	Queues</H1>
    <B>Richard Raseley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Scaling%20Throughput%20with%20Highly%20Available%0A%09Queues&In-Reply-To=%3CCAO%3D6ox-KkDbxj9v_oCmpz04pfNF7cge-FMXb6KMj_D2S_xVR_g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Scaling Throughput with Highly Available	Queues">richard at raseley.com
       </A><BR>
    <I>Tue Mar 19 22:35:51 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026046.html">[rabbitmq-discuss] Scaling Throughput with Highly Available	Queues
</A></li>
        <LI>Next message: <A HREF="026051.html">[rabbitmq-discuss] Scaling Throughput with Highly	Available	Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26049">[ date ]</a>
              <a href="thread.html#26049">[ thread ]</a>
              <a href="subject.html#26049">[ subject ]</a>
              <a href="author.html#26049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

I am glad that you were able to anticipate where I was heading - that means
I am not completely insane (at least as it relates to this). =]

Yes, I understand that they are actually two separate queues (I am treating
them as one logical one for purposes of discussion). In this case the lack
of order preservation and visibility from one cluster to the other isn't an
issue for us. We decided not to go with two queues for the transparency
reasons you mentioned.

Thanks so much for your time today.

Regards,

Richard


On Tue, Mar 19, 2013 at 3:27 PM, Matthias Radestock
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;wrote:

&gt;<i> On 19/03/13 22:12, Richard Raseley wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> There are four servers named rmq01, rmq02, rmq03, and rmq04. Servers
</I>&gt;&gt;<i> rmq01 and rmq02 are clustered; servers rmq03 and rmq04 are clustered (so
</I>&gt;&gt;<i> we now have 2x two node clusters).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On both clusters we create a vhost named &quot;default&quot;, a direct exchange
</I>&gt;&gt;<i> named &quot;default&quot;, a queue named &quot;default&quot;, a user &quot;default&quot; (which has
</I>&gt;&gt;<i> read, write and config access to the aforementioned objects) with a
</I>&gt;&gt;<i> password of &quot;default&quot; and apply the ha-all mode to the &quot;default&quot; vhost.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We place these two identically configured clusters inside of a load
</I>&gt;&gt;<i> balanced pool with a &quot;least queue depth&quot; configuration. We then
</I>&gt;&gt;<i> configure the consumers and producers associated with this app to
</I>&gt;&gt;<i> connect to the VIP (which maps to the load balanced pool) to send
</I>&gt;&gt;<i> messages to the &quot;default&quot; exchange and consume messages from the
</I>&gt;&gt;<i> &quot;default&quot; queue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Assuming we have more producers and consumers than we do RabbitMQ nodes
</I>&gt;&gt;<i> (and they get distributed properly), we've now increased our throughput
</I>&gt;&gt;<i> - as we now have two master queue processes to work with on this
</I>&gt;&gt;<i> &quot;single&quot; queue.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I thought that's where you were heading :)
</I>&gt;<i>
</I>&gt;<i> You really have two queues in the above. Message order is no longer
</I>&gt;<i> preserved between messages ending up in different (real) queues. And
</I>&gt;<i> consumers on one (real) queue will never see the messages published to the
</I>&gt;<i> other. If that is ok in your use case then fine.
</I>&gt;<i>
</I>&gt;<i> You could get the same effect by just having two queues in the same
</I>&gt;<i> cluster, though obviously that requires them to be named differently and
</I>&gt;<i> hence is not transparent to clients.
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130319/83571012/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130319/83571012/attachment.htm</A>&gt;
</PRE>




































































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026046.html">[rabbitmq-discuss] Scaling Throughput with Highly Available	Queues
</A></li>
	<LI>Next message: <A HREF="026051.html">[rabbitmq-discuss] Scaling Throughput with Highly	Available	Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26049">[ date ]</a>
              <a href="thread.html#26049">[ thread ]</a>
              <a href="subject.html#26049">[ subject ]</a>
              <a href="author.html#26049">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
