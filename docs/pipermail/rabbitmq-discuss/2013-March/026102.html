<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Many RabbitMQ Status Processes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Many%20RabbitMQ%20Status%20Processes&In-Reply-To=%3C1C1E42D0-F36D-4E70-A311-C4798F5E53CB%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026047.html">
   <LINK REL="Next"  HREF="026031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Many RabbitMQ Status Processes</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Many%20RabbitMQ%20Status%20Processes&In-Reply-To=%3C1C1E42D0-F36D-4E70-A311-C4798F5E53CB%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Many RabbitMQ Status Processes">tim at rabbitmq.com
       </A><BR>
    <I>Thu Mar 21 12:00:08 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026047.html">[rabbitmq-discuss] Many RabbitMQ Status Processes
</A></li>
        <LI>Next message: <A HREF="026031.html">[rabbitmq-discuss] socket_error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26102">[ date ]</a>
              <a href="thread.html#26102">[ thread ]</a>
              <a href="subject.html#26102">[ subject ]</a>
              <a href="author.html#26102">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Eric,

On 19 Mar 2013, at 16:18, Eric Berg wrote:
&gt;<i> Hi! I have a 2 node cluster running for a prototype we are developing, it handles over 1000 queues and over 1000 msg/s when running at full speed. We had an issue recently with some run away processes that published messages from production app servers vi the php library:
</I>[snip]
&gt;<i> The cause of that is still under investigation, but it left many thousands of 'stale' idle connections that rabbit was maintaining.
</I>
How did you identify that - using the management UI? What version of rabbit are you running and on which os/platform?

&gt;<i> Attempting to stop/start each node hangs indefinitely, the only way get a full restart of the server is to actually restart the hardware. I see 58 'status' processes attributed to rabbit:
</I>&gt;<i> 
</I>&gt;<i> rabbitmq 16066 16033  0 Mar18 ?        00:00:00 inet_gethost 4
</I>&gt;<i> rabbitmq 16067 16066  0 Mar18 ?        00:00:00 inet_gethost 4
</I>&gt;<i> root     17713 20340  0 05:27 ?        00:00:00 /bin/sh /etc/init.d/rabbitmq-server status
</I>&gt;<i> root     17716 17713  0 05:27 ?        00:00:00 /bin/sh /usr/sbin/rabbitmqctl status
</I>&gt;<i> root     17725 17716  0 05:27 ?        00:00:00 su rabbitmq -s /bin/sh -c /usr/lib/rabbitmq/bin/rabbitmqctl  &quot;status&quot;
</I>&gt;<i> rabbitmq 17726 17725  0 05:27 ?        00:00:00 /usr/lib64/erlang/erts-5.8.5/bin/beam.smp -- -root /usr/lib64/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.0.1/sbin/../ebin -noshell -noinput -hidden -sname rabbitmqctl17726 -s rabbit_control_main -nodename <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbit</A> -extra status
</I>&gt;<i> 
</I>
Where's the 58 coming from?

&gt;<i> 
</I>&gt;<i> When stopping the node I see this in the log file:
</I>&gt;<i> =INFO REPORT==== 19-Mar-2013::11:18:32 ===
</I>&gt;<i> Stopping RabbitMQ
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 19-Mar-2013::11:18:32 ===
</I>&gt;<i>     application: rabbitmq_management_visualiser
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: temporary
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 19-Mar-2013::11:18:32 ===
</I>&gt;<i>     application: rabbitmq_federation_management
</I>&gt;<i>     exited: stopped
</I>&gt;<i>     type: temporary
</I>&gt;<i> 
</I>
Those look perfectly normal. I thought you said you couldn't stop the node(s) at all?

&gt;<i> 
</I>&gt;<i> Has anyone see issues with many thousands of stale connections, in combination with many status processes and hanging stop/start? Currently there are are no producers or consumers connected to this box.
</I>
The 'status' processes are only ever launched by the init daemon or by a user issuing `rabbitmq-server status` - are you sure you don't have some monitoring infrastructure that is triggering these commands?

Cheers,
Tim

&gt;<i> 
</I>&gt;<i> Thanks!
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>

















































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026047.html">[rabbitmq-discuss] Many RabbitMQ Status Processes
</A></li>
	<LI>Next message: <A HREF="026031.html">[rabbitmq-discuss] socket_error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26102">[ date ]</a>
              <a href="thread.html#26102">[ thread ]</a>
              <a href="subject.html#26102">[ subject ]</a>
              <a href="author.html#26102">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
