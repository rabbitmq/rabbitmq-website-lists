<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Difference between async connection using ioloop and blocking connection for rabbitmq
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Difference%20between%20async%20connection%20using%0A%20ioloop%20and%20blocking%20connection%20for%20rabbitmq&In-Reply-To=%3C8A65CF8681F942BCA31828CD8733DCE9%40meetme.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025783.html">
   <LINK REL="Next"  HREF="025772.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Difference between async connection using ioloop and blocking connection for rabbitmq</H1>
    <B>Gavin M. Roy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Difference%20between%20async%20connection%20using%0A%20ioloop%20and%20blocking%20connection%20for%20rabbitmq&In-Reply-To=%3C8A65CF8681F942BCA31828CD8733DCE9%40meetme.com%3E"
       TITLE="[rabbitmq-discuss] Difference between async connection using ioloop and blocking connection for rabbitmq">gmr at meetme.com
       </A><BR>
    <I>Thu Mar  7 14:55:04 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025783.html">[rabbitmq-discuss] Difference between async connection using	ioloop and blocking connection for rabbitmq
</A></li>
        <LI>Next message: <A HREF="025772.html">[rabbitmq-discuss] RabbitMQ 3.0.3 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25788">[ date ]</a>
              <a href="thread.html#25788">[ thread ]</a>
              <a href="subject.html#25788">[ subject ]</a>
              <a href="author.html#25788">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You should not use time.sleep, in pika, use connection.sleep():

<A HREF="https://pika.readthedocs.org/en/0.9.9/adapters.html#module-pika.adapters.blocking_connection">https://pika.readthedocs.org/en/0.9.9/adapters.html#module-pika.adapters.blocking_connection</A>

That will likely change what you're seeing. You're freezing the whole process when you use time.sleep while connection.sleep will block your python app for that time while processing communication with RabbitMQ in the background. 


On Thursday, March 7, 2013 at 8:25 AM, Ask Solem wrote:

&gt;<i> 
</I>&gt;<i> On Mar 5, 2013, at 11:14 PM, Ameya Patil &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Ameya.Patil at servicenow.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Ameya.Patil at servicenow.com</A>)&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi, 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Ioloops in async connection is exhibiting blocking semantics. I am trying to understand how this is different than a blocking connection
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The documentation (<A HREF="https://pika.readthedocs.org/en/latest/connecting.html#io-and-event-looping">https://pika.readthedocs.org/en/latest/connecting.html#io-and-event-looping</A> ) states:
</I>&gt;<i> &gt; These IOLoops are blocking methods which loop and listen for events.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; In a experiment I conducted, I publish 2 messages, each 5 times: message 'test' published by AsyncPublisher and 'test1' by AsyncPublisher1.py. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; In the consumer I have an if block stating:
</I>&gt;<i> &gt; If body == test: 
</I>&gt;<i> &gt; Time.sleep(10)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I run AsyncPublisher.py first, and after it has sent 5 test messages I run AsyncPublisher1.py.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The output I expect is :
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; tes1
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Why do you expect this particular order?
</I>&gt;<i> 
</I>&gt;<i> &gt; Instead I get:
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; Tes
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; Test
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; test1
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This is the same as if I would run the sender and receiver using a blocking connection.
</I>&gt;<i> &gt; My question is how does a blocking connection different than ioloop.start ? Does it differ only on multithreading ? 
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> It uses Async I/O, not multithreading, so a single process would not run anything in parallel, but it enables you to do multiple I/O operations at the same time by scheduling
</I>&gt;<i> the callbacks for when the operation can be completed. See <A HREF="http://en.wikipedia.org/wiki/Asynchronous_I/O">http://en.wikipedia.org/wiki/Asynchronous_I/O</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>)
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130307/12b0ee0d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130307/12b0ee0d/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025783.html">[rabbitmq-discuss] Difference between async connection using	ioloop and blocking connection for rabbitmq
</A></li>
	<LI>Next message: <A HREF="025772.html">[rabbitmq-discuss] RabbitMQ 3.0.3 released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25788">[ date ]</a>
              <a href="thread.html#25788">[ thread ]</a>
              <a href="subject.html#25788">[ subject ]</a>
              <a href="author.html#25788">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
