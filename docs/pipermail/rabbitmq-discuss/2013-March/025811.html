<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Keeping idle connections alive in EC2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Keeping%20idle%20connections%20alive%20in%20EC2&In-Reply-To=%3CCD5F7169.86BB%25Michael.Laing%40nytimes.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025806.html">
   <LINK REL="Next"  HREF="025820.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Keeping idle connections alive in EC2</H1>
    <B>Laing, Michael P.</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Keeping%20idle%20connections%20alive%20in%20EC2&In-Reply-To=%3CCD5F7169.86BB%25Michael.Laing%40nytimes.com%3E"
       TITLE="[rabbitmq-discuss] Keeping idle connections alive in EC2">Michael.Laing at nytimes.com
       </A><BR>
    <I>Fri Mar  8 15:50:19 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025806.html">[rabbitmq-discuss] Keeping idle connections alive in EC2
</A></li>
        <LI>Next message: <A HREF="025820.html">[rabbitmq-discuss] Keeping idle connections alive in EC2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25811">[ date ]</a>
              <a href="thread.html#25811">[ thread ]</a>
              <a href="subject.html#25811">[ subject ]</a>
              <a href="author.html#25811">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We keep connections alive for long periods in EC2.

We set the heartbeat to 25 secs to achieve this, as elastic load
balancers, in particular, have short timeouts.

I would recommend upgrading to the latest rabbitmq and setting the
heartbeat in the configuration.

Look to see that it shows up in the management console. It's possible for
client interface code to not agree to heartbeat w the server.

Michael

On 3/8/13 4:56 AM, &quot;Emile Joubert&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>On 07/03/13 22:59, Nishanth wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> While they process the message, rabbitmq drops their connection silently
</I>&gt;&gt;<i> as it considers them to have been idle for a long time.
</I>&gt;<i>
</I>&gt;<i>The broker will not drop connections silently. The culprit is more
</I>&gt;<i>likely a firewall and enabling heartbeats is the correct way to solve
</I>&gt;<i>the problem.
</I>&gt;<i>
</I>&gt;&gt;<i> I tried to set up heartbeat interval in worker connections but it didn't
</I>&gt;&gt;<i> resolve the issue. It keeps timing out. I am not able to understand how
</I>&gt;&gt;<i> this heartbeat work or how to debug to find out why its timing out.
</I>&gt;<i>
</I>&gt;<i>You can check that the heartbeat is indeed recognised in the broker by
</I>&gt;<i>issuing &quot;rabbitmqctl list_connections timeout&quot;.
</I>&gt;<i>
</I>&gt;<i>If the heartbeat is set too long then connections may of course still be
</I>&gt;<i>dropped, e.g. if an intervening firewall has a 10 minute timeout and the
</I>&gt;<i>AMQP heartbeats are exchanged every 15 minutes then connections will
</I>&gt;<i>still be dropped.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>-Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>rabbitmq-discuss mailing list
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025806.html">[rabbitmq-discuss] Keeping idle connections alive in EC2
</A></li>
	<LI>Next message: <A HREF="025820.html">[rabbitmq-discuss] Keeping idle connections alive in EC2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25811">[ date ]</a>
              <a href="thread.html#25811">[ thread ]</a>
              <a href="subject.html#25811">[ subject ]</a>
              <a href="author.html#25811">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
