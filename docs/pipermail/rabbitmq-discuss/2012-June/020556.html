<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Clustering question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20question&In-Reply-To=%3C4FD60E8E.9000405%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020519.html">
   <LINK REL="Next"  HREF="020524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Clustering question</H1>
    <B>Francesco Mazzoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20question&In-Reply-To=%3C4FD60E8E.9000405%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Clustering question">francesco at rabbitmq.com
       </A><BR>
    <I>Mon Jun 11 16:28:14 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020519.html">[rabbitmq-discuss] Clustering question
</A></li>
        <LI>Next message: <A HREF="020524.html">[rabbitmq-discuss] Splitting published messages to a body and	no-body part
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20556">[ date ]</a>
              <a href="thread.html#20556">[ thread ]</a>
              <a href="subject.html#20556">[ subject ]</a>
              <a href="author.html#20556">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

 &gt; The node called <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RIYAZ</A> is down. Now, according to the
 &gt; clustering documentation on rabbitMQ (&quot;A client can connect as
 &gt; normal to any node within a cluster. If that node should fail, and
 &gt; the rest of the cluster survives, then the client should notice the
 &gt; closed connection, and should be able to reconnect to some surviving
 &gt; member of the cluster.&quot;), the producer that I run on my local
 &gt; machine should connect to either ORION or ALLEGRO. But it doesn't,
 &gt; the producer throws an exception as follws:
 &gt; [...]
 &gt; My producer connects to RIYAZ.

The docs here are telling you that is the client responsibility to
detect offline nodes and connect to other nodes in the cluster; not
that the AMQP client code will do that for you automatically. In this
case you will need to manually connect to ALLEGRO or ORION when RIYAZ
is down.

Francesco.

On 07/06/12 20:51, Mahesh Viraktamath wrote:
&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I need some help in clustering three nodes and I am stuck. I hope, you will help.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have clustered three rabbitMQ nodes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On ORION :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> C:\Program Files\RabbitMQ Server\rabbitmq_server-2.8.1\sbin&gt;rabbitmqctl.bat cluster_status
</I>&gt;&gt;<i> Cluster status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ORION</A> ...
</I>&gt;&gt;<i> [{nodes,[{disc,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ALLEGRO</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at RIYAZ</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at ORION</A>]}]},
</I>&gt;&gt;<i>   {running_nodes,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ALLEGRO</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at ORION</A>]}]
</I>&gt;&gt;<i> ...done.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On ALLEGRO :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> C:\Program Files\RabbitMQ Server\rabbitmq_server-2.8.1\sbin&gt;rabbitmqctl.bat cluster_status
</I>&gt;&gt;<i> Cluster status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ALLEGRO</A> ...
</I>&gt;&gt;<i> [{nodes,[{disc,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ALLEGRO</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at RIYAZ</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at ORION</A>]}]},
</I>&gt;&gt;<i>   {running_nodes,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ORION</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at ALLEGRO</A>]}]
</I>&gt;&gt;<i> ...done.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The node called <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RIYAZ</A> is down. Now, according to the clustering documentation on rabbitMQ (&quot;A client can connect as normal to any node within a cluster. If that node should fail, and the rest of the cluster survives, then the client should notice the closed connection, and should be able to reconnect to some surviving member of the cluster.&quot;), the producer that I run on my local machine should connect to either ORION or ALLEGRO. But it doesn't, the producer throws an exception as follws:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> java.net.NoRouteToHostException: No route to host
</I>&gt;&gt;<i> at java.net.PlainSocketImpl.socketConnect(Native Method)
</I>&gt;&gt;<i> at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
</I>&gt;&gt;<i> at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
</I>&gt;&gt;<i> at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
</I>&gt;&gt;<i> at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
</I>&gt;&gt;<i> at java.net.Socket.connect(Socket.java:579)
</I>&gt;&gt;<i> at com.rabbitmq.client.ConnectionFactory.createFrameHandler(ConnectionFactory.java:445)
</I>&gt;&gt;<i> at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:504)
</I>&gt;&gt;<i> at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:533)
</I>&gt;&gt;<i> at producer.RPCClient1.&lt;init&gt;(RPCClient1.java:22)
</I>&gt;&gt;<i> at producer.RPCClient.main(RPCClient.java:68)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> My producer connects to RIYAZ.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please shed some light.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> Mahesh
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020519.html">[rabbitmq-discuss] Clustering question
</A></li>
	<LI>Next message: <A HREF="020524.html">[rabbitmq-discuss] Splitting published messages to a body and	no-body part
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20556">[ date ]</a>
              <a href="thread.html#20556">[ thread ]</a>
              <a href="subject.html#20556">[ subject ]</a>
              <a href="author.html#20556">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
