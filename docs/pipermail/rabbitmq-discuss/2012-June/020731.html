<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Incorrect display of mirrored queues as	unsynchronised after database failover
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Incorrect%20display%20of%20mirrored%20queues%20as%0A%09unsynchronised%20after%20database%20failover&In-Reply-To=%3CCACLE7iy7mosnq%2BGSJHDC_z_N5fxtC0GRujTk2MMUibiBSJVrgQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020730.html">
   <LINK REL="Next"  HREF="020775.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Incorrect display of mirrored queues as	unsynchronised after database failover</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Incorrect%20display%20of%20mirrored%20queues%20as%0A%09unsynchronised%20after%20database%20failover&In-Reply-To=%3CCACLE7iy7mosnq%2BGSJHDC_z_N5fxtC0GRujTk2MMUibiBSJVrgQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Incorrect display of mirrored queues as	unsynchronised after database failover">mpietrek at skytap.com
       </A><BR>
    <I>Wed Jun 20 22:31:46 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020730.html">[rabbitmq-discuss] Filter out messages from self
</A></li>
        <LI>Next message: <A HREF="020775.html">[rabbitmq-discuss] Incorrect display of mirrored queues as	unsynchronised after database failover
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20731">[ date ]</a>
              <a href="thread.html#20731">[ thread ]</a>
              <a href="subject.html#20731">[ subject ]</a>
              <a href="author.html#20731">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Back before 2.8.0 was announced, I reported an issue with Mirrored queues
reporting some nodes as unsynchronized.  SimonM says it was fixed, per the
release notes:

- fix incorrect display of mirrored queues as unsynchronised after database
  failover


However, I'm still seeing the issue in 2.8.2. In our cluster with several
mirrored queues in a three-node cluster, I do a &quot;rolling upgrade&quot; operation
wherein I restart each node in sequence. After bring each node back up I
wait for the queue to become fully synchronized before moving on to the
next node.

At the beginning of the rolling restart, the queue has no messages in it
and the management UI says there are two synchronized nodes in addition to
the master.

At some later point after restarting a node, the management console and
HTTP API report that one of the nodes is unsynchronized, despite there
being 0 messages in the queue.

I have verbose mnesia tracing enabled if this would help track down the
problem.

Thanks,

Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120620/35e9c4f6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120620/35e9c4f6/attachment.htm</A>&gt;
</PRE>

































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020730.html">[rabbitmq-discuss] Filter out messages from self
</A></li>
	<LI>Next message: <A HREF="020775.html">[rabbitmq-discuss] Incorrect display of mirrored queues as	unsynchronised after database failover
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20731">[ date ]</a>
              <a href="thread.html#20731">[ thread ]</a>
              <a href="subject.html#20731">[ subject ]</a>
              <a href="author.html#20731">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
