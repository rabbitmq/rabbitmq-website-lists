<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Transaction
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Transaction&In-Reply-To=%3C33993156.post%40talk.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020548.html">
   <LINK REL="Next"  HREF="020499.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Transaction</H1>
    <B>David sUAREZ</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Transaction&In-Reply-To=%3C33993156.post%40talk.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Transaction">d.suarez at aquaesolutions.com
       </A><BR>
    <I>Mon Jun 11 14:32:15 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020548.html">[rabbitmq-discuss] Transaction
</A></li>
        <LI>Next message: <A HREF="020499.html">[rabbitmq-discuss] several further questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20549">[ date ]</a>
              <a href="thread.html#20549">[ thread ]</a>
              <a href="subject.html#20549">[ subject ]</a>
              <a href="author.html#20549">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Matthias,

I agree that the solution is to control the duplication of messages. The
worst case is that I say when messages are notifications to users when an
error has occurred while processing the message queue. The user receive
several messages in the same error. It would be nice in future have
transactions between queues. Something that implement the database systems
quite well. We would greatly facilitate the work.

Thank you very much for the answer


Matthias Radestock-3 wrote:
&gt;<i> 
</I>&gt;<i> David,
</I>&gt;<i> 
</I>&gt;<i> On 06/06/12 10:32, David sUAREZ wrote:
</I>&gt;&gt;<i> I have the following problem. In my application I have the following
</I>&gt;&gt;<i> message
</I>&gt;&gt;<i> flow.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) A publisher sends a message to a queue &quot;A&quot;.
</I>&gt;&gt;<i> 2) A subcriptor receives the message from queue &quot;A&quot; and send this message
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> the process &quot;P&quot;.
</I>&gt;&gt;<i> 3) In the process &quot;P&quot; I send a message to the queue &quot;B&quot;.
</I>&gt;&gt;<i> 4) The subcriptor which received the message sends the ACK to RabbitMQ.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The subcriptor uses a channel &quot;C1&quot; to process messages in the point 2.
</I>&gt;&gt;<i> And
</I>&gt;&gt;<i> the point 3 is sent the message to the queue &quot;B&quot; through another channel
</I>&gt;&gt;<i> &quot;C2&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would like the ACK sent by the channel &quot;C1&quot; belonged the same
</I>&gt;&gt;<i> transaction
</I>&gt;&gt;<i> that the publication of the message by the channel &quot;C2&quot;, that is showed
</I>&gt;&gt;<i> in
</I>&gt;&gt;<i> the point 3. Is it possible?. I have only seen  transactions in the same
</I>&gt;&gt;<i> channel. Not by connection.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Why do I want this?. May be that I send the publication showed in section
</I>&gt;&gt;<i> 3
</I>&gt;&gt;<i> and the machine crash. Then the ack of subcriptor will not be sent. Then
</I>&gt;&gt;<i> the
</I>&gt;&gt;<i> &quot;P&quot; process re-processing the previous message and re-send the same
</I>&gt;&gt;<i> message
</I>&gt;&gt;<i> showed in the point 3. Duplicating messages.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://old.nabble.com/file/p33968899/rabbitmq.png">http://old.nabble.com/file/p33968899/rabbitmq.png</A>
</I>&gt;<i> 
</I>&gt;<i> AMQP transactions are channel-bound, so what you want above is not 
</I>&gt;<i> possible. Furthermore, AMQP transactions are only guaranteed to be 
</I>&gt;<i> atomic when they involve a single queue. See 
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/semantics.html#tx">http://www.rabbitmq.com/semantics.html#tx</A> for more details.
</I>&gt;<i> 
</I>&gt;<i> Generally you'll want to design your system s.t. it can cope with 
</I>&gt;<i> duplicate messages. There are many more failure scenarios than the one 
</I>&gt;<i> described above, and re-sending of messages, with the resulting 
</I>&gt;<i> possibility of duplication, is usually the easiest way to handle them. 
</I>&gt;<i> E.g. consider what happens in case of failures in steps 1 or 3; the 
</I>&gt;<i> sender has no way of knowing whether the message made it through and 
</I>&gt;<i> hence would have to re-send it.
</I>&gt;<i> 
</I>&gt;<i> Matthias.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>-- 
View this message in context: <A HREF="http://old.nabble.com/Transaction-tp33968899p33993156.html">http://old.nabble.com/Transaction-tp33968899p33993156.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020548.html">[rabbitmq-discuss] Transaction
</A></li>
	<LI>Next message: <A HREF="020499.html">[rabbitmq-discuss] several further questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20549">[ date ]</a>
              <a href="thread.html#20549">[ thread ]</a>
              <a href="subject.html#20549">[ subject ]</a>
              <a href="author.html#20549">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
