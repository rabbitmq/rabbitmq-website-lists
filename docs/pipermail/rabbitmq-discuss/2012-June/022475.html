<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> No subject
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.16.1347555720.8494.rabbitmq-discuss%40lists.rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021998.html">
   <LINK REL="Next"  HREF="022611.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>No subject</H1>
    <B></B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.16.1347555720.8494.rabbitmq-discuss%40lists.rabbitmq.com%3E"
       TITLE="No subject">
       </A><BR>
    <I>Sun Jun 17 23:12:48 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021998.html">No subject
</A></li>
        <LI>Next message: <A HREF="022611.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22475">[ date ]</a>
              <a href="thread.html#22475">[ thread ]</a>
              <a href="subject.html#22475">[ subject ]</a>
              <a href="author.html#22475">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>i realized that I can only send ACKs from the original connection/channel
that was used to receive a message. This sorta blocks me from implementing
the use/case I wanted. Here is the scenario:

- Publisher sends a message to RabbitMQ queue (via exchange using routing
key and binding).
- Subscriber gets the message. It doesn't ACK immediately because message
processing involves database operation. If database operations goes well,
then ACK will be sent. If database operation fails, no ACK will be sent and
message will be redelivered later (which is great, because I want to retry
the operation).
- Database operation goes through and the subscriber tries to send ACK.
Immediately before that, RabbitMQ host becomes unavailable and ACK doesn't
go through (I get the exception, so I am notified that ACKing failed).
- My operation is not idempotent right now, so when another subscriber
connects to RabbitMQ (after it becomes available), the same message will be
redelivered to it (because ACK didn't go through). This will cause
duplicated operations, because original message was never ACKed properly.

I wanted to save ACKs to disk and then recover them (send them to RabbitMQ)
before new connections from subscribers are made. However, from the link
above it seems that this is not possible with RabbitMQ? Is there a way for
me to implement this or should I treat ACKs differently? If ACK should only
indicate if message transfer was okay, then I suppose using autoacking
feature (when consumer is initialized setting noAck parameter to true) is
better than doing it manually. In that case, is there a way for me to
request redelivery of this message from Rabbit even though it was previously
ACKed?

Thanks a lot for your time!
Milan 



--
View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/What-is-a-proper-workflow-for-ACKs-tp21995.html">http://rabbitmq.1065348.n5.nabble.com/What-is-a-proper-workflow-for-ACKs-tp21995.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021998.html">No subject
</A></li>
	<LI>Next message: <A HREF="022611.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22475">[ date ]</a>
              <a href="thread.html#22475">[ thread ]</a>
              <a href="subject.html#22475">[ subject ]</a>
              <a href="author.html#22475">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
