<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> No subject
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.10.1344473516.8494.rabbitmq-discuss%40lists.rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020719.html">
   <LINK REL="Next"  HREF="021869.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>No subject</H1>
    <B></B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20No%20subject&In-Reply-To=%3Cmailman.10.1344473516.8494.rabbitmq-discuss%40lists.rabbitmq.com%3E"
       TITLE="No subject">
       </A><BR>
    <I>Sun Jun 17 23:12:48 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020719.html">No subject
</A></li>
        <LI>Next message: <A HREF="021869.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21783">[ date ]</a>
              <a href="thread.html#21783">[ thread ]</a>
              <a href="subject.html#21783">[ subject ]</a>
              <a href="author.html#21783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>could be something totally different.
Application creates multiple Connection/Channel pairs and each is assigned
its own Consumer instance.
We have a single consumer per channel per connection.

Here's a snippet of code from Consumer.handleDelivery() method modified to
remove business specific information.
But this is the gist of what happens when a message is received.

    public final void handleDelivery(String consumerTag, Envelope envelope,
            BasicProperties properties, byte[] body) throws IOException {

        boolean failed = false;
        Throwable failureReason = null;
        try {
            // create a delivery for the client
            delivery = createDelivery(consumerTag, body, envelope,
properties);
            // deliver to client
            deliveryHandler.handleDelivery(delivery);
        } catch (Throwable e) {
            // client had a problem handling/processing delivery
            failed = true;
            failureReason = e;
            log.error(&quot;Client failed while handling delivery. &quot;
                    + e.getMessage(), e);
        } finally {
            if (failed) {
                handleFailedDelivery(
                        failureReason, body, properties);
            } else {
                try {
                    acknowledge(envelope.getDeliveryTag());
                } catch (Exception e) {
                    notifyClient(e);
                }
            }
        }
    }

Envelope object that is handed to the method as an argument stays method
local.
Our application is connecting to the cluster through a netscaler VIP.

We have not seen this problem when consuming from a local cluster with the
same application.

Any help or pointer in the right direction is appreciated.

Thanks,
Vineet

--f46d0438936f1737cf04c6caa103
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: base64

SGVsbG8sPGJyPjxicj5XZSBhcmUgdXNpbmcgcmFiYml0IGNsdXN0ZXIgZm9yIGEgZmV3IG1vbnRo
cyBub3cgYW5kIHRoaW5ncyBoYXZlIGJlZW4gd29ya2luZyBmaW5lIHVudGlsIG5vdy48YnI+PGJy
PkVOVklPUk5NRU5UPGJyPj09PT09PT09PT09PT08YnI+UmFiYml0TVEgU2VydmVyIHZlcnNpb24g
Mi44LjI8YnI+UmFiYml0TVEgQ2xpZW50IDIuNy4xPGJyPjxicj5PbmUgb2Ygb3VyIGFwcGxpY2F0
aW9ucyBpcyBjb25zdW1pbmcgbWVzc2FnZXMgZnJvbSBSYWJiaXRNUSBzZXJ2ZXIgb3ZlciBXQU4u
PGJyPgpUaGlzIHdhcyBhIHJlY2VudCBpbnRyb2R1Y3Rpb24gaS5lLiBnb2luZyBvdmVyIFdBTiB0
byBhIGRpZmYuIFJhYmJpdE1RIGNsdXN0ZXIgdGhhbiB0aGUgbG9jYWwgb25lLjxicj5BZnRlciBh
IGZldyBob3VycyBvZiBiZWluZyB1cCBhbmQgY29uc3VtaW5nIG1lc3NhZ2VzLCBvbmUgb2YgdGhl
IG1hbnkgY2hhbm5lbHMgaW4gdGhlIGFwcGxpY2F0aW9uIDxicj5pcyBjbG9zZWQgYnkgdGhlIHNl
cnZlciB3aXRoIHRoZSBmb2xsb3dpbmcgbWVzc2FnZS48YnI+Cjxicj57I21ldGhvZCZsdDtjaGFu
bmVsLmNsb3NlJmd0OyhyZXBseS1jb2RlPTQwNiwgcmVwbHktdGV4dD1QUkVDT05ESVRJT05fRkFJ
TEVEIC0gdW5rbm93biBkZWxpdmVyeSB0YWcgMTA3Mzc0Mzg4MywgY2xhc3MtaWQ9NjAsIG1ldGhv
ZC1pZD04MCksIG51bGwsICZxdW90O1tCQDYwN2RhZWMzJnF1b3Q7fTxicj48YnI+RnJvbSB3aGF0
IGkgaGF2ZSByZWFkIHNvIGZhciBpdCBzZWVtcyBsaWtlIGEgcHJvYmxlbSBvZiBkb3VibGUgYWNr
LiBidXQgaXQgY291bGQgYmUgc29tZXRoaW5nIHRvdGFsbHkgZGlmZmVyZW50Ljxicj4KQXBwbGlj
YXRpb24gY3JlYXRlcyBtdWx0aXBsZSBDb25uZWN0aW9uL0NoYW5uZWwgcGFpcnMgYW5kIGVhY2gg
aXMgYXNzaWduZWQgaXRzIG93biBDb25zdW1lciBpbnN0YW5jZS48YnI+V2UgaGF2ZSBhIHNpbmds
ZSBjb25zdW1lciBwZXIgY2hhbm5lbCBwZXIgY29ubmVjdGlvbi48YnI+PGJyPkhlcmUmIzM5O3Mg
YSBzbmlwcGV0IG9mIGNvZGUgZnJvbSBDb25zdW1lci5oYW5kbGVEZWxpdmVyeSgpIG1ldGhvZCBt
b2RpZmllZCB0byByZW1vdmUgYnVzaW5lc3Mgc3BlY2lmaWMgaW5mb3JtYXRpb24uPGJyPgpCdXQg
dGhpcyBpcyB0aGUgZ2lzdCBvZiB3aGF0IGhhcHBlbnMgd2hlbiBhIG1lc3NhZ2UgaXMgcmVjZWl2
ZWQuPGJyPjxicj7CoMKgwqAgcHVibGljIGZpbmFsIHZvaWQgaGFuZGxlRGVsaXZlcnkoU3RyaW5n
IGNvbnN1bWVyVGFnLCBFbnZlbG9wZSBlbnZlbG9wZSw8YnI+wqDCoMKgwqDCoMKgwqDCoMKgwqDC
oCBCYXNpY1Byb3BlcnRpZXMgcHJvcGVydGllcywgYnl0ZVtdIGJvZHkpIHRocm93cyBJT0V4Y2Vw
dGlvbiB7PGJyPgo8YnI+wqDCoMKgwqDCoMKgwqAgYm9vbGVhbiBmYWlsZWQgPSBmYWxzZTs8YnI+
wqDCoMKgwqDCoMKgwqAgVGhyb3dhYmxlIGZhaWx1cmVSZWFzb24gPSBudWxsOzxicj7CoMKgwqDC
oMKgwqDCoCB0cnkgezxicj7CoMKgwqDCoMKgwqDCoMKgwqDCoMKgIC8vIGNyZWF0ZSBhIGRlbGl2
ZXJ5IGZvciB0aGUgY2xpZW50PGJyPsKgwqDCoMKgwqDCoMKgwqDCoMKgwqAgZGVsaXZlcnkgPSBj
cmVhdGVEZWxpdmVyeShjb25zdW1lclRhZywgYm9keSwgZW52ZWxvcGUsIHByb3BlcnRpZXMpOzxi
cj4KwqDCoMKgwqDCoMKgwqDCoMKgwqDCoCAvLyBkZWxpdmVyIHRvIGNsaWVudDxicj7CoMKgwqDC
oMKgwqDCoMKgwqDCoMKgIGRlbGl2ZXJ5SGFuZGxlci5oYW5kbGVEZWxpdmVyeShkZWxpdmVyeSk7
PGJyPsKgwqDCoMKgwqDCoMKgIH0gY2F0Y2ggKFRocm93YWJsZSBlKSB7PGJyPsKgwqDCoMKgwqDC
oMKgwqDCoMKgwqAgLy8gY2xpZW50IGhhZCBhIHByb2JsZW0gaGFuZGxpbmcvcHJvY2Vzc2luZyBk
ZWxpdmVyeTxicj7CoMKgwqDCoMKgwqDCoMKgwqDCoMKgIGZhaWxlZCA9IHRydWU7PGJyPgrCoMKg
wqDCoMKgwqDCoMKgwqDCoMKgIGZhaWx1cmVSZWFzb24gPSBlOzxicj7CoMKgwqDCoMKgwqDCoMKg
wqDCoMKgIGxvZy5lcnJvcigmcXVvdDtDbGllbnQgZmFpbGVkIHdoaWxlIGhhbmRsaW5nIGRlbGl2
ZXJ5LiAmcXVvdDs8YnI+wqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqAgKyBl
LmdldE1lc3NhZ2UoKSwgZSk7PGJyPsKgwqDCoMKgwqDCoMKgIH0gZmluYWxseSB7PGJyPsKgwqDC
oMKgwqDCoMKgwqDCoMKgwqAgaWYgKGZhaWxlZCkgezxicj7CoMKgwqDCoMKgwqDCoMKgwqDCoMKg
wqDCoMKgwqAgaGFuZGxlRmFpbGVkRGVsaXZlcnkoPGJyPgrCoMKgwqDCoMKgwqDCoMKgwqDCoMKg
wqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgIGZhaWx1cmVSZWFzb24sIGJvZHksIHByb3BlcnRpZXMp
Ozxicj7CoMKgwqDCoMKgwqDCoMKgwqDCoMKgIH0gZWxzZSB7PGJyPsKgwqDCoMKgwqDCoMKgwqDC
oMKgwqDCoMKgwqDCoCB0cnkgezxicj7CoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKg
wqDCoCBhY2tub3dsZWRnZShlbnZlbG9wZS5nZXREZWxpdmVyeVRhZygpKTs8YnI+wqDCoMKgwqDC
oMKgwqDCoMKgwqDCoMKgwqDCoMKgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7PGJyPsKgwqDCoMKg
wqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgIG5vdGlmeUNsaWVudChlKTs8YnI+CsKgwqDC
oMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoCB9PGJyPsKgwqDCoMKgwqDCoMKgwqDCoMKgwqAgfTxi
cj7CoMKgwqDCoMKgwqDCoCB9PGJyPsKgwqDCoCB9PGJyPgo8YnI+RW52ZWxvcGUgb2JqZWN0IHRo
YXQgaXMgaGFuZGVkIHRvIHRoZSBtZXRob2QgYXMgYW4gYXJndW1lbnQgc3RheXMgbWV0aG9kIGxv
Y2FsLjxicj5PdXIgYXBwbGljYXRpb24gaXMgY29ubmVjdGluZyB0byB0aGUgY2x1c3RlciB0aHJv
dWdoIGEgbmV0c2NhbGVyIFZJUC48YnI+PGJyPldlIGhhdmUgbm90IHNlZW4gdGhpcyBwcm9ibGVt
IHdoZW4gY29uc3VtaW5nIGZyb20gYSBsb2NhbCBjbHVzdGVyIHdpdGggdGhlIHNhbWUgYXBwbGlj
YXRpb24uPGJyPgo8YnI+QW55IGhlbHAgb3IgcG9pbnRlciBpbiB0aGUgcmlnaHQgZGlyZWN0aW9u
IGlzIGFwcHJlY2lhdGVkLjxicj48YnI+VGhhbmtzLDxicj5WaW5lZXQ8YnI+wqA8YnI+Cg==
--f46d0438936f1737cf04c6caa103--
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020719.html">No subject
</A></li>
	<LI>Next message: <A HREF="021869.html">No subject
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21783">[ date ]</a>
              <a href="thread.html#21783">[ thread ]</a>
              <a href="subject.html#21783">[ subject ]</a>
              <a href="author.html#21783">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
