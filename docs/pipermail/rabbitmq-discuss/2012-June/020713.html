<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Newbie%20Q%3A%20Bugs%20in%202.8.2-1%3F&In-Reply-To=%3CCAG2p9D%2Bq%2BDRK3ZA_gDJLhdW950AnNQcfjFuWcSq2tCXb26LF8g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020705.html">
   <LINK REL="Next"  HREF="020724.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?</H1>
    <B>Eric Bravick</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Newbie%20Q%3A%20Bugs%20in%202.8.2-1%3F&In-Reply-To=%3CCAG2p9D%2Bq%2BDRK3ZA_gDJLhdW950AnNQcfjFuWcSq2tCXb26LF8g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?">ebravick at springsemantics.com
       </A><BR>
    <I>Tue Jun 19 22:16:55 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020705.html">[rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?
</A></li>
        <LI>Next message: <A HREF="020724.html">[rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20713">[ date ]</a>
              <a href="thread.html#20713">[ thread ]</a>
              <a href="subject.html#20713">[ subject ]</a>
              <a href="author.html#20713">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Simon,

On Tue, Jun 19, 2012 at 10:26 AM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;wrote:

&gt;<i> On 19/06/12 15:16, Eric Bravick wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> For people starting with 2.8.2+, you might consider re-visiting the hard
</I>&gt;&gt;<i> failure and making this a warning state instead...  seems to me there's
</I>&gt;&gt;<i> a valid argument to throw a warning here rather than blocking (however,
</I>&gt;&gt;<i> I could be entirely incorrect about that.)
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The trouble is that AMQP doesn't give us the ability to warn-on-publish
</I>&gt;<i> (and even if it did it's easy to imagine that the typical default client
</I>&gt;<i> callback would be a no-op). So it's not clear where a warning would go - we
</I>&gt;<i> already write to logs and show a big red thing in mgmt, but from the number
</I>&gt;<i> of questions we're getting asked it's clear people are not seeing these.
</I>&gt;<i>
</I>&gt;<i>
</I>Ah, I see.  Even if AMQP had a warn-on-publish strategy, that would require
code changes for everyone, so that's a non-starter.  Here, we watch logs
and the management interface - it seems to me (granted I'm from the ops
world more than the dev world) that users of Rabbit should be watching
those...  in this case for a warning that said something about insufficient
disk space to page out the full memory footprint.  If that was OK and
understood, maybe a flag in the config file could be set to silence that
warning.

For example, one of the applications we have under development will be very
high throughput and time sensitive (meaning that the value of the messages
decays very quickly.)  In the event we had a failure that ended up hitting
disk, we'd end up with zero value in the messages anyway, so in that
particular case we'd be running with big memory, almost no disk, and all
warnings suppressed.


&gt;<i> However, there's no denying that this has hurt a lot more people than we
</I>&gt;<i> expected, and we really don't like that.
</I>&gt;<i>
</I>&gt;<i> Its often very difficult to predict this sort of issue in the field.
</I>

&gt;<i> So for the next release we're intending to go with a lower disk space
</I>&gt;<i> limit - probably a hard 1GB. This is not ideal - ideally we would always
</I>&gt;<i> have the ability to page the whole of memory out to disk - but it's at
</I>&gt;<i> least somewhat likely to stop you before you *actually* run out of disk
</I>&gt;<i> space and crash, while hopefully not causing the wave of false-positives
</I>&gt;<i> that have inconvenienced people running 2.8.2.
</I>&gt;<i>
</I>
Hmmm.  Well, its just my opinion, keep in mind that I'm sure you know far
more than I do about what all the Rabbit users need - but if it were my
choice I'd probably consider that a compromise where no one wins overall -
it lowers the bar.  I certainly understand what you were trying to achieve
with the current limits - more stable and consistent outcomes for the vast
majority of users.  I'd either:

1) Stick to your original guns and let us all adjust to best practices.
2) Move this from a block to a warn (in log + management) (my favorite, it
would not shut people off, but it would firmly tell us all that we should
be aware of *why* we are breaking what is a good practice.)

This option seems less attractive:

3) Assign a lower floor.  You'll move the problem quantitatively, but not
qualitatively...  those that hit the limit will still be confused (you'll
discover how many people have &lt;1GB /var ).  Those who don't have enough
disk to page out memory might be in for a very nasty surprise, since they
won't get warned of the potential issue in advance, they might end up
pretty unhappy in a failure mode.

Again, I might be off base here...

-- 
Regards,
--
-- Eric Bravick, CTO
-- Spring Semantics, Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120619/2568de90/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120619/2568de90/attachment.htm</A>&gt;
</PRE>
































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020705.html">[rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?
</A></li>
	<LI>Next message: <A HREF="020724.html">[rabbitmq-discuss] Newbie Q: Bugs in 2.8.2-1?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20713">[ date ]</a>
              <a href="thread.html#20713">[ thread ]</a>
              <a href="subject.html#20713">[ subject ]</a>
              <a href="author.html#20713">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
