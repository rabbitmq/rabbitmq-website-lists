<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel configuration for a clustered broker with mirrored high-availability queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20configuration%20for%20a%20clustered%20broker%0A%20with%20mirrored%20high-availability%20queues&In-Reply-To=%3Cf9ae5a1e-30ed-4999-906f-f40a124c0ff5%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020906.html">
   <LINK REL="Next"  HREF="020913.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel configuration for a clustered broker with mirrored high-availability queues</H1>
    <B>Eric</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20configuration%20for%20a%20clustered%20broker%0A%20with%20mirrored%20high-availability%20queues&In-Reply-To=%3Cf9ae5a1e-30ed-4999-906f-f40a124c0ff5%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Shovel configuration for a clustered broker with mirrored high-availability queues">ejarendt at gmail.com
       </A><BR>
    <I>Fri Jun 29 17:00:54 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020906.html">[rabbitmq-discuss] Connection attempt from disallowed node	question
</A></li>
        <LI>Next message: <A HREF="020913.html">[rabbitmq-discuss] Shovel configuration for a clustered broker with mirrored high-availability queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20912">[ date ]</a>
              <a href="thread.html#20912">[ thread ]</a>
              <a href="subject.html#20912">[ subject ]</a>
              <a href="author.html#20912">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the reply.

The odd thing about the federation plugin is that the downstream broker, 
which is the 'master' conceptually in my case, has to declare its exchange 
type as 'federation', which means the actual type is based on the upstream 
'slave' exchange.  That feels strange to me, because I don't want the 
master to really care about the upstream exchange - it's sort of optional. 
 If the upstream broker is alive that's great, and I want it to forward 
messages along to the master.  If it's not, or isn't present when the 
master starts, I don't want that to be a problem.

Maybe I'm not understanding federation correctly?  It just struck me as odd 
that the master has to go declaring all of the upstream sources it expects, 
and the other way (with shovel) seemed more natural.

I understand that the sources and destination fields accept a list for the 
purpose of failover.  I could configure a single shovel that consumes from 
either broker in the 'slave' cluster and publishes to either broker on the 
master cluster, but I'm worried about the shovel's host broker failing and 
taking the shovel down.

On Friday, June 29, 2012 12:31:41 AM UTC-7, Brendan Hay wrote:
&gt;<i>
</I>&gt;<i> Hi Eric,
</I>&gt;<i>
</I>&gt;<i> FYI: The 'sources' and 'destinations' configuration fields both accept a 
</I>&gt;<i> list. The shovel plugin doesn't actually pull/push to/from all of these 
</I>&gt;<i> simultaneously, it uses them as a form of simple failover - if a connection 
</I>&gt;<i> fails, it uses the next one in the list.
</I>&gt;<i>
</I>&gt;<i> It sounds like for your scenario (when clustering in general), it would be 
</I>&gt;<i> easier to use the federation plugin (
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/federation.html">http://www.rabbitmq.com/federation.html</A>). When you declare a federated 
</I>&gt;<i> exchange on the downstream/master cluster, the plugin auto-magically 
</I>&gt;<i> declares queues (mirrored if configured) on the upstream/AWS cluster .. you 
</I>&gt;<i> would then bind a mirrored queue to the federated exchange on the 
</I>&gt;<i> downstream/master cluster to cause messages to be routed across the link to 
</I>&gt;<i> that queue.
</I>&gt;<i>
</I>&gt;<i> The plugin will then stay connected even if one of your nodes on either 
</I>&gt;<i> cluster go down .. if the whole downstream/master cluster goes away/down, 
</I>&gt;<i> then messages will pile up in the upstream/AWS queues, and be transfered 
</I>&gt;<i> once the link is re-established.
</I>&gt;<i>
</I>&gt;<i> Does that solve your use-case?
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Brendan
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120629/d3ff712a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120629/d3ff712a/attachment.htm</A>&gt;
</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020906.html">[rabbitmq-discuss] Connection attempt from disallowed node	question
</A></li>
	<LI>Next message: <A HREF="020913.html">[rabbitmq-discuss] Shovel configuration for a clustered broker with mirrored high-availability queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20912">[ date ]</a>
              <a href="thread.html#20912">[ thread ]</a>
              <a href="subject.html#20912">[ subject ]</a>
              <a href="author.html#20912">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
