<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Application architecture question: queue failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Application%20architecture%20question%3A%20queue%20failure&In-Reply-To=%3CCAKhN_m7LSCJHx7NcnoNnWGxErf%2BUD20dmAuTQi5s2GMUoHk6yQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020515.html">
   <LINK REL="Next"  HREF="020591.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Application architecture question: queue failure</H1>
    <B>Bill Moseley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Application%20architecture%20question%3A%20queue%20failure&In-Reply-To=%3CCAKhN_m7LSCJHx7NcnoNnWGxErf%2BUD20dmAuTQi5s2GMUoHk6yQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Application architecture question: queue failure">moseley at hank.org
       </A><BR>
    <I>Wed Jun  6 14:05:33 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020515.html">[rabbitmq-discuss] several further questions
</A></li>
        <LI>Next message: <A HREF="020591.html">[rabbitmq-discuss] Application architecture question: queue	failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20501">[ date ]</a>
              <a href="thread.html#20501">[ thread ]</a>
              <a href="subject.html#20501">[ subject ]</a>
              <a href="author.html#20501">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We try and design our architecture (for a large web application) in a way
that we expect any part to fail: &quot;design for failure&quot;.   There's parts of
our system that are prime for RabbitMQ but the concern is that a message
must never be lost -- even when RabbitMQ is setup for HA.

So, designing for that rare situation that a message might get lost, my
approach has been to maintain state on the application.  When I send a
message to get some work down I flag it as &quot;in process&quot; or &quot;pending&quot; with a
start time and a retry counter.  I can then (say with cron) find the
uncompleted tasks that have been waiting for some value of too long.

But, then the problem is what to do with that information?  How do I know
that the message is really lost and not just backed up in the queue?  Don't
want to queue it again in this case as it just compounds the problem (and
then if the first job finally completes the state of the wrong message is
updated).

That, and I frankly think the overhead of my state tracking is possibly
more problematic than the potential for a loss of a message.

Anyway, sorry if this is a mundane (if not a bit off-topic) question -- and
I know it's application-specific. But, it's a question that comes up often
in our design discussions.

Do you have these concerns and how do you handle the possibility of message
or queue loss?

Thanks,

-- 
Bill Moseley
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">moseley at hank.org</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120606/1d87fb62/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120606/1d87fb62/attachment.htm</A>&gt;
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020515.html">[rabbitmq-discuss] several further questions
</A></li>
	<LI>Next message: <A HREF="020591.html">[rabbitmq-discuss] Application architecture question: queue	failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20501">[ date ]</a>
              <a href="thread.html#20501">[ thread ]</a>
              <a href="subject.html#20501">[ subject ]</a>
              <a href="author.html#20501">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
