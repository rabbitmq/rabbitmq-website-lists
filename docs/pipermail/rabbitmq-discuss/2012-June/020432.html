<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pika write buffer problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pika%20write%20buffer%20problem&In-Reply-To=%3CCAEo4zpdNjnZM7vgAkgyCn5pD0iq57rNxqNiEPuWM--GKHjcBig%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020497.html">
   <LINK REL="Next"  HREF="020433.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pika write buffer problem</H1>
    <B>James Dear</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pika%20write%20buffer%20problem&In-Reply-To=%3CCAEo4zpdNjnZM7vgAkgyCn5pD0iq57rNxqNiEPuWM--GKHjcBig%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Pika write buffer problem">jamesdear at gmail.com
       </A><BR>
    <I>Sat Jun  2 09:03:08 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="020497.html">[rabbitmq-discuss] rabbitmqadmin error
</A></li>
        <LI>Next message: <A HREF="020433.html">[rabbitmq-discuss] Pika write buffer problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20432">[ date ]</a>
              <a href="thread.html#20432">[ thread ]</a>
              <a href="subject.html#20432">[ subject ]</a>
              <a href="author.html#20432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yeah I could understand if it was happening after the thousandth, or maybe
even the hundredth message, but tenth? Why would it slow down after just
ten messages?

The messages are indeed getting to rabbitmq, but very slowly.

If I use pika twisted I don't get this problem at all.
On May 27, 2012 10:01 PM, &quot;Gavin M. Roy&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">gmr at myyearbook.com</A>&gt; wrote:

&gt;<i>  The warnings are just warnings, letting you know that the writes to
</I>&gt;<i> rabbitMQ are not happening as quickly as you'd like them to do. Are you
</I>&gt;<i> saying they are not actually getting into RabbitMQ?
</I>&gt;<i>
</I>&gt;<i> On Sunday, May 27, 2012 at 4:27 PM, James Dear wrote:
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm having trouble getting simple examples of basic_publish to work due to
</I>&gt;<i> the write buffer being exceeded. If I use the demo_send code from here&lt;<A HREF="http://pika.github.com/examples.html">http://pika.github.com/examples.html</A>&gt;,
</I>&gt;<i> I only manage to send 5 messages before getting write buffer exceeded
</I>&gt;<i> problems. Here's my output:
</I>&gt;<i>
</I>&gt;<i> [INFO     2012-05-27 20:30:16,863  #5451] Connecting fd 3 to
</I>&gt;<i> 127.0.0.1:5672
</I>&gt;<i> [INFO     2012-05-27 20:30:17,869  #5451] demo_send: Connected to RabbitMQ
</I>&gt;<i> [INFO     2012-05-27 20:30:17,872  #5451] demo_send: Received our Channel
</I>&gt;<i> [INFO     2012-05-27 20:30:17,882  #5451] demo_send: Queue Declared
</I>&gt;<i> [INFO     2012-05-27 20:30:17,883  #5451] Sending: Hello World #0:
</I>&gt;<i> 1338147017.88308692
</I>&gt;<i> [INFO     2012-05-27 20:30:17,883  #5451] Sending: Hello World #1:
</I>&gt;<i> 1338147017.88367391
</I>&gt;<i> [INFO     2012-05-27 20:30:17,884  #5451] Sending: Hello World #2:
</I>&gt;<i> 1338147017.88425899
</I>&gt;<i> [INFO     2012-05-27 20:30:17,884  #5451] Sending: Hello World #3:
</I>&gt;<i> 1338147017.88472700
</I>&gt;<i> [INFO     2012-05-27 20:30:17,885  #5451] Sending: Hello World #4:
</I>&gt;<i> 1338147017.88527107
</I>&gt;<i> /..snip../pika/connection.py:766: UserWarning: Pika: Write buffer exceeded
</I>&gt;<i> warning threshold at 413 bytes and an estimated 10 frames behind
</I>&gt;<i>   warn(message % (self.outbound_buffer.size, est_frames_behind))
</I>&gt;<i> /..snip../pika/connection.py:766: UserWarning: Pika: Write buffer exceeded
</I>&gt;<i> warning threshold at 447 bytes and an estimated 11 frames behind
</I>&gt;<i>   warn(message % (self.outbound_buffer.size, est_frames_behind))
</I>&gt;<i> /..snip../pika/connection.py:766: UserWarning: Pika: Write buffer exceeded
</I>&gt;<i> warning threshold at 490 bytes and an estimated 12 frames behind
</I>&gt;<i>   warn(message % (self.outbound_buffer.size, est_frames_behind))
</I>&gt;<i> [INFO     2012-05-27 20:30:17,887  #5451] Sending: Hello World #5:
</I>&gt;<i> 1338147017.88733912
</I>&gt;<i> /..snip../pika/connection.py:766: UserWarning: Pika: Write buffer exceeded
</I>&gt;<i> warning threshold at 511 bytes and an estimated 13 frames behind
</I>&gt;<i>   warn(message % (self.outbound_buffer.size, est_frames_behind))
</I>&gt;<i> /..snip../pika/connection.py:766: UserWarning: Pika: Write buffer exceeded
</I>&gt;<i> warning threshold at 545 bytes and an estimated 14 frames behind
</I>&gt;<i>   warn(message % (self.outbound_buffer.size, est_frames_behind))
</I>&gt;<i> /..snip../pika/connection.py:766: UserWarning: Pika: Write buffer exceeded
</I>&gt;<i> warning threshold at 588 bytes and an estimated 15 frames behind
</I>&gt;<i>   warn(message % (self.outbound_buffer.size, est_frames_behind))
</I>&gt;<i>
</I>&gt;<i> etc etc
</I>&gt;<i>
</I>&gt;<i> On the other hand, everything works fine with pika twisted and the msgs do
</I>&gt;<i> end up on RabbitMQ with pika twisted, so it doesn't seem to be a
</I>&gt;<i> restriction to do with RabbitMQ per se.
</I>&gt;<i>
</I>&gt;<i> I've created gists &lt;<A HREF="https://gist.github.com/2815757">https://gist.github.com/2815757</A>&gt; for the pika native
</I>&gt;<i> code which doesn't work and the pika twisted code that does work.
</I>&gt;<i>
</I>&gt;<i> If anyone could help, I would greatly appreciate it.
</I>&gt;<i>
</I>&gt;<i> James
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120602/1f93f67a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120602/1f93f67a/attachment.htm</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020497.html">[rabbitmq-discuss] rabbitmqadmin error
</A></li>
	<LI>Next message: <A HREF="020433.html">[rabbitmq-discuss] Pika write buffer problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20432">[ date ]</a>
              <a href="thread.html#20432">[ thread ]</a>
              <a href="subject.html#20432">[ subject ]</a>
              <a href="author.html#20432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
