<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Balancing Queues across nodes in a cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Balancing%20Queues%20across%20nodes%20in%20a%20cluster&In-Reply-To=%3C5194D4F4.7060608%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027212.html">
   <LINK REL="Next"  HREF="027250.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Balancing Queues across nodes in a cluster</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Balancing%20Queues%20across%20nodes%20in%20a%20cluster&In-Reply-To=%3C5194D4F4.7060608%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Balancing Queues across nodes in a cluster">simon at rabbitmq.com
       </A><BR>
    <I>Thu May 16 13:45:40 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027212.html">[rabbitmq-discuss] Balancing Queues across nodes in a cluster
</A></li>
        <LI>Next message: <A HREF="027250.html">[rabbitmq-discuss] Balancing Queues across nodes in a cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27248">[ date ]</a>
              <a href="thread.html#27248">[ thread ]</a>
              <a href="subject.html#27248">[ subject ]</a>
              <a href="author.html#27248">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 15/05/13 20:02, Cordell, Ron L wrote:
&gt;<i> We are using RabbitMQ 3.0.1 in a cluster behind an F5 load balancer.
</I>
&lt;snip&gt;

&gt;<i> My question is around balancing node resources. If a queue becomes
</I>&gt;<i> somewhat busy, can I move make a different node master for that queue
</I>&gt;<i> (assuming a mirrored queue)? I don&#8217;t want to take down the node as I
</I>&gt;<i> have other queues on that node; I just want to move the master for a
</I>&gt;<i> particular queue, if possible.
</I>
Not with 3.0.x. This was fixed in 3.1.x.

If you want to control exactly which nodes a queue is on, you need the 
&quot;nodes&quot; policy.

With 3.0.x if you set a &quot;nodes&quot; policy such that a queue should change 
masters, it won't. Any old slaves will go down, and new slaves will come 
up, but the master won't change. This is to avoid losing messages if the 
new master wasn't synchronised (or even a slave) before the change.

With 3.1.x we are a bit smarter. Now if you set a &quot;nodes&quot; policy such 
that the master should change, it will do so immediately if one of the 
new mirrors was previously a synchronised slave. If not, the old master 
will stick around until one of the new mirrors becomes synchronised, 
then it will vanish.

See '&quot;nodes&quot; policy and migrating masters' under 
<A HREF="http://www.rabbitmq.com/ha.html#genesis">http://www.rabbitmq.com/ha.html#genesis</A>

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027212.html">[rabbitmq-discuss] Balancing Queues across nodes in a cluster
</A></li>
	<LI>Next message: <A HREF="027250.html">[rabbitmq-discuss] Balancing Queues across nodes in a cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27248">[ date ]</a>
              <a href="thread.html#27248">[ thread ]</a>
              <a href="subject.html#27248">[ subject ]</a>
              <a href="author.html#27248">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
