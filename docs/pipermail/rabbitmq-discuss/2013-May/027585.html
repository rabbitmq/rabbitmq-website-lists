<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-shovel%20issues%20%5Bfor%20hyperthunk%5D&In-Reply-To=%3C51A7BD71.50808%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027584.html">
   <LINK REL="Next"  HREF="027601.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-shovel%20issues%20%5Bfor%20hyperthunk%5D&In-Reply-To=%3C51A7BD71.50808%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]">matthias at rabbitmq.com
       </A><BR>
    <I>Thu May 30 21:58:25 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027584.html">[rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]
</A></li>
        <LI>Next message: <A HREF="027601.html">[rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27585">[ date ]</a>
              <a href="thread.html#27585">[ thread ]</a>
              <a href="subject.html#27585">[ subject ]</a>
              <a href="author.html#27585">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 30/05/13 21:35, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">john.hayden at nokia.com</A> wrote:
&gt;<i> I have 2 Rabbits running on 2 different ec2 instances in AWS
</I>&gt;<i> Rabbit1 has had a Shovel plugin installed in order to send messages to
</I>&gt;<i> Rabbit2
</I>&gt;<i> These Rabbits are being used for a Sensu monitoring network
</I>&gt;<i> The Sensu server is in the same region as Rabbit1
</I>&gt;<i> When a message is sent by Sensu to Rabbit1 it fansout to all connected
</I>&gt;<i> queues (maybe the wrong terminology here), including one called us-west-2
</I>&gt;<i> The Shovel is supposed to pick up messages from us-west-2 and forward it
</I>&gt;<i> to Rabbit2
</I>&gt;<i> Later on I will add other queues to forward to other Rabbits
</I>&gt;<i>
</I>&gt;<i> As I try this setup, I seem to timeout on a connection and I don't know why.
</I>&gt;<i>
</I>&gt;<i> Here is a gist of what is going on: <A HREF="https://gist.github.com/jhhayden/5679708">https://gist.github.com/jhhayden/5679708</A>
</I>
Have you checked the obvious, i.e. whether the Rabbit1 machine can 
connect to both endpoints? In particular, on Rabbit1 run

telnet 54.243.157.166 5672

and then type AMQPxx&lt;return&gt;

This should reply with 'AMQP&lt;somestuff&gt;' and close the connection.

Then try the same for the other connection, i.e. 'telnet 54.245.126.50 
5672'.

Also, it's worth checking the rabbit logs on both brokers for connection 
attempts and errors.


A few other points...

- you say that the shovel is running on rabbit1 and shovelling to 
rabbit2. That means it would be better to use a direct connection to 
rabbit1 instead of a network connection. From 
<A HREF="http://www.rabbitmq.com/shovel.html#configuration">http://www.rabbitmq.com/shovel.html#configuration</A> &quot;If the [URI] host is 
omitted [...] the shovel uses a direct connection to the broker in which 
it is running. This avoids using the network stack.&quot;. In addition to 
better performance, direct connections are not affected by network 
issues, which should make it easier to debug the problem you are seeing.

- there's no need to specify the port 5672 in the URI since that is the 
default

Regards,

Matthias.
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027584.html">[rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]
</A></li>
	<LI>Next message: <A HREF="027601.html">[rabbitmq-discuss] rabbitmq-shovel issues [for hyperthunk]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27585">[ date ]</a>
              <a href="thread.html#27585">[ thread ]</a>
              <a href="subject.html#27585">[ subject ]</a>
              <a href="author.html#27585">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
