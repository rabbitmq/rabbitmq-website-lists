<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [dotnet-client] Help mocking	IModel.BasicPublish
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Bdotnet-client%5D%20Help%20mocking%0A%09IModel.BasicPublish&In-Reply-To=%3C30396DB5-7391-4A0D-B30B-3BC09E743E56%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027476.html">
   <LINK REL="Next"  HREF="027478.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [dotnet-client] Help mocking	IModel.BasicPublish</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Bdotnet-client%5D%20Help%20mocking%0A%09IModel.BasicPublish&In-Reply-To=%3C30396DB5-7391-4A0D-B30B-3BC09E743E56%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] [dotnet-client] Help mocking	IModel.BasicPublish">tim at rabbitmq.com
       </A><BR>
    <I>Tue May 28 15:22:07 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027476.html">[rabbitmq-discuss] [dotnet-client] Help mocking IModel.BasicPublish
</A></li>
        <LI>Next message: <A HREF="027478.html">[rabbitmq-discuss] PHP STOMP extension/lib that works well with	RabbitMQ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27510">[ date ]</a>
              <a href="thread.html#27510">[ thread ]</a>
              <a href="subject.html#27510">[ subject ]</a>
              <a href="author.html#27510">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mark,

On 24 May 2013, at 17:02, Mark Snelling wrote:

&gt;<i> I've managed to successfully implement reading from a mocked call to IModel.BasicConsume() and acknowledging with IModel.BasicAck() but am stuck on IModel.BasicPublish(), in particular mocking the ack/nack mechanism with IModel as I need to test my component in both those scenarios.
</I>&gt;<i> 
</I>&gt;<i> How does the ack/nack mechanism work with IModel.WaitForConfirms() and how would I go about sending an ack/nack when the publisher calls IModel.BasicPublish()?
</I>&gt;<i> 
</I>
It really depends on how you've mocked the model reference, but essentially the broker will send either ACK for one (or more, if batching) or NACK for the published messages, depending on whether or not it was willing and able to take responsibility for them. Presumably in your test cases you want to handle the situation where #WaitForConfirms() fails, in which case you should either return false (where you wish to simulate the broker issuing a NACK) or return true but also set the out parameter 'timedOut' to true to indicate that a timeout occurred.

Hope that makes sense.

Cheers,
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130528/995f5a11/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130528/995f5a11/attachment.htm</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027476.html">[rabbitmq-discuss] [dotnet-client] Help mocking IModel.BasicPublish
</A></li>
	<LI>Next message: <A HREF="027478.html">[rabbitmq-discuss] PHP STOMP extension/lib that works well with	RabbitMQ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27510">[ date ]</a>
              <a href="thread.html#27510">[ thread ]</a>
              <a href="subject.html#27510">[ subject ]</a>
              <a href="author.html#27510">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
