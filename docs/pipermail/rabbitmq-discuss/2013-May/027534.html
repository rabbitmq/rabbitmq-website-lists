<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Trace Plugin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Trace%20Plugin&In-Reply-To=%3C06536F18C0038E489237EEE3CA9BF2D01403FDB1%40FRGR1D2MX07.services.firstrand.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027521.html">
   <LINK REL="Next"  HREF="027535.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Trace Plugin</H1>
    <B>Jeffery, Mark</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Trace%20Plugin&In-Reply-To=%3C06536F18C0038E489237EEE3CA9BF2D01403FDB1%40FRGR1D2MX07.services.firstrand.net%3E"
       TITLE="[rabbitmq-discuss] Trace Plugin">MJeffery at fnb.co.za
       </A><BR>
    <I>Wed May 29 13:36:21 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027521.html">[rabbitmq-discuss] Trace Plugin
</A></li>
        <LI>Next message: <A HREF="027535.html">[rabbitmq-discuss] Trace Plugin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27534">[ date ]</a>
              <a href="thread.html#27534">[ thread ]</a>
              <a href="subject.html#27534">[ subject ]</a>
              <a href="author.html#27534">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Apologies for bumping earlier: I didn't see the mail.

I think this is cluster related (I didn't mention the cluster earlier, sorry)

It seems that the fire-hose tracing only seems to allow tracing on the first node that is started in the cluster.
ie The consumer needs to connect to the node that was started first.
If I connect the consumer to a node that wasn't started first, messages aren't routed to the declared queue.

Is this the case ?

I am able to run trace_on and trace_off and see the messages start and stop at the consumer with no problems. (With out re-creating the channel).

Thanks

Jeff

-----Original Message-----
From: Matthias Radestock [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>] 
Sent: Wednesday, May 29, 2013 10:26 AM
To: Jeffery, Mark
Cc: Discussions about RabbitMQ
Subject: Re: [rabbitmq-discuss] Trace Plugin

Jeff,

On 28/05/13 13:52, Jeffery, Mark wrote:
&gt;<i> I have the following scenario that led to my question
</I>&gt;<i>
</I>&gt;<i> On 3.0.1 if I (via Java, not management console)
</I>&gt;<i>
</I>&gt;<i> Have the rabbitmq_tracing plugin enabled Declare a queue 
</I>&gt;<i> &quot;tracepublish&quot;
</I>&gt;<i> Bind it to exchange amq.rabbitmq.trace with routing key publish.# 
</I>&gt;<i> Start a Consumer on &quot;tracepublish&quot;
</I>&gt;<i> Execute rabbitmqctl trace_on
</I>&gt;<i>
</I>&gt;<i> I receive all the messages published perfectly.
</I>&gt;<i>
</I>&gt;<i> However if I
</I>&gt;<i> Disable the rabbitmq_tracing plugin.
</I>&gt;<i> Declare a queue &quot;tracepublish&quot;
</I>&gt;<i> Bind it to exchange amq.rabbitmq.trace with routing key publish.# 
</I>&gt;<i> Start a Consumer on &quot;tracepublish&quot;
</I>&gt;<i> Execute rabbitmqctl trace_on
</I>&gt;<i>
</I>&gt;<i> I get no messages on the consumer side. Almost as though the firehose 
</I>&gt;<i> tracing was disabled when the plugin was disabled
</I>
I can see nothing in the code that would cause that to happen. Check the logs for &quot;{Enabling,Disabling} tracing for vhost ...&quot; messages. Any change in the tracing should be accompanied by these.

Note that the tracing state is checked on channel creation only, so enabling/disabling tracing after a channel has been created has no effect on the tracing of messages published/consumed on that channel. I wonder whether that could explain the difference in behaviour you were seeing.

Regards,

Matthias.
To read FirstRand Bank's Disclaimer for this email click on the following address or copy into your Internet browser: 
<A HREF="https://www.fnb.co.za/disclaimer.html">https://www.fnb.co.za/disclaimer.html</A> 

If you are unable to access the Disclaimer, send a blank e-mail to
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">firstrandbankdisclaimer at fnb.co.za</A> and we will send you a copy of the Disclaimer.
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027521.html">[rabbitmq-discuss] Trace Plugin
</A></li>
	<LI>Next message: <A HREF="027535.html">[rabbitmq-discuss] Trace Plugin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27534">[ date ]</a>
              <a href="thread.html#27534">[ thread ]</a>
              <a href="subject.html#27534">[ subject ]</a>
              <a href="author.html#27534">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
