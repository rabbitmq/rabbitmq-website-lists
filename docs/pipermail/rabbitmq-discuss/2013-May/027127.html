<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Resource alarms in 3.1 seems to block	operations other than basic.publish
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Resource%20alarms%20in%203.1%20seems%20to%20block%0A%09operations%20other%20than%20basic.publish&In-Reply-To=%3C88799E5B-A7C6-4526-9F39-779A3D896315%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027125.html">
   <LINK REL="Next"  HREF="027122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Resource alarms in 3.1 seems to block	operations other than basic.publish</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Resource%20alarms%20in%203.1%20seems%20to%20block%0A%09operations%20other%20than%20basic.publish&In-Reply-To=%3C88799E5B-A7C6-4526-9F39-779A3D896315%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Resource alarms in 3.1 seems to block	operations other than basic.publish">watson.timothy at gmail.com
       </A><BR>
    <I>Mon May 13 20:26:02 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027125.html">[rabbitmq-discuss] Resource alarms in 3.1 seems to block operations other than basic.publish
</A></li>
        <LI>Next message: <A HREF="027122.html">[rabbitmq-discuss] Resource alarms in 3.1 seems to block operations other than basic.publish
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27127">[ date ]</a>
              <a href="thread.html#27127">[ thread ]</a>
              <a href="subject.html#27127">[ subject ]</a>
              <a href="author.html#27127">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13 May 2013, at 19:13, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.s.klishin at gmail.com</A>&gt; wrote:

&gt;<i> 
</I>&gt;<i> 2013/5/13 Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">watson.timothy at gmail.com</A>&gt;
</I>&gt;<i> Hmm. How long did that take? I can kick off a run overnight an let it stew I suppose. How much memory has your machine got?
</I>&gt;<i> 
</I>&gt;<i> 4 GB. It's not a powerful machine, although it does have an SSD which should offset the effect of paging somewhat.
</I>
Yeah, but I'm kinda with Matthias on this one. If the whole machine is grinding, it sounds a lot like you've exhausted the available resources and under those circumstances a whole bunch of things are going to crawl.

&gt;<i>  
</I>&gt;<i> 
</I>&gt;&gt;<i> Purging the queue helps with new connections but messages are still not delivered to the consumer when I restart
</I>&gt;&gt;<i> the producer.
</I>&gt;<i> 
</I>&gt;<i> I didn't pick that up from the original post. Is this happening after the alarm has been unset?
</I>&gt;<i> As far as I can tell, yes.
</I>
That's the key thing here. If the alarm isn't unset, the producer won't be able to proceed. It sounds a lot like (a) the whole os is jammed due to resource exhaustion and (b) the alarm could still be set.

If that weren't the case, I'd expect to be able to reproduce it with a much lower threshold and even if I'm wrong, it doesn't doesn't replicate for me (in terms of the queue being non-empty) even on a single host.

Cheers,
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130513/d41f4848/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130513/d41f4848/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027125.html">[rabbitmq-discuss] Resource alarms in 3.1 seems to block operations other than basic.publish
</A></li>
	<LI>Next message: <A HREF="027122.html">[rabbitmq-discuss] Resource alarms in 3.1 seems to block operations other than basic.publish
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27127">[ date ]</a>
              <a href="thread.html#27127">[ thread ]</a>
              <a href="subject.html#27127">[ subject ]</a>
              <a href="author.html#27127">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
