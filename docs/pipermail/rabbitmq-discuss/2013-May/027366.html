<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] consumer get messages from one queue	sometimes disorder
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20consumer%20get%20messages%20from%20one%20queue%0A%09sometimes%20disorder&In-Reply-To=%3CCAAjbVJDEXopt-dqNrpvEazcsxPwVW8jnHd2fv5wJoZ9-hAgueA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026970.html">
   <LINK REL="Next"  HREF="026929.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] consumer get messages from one queue	sometimes disorder</H1>
    <B>Xie Yunpeng</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20consumer%20get%20messages%20from%20one%20queue%0A%09sometimes%20disorder&In-Reply-To=%3CCAAjbVJDEXopt-dqNrpvEazcsxPwVW8jnHd2fv5wJoZ9-hAgueA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] consumer get messages from one queue	sometimes disorder">woqimingweipeng at gmail.com
       </A><BR>
    <I>Tue May 21 03:44:39 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026970.html">[rabbitmq-discuss] consumer get messages from one queue	sometimes disorder
</A></li>
        <LI>Next message: <A HREF="026929.html">[rabbitmq-discuss] [rabbitmq_discuss]more time to publish
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27366">[ date ]</a>
              <a href="thread.html#27366">[ thread ]</a>
              <a href="subject.html#27366">[ subject ]</a>
              <a href="author.html#27366">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>the second reason is right.it mybe a bug in kombu/amqp. in kombu it get
many message from rabbitmq in SimpleQueue.get method without ack and push
the messages into a collections.deque, but sometimes my server has poor
network and the client/server disconnected(or mybe a but in amqp lead to
the disconnection), then the kombu create a new connection/channel, the
messages in noack cannnot be received for a while and then goto ready .this
reason makes the messages disorder.


2013/5/7 Xie Yunpeng &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">woqimingweipeng at gmail.com</A>&gt;

&gt;<i> thx, i will do some test and analyse log to verify the second condition.i
</I>&gt;<i> think it is the real reason.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2013/5/7 Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
</I>&gt;<i>
</I>&gt;&gt;<i> On 07/05/2013 09:26, Emile Joubert wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 06/05/13 11:08, Xie Yunpeng wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  I use 4 publisher sending messages to this queue and 1 consumer to
</I>&gt;&gt;&gt;&gt;<i> receive the messages.the consumer when connect to the rabbitmq server ,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  i find it receive messages disorder sometimes, just like: first receive
</I>&gt;&gt;&gt;&gt;<i> messges in current time and then receive messages several hour ago, the
</I>&gt;&gt;&gt;&gt;<i> interval is not regular.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> You can find the ordering guarantees here:
</I>&gt;&gt;&gt;<i> <A HREF="http://www.rabbitmq.com/**semantics.html#ordering&lt;http://www.rabbitmq.com/semantics.html#ordering">http://www.rabbitmq.com/**semantics.html#ordering&lt;http://www.rabbitmq.com/semantics.html#ordering</A>&gt;
</I>&gt;&gt;&gt;<i> In particular, there is no ordering guarantee if you involve multiple
</I>&gt;&gt;&gt;<i> publishers.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Well, there's still exactly the same ordering guarantee as there is with
</I>&gt;&gt;<i> a single publisher: messages from each publishing channel won't get
</I>&gt;&gt;<i> reordered with respect to each other. We just don't guarantee anything
</I>&gt;&gt;<i> about ordering between channels. And indeed it's hard to see how we could.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To the OP: either something weird is happening in your publishers causing
</I>&gt;&gt;<i> them to buffer messages for hours before sending to RabbitMQ (unlikely I
</I>&gt;&gt;<i> guess but I should mention it) or messages are not being acknowledged by
</I>&gt;&gt;<i> your consumers and are then being requeued once the consumer disconnects.
</I>&gt;&gt;<i> In the latter case all the &quot;late&quot; messages should have the &quot;redelivered&quot;
</I>&gt;&gt;<i> flag set.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers, Simon
</I>&gt;&gt;<i> ______________________________**_________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.</A>**rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130521/fa174b12/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130521/fa174b12/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026970.html">[rabbitmq-discuss] consumer get messages from one queue	sometimes disorder
</A></li>
	<LI>Next message: <A HREF="026929.html">[rabbitmq-discuss] [rabbitmq_discuss]more time to publish
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27366">[ date ]</a>
              <a href="thread.html#27366">[ thread ]</a>
              <a href="subject.html#27366">[ subject ]</a>
              <a href="author.html#27366">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
