<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Strange%20subtract_acks%20crash%20in%20RabbitMQ%0A%203.1.0-1%20%28case_clause%20empty%29%20on%20EC2&In-Reply-To=%3CCALPqkipk5DFLH5XwfR8fW%3DfTVd4tJWsC8XwC%2BqXctgaxW7vHCQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027297.html">
   <LINK REL="Next"  HREF="027300.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2</H1>
    <B>Brett Cameron</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Strange%20subtract_acks%20crash%20in%20RabbitMQ%0A%203.1.0-1%20%28case_clause%20empty%29%20on%20EC2&In-Reply-To=%3CCALPqkipk5DFLH5XwfR8fW%3DfTVd4tJWsC8XwC%2BqXctgaxW7vHCQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2">brett.r.cameron at gmail.com
       </A><BR>
    <I>Sat May 18 04:48:10 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027297.html">[rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2
</A></li>
        <LI>Next message: <A HREF="027300.html">[rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27298">[ date ]</a>
              <a href="thread.html#27298">[ thread ]</a>
              <a href="subject.html#27298">[ subject ]</a>
              <a href="author.html#27298">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Karl,

Wild speculation would be that messages have been consumed from a queue but
that queue (name = document_queue?) is for some reason missing in action
(gone, inaccessible, ...) when the consumer subsequently tries to ack the
message(s).

Brett



On Sat, May 18, 2013 at 3:20 PM, Karl Rieb &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">karl.rieb at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am running a RabbitMQ cluster of 4 nodes in AWS EC2 on *c1.xlarge *instances
</I>&gt;<i> using Ubuntu 12.04 LTS (kernel 3.2.0-38).  Periodically two of my nodes
</I>&gt;<i> holding the largest queues will crash and require me to restart the
</I>&gt;<i> rabbitmq-server service.  Looking at the logs, I'm at a loss as to why the
</I>&gt;<i> crash is occurring.  I've have tried reproducing the crash manually by
</I>&gt;<i> flooding my nodes with messages, but that doesn't seem to trigger the
</I>&gt;<i> issue.  Below is output from various RabbitMQ logs:
</I>&gt;<i>
</I>&gt;<i> # cat /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-123-123-123-sasl.log</A>
</I>&gt;&gt;<i> =CRASH REPORT==== 18-May-2013::01:41:51 ===
</I>&gt;&gt;<i>   crasher:
</I>&gt;&gt;<i>     initial call: gen:init_it/6
</I>&gt;&gt;<i>     pid: &lt;0.301.0&gt;
</I>&gt;&gt;<i>     registered_name: []
</I>&gt;&gt;<i>     exception exit: {{case_clause,{empty,{[],[]}}},
</I>&gt;&gt;<i>                      [{rabbit_amqqueue_process,subtract_acks,3,[]},
</I>&gt;&gt;<i>                       {rabbit_amqqueue_process,subtract_acks,4,[]},
</I>&gt;&gt;<i>                       {rabbit_amqqueue_process,handle_cast,2,[]},
</I>&gt;&gt;<i>                       {gen_server2,handle_msg,2,[]},
</I>&gt;&gt;<i>                       {proc_lib,wake_up,3,
</I>&gt;&gt;<i>                                 [{file,&quot;proc_lib.erl&quot;},{line,249}]}]}
</I>&gt;&gt;<i>       in function  gen_server2:terminate/3
</I>&gt;&gt;<i>     ancestors: [rabbit_amqqueue_sup,rabbit_sup,&lt;0.207.0&gt;]
</I>&gt;&gt;<i>     messages: [{'$gen_cast',{resume,&lt;0.676.0&gt;}},
</I>&gt;&gt;<i>                   {'$gen_cast',{ack,[27583,27606,27629,27652,27675,27698,
</I>&gt;&gt;<i>                                      27721,27744,27767,27790,27813,27836,
</I>&gt;&gt;<i>                                      27859,27882,27905,27928,27951,27974,
</I>&gt;&gt;<i>                                      27997,28020,28043,28066,28089,28112,
</I>&gt;&gt;<i>                                      28135,28158,28179,28200,28221,28242,
</I>&gt;&gt;<i>                                      28263,28284,28305,28324,28342,28360,
</I>&gt;&gt;<i>                                      28378,28396,28414,28432,28450,28468,
</I>&gt;&gt;<i>                                      28486,28504,28522,28540,28558,28576,
</I>&gt;&gt;<i>                                      28594,28612],
</I>&gt;&gt;<i>                                     &lt;0.737.0&gt;}},
</I>&gt;&gt;<i>                   {'$gen_cast',{resume,&lt;0.737.0&gt;}},
</I>&gt;&gt;<i>                   {'$gen_cast',{ack,[27608,27631,27654,27677,27700,27723,
</I>&gt;&gt;<i>                                      27746,27769,27792,27815,27838,27861,
</I>&gt;&gt;<i>                                      27884,27907,27930,27953,27976,27999,
</I>&gt;&gt;<i>                                      28022,28045,28068,28091,28114,28137,
</I>&gt;&gt;<i>                                      28160,28181,28202,28223,28244,28265,
</I>&gt;&gt;<i>                                      28286,28307,28326,28344,28362,28380,
</I>&gt;&gt;<i>                                      28398,28416,28434,28452,28470,28488,
</I>&gt;&gt;<i>                                      28506,28524,28542,28560,28578,28596,
</I>&gt;&gt;<i>                                      28614],
</I>&gt;&gt;<i>                                     &lt;0.676.0&gt;}},
</I>&gt;&gt;<i>                   {'$gen_cast',{ack,[27578,27601,27624,27647,27670,27693,
</I>&gt;&gt;<i>                                      27716,27739,27762,27785,27808,27831,
</I>&gt;&gt;<i>                                      27854,27877,27900,27923,27946,27969,
</I>&gt;&gt;<i>                                      27992,28015,28038,28061,28084,28107,
</I>&gt;&gt;<i>                                      28130,28153,28174,28195,28216,28237,
</I>&gt;&gt;<i>                                      28258,28279,28300,28321,28340,28358,
</I>&gt;&gt;<i>                                      28376,28394,28412,28430,28448,28466,
</I>&gt;&gt;<i>                                      28484,28502,28520,28538,28556,28574,
</I>&gt;&gt;<i>                                      28592,28610],
</I>&gt;&gt;<i>                                     &lt;0.716.0&gt;}},
</I>&gt;&gt;<i>                   {'$gen_cast',{resume,&lt;0.716.0&gt;}},
</I>&gt;&gt;<i>                   {'$gen_cast',{ack,[27582,27605,27628,27651,27674,27697,
</I>&gt;&gt;<i>                                      27720,27743,27766,27789,27812,27835,
</I>&gt;&gt;<i>                                      27858,27881,27904,27927,27950,27973,
</I>&gt;&gt;<i>                                      27996,28019,28042,28065,28088,28111,
</I>&gt;&gt;<i>                                      28134,28157,28178,28199,28220,28241,
</I>&gt;&gt;<i>                                      28262,28283,28304,28323,28341,28359,
</I>&gt;&gt;<i>                                      28377,28395,28413,28431,28449,28467,
</I>&gt;&gt;<i>                                      28485,28503,28521,28539,28557,28575,
</I>&gt;&gt;<i>                                      28593,28611],
</I>&gt;&gt;<i>                                     &lt;0.737.0&gt;}}]
</I>&gt;&gt;<i>     links: [&lt;0.300.0&gt;]
</I>&gt;&gt;<i>     dictionary: [{{ch,&lt;0.729.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.729.0&gt;,#Ref&lt;0.0.0.12296&gt;,
</I>&gt;&gt;<i>                        {[28715,28696,28677,28658,28639,28620,28602,28584,
</I>&gt;&gt;<i>                          28566,28548,28530,28512,28494,28476,28458,28440,
</I>&gt;&gt;<i>                          28422,28404,28386,28368,28350,28332,28313,28292,
</I>&gt;&gt;<i>                          28271,28250,28229,28208,28187,28166,28143,28120,
</I>&gt;&gt;<i>                          28097,28074,28051,28028,28005,27982,27959,27936,
</I>&gt;&gt;<i>                          27913,27890,27867,27844,27821,27798,27775,27752,
</I>&gt;&gt;<i>                          27729,27706,27683,27660,27637,27614],
</I>&gt;&gt;<i>                         [27591]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.728.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        11}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.877.0&gt;},22},
</I>&gt;&gt;<i>                   {{ch,&lt;0.608.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.608.0&gt;,#Ref&lt;0.0.0.9041&gt;,
</I>&gt;&gt;<i>                        {[28708,28689,28670,28651,28632,28607,28589,28571,
</I>&gt;&gt;<i>                          28553,28535,28517,28499,28481,28463,28445,28427,
</I>&gt;&gt;<i>                          28409,28391,28373,28355,28337,28318,28297,28276,
</I>&gt;&gt;<i>                          28255,28234,28213,28192,28171,28150,28127,28104,
</I>&gt;&gt;<i>                          28081,28058,28035,28012,27989,27966,27943,27920,
</I>&gt;&gt;<i>                          27897,27874,27851,27828,27805,27782,27759,27736,
</I>&gt;&gt;<i>                          27713,27690,27667,27644,27621,27598],
</I>&gt;&gt;<i>                         [27575]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.607.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        38}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.624.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.624.0&gt;,#Ref&lt;0.0.0.9436&gt;,
</I>&gt;&gt;<i>                        {[28722,28703,28684,28665,28646],[28627]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.623.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        36}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.696.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.696.0&gt;,#Ref&lt;0.0.0.11414&gt;,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        2,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.695.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        24}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.564.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.564.0&gt;,#Ref&lt;0.0.0.7285&gt;,
</I>&gt;&gt;<i>                        {[28718,28699,28680,28661,28642],[28623]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.563.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        12}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.644.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.644.0&gt;,#Ref&lt;0.0.0.10071&gt;,
</I>&gt;&gt;<i>                        {[28713,28694,28675,28656,28637,28618,28600,28582,
</I>&gt;&gt;<i>                          28564,28546,28528,28510,28492,28474,28456,28438,
</I>&gt;&gt;<i>                          28420,28402,28384,28366,28348,28330,28311,28290,
</I>&gt;&gt;<i>                          28269,28248,28227,28206,28185,28164,28141,28118,
</I>&gt;&gt;<i>                          28095,28072,28049,28026,28003,27980,27957,27934,
</I>&gt;&gt;<i>                          27911,27888,27865,27842,27819,27796,27773,27750,
</I>&gt;&gt;<i>                          27727,27704,27681,27658,27635,27612],
</I>&gt;&gt;<i>                         [27589]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.643.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        11}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.676.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.676.0&gt;,#Ref&lt;0.0.0.11309&gt;,
</I>&gt;&gt;<i>                        {[28614,28613,28596,28595,28578,28577,28560,28559,
</I>&gt;&gt;<i>                          28542,28541,28524,28523,28506,28505,28488,28487,
</I>&gt;&gt;<i>                          28470,28469,28452,28451,28434,28433,28416,28415,
</I>&gt;&gt;<i>                          28398,28397,28380,28379,28362,28361,28344,28343,
</I>&gt;&gt;<i>                          28326,28325,28307,28306,28286,28285,28265,28264,
</I>&gt;&gt;<i>                          28244,28243,28223,28222,28202,28201,28181,28180,
</I>&gt;&gt;<i>                          28160,28159,28137,28136,28114,28113,28091,28090,
</I>&gt;&gt;<i>                          28068,28067,28045,28044,28022,28021,27999,27998,
</I>&gt;&gt;<i>                          27976,27975,27953,27952,27930,27929,27907,27906,
</I>&gt;&gt;<i>                          27884,27883,27861,27860,27838,27837,27815,27814,
</I>&gt;&gt;<i>                          27792,27791,27769,27768,27746,27745,27723,27722,
</I>&gt;&gt;<i>                          27700,27699,27677,27676,27654,27653,27631,27630,
</I>&gt;&gt;<i>                          27608,27607,27585],
</I>&gt;&gt;<i>                         [27584]},
</I>&gt;&gt;<i>                        2,
</I>&gt;&gt;<i>                        {[{&lt;0.676.0&gt;,
</I>&gt;&gt;<i>                           {consumer,&lt;&lt;&quot;amq.ctag-0cvDGmyaAbEW_j15AfhGHQ&quot;&gt;&gt;,
</I>&gt;&gt;<i>                                     true}}],
</I>&gt;&gt;<i>                         [{&lt;0.676.0&gt;,
</I>&gt;&gt;<i>                           {consumer,&lt;&lt;&quot;amq.ctag-YqU04SIfQv6P-QVueEjbRg&quot;&gt;&gt;,
</I>&gt;&gt;<i>                                     true}}]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.675.0&gt;,suspended,{0,nil}},
</I>&gt;&gt;<i>                        25}},
</I>&gt;&gt;<i>                   {{xtype_to_module,direct},rabbit_exchange_type_direct},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.833.0&gt;},31},
</I>&gt;&gt;<i>                   {{ch,&lt;0.745.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.745.0&gt;,#Ref&lt;0.0.0.12674&gt;,
</I>&gt;&gt;<i>                        {[28716,28697,28678,28659,28640,28621,28603,28585,
</I>&gt;&gt;<i>                          28567,28549,28531,28513,28495,28477,28459,28441,
</I>&gt;&gt;<i>                          28423,28405,28387,28369,28351,28333,28314,28293,
</I>&gt;&gt;<i>                          28272,28251,28230,28209,28188,28167,28144,28121,
</I>&gt;&gt;<i>                          28098,28075,28052,28029,28006,27983,27960,27937,
</I>&gt;&gt;<i>                          27914,27891,27868,27845,27822,27799,27776,27753,
</I>&gt;&gt;<i>                          27730,27707,27684,27661,27638,27615],
</I>&gt;&gt;<i>                         [27592]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.744.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        37}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.660.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.660.0&gt;,#Ref&lt;0.0.0.10650&gt;,
</I>&gt;&gt;<i>                        {[28712,28693,28674,28655,28636,28617,28599,28581,
</I>&gt;&gt;<i>                          28563,28545,28527,28509,28491,28473,28455,28437,
</I>&gt;&gt;<i>                          28419,28401,28383,28365,28347,28329,28310,28289,
</I>&gt;&gt;<i>                          28268,28247,28226,28205,28184,28163,28140,28117,
</I>&gt;&gt;<i>                          28094,28071,28048,28025,28002,27979,27956,27933,
</I>&gt;&gt;<i>                          27910,27887,27864,27841,27818,27795,27772,27749,
</I>&gt;&gt;<i>                          27726,27703,27680,27657,27634,27611],
</I>&gt;&gt;<i>                         [27588]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.659.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        11}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.837.0&gt;},32},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.881.0&gt;},17},
</I>&gt;&gt;<i>                   {{ch,&lt;0.737.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.737.0&gt;,#Ref&lt;0.0.0.12429&gt;,
</I>&gt;&gt;<i>                        {[28612,28611,28594,28593,28576,28575,28558,28557,
</I>&gt;&gt;<i>                          28540,28539,28522,28521,28504,28503,28486,28485,
</I>&gt;&gt;<i>                          28468,28467,28450,28449,28432,28431,28414,28413,
</I>&gt;&gt;<i>                          28396,28395,28378,28377,28360,28359,28342,28341,
</I>&gt;&gt;<i>                          28324,28323,28305,28304,28284,28283,28263,28262,
</I>&gt;&gt;<i>                          28242,28241,28221,28220,28200,28199,28179,28178,
</I>&gt;&gt;<i>                          28158,28157,28135,28134,28112,28111,28089,28088,
</I>&gt;&gt;<i>                          28066,28065,28043,28042,28020,28019,27997,27996,
</I>&gt;&gt;<i>                          27974,27973,27951,27950,27928,27927,27905,27904,
</I>&gt;&gt;<i>                          27882,27881,27859,27858,27836,27835,27813,27812,
</I>&gt;&gt;<i>                          27790,27789,27767,27766,27744,27743,27721,27720,
</I>&gt;&gt;<i>                          27698,27697,27675,27674,27652,27651,27629,27628,
</I>&gt;&gt;<i>                          27606,27605,27583],
</I>&gt;&gt;<i>                         [27582]},
</I>&gt;&gt;<i>                        2,
</I>&gt;&gt;<i>                        {[{&lt;0.737.0&gt;,
</I>&gt;&gt;<i>                           {consumer,&lt;&lt;&quot;amq.ctag-ITZqhulzHhUzx1uy1Eot3g&quot;&gt;&gt;,
</I>&gt;&gt;<i>                                     true}}],
</I>&gt;&gt;<i>                         [{&lt;0.737.0&gt;,
</I>&gt;&gt;<i>                           {consumer,&lt;&lt;&quot;amq.ctag-hpo5ejdoJRdLrT6JS42jGw&quot;&gt;&gt;,
</I>&gt;&gt;<i>                                     true}}]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.736.0&gt;,suspended,{0,nil}},
</I>&gt;&gt;<i>                        11}},
</I>&gt;&gt;<i>                   {credit_blocked,[]},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.854.0&gt;},3},
</I>&gt;&gt;<i>                   {{ch,&lt;0.716.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.716.0&gt;,#Ref&lt;0.0.0.11820&gt;,
</I>&gt;&gt;<i>                        {[28610,28609,28592,28591,28574,28573,28556,28555,
</I>&gt;&gt;<i>                          28538,28537,28520,28519,28502,28501,28484,28483,
</I>&gt;&gt;<i>                          28466,28465,28448,28447,28430,28429,28412,28411,
</I>&gt;&gt;<i>                          28394,28393,28376,28375,28358,28357,28340,28339,
</I>&gt;&gt;<i>                          28321,28320,28300,28299,28279,28278,28258,28257,
</I>&gt;&gt;<i>                          28237,28236,28216,28215,28195,28194,28174,28173,
</I>&gt;&gt;<i>                          28153,28152,28130,28129,28107,28106,28084,28083,
</I>&gt;&gt;<i>                          28061,28060,28038,28037,28015,28014,27992,27991,
</I>&gt;&gt;<i>                          27969,27968,27946,27945,27923,27922,27900,27899,
</I>&gt;&gt;<i>                          27877,27876,27854,27853,27831,27830,27808,27807,
</I>&gt;&gt;<i>                          27785,27784,27762,27761,27739,27738,27716,27715,
</I>&gt;&gt;<i>                          27693,27692,27670,27669,27647,27646,27624,27623,
</I>&gt;&gt;<i>                          27601,27600,27578],
</I>&gt;&gt;<i>                         [27577]},
</I>&gt;&gt;<i>                        2,
</I>&gt;&gt;<i>                        {[{&lt;0.716.0&gt;,
</I>&gt;&gt;<i>                           {consumer,&lt;&lt;&quot;amq.ctag-BTlS-GmbXNpcU-wUlMI60Q&quot;&gt;&gt;,
</I>&gt;&gt;<i>                                     true}}],
</I>&gt;&gt;<i>                         [{&lt;0.716.0&gt;,
</I>&gt;&gt;<i>                           {consumer,&lt;&lt;&quot;amq.ctag-loc5monF8M1pz_Bb8ypumw&quot;&gt;&gt;,
</I>&gt;&gt;<i>                                     true}}]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.715.0&gt;,suspended,{0,nil}},
</I>&gt;&gt;<i>                        44}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.782.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.782.0&gt;,#Ref&lt;0.0.0.15649&gt;,
</I>&gt;&gt;<i>                        {[28714,28695,28676,28657,28638,28619,28601,28583,
</I>&gt;&gt;<i>                          28565,28547,28529,28511,28493,28475,28457,28439,
</I>&gt;&gt;<i>                          28421,28403,28385,28367,28349,28331,28312,28291,
</I>&gt;&gt;<i>                          28270,28249,28228,28207,28186,28165,28142,28119,
</I>&gt;&gt;<i>                          28096,28073,28050,28027,28004,27981,27958,27935,
</I>&gt;&gt;<i>                          27912,27889,27866,27843,27820,27797,27774,27751,
</I>&gt;&gt;<i>                          27728,27705,27682,27659,27636,27613],
</I>&gt;&gt;<i>                         [27590]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.781.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        35}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.846.0&gt;},22},
</I>&gt;&gt;<i>                   {{ch,&lt;0.684.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.684.0&gt;,#Ref&lt;0.0.0.11198&gt;,
</I>&gt;&gt;<i>                        {[28711,28692,28673,28654,28635,28616,28598,28580,
</I>&gt;&gt;<i>                          28562,28544,28526,28508,28490,28472,28454,28436,
</I>&gt;&gt;<i>                          28418,28400,28382,28364,28346,28328,28309,28288,
</I>&gt;&gt;<i>                          28267,28246,28225,28204,28183,28162,28139,28116,
</I>&gt;&gt;<i>                          28093,28070,28047,28024,28001,27978,27955,27932,
</I>&gt;&gt;<i>                          27909,27886,27863,27840,27817,27794,27771,27748,
</I>&gt;&gt;<i>                          27725,27702,27679,27656,27633,27610],
</I>&gt;&gt;<i>                         [27587]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.683.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        11}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.692.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.692.0&gt;,#Ref&lt;0.0.0.11088&gt;,
</I>&gt;&gt;<i>                        {[28710,28691,28672,28653,28634,28615,28597,28579,
</I>&gt;&gt;<i>                          28561,28543,28525,28507,28489,28471,28453,28435,
</I>&gt;&gt;<i>                          28417,28399,28381,28363,28345,28327,28308,28287,
</I>&gt;&gt;<i>                          28266,28245,28224,28203,28182,28161,28138,28115,
</I>&gt;&gt;<i>                          28092,28069,28046,28023,28000,27977,27954,27931,
</I>&gt;&gt;<i>                          27908,27885,27862,27839,27816,27793,27770,27747,
</I>&gt;&gt;<i>                          27724,27701,27678,27655,27632,27609],
</I>&gt;&gt;<i>                         [27586]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.691.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        12}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.648.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.648.0&gt;,#Ref&lt;0.0.0.10283&gt;,
</I>&gt;&gt;<i>                        {[28717,28698,28679,28660,28641],[28622]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.647.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        12}},
</I>&gt;&gt;<i>                   {guid,{{2296174761
</I>&gt;&gt;<i> ,591959305,1562876388,1822892473},1}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.720.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.720.0&gt;,#Ref&lt;0.0.0.12036&gt;,
</I>&gt;&gt;<i>                        {[28723,28704,28685,28666,28647],[28628]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.719.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        37}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.869.0&gt;},39},
</I>&gt;&gt;<i>                   {{ch,&lt;0.636.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.636.0&gt;,#Ref&lt;0.0.0.9960&gt;,
</I>&gt;&gt;<i>                        {[28705,28686,28667,28648,28629,28604,28586,28568,
</I>&gt;&gt;<i>                          28550,28532,28514,28496,28478,28460,28442,28424,
</I>&gt;&gt;<i>                          28406,28388,28370,28352,28334,28315,28294,28273,
</I>&gt;&gt;<i>                          28252,28231,28210,28189,28168,28147,28124,28101,
</I>&gt;&gt;<i>                          28078,28055,28032,28009,27986,27963,27940,27917,
</I>&gt;&gt;<i>                          27894,27871,27848,27825,27802,27779,27756,27733,
</I>&gt;&gt;<i>                          27710,27687,27664,27641,27618,27595],
</I>&gt;&gt;<i>                         [27572]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.635.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        15}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.850.0&gt;},50},
</I>&gt;&gt;<i>                   {{ch,&lt;0.616.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.616.0&gt;,#Ref&lt;0.0.0.9300&gt;,
</I>&gt;&gt;<i>                        {[28719,28700,28681,28662,28643],[28624]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.615.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        12}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.509.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.509.0&gt;,#Ref&lt;0.0.0.2243&gt;,
</I>&gt;&gt;<i>                        {[28302,28281,28260,28239,28218,28197,28176,28155,
</I>&gt;&gt;<i>                          28132,28109,28086,28063,28040,28017,27994,27971],
</I>&gt;&gt;<i>                         [27580,27603,27626,27649,27672,27695,27718,27741,
</I>&gt;&gt;<i>                          27764,27787,27810,27833,27856,27879,27902,27925,
</I>&gt;&gt;<i>                          27948]},
</I>&gt;&gt;<i>                        3,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.508.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        36}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.873.0&gt;},17},
</I>&gt;&gt;<i>                   {{ch,&lt;0.588.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.588.0&gt;,#Ref&lt;0.0.0.7808&gt;,
</I>&gt;&gt;<i>                        {[28721,28702,28683,28664,28645],[28626]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.587.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        12}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.664.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.664.0&gt;,#Ref&lt;0.0.0.10772&gt;,
</I>&gt;&gt;<i>                        {[28720,28701,28682,28663,28644],[28625]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.663.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        13}},
</I>&gt;&gt;<i>                   {fhc_age_tree,{0,nil}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.708.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.708.0&gt;,#Ref&lt;0.0.0.11695&gt;,
</I>&gt;&gt;<i>                        {[28707,28688,28669,28650,28631,28606,28588,28570,
</I>&gt;&gt;<i>                          28552,28534,28516,28498,28480,28462,28444,28426,
</I>&gt;&gt;<i>                          28408,28390,28372,28354,28336,28317,28296,28275,
</I>&gt;&gt;<i>                          28254,28233,28212,28191,28170,28149,28126,28103,
</I>&gt;&gt;<i>                          28080,28057,28034,28011,27988,27965,27942,27919,
</I>&gt;&gt;<i>                          27896,27873,27850,27827,27804,27781,27758,27735,
</I>&gt;&gt;<i>                          27712,27689,27666,27643,27620,27597],
</I>&gt;&gt;<i>                         [27574]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.707.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        35}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.829.0&gt;},13},
</I>&gt;&gt;<i>                   {{ch,&lt;0.757.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.757.0&gt;,#Ref&lt;0.0.0.13150&gt;,
</I>&gt;&gt;<i>                        {[28706,28687,28668,28649,28630,28605,28587,28569,
</I>&gt;&gt;<i>                          28551,28533,28515,28497,28479,28461,28443,28425,
</I>&gt;&gt;<i>                          28407,28389,28371,28353,28335,28316,28295,28274,
</I>&gt;&gt;<i>                          28253,28232,28211,28190,28169,28148,28125,28102,
</I>&gt;&gt;<i>                          28079,28056,28033,28010,27987,27964,27941,27918,
</I>&gt;&gt;<i>                          27895,27872,27849,27826,27803,27780,27757,27734,
</I>&gt;&gt;<i>                          27711,27688,27665,27642,27619,27596],
</I>&gt;&gt;<i>                         [27573]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.756.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        49}},
</I>&gt;&gt;<i>                   {{ch,&lt;0.572.0&gt;},
</I>&gt;&gt;<i>                    {cr,&lt;0.572.0&gt;,#Ref&lt;0.0.0.7536&gt;,
</I>&gt;&gt;<i>                        {[28709,28690,28671,28652,28633,28608,28590,28572,
</I>&gt;&gt;<i>                          28554,28536,28518,28500,28482,28464,28446,28428,
</I>&gt;&gt;<i>                          28410,28392,28374,28356,28338,28319,28298,28277,
</I>&gt;&gt;<i>                          28256,28235,28214,28193,28172,28151,28128,28105,
</I>&gt;&gt;<i>                          28082,28059,28036,28013,27990,27967,27944,27921,
</I>&gt;&gt;<i>                          27898,27875,27852,27829,27806,27783,27760,27737,
</I>&gt;&gt;<i>                          27714,27691,27668,27645,27622,27599],
</I>&gt;&gt;<i>                         [27576]},
</I>&gt;&gt;<i>                        1,
</I>&gt;&gt;<i>                        {[],[]},
</I>&gt;&gt;<i>                        {qstate,&lt;0.571.0&gt;,active,{0,nil}},
</I>&gt;&gt;<i>                        35}},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.825.0&gt;},2},
</I>&gt;&gt;<i>                   {{credit_to,&lt;7350.858.0&gt;},3}]
</I>&gt;&gt;<i>     trap_exit: true
</I>&gt;&gt;<i>     status: running
</I>&gt;&gt;<i>     heap_size: 121536
</I>&gt;&gt;<i>     stack_size: 27
</I>&gt;&gt;<i>     reductions: 9363545
</I>&gt;&gt;<i>   neighbours:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> =SUPERVISOR REPORT==== 18-May-2013::01:41:51 ===
</I>&gt;&gt;<i>      Supervisor: {local,rabbit_amqqueue_sup}
</I>&gt;&gt;<i>      Context:    child_terminated
</I>&gt;&gt;<i>      Reason:     {{case_clause,{empty,{[],[]}}},
</I>&gt;&gt;<i>                   [{rabbit_amqqueue_process,subtract_acks,3,[]},
</I>&gt;&gt;<i>                    {rabbit_amqqueue_process,subtract_acks,4,[]},
</I>&gt;&gt;<i>                    {rabbit_amqqueue_process,handle_cast,2,[]},
</I>&gt;&gt;<i>                    {gen_server2,handle_msg,2,[]},
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  {proc_lib,wake_up,3,[{file,&quot;proc_lib.erl&quot;},{line,249}]}]}
</I>&gt;&gt;<i>      Offender:   [{pid,&lt;0.301.0&gt;},
</I>&gt;&gt;<i>                   {name,rabbit_amqqueue},
</I>&gt;&gt;<i>                   {mfa,
</I>&gt;&gt;<i>                       {rabbit_amqqueue_process,start_link,
</I>&gt;&gt;<i>                           [{amqqueue,
</I>&gt;&gt;<i>                                {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
</I>&gt;&gt;<i>                                    &lt;&lt;&quot;document_queue&quot;&gt;&gt;},
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  true,false,none,[],&lt;0.7622.0&gt;,[],[],undefined,
</I>&gt;&gt;<i>                                []}]}},
</I>&gt;&gt;<i>                   {restart_type,temporary},
</I>&gt;&gt;<i>                   {shutdown,4294967295},
</I>&gt;&gt;<i>                   {child_type,worker}]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Notice how the *case_clause *is *empty*.  The other rabbit log looks
</I>&gt;<i> similar:
</I>&gt;<i>
</I>&gt;<i> # cat /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-123-123-123.log</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> =ERROR REPORT==== 18-May-2013::01:41:48 ===
</I>&gt;<i>
</I>&gt;<i> ** Generic server &lt;0.301.0&gt; terminating
</I>&gt;<i>
</I>&gt;<i> ** Last message in was {'$gen_cast',
</I>&gt;<i>
</I>&gt;<i>                            {ack,
</I>&gt;<i>
</I>&gt;<i>                                [27585,27584,27607,27630,27653,27676,27699,
</I>&gt;<i>
</I>&gt;<i>                                 27722,27745,27768,27791,27814,27837,27860,
</I>&gt;<i>
</I>&gt;<i>                                 27883,27906,27929,27952,27975,27998,28021,
</I>&gt;<i>
</I>&gt;<i>                                 28044,28067,28090,28113,28136,28159,28180,
</I>&gt;<i>
</I>&gt;<i>                                 28201,28222,28243,28264,28285,28306,28325,
</I>&gt;<i>
</I>&gt;<i>                                 28343,28361,28379,28397,28415,28433,28451,
</I>&gt;<i>
</I>&gt;<i>                                 28469,28487,28505,28523,28541,28559,28577,
</I>&gt;<i>
</I>&gt;<i>                                 28595,28613],
</I>&gt;<i>
</I>&gt;<i>                                &lt;0.676.0&gt;}}
</I>&gt;<i>
</I>&gt;<i> ** When Server state == {q,
</I>&gt;<i>
</I>&gt;<i>                          {amqqueue,
</I>&gt;<i>
</I>&gt;<i>                           {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,
</I>&gt;<i>
</I>&gt;<i>                            &lt;&lt;&quot;document_queue&quot;&gt;&gt;},
</I>&gt;<i>
</I>&gt;<i>                           true,false,none,[],&lt;0.301.0&gt;,[],[],undefined,[]},
</I>&gt;<i>
</I>&gt;<i>                          none,true,rabbit_variable_queue,
</I>&gt;<i>
</I>&gt;<i>                          {vqstate,
</I>&gt;<i>
</I>&gt;<i>                           {0,{[],[]}},
</I>&gt;<i>
</I>&gt;<i>                           {0,{[],[]}},
</I>&gt;<i>
</I>&gt;<i>                           {delta,undefined,0,undefined},
</I>&gt;<i>
</I>&gt;<i>                           {0,{[],[]}},
</I>&gt;<i>
</I>&gt;<i>                           {0,{[],[]}},
</I>&gt;<i>
</I>&gt;<i> *                          ... [ thousands of lines of state ] ... *
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ** Reason for termination ==
</I>&gt;<i>
</I>&gt;<i> ** {{case_clause,{empty,{[],[]}}},
</I>&gt;<i>
</I>&gt;<i>     [{rabbit_amqqueue_process,subtract_acks,3,[]},
</I>&gt;<i>
</I>&gt;<i>      {rabbit_amqqueue_process,subtract_acks,4,[]},
</I>&gt;<i>
</I>&gt;<i>      {rabbit_amqqueue_process,handle_cast,2,[]},
</I>&gt;<i>
</I>&gt;<i>      {gen_server2,handle_msg,2,[]},
</I>&gt;<i>
</I>&gt;<i>      {proc_lib,wake_up,3,[{file,&quot;proc_lib.erl&quot;},{line,249}]}]}
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> =ERROR REPORT==== 18-May-2013::01:41:51 ===
</I>&gt;<i>
</I>&gt;<i> connection &lt;0.430.0&gt;, channel 22 - soft error:
</I>&gt;<i>
</I>&gt;<i> {amqp_error,not_found,
</I>&gt;<i>
</I>&gt;<i>             &quot;no queue 'document_queue' in vhost '/'&quot;,
</I>&gt;<i>
</I>&gt;<i>             'queue.declare'}
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> =ERROR REPORT==== 18-May-2013::01:41:51 ===
</I>&gt;<i>
</I>&gt;<i> connection &lt;0.384.0&gt;, channel 12 - soft error:
</I>&gt;<i>
</I>&gt;<i> {amqp_error,not_found,
</I>&gt;<i>
</I>&gt;<i>             &quot;no queue 'document_queue' in vhost '/'&quot;,
</I>&gt;<i>
</I>&gt;<i>             'queue.declare'}
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> =ERROR REPORT==== 18-May-2013::01:41:51 ===
</I>&gt;<i>
</I>&gt;<i> connection &lt;0.384.0&gt;, channel 15 - soft error:
</I>&gt;<i>
</I>&gt;<i> {amqp_error,not_found,
</I>&gt;<i>
</I>&gt;<i>             &quot;no queue 'document_queue' in vhost '/'&quot;,
</I>&gt;<i>
</I>&gt;<i>             'queue.declare'}
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> =ERROR REPORT==== 18-May-2013::01:41:51 ===
</I>&gt;<i>
</I>&gt;<i> connection &lt;0.373.0&gt;, channel 23 - soft error:
</I>&gt;<i>
</I>&gt;<i> {amqp_error,not_found,
</I>&gt;<i>
</I>&gt;<i>             &quot;no queue 'document_queue' in vhost '/'&quot;,
</I>&gt;<i>
</I>&gt;<i>             'queue.declare'}
</I>&gt;<i>
</I>&gt;<i> * ... [ repeated a bunch of times ] ...*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I also see this in my */var/log/syslog* with regards to *beam.smp*:
</I>&gt;<i>
</I>&gt;<i> # cat /var/log/syslog
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176041] INFO: task
</I>&gt;&gt;<i> beam.smp:18971 blocked for more than 120 seconds.
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176053] &quot;echo 0 &gt;
</I>&gt;&gt;<i> /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176060] beam.smp
</I>&gt;&gt;<i>  D ffff8801bfd93700     0 18971  18962 0x00000000
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176065]
</I>&gt;&gt;<i>  ffff8801b11cdcb8 0000000000000282 0000000000000000 ffffffffffffffe0
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176070]
</I>&gt;&gt;<i>  ffff8801b11cdfd8 ffff8801b11cdfd8 ffff8801b11cdfd8 0000000000013700
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176075]
</I>&gt;&gt;<i>  ffff8801b3180000 ffff8801b35244a0 00007f500e2079e0 ffff8801b146bb80
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176079] Call Trace:
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176089]
</I>&gt;&gt;<i>  [&lt;ffffffff8165434f&gt;] schedule+0x3f/0x60
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176094]
</I>&gt;&gt;<i>  [&lt;ffffffff8106aef5&gt;] exit_mm+0x85/0x130
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176097]
</I>&gt;&gt;<i>  [&lt;ffffffff8106b10e&gt;] do_exit+0x16e/0x450
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176102]
</I>&gt;&gt;<i>  [&lt;ffffffff810797aa&gt;] ? __dequeue_signal+0x6a/0xb0
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176105]
</I>&gt;&gt;<i>  [&lt;ffffffff8106b594&gt;] do_group_exit+0x44/0xa0
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176108]
</I>&gt;&gt;<i>  [&lt;ffffffff8107c36c&gt;] get_signal_to_deliver+0x21c/0x420
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176113]
</I>&gt;&gt;<i>  [&lt;ffffffff81014825&gt;] do_signal+0x45/0x130
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176116]
</I>&gt;&gt;<i>  [&lt;ffffffff8105539d&gt;] ? set_next_entity+0xad/0xd0
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176120]
</I>&gt;&gt;<i>  [&lt;ffffffff81014ad5&gt;] do_notify_resume+0x65/0x80
</I>&gt;&gt;<i> May 17 22:46:23 ip-10-123-123-123 kernel: [244800.176124]
</I>&gt;&gt;<i>  [&lt;ffffffff8165ea90&gt;] int_signal+0x12/0x17
</I>&gt;&gt;<i> *... [ repeated 9 more times with same timestamp ] ...*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> There are no strange CPU spikes on my EC2 node based on AWS monitoring.
</I>&gt;<i> The only thing that seems to stand out is that my writes to my EBS volume
</I>&gt;<i> spike during the crash (~90 write OPs/sec, 4 MiB/sec write bandwidth,
</I>&gt;<i> ~30ms/op write latency).
</I>&gt;<i>
</I>&gt;<i> My team and I are completely stumped and would appreciate any insight you
</I>&gt;<i> might have to the crash reports.  Is this a problem with writes hanging
</I>&gt;<i> when going against the EBS volume since EBS volumes are essentially network
</I>&gt;<i> mounted?  Is there a way to configure rabbit to be more tolerant of these
</I>&gt;<i> delays?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For debugging purposes, below is the status output of one of the nodes
</I>&gt;<i> when it is healthy (so you can see the versions of everything i'm running):
</I>&gt;<i>
</I>&gt;<i> # rabbitmqctl status
</I>&gt;&gt;<i> Status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ip-10-123-123-123</A>' ...
</I>&gt;&gt;<i> [{pid,28978},
</I>&gt;&gt;<i>  {running_applications,
</I>&gt;&gt;<i>      [{rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;3.1.0&quot;},
</I>&gt;&gt;<i>       {rabbitmq_web_dispatch,&quot;RabbitMQ Web Dispatcher&quot;,&quot;3.1.0&quot;},
</I>&gt;&gt;<i>       {webmachine,&quot;webmachine&quot;,&quot;1.9.1-rmq3.1.0-git52e62bc&quot;},
</I>&gt;&gt;<i>       {mochiweb,&quot;MochiMedia Web Server&quot;,&quot;2.3.1-rmq3.1.0-gitd541e9a&quot;},
</I>&gt;&gt;<i>       {rabbitmq_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;3.1.0&quot;},
</I>&gt;&gt;<i>       {rabbit,&quot;RabbitMQ&quot;,&quot;3.1.0&quot;},
</I>&gt;&gt;<i>       {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.11&quot;},
</I>&gt;&gt;<i>       {inets,&quot;INETS  CXC 138 49&quot;,&quot;5.9.4&quot;},
</I>&gt;&gt;<i>       {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.8&quot;},
</I>&gt;&gt;<i>       {amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;3.1.0&quot;},
</I>&gt;&gt;<i>       {xmerl,&quot;XML parser&quot;,&quot;1.3.3&quot;},
</I>&gt;&gt;<i>       {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.3.1&quot;},
</I>&gt;&gt;<i>       {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.19.1&quot;},
</I>&gt;&gt;<i>       {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.16.1&quot;}]},
</I>&gt;&gt;<i>  {os,{unix,linux}},
</I>&gt;&gt;<i>  {erlang_version,
</I>&gt;&gt;<i>      &quot;Erlang R16B (erts-5.10.1) [source-05f1189] [64-bit] [smp:8:8]
</I>&gt;&gt;<i> [async-threads:30] [hipe] [kernel-poll:true]\n&quot;},
</I>&gt;&gt;<i>  {memory,
</I>&gt;&gt;<i>      [{total,60179048},
</I>&gt;&gt;<i>       {connection_procs,5274808},
</I>&gt;&gt;<i>       {queue_procs,13107264},
</I>&gt;&gt;<i>       {plugins,354272},
</I>&gt;&gt;<i>       {other_proc,9741830},
</I>&gt;&gt;<i>       {mnesia,150456},
</I>&gt;&gt;<i>       {mgmt_db,12248},
</I>&gt;&gt;<i>       {msg_index,34768},
</I>&gt;&gt;<i>       {other_ets,1148248},
</I>&gt;&gt;<i>       {binary,4905584},
</I>&gt;&gt;<i>       {code,19565863},
</I>&gt;&gt;<i>       {atom,703377},
</I>&gt;&gt;<i>       {other_system,5180330}]},
</I>&gt;&gt;<i>  {vm_memory_high_watermark,0.8},
</I>&gt;&gt;<i>  {vm_memory_limit,5828434329},
</I>&gt;&gt;<i>  {disk_free_limit,1000000000},
</I>&gt;&gt;<i>  {disk_free,3953344512},
</I>&gt;&gt;<i>  {file_descriptors,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  [{total_limit,924},{total_used,6},{sockets_limit,829},{sockets_used,4}]},
</I>&gt;&gt;<i>  {processes,[{limit,1048576},{used,348}]},
</I>&gt;&gt;<i>  {run_queue,0},
</I>&gt;&gt;<i>  {uptime,3796}]
</I>&gt;&gt;<i> ...done.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Note that I am using Erlang v16 from the Erlang Solutions repo (esl-erlang
</I>&gt;<i> package).  I originally was using Erlang v14 from Ubuntu repos
</I>&gt;<i> (erlang-base), but decided to upgrade hoping it would resolve the issue
</I>&gt;<i> (which it did not).  I have also tried running RabbitMQ 3.0.4 without
</I>&gt;<i> success.  This issue seems to affect both versions.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Karl
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130518/0529f34a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130518/0529f34a/attachment.htm</A>&gt;
</PRE>

















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027297.html">[rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2
</A></li>
	<LI>Next message: <A HREF="027300.html">[rabbitmq-discuss] Strange subtract_acks crash in RabbitMQ 3.1.0-1 (case_clause empty) on EC2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27298">[ date ]</a>
              <a href="thread.html#27298">[ thread ]</a>
              <a href="subject.html#27298">[ subject ]</a>
              <a href="author.html#27298">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
