<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Unexpected blocking in channel.basicGet()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Unexpected%20blocking%20in%20channel.basicGet%28%29&In-Reply-To=%3C03BC24AE-9691-495B-9FF4-80B4E753B392%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026908.html">
   <LINK REL="Next"  HREF="026910.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Unexpected blocking in channel.basicGet()</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Unexpected%20blocking%20in%20channel.basicGet%28%29&In-Reply-To=%3C03BC24AE-9691-495B-9FF4-80B4E753B392%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Unexpected blocking in channel.basicGet()">tim at rabbitmq.com
       </A><BR>
    <I>Fri May  3 17:19:02 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026908.html">[rabbitmq-discuss] Unexpected blocking in channel.basicGet()
</A></li>
        <LI>Next message: <A HREF="026910.html">[rabbitmq-discuss] Unexpected blocking in channel.basicGet()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26909">[ date ]</a>
              <a href="thread.html#26909">[ thread ]</a>
              <a href="subject.html#26909">[ subject ]</a>
              <a href="author.html#26909">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3 May 2013, at 16:53, Dave Goldstein wrote:

&gt;<i> So if the call blocks indefinitely without erroring out, what does that suggest 
</I>&gt;<i> 
</I>
The usual suspect is a network connectivity problem, either due to an interruption in service, broker failure/crash/restart or intermediate network kit (such as firewalls). A typical TCP/IP stack can take quite a long time to &quot;notice&quot; the peer socket has &quot;disappeared&quot;, while the client is sat waiting for a reply.

&gt;<i> and is there any way for me to recover from this beyond detecting and killing the thread?
</I>
Unfortunately there aren't any silver bullet solutions to this kind of problem. Detecting an idle worker (based on whatever your definition of &quot;idle&quot; happens to be) and killing it is certinaly the must common approach. Bear in mind that the OS networking stack is already trying to 'detect' the problem, and it's unlikely you'll be able to improve on what it is doing.

It might help if you enable AMQP heartbeats in your client, which would at least detect an unresponsive network connection in a timely fashion. These will do the job of killing the connection and any channels for you, so at least you don't have to home bake a solution based on killing threads. The other thing that might help is to consider turning on TCP keep-alives in your OS networking configuration. These perform a similar function, but at a much lower level, however they come with overheads and caveats that they might affect your application (and/or other network interactions taking place on the machine) in a wide variety of ways.

&gt;<i> BTW, I was running client 3.0.1 and have just moved to 3.0.4 to see if the behavior changes.
</I>&gt;<i>  
</I>
This won't have changed between releases, if I've diagnosed it correctly at least.

Cheers,
Tim
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026908.html">[rabbitmq-discuss] Unexpected blocking in channel.basicGet()
</A></li>
	<LI>Next message: <A HREF="026910.html">[rabbitmq-discuss] Unexpected blocking in channel.basicGet()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26909">[ date ]</a>
              <a href="thread.html#26909">[ thread ]</a>
              <a href="subject.html#26909">[ subject ]</a>
              <a href="author.html#26909">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
