<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Porting%20.NET%20client%20to%20WinRT%20API%20%28Windows%208%29.&In-Reply-To=%3CCAFCmQSofOfwN5B2rdRsALXYfcv-EvcUOYBGorY7xZNyBjBhp9w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027050.html">
   <LINK REL="Next"  HREF="027082.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).</H1>
    <B>Nathan Brown</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Porting%20.NET%20client%20to%20WinRT%20API%20%28Windows%208%29.&In-Reply-To=%3CCAFCmQSofOfwN5B2rdRsALXYfcv-EvcUOYBGorY7xZNyBjBhp9w%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).">nathan at nkbrown.us
       </A><BR>
    <I>Sat May 11 21:40:04 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027050.html">[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
</A></li>
        <LI>Next message: <A HREF="027082.html">[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27081">[ date ]</a>
              <a href="thread.html#27081">[ thread ]</a>
              <a href="subject.html#27081">[ subject ]</a>
              <a href="author.html#27081">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Emile (and others),

I have the Windows 8 Modern UI (Windows Store) implementation basically
working.  I'm trying to polish up a sample project.

The thing with the Windows.Networking.Sockets is that it breaks
compatibility with every version of Windows before Windows 8 and Server
2012.  So support will have to swap in code as needed and compile separate
DLLs.  The SSL implementation is so different, that I'm not even sure if
there is the equivalent of having the application handle or know about its
certificates.  I'm also not familiar with setting up and testing SSL in
RabbitMQ.

The Generic changes should all work on Mono, so all of that can be shared.
 I do wonder if we want to move completely away from IDictionary to
IDictionary&lt;string, object&gt;.  Specifically look at the
WireFormatting.WriteTable() and MethodArgumentWriter.WriteTable() methods.
 With my current method of having both overloads, callers need to cast to
the specific interface they are using because the concrete Dictionary&lt;,&gt;
implements both.

Currently, I have the Windows Store project working with sharing most files
and having copies of some files. Since not many lines change compared to
the size of the files, it might be beneficial to use #if NETFX_CORE in the
main files and share everything.  What do you think?  The files that were
copied and not currently shared are:

&quot;..\RabbitMQ.Client\src\util\**\XmlUtil.cs;..\RabbitMQ.Client\src\client\**\ConnectionFactory.cs;..\RabbitMQ.Client\src\client\**\ConnectionBase.cs;..\RabbitMQ.Client\src\client\**\Frame.cs;..\RabbitMQ.Client\src\client\**\SessionManager.cs;..\RabbitMQ.Client\src\client\**\SocketFrame*.cs;..\RabbitMQ.Client\src\client\**\SslHelper.cs;..\RabbitMQ.Client\src\client\**\SslOption.cs;..\RabbitMQ.Client\src\client\**\Protocols.cs&quot;

Another area that was different was getting environment variables.  Windows
Store Apps don't have access to ConfigurationSettings,
ConfigurationManager, or Environment.GetEnvironmentVariable but instead
uses Windows.Storage.ApplicationData.  I'm not sure if it's a good idea to
have the library try to access those values (primarily the AMQP_PROTOCOL)
or just make it clear they have to be pragmatically set.  I don't think
there's an example of the protocol being pragmatically set though.

Having the library use Windows.Storage.ApplicationData keeps it from
running on the desktop because there is no Application Identity.  It also
keeps some of the tests from being runnable on NUnit.  Any thoughts on this?

Thanks,

Nathan Brown


On Fri, May 10, 2013 at 2:45 AM, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> Hi Nathan,
</I>&gt;<i>
</I>&gt;<i> On 07/05/13 17:34, Nathan Brown wrote:
</I>&gt;<i> &gt; Can you guys review these changes and consider incorporating them into
</I>&gt;<i> &gt; the mainline codebase?
</I>&gt;<i>
</I>&gt;<i> Yes, and thanks! We'd like to make use of your contribution, but it will
</I>&gt;<i> take a while to review. May I request that you sign a contributor
</I>&gt;<i> agreement in the meantime? I'll contact you off-list.
</I>&gt;<i>
</I>&gt;<i> &gt; The networking area is another area of change in WinRT.  It will have to
</I>&gt;<i> &gt; involve a separate project because System.Net.Sockets has been removed
</I>&gt;<i> &gt; and Windows.Networking.Sockets has been added.  I am still working on
</I>&gt;<i> &gt; porting the networking code to the WinRT API, but that will hit far
</I>&gt;<i> &gt; fewer files than the non-generic to generic collection conversion.
</I>&gt;<i>
</I>&gt;<i> Yes, Socket and SSL-related functionality is more localised.
</I>&gt;<i>
</I>&gt;<i> We would be reluctant to relinquish the compatibility of the current
</I>&gt;<i> .net client with mono. I'm not sure whether that is necessarily the
</I>&gt;<i> implication, but it might be something to consider.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130511/9f8581d0/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130511/9f8581d0/attachment.htm</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027050.html">[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
</A></li>
	<LI>Next message: <A HREF="027082.html">[rabbitmq-discuss] Porting .NET client to WinRT API (Windows 8).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27081">[ date ]</a>
              <a href="thread.html#27081">[ thread ]</a>
              <a href="subject.html#27081">[ subject ]</a>
              <a href="author.html#27081">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
