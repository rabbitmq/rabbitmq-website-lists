<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Expected msg/s per CPU core
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Expected%20msg/s%20per%20CPU%20core&In-Reply-To=%3C5198858F.3090807%40osic.rs%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027310.html">
   <LINK REL="Next"  HREF="027317.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Expected msg/s per CPU core</H1>
    <B>Nikola Savic</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Expected%20msg/s%20per%20CPU%20core&In-Reply-To=%3C5198858F.3090807%40osic.rs%3E"
       TITLE="[rabbitmq-discuss] Expected msg/s per CPU core">niks at osic.rs
       </A><BR>
    <I>Sun May 19 08:55:59 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027310.html">[rabbitmq-discuss] Expected msg/s per CPU core
</A></li>
        <LI>Next message: <A HREF="027317.html">[rabbitmq-discuss] Expected msg/s per CPU core
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27313">[ date ]</a>
              <a href="thread.html#27313">[ thread ]</a>
              <a href="subject.html#27313">[ subject ]</a>
              <a href="author.html#27313">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

Thank you for prompt reply!

Web application is coded in PHP. We tried both PHP AMQP extension and 
php-amqplib. We ended up using AMQP extension, because it works much 
faster, since php-amqplib took 80-100ms to connect and send single 
message (but that's different issue).

With every execution, PHP scripts connects to RabbitMQ and post 1-3 
messages. Since we're tracking banner displaying, additionally when 
displayed to user, each page generates 3-5 more messages.

So, on producer side, we have many connections being made and 1-3 short 
messages sent on single queue.

On consumer side we have worker PHP processes, which are connected once 
and receive messages. From time to time, we're sending ECHO (loopback 
messages) from producers to themselves, because we noticed that 
producers do not recognize RabbitMQ server has gone away or that VIP has 
switched to different server. With each ECHO message new connection is 
established.

Regards,
Nikola


On 05/18/2013 10:33 PM, Michael Klishin wrote:
&gt;<i> 2013/5/18 nikolasavic77 &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">niksav at osic.rs</A> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">niksav at osic.rs</A>&gt;&gt;
</I>&gt;<i>
</I>&gt;<i>     What is expected value of consumed msg/s per CPU code running at
</I>&gt;<i>     2.4GHz?
</I>&gt;<i>
</I>&gt;<i>     We're using 4 core VM running only RabbitMQ. When under load of
</I>&gt;<i>     about 500msg/s, IDLE is only about 50%. This sounds like far away
</I>&gt;<i>     from high performance, since we're expecting much much more msg/s :(
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It depends on message size but 500 sounds way too low. However, 
</I>&gt;<i> consumer throughput greatly depends on the client
</I>&gt;<i> and consumer code. Can you post any? What are your prefetch settings?
</I>&gt;<i> -- 
</I>&gt;<i> MK
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
</I>&gt;<i> <A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130519/6efb4f77/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130519/6efb4f77/attachment.htm</A>&gt;
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027310.html">[rabbitmq-discuss] Expected msg/s per CPU core
</A></li>
	<LI>Next message: <A HREF="027317.html">[rabbitmq-discuss] Expected msg/s per CPU core
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27313">[ date ]</a>
              <a href="thread.html#27313">[ thread ]</a>
              <a href="subject.html#27313">[ subject ]</a>
              <a href="author.html#27313">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
