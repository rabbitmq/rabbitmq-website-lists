<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Repairing a crashed cluster - Obtaining persisted msgs from master
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Repairing%20a%20crashed%20cluster%20-%20Obtaining%0A%20persisted%20msgs%20from%20master&In-Reply-To=%3C518142C8.1040906%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026812.html">
   <LINK REL="Next"  HREF="026798.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Repairing a crashed cluster - Obtaining persisted msgs from master</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Repairing%20a%20crashed%20cluster%20-%20Obtaining%0A%20persisted%20msgs%20from%20master&In-Reply-To=%3C518142C8.1040906%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Repairing a crashed cluster - Obtaining persisted msgs from master">simon at rabbitmq.com
       </A><BR>
    <I>Wed May  1 17:28:56 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="026812.html">[rabbitmq-discuss] Repairing a crashed cluster - Obtaining persisted msgs from master
</A></li>
        <LI>Next message: <A HREF="026798.html">[rabbitmq-discuss] Question about starting a node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26813">[ date ]</a>
              <a href="thread.html#26813">[ thread ]</a>
              <a href="subject.html#26813">[ subject ]</a>
              <a href="author.html#26813">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 01/05/13 17:11, ranjitiyer wrote:
&gt;<i> Hi Simon,
</I>&gt;<i>
</I>&gt;&gt;<i> Note that since that message, RabbitMQ 3.0 was released, with
</I>&gt;&gt;<i> &quot;rabbitmqctl forget_cluster_node&quot; - which might help you get the slave
</I>&gt;&gt;<i> started if the master is gone.
</I>&gt;<i>
</I>&gt;<i> But isn't this option available only after the rabbitmq server has started
</I>&gt;<i> (erl.exe) and I've noticed even erl.exe won't start on a slave machine if
</I>&gt;<i> its remote master is not available?
</I>
It's worth noting that at the cluster level there are no &quot;masters&quot; and 
&quot;slaves&quot; (those terms only apply to the mirrors of individual queues).

But when restarting a stopped cluster, all other nodes wait for the last 
node that shut down to come back (since that node could know about 
things which happened that no other node has seen).

So if that last-node-to-shut-down is no longer available then you can 
recover with a combination of starting the second-to-last node with 
RABBITMQ_NODE_ONLY set, then invoking &quot;rabbitmqctl forget_cluster_node 
--offline&quot;.

This could probably be better documented. It's a bit of an edge case 
though...

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026812.html">[rabbitmq-discuss] Repairing a crashed cluster - Obtaining persisted msgs from master
</A></li>
	<LI>Next message: <A HREF="026798.html">[rabbitmq-discuss] Question about starting a node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26813">[ date ]</a>
              <a href="thread.html#26813">[ thread ]</a>
              <a href="subject.html#26813">[ subject ]</a>
              <a href="author.html#26813">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
