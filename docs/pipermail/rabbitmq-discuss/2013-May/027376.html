<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Production cluster fun,	make that not so fun (production cluster setup guidance)!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Production%20cluster%20fun%2C%0A%09make%20that%20not%20so%20fun%20%28production%20cluster%20setup%20guidance%29%21&In-Reply-To=%3C90F4CD8F-0C39-43F1-B4AC-0135FAA05638%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027131.html">
   <LINK REL="Next"  HREF="027132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Production cluster fun,	make that not so fun (production cluster setup guidance)!</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Production%20cluster%20fun%2C%0A%09make%20that%20not%20so%20fun%20%28production%20cluster%20setup%20guidance%29%21&In-Reply-To=%3C90F4CD8F-0C39-43F1-B4AC-0135FAA05638%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Production cluster fun,	make that not so fun (production cluster setup guidance)!">tim at rabbitmq.com
       </A><BR>
    <I>Tue May 21 12:03:07 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027131.html">[rabbitmq-discuss] Production cluster fun, make that not so fun (production cluster setup guidance)!
</A></li>
        <LI>Next message: <A HREF="027132.html">[rabbitmq-discuss] About the JSonRPC data length limit?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27376">[ date ]</a>
              <a href="thread.html#27376">[ thread ]</a>
              <a href="subject.html#27376">[ subject ]</a>
              <a href="author.html#27376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Stefan,

Sorry for the delay in getting back to you...

On 14 May 2013, at 05:52, Stefan Sedich wrote:

&gt;<i> What is the ideal setup for our production cluster, currently we have two ABs with two nodes in each, after setting pause_minority today and having a partition where all nodes were paused, we changed to autoheal and restarted all nodes. In the midst of this something happened, and even rolling back to just 1 node apps were not able to connect to the node.
</I>
Sounds like the node got stuck during recovery.

&gt;<i> In the end my only fix was to completely trash the db/ of that one node and restart it which got things working again (no idea what got corrupted or how but something went bad). Now after this is would be good for some guidance on how to properly configure out cluster and how many nodes would be ideal and what recovery node to use (we seem to occasionally have a partition, even though it SHOULD be a stable link).
</I>
The pause_minority setting will cause nodes in the minority island to literally pause (with regards cluster membership) until they've seen the cluster recover - i.e., all the expected nodes come back online. As to &quot;what recovery node to use&quot;, there is no answer to that because there is no concept of a 'special' node in a rabbit cluster. Or did you rather mean what recovery *mode* to use?

Please note that whilst the autoheal features are intended to simply the process of partition recovery, they're not a panacea and a partition can still result in states where manual intervention is required. It would be good to understand how your current cluster topology is used by clients, to get a feel for what the impact of the recovery process is likely to be.

Cheers,
Tim
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027131.html">[rabbitmq-discuss] Production cluster fun, make that not so fun (production cluster setup guidance)!
</A></li>
	<LI>Next message: <A HREF="027132.html">[rabbitmq-discuss] About the JSonRPC data length limit?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27376">[ date ]</a>
              <a href="thread.html#27376">[ thread ]</a>
              <a href="subject.html#27376">[ subject ]</a>
              <a href="author.html#27376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
