<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] All nodes in a cluster becomes unresponsive	for a short period of time when any node goes down
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20All%20nodes%20in%20a%20cluster%20becomes%20unresponsive%0A%09for%20a%20short%20period%20of%20time%20when%20any%20node%20goes%20down&In-Reply-To=%3C04692AB3-F6D9-4E9E-8449-FAF398804B5C%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027369.html">
   <LINK REL="Next"  HREF="027380.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] All nodes in a cluster becomes unresponsive	for a short period of time when any node goes down</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20All%20nodes%20in%20a%20cluster%20becomes%20unresponsive%0A%09for%20a%20short%20period%20of%20time%20when%20any%20node%20goes%20down&In-Reply-To=%3C04692AB3-F6D9-4E9E-8449-FAF398804B5C%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] All nodes in a cluster becomes unresponsive	for a short period of time when any node goes down">tim at rabbitmq.com
       </A><BR>
    <I>Tue May 21 12:15:11 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027369.html">[rabbitmq-discuss] All nodes in a cluster becomes unresponsive for a short period of time when any node goes down
</A></li>
        <LI>Next message: <A HREF="027380.html">[rabbitmq-discuss] reply-to header in STOMP frames causing	&quot;Processing Error&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27378">[ date ]</a>
              <a href="thread.html#27378">[ thread ]</a>
              <a href="subject.html#27378">[ subject ]</a>
              <a href="author.html#27378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Thomas,

During autohealing, nodes will be restarted dynamically and during the downtime any clients will effectively be disconnected. Those clients may not, however, detect this disconnection in a timely fashion, so I would ask...

1. are you using AMQP heartbeats (to detect disconnections quickly)
2. are you using producer confirms (to clarify that sent message have indeed arrived at the target broker)
3. are you using consumer cancel notifications (to detect that in a clustered + ha setup, the node on which the queue is located has failed/stopped)

Cheers,
Tim

On 21 May 2013, at 06:39, thomas wrote:

&gt;<i> I have 3 RabbitMQ nodes, namely <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at A</A>, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at b</A>, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at c</A> in a cluster
</I>&gt;<i> with active-mirrored queues HA.
</I>&gt;<i> I am using RabbitMQ 3.1.0 with autoheal chosen for
</I>&gt;<i> &quot;cluster_partition_handling&quot; and &quot;net_ticktime&quot; set to 2. I tried to
</I>&gt;<i> shutdown the network interface instead of shutting down rabbitmq to observe
</I>&gt;<i> the behavior and realized that it results in the temporary unresponsiveness
</I>&gt;<i> of all the other available nodes for a short period of time. 
</I>&gt;<i> 
</I>&gt;<i> This was what I did:
</I>&gt;<i> 1) All the 3 nodes are running as per normal
</I>&gt;<i> 2) I shutdown the network interface for <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at B</A>
</I>&gt;<i> 3) The other 2 nodes become unresponsive for a short period of time and the
</I>&gt;<i> messages sent during that period were mostly lost.
</I>&gt;<i> 
</I>&gt;<i> I would like to find out if that is the intended behavior or possibly
</I>&gt;<i> something wrong with my setup. Thanks in advance.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> View this message in context: <A HREF="http://rabbitmq.1065348.n5.nabble.com/All-nodes-in-a-cluster-becomes-unresponsive-for-a-short-period-of-time-when-any-node-goes-down-tp26883.html">http://rabbitmq.1065348.n5.nabble.com/All-nodes-in-a-cluster-becomes-unresponsive-for-a-short-period-of-time-when-any-node-goes-down-tp26883.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027369.html">[rabbitmq-discuss] All nodes in a cluster becomes unresponsive for a short period of time when any node goes down
</A></li>
	<LI>Next message: <A HREF="027380.html">[rabbitmq-discuss] reply-to header in STOMP frames causing	&quot;Processing Error&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27378">[ date ]</a>
              <a href="thread.html#27378">[ thread ]</a>
              <a href="subject.html#27378">[ subject ]</a>
              <a href="author.html#27378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
