<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Workflow for optional data in HTTP server	process?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Workflow%20for%20optional%20data%20in%20HTTP%20server%0A%09process%3F&In-Reply-To=%3C41B10089-6A9F-45B2-BC0E-089D8C9081FB%40teksol.info%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027406.html">
   <LINK REL="Next"  HREF="027208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Workflow for optional data in HTTP server	process?</H1>
    <B>Fran&#231;ois Beausoleil</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Workflow%20for%20optional%20data%20in%20HTTP%20server%0A%09process%3F&In-Reply-To=%3C41B10089-6A9F-45B2-BC0E-089D8C9081FB%40teksol.info%3E"
       TITLE="[rabbitmq-discuss] Workflow for optional data in HTTP server	process?">francois at teksol.info
       </A><BR>
    <I>Mon May 13 14:02:04 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="027406.html">[rabbitmq-discuss] create a policy for concrete nodes
</A></li>
        <LI>Next message: <A HREF="027208.html">[rabbitmq-discuss] Workflow for optional data in HTTP server	process?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27106">[ date ]</a>
              <a href="thread.html#27106">[ thread ]</a>
              <a href="subject.html#27106">[ subject ]</a>
              <a href="author.html#27106">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!

Let's say I have data which I'd like to return to an HTTP client (browser), but is optional. When the request hits the web server process, is it expected that it would open a channel, create a server-named queue and send the request, with reply-to set to the queue? Once all processing is completed, the web server process would poll the queue for N milliseconds and return ASAP. If the reply hasn't arrived, RabbitMQ would discard it since the queue would already be destroyed.

Because the data is optional, I would assume that this workflow is as optimal as possible?

For reference, I'm talking about using Bunny in a Ruby 1.9.3 Unicorn HTTP web server. Pseudo-code:

# Ruby / Sinatra
get &quot;/widget/:id&quot; do
  queue = nil
  begin
    queue = bunny.queue(&quot;&quot;)
    exchange.publish(params[:id], reply_to: queue.name)

    # database code - expected to take a couple milliseconds
    @widget = # fetch from database
    # more processing

    # hopefully, by this time, the data has made it only the queue
    # and we can get it - else, we won't care
    @optional = queue.get # returns nil if no message, does not block
  finally
    queue.close if queue
  end
end

With this code, the queue is expected to live for only a few milliseconds.

Bye!
Fran&#231;ois

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4142 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130513/e387e04b/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130513/e387e04b/attachment.bin</A>&gt;
</PRE>































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027406.html">[rabbitmq-discuss] create a policy for concrete nodes
</A></li>
	<LI>Next message: <A HREF="027208.html">[rabbitmq-discuss] Workflow for optional data in HTTP server	process?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27106">[ date ]</a>
              <a href="thread.html#27106">[ thread ]</a>
              <a href="subject.html#27106">[ subject ]</a>
              <a href="author.html#27106">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
