<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java client blocked when opening channel
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20blocked%20when%20opening%20channel&In-Reply-To=%3C20110223105638.11791vt2j7bhgb8g%40webmail.active24.cz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011446.html">
   <LINK REL="Next"  HREF="011428.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java client blocked when opening channel</H1>
    <B>Jiri Krutil</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20blocked%20when%20opening%20channel&In-Reply-To=%3C20110223105638.11791vt2j7bhgb8g%40webmail.active24.cz%3E"
       TITLE="[rabbitmq-discuss] Java client blocked when opening channel">jiri at krutil.com
       </A><BR>
    <I>Wed Feb 23 09:56:38 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011446.html">[rabbitmq-discuss] pika - HeartbeatChecker Bug?
</A></li>
        <LI>Next message: <A HREF="011428.html">[rabbitmq-discuss] Java client blocked when opening channel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11427">[ date ]</a>
              <a href="thread.html#11427">[ thread ]</a>
              <a href="subject.html#11427">[ subject ]</a>
              <a href="author.html#11427">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have experienced a strange problem that we did not see before.

One of our threads got stuck inside AMQConnection.createChannel() and  
would not return. The thread dump shows this:

at java/lang/Object.wait(Native Method) at  
java/lang/Object.wait(Object.java:199(Compiled Code)) at  
com/rabbitmq/utility/BlockingCell.get(BlockingCell.java:64) at  
com/rabbitmq/utility/BlockingCell.uninterruptibleGet(BlockingCell.java:103) at  
com/rabbitmq/utility/BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:47) at com/rabbitmq/client/impl/AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:342) at com/rabbitmq/client/impl/AMQChannel.rpc(AMQChannel.java:215) at com/rabbitmq/client/impl/AMQChannel.exnWrappingRpc(AMQChannel.java:139) at com/rabbitmq/client/impl/ChannelN.open(ChannelN.java:125) at com/rabbitmq/client/impl/ChannelManager.createChannelInternal(ChannelManager.java:121) at com/rabbitmq/client/impl/ChannelManager.createChannel(ChannelManager.java:100) at  
com/rabbitmq/client/impl/AMQConnection.createChannel(AMQConnection.java:382)
... our code here ...

This blocked all the other threads that tried to open a channel. Some  
of these threads got stuck in AMQConnection.createChannel(), others in  
ChannelManager.createChannel(). All of them seemed to be waiting for  
the same ChannelManager lock.

The same scenario occurs in three consecutive thread dumps we have  
taken with 2 minute delays. The application would not recover for a  
long time, so we had to restart it.

We are running RabbitMQ 2.1.0 (both server and Java client).

Any ideas?

</PRE>



















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011446.html">[rabbitmq-discuss] pika - HeartbeatChecker Bug?
</A></li>
	<LI>Next message: <A HREF="011428.html">[rabbitmq-discuss] Java client blocked when opening channel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11427">[ date ]</a>
              <a href="thread.html#11427">[ thread ]</a>
              <a href="subject.html#11427">[ subject ]</a>
              <a href="author.html#11427">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
