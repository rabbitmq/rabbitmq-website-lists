<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Clustering over a WAN
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20over%20a%20WAN&In-Reply-To=%3CBED156B9-E9DC-428C-88BF-C74EEA5F0FB1%40jbrisbin.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011516.html">
   <LINK REL="Next"  HREF="011522.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Clustering over a WAN</H1>
    <B>Jon Brisbin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Clustering%20over%20a%20WAN&In-Reply-To=%3CBED156B9-E9DC-428C-88BF-C74EEA5F0FB1%40jbrisbin.com%3E"
       TITLE="[rabbitmq-discuss] Clustering over a WAN">jon at jbrisbin.com
       </A><BR>
    <I>Mon Feb 28 16:37:04 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011516.html">[rabbitmq-discuss] Clustering over a WAN
</A></li>
        <LI>Next message: <A HREF="011522.html">[rabbitmq-discuss] Clustering over a WAN
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11518">[ date ]</a>
              <a href="thread.html#11518">[ thread ]</a>
              <a href="subject.html#11518">[ subject ]</a>
              <a href="author.html#11518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Would any of these issues be resolved by using a distributed K/V store as the backend for both messages and metadata? I know the internals of using mnesia to store all that metadata can't easily be abstracted, but if you didn't have that particular hurdle to jump, would that make clustering any easier?

Jon Brisbin

<A HREF="http://jbrisbin.com">http://jbrisbin.com</A>
Twitter: @j_brisbin


On Feb 28, 2011, at 9:51 AM, Matthew Sackman wrote:

&gt;<i> On Mon, Feb 28, 2011 at 03:27:42PM +0000, Chris Hampson wrote:
</I>&gt;&gt;<i> We're currently attempting to maintain a RabbitMQ cluster over a WAN between some of our sites, 2 in the US, one in the UK and another in India.
</I>&gt;<i> 
</I>&gt;<i> That's a bad idea.
</I>&gt;<i> 
</I>&gt;&gt;<i> For the most part this seems to be working fine, but it seems a little fragile and we can't seem to get it to recover from failures very well.
</I>&gt;<i> 
</I>&gt;<i> Correct. Mnesia, which Rabbit uses to store all sorts of data (though
</I>&gt;<i> not messages), copes poorly with network partitions.
</I>&gt;<i> 
</I>&gt;&gt;<i> If anyone can provide any advice to aid our situation we'd be most
</I>&gt;&gt;<i> grateful (even if it is &quot;don't do that you loony, separate them out
</I>&gt;&gt;<i> and shovel messages between sites when necessary&quot;)
</I>&gt;<i> 
</I>&gt;<i> Yeah, the latter's a fair summary of my advice on this ;) We do state
</I>&gt;<i> quite prominantly that clustering is not for HA, though I admit we state
</I>&gt;<i> it on <A HREF="http://www.rabbitmq.com/pacemaker.html">http://www.rabbitmq.com/pacemaker.html</A> rather than
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/clustering.html">http://www.rabbitmq.com/clustering.html</A> which is not really as helpful
</I>&gt;<i> as it could be.
</I>&gt;<i> 
</I>&gt;<i> The problem is that mnesia, and by extension Rabbit, goes for the
</I>&gt;<i> Consistency and Availability part of the CAP triangle, and so just does
</I>&gt;<i> not cope well with partitions ocurring.
</I>&gt;<i> <A HREF="http://en.wikipedia.org/wiki/CAP_theorem">http://en.wikipedia.org/wiki/CAP_theorem</A>
</I>&gt;<i> 
</I>&gt;<i> We are working on solving some of these problems in a number of
</I>&gt;<i> different ways. If the shovel is a viable solution then I'd recommend
</I>&gt;<i> you use that, otherwise please let us know some more details of your use
</I>&gt;<i> case and we should be able to advise further.
</I>&gt;<i> 
</I>&gt;<i> Best wishes,
</I>&gt;<i> 
</I>&gt;<i> Matthew
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011516.html">[rabbitmq-discuss] Clustering over a WAN
</A></li>
	<LI>Next message: <A HREF="011522.html">[rabbitmq-discuss] Clustering over a WAN
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11518">[ date ]</a>
              <a href="thread.html#11518">[ thread ]</a>
              <a href="subject.html#11518">[ subject ]</a>
              <a href="author.html#11518">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
