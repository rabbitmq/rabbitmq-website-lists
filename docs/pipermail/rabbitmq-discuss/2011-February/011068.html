<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pulling RabbitMQ out of service
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pulling%20RabbitMQ%20out%20of%20service&In-Reply-To=%3C20110204131044.GM15733%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011065.html">
   <LINK REL="Next"  HREF="011069.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pulling RabbitMQ out of service</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pulling%20RabbitMQ%20out%20of%20service&In-Reply-To=%3C20110204131044.GM15733%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Pulling RabbitMQ out of service">matthew at rabbitmq.com
       </A><BR>
    <I>Fri Feb  4 13:10:45 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011065.html">[rabbitmq-discuss] AMQP	Java	Client	on	http://repo2.maven.org/maven2/com/rabbitmq/amqp-client/
</A></li>
        <LI>Next message: <A HREF="011069.html">[rabbitmq-discuss] Pulling RabbitMQ out of service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11068">[ date ]</a>
              <a href="thread.html#11068">[ thread ]</a>
              <a href="subject.html#11068">[ subject ]</a>
              <a href="author.html#11068">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Jan 31, 2011 at 07:26:34AM -0800, Bill Moseley wrote:
&gt;<i> For those of you running multiple RabbitMQ servers in a cluster, what is
</I>&gt;<i> your procedure when you want to shut one of the servers down (e.g. for
</I>&gt;<i> maintenance) but not disrupt overall service?   Queues only live on one
</I>&gt;<i> server so I'm wondering how (or if) you do something to flush out the queue
</I>&gt;<i> before stopping the machine.
</I>
Usual best practise is to force clients to reconnect elsewhere,
recreating the resources they need. This may need some careful thought
with ordering of events etc. Frequent best practise is that publishers
create exchanges, and consumers create the queues they need and bind
them as necessary. To avoid missing any messages you'll need to start up
new consumers before taking down the old ones. But they must create new
queues, not on the to-die node. So this requires the queue names must be
fresh, but then you're going to have to deal with the possibilities of
duplicate messages during the period that multiple sets of consumers are
up etc.

The &quot;or-else&quot; routing semantics of RabbitMQ's &quot;Alternate Exchanges&quot; may
well be of use here.
<A HREF="http://www.rabbitmq.com/extensions.html#alternate-exchange">http://www.rabbitmq.com/extensions.html#alternate-exchange</A>

&gt;<i> Now, this is a bit tougher: How about catastrophic failures?  I'm wondering
</I>&gt;<i> about using the complexity of Pacemaker and DRBD vs. tracking incomplete
</I>&gt;<i> jobs and resubmitting after some time.
</I>
Horses for courses really. We know of a number of clients who are using
the pacemaker stuff, though frequently with NAS/SAN rather than DRBD. If
you can work out what failures you can withstand and what you can't and
then pick the best approach to match.

Matthew
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011065.html">[rabbitmq-discuss] AMQP	Java	Client	on	http://repo2.maven.org/maven2/com/rabbitmq/amqp-client/
</A></li>
	<LI>Next message: <A HREF="011069.html">[rabbitmq-discuss] Pulling RabbitMQ out of service
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11068">[ date ]</a>
              <a href="thread.html#11068">[ thread ]</a>
              <a href="subject.html#11068">[ subject ]</a>
              <a href="author.html#11068">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
