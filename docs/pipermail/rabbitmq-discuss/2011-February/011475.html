<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20code%20404%20NOT_FOUND%20when%20declaring%20a%0A%20queue%20in%20a%20clustered%20server%20%28using%20.NET%20client%29&In-Reply-To=%3C20110225111700.GF2332%40dakota.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011482.html">
   <LINK REL="Next"  HREF="011478.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20code%20404%20NOT_FOUND%20when%20declaring%20a%0A%20queue%20in%20a%20clustered%20server%20%28using%20.NET%20client%29&In-Reply-To=%3C20110225111700.GF2332%40dakota.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)">alexandru at rabbitmq.com
       </A><BR>
    <I>Fri Feb 25 11:17:00 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011482.html">[rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)
</A></li>
        <LI>Next message: <A HREF="011478.html">[rabbitmq-discuss] embedded rabbitmq-c client + openssl/openvpn
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11475">[ date ]</a>
              <a href="thread.html#11475">[ thread ]</a>
              <a href="subject.html#11475">[ subject ]</a>
              <a href="author.html#11475">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

In a cluster, if a there's a durable queue on a down'ed node,
redeclaring that queue on another node will fail with NOT_FOUND.  The
only way to solve this is to bring back up the node holding the queue.

This seems to be what you're seeing, but you say all the queues were
declared on the online node.  Are you sure that's the case?

Does bringing the other node up solve the problem? 

Once up, can you delete the queue, redeclare it on SERVER_1, take down
SERVER_2 again and check if the problem still happens?

BTW, in the next message, you seem to have reversed SERVER_1 and
SERVER_2.

Cheers,
Alex

On Fri, Feb 25, 2011 at 11:57:25AM +0100, Alfonso Pantoja wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Today I've got a code=404  NOT_FOUND  error when declaring a queue in a
</I>&gt;<i> clustered server.
</I>&gt;<i> We have 2 servers in that cluster. SERVER_1 and SERVER_2.
</I>&gt;<i> The message reported that the queue the consumer wanted to declare didn't
</I>&gt;<i> exist which hasn't too much sense...
</I>&gt;<i> 
</I>&gt;<i> The AMQP operation
</I>&gt;<i> was interrupted: AMQP close-reason, initiated by Peer, code=404,
</I>&gt;<i> text=&quot;NOT_FOUND - no queue  'alfonsoqueue' in vhost '/'&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> SERVER_2 was offline and the .NET consumer tried to connect to SERVER1 (we
</I>&gt;<i> don't use the array of addresses feature, we point the consumer directly to
</I>&gt;<i> one single server).
</I>&gt;<i> The queues were created on server SERVER_1 and there were no queues in
</I>&gt;<i>  webadmin queue listing of SERVER_2.
</I>&gt;<i> 
</I>&gt;<i> By the way all our queues and exchanges are durable and the first thing the
</I>&gt;<i> consumer do is to a
</I>&gt;<i> channel.DeclareQueue(name=queue_name, durable=true)
</I>&gt;<i> In the source code I see this declaration is performed using nowait=false,
</I>&gt;<i> exclusive=false...
</I>&gt;<i> 
</I>&gt;<i> My
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011482.html">[rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)
</A></li>
	<LI>Next message: <A HREF="011478.html">[rabbitmq-discuss] embedded rabbitmq-c client + openssl/openvpn
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11475">[ date ]</a>
              <a href="thread.html#11475">[ thread ]</a>
              <a href="subject.html#11475">[ subject ]</a>
              <a href="author.html#11475">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
