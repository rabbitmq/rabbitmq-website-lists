<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Losing messages, why?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Losing%20messages%2C%20why%3F&In-Reply-To=%3C36051298913090%40web35.yandex.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011533.html">
   <LINK REL="Next"  HREF="011523.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Losing messages, why?</H1>
    <B>DOBRO Sergei</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Losing%20messages%2C%20why%3F&In-Reply-To=%3C36051298913090%40web35.yandex.ru%3E"
       TITLE="[rabbitmq-discuss] Losing messages, why?">vertolet666 at yandex.ru
       </A><BR>
    <I>Mon Feb 28 17:11:29 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011533.html">[rabbitmq-discuss] Clustering over a WAN
</A></li>
        <LI>Next message: <A HREF="011523.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11521">[ date ]</a>
              <a href="thread.html#11521">[ thread ]</a>
              <a href="subject.html#11521">[ subject ]</a>
              <a href="author.html#11521">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

I can confirm that the issue is not resolved yet.
Those queues which have messages_ready are not relevant to the case because all of them are bound to the other (fanout) exchange. Each worker's queue is bound to another direct exchange with its own routing key.

I've noticed that the issue occurs chiefly when the worker's queue is in heavy load state.

But when the workers stop receving messages, none of their queues have messages_ready or messages_unacknowledged.
Here is the output I've saved when it happened last time.

# rabbitmqctl list_queues name messages messages_ready messages_unacknowledged |grep daemon
daemon-8698-1298682602  0       0       0
daemon-8711-1298682602  0       0       0
daemon-8700-1298682602  0       0       0
daemon-8699-1298682602  0       0       0
daemon-8704-1298682602  0       0       0
daemon-8710-1298682602  0       0       0
daemon-8706-1298682602  0       0       0
daemon-8702-1298682602  0       0       0
daemon-8701-1298682602  0       0       0
daemon-8707-1298682602  0       0       0

The full output of rabbitmqctl list_{exchanges,queues,bindings,consumers,connections,channels} I have published here:
<A HREF="http://old.nabble.com/Losing-messages%2C-why--td30958766.html">http://old.nabble.com/Losing-messages%2C-why--td30958766.html</A>

BTW, workers are Perl (Net::RabbitMQ) clients. Does it matter?

Thanks a lot for your support!

DOBRO.

28.02.2011, 18:13, &quot;Matthias Radestock&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;:
&gt;<i> On 26/02/11 10:32, DOBRO wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> &#160;Now I understand why messages_ready in some queues grow up in time.
</I>&gt;&gt;<i> &#160;That's because of connection was closed not properly.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;Actually, these queues disappear later.
</I>&gt;<i>
</I>&gt;<i> So is there still a problem? Has the original &quot;some workers stop
</I>&gt;<i> receiving messages from some queues&quot; issue been resolved?
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I></PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011533.html">[rabbitmq-discuss] Clustering over a WAN
</A></li>
	<LI>Next message: <A HREF="011523.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11521">[ date ]</a>
              <a href="thread.html#11521">[ thread ]</a>
              <a href="subject.html#11521">[ subject ]</a>
              <a href="author.html#11521">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
