<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Losing messages, why?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Losing%20messages%2C%20why%3F&In-Reply-To=%3CF78BCF638F95D74A99D036114107EDB5023948CF4F%40EXCH-MBX-3.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011416.html">
   <LINK REL="Next"  HREF="011421.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Losing messages, why?</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Losing%20messages%2C%20why%3F&In-Reply-To=%3CF78BCF638F95D74A99D036114107EDB5023948CF4F%40EXCH-MBX-3.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Losing messages, why?">jerryk at vmware.com
       </A><BR>
    <I>Tue Feb 22 22:36:40 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011416.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
        <LI>Next message: <A HREF="011421.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11419">[ date ]</a>
              <a href="thread.html#11419">[ thread ]</a>
              <a href="subject.html#11419">[ subject ]</a>
              <a href="author.html#11419">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Invoking
</I>&gt;<i> rabbitmqctl list_queues name messages messages_ready messages_unacknowledged
</I>&gt;<i>
</I>&gt;<i> I get (for most of queues):
</I>&gt;<i> queue_name_1 0 0 0
</I>
That looks good.  That's either a queue to which nobody is publishing,
or one that's being consumed from at a brisk enough rate that nothing
is being left behind, either ready to be delivered to clients, or
already delivered to a client but not yet acknowledged.

&gt;<i> and for some queues:
</I>&gt;<i> queue_name_2 239 239 0
</I>&gt;<i>
</I>&gt;<i> i.e. &quot;messages&quot; and &quot;messages_ready&quot; are greater than zero, but
</I>&gt;<i> &quot;messages_unacknowledged&quot; are always the same (0).
</I>
I think earlier in the thread we established that all of your
consumers are consuming with noAck=true, so therefore everything
should be getting ACK-ed as its consumed.  That would be consistent
with what we're seeing here, since there are no messages being
reported as unacknowledged by rabbitmqctl.  On the other hand, since a
message has to be delivered before it can be ACK-ed, one would also
think that the messages_ready (the second column from the right in
your output) should also read zero.

Has, perhaps, one of your consumers died?  Or become busy and stopped
consuming and acking from queue_name_2?

To investigate try:

rabbitmqctl list_consumers

That will show you the names of your queues, the id's of the channel
processes that created and now own the subscriptions, and tags that
let you identify a subscription within the channel.  You'll also be
reminded there about whether or not ACKs are expected for messages
going to that consumer, but since you have nothing un-ACKed above, you
don't seem to be having a problem with this.

Best regards,
Jerry
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011416.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
	<LI>Next message: <A HREF="011421.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11419">[ date ]</a>
              <a href="thread.html#11419">[ thread ]</a>
              <a href="subject.html#11419">[ subject ]</a>
              <a href="author.html#11419">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
