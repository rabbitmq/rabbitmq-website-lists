<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] socket error while using rabbitmq and a NAT	(Network address translation)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20socket%20error%20while%20using%20rabbitmq%20and%20a%20NAT%0A%09%28Network%20address%20translation%29&In-Reply-To=%3CAANLkTinD1gHsHGZmWNr%2BKY-k_khXQgTBin%2B25kuLvDhe%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011491.html">
   <LINK REL="Next"  HREF="011511.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] socket error while using rabbitmq and a NAT	(Network address translation)</H1>
    <B>mysurf mail</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20socket%20error%20while%20using%20rabbitmq%20and%20a%20NAT%0A%09%28Network%20address%20translation%29&In-Reply-To=%3CAANLkTinD1gHsHGZmWNr%2BKY-k_khXQgTBin%2B25kuLvDhe%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] socket error while using rabbitmq and a NAT	(Network address translation)">stammailbox at gmail.com
       </A><BR>
    <I>Sun Feb 27 13:06:58 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011491.html">[rabbitmq-discuss] Missing erlang functions?
</A></li>
        <LI>Next message: <A HREF="011511.html">[rabbitmq-discuss] socket error while using rabbitmq and a NAT (Network address translation)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11494">[ date ]</a>
              <a href="thread.html#11494">[ thread ]</a>
              <a href="subject.html#11494">[ subject ]</a>
              <a href="author.html#11494">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi ,
I am writing a new mail because my last issue was solved .
It is just that on a certain computer my application stopped working.
So it is a new issue and I will explain and paste the exception below.

Basically, I did three things :
1. I upgraded from 1.7.0 to 2.3.1 (installed a new erlang also)
2. I upgraded the client jars
3. changed the protocol to ack = true;

channel.basicConsume(queueName, true, queueingConsumer);

well, that certain computer is behind a firewall, and has a NAT (Network
Address Translation ).
It did work prior to the upgrade with the NAT (mySQL also handles it pretty
well).
with the same ports.
Maybe it is the bidirectional channel (since I added acking? I dont think
so...).

what I can see is that.
when the client tries to connect it writes in the logs

Connection closed abruptly

And now, behold, the exception :

PlatformException: com.rabbitmq.client.ShutdownSignalException:
connection error; reason: java.net.SocketException: Connection reset
	at com.rabbitmq.client.impl.AMQConnection.shutdown(AMQConnection.java:588)
	at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:454)
Caused by: com.rabbitmq.client.ShutdownSignalException: connection
error; reason: java.net.SocketException: Connection reset
	... 2 more
Caused by: java.net.SocketException: Connection reset
	at java.net.SocketInputStream.read(Unknown Source)
	at java.io.BufferedInputStream.fill(Unknown Source)
	at java.io.BufferedInputStream.read(Unknown Source)
	at java.io.DataInputStream.readUnsignedByte(Unknown Source)
	at com.rabbitmq.client.impl.Frame.readFrom(Frame.java:117)
	at com.rabbitmq.client.impl.SocketFrameHandler.readFrame(SocketFrameHandler.java:151)
	at com.rabbitmq.client.impl.AMQConnection.readFrame(AMQConnection.java:379)
	at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:420)
11:21:41,187 WARN  SoundUtil - Error in playing sound : emergency
com.google.common.collect.ComputationException:
com.barak.capital.model.exception.PlatformException: Error loading
sound : emergency.wav, from file.
	at com.google.common.collect.MapMaker$StrategyImpl.compute(MapMaker.java:602)
	at com.google.common.collect.MapMaker$StrategyImpl.compute(MapMaker.java:462)
	at com.google.common.collect.CustomConcurrentHashMap$ComputingImpl.get(CustomConcurrentHashMap.java:2045)
	at com.programa17.mmm.utils.SoundUtil$2.call(SoundUtil.java:115)
	at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
	at java.util.concurrent.FutureTask.run(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.lang.Thread.run(Unknown Source)
Caused by: com.barak.capital.model.exception.PlatformException: Error
loading sound : emergency.wav, from file.
	at com.programa17.mmm.utils.SoundUtil$1.apply(SoundUtil.java:97)
	at com.programa17.mmm.utils.SoundUtil$1.apply(SoundUtil.java:77)
	at com.google.common.collect.MapMaker$StrategyImpl.compute(MapMaker.java:592)
	... 8 more
Caused by: java.io.FileNotFoundException: emergency.wav (The system
cannot find the file specified)
	at java.io.FileInputStream.open(Native Method)
	at java.io.FileInputStream.&lt;init&gt;(Unknown Source)
	at com.sun.media.sound.WaveFileReader.getAudioInputStream(Unknown Source)
	at javax.sound.sampled.AudioSystem.getAudioInputStream(Unknown Source)
	at com.programa17.mmm.utils.SoundUtil$1.apply(SoundUtil.java:81)
	... 10 more
11:21:41,187 ERROR CentralExceptionHandler - central exception handler
:<i> warning found :
</I>
Any Idea? thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110227/65d813e4/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110227/65d813e4/attachment.htm</A>&gt;
</PRE>




































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011491.html">[rabbitmq-discuss] Missing erlang functions?
</A></li>
	<LI>Next message: <A HREF="011511.html">[rabbitmq-discuss] socket error while using rabbitmq and a NAT (Network address translation)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11494">[ date ]</a>
              <a href="thread.html#11494">[ thread ]</a>
              <a href="subject.html#11494">[ subject ]</a>
              <a href="author.html#11494">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
