<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java handleShutdownSignal startegy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20handleShutdownSignal%20startegy&In-Reply-To=%3C4D60502A.9040309%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011189.html">
   <LINK REL="Next"  HREF="011193.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java handleShutdownSignal startegy</H1>
    <B>Rob Harrop</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20handleShutdownSignal%20startegy&In-Reply-To=%3C4D60502A.9040309%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Java handleShutdownSignal startegy">rob at rabbitmq.com
       </A><BR>
    <I>Sat Feb 19 23:20:10 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011189.html">[rabbitmq-discuss] Java handleShutdownSignal startegy
</A></li>
        <LI>Next message: <A HREF="011193.html">[rabbitmq-discuss] Web server error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11336">[ date ]</a>
              <a href="thread.html#11336">[ thread ]</a>
              <a href="subject.html#11336">[ subject ]</a>
              <a href="author.html#11336">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Abishek,

I think the best strategy will depend on how many consumers you have per 
connection and whether you want multiple consumers (if you have them) to 
reconnect independently if their channel dies.

If you want to handle channel death on a per consumer basis, then using 
handleShutdownSignal on Consumer is fine. You'll need to make sure that 
when you open a new channel as part of the retry that you have moved 
work off the connection thread. Basically, you need to start a new 
thread in handleShutdownSignal before starting to interact with the 
connection.

I think a better solution is to use a ShutdownListener that can be 
attached to either the channel or the connection (or both). This is 
slightly more robust because it will allow retry to happen if the 
consumer hasn't yet been created (maybe there is an intermittent failure 
during startup).

Regards,

Rob

Abhishek Kona wrote:
&gt;<i> Abishek,
</I>&gt;<i>
</I>&gt;<i> I think the best strategy will depend on how many consumers you have per
</I>&gt;<i> connection and whether you want multiple consumers (if you have them) to
</I>&gt;<i> reconnect independently if their channel dies.
</I>&gt;<i>
</I>&gt;<i> If you want to handle channel death on a per consumer basis, then using
</I>&gt;<i> handleShutdownSignal on Consumer is fine. You'll need to make sure that
</I>&gt;<i> when you open a new channel as part of the retry that you have moved
</I>&gt;<i> work off the connection thread. Basically, you need to start a new
</I>&gt;<i> thread in handleShutdownSignal before starting to interact with the
</I>&gt;<i> connection.
</I>&gt;<i>
</I>&gt;<i> I think a better solution is to use a ShutdownListener that can be
</I>&gt;<i> attached to either the channel or the connection (or both). This is
</I>&gt;<i> slightly more robust because it will allow retry to happen if the
</I>&gt;<i> consumer hasn't yet been created (maybe there is an intermittent failure
</I>&gt;<i> during startup).
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Rob
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011189.html">[rabbitmq-discuss] Java handleShutdownSignal startegy
</A></li>
	<LI>Next message: <A HREF="011193.html">[rabbitmq-discuss] Web server error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11336">[ date ]</a>
              <a href="thread.html#11336">[ thread ]</a>
              <a href="subject.html#11336">[ subject ]</a>
              <a href="author.html#11336">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
