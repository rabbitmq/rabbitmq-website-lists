<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AMQP%200.9.1%20Specification%3A%20Suport%20for%20Deliver%0A%20API&In-Reply-To=%3C4D4FC52A.3010605%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011097.html">
   <LINK REL="Next"  HREF="011135.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver API</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20AMQP%200.9.1%20Specification%3A%20Suport%20for%20Deliver%0A%20API&In-Reply-To=%3C4D4FC52A.3010605%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver API">emile at rabbitmq.com
       </A><BR>
    <I>Mon Feb  7 10:10:50 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011097.html">[rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver API
</A></li>
        <LI>Next message: <A HREF="011135.html">[rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver	API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11101">[ date ]</a>
              <a href="thread.html#11101">[ thread ]</a>
              <a href="subject.html#11101">[ subject ]</a>
              <a href="author.html#11101">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Prashant,

On 06/02/11 21:00, Prashant wrote:
&gt;<i> Helo,
</I>&gt;<i>
</I>&gt;<i> I was stuck while trying to use deliver option in channel. Now , in my
</I>&gt;<i> experiment , I am trying to use basicRecover to republish all the
</I>&gt;<i> unack messages back to the channel. These messages gets again repub ,
</I>&gt;<i> so far so good. But i fear , it might go into a loop as ,when Consumer
</I>&gt;<i> cannot consume messages it will be returned back to channel.
</I>&gt;<i>
</I>&gt;<i> I looked into Spec refrence and found out that channel has a deliver
</I>&gt;<i> mechanism , which basically checks for relivered bit .
</I>&gt;<i> Per specification-----
</I>&gt;<i> This method delivers a message to the client, via a consumer. In the
</I>&gt;<i> asynchronous message delivery model, the client starts a consumer
</I>&gt;<i> using the Consume method, then the server responds with Deliver
</I>&gt;<i> methods as and when messages arrive for that consumer.
</I>&gt;<i>
</I>&gt;<i>      * The server SHOULD track the number of times a message has been
</I>&gt;<i> delivered to clients and when a message is redelivered a certain
</I>&gt;<i> number of times - e.g. 5 times - without being acknowledged, the
</I>&gt;<i> server SHOULD consider the message to be unprocessable (possibly
</I>&gt;<i> causing client applications to abort), and move the message to a dead
</I>&gt;<i> letter queue.
</I>&gt;<i> -------
</I>&gt;<i> Now , my question is how I can leverage this , i.e.  if messge is
</I>&gt;<i> redelivered 5 times to channel , I intend to publish a message about
</I>&gt;<i> the status of this message with specifics that it has been failed
</I>&gt;<i> after trying 5 times...
</I>&gt;<i> If , its pssible , where do I need to add the logic to check this,
</I>&gt;<i> certainly now publisher as the messages are in channel.Can you please
</I>&gt;<i> throw in some pointers.
</I>
The specification does indeed suggest that a broker should track the 
number of redeliveries. You can get more details about conformance for 
this feature on the specification page:

  <A HREF="http://www.rabbitmq.com/specification.html">http://www.rabbitmq.com/specification.html</A>

The feature that you describe has reference &quot;basic / deliver / 01&quot; and 
is mark as &quot;planned&quot;, which means that it has not been implemented yet. 
It is possible to get similar functionality without broker support though.

A possible way to deal with your scenario is to republish 
non-processable messages to a different queue instead of leaving them 
unacknowledged. You might even republish messages together with the 
cause of failure to aid the decision about their fate.

Another option might be to publish messages initially with a processing 
count of 0. Each time a consumer fails to publish the message, republish 
the message to the same queue with an incremented processing count 
instead of leaving the message unacknowledged. When the processing count 
reaches 5 then you can take appropriate action.

Regards

Emile


</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011097.html">[rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver API
</A></li>
	<LI>Next message: <A HREF="011135.html">[rabbitmq-discuss] AMQP 0.9.1 Specification: Suport for Deliver	API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11101">[ date ]</a>
              <a href="thread.html#11101">[ thread ]</a>
              <a href="subject.html#11101">[ subject ]</a>
              <a href="author.html#11101">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
