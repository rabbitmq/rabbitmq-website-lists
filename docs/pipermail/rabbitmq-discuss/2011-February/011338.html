<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] recording all messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20recording%20all%20messages&In-Reply-To=%3C4D60FFF6.7090001%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011337.html">
   <LINK REL="Next"  HREF="011325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] recording all messages</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20recording%20all%20messages&In-Reply-To=%3C4D60FFF6.7090001%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] recording all messages">matthias at rabbitmq.com
       </A><BR>
    <I>Sun Feb 20 11:50:14 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011337.html">[rabbitmq-discuss] recording all messages
</A></li>
        <LI>Next message: <A HREF="011325.html">[rabbitmq-discuss] Naming RabbitMQ nodes with complete domain names
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11338">[ date ]</a>
              <a href="thread.html#11338">[ thread ]</a>
              <a href="subject.html#11338">[ subject ]</a>
              <a href="author.html#11338">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jim, James,

James Carr wrote:
&gt;<i> On Fri, Feb 18, 2011 at 6:31 PM, Jim Irrer &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">irrer at umich.edu</A>&gt; wrote:
</I>&gt;&gt;<i> Is there a RabbitMQ plugin for recording all AMQP messages?  I was thinking
</I>&gt;&gt;<i> in terms of a development tool for diagnosing problems (knowing that it
</I>&gt;&gt;<i> would
</I>&gt;&gt;<i> be a huge drag on the system).
</I> &gt;
&gt;<i> I have actually been wondering the same thing. It'd be interesting to
</I>&gt;<i> know if there is a way to implement an EIP style wiretap outside of
</I>&gt;<i> just creating a queue for the routing key of the messages I want to
</I>&gt;<i> watch.
</I>
I can think of at least five ways of doing that:

1) tap into the network stream with wireshark, which understands AMQP.

2) insert a logging AMQP proxy. Writing AMQP proxies is really quite 
straightforward. See, for example, rabbit's tracer 
(<A HREF="http://www.rabbitmq.com/examples.html#tracer">http://www.rabbitmq.com/examples.html#tracer</A>).

3) Bind a logging queue to the various exchanges that messages get 
published to, with the same binding keys as the other queues in the 
system, and log messages from an AMQP client consuming from that queue. 
This only works for fairly static configurations, i.e. where the 
exchanges, queues and their bindings are known in advance. And it cannot 
log messages sent to the default exchange, since that does not permit 
explicit bindings.

4) As 3), but create fanout exchange intermediaries for all exchanges, 
bind the aforementioned logging queue to that and bind the real 
exchanges to the intermediaries with exchange-to-exchange bindings. The 
advantage over 3) is that the logging queue only needs one binding to 
each intermediate exchange. Hence this can cope with dynamic queue 
creation &amp; binding. However, publishers will need modifying to publish 
to the intermediate exchanges.

5) write a rabbit plugin that taps into rabbit's internal message 
routing APIs using Erlang's tracing functionality.


Regards,

Matthias.
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011337.html">[rabbitmq-discuss] recording all messages
</A></li>
	<LI>Next message: <A HREF="011325.html">[rabbitmq-discuss] Naming RabbitMQ nodes with complete domain names
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11338">[ date ]</a>
              <a href="thread.html#11338">[ thread ]</a>
              <a href="subject.html#11338">[ subject ]</a>
              <a href="author.html#11338">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
