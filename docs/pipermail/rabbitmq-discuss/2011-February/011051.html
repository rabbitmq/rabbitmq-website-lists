<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 2.3.1 Release
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.3.1%20Release&In-Reply-To=%3C20110203144528.GI15733%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011049.html">
   <LINK REL="Next"  HREF="011053.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 2.3.1 Release</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.3.1%20Release&In-Reply-To=%3C20110203144528.GI15733%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ 2.3.1 Release">matthew at rabbitmq.com
       </A><BR>
    <I>Thu Feb  3 14:45:29 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011049.html">[rabbitmq-discuss] RabbitMQ 2.3.1 Release
</A></li>
        <LI>Next message: <A HREF="011053.html">[rabbitmq-discuss] RabbitMQ 2.3.1 Release
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11051">[ date ]</a>
              <a href="thread.html#11051">[ thread ]</a>
              <a href="subject.html#11051">[ subject ]</a>
              <a href="author.html#11051">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Feb 03, 2011 at 02:22:14PM +0000, Simon MacMullen wrote:
&gt;<i> The RabbitMQ team is pleased to announce the release of RabbitMQ
</I>&gt;<i> 2.3.1.
</I>&gt;<i> 
</I>&gt;<i> This release fixes a small number of bugs, in particular one serious
</I>&gt;<i> bug in 2.3.0 which could lead to queue processes crashing.
</I>
As a result of the severity of the bug that's been fixed, we do not
advise anyone to use 2.3.0.

The bug fixed is a race condition that can cause any queue to violate an
enforced invariant of the queue during an AMQP transaction commit. If
the invariant is violated, then the queue will crash instantly, losing
all non-persisted messages within the queue.

The bug was introduced in the process of fixing another bug - a bug that
had existed since the 2.0.0 release, and which could lead, in the event
of a crash, to more persistent messages being lost than should be. To
explain that a little further: persistent messages are not written to
disk immediately because there may be opportunities to optimise out the
write completely, and additionally it is not performant to issue lots of
tiny I/O write operations. Consequently, there are various caches, and
timeouts which ensure that messages that are being written to disk are
done so promptly enough but also efficiently enough. The bug found was
that one of the timers related to this process was not being reset
correctly. As a result, a long period of time could occur before
messages were pushed out to disk in some cases, leading to a bigger
window for messages to be potentially lost in. This would affect not
just how messages are pushed to disk in the case of memory pressure, but
also latency of transaction commits, and probably some scenarios too.

In fixing this bug, the critical bug discovered in 2.3.0 was
accidentally introduced. Both bugs do not exist in 2.3.1.

By being a race condition, it managed to not get triggered in testing.
Indeed even now, knowing where the bug lies, I have not been able to
trigger it.

I hope that sheds some light on the situation.

Matthew
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011049.html">[rabbitmq-discuss] RabbitMQ 2.3.1 Release
</A></li>
	<LI>Next message: <A HREF="011053.html">[rabbitmq-discuss] RabbitMQ 2.3.1 Release
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11051">[ date ]</a>
              <a href="thread.html#11051">[ thread ]</a>
              <a href="subject.html#11051">[ subject ]</a>
              <a href="author.html#11051">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
