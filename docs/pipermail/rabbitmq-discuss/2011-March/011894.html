<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-server init script
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-server%20init%20script&In-Reply-To=%3C20110317102955.GA2365%40dakota.doc.ic.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011875.html">
   <LINK REL="Next"  HREF="011916.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-server init script</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-server%20init%20script&In-Reply-To=%3C20110317102955.GA2365%40dakota.doc.ic.ac.uk%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-server init script">alexandru at rabbitmq.com
       </A><BR>
    <I>Thu Mar 17 10:29:55 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011875.html">[rabbitmq-discuss] rabbitmq-server init script
</A></li>
        <LI>Next message: <A HREF="011916.html">[rabbitmq-discuss] rabbitmq-server init script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11894">[ date ]</a>
              <a href="thread.html#11894">[ thread ]</a>
              <a href="subject.html#11894">[ subject ]</a>
              <a href="author.html#11894">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm having trouble reproducing this.

On a fresh Centos install, the RPM does what it's supposed to do (and what
you say it does).  In /var/log/rabbitmq, there are some log files owned by
root and some owned by rabbitmq, but the root files are only ever accessed
by the init script, and that should be fine.

Is this what you're seeing?

  Starting rabbitmq-server: /etc/init.d/rabbitmq-server: line 43:
  /var/log/rabbitmq/startup_log: Permission denied
  TIMEOUT - check /var/log//rabbitmq/startup_{log,err}
  rabbitmq_server.

If so, are you starting the service as a non-root user?

Cheers,
Alex

On Wed, Mar 16, 2011 at 11:28:20AM -0700, paul wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mar 16, 5:16&#160;am, Alexandru Scvor??ov &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexan... at rabbitmq.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; &gt; chown -R $USER:$USER $INIT_LOG_DIR
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; That's interesting. &#160;Did you add some code to run rabbitmq as non-root?
</I>&gt;<i> 
</I>&gt;<i> nope.
</I>&gt;<i> 
</I>&gt;<i> &gt; What is your INIT_LOG_DIR? (did you change it to a location that gets
</I>&gt;<i> &gt; wiped on restart?)
</I>&gt;<i> 
</I>&gt;<i> i installed from the RPM, which created the rabbitmq log directory in
</I>&gt;<i> the appropriate place, and with the appropriate ownership as
</I>&gt;<i> rabbitmq:rabbitmq - it's just that on restart apparently the logs
</I>&gt;<i> would be created owned by root which would block startup.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I see we don't automatically `mkdir $INIT_LOG_DIR` in the init script.
</I>&gt;<i> &gt; How are you creating it?
</I>&gt;<i> 
</I>&gt;<i> as above - was created at /var/log/rabbitmq by the rpm.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011875.html">[rabbitmq-discuss] rabbitmq-server init script
</A></li>
	<LI>Next message: <A HREF="011916.html">[rabbitmq-discuss] rabbitmq-server init script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11894">[ date ]</a>
              <a href="thread.html#11894">[ thread ]</a>
              <a href="subject.html#11894">[ subject ]</a>
              <a href="author.html#11894">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
