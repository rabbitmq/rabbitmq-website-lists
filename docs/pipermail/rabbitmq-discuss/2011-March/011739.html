<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] chunking a file to many messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20chunking%20a%20file%20to%20many%20messages&In-Reply-To=%3C4D77EDF4.20105%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011737.html">
   <LINK REL="Next"  HREF="011702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] chunking a file to many messages</H1>
    <B>Vlad Alexandru Ionescu</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20chunking%20a%20file%20to%20many%20messages&In-Reply-To=%3C4D77EDF4.20105%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] chunking a file to many messages">vlad at rabbitmq.com
       </A><BR>
    <I>Wed Mar  9 21:15:32 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011737.html">[rabbitmq-discuss] chunking a file to many messages
</A></li>
        <LI>Next message: <A HREF="011702.html">[rabbitmq-discuss] Install error erlang not found but is installed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11739">[ date ]</a>
              <a href="thread.html#11739">[ thread ]</a>
              <a href="subject.html#11739">[ subject ]</a>
              <a href="author.html#11739">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

To answer 1:
A setup I could imagine would be to have a &quot;work queue&quot;, in which each 
message would consist of a file identifier and a queue name. Your 
servers can pick up jobs from this queue in a round-robin fashion. 
Whenever you want to send a new file with your clients, you first 
declare a new queue for your file (let's call it &quot;file queue&quot;), and then 
publish a message to the &quot;work queue&quot; mentioned above (with the name of 
the &quot;file queue&quot;). Then you continue publishing bits of the file to the 
&quot;file queue&quot;. The servers that serve a job from the &quot;work queue&quot; would 
subscribe to the &quot;file queue&quot;, whose name was picked up from the job's 
message.

And to answer 2:
RabbitMQ guarantees ordering of the messages, as long as the messages in 
question follow the exact same path through the clients and the broker 
(same publisher, same exchange, same queue and same consumer). With the 
setup described above, you should be good to go without extra identifiers.

Hope that makes sense,
Vlad.


On 03/08/2011 09:52 PM, asaf david wrote:
&gt;<i> hello
</I>&gt;<i> I'm a RabbitMQ beginner. I need to handle a case where several clients 
</I>&gt;<i> can produce files for processing, which should be done in some 
</I>&gt;<i> servers. I've realized there is no native support for files transfers, 
</I>&gt;<i> so I'm going to chunk a produced file to many small messages are 
</I>&gt;<i> transfer them (similar to the answer given here 
</I>&gt;<i> &lt;<A HREF="https://groups.google.com/d/msg/rabbitmq-discuss/-G39l-JJtp4/OTSd9FUJdfEJ">https://groups.google.com/d/msg/rabbitmq-discuss/-G39l-JJtp4/OTSd9FUJdfEJ</A>&gt;), 
</I>&gt;<i> and reassemble them to a whole file at the server. However there are 
</I>&gt;<i> two points i'm not sure about:
</I>&gt;<i>
</I>&gt;<i>    1. How do i make sure that different messages that belong to the
</I>&gt;<i>       same file won't end up in different servers? I want a fair
</I>&gt;<i>       dispatching between the servers on a per-file base, not per-message
</I>&gt;<i>    2. How do I make sure that messages won't be reordered? should i
</I>&gt;<i>       attach an identifier to each message to mark it's location in
</I>&gt;<i>       the original file?
</I>&gt;<i>
</I>&gt;<i> thanks in advance :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110309/8aed0320/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110309/8aed0320/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011737.html">[rabbitmq-discuss] chunking a file to many messages
</A></li>
	<LI>Next message: <A HREF="011702.html">[rabbitmq-discuss] Install error erlang not found but is installed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11739">[ date ]</a>
              <a href="thread.html#11739">[ thread ]</a>
              <a href="subject.html#11739">[ subject ]</a>
              <a href="author.html#11739">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
