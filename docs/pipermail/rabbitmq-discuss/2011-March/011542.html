<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Losing messages, why?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Losing%20messages%2C%20why%3F&In-Reply-To=%3C295551298973551%40web84.yandex.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011537.html">
   <LINK REL="Next"  HREF="011543.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Losing messages, why?</H1>
    <B>DOBRO Sergei</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Losing%20messages%2C%20why%3F&In-Reply-To=%3C295551298973551%40web84.yandex.ru%3E"
       TITLE="[rabbitmq-discuss] Losing messages, why?">vertolet666 at yandex.ru
       </A><BR>
    <I>Tue Mar  1 09:59:10 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011537.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
        <LI>Next message: <A HREF="011543.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11542">[ date ]</a>
              <a href="thread.html#11542">[ thread ]</a>
              <a href="subject.html#11542">[ subject ]</a>
              <a href="author.html#11542">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>01.03.2011, 10:22, &quot;Matthias Radestock&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;:
&gt;<i> DOBRO Sergei wrote:
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> &#160;In the list_* output you sent, which consumers/queues are in the
</I>&gt;&gt;&gt;<i> &#160;&quot;broken&quot; state where their connected clients aren't receiving
</I>&gt;&gt;&gt;<i> &#160;messages?
</I>&gt;&gt;<i> &#160;All the consumers, queues, bindings and connections are present.
</I>&gt;<i>
</I>&gt;<i> Understood, but my question was *which specific* worker(s) (and their
</I>&gt;<i> associated consumers/queues) had stopped working at the time you ran
</I>&gt;<i> these commands?
</I>&gt;<i>
</I>
O.k., let me explain what is exactly going on. 
As I said, each worker declares a queue with its own routing key and starts consuming from that queue. All their queues are bound to the same exchange of direct type.
worker1 -&gt; queue1 -&gt; ex.direct (routing_key1),
worker2 -&gt; queue2 -&gt; ex.direct (routing_key2),
......
worker6 -&gt; queue6 -&gt; ex.direct (routing_key6),

There are six workers. Other clients publish messages to exchange &quot;ex.direct&quot; with the routing key which is determined randomly from the values of array (routing_key1, routing_key2, ...., routing_key6).
So, the workers receive messages randomly too. That's why I can not tell you which worker(s) stops receiving messages.

Now let me tell you why I'm using this stupid method :). Why &quot;stupid&quot;? Because it's a random (not round-robin) dispatching.
But, in my case it is more stable way. Yes, I have already tried to run workers consuming messages from the same queue, but the issue occured more often. So, having round-robin pattern (one queue) all the workers stop receiving messages at once.

&gt;<i>
</I>&gt;<i> If restarting them works fine then the problem is most certainly client
</I>&gt;<i> side.
</I>&gt;<i>
</I>&gt;<i> As I said, you may want to tap the network to check whether messages do
</I>&gt;<i> indeed still get sent to the broken workers.
</I>&gt;<i>
</I>RabbitMQ and the workers are running on the same machine. Each connection's IP is 127.0.0.1. Can you give me some advice? Which software to use to access the data flowing across the connection RabbitMQ&lt;-&gt;worker?

Thanks.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011537.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
	<LI>Next message: <A HREF="011543.html">[rabbitmq-discuss] Losing messages, why?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11542">[ date ]</a>
              <a href="thread.html#11542">[ thread ]</a>
              <a href="subject.html#11542">[ subject ]</a>
              <a href="author.html#11542">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
