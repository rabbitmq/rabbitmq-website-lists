<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Exchange and queue design/best practices for social event updates
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange%20and%20queue%20design/best%20practices%20for%0A%20social%20event%20updates&In-Reply-To=%3C4D8A080D.2040900%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011920.html">
   <LINK REL="Next"  HREF="011919.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Exchange and queue design/best practices for social event updates</H1>
    <B>Michael Bridgen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange%20and%20queue%20design/best%20practices%20for%0A%20social%20event%20updates&In-Reply-To=%3C4D8A080D.2040900%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Exchange and queue design/best practices for social event updates">mikeb at rabbitmq.com
       </A><BR>
    <I>Wed Mar 23 14:47:41 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011920.html">[rabbitmq-discuss] Exchange and queue design/best practices for	social event updates
</A></li>
        <LI>Next message: <A HREF="011919.html">[rabbitmq-discuss] server crashes with very fast consumers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11994">[ date ]</a>
              <a href="thread.html#11994">[ thread ]</a>
              <a href="subject.html#11994">[ subject ]</a>
              <a href="author.html#11994">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alex,

&gt;<i> The following is the basic requirements of our system:
</I>&gt;<i>
</I>&gt;<i> The whole application is called community.  Inside community we have groups.
</I>&gt;<i> In each group, user can have discussion topics within the group.
</I>&gt;<i> User can share file/resource to community.
</I>&gt;<i> There is a wall page for user.  Also there is a wall page for the group.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>[...]

&gt;<i>
</I>&gt;<i> This is my initial plan:
</I>
In general, mapping your application domain directly to a messaging 
system isn't a good approach.  Instead, you ought to determine what 
kinds of services your application needs from the messaging system, then 
work out how to implement them.

Usually the required services boil down to a fairly small set of 
messaging patterns.  These are explained in our tutorials:
<A HREF="http://www.rabbitmq.com/getstarted.html">http://www.rabbitmq.com/getstarted.html</A>

Software architecture is of course subject to fashion, but this book 
seems to be a fairly stable point: <A HREF="http://www.eaipatterns.com/">http://www.eaipatterns.com/</A>

&gt;<i> - planning to use *topic exchange* for that.
</I>
Topic exchanges make a good &quot;message bus&quot; stand-in, so that may be 
appropriate for notifications.

&gt;<i> - use queues binding such as ( #.self , #.friends, #.group,
</I>&gt;<i> #.groupmembers, #.otheractors )
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> But my concern is:
</I>&gt;<i>
</I>&gt;<i> -  how do we mix together the *TARGET* and *ACTION* so that one routing
</I>&gt;<i> key will cover all possible combination?
</I>
I think you will want different semantics for different actions, so I 
wouldn't lump them together.

For example, for updates, you really just want to queue things until you 
can process them; in this case, you'd use the work queue pattern, and 
send things directly to a particular queue.

&gt;<i> - do I require to send 2 messages with different routing keys to get the
</I>&gt;<i> possible combination?  (which I don't really want to since the publisher
</I>&gt;<i> will have too much knowledge about the business rule)
</I>
Yes, you will want to insulate the components that produce events from 
those that process them.  But inevitably, some components will want to 
accomplish more than one thing -- e.g., queue a job to resize a picture 
AND respond to the user -- in which case it may have to send more than 
one message.

&gt;<i> - Is it the right approach?  Or should I just have either of ACTION or
</I>&gt;<i> TARGET and have the consumer decide based on the event type?
</I>&gt;<i>
</I>&gt;<i> - What is the recommended number of exchanges for such situation?
</I>
Exchanges are cheap.  Just think of them as namespaces for routing.  So 
the answer is &quot;As many as you need&quot;.

&gt;<i> - Would be great if you could suggest the good naming practice for queue
</I>&gt;<i> and exchange.
</I>
For queues that are work queues, supply a name meaningful to your 
application.  For convenience, queues that are tied to a particular 
application resource and need to be durable, can be named for that 
resource -- e.g., &quot;&lt;user&gt;-notifications&quot;.  For any other queues, let the 
server name them.

For exchanges, supply a name meaningful to your application.


Kind regards,
Michael
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011920.html">[rabbitmq-discuss] Exchange and queue design/best practices for	social event updates
</A></li>
	<LI>Next message: <A HREF="011919.html">[rabbitmq-discuss] server crashes with very fast consumers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11994">[ date ]</a>
              <a href="thread.html#11994">[ thread ]</a>
              <a href="subject.html#11994">[ subject ]</a>
              <a href="author.html#11994">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
