<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] checking no of message in queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20checking%20no%20of%20message%20in%20queue&In-Reply-To=%3C4D88A3C6.2090807%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011970.html">
   <LINK REL="Next"  HREF="011974.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] checking no of message in queue</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20checking%20no%20of%20message%20in%20queue&In-Reply-To=%3C4D88A3C6.2090807%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] checking no of message in queue">emile at rabbitmq.com
       </A><BR>
    <I>Tue Mar 22 13:27:34 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011970.html">[rabbitmq-discuss] checking no of message in queue
</A></li>
        <LI>Next message: <A HREF="011974.html">[rabbitmq-discuss] RabbitMQ with halfword emulator in R14B02
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11973">[ date ]</a>
              <a href="thread.html#11973">[ thread ]</a>
              <a href="subject.html#11973">[ subject ]</a>
              <a href="author.html#11973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi cheepu,

Op 22/03/2011 10:34, het cheepu geskryf:
&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am using the QueueingConsumer
</I>
If you are using QueueingConsumer then the broker will deliver messages 
to the consumer, indepently from whether you dequeue them from the 
QueueingConsumer using nextDelivery(). That is why the number of 
messages is 0 in step 2.

I would suggest using the &quot;rabbitmqctl list_queues&quot; command to confirm 
that nextDelivery() makes no difference to the broker.

 &gt; and using the following code for the explicit acknowledgement
 &gt;
&gt;<i>   delivery = consumer.nextDelivery(500);
</I>&gt;<i> channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false);
</I>
This explicit message acknowledgement shows that you are not using 
auto-ack, as I previously thought.

&gt;<i> I am using java library for this and how can i get in this case the number
</I>&gt;<i> of messages?
</I>
Your previous sample code using passive queue declaration with 
getMessageCount() is correct.

---

As an aside, you can use QoS, which is a consumer-initiated means of 
flow control in this situation. Setting prefetchCount to 1 will prevent 
all messages from being sent to the QueueingConsumer immediately without 
acknowledgement. See the method spec here:

<A HREF="http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.qos">http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.qos</A>
<A HREF="http://www.rabbitmq.com/amqp-0-9-1-quickref.html#basic.qos">http://www.rabbitmq.com/amqp-0-9-1-quickref.html#basic.qos</A>


Regards

Emile


</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011970.html">[rabbitmq-discuss] checking no of message in queue
</A></li>
	<LI>Next message: <A HREF="011974.html">[rabbitmq-discuss] RabbitMQ with halfword emulator in R14B02
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11973">[ date ]</a>
              <a href="thread.html#11973">[ thread ]</a>
              <a href="subject.html#11973">[ subject ]</a>
              <a href="author.html#11973">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
