<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Client connect/disconnect events on the	server side
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Client%20connect/disconnect%20events%20on%20the%0A%09server%20side&In-Reply-To=%3CAANLkTinTU9ryoTrGHs1cRHAhbvVB8Hzh1dxm3WTe%2BGyr%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011839.html">
   <LINK REL="Next"  HREF="011841.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Client connect/disconnect events on the	server side</H1>
    <B>Miguel Morales</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Client%20connect/disconnect%20events%20on%20the%0A%09server%20side&In-Reply-To=%3CAANLkTinTU9ryoTrGHs1cRHAhbvVB8Hzh1dxm3WTe%2BGyr%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Client connect/disconnect events on the	server side">therevoltingx at gmail.com
       </A><BR>
    <I>Tue Mar 15 19:44:12 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011839.html">[rabbitmq-discuss] Client connect/disconnect events on the	server side
</A></li>
        <LI>Next message: <A HREF="011841.html">[rabbitmq-discuss] Client connect/disconnect events on the	server side
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11840">[ date ]</a>
              <a href="thread.html#11840">[ thread ]</a>
              <a href="subject.html#11840">[ subject ]</a>
              <a href="author.html#11840">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> 'presence' is a highly application dependent concept. Support for it in the
</I>&gt;<i> messaging system itself could only accommodate a very restricted set of use
</I>&gt;<i> cases. So it's best handled by applications.
</I>&gt;<i>
</I>&gt;<i>
</I>Yeah, definetly.  It would be *kind of* cool to have that built into
rabbitmq but not a necessity by any means.  There are several points where
one may want to hook into such as when the connection happens, when a bind
has been made, etc.


&gt;<i> One fairly generic and flexible way is to get clients to publish a presence
</I>&gt;<i> message every so often to some dedicated exchange. That message can contain
</I>&gt;<i> all kinds of application specific information, e.g. to identify the user,
</I>&gt;<i> what their status is, etc. An app can then consume these messages, update
</I>&gt;<i> some db with status information, send status change messages to clients
</I>&gt;<i> interested and authorised to see them (e.g. 'friends'). The app can also
</I>&gt;<i> detect the absence of the messages and mark the user as absent.
</I>&gt;<i>
</I>&gt;<i>
</I>Yeah, this was the road I was heading toward.  In my use case this is fine.
 However, I think that it might be difficult for an app that doesn't require
the client to publish any messages in order to be active.  For example, in a
cell phone where one wants to send the least amount of data but still wants
to receive any small messages from the server.
Also, if one wants to detect absence as soon as possible.  The client would
have to rapidly be transmitting status packets.

The other option would be to map the users by their ip and detect events via
a tcp proxy as you suggested earlier.

In this scheme
&gt;<i>
</I>&gt;<i> - the notion of presence is not tied to the lifetime of connections, or
</I>&gt;<i> queues, or bindings
</I>&gt;<i>
</I>&gt;<i> - the notion of users (or, more generally, 'the things of which we want to
</I>&gt;<i> know the presence') is not tied to that of AMQP users
</I>&gt;<i>
</I>&gt;<i> - presence can be more than just a flag, i.e. all kinds of complex status
</I>&gt;<i> information can be transmitted
</I>&gt;<i>
</I>&gt;<i>
</I>I think this is a fundamental flaw in my setup is that clients are tied to
users.
But even is a single user scheme is implemented, it would still be difficult
to detect when clients connect/disconnect in real time.  I'm probably
missing something though.

The way I'm going to detect this is by having the client have another tcp
socket connection open to another port on my server.  Then a server side app
that listens on that port can detect if the client connected/disconnected at
the socket level.  (It uses the same credentials as the rabbitmq server so
the client has to 'log-in' to both services.)

Thanks for your help,
Miguel.


&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
~ Jeremiah:9:23-24
Android 2D MMORPG: <A HREF="http://solrpg.com/">http://solrpg.com/</A> <A HREF="http://www.youtube.com/user/revoltingx">http://www.youtube.com/user/revoltingx</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110315/4c9e048c/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110315/4c9e048c/attachment.htm</A>&gt;
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011839.html">[rabbitmq-discuss] Client connect/disconnect events on the	server side
</A></li>
	<LI>Next message: <A HREF="011841.html">[rabbitmq-discuss] Client connect/disconnect events on the	server side
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11840">[ date ]</a>
              <a href="thread.html#11840">[ thread ]</a>
              <a href="subject.html#11840">[ subject ]</a>
              <a href="author.html#11840">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
