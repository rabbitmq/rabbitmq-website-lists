<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] STOMP Plugin 2.4.0 Issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20Plugin%202.4.0%20Issue&In-Reply-To=%3C628F04E2-D47A-478C-A809-735644C08FBF%40kinishi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012148.html">
   <LINK REL="Next"  HREF="012151.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] STOMP Plugin 2.4.0 Issue</H1>
    <B>Alexander Goldstone</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20Plugin%202.4.0%20Issue&In-Reply-To=%3C628F04E2-D47A-478C-A809-735644C08FBF%40kinishi.com%3E"
       TITLE="[rabbitmq-discuss] STOMP Plugin 2.4.0 Issue">alex at kinishi.com
       </A><BR>
    <I>Wed Mar 30 17:32:18 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012148.html">[rabbitmq-discuss] STOMP Plugin 2.4.0 Issue
</A></li>
        <LI>Next message: <A HREF="012151.html">[rabbitmq-discuss] STOMP Plugin 2.4.0 Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12149">[ date ]</a>
              <a href="thread.html#12149">[ thread ]</a>
              <a href="subject.html#12149">[ subject ]</a>
              <a href="author.html#12149">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Steve,

Thank you for taking the time to look at this for me.

I started with a regular 64-Bit Ubuntu 10.10 running on an Amazon EC2 micro instance.

I changed the hostname of the instance and then ran:

		sudo apt-get update &amp;&amp; sudo apt-get upgrade -y

I then copied and pasted the rabbitmq-user-data.sh script documented at:

		<A HREF="http://www.rabbitmq.com/ec2.html">http://www.rabbitmq.com/ec2.html</A>

Once the latest (2.4.0) rabbitmq was installed using that script I installed the plugins:

cd /usr/lib/rabbitmq/lib/rabbitmq_server-2.4.0/plugins/
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/mochiweb-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/mochiweb-2.4.0.ez</A>
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/webmachine-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/webmachine-2.4.0.ez</A>
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/amqp_client-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/amqp_client-2.4.0.ez</A>
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbitmq-mochiweb-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbitmq-mochiweb-2.4.0.ez</A>
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbitmq-management-agent-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbitmq-management-agent-2.4.0.ez</A>
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbitmq-management-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbitmq-management-2.4.0.ez</A>
sudo wget <A HREF="http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbit_stomp-2.4.0.ez">http://www.rabbitmq.com/releases/plugins/v2.4.0/rabbit_stomp-2.4.0.ez</A>
sudo /etc/init.d/rabbitmq-server restart

I did not manually install erlang itself but I can see that the version I have ended up with after the above is R13B03.

I didn't do anything else so I can't see what I could have done differently. This same process worked for the previous version of rabbitmq for which I was able to telnet and use the STOMP plugin fine.

I just removed all plugins except amqp_client-2.4.0.ez and rabbit_stomp-2.4.0.ez and restarted rabbitmq as this was the only difference I could see between your tests and mine (other than the operating system and erlang version).

Removing the other plugins and restarting rabbitmq had no impact on this issue so I would really appreciate you repeating your test on an Ubuntu client as that would seem to be the only difference between your tests and mine.

If there is anything else I should try and/or any other details I can provide that would be useful then please let me know.

Thanks,

Alex

On 30 Mar 2011, at 16:41, Steve Powell wrote:

&gt;<i> Hi Alexander,
</I>&gt;<i> 
</I>&gt;<i> I'm able to run happily on the (in-house) 'best-so-far' version of rabbitmq-stomp:
</I>&gt;<i> ---------------------------------------------------8&lt;----cut-here-----------
</I>&gt;<i> 15:29:30 :&gt; telnet localhost 61613
</I>&gt;<i> Trying ::1...
</I>&gt;<i> Connected to localhost.
</I>&gt;<i> Escape character is '^]'.
</I>&gt;<i> CONNECT
</I>&gt;<i> login:guest
</I>&gt;<i> passcode:guest
</I>&gt;<i> 
</I>&gt;<i> ^@
</I>&gt;<i> CONNECTED
</I>&gt;<i> session:session-A/W+DDK95d4+ZZehxZHkZQ==
</I>&gt;<i> heartbeat:0,0
</I>&gt;<i> version:1.0
</I>&gt;<i> 
</I>&gt;<i> DISCONNECT
</I>&gt;<i> 
</I>&gt;<i> ^@
</I>&gt;<i> Connection closed by foreign host.
</I>&gt;<i> 
</I>&gt;<i> 15:30:31 :&gt;
</I>&gt;<i> ---------------------------------------------------8&lt;----cut-here-----------
</I>&gt;<i> but this is, I admit, a development version, so the next thing I tried is to download my own fresh RabbitMQ 2.4.0....
</I>&gt;<i> 
</I>&gt;<i> (I'm on Mac, so I used macports to install rabbitmq-server (@2.4.0) and put amqp-client-2.4.0.ez and rabbit-somp-2.4.0.ez in the plugins directory, ran 
</I>&gt;<i> 'sudo rabbitmq-server' and repeated the above experiment.)
</I>&gt;<i> 
</I>&gt;<i> And it worked identically for me.  So, this is probably a set-up issue for you.  Can you provide the installation steps you went through, please? Oh, and the versions of Erlang and so on are very useful, too, thanks.
</I>&gt;<i> 
</I>&gt;<i> Here is my 'rabbitmqctl status' output for comparison:
</I>&gt;<i> 
</I>&gt;<i> [{pid,73212},
</I>&gt;<i> {running_applications,[{amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.4.0&quot;},
</I>&gt;<i>                        {rabbit_stomp,&quot;Embedded Rabbit Stomp Adapter&quot;,&quot;2.4.0&quot;},
</I>&gt;<i>                        {rabbit,&quot;RabbitMQ&quot;,&quot;2.4.0&quot;},
</I>&gt;<i>                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.16&quot;},
</I>&gt;<i>                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.5&quot;},
</I>&gt;<i>                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.9.2&quot;},
</I>&gt;<i>                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.2&quot;},
</I>&gt;<i>                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.2&quot;}]},
</I>&gt;<i> {nodes,[{disc,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at spowell-desktop</A>']}]},
</I>&gt;<i> {running_nodes,['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at spowell-desktop</A>']}]
</I>&gt;<i> 
</I>&gt;<i> I appear to be running a more modern version of Erlang and its friends here, but the next step would be for me to try this on an Ubuntu client (which I can probably do, but it will take me a little time to set one up.)
</I>&gt;<i> 
</I>&gt;<i> Please just come back here if you need me to try that.
</I>&gt;<i> 
</I>&gt;<i> Steve Powell
</I>&gt;<i> 
</I>&gt;<i> On 30 Mar 2011, at 09:44, Alexander Goldstone wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Are there any known issues with the STOMP plugin for RabbitMQ 2.4.0 ?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I am used to connecting to the STOMP plugin via Telnet and issuing CONNECT, SEND and SUBSCRIBE frames by hand. For previous versions of RabbitMQ this has all worked fine. Now, for a clean install of RabbitMQ 2.4.0 on Ubuntu 10.10, I am not even able to successfully CONNECT using something like:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 		CONNECT
</I>&gt;&gt;<i> 		login:guest
</I>&gt;&gt;<i> 		passcode:guest
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 		^@
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I send a line-break after the passcode and then send another line-break but the server closes the connection before I am able to send the NULL frame terminator. The server does not output any error messages.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Similarly, if I follow the &quot;Testing the adapter&quot; example at <A HREF="http://www.rabbitmq.com/stomp.html">http://www.rabbitmq.com/stomp.html</A> then the server closes the connection after the second time I send &quot;dummy&quot; but it does not output an error message.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The RabbitMQ Management Plugin shows the STOMP plugin is listening on port 61613.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The Erlang version provided as standard for Ubuntu 10.10 seems to be R13B03 and th output from &quot;rabbitmqctl status&quot; looks like this:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> [{pid,28410},
</I>&gt;&gt;<i> {running_applications,
</I>&gt;&gt;<i>    [{rabbit_management,&quot;RabbitMQ Management Console&quot;,&quot;2.4.0&quot;},
</I>&gt;&gt;<i>     {webmachine,&quot;webmachine&quot;,&quot;1.7.0&quot;},
</I>&gt;&gt;<i>     {rabbit_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;2.4.0&quot;},
</I>&gt;&gt;<i>     {amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.4.0&quot;},
</I>&gt;&gt;<i>     {rabbit_mochiweb,&quot;RabbitMQ Mochiweb Embedding&quot;,&quot;2.4.0&quot;},
</I>&gt;&gt;<i>     {mochiweb,&quot;MochiMedia Web Server&quot;,&quot;1.3&quot;},
</I>&gt;&gt;<i>     {inets,&quot;INETS  CXC 138 49&quot;,&quot;5.2&quot;},
</I>&gt;&gt;<i>     {rabbit_stomp,&quot;Embedded Rabbit Stomp Adapter&quot;,&quot;2.4.0&quot;},
</I>&gt;&gt;<i>     {rabbit,&quot;RabbitMQ&quot;,&quot;2.4.0&quot;},
</I>&gt;&gt;<i>     {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.12&quot;},
</I>&gt;&gt;<i>     {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.4&quot;},
</I>&gt;&gt;<i>     {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.8&quot;},
</I>&gt;&gt;<i>     {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.16.4&quot;},
</I>&gt;&gt;<i>     {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.13.4&quot;}]},
</I>&gt;&gt;<i> {nodes,[{disc,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at tatooine</A>]}]},
</I>&gt;&gt;<i> {running_nodes,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at tatooine</A>]}]
</I>&gt;&gt;<i> ...done.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I'm assuming this isn't a problem for everyone using the STOMP plugin otherwise someone would have mentioned it by now so if I can provide any further information to help work out what is wrong on my setup then please let me know.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Alex
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>




</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012148.html">[rabbitmq-discuss] STOMP Plugin 2.4.0 Issue
</A></li>
	<LI>Next message: <A HREF="012151.html">[rabbitmq-discuss] STOMP Plugin 2.4.0 Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12149">[ date ]</a>
              <a href="thread.html#12149">[ thread ]</a>
              <a href="subject.html#12149">[ subject ]</a>
              <a href="author.html#12149">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
