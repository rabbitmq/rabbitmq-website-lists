<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Spying on &quot;mandatory&quot; messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Spying%20on%20%22mandatory%22%20messages&In-Reply-To=%3C7494EE23-3862-42C1-B52D-50BEA0CCE52E%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012005.html">
   <LINK REL="Next"  HREF="012036.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Spying on &quot;mandatory&quot; messages</H1>
    <B>Alvaro Videla</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Spying%20on%20%22mandatory%22%20messages&In-Reply-To=%3C7494EE23-3862-42C1-B52D-50BEA0CCE52E%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Spying on &quot;mandatory&quot; messages">videlalvaro at gmail.com
       </A><BR>
    <I>Thu Mar 24 15:16:20 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012005.html">[rabbitmq-discuss] Spying on &quot;mandatory&quot; messages
</A></li>
        <LI>Next message: <A HREF="012036.html">[rabbitmq-discuss] Spying on &quot;mandatory&quot; messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12006">[ date ]</a>
              <a href="thread.html#12006">[ thread ]</a>
              <a href="subject.html#12006">[ subject ]</a>
              <a href="author.html#12006">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

For spying messages on an RPC setup I'm working on an implementation of the Smart Proxy messaging pattern: <A HREF="http://www.eaipatterns.com/SmartProxy.html">http://www.eaipatterns.com/SmartProxy.html</A> perhaps you could implement that too.

This is what I've done so far: <A HREF="http://vimeo.com/20966661">http://vimeo.com/20966661</A> which is at early stage of development and very alpha.

Also take a look at the Wire Tap messaging pattern: <A HREF="http://www.eaipatterns.com/WireTap.html">http://www.eaipatterns.com/WireTap.html</A>

I guess most of the patterns from that book can be implemented with RabbitMQ, and some of them are already there but with different nomenclature.

Hope this helps,

Alvaro

On Mar 24, 2011, at 4:05 PM, Matthew Sackman wrote:

&gt;<i> Hi Charly,
</I>&gt;<i> 
</I>&gt;<i> On Thu, Mar 24, 2011 at 03:35:35PM +0100, Charly Hamy wrote:
</I>&gt;&gt;<i> For the req/res scenario, I'm using the mandatory flag on my messages, so
</I>&gt;&gt;<i> that sending a request message to a disconnected component (no corresponding
</I>&gt;&gt;<i> queue declared on the broker) returns an error to the sender. This works as
</I>&gt;&gt;<i> expected.
</I>&gt;<i> 
</I>&gt;<i> Well... you're using mandatory as a poor-man's form of resource
</I>&gt;<i> monitoring.
</I>&gt;<i> 
</I>&gt;&gt;<i> But now, I would want to plug new components to spy on those flows of
</I>&gt;&gt;<i> requests and responses, without interfering with the ongoing
</I>&gt;&gt;<i> communications... which is not by default compatible with my use of the
</I>&gt;&gt;<i> mandatory flag : when a &quot;spy&quot; component is monitorng request/response
</I>&gt;&gt;<i> messages, those messages end-up in its queue, then even if the actual target
</I>&gt;&gt;<i> component for those messages is not present on the broker (no queue), no
</I>&gt;&gt;<i> error is returned to the sender.
</I>&gt;<i> 
</I>&gt;<i> Indeed, which is why mandatory is probably a mis-feature and should not
</I>&gt;<i> be used. Basically, AMQP does not really provide any sort of sane
</I>&gt;<i> resource monitoring. We've added in the 2.4.0 release consumer-death
</I>&gt;<i> notifications, but that's not going to help you here. You really have a
</I>&gt;<i> choice: make the queue non-exclusive and non-autodelete. Thus it always
</I>&gt;<i> stays there and will always receive messages. Then, you have your
</I>&gt;<i> clients just consume from it. The queue will do round-robining between
</I>&gt;<i> the consumers and all should be well, but you might have reasons why you
</I>&gt;<i> want the queue to be exclusive or autodelete. The other option is to use
</I>&gt;<i> some other tool to do monitoring of your consumers and to address that
</I>&gt;<i> problem outside of AMQP/RabbitMQ.
</I>&gt;<i> 
</I>&gt;<i> Best wishes,
</I>&gt;<i> 
</I>&gt;<i> Matthew
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012005.html">[rabbitmq-discuss] Spying on &quot;mandatory&quot; messages
</A></li>
	<LI>Next message: <A HREF="012036.html">[rabbitmq-discuss] Spying on &quot;mandatory&quot; messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12006">[ date ]</a>
              <a href="thread.html#12006">[ thread ]</a>
              <a href="subject.html#12006">[ subject ]</a>
              <a href="author.html#12006">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
