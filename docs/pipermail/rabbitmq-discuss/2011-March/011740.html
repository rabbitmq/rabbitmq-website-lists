<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20code%20404%20NOT_FOUND%20when%20declaring%20a%0A%20queue%20in%20a%20clustered%20server%20%28using%20.NET%20client%29&In-Reply-To=%3CAANLkTika117M8TV7XnMAz-yz%3Dqb4T95280A13JeV1fUf%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011725.html">
   <LINK REL="Next"  HREF="011742.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)</H1>
    <B>Alfonso Pantoja</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20code%20404%20NOT_FOUND%20when%20declaring%20a%0A%20queue%20in%20a%20clustered%20server%20%28using%20.NET%20client%29&In-Reply-To=%3CAANLkTika117M8TV7XnMAz-yz%3Dqb4T95280A13JeV1fUf%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Error code 404 NOT_FOUND when declaring a queue in a clustered server (using .NET client)">alfonso.pantoja at gmail.com
       </A><BR>
    <I>Wed Mar  9 22:47:18 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="011725.html">[rabbitmq-discuss] Problem with a constantly increasing memory footprint
</A></li>
        <LI>Next message: <A HREF="011742.html">[rabbitmq-discuss] Fine grain access control when using STOMP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11740">[ date ]</a>
              <a href="thread.html#11740">[ thread ]</a>
              <a href="subject.html#11740">[ subject ]</a>
              <a href="author.html#11740">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Alex,

Sorry, my mistake
You are right. The queues were declared on the offline node.
Due to the way to solve this is to bring back up that node we'll have
decided
that every consumer will point to the server that holds the queues
it needs, so a shutdown on the other node won't affect it .


Thank you


Alfonso Pantoja




2011/2/25 Alexandru Scvor&#355;ov &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexandru at rabbitmq.com</A>&gt;

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> In a cluster, if a there's a durable queue on a down'ed node,
</I>&gt;<i> redeclaring that queue on another node will fail with NOT_FOUND.  The
</I>&gt;<i> only way to solve this is to bring back up the node holding the queue.
</I>&gt;<i>
</I>&gt;<i> This seems to be what you're seeing, but you say all the queues were
</I>&gt;<i> declared on the online node.  Are you sure that's the case?
</I>&gt;<i>
</I>&gt;<i> Does bringing the other node up solve the problem?
</I>&gt;<i>
</I>&gt;<i> Once up, can you delete the queue, redeclare it on SERVER_1, take down
</I>&gt;<i> SERVER_2 again and check if the problem still happens?
</I>&gt;<i>
</I>&gt;<i> BTW, in the next message, you seem to have reversed SERVER_1 and
</I>&gt;<i> SERVER_2.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Alex
</I>&gt;<i>
</I>&gt;<i> On Fri, Feb 25, 2011 at 11:57:25AM +0100, Alfonso Pantoja wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Today I've got a code=404  NOT_FOUND  error when declaring a queue in a
</I>&gt;<i> &gt; clustered server.
</I>&gt;<i> &gt; We have 2 servers in that cluster. SERVER_1 and SERVER_2.
</I>&gt;<i> &gt; The message reported that the queue the consumer wanted to declare didn't
</I>&gt;<i> &gt; exist which hasn't too much sense...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The AMQP operation
</I>&gt;<i> &gt; was interrupted: AMQP close-reason, initiated by Peer, code=404,
</I>&gt;<i> &gt; text=&quot;NOT_FOUND - no queue  'alfonsoqueue' in vhost '/'&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SERVER_2 was offline and the .NET consumer tried to connect to SERVER1
</I>&gt;<i> (we
</I>&gt;<i> &gt; don't use the array of addresses feature, we point the consumer directly
</I>&gt;<i> to
</I>&gt;<i> &gt; one single server).
</I>&gt;<i> &gt; The queues were created on server SERVER_1 and there were no queues in
</I>&gt;<i> &gt;  webadmin queue listing of SERVER_2.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; By the way all our queues and exchanges are durable and the first thing
</I>&gt;<i> the
</I>&gt;<i> &gt; consumer do is to a
</I>&gt;<i> &gt; channel.DeclareQueue(name=queue_name, durable=true)
</I>&gt;<i> &gt; In the source code I see this declaration is performed using
</I>&gt;<i> nowait=false,
</I>&gt;<i> &gt; exclusive=false...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; My
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110309/2aacd032/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110309/2aacd032/attachment.htm</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011725.html">[rabbitmq-discuss] Problem with a constantly increasing memory footprint
</A></li>
	<LI>Next message: <A HREF="011742.html">[rabbitmq-discuss] Fine grain access control when using STOMP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11740">[ date ]</a>
              <a href="thread.html#11740">[ thread ]</a>
              <a href="subject.html#11740">[ subject ]</a>
              <a href="author.html#11740">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
