<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] problem with new persiter with 1000	topics/queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20problem%20with%20new%20persiter%20with%201000%0A%09topics/queues&In-Reply-To=%3C4CCA04BE.5000606%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009684.html">
   <LINK REL="Next"  HREF="009686.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] problem with new persiter with 1000	topics/queues</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20problem%20with%20new%20persiter%20with%201000%0A%09topics/queues&In-Reply-To=%3C4CCA04BE.5000606%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] problem with new persiter with 1000	topics/queues">matthias at rabbitmq.com
       </A><BR>
    <I>Fri Oct 29 00:18:22 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009684.html">[rabbitmq-discuss] problem with new persiter with 1000	topics/queues
</A></li>
        <LI>Next message: <A HREF="009686.html">[rabbitmq-discuss] Understanding RabbitMQ clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9685">[ date ]</a>
              <a href="thread.html#9685">[ thread ]</a>
              <a href="subject.html#9685">[ subject ]</a>
              <a href="author.html#9685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alex,

alex chen wrote:
&gt;<i> yes 1000 queues and 1000 connections.  this 4 GB was after 200 GB 
</I>&gt;<i> messages were consumed.
</I>&gt;<i> If the broker is started fresh with 1000 queues and connections but no 
</I>&gt;<i> messages published, the mem usage is 260 MB.
</I>
Memory fragmentation will result in a figure higher than 260MB when the 
broker goes idle, but 4GB seems a bit much. It's possible that the 
memory is being taken up by the processes handling connections and/or 
channels. That is not something we have seen before, but the scenario 
you are describing - lots of connections that are all idle - is not very 
common.

&gt;<i> we run it once a minute to monitor the queue length.
</I>
That should actually be fine; 60s is plenty for the queues to go to 
sleep. Though waking them all up again will cause some memory and CPU 
pressure. FWIW, the management plugin can monitor queues without 
interfering with their sleeping patterns.


Regards,

Matthias.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009684.html">[rabbitmq-discuss] problem with new persiter with 1000	topics/queues
</A></li>
	<LI>Next message: <A HREF="009686.html">[rabbitmq-discuss] Understanding RabbitMQ clustering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9685">[ date ]</a>
              <a href="thread.html#9685">[ thread ]</a>
              <a href="subject.html#9685">[ subject ]</a>
              <a href="author.html#9685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
