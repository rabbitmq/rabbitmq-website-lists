<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumer Not Getting Message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20Not%20Getting%20Message&In-Reply-To=%3CB80E9C61-98A4-45BF-ABCC-B16832541B98%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009384.html">
   <LINK REL="Next"  HREF="009385.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumer Not Getting Message</H1>
    <B>Rob Harrop</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20Not%20Getting%20Message&In-Reply-To=%3CB80E9C61-98A4-45BF-ABCC-B16832541B98%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Consumer Not Getting Message">rob at rabbitmq.com
       </A><BR>
    <I>Thu Oct 14 14:56:49 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009384.html">[rabbitmq-discuss]  Consumer Not Getting Message
</A></li>
        <LI>Next message: <A HREF="009385.html">[rabbitmq-discuss] Java Client Changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9430">[ date ]</a>
              <a href="thread.html#9430">[ thread ]</a>
              <a href="subject.html#9430">[ subject ]</a>
              <a href="author.html#9430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On the face of it the code looks fine.

Just to check, do you see GETTING MESSAGE printed out the second time?

Is it possible for you to pull this out of an EJB and run it standalone? I doubt that it is anything specific about the JBoss environment but it's worth checking to be sure. 

Is there anything of interest in the Rabbit logs?

Regards,

Rob

On 12 Oct 2010, at 10:43, azzuwan wrote:

&gt;<i> 
</I>&gt;<i> I'm using Rabbit MQ 1.8.0 and connecting using the java client from an EJB in
</I>&gt;<i> JBOSS 5.1.
</I>&gt;<i> 
</I>&gt;<i> I'm having a problem while trying to get message from the queue using the
</I>&gt;<i> following codes
</I>&gt;<i> 
</I>&gt;<i> QueueingConsumer consumer = new QueueingConsumer(replyChannel);
</I>&gt;<i>            replyChannel.basicConsume(replyQueueName, consumer);
</I>&gt;<i>            boolean run = true;
</I>&gt;<i> 
</I>&gt;<i>            logger.info(&quot;BEFORE LOOP&quot;);
</I>&gt;<i>            while (run) {
</I>&gt;<i>                QueueingConsumer.Delivery delivery = null;
</I>&gt;<i>                logger.info(&quot;GETTING MESSAGE&quot;);
</I>&gt;<i>                try {                    
</I>&gt;<i> 
</I>&gt;<i>                    delivery = consumer.nextDelivery();
</I>&gt;<i>                    logger.info(&quot;MESSAGE RECIEVED STATE &quot;);
</I>&gt;<i> 
</I>&gt;<i> replyChannel.basicAck(delivery.getEnvelope().getDeliveryTag(), false);
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>                } catch (InterruptedException ie) {
</I>&gt;<i>                    logger.info(ie.getMessage());
</I>&gt;<i>                    continue;
</I>&gt;<i>                }                
</I>&gt;<i> 
</I>&gt;<i>                ....
</I>&gt;<i>            }
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I managed to get the first message successfully but the second and
</I>&gt;<i> subsequent messages never gets delivered.
</I>&gt;<i> From the output, it seems that the attempt to get the message stuck at 
</I>&gt;<i> delivery = consumer.nextDelivery() .
</I>&gt;<i> MESSAGE RECIEVED STATE gets print out for the first time only.
</I>&gt;<i> From then on, all the messages gets piled up in the queue.
</I>&gt;<i> Any idea why?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> View this message in context: <A HREF="http://old.nabble.com/Consumer-Not-Getting-Message-tp29941664p29941664.html">http://old.nabble.com/Consumer-Not-Getting-Message-tp29941664p29941664.html</A>
</I>&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009384.html">[rabbitmq-discuss]  Consumer Not Getting Message
</A></li>
	<LI>Next message: <A HREF="009385.html">[rabbitmq-discuss] Java Client Changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9430">[ date ]</a>
              <a href="thread.html#9430">[ thread ]</a>
              <a href="subject.html#9430">[ subject ]</a>
              <a href="author.html#9430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
