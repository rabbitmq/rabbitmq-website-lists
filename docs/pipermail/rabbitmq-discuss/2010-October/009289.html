<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Using Toke
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Using%20Toke&In-Reply-To=%3C20101004172730.GT20604%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009288.html">
   <LINK REL="Next"  HREF="009290.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Using Toke</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Using%20Toke&In-Reply-To=%3C20101004172730.GT20604%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Using Toke">matthew at rabbitmq.com
       </A><BR>
    <I>Mon Oct  4 18:27:30 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009288.html">[rabbitmq-discuss] Using Toke
</A></li>
        <LI>Next message: <A HREF="009290.html">[rabbitmq-discuss] Using Toke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9289">[ date ]</a>
              <a href="thread.html#9289">[ thread ]</a>
              <a href="subject.html#9289">[ subject ]</a>
              <a href="author.html#9289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Oct 04, 2010 at 12:04:23PM -0500, tsuraan wrote:
&gt;<i> Is there a setup guide somewhere for the Toke plugin?  The plugins
</I>&gt;<i> page (<A HREF="http://www.rabbitmq.com/plugins.html">http://www.rabbitmq.com/plugins.html</A>) doesn't mention it, and
</I>&gt;<i> there isn't a README in the rabbitmq-toke project.  My rabbit build
</I>&gt;<i> environment is just a download of the 2.1.0 tarball; I have tokyo
</I>&gt;<i> cabinet installed, so after that, what do I need to do to get Toke
</I>&gt;<i> running?  Also, is there a way to tell that toke is running on a given
</I>&gt;<i> rabbit process?
</I>
Sadly, it's all a bit of a mess just at the moment.

rabbitmq-toke requires toke, which requires tokyocabinet to be
installed.

Because we don't ship native code, and because we certainly don't want
to ship tokyocabinet, the rabbitmq-toke package was never added to our
overall list of plugins in the rabbitmq-public-umbrella repo. As a
result of this, recent changes to the public umbrella build mechanism
managed to break rabbitmq-toke (amongst other things).

I've spent the last two weeks rewriting the whole build system, pretty
much from scratch, and it's now vastly improved and rabbitmq-toke works
again now, however, that work has not yet been through QA, and is thus
only available on branch bug23274. Thus, the following should work:

First, install tokyocabinet locally, including development headers -
compiling from source is your best bet.

hg clone <A HREF="http://hg.rabbitmq.com/rabbitmq-public-umbrella">http://hg.rabbitmq.com/rabbitmq-public-umbrella</A> -r bug23274
cd rabbitmq-public-umbrella
make checkout
cd rabbitmq-toke
make -j
make run_in_broker

You should then see as part of the rabbit boot steps:
starting Tokyo Cabinet for rabbit_msg_store    ...done

If you exit the broker, then ls dist/*.ez, you should see something
like:

rabbitmq-toke$ ls dist/*.ez
dist/amqp_client-0.0.0.ez  dist/rabbit_common-0.0.0.ez
dist/rabbit_toke-0.0.0.ez  dist/toke-0.0.0.ez

Copy all but the rabbit_common to your server plugins dir. Now I _think_
you should be ok running these with a 2.1.0 broker, but you may not be -
you may have to run the latest broker from default.

Hopefully, this building mess will be sorted in the next day or two, as
this new work gets through QA. However, there is a general issue with
toke that we don't want to ship native code, but can't build or package
toke without. Certainly, the website plugins page should be properly
updated soon.

Matthew
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009288.html">[rabbitmq-discuss] Using Toke
</A></li>
	<LI>Next message: <A HREF="009290.html">[rabbitmq-discuss] Using Toke
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9289">[ date ]</a>
              <a href="thread.html#9289">[ thread ]</a>
              <a href="subject.html#9289">[ subject ]</a>
              <a href="author.html#9289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
