<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] problem with new persiter with 1000	topics/queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20problem%20with%20new%20persiter%20with%201000%0A%09topics/queues&In-Reply-To=%3C78396.91847.qm%40web31808.mail.mud.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009674.html">
   <LINK REL="Next"  HREF="009672.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] problem with new persiter with 1000	topics/queues</H1>
    <B>alex chen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20problem%20with%20new%20persiter%20with%201000%0A%09topics/queues&In-Reply-To=%3C78396.91847.qm%40web31808.mail.mud.yahoo.com%3E"
       TITLE="[rabbitmq-discuss] problem with new persiter with 1000	topics/queues">chen650 at yahoo.com
       </A><BR>
    <I>Thu Oct 28 00:39:01 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009674.html">[rabbitmq-discuss] Lose messages between restarts of broker
</A></li>
        <LI>Next message: <A HREF="009672.html">[rabbitmq-discuss] problem with new persiter with	1000	topics/queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9670">[ date ]</a>
              <a href="thread.html#9670">[ thread ]</a>
              <a href="subject.html#9670">[ subject ]</a>
              <a href="author.html#9670">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Matthias,


&gt;<i> That is expected. When clients are publishing at a higher rate than the broker can write to disk, and consumers aren't draining the queues, then eventually rabbit will have to pause producers so it can page messages to disk and free up some memory.
</I>
i was able to increase the memory_high_watermark to 0.8 (6.4GB) and got 50 MB/sec publish rate all the way to 200 GB messages stored.  the broker used 5.9 GB and there was no throttling on publishers.   However, when i started 1000 consumers, the same old errors happen again as described in my first email:  lots of consumers got errors on login or basic_consume:
<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008420.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008420.html</A>

i am using erlang R14B for this test.

&gt;<i> That threshold setting via vm_memory_high_watermark definitely still works in 2.1.1.
</I>
yes it works.  my /etc/rabbitmq/rabbitmq.config was a symlink instead of a regular file.  rabbitmq-server script uses -f instead of -e to check file exist, so it does not work for symlink.

thanks.

-alex


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101027/4954006b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101027/4954006b/attachment.htm</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009674.html">[rabbitmq-discuss] Lose messages between restarts of broker
</A></li>
	<LI>Next message: <A HREF="009672.html">[rabbitmq-discuss] problem with new persiter with	1000	topics/queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9670">[ date ]</a>
              <a href="thread.html#9670">[ thread ]</a>
              <a href="subject.html#9670">[ subject ]</a>
              <a href="author.html#9670">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
