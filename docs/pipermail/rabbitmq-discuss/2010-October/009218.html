<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] last sticky wicket on map/reduce
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20last%20sticky%20wicket%20on%20map/reduce&In-Reply-To=%3CAANLkTikNdqbcxvYOGZJsxOvc4c5ObYFvm%2Bi15htDXQhi%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009214.html">
   <LINK REL="Next"  HREF="009221.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] last sticky wicket on map/reduce</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20last%20sticky%20wicket%20on%20map/reduce&In-Reply-To=%3CAANLkTikNdqbcxvYOGZJsxOvc4c5ObYFvm%2Bi15htDXQhi%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] last sticky wicket on map/reduce">alexis at rabbitmq.com
       </A><BR>
    <I>Fri Oct  1 14:51:42 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009214.html">[rabbitmq-discuss] last sticky wicket on map/reduce
</A></li>
        <LI>Next message: <A HREF="009221.html">[rabbitmq-discuss] last sticky wicket on map/reduce
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9218">[ date ]</a>
              <a href="thread.html#9218">[ thread ]</a>
              <a href="subject.html#9218">[ subject ]</a>
              <a href="author.html#9218">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Why can't you use a checksum instead? Each time you create a set of n
subtasks from some task T, attach a fraction m/n to each subtask where m is
the fraction attached to T. Start with m equals 1. The sum of the fractions
will always be 1. No need for shared counters...

On Oct 1, 2010 3:35 PM, &quot;Jon Brisbin&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jon.brisbin at npcinternational.com</A>&gt;
wrote:

I'm also wondering if anyone uses counts to determine when a job is finished
or not. By that I mean, increment a counter for every outgoing message and
decrement the counter when a response is received. In the case of a
map/reduce job, I'd need to do something like:

SQL -&gt; Map phase = +1 (per row)
Map phase -&gt; Reduce phase = -1 (that we got the original msg) +1 * (num of
emit's)
Reduce phase -&gt; Response|ReReduce = -1 (for emit's) +1 (for
response/rereduce)
[ReReduce -&gt; Response] = -1 +1 (for sending response)
Response = -1

Essentially, each step would decrement a counter for the incoming message
and increment the counter for the outgoing message. A reduce phase might
decrement the counter 1000 times and increment it once. But since the map
phase incremented it 1000 times prior, the count after map/reduce would be
&quot;1&quot;. The response listener would then decrement the counter when it
processed the response, see that it's now zero, and know to continue.

If my goal is to beat processing times on the AS/400 when doing large
financial calculations (daily acct'g reports take several hours to
generate), I can't really depend on timeouts to make sure I've gathered all
my results. I want the job to return as soon as results are ready. I'd like
to go to management and show them a 2 hr -&gt; 15 min improvement by using
parallel processing.

I'm just wondering if using ZooKeeper or similar to do distributed,
synchronized counters will have enough atomicity to not miss a count
incr/decr. If I miss even one, I'm screwed because it'll never get back to
zero (or get there prematurely).

I need a sentence with a question mark or this will definitely go
unanswered: are message counters like this a good way to monitor
asynchronous, distributed processing state?

Thanks! :)

Jon Brisbin Portal Webmaster NPC International, Inc.

On Oct 1, 2010, at 8:11 AM, Jon Brisbin wrote: &gt; I had not really looked at
the spring integration ...

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101001/f8d07728/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20101001/f8d07728/attachment-0001.htm</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009214.html">[rabbitmq-discuss] last sticky wicket on map/reduce
</A></li>
	<LI>Next message: <A HREF="009221.html">[rabbitmq-discuss] last sticky wicket on map/reduce
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9218">[ date ]</a>
              <a href="thread.html#9218">[ thread ]</a>
              <a href="subject.html#9218">[ subject ]</a>
              <a href="author.html#9218">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
