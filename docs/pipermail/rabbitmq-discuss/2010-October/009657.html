<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the connect timeout
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Cilent%3A%20Allow%20specifying%20the%0A%20connect%20timeout&In-Reply-To=%3C4CC80FB1.40305%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009655.html">
   <LINK REL="Next"  HREF="009658.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the connect timeout</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Cilent%3A%20Allow%20specifying%20the%0A%20connect%20timeout&In-Reply-To=%3C4CC80FB1.40305%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the connect timeout">emile at rabbitmq.com
       </A><BR>
    <I>Wed Oct 27 12:40:33 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009655.html">[rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the connect timeout
</A></li>
        <LI>Next message: <A HREF="009658.html">[rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the	connect timeout
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9657">[ date ]</a>
              <a href="thread.html#9657">[ thread ]</a>
              <a href="subject.html#9657">[ subject ]</a>
              <a href="author.html#9657">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi again Amr,

On 27/10/10 12:01, Emile Joubert wrote:
&gt;<i> Hi Amr,
</I>&gt;<i> 
</I>&gt;<i> On 23/10/10 19:20, Amr Mostafa wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I've been searching around for a way to specify a connect timeout in the
</I>&gt;&gt;<i> Java client, but couldn't find an easy way to do that. There is one way,
</I>&gt;&gt;<i> which is by extending ConnectionFactory with a custom createFrameHandler
</I>&gt;&gt;<i> method, but that doesn't work with my case since I'm using Spring AMQP
</I>&gt;&gt;<i> support on top of the client API.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It would be very useful to add an option for that in the
</I>&gt;&gt;<i> ConnectionFactory which, if specified, would be passed to the socket
</I>&gt;&gt;<i> connect call.
</I>&gt;<i> 
</I>&gt;<i> You can also set socket options by overriding
</I>&gt;<i> ConnectionFactory.configureSocket(). By default this hook disables
</I>&gt;<i> Nagle's algorithm, but it can be used to set the timeout as well
</I>&gt;<i> (socket.setSoTimeout()). Even when using Spring AMQP you should be able
</I>&gt;<i> to specify your own ConnectionFactory that inherits from the existing one.
</I>
My previous advice won't work, because SO_TIMEOUT doesn't affect the
connection timeout. Instead of overriding configureSocket(), you need to
override createFrameHandler(). The call to socket.connect(addr) needs to
be changed to the 2-parameter version that accepts a connection timeout.

Another option would be to supply your own SocketFactory that supplies
sockets that override connect().

Given the difficulty of both these options we will look at extending the
ConnectionFactory API to make this simpler, as you suggested.

Regards

Emile
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009655.html">[rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the connect timeout
</A></li>
	<LI>Next message: <A HREF="009658.html">[rabbitmq-discuss] RabbitMQ Cilent: Allow specifying the	connect timeout
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9657">[ date ]</a>
              <a href="thread.html#9657">[ thread ]</a>
              <a href="subject.html#9657">[ subject ]</a>
              <a href="author.html#9657">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
