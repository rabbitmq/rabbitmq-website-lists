<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [help] [beginner] testing with pika: some questions and complaints
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Bhelp%5D%20%5Bbeginner%5D%20testing%20with%20pika%3A%20some%0A%20questions%20and%20complaints&In-Reply-To=%3C4F4DFDC2.3020801%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018470.html">
   <LINK REL="Next"  HREF="018471.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [help] [beginner] testing with pika: some questions and complaints</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Bhelp%5D%20%5Bbeginner%5D%20testing%20with%20pika%3A%20some%0A%20questions%20and%20complaints&In-Reply-To=%3C4F4DFDC2.3020801%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] [help] [beginner] testing with pika: some questions and complaints">simon at rabbitmq.com
       </A><BR>
    <I>Wed Feb 29 10:28:18 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018470.html">[rabbitmq-discuss] [help] [beginner] testing with pika: some	questions and complaints
</A></li>
        <LI>Next message: <A HREF="018471.html">[rabbitmq-discuss] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18473">[ date ]</a>
              <a href="thread.html#18473">[ thread ]</a>
              <a href="subject.html#18473">[ subject ]</a>
              <a href="author.html#18473">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/02/12 01:54, Alistair Bayley wrote:
&gt;<i> I've been testing rabbitmq with pika (python) to understand how they
</I>&gt;<i> interact and learn about the AMQP protocol. I've some questions and
</I>&gt;<i> some complaints; no doubt much of this will be from my
</I>&gt;<i> misunderstandings of the AMQP/rabbitmq specs.
</I>&gt;<i>
</I>&gt;<i> Pika (is this better posted to the pika mailing list?):
</I>
Maybe?

&gt;<i> AMQP/rabbitmq:
</I>&gt;<i>
</I>&gt;<i> 4.  why doesn't basic_ack do what I expect?
</I>&gt;<i>      If I do a basic_get with no_ack=False, and then a basic_ack,
</I>&gt;<i>      the message stays on the queue.
</I>&gt;<i>      I can repeatedly fetch-and-ack it, and each time redelivered=true.
</I>
That sounds like somehow the ack is malformed somehow (wrong ack tag?) 
and instead taking the channel / connection down. Is anything showing up 
in the server logs at this point?

&gt;<i> 5.  if the server reaches a state where it stops accepting messages
</I>&gt;<i>      (e.g. memory usage exceeds the high water mark) it does not send
</I>&gt;<i>      nack or return responses to basic_publish.
</I>&gt;<i>      This is both with transactions, or with channel confirm_delivery
</I>&gt;<i>      enabled.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> (5) is a concern when one requires guaranteed delivery. Having the
</I>&gt;<i> server swallow the message and not respond doesn't seem reliable to
</I>&gt;<i> me. Is there some other method I should be using for guaranteed
</I>&gt;<i> delivery?
</I>
The server is not swallowing the message without responding; it's 
stopped accepting messages altogether, and will (eventually) send 
confirms for everything it's accepted. However, in this scenario you're 
presumably hammering the server with messages, and in that case there 
can be lots of messages waiting in the OS TCP buffers - RabbitMQ hasn't 
seen them at all.

It's not clear what else RabbitMQ could do in this situation - for 
guaranteed delivery you need to treat the message as the producer's 
responsibility until you see the confirm or tx.commit-ok.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018470.html">[rabbitmq-discuss] [help] [beginner] testing with pika: some	questions and complaints
</A></li>
	<LI>Next message: <A HREF="018471.html">[rabbitmq-discuss] (no subject)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18473">[ date ]</a>
              <a href="thread.html#18473">[ thread ]</a>
              <a href="subject.html#18473">[ subject ]</a>
              <a href="author.html#18473">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
