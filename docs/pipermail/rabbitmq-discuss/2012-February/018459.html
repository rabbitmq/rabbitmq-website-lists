<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq-discuss Digest, Vol 57, Issue 28
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-discuss%20Digest%2C%20Vol%2057%2C%20Issue%2028&In-Reply-To=%3CAFFA651B612BDE4EB570E34F0571834D0E170F8B17%40mail.vfinamex.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018456.html">
   <LINK REL="Next"  HREF="018472.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq-discuss Digest, Vol 57, Issue 28</H1>
    <B>Jose Jimenez Ortiz</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq-discuss%20Digest%2C%20Vol%2057%2C%20Issue%2028&In-Reply-To=%3CAFFA651B612BDE4EB570E34F0571834D0E170F8B17%40mail.vfinamex.local%3E"
       TITLE="[rabbitmq-discuss] rabbitmq-discuss Digest, Vol 57, Issue 28">j-jimenez at finamex.com.mx
       </A><BR>
    <I>Tue Feb 28 14:56:00 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018456.html">[rabbitmq-discuss] STOMP Plugin: Alternative exchange other	than amq.topic?
</A></li>
        <LI>Next message: <A HREF="018472.html">[rabbitmq-discuss] rabbitmq-discuss Digest, Vol 57, Issue 28
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18459">[ date ]</a>
              <a href="thread.html#18459">[ thread ]</a>
              <a href="subject.html#18459">[ subject ]</a>
              <a href="author.html#18459">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I installed rabbitmq 2.7.1 and enable Rabbitmq_Management plugin but in the explorer I don't see anything on OVERVIEW panel.

Any idea?

Regards,


-----Mensaje original-----
De: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] En nombre de <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-request at lists.rabbitmq.com</A>
Enviado el: Lunes, 27 de Febrero de 2012 06:00
Para: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Asunto: rabbitmq-discuss Digest, Vol 57, Issue 28

Send rabbitmq-discuss mailing list submissions to
        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>

To subscribe or unsubscribe via the World Wide Web, visit
        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
or, via email, send a message with subject or body 'help' to
        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-request at lists.rabbitmq.com</A>

You can reach the person managing the list at
        <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-owner at lists.rabbitmq.com</A>

When replying, please edit your Subject line so it is more specific than &quot;Re: Contents of rabbitmq-discuss digest...&quot;


Today's Topics:

   1. (no subject) (jay nanavati)
   2. Apache MINA Integration (Uday Subbarayan)
   3. Problem with using rabbitmqctl on EC2 (Codevally)
   4. Re: [help] [beginner] server stops sending messages; publish
      (in transaction) hangs on commit (Alistair Bayley)
   5. dead connection lingers around? (stone)
   6. Re: Problems with STOMP &amp; access control (Steve Powell)
   7. Re: Unexpected behaviour with STOMP &amp; NACK (Steve Powell)
   8. Re: Consumers and exceptions (Jon Hill)
   9. Re: Problems with STOMP &amp; access control (Lionel Cons)
  10. Re: Ensuring low latency for publishers (Simon MacMullen)
  11. Re: STOMP doesn't include the routing-key on      MESSAGE frames
      (Steve Powell)
  12. Re: dead connection lingers around? (Simon MacMullen)
  13. Re: ??:  Passive queue declaration and channel closure
      (Simon MacMullen)
  14. Re: Apache MINA Integration (Michael Bridgen)
  15. Re: [help] [beginner] server stops sending messages; publish
      (in transaction) hangs on commit (Marek Majkowski)


----------------------------------------------------------------------

Message: 1
Date: Sun, 26 Feb 2012 18:45:39 +0000
From: jay nanavati &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jaysnanavati at hotmail.co.uk</A>&gt;
Subject: [rabbitmq-discuss] (no subject)
To: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">BAY154-W539870CC6FC7A6D83362DC99680 at phx.gbl</A>&gt;
Content-Type: text/plain; charset=&quot;windows-1252&quot;


Hi everyone,
I have followed this guide to setup rabbitMQ for android.<A HREF="http://simonwdixon.wordpress.com/2011/06/03/getting-started-with-rabbitmq-on-android-part-1/">http://simonwdixon.wordpress.com/2011/06/03/getting-started-with-rabbitmq-on-android-part-1/</A>
The problem I am facing is On the line mConsumer.connectToRabbitMQ() in the ActivityHome, I have changed it to:
mOutput.append(?\n?+mConsumer.connectToRabbitMQ());
now when I have the wrong server, it prints false as expected however when I have the write server it does not print anything. In fact it does not even print the @string/hello which it should anyways..
The app does not consume messages and I think this could be the reason.. Also I have used loger and found out that the error must be on this method because I can logg before the call however I cannot logg anything after the call.
Any help would be greatly appreciated.. Thanks!


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120226/4bea75c7/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120226/4bea75c7/attachment.html</A>&gt;

------------------------------

Message: 2
Date: Sun, 26 Feb 2012 12:51:53 -0800 (PST)
From: Uday Subbarayan &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">uday.subbarayan at yahoo.com</A>&gt;
Subject: [rabbitmq-discuss] Apache MINA Integration
To: &quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&quot;
        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Message-ID:
        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">1330289513.57728.YahooMailNeo at web44910.mail.sp1.yahoo.com</A>&gt;
Content-Type: text/plain; charset=&quot;iso-8859-1&quot;

Hi All,
? ? ?Has anyone integrated Apache MINA with Rabbit MQ to publish and receive messages?

Thanks,
-Uday.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120226/55d812e1/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120226/55d812e1/attachment-0001.htm</A>&gt;

------------------------------

Message: 3
Date: Sun, 26 Feb 2012 19:00:15 -0800 (PST)
From: Codevally &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">codevally at gmail.com</A>&gt;
Subject: [rabbitmq-discuss] Problem with using rabbitmqctl on EC2
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID:
        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">17970f1d-15cf-42a2-9b5a-f431ffd74a6d at v2g2000vbx.googlegroups.com</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1

Hi Experts

I have installed RabbitMQ 2.7.1 on EC2 (host name is ec2test2) and server getting started without any issue.

AMQP 0-9-1 / 0-9 / 0-8
Copyright (C) 2007-2011 VMware, Inc.
Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/">http://www.rabbitmq.com/</A>

node           : <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ec2test2</A>
app descriptor : /app/rabbitmq_server-2.7.1/sbin/../ebin/rabbit.app
home dir       : /root
config file(s) : (none)
cookie hash    : 4lZvwoYL5ZJbkEiBx9CgDA==
log            : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ec2test2.log</A>
sasl log       : /var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ec2test2-sasl.log</A>
database dir   : /app/rabbitmq-config/lib/rabbitmq/mnesia/
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ec2test2</A>
erlang version : 5.9

But when I try to use rabbitmqctl, I am getting the below error.

ec2test2:/app/rabbitmq/sbin # sh rabbitmqctl {error_logger,{{2012,2,27},{2,55,8}},&quot;Can't set long node name!
\nPlease check your configuration\n&quot;,[]} {error_logger,{{2012,2,27},{2,55,8}},crash_report,[[{initial_call,
{net_kernel,init,['Argument__1']}},{pid,&lt;0.20.0&gt;},{registered_name,[]},
{error_info,{exit,{error,badarg},[{gen_server,init_it,6,
[{file,&quot;gen_server.erl&quot;},{line,313}]},{proc_lib,init_p_do_apply,3,
[{file,&quot;proc_lib.erl&quot;},{line,227}]}]}},{ancestors,
[net_sup,kernel_sup,&lt;0.9.0&gt;]},{messages,[]},{links,[&lt;0.17.0&gt;]},
{dictionary,[{longnames,true}]},{trap_exit,true},{status,running},
{heap_size,6765},{stack_size,24},{reductions,2361}],[]]}

Host name is correctly configured and it displays:
ec2test2:/app/rabbitmq/sbin # hostname
ec2test2
ec2test2:/app/rabbitmq/sbin #

Could someone please explain this erroneous behavior?

Thanks.


------------------------------

Message: 4
Date: Mon, 27 Feb 2012 16:37:24 +1300
From: Alistair Bayley &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alistair at abayley.org</A>&gt;
Subject: Re: [rabbitmq-discuss] [help] [beginner] server stops sending
        messages; publish (in transaction) hangs on commit
To: Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID:
        &lt;CAKYODbip9zOg2=7xNukG6oMAGVqZHdU1ibza=<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">5+98xvUTQtzow at mail.gmail.com</A>&gt;
Content-Type: text/plain; charset=UTF-8

On 25 February 2012 00:38, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:
&gt;&gt;<i>
</I>&gt;&gt;<i> OK. Can I have some guidance as to how much memory we should allocate?
</I>&gt;<i>
</I>&gt;<i> This is a real how-long-is-a-piece-of-string question I'm afraid. 512M
</I>&gt;<i> would already be a significant step towards the comfort zone though.
</I>
rabbitmqctl report shows a large number of channels (in the thousands) and memory usage seems to correlate with the large number of channels.
I've left the server running and shut down each of the clients, and the channels have vanished from the report output, so I suspect a dodgy client here. We're using python kombu over ampqlib, so maybe kombu is doing something undesirable. A quick glance at the source shows that it has a channel pool, so maybe that's to blame. Anyway, more investigation required...

Once the number of channels is down to less than 10, the memory usage is around 32M, which seems fine to me. Maybe I don't need to allocate more, if I can solve this channels problem.


&gt;&gt;<i> Is there an
</I>&gt;&gt;<i> option to get the server to return something that says that it is not
</I>&gt;&gt;<i> accepting messages?
</I>&gt;<i>
</I>&gt;<i> In ancient history we used to do this; there's a method in AMQP 0-9-1
</I>&gt;<i> called channel.flow which the server should be able to use to tell a
</I>&gt;<i> client to shut up. In practice it was unreliable (client may not
</I>&gt;<i> support it, or may take too long to take notice of it).
</I>
I will do some more testing. Maybe the immediate flag on basic_publish will do something useful. python amqplib is protocol version 0.8, so whatever I do must fit in with that.

Alistair


------------------------------

Message: 5
Date: Mon, 27 Feb 2012 10:25:37 +0100
From: stone &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">zmstone at gmail.com</A>&gt;
Subject: [rabbitmq-discuss] dead connection lingers around?
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID:
        &lt;CAPNZrFUMw1ZarWq-cuooqw8g6FJXhCNM7xgaBuiYS=<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">a+cwHHQw at mail.gmail.com</A>&gt;
Content-Type: text/plain; charset=&quot;iso-8859-1&quot;

Hi

Have a problem while testing my Erlang client based application.
I have no idea if it's due to some bad behavior in my app or whatsoever, hope I can get some useful information here.

In my case, I have:
three rabbit nodes in a cluster;
one non-durable topic exchange;
two connections established;
several channels and queues (exclusive &amp; non-exclusive) declared.

While i'm testing, sometimes the connections they just linger around even the client has quit already.

For instance, here is one or my dead connections (copied from admin page):

AMQP 0-9-110.15.36.246:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">36526rabbit at test-app20B</A>/s(1.9kB total) 0B/s(1.1kB total)4guestrunning I'm pretty sure that the client on 10.15.36.246 has been killed already, but the connection is still in &quot;running&quot; state.

/stone
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120227/3187eb08/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120227/3187eb08/attachment-0001.htm</A>&gt;

------------------------------

Message: 6
Date: Mon, 27 Feb 2012 09:44:56 +0000
From: Steve Powell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] Problems with STOMP &amp; access control
To: Lionel Cons &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lionel.cons at cern.ch</A>&gt;
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">7245AC14-4662-4F85-B38A-EAFF206DD7EF at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=us-ascii

Lionel,

Apologies for tardy reply.

Presently there is no way to set access control based upon the STOMP names, though I agree this would be desirable. Does the STOMP specification talk about access control at all?

I think the destination names aren't all entirely opaque, so it might be possible to exert access control on some resources, but a comprehensive solution is not available, I'm afraid.

Steve Powell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>
[wrk: +44-2380-111-528] [mob: +44-7815-838-558]

On 21 Feb 2012, at 13:44, Lionel Cons wrote:

&gt;<i> I've read <A HREF="http://www.rabbitmq.com/access-control.html">http://www.rabbitmq.com/access-control.html</A> and
</I>&gt;<i> <A HREF="http://www.rabbitmq.com/stomp.html">http://www.rabbitmq.com/stomp.html</A> and I did not find any practical
</I>&gt;<i> way to use access control with STOMP.
</I>&gt;<i>
</I>&gt;<i> In the STOMP world (in fact, since STOMP is broker behavior agnostic,
</I>&gt;<i> this is rather tied to the JMS world), one can use destinations like
</I>&gt;<i> /queue/test.foo or /topic/test.bar. It would be natural to use these
</I>&gt;<i> names in the access control regexps to allow, for instance, a given
</I>&gt;<i> user to access all queues matching &quot;test\..*&quot;.
</I>&gt;<i>
</I>&gt;<i> Unfortunately, the STOMP destinations names get mapped to AMQP
</I>&gt;<i> resource names that loose the original names, for instance
</I>&gt;<i> amq.gen-AXVr2gFuBTO4duQ5OEC9b9.
</I>&gt;<i>
</I>&gt;<i> Is there a way in RabbitMQ to use access control based on the STOMP
</I>&gt;<i> destination names?
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Lionel
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>


------------------------------

Message: 7
Date: Mon, 27 Feb 2012 10:21:39 +0000
From: Steve Powell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] Unexpected behaviour with STOMP &amp; NACK
To: Lionel Cons &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lionel.cons at cern.ch</A>&gt;
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">C71F5D87-E010-4007-8CEB-7560CCEBFFD7 at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=us-ascii

Lionel,

Apologies for the tardy reply.

Thank you for reporting this. What is happening is that the NACK sets the 'requeue=true' flag, which, by definition, puts the message back on its queue.
It is then available for redelivery. Whether it gets redelivered to the same consumer depends on lots of things, but is entirely possible, and is expected when there is only one consumer.

Currently, we expect this behaviour and did not think it was prohibited by the specification.

If this is determined to violate the specification we could set requeue=false on NACK, then neither this client, nor any other, will see the message; which is allowable server behaviour. There is currently no mechanism for re-routing messages that are NACKd, but this may change in the near future.

Steve Powell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>
[wrk: +44-2380-111-528] [mob: +44-7815-838-558]

On 22 Feb 2012, at 12:24, Lionel Cons wrote:

&gt;<i> I get an unexpected behaviour with STOMP &amp; NACK with RabbitMQ 2.7.1.
</I>&gt;<i>
</I>&gt;<i> Here is my test, using an empty queue.
</I>&gt;<i> - client1 connects, sends a message to the queue and disconnects
</I>&gt;<i> - client2 connects, subscribes to the queue with ack:client
</I>&gt;<i> - client2 receives the message (so far so good) but does not ack it
</I>&gt;<i> - client3 connects, subscribes to the queue
</I>&gt;<i> - client2 sends a NACK frame for the message
</I>&gt;<i> - client2 receives the message once more
</I>&gt;<i> - client3 receives nothing
</I>&gt;<i>
</I>&gt;<i> I would have expected the other client (client3) to receive the
</I>&gt;<i> message that has not been consumed by client2. In fact, this is how
</I>&gt;<i> ActiveMQ and Apollo work.
</I>&gt;<i>
</I>&gt;<i> FWIW, the STOMP 1.1 spec mentions:
</I>&gt;<i>
</I>&gt;<i> | NACK is the opposite of ACK. It is used to tell the server that the
</I>&gt;<i> | client did not consume the message. The server can then either send
</I>&gt;<i> | the message to a different client, discard it, or put it in a dead
</I>&gt;<i> | letter queue. The exact behavior is server specific.
</I>&gt;<i>
</I>&gt;<i> So, although the behavior is not strictly defined, re-sending the
</I>&gt;<i> message to the same client does not look appropriate to me.
</I>&gt;<i>
</I>&gt;<i> What do you think?
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Lionel
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>


------------------------------

Message: 8
Date: Mon, 27 Feb 2012 02:30:15 -0800 (PST)
From: Jon Hill &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jon.hill at comshen.com</A>&gt;
Subject: Re: [rabbitmq-discuss] Consumers and exceptions
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID:
        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">3b4977f4-5f27-4b7b-97bc-64606fc3acc9 at hs8g2000vbb.googlegroups.com</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1

Steve

Many thanks for the reply. That makes sense, and I am now progressing.

All the best

Jon


------------------------------

Message: 9
Date: Mon, 27 Feb 2012 11:31:45 +0100
From: Lionel Cons &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">lionel.cons at cern.ch</A>&gt;
Subject: Re: [rabbitmq-discuss] Problems with STOMP &amp; access control
To: Steve Powell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt;
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">20299.23441.992131.685344 at mail.cern.ch</A>&gt;
Content-Type: text/plain; charset=&quot;us-ascii&quot;

Steve Powell writes:
 &gt; Does the STOMP specification talk about access control at all?

No. The specification does not describe the broker behavior. Even something like &quot;/topic/foo&quot; means a JMS-style topic named &quot;foo&quot; is outside of the spec.

 &gt; I think the destination names aren't all entirely opaque, so it  &gt; might be possible to exert access control on some resources, but a  &gt; comprehensive solution is not available, I'm afraid.

It seems that things might work with queues since a STOMP destination of &quot;/queue/foo&quot; will AFAIK use a queue named &quot;foo&quot;. To be confirmed.

Topics are more problematic but this does not seem to be STOMP specific.

In AMQP, how would you configure the RabbitMQ ACLs so that client A can only send to amq.topic with a routing key matching A.* while client B is restrcited to routing keys matching B.*?

The <A HREF="http://www.rabbitmq.com/access-control.html">http://www.rabbitmq.com/access-control.html</A> page does not really describe what a reource is. Would a syntax like amq.topic:A.* make sense to perform routing key based access control?

Cheers,

Lionel


------------------------------

Message: 10
Date: Mon, 27 Feb 2012 10:42:00 +0000
From: Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] Ensuring low latency for publishers
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">4F4B5DF8.5090500 at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

On 24/02/12 18:07, Eric wrote:
&gt;<i> In reality, the throttling case is extremely unlikely anyway, right?
</I>&gt;<i> You basically have to create a case where publishers are outpacing
</I>&gt;<i> consumers and/or the speed of disk writes on the broker.  So you'd
</I>&gt;<i> have to publish something like 100mb/s with little or no consumption,
</I>&gt;<i> and our application is roughly 5mb/minute.
</I>
With small messages in fact the first thing you run into is being CPU-bound making routing decisions. But the general principle holds, yes.

&gt;<i> In conclusion, I finally did what I should have done in the first
</I>&gt;<i> place.  I mocked up the threading scenario we're likely to see in
</I>&gt;<i> production and benchmarked it against Java's LinkedBlockingQueue and
</I>&gt;<i> ArrayBlockingQueue.  Compared to each producer thread having its own
</I>&gt;<i> linked list (the completely uncontended scenario) the blocking queues
</I>&gt;<i> introduced virtually no additional waiting - a microsecond or two at
</I>&gt;<i> most.  That's the case even at rates 50x or more than we'd see in
</I>&gt;<i> production.  So blocking queue it is, and that's a comfortingly simple
</I>&gt;<i> solution.
</I>&gt;<i>
</I>&gt;<i> Thanks for all the help and apologies for under-researching what I was
</I>&gt;<i> doing.
</I>
Ah, good.

I had a quick look at implementing non-blocking publish on Java on Friday. Unfortunately it's not possible to do this without NIO on Java, so a prerequisite becomes &quot;port the Java client to NIO&quot;, which... makes it less likely to happen I'm afraid.

Cheers, Simon

--
Simon MacMullen
RabbitMQ, VMware


------------------------------

Message: 11
Date: Mon, 27 Feb 2012 10:56:09 +0000
From: Steve Powell &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] STOMP doesn't include the routing-key
        on      MESSAGE frames
To: Tony Garnock-Jones &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonygarnockjones+rabbitmq at gmail.com</A>&gt;
Cc: RabbitMQ Discuss &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">5E2DB83D-C02B-48D6-97C2-FDB76643B855 at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=us-ascii

Tony,

Read your patch, and prefer this solution to adding extra headers.

I'm raising a bug (24763) to fix our spec-compliance problem (thank you for
pointing this out), and see if we can get this change in.

Steve Powell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>
[wrk: +44-2380-111-528] [mob: +44-7815-838-558]

On 20 Feb 2012, at 20:36, Tony Garnock-Jones wrote:

&gt;<i> Hi Steve,
</I>&gt;<i>
</I>&gt;<i> How about the attached patch? It attempts to bring the &quot;destination&quot;
</I>&gt;<i> header in MESSAGEs in to line with the STOMP 1.1 spec. I've paid
</I>&gt;<i> cursory attention to binary-and-slash-escaping issues but it could use
</I>&gt;<i> a second glance before being committed, I reckon.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>  Tony
</I>&gt;<i>
</I>&gt;<i> On 20 February 2012 14:56, Tony Garnock-Jones
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonygarnockjones+rabbitmq at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> Adding the routing_key puts the final small missing piece in place. A
</I>&gt;&gt;<i> perhaps more STOMPish way of giving it would be to have a &quot;to&quot; header
</I>&gt;&gt;<i> or similar carried in a MESSAGE, containing the full destination given
</I>&gt;&gt;<i> in the SEND. Oh wait! I've just checked, and actually that's what's
</I>&gt;&gt;<i> required by the 1.1 spec already. So the STOMP adapter isn't quite
</I>&gt;&gt;<i> spec-compliant, in that it's giving the destination from the
</I>&gt;&gt;<i> *subscribe* rather than the *send*.
</I>&gt;<i> --
</I>&gt;<i> Tony Garnock-Jones
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonygarnockjones at gmail.com</A>
</I>&gt;<i> <A HREF="http://homepages.kcbbs.gen.nz/tonyg/">http://homepages.kcbbs.gen.nz/tonyg/</A>
</I>&gt;<i> &lt;better-destination-patch.patch&gt;
</I>


------------------------------

Message: 12
Date: Mon, 27 Feb 2012 11:05:56 +0000
From: Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] dead connection lingers around?
To: stone &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">zmstone at gmail.com</A>&gt;
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">4F4B6394.10903 at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi.

Sometimes if a TCP connection gets killed outright the OS never notices
and so we don't know either.

This probably implies you are not closing connections properly? (i.e.
with the AMQP close handshake, by invoking amqp_connection:close/1.)

Enabling AMQP heartbeats will allow RabbitMQ to detect this condition.

Cheers, Simon

On 27/02/12 09:25, stone wrote:
&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> Have a problem while testing my Erlang client based application.
</I>&gt;<i> I have no idea if it's due to some bad behavior in my app or whatsoever,
</I>&gt;<i> hope I can get some useful information here.
</I>&gt;<i>
</I>&gt;<i> In my case, I have:
</I>&gt;<i> three rabbit nodes in a cluster;
</I>&gt;<i> one non-durable topic exchange;
</I>&gt;<i> two connections established;
</I>&gt;<i> several channels and queues (exclusive &amp; non-exclusive) declared.
</I>&gt;<i>
</I>&gt;<i> While i'm testing, sometimes the connections they just linger around
</I>&gt;<i> even the client has quit already.
</I>&gt;<i>
</I>&gt;<i> For instance, here is one or my dead connections (copied from admin page):
</I>&gt;<i>
</I>&gt;<i> AMQP 0-9-1    10.15.36.246:36526 &lt;<A HREF="http://10.15.36.246:36526">http://10.15.36.246:36526</A>&gt;
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at test-app2</A>      0B/s_(1.9kB total)      0B/s_(1.1kB total)      4       guest   running
</I>&gt;<i>
</I>&gt;<i> I'm pretty sure that the client on 10.15.36.246 has been killed already,
</I>&gt;<i> but the connection is still in &quot;running&quot; state.
</I>&gt;<i>
</I>&gt;<i> /stone
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

--
Simon MacMullen
RabbitMQ, VMware


------------------------------

Message: 13
Date: Mon, 27 Feb 2012 11:06:49 +0000
From: Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] ??:  Passive queue declaration and
        channel closure
To: Simone Busoli &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simone.busoli at gmail.com</A>&gt;
Cc: &quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&quot;
        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">4F4B63C9.7070909 at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=GB2312

On 25/02/12 18:37, Simone Busoli wrote:
&gt;<i> David, I somewhat agree with you, lack of documentation about
</I>&gt;<i> operational aspects of broker behavior is something I have been missing
</I>&gt;<i> as well.
</I>
Yeah, I suspect our documentation could still be better. But this is one
of the areas where it's really easy to be blinded by over-familiarity.
What sort of things do you think are particularly missing?

Cheers, Simon

--
Simon MacMullen
RabbitMQ, VMware


------------------------------

Message: 14
Date: Mon, 27 Feb 2012 11:43:12 +0000
From: Michael Bridgen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mikeb at rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] Apache MINA Integration
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Message-ID: &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">4F4B6C50.9070702 at rabbitmq.com</A>&gt;
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

&gt;<i> Has anyone integrated Apache MINA with Rabbit MQ to publish and receive
</I>&gt;<i> messages?
</I>
What form would you expect such an integration to take?


------------------------------

Message: 15
Date: Mon, 27 Feb 2012 11:49:18 +0000
From: Marek Majkowski &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">majek04 at gmail.com</A>&gt;
Subject: Re: [rabbitmq-discuss] [help] [beginner] server stops sending
        messages; publish (in transaction) hangs on commit
To: Alistair Bayley &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alistair at abayley.org</A>&gt;
Cc: rabbitmq-discuss &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Message-ID:
        &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">CABzX+qznWcOPTsLob0w+uK0vUg7GBbOqot0EzhbKud12DDLAJQ at mail.gmail.com</A>&gt;
Content-Type: text/plain; charset=UTF-8

On Mon, Feb 27, 2012 at 03:37, Alistair Bayley &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alistair at abayley.org</A>&gt; wrote:
&gt;<i> On 25 February 2012 00:38, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> OK. Can I have some guidance as to how much memory we should allocate?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is a real how-long-is-a-piece-of-string question I'm afraid. 512M would
</I>&gt;&gt;<i> already be a significant step towards the comfort zone though.
</I>&gt;<i>
</I>&gt;<i> rabbitmqctl report shows a large number of channels (in the thousands)
</I>&gt;<i> and memory usage seems to correlate with the large number of channels.
</I>&gt;<i> I've left the server running and shut down each of the clients, and
</I>&gt;<i> the channels have vanished from the report output, so I suspect a
</I>&gt;<i> dodgy client here. We're using python kombu over ampqlib, so maybe
</I>&gt;<i> kombu is doing something undesirable. A quick glance at the source
</I>&gt;<i> shows that it has a channel pool, so maybe that's to blame. Anyway,
</I>&gt;<i> more investigation required...
</I>
Right. This is definitely possible that channels are the main
thing that consumes memory.

&gt;<i> Once the number of channels is down to less than 10, the memory usage
</I>&gt;<i> is around 32M, which seems fine to me. Maybe I don't need to allocate
</I>&gt;<i> more, if I can solve this channels problem.
</I>
Yup, quite possible.

&gt;&gt;&gt;<i> Is there an
</I>&gt;&gt;&gt;<i> option to get the server to return something that says that it is not
</I>&gt;&gt;&gt;<i> accepting messages?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In ancient history we used to do this; there's a method in AMQP 0-9-1 called
</I>&gt;&gt;<i> channel.flow which the server should be able to use to tell a client to shut
</I>&gt;&gt;<i> up. In practice it was unreliable (client may not support it, or may take
</I>&gt;&gt;<i> too long to take notice of it).
</I>&gt;<i>
</I>&gt;<i> I will do some more testing. Maybe the immediate flag on basic_publish
</I>&gt;<i> will do something useful. python amqplib is protocol version 0.8, so
</I>&gt;<i> whatever I do must fit in with that.
</I>
Nope, &quot;immediate&quot; flag is a completely unrelated:
  <A HREF="http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.publish">http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.publish</A>

Marek


------------------------------

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>


End of rabbitmq-discuss Digest, Vol 57, Issue 28
************************************************
</PRE>
































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018456.html">[rabbitmq-discuss] STOMP Plugin: Alternative exchange other	than amq.topic?
</A></li>
	<LI>Next message: <A HREF="018472.html">[rabbitmq-discuss] rabbitmq-discuss Digest, Vol 57, Issue 28
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18459">[ date ]</a>
              <a href="thread.html#18459">[ thread ]</a>
              <a href="subject.html#18459">[ subject ]</a>
              <a href="author.html#18459">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
