<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Using%20Pika%20Python%20client%20library%20with%0A%20BlockingConnections%20and%20publisher-confirms%20-%20Does%20it%20work%3F&In-Reply-To=%3CEC33259C71DB461EA0F4BE4D2FE04F2C%40myyearbook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017955.html">
   <LINK REL="Next"  HREF="017958.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?</H1>
    <B>Gavin M. Roy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Using%20Pika%20Python%20client%20library%20with%0A%20BlockingConnections%20and%20publisher-confirms%20-%20Does%20it%20work%3F&In-Reply-To=%3CEC33259C71DB461EA0F4BE4D2FE04F2C%40myyearbook.com%3E"
       TITLE="[rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?">gmr at myyearbook.com
       </A><BR>
    <I>Mon Feb  6 18:47:14 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017955.html">[rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?
</A></li>
        <LI>Next message: <A HREF="017958.html">[rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17956">[ date ]</a>
              <a href="thread.html#17956">[ thread ]</a>
              <a href="subject.html#17956">[ subject ]</a>
              <a href="author.html#17956">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There are multiple ways, the best from my perspective is Publisher confirms: <A HREF="http://www.rabbitmq.com/extensions.html#confirms">http://www.rabbitmq.com/extensions.html#confirms</A>

Using Pika, you'll have to grab the master branch at github as 0.9.5 does not support them and 0.9.6 is not released yet (though I am making progress in adding the test coverage I'd like to have there prior to releasing it)

Here's the method to enable it:

<A HREF="https://github.com/pika/pika/blob/master/pika/channel.py#L527">https://github.com/pika/pika/blob/master/pika/channel.py#L527</A>

In short:

channel.confirm_delivery(delivery_confirmation_callback)

When a message is delivered, you'll now get a callback frame/message to the delivery_confirmation_callback method (whatever you replace that with).

In doing this you'll need to keep track of what you published, sequence wise on the channel to use to validate the delivery tag in the Basic.Ack frame.

Hope this helps,

Gavin


On Monday, February 6, 2012 at 1:29 PM, Matt Pietrek wrote:

&gt;<i> Thanks Ask and Marek for your replies.
</I>&gt;<i> 
</I>&gt;<i> Let me circle back to the original issue. Our system just needs a reliable way of knowing that once we've published a message, that it's safely in the broker. The exact mechanics aren't particularly important.
</I>&gt;<i> 
</I>&gt;<i> Obviously transactions will work, but they slow things down to the point where we're doubting the system performance will meet our needs. I'm happy to experiment with publisher-confirms, but it seems that given our simple, synchronous pattern, aren't easy to incorporate without contorting the code. Perhaps I'm wrong, and if so, feel free to correct me.
</I>&gt;<i> 
</I>&gt;<i> What's your take here? What's the best path forward?
</I>&gt;<i> 
</I>&gt;<i> In a related question, can either of you offer some insights on the planned futures of Pika / Puka / Kombu in terms of being client libraries we should rely on for commercial app development?
</I>&gt;<i> 
</I>&gt;<i> Obviously if there were an official RabbitMQ Python client library, we'd choose that. In the absence of that, we're trying to evaluate the viability of Pika/Puka/Kombu, and whatever else is out there. However, it's hard to get a sense for what is &quot;the future&quot; and what may not be a good choice 3 years from now.
</I>&gt;<i> 
</I>&gt;<i> Thanks again,
</I>&gt;<i> 
</I>&gt;<i> Matt
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>)
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120206/4c08c90a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120206/4c08c90a/attachment.htm</A>&gt;
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017955.html">[rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?
</A></li>
	<LI>Next message: <A HREF="017958.html">[rabbitmq-discuss] Using Pika Python client library with BlockingConnections and publisher-confirms - Does it work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17956">[ date ]</a>
              <a href="thread.html#17956">[ thread ]</a>
              <a href="subject.html#17956">[ subject ]</a>
              <a href="author.html#17956">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
