<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%202.7.1%20mirrored%20queues%20leak%20a%20lot%20of%20memory%0A%20on%20slave%20nodes&In-Reply-To=%3CCAChq9g3%3DAWMD0kMioxML4i0Kj3Q_WJPaYgCw36Vm%2BUfVBZP8Rw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018348.html">
   <LINK REL="Next"  HREF="018386.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes</H1>
    <B>Travis</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%202.7.1%20mirrored%20queues%20leak%20a%20lot%20of%20memory%0A%20on%20slave%20nodes&In-Reply-To=%3CCAChq9g3%3DAWMD0kMioxML4i0Kj3Q_WJPaYgCw36Vm%2BUfVBZP8Rw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes">hcoyote at ghostar.org
       </A><BR>
    <I>Wed Feb 22 23:24:34 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018348.html">[rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes
</A></li>
        <LI>Next message: <A HREF="018386.html">[rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18350">[ date ]</a>
              <a href="thread.html#18350">[ thread ]</a>
              <a href="subject.html#18350">[ subject ]</a>
              <a href="author.html#18350">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Feb 22, 2012 at 3:58 PM, Travis &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">hcoyote at ghostar.org</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> I think we're experiencing the same thing. &#160;Previously, we were seeing
</I>&gt;<i> a memory leak in 2.6.1 which was patched[1] in subsequent releases.
</I>&gt;<i> Since then, we've upgraded to 2.7.1 as well and we're seeing slowly
</I>&gt;<i> growing memory usage on our slaves that requires us to restart the
</I>&gt;<i> slaves periodically to keep the memory usage down.
</I>&gt;<i>
</I>&gt;<i> In our case, we're using only two nodes with mirrored queues.
</I>&gt;<i>
</I>
Also, just to show how bad the problem is, I've uploaded (to imgur) a
graph of the memory utilization to for the slave over the last few
weeks.

<A HREF="http://i.imgur.com/dBNO8.png">http://i.imgur.com/dBNO8.png</A>

We currently set the vm highwater mark to 10% (which ends up being
2.4GB of ram available to the system).

As you can see, we had flat memory utilization up until about week 5.
There's a small dip (where we turned things off for abit to upgrade
from 2.6.1 (with the previously mentioned patch) to 2.7.1.  After
that, memory has grown pretty steadily.  The points where it has going
almost down to zero usage after that was right after restarts of the
rabbitmq-server on this node.

Travis
-- 
Travis Campbell
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">travis at ghostar.org</A>
</PRE>



























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018348.html">[rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes
</A></li>
	<LI>Next message: <A HREF="018386.html">[rabbitmq-discuss] 2.7.1 mirrored queues leak a lot of memory on slave nodes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18350">[ date ]</a>
              <a href="thread.html#18350">[ thread ]</a>
              <a href="subject.html#18350">[ subject ]</a>
              <a href="author.html#18350">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
