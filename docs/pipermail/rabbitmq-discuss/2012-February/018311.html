<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Re  storing a message to the queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Re%20%20storing%20a%20message%20to%20the%20queue&In-Reply-To=%3C33364165.post%40talk.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018294.html">
   <LINK REL="Next"  HREF="018295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Re  storing a message to the queue</H1>
    <B>Bamboula</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Re%20%20storing%20a%20message%20to%20the%20queue&In-Reply-To=%3C33364165.post%40talk.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Re  storing a message to the queue">aloroi18 at gmail.com
       </A><BR>
    <I>Tue Feb 21 14:14:57 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018294.html">[rabbitmq-discuss] Re storing a message to the queue
</A></li>
        <LI>Next message: <A HREF="018295.html">[rabbitmq-discuss] Bug in management plugin escaping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18311">[ date ]</a>
              <a href="thread.html#18311">[ thread ]</a>
              <a href="subject.html#18311">[ subject ]</a>
              <a href="author.html#18311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

Thanks for your quick reply. I think that my problem is not really to
restore a message, because if I check with the RabbitMQ command line (using
&quot;rabbitmqctl list_queues&quot;),I can see that the message I sent is stored in
the queue. My problem is rather to be able to retrieve the message to my
consumer GUI.
 I've created a project (with C# .net) where the consumer can choose whether
he wants to be connected or disconnected from the queue.

When the consumer chooses the disconnect radiobutton, I'm writing in the
consumer form:

consumer.onMessageReceived -= handleMessage;

This causes to go to the catch of this loop:
 
            while (isConsuming)
            {
                try
                {
                    RabbitMQ.Client.Events.BasicDeliverEventArgs e =
(RabbitMQ.Client.Events.BasicDeliverEventArgs)consumer.Queue.Dequeue();

                    IBasicProperties props = e.BasicProperties;
                    byte[] body = e.Body;
                    // ... process the message
                    onMessageReceived(body);
                    Model.BasicAck(e.DeliveryTag,true);

                }
                catch
                {
                    Model.BasicCancel(consumerTag);
                    break;
                }

Now, the producer sends a message, and the message is stocked in the queue.
Then, the consumer chooses the Connect RadioButton. I'm expecting to see the
message on the consumer GUI, but I'm not.
I checked the consumer instance's properties during debugging and I saw
that:m_queue count=0. This explains why I don't see any message on my
consumer GUI.

If I do the same experience with more than one message, I will be able to
retrieve all the messages except the first one.

I think that the reason to this is that the consumer instance goes through a
Dequeue() before the user chooses the disconnect radiobutton and maybe due
to this, there is no possibility to retrieve the message from the queue.
But maybe I'm wrong. However, the problem is still the same: I can't
retrieve the first message.

Could you help me?if you can't, give me a link to someone who could help.
Thanks a lot,I've been working on this for several days

Bamboula

Alvaro Videla-2 wrote:
&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> It all depends on why you want the message to be back in the queue. Also
</I>&gt;<i> do
</I>&gt;<i> you want the exact message to be back in the queue or just the contents of
</I>&gt;<i> it?
</I>&gt;<i> 
</I>&gt;<i> If you want the exact message you can basic.reject it I guess. See the
</I>&gt;<i> Spec
</I>&gt;<i> here: <A HREF="http://www.rabbitmq.com/amqp-0-9-1-quickref.html">http://www.rabbitmq.com/amqp-0-9-1-quickref.html</A>
</I>&gt;<i> 
</I>&gt;<i> If you just want the msg body back in the queue then you can republish the
</I>&gt;<i> message body.
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Alvaro
</I>&gt;<i> 
</I>&gt;<i> On Tue, Feb 21, 2012 at 10:29 AM, Bamboula &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aloroi18 at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> After using Dequeue() to my queue, I want to restore the retrieved
</I>&gt;&gt;<i> message
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> the queue. Is this possible?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> View this message in context:
</I>&gt;&gt;<i> <A HREF="http://old.nabble.com/Restoring-a-message-to-the-queue-tp33362597p33362597.html">http://old.nabble.com/Restoring-a-message-to-the-queue-tp33362597p33362597.html</A>
</I>&gt;&gt;<i> Sent from the RabbitMQ mailing list archive at Nabble.com.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-- 
View this message in context: <A HREF="http://old.nabble.com/Restoring-a-message-to-the-queue-tp33362597p33364165.html">http://old.nabble.com/Restoring-a-message-to-the-queue-tp33362597p33364165.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.

</PRE>
















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018294.html">[rabbitmq-discuss] Re storing a message to the queue
</A></li>
	<LI>Next message: <A HREF="018295.html">[rabbitmq-discuss] Bug in management plugin escaping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18311">[ date ]</a>
              <a href="thread.html#18311">[ thread ]</a>
              <a href="subject.html#18311">[ subject ]</a>
              <a href="author.html#18311">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
