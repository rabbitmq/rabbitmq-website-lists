<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] basicpublish Android to Java?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20basicpublish%20Android%20to%20Java%3F&In-Reply-To=%3Cae47ffd7-af81-4b01-80ec-d7285635b90d%40p21g2000yqm.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018263.html">
   <LINK REL="Next"  HREF="018269.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] basicpublish Android to Java?</H1>
    <B>Kamran</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20basicpublish%20Android%20to%20Java%3F&In-Reply-To=%3Cae47ffd7-af81-4b01-80ec-d7285635b90d%40p21g2000yqm.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] basicpublish Android to Java?">muhammad.kamrana at gmail.com
       </A><BR>
    <I>Mon Feb 20 13:30:31 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018263.html">[rabbitmq-discuss] basicpublish Android to Java?
</A></li>
        <LI>Next message: <A HREF="018269.html">[rabbitmq-discuss] basicpublish Android to Java?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18268">[ date ]</a>
              <a href="thread.html#18268">[ thread ]</a>
              <a href="subject.html#18268">[ subject ]</a>
              <a href="author.html#18268">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry for my brief message, actually no error is shown. As in java
tutorial one, we get the message &quot;&quot;message&quot; received&quot; I don't receive
anything on the receiver side. &quot;rabbitmqctl list_queues&quot; don't show
any errors either and it shows the creation of queues. By the way I
have tried with different parameters in &quot;exchangedeclare&quot; and
&quot;queuedeclare&quot;, but nothing is working for me. Thanks for the help!

The android code is:

public class ActivityHome extends Activity {
	private MessageConsumer mConsumer;
	private TextView mOutput;
&#160; &#160; private final static String QUEUE_NAME = &quot;hello&quot;;
&#160; &#160; private final static String EXCHANGE_NAME = &quot;logs&quot;;
&#160; &#160; /** Called when the activity is first created. */
&#160; &#160; @Override
&#160; &#160; public void onCreate(Bundle savedInstanceState) {
&#160; &#160; &#160; &#160; super.onCreate(savedInstanceState);
&#160; &#160; &#160; &#160; setContentView(R.layout.main);
&#160; &#160; &#160; &#160; //The output TextView we'll use to display messages
&#160; &#160; &#160; &#160; mOutput = &#160;(TextView) findViewById(R.id.output);
&#160; &#160; &#160; &#160;//Create the consumer
&#160; &#160; &#160; &#160; mConsumer = new
MessageConsumer(&quot;192.168.2.3&quot;,&quot;logs&quot;,&quot;fanout&quot;);
&#160; &#160; &#160; &#160; //Connect to broker
&#160; &#160; &#160; &#160; mConsumer.connectToRabbitMQ();
&#160; &#160; &#160; &#160; //register for messages
&#160; &#160; &#160; &#160; mConsumer.setOnReceiveMessageHandler(new
OnReceiveMessageHandler(){
			public void onReceiveMessage(byte[] message) {
				String text = &quot;&quot;;
				try {
					text = new String(message, &quot;UTF8&quot;);
				} catch (UnsupportedEncodingException e) {
					e.printStackTrace();
				}
				mOutput.append(&quot;\n&quot;+text);
			}
&#160; &#160; &#160; &#160;});
&#160; &#160; &#160; &#160; MessageSender Sender = new
MessageSender(&quot;192.168.2.3&quot;,&quot;logs&quot;,&quot;fanout&quot;);
&#160; &#160; &#160; &#160; Sender.connectToRabbitMQ();
&#160; &#160; &#160; ConnectionFactory factory = new ConnectionFactory();
&#160; &#160; &#160; &#160; factory.setHost(&quot;sethost&quot;);
&#160; &#160; &#160; &#160; try{
&#160; &#160; &#160; &#160; Connection connection = factory.newConnection();
&#160; &#160; &#160; &#160; Channel channel = connection.createChannel();
&#160; &#160; &#160; &#160; channel.queueDeclare(QUEUE_NAME, false, false, false, null);
&#160; &#160; &#160; &#160; String message = &quot;Kamran Android E&quot;;
&#160; &#160; &#160; &#160; channel.basicPublish(EXCHANGE_NAME, QUEUE_NAME, null,
message.getBytes());
&#160; &#160; &#160; &#160; System.out.println(&quot; [x] Sent '&quot; + message + &quot;'&quot;);

&#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; catch (Exception e) {
			// TODO: handle exception
		e.printStackTrace();
&#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160;mOutput.append(&quot;\nSent&quot;);
&#160; &#160; }
&#160; &#160; @Override
	protected void onResume() {
		super.onPause();
		mConsumer.connectToRabbitMQ();
	}
	@Override
	protected void onPause() {
		super.onPause();
		mConsumer.dispose();
	}
}

This is the receiver code:

public class Recv {
&#160; &#160; private final static String QUEUE_NAME = &quot;hello&quot;;
&#160; &#160; private final static String EXCHANGE_NAME = &quot;logs&quot;;
&#160; &#160; public static void main(String[] argv) throws Exception {
&#160; &#160; ConnectionFactory factory = new ConnectionFactory();
&#160; &#160; factory.setHost(&quot;localhost&quot;);
&#160; &#160; Connection connection = factory.newConnection();
&#160; &#160; Channel channel = connection.createChannel();
&#160; &#160; channel.exchangeDeclare(EXCHANGE_NAME,&quot;fanout&quot;, true);
&#160; &#160; channel.queueDeclare(QUEUE_NAME, false, false, false, null);
&#160; &#160; System.out.println(&quot; [*] Waiting for messages. To exit press CTRL
+C&quot;);
&#160; &#160; QueueingConsumer consumer = new QueueingConsumer(channel);
&#160; &#160; channel.basicConsume(QUEUE_NAME, false, consumer);
&#160; &#160; while (true) {
&#160; &#160; &#160; QueueingConsumer.Delivery delivery = consumer.nextDelivery();
&#160; &#160; &#160; String message = new String(delivery.getBody());
&#160; &#160; &#160; System.out.println(&quot; [x] Received '&quot; + message + &quot;'&quot;);
&#160; &#160; }
&#160; }

On Feb 20, 1:31&#160;pm, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">em... at rabbitmq.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> On 20/02/12 11:56, Kamran wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; &#160; &#160; &#160; &#160; &#160; &#160; Yes when I have Java Client in Android. Then a publish via
</I>&gt;<i> &gt; &quot;basicpublish&quot; from Android should go to &quot;basicconsume&quot; in Java file
</I>&gt;<i> &gt; (the receive file in tutorial one). Unfortunately it is not working
</I>&gt;<i> &gt; for me.
</I>&gt;<i>
</I>&gt;<i> When you say this is not working, can you explain what your expectation
</I>&gt;<i> is and how it fails to be met? Did you get any error messages? Does the
</I>&gt;<i> information reported by &quot;rabbitmqctl list_queues&quot; shed any light? Does
</I>&gt;<i> the client receive an exception? In that case how far does it get?
</I>&gt;<i>
</I>&gt;<i> -Emile
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I></PRE>



















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018263.html">[rabbitmq-discuss] basicpublish Android to Java?
</A></li>
	<LI>Next message: <A HREF="018269.html">[rabbitmq-discuss] basicpublish Android to Java?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18268">[ date ]</a>
              <a href="thread.html#18268">[ thread ]</a>
              <a href="subject.html#18268">[ subject ]</a>
              <a href="author.html#18268">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
