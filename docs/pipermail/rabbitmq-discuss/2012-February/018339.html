<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ crash after few hours
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20crash%20after%20few%20hours&In-Reply-To=%3C4F452713.6000007%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018338.html">
   <LINK REL="Next"  HREF="018345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ crash after few hours</H1>
    <B>Artsiom</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20crash%20after%20few%20hours&In-Reply-To=%3C4F452713.6000007%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ crash after few hours">u2.storm at gmail.com
       </A><BR>
    <I>Wed Feb 22 17:34:11 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018338.html">[rabbitmq-discuss] RabbitMQ crash after few hours
</A></li>
        <LI>Next message: <A HREF="018345.html">[rabbitmq-discuss] timestamp basic property looses milliseconds?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18339">[ date ]</a>
              <a href="thread.html#18339">[ thread ]</a>
              <a href="subject.html#18339">[ subject ]</a>
              <a href="author.html#18339">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for reply.
/
/usr/lib/rabbitmq/bin/rabbitmq-env: fork: retry: Resource temporarily
unavailable
/
I've checked that no limit of processes was reached (over 300 proc. were 
running),
I was able to start new processes. May be there was a file lock on one 
of the (configuration?) files?
This error disappeared when local rabbitmq broker have become able to 
see other brokers.

Most of all I'm interested why 3 nodes crashed at once and why following 
message appeared:

     =ERROR REPORT==== 14-Feb-2012::19:13:47 ===
     ** Generic server &lt;0.1093.0&gt; terminating
     ** Last message in was {<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mnesia_locker,wosnfs at dell39</A>,granted}
     ** When Server state == 5
     ** Reason for termination ==
     ** {unexpected_info,{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mnesia_locker,wosnfs at dell39</A>,granted}}

Following error messages may be the consuquece of this.
Look forward to results of your investigation.

P.S. better way to recover cluster is (to leave cluster if possible), 
clear mnesia on crashed nodes and rejoin them?

On 02/22/2012 08:07 PM, Simon MacMullen wrote:
&gt;<i> On 22/02/12 16:13, Artsiom wrote:
</I>&gt;&gt;<i> /usr/lib/rabbitmq/bin/rabbitmq-env: fork: retry: Resource temporarily
</I>&gt;&gt;<i> unavailable
</I>&gt;<i>
</I>&gt;<i> This implies that you're running into some OS-imposed limit on the 
</I>&gt;<i> number of (OS not Erlang) processes. When you do that, Bad Things are 
</I>&gt;<i> likely to happen.
</I>&gt;<i>
</I>&gt;<i> I also see a bunch of errors along the lines of:
</I>&gt;<i>
</I>&gt;<i> =ERROR REPORT==== 14-Feb-2012::20:51:30 ===
</I>&gt;<i> Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">wosnfs at dell39</A>): ** ERROR ** mnesia_event got 
</I>&gt;<i> {inconsistent_database, running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">wosnfs at dell33</A>}
</I>&gt;<i>
</I>&gt;<i> in machine 4's log, which is another bad sign - RabbitMQ clusters are 
</I>&gt;<i> not designed to tolerate network partitions.
</I>&gt;<i>
</I>&gt;<i> I'll look into some of the other error messages that are showing up in 
</I>&gt;<i> your logs; it's possible some of then are real, but you have some bad 
</I>&gt;<i> things going on underneath RabbitMQ - you need to sort those out first,
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>--
Best regards,
Artsiom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120222/97d33609/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120222/97d33609/attachment.htm</A>&gt;
</PRE>































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018338.html">[rabbitmq-discuss] RabbitMQ crash after few hours
</A></li>
	<LI>Next message: <A HREF="018345.html">[rabbitmq-discuss] timestamp basic property looses milliseconds?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18339">[ date ]</a>
              <a href="thread.html#18339">[ thread ]</a>
              <a href="subject.html#18339">[ subject ]</a>
              <a href="author.html#18339">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
