<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Initiating queue monitoring, but returning to main method with indication of success
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Initiating%20queue%20monitoring%2C%0A%20but%20returning%20to%20main%20method%20with%20indication%20of%20success&In-Reply-To=%3CC974010E949511448F6DC6F748F604D90FEB1959%40TSEAMB01%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018346.html">
   <LINK REL="Next"  HREF="018330.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Initiating queue monitoring, but returning to main method with indication of success</H1>
    <B>McMahon, James S (TASC)</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Initiating%20queue%20monitoring%2C%0A%20but%20returning%20to%20main%20method%20with%20indication%20of%20success&In-Reply-To=%3CC974010E949511448F6DC6F748F604D90FEB1959%40TSEAMB01%3E"
       TITLE="[rabbitmq-discuss] Initiating queue monitoring, but returning to main method with indication of success">james.mcmahon at TASC.COM
       </A><BR>
    <I>Tue Feb 21 20:33:38 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018346.html">[rabbitmq-discuss] Correct way of determining which node is master?
</A></li>
        <LI>Next message: <A HREF="018330.html">[rabbitmq-discuss] Initiating queue monitoring, but returning to main method with indication of success
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18325">[ date ]</a>
              <a href="thread.html#18325">[ thread ]</a>
              <a href="subject.html#18325">[ subject ]</a>
              <a href="author.html#18325">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The rabbitMQ examples all show a use case where the receiver enters into a while( true ) loop that is only terminated when the coder hits Ctrl-C at the command line.

In my case, I call a method in a Listener class from a main java method in my primary class, Driver. As a result, control passes to callListener() in Listener.java and loops there endlessly waiting for messages it gets from the direct exchange. In my main() method of Driver.java, it makes a call right now like this:

callListener();

and inside my callListener method I implement similar to that that which was shown in the tutorials:

        ConnectionFactory factory = new ConnectionFactory();
        factory.setHost(&quot;localhost&quot;);
        Connection connection = factory.newConnection();
        Channel channel = connection.createChannel();

        channel.exchangeDeclare(EXCHANGE_NAME, &quot;topic&quot;);
        String queueName = channel.queueDeclare().getQueue();

        for(String bindingKey : argv){
            channel.queueBind(queueName, EXCHANGE_NAME, bindingKey);
        }

        System.out.println(&quot; [*] Waiting for messages. To exit press CTRL+C&quot;);

        QueueingConsumer consumer = new QueueingConsumer(channel);
        channel.basicConsume(queueName, true, consumer);

        while (true) {
            QueueingConsumer.Delivery delivery = consumer.nextDelivery();
            String message = new String(delivery.getBody());
            String routingKey = delivery.getEnvelope().getRoutingKey();

            // ...my other method calls to process the messages
        }

I lose program control at that point, because this does not return me to my main() in Driver, where I need to accomplish other actions while this listener is monitoring the queue. What I need is for that call to initiate the while loop and listen to the queue, and if it does so successfully return me to my calling program with some indication of success even as the while loop sits there listening to the queue for messages.

How can I implement this?

Thanks very much.

CONFIDENTIALITY NOTICE: This message and any attachments or files transmitted with it (collectively, the &quot;Message&quot;) are intended only for the addressee and may contain information that is privileged, proprietary and/or prohibited from disclosure by law or contract. If you are not the intended recipient: (a) please do not read, copy or retransmit the Message; (b) permanently delete and/or destroy all electronic and hard copies of the Message; (c) notify us by return email; and (d) you are hereby notified that any dissemination, distribution or copying of the Message is strictly prohibited.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120221/b735f141/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120221/b735f141/attachment.htm</A>&gt;
</PRE>




































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018346.html">[rabbitmq-discuss] Correct way of determining which node is master?
</A></li>
	<LI>Next message: <A HREF="018330.html">[rabbitmq-discuss] Initiating queue monitoring, but returning to main method with indication of success
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18325">[ date ]</a>
              <a href="thread.html#18325">[ thread ]</a>
              <a href="subject.html#18325">[ subject ]</a>
              <a href="author.html#18325">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
