<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Bug? STOMP adaptor created queues with invalid	UTF-8 characters
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Bug%3F%20STOMP%20adaptor%20created%20queues%20with%20invalid%0A%09UTF-8%20characters&In-Reply-To=%3C4F3872C0.9000202%40strategicdata.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018105.html">
   <LINK REL="Next"  HREF="018097.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Bug? STOMP adaptor created queues with invalid	UTF-8 characters</H1>
    <B>Toby Corkindale</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Bug%3F%20STOMP%20adaptor%20created%20queues%20with%20invalid%0A%09UTF-8%20characters&In-Reply-To=%3C4F3872C0.9000202%40strategicdata.com.au%3E"
       TITLE="[rabbitmq-discuss] Bug? STOMP adaptor created queues with invalid	UTF-8 characters">toby.corkindale at strategicdata.com.au
       </A><BR>
    <I>Mon Feb 13 02:17:36 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018105.html">[rabbitmq-discuss] Why is the queue created on the consumer's side?
</A></li>
        <LI>Next message: <A HREF="018097.html">[rabbitmq-discuss] Bug? STOMP adaptor created queues with	invalid UTF-8 characters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18096">[ date ]</a>
              <a href="thread.html#18096">[ thread ]</a>
              <a href="subject.html#18096">[ subject ]</a>
              <a href="author.html#18096">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I *think* I've found symptoms of a bug in the RabbitMQ STOMP adaptor.

We're using /topic/ subscriptions in our applications, and the STOMP 
adaptor creates some temporary queues in RabbitMQ.
If you subscribe to /topic/foo.bar.123 it'll create a queue of the 
pattern stomp.dsub.foo.bar.123.XXXXXXXXXXXXXXXX
where the Xs are random characters.

It recently managed to create some with invalid UTF8 in the random 
section of the queue name. This broke the web management interface and 
the JSON REST API.

=ERROR REPORT==== 13-Feb-2012::13:05:44 ===
webmachine error: path=&quot;/api/queues//&quot;
{error,{exit,{ucs,{bad_utf8_character_code}},
              [{xmerl_ucs,from_utf8,1},
               {mochijson2,json_encode_string,2},
               {mochijson2,'-json_encode_proplist/2-fun-0-',3},
               {lists,foldl,3},
               {mochijson2,json_encode_proplist,2},
               {mochijson2,'-json_encode_array/2-fun-0-',3},
               {lists,foldl,3},
               {mochijson2,json_encode_array,2}]}}



 From the command line, I see:
# rabbitmqctl list_queues -p test
Listing queues ...
stomp.dsub.websurvey.commander.686.&#65533;&#65533;&#65533;+[FY\003*\177y&#65533;&#924;&#65533;&#65533;	0
stomp.dsub.websurvey.commander.610.d&#65533;+^Ua\005sI&#65533;D&#1421;\031\031&#65533;	0
...done.


Is this intended behaviour? We've never seen this happen before.

Cheers,
Toby
</PRE>



















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018105.html">[rabbitmq-discuss] Why is the queue created on the consumer's side?
</A></li>
	<LI>Next message: <A HREF="018097.html">[rabbitmq-discuss] Bug? STOMP adaptor created queues with	invalid UTF-8 characters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18096">[ date ]</a>
              <a href="thread.html#18096">[ thread ]</a>
              <a href="subject.html#18096">[ subject ]</a>
              <a href="author.html#18096">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
