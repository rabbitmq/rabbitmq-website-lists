<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] STOMP and persistent messages to a	queue	destination
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20and%20persistent%20messages%20to%20a%0A%09queue%09destination&In-Reply-To=%3C118c54c3-9e1d-4924-b07c-528502c18a0a%40strongmad.batnest.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017868.html">
   <LINK REL="Next"  HREF="017903.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] STOMP and persistent messages to a	queue	destination</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20and%20persistent%20messages%20to%20a%0A%09queue%09destination&In-Reply-To=%3C118c54c3-9e1d-4924-b07c-528502c18a0a%40strongmad.batnest.org%3E"
       TITLE="[rabbitmq-discuss] STOMP and persistent messages to a	queue	destination">jerryk at vmware.com
       </A><BR>
    <I>Thu Feb  2 17:22:55 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="017868.html">[rabbitmq-discuss] STOMP and persistent messages to a	queue	destination
</A></li>
        <LI>Next message: <A HREF="017903.html">[rabbitmq-discuss] STOMP and persistent messages to a queue	destination
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17872">[ date ]</a>
              <a href="thread.html#17872">[ thread ]</a>
              <a href="subject.html#17872">[ subject ]</a>
              <a href="author.html#17872">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, Michael...

Apologies.  When I responded somewhat glibly earlier I missed the key bit
of context that you're talking about STOMP, about which I know relatively little.

The plugin creates its &quot;/queue&quot; queues as durable automatically, so that part
of my admonition is taken care of, and it works through the default exchange,
which is always there, so that won't be the problem...

Your messages do indeed appear to be published with persistence requested.
Are you losing some or a lot?  When is the broker restart happening?  Could it
be that the broker is bouncing before it's been able to accept responsibility 
for your message and get it safely on disk?

Looking at the STOMP adapter's web page, I see we've got what appears to be
an inert non-link where we promise to tell you about the actual semantics of
this operation:

<A HREF="http://www.rabbitmq.com/stomp.html">http://www.rabbitmq.com/stomp.html</A>

Rabbit's publisher confirm extension, for ensuring that the broker has really
taken responsibility for a message you've published is documented here:

<A HREF="http://www.rabbitmq.com/extensions.html#confirms">http://www.rabbitmq.com/extensions.html#confirms</A>

Are you asking for receipts when you publish?

Best regards,
Jerry

----- Original Message -----
From: &quot;Michael Justin&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">michael.justin at gmx.net</A>&gt;
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Sent: Thursday, February 2, 2012 6:54:41 AM
Subject: [rabbitmq-discuss] STOMP and persistent messages to a queue	destination

Hello,

with RabbitMQ 2.7.1 I tested persistent messages based on the STOMP 
description which says &quot;Setting the persistent header to true has the 
effect of making the message persistent.&quot;

So the frame which sends a message to a queue has this header:

SEND
destination:/queue/TOOL.DEFAULT
persistent:true
content-type:text/plain

Do I also have to do something with the queue to make it persistent? 
This is not clear from the documentation - and I found that the messages 
so not survive a broker restart

Many thanks in advance
-- 
Michael Justin
habarisoft - Enterprise Messaging Software for Delphi
<A HREF="http://www.habarisoft.com/">http://www.habarisoft.com/</A>

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017868.html">[rabbitmq-discuss] STOMP and persistent messages to a	queue	destination
</A></li>
	<LI>Next message: <A HREF="017903.html">[rabbitmq-discuss] STOMP and persistent messages to a queue	destination
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17872">[ date ]</a>
              <a href="thread.html#17872">[ thread ]</a>
              <a href="subject.html#17872">[ subject ]</a>
              <a href="author.html#17872">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
