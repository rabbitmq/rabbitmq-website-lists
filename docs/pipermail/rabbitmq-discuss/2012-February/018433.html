<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] dead connection lingers around?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20dead%20connection%20lingers%20around%3F&In-Reply-To=%3C4F4B6394.10903%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018426.html">
   <LINK REL="Next"  HREF="018438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] dead connection lingers around?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20dead%20connection%20lingers%20around%3F&In-Reply-To=%3C4F4B6394.10903%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] dead connection lingers around?">simon at rabbitmq.com
       </A><BR>
    <I>Mon Feb 27 11:05:56 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018426.html">[rabbitmq-discuss] dead connection lingers around?
</A></li>
        <LI>Next message: <A HREF="018438.html">[rabbitmq-discuss] Log rotation with rabbitmq-service on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18433">[ date ]</a>
              <a href="thread.html#18433">[ thread ]</a>
              <a href="subject.html#18433">[ subject ]</a>
              <a href="author.html#18433">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi.

Sometimes if a TCP connection gets killed outright the OS never notices 
and so we don't know either.

This probably implies you are not closing connections properly? (i.e. 
with the AMQP close handshake, by invoking amqp_connection:close/1.)

Enabling AMQP heartbeats will allow RabbitMQ to detect this condition.

Cheers, Simon

On 27/02/12 09:25, stone wrote:
&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> Have a problem while testing my Erlang client based application.
</I>&gt;<i> I have no idea if it's due to some bad behavior in my app or whatsoever,
</I>&gt;<i> hope I can get some useful information here.
</I>&gt;<i>
</I>&gt;<i> In my case, I have:
</I>&gt;<i> three rabbit nodes in a cluster;
</I>&gt;<i> one non-durable topic exchange;
</I>&gt;<i> two connections established;
</I>&gt;<i> several channels and queues (exclusive &amp; non-exclusive) declared.
</I>&gt;<i>
</I>&gt;<i> While i'm testing, sometimes the connections they just linger around
</I>&gt;<i> even the client has quit already.
</I>&gt;<i>
</I>&gt;<i> For instance, here is one or my dead connections (copied from admin page):
</I>&gt;<i>
</I>&gt;<i> AMQP 0-9-1	10.15.36.246:36526 &lt;<A HREF="http://10.15.36.246:36526">http://10.15.36.246:36526</A>&gt;
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at test-app2</A>	0B/s_(1.9kB total) 	0B/s_(1.1kB total) 	4	guest	running
</I>&gt;<i>
</I>&gt;<i> I'm pretty sure that the client on 10.15.36.246 has been killed already,
</I>&gt;<i> but the connection is still in &quot;running&quot; state.
</I>&gt;<i>
</I>&gt;<i> /stone
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>


















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018426.html">[rabbitmq-discuss] dead connection lingers around?
</A></li>
	<LI>Next message: <A HREF="018438.html">[rabbitmq-discuss] Log rotation with rabbitmq-service on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18433">[ date ]</a>
              <a href="thread.html#18433">[ thread ]</a>
              <a href="subject.html#18433">[ subject ]</a>
              <a href="author.html#18433">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
