<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [help] [beginner] testing with pika: some	questions and complaints
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Bhelp%5D%20%5Bbeginner%5D%20testing%20with%20pika%3A%20some%0A%09questions%20and%20complaints&In-Reply-To=%3CCAKYODbh2qeJC3%2Bj-PCgpsu7VH7HCaMHq2KPbGpZUupRsuY8HBA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018464.html">
   <LINK REL="Next"  HREF="018473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [help] [beginner] testing with pika: some	questions and complaints</H1>
    <B>Alistair Bayley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5Bhelp%5D%20%5Bbeginner%5D%20testing%20with%20pika%3A%20some%0A%09questions%20and%20complaints&In-Reply-To=%3CCAKYODbh2qeJC3%2Bj-PCgpsu7VH7HCaMHq2KPbGpZUupRsuY8HBA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] [help] [beginner] testing with pika: some	questions and complaints">alistair at abayley.org
       </A><BR>
    <I>Wed Feb 29 01:54:24 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="018464.html">[rabbitmq-discuss] Query a queue status from the client
</A></li>
        <LI>Next message: <A HREF="018473.html">[rabbitmq-discuss] [help] [beginner] testing with pika: some questions and complaints
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18470">[ date ]</a>
              <a href="thread.html#18470">[ thread ]</a>
              <a href="subject.html#18470">[ subject ]</a>
              <a href="author.html#18470">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been testing rabbitmq with pika (python) to understand how they
interact and learn about the AMQP protocol. I've some questions and
some complaints; no doubt much of this will be from my
misunderstandings of the AMQP/rabbitmq specs.

Pika (is this better posted to the pika mailing list?):

1.  why is the test in channel.py:102 like so:
        if callback and not isinstance(callback, types.FunctionType) and \
           not isinstance(callback, types.MethodType):
            raise TypeError(&quot;callback should be None, a function or method.&quot;)

    i.e. why isn't is just a callable() test e.g.
        if callback and not callable(callback):
            raise TypeError(&quot;callback should be callable.&quot;)

    (is this a python-3 compatibility thing?)


2.  documentation for callback functions is mostly non-existent, and when it
    exists is sometimes wrong e.g. on <A HREF="http://pika.github.com/channel.html">http://pika.github.com/channel.html</A> :

    (i) channel.basic_get:
        &quot;callback method signature should have 3 parameters:
        The method frame, header frame and the body&quot;
    In fact the callback gets 4 parameters:
        channel, method (Basic.GetOk), properties (Basic.Properties), body

    (ii) channel.add_on_close_callback:
        &quot;The callback function should receive a frame parameter.&quot;
    In fact the callback gets 2 parameters: error_code, error_message


3.  why does basic_ack cause this warning?
    CallbackManager.add: Duplicate callback found for &quot;0:Connection.CloseOk&quot;
    i.e. why does it appear to add a(nother) connection close callback?
    I've grubbed through the pika source but can't see how/where it happens.


AMQP/rabbitmq:

4.  why doesn't basic_ack do what I expect?
    If I do a basic_get with no_ack=False, and then a basic_ack,
    the message stays on the queue.
    I can repeatedly fetch-and-ack it, and each time redelivered=true.


5.  if the server reaches a state where it stops accepting messages
    (e.g. memory usage exceeds the high water mark) it does not send
    nack or return responses to basic_publish.
    This is both with transactions, or with channel confirm_delivery
    enabled.


(5) is a concern when one requires guaranteed delivery. Having the
server swallow the message and not respond doesn't seem reliable to
me. Is there some other method I should be using for guaranteed
delivery?

Alistair
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018464.html">[rabbitmq-discuss] Query a queue status from the client
</A></li>
	<LI>Next message: <A HREF="018473.html">[rabbitmq-discuss] [help] [beginner] testing with pika: some questions and complaints
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18470">[ date ]</a>
              <a href="thread.html#18470">[ thread ]</a>
              <a href="subject.html#18470">[ subject ]</a>
              <a href="author.html#18470">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
