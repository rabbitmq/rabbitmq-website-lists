<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Publish to queue fails but publish to direct exchange works
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publish%20to%20queue%20fails%20but%20publish%20to%20direct%0A%20exchange%20works&In-Reply-To=%3C4C1C594C.1020706%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007670.html">
   <LINK REL="Next"  HREF="007608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Publish to queue fails but publish to direct exchange works</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Publish%20to%20queue%20fails%20but%20publish%20to%20direct%0A%20exchange%20works&In-Reply-To=%3C4C1C594C.1020706%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Publish to queue fails but publish to direct exchange works">matthias at rabbitmq.com
       </A><BR>
    <I>Sat Jun 19 06:44:44 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007670.html">[rabbitmq-discuss] Publish to queue fails but publish to direct	exchange works
</A></li>
        <LI>Next message: <A HREF="007608.html">[rabbitmq-discuss] Rabbitmq Crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7672">[ date ]</a>
              <a href="thread.html#7672">[ thread ]</a>
              <a href="subject.html#7672">[ subject ]</a>
              <a href="author.html#7672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Raphael,

Raphael Simon wrote:
&gt;<i> On Fri, Jun 18, 2010 at 12:07 AM, Matthias Radestock 
</I>&gt;<i> &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A> &lt;mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i>     The reason we don't map the blank exchange name to something else is
</I>&gt;<i>     that RabbitMQ permits anything in the exchange name, so *** and ---
</I>&gt;<i>     actually are valid exchange names.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I understand but it seems to me that the pain it causes users in general 
</I>&gt;<i> is greater than the remote chance somebody would have called its queue 
</I>&gt;<i> ---. Alternatively you could wrap queue names e.g. around brackets. You 
</I>&gt;<i> could also use a divider ' | ' (which would also be an issue if somebody 
</I>&gt;<i> called its queue ' | ' but again it seems to me that the benefits way 
</I>&gt;<i> outweigh the drawbacks). 
</I>
We considered something like that, and early versions of the code worked 
that way, but it turned out to cause more problems than it solved.

The current output format is designed to be processed by standard tools 
in the unix tool chain, such as 'cut', which is a major advantage.

&gt;<i>         I should probably mention that sending the following queue.bind
</I>&gt;<i>         packet didn't seem to help (rabbitmqctl list_bindings still
</I>&gt;<i>         shows the
</I>&gt;<i>         binding  missing).
</I>&gt;<i> 
</I>&gt;<i>         [:sending,
</I>&gt;<i>          #&lt;AMQP::Protocol::Queue::Bind:0x9b26778
</I>&gt;<i>          @arguments=nil,
</I>&gt;<i>          @debug=1,
</I>&gt;<i>          @exchange=
</I>&gt;<i>          
</I>&gt;<i>         &quot;nanite-rs-instance-fd0416fe31d7b019112c2c0adce9b4e4a261bab1-1094976&quot;,
</I>&gt;<i>          @nowait=true,
</I>&gt;<i>          @queue=&quot;nanite-rs-instance-fd0416fe31d7b019112c2c0adce9b4e4a261bab1-1094976&quot;,
</I>&gt;<i>          @routing_key=nil,
</I>&gt;<i>          @ticket=1&gt;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     The exchange in the above should be blank.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Setting the exchange to blank here did not seem to do the right thing. 
</I>&gt;<i> The binding that is missing is the one from the queue name to the 
</I>&gt;<i> routing key with the same name.
</I>
Ah, I didn't spot the second mistake - the routing key should be set to 
the queue name.

&gt;<i> Also a different issue: Using a blank string with rabbitmqctl 
</I>&gt;<i> set_permissions has the same effect as using a wild card (.*). This 
</I>&gt;<i> seems a little bit counter-intuitive (i.e. rabbitmqctl set_permissions 
</I>&gt;<i> user &quot;&quot; &quot;' &quot;&quot; has the same effect as rabbitmqctl set_permissions user 
</I>&gt;<i> &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;).
</I>
We are implementing nothing special here; just following whatever the 
regexp library does.

One thing we could do is automatically anchor all regexp by surrounding 
them with ^$. That would make it impossible to use explicit anchors though.

&gt;<i> Finally a different question: is there a way to force a disconnect from 
</I>&gt;<i> a client from the broker?
</I>
Yes, see the 'rabbitmqctl close_connection' command.


Regards,

Matthias.
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007670.html">[rabbitmq-discuss] Publish to queue fails but publish to direct	exchange works
</A></li>
	<LI>Next message: <A HREF="007608.html">[rabbitmq-discuss] Rabbitmq Crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7672">[ date ]</a>
              <a href="thread.html#7672">[ thread ]</a>
              <a href="subject.html#7672">[ subject ]</a>
              <a href="author.html#7672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
