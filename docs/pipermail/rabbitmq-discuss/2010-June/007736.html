<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Debugging rabbitmq crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Debugging%20rabbitmq%20crash&In-Reply-To=%3CAANLkTil5gYdTEucaSjhO8dW62elN6TTs_epaWFd4n6O1%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007731.html">
   <LINK REL="Next"  HREF="007757.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Debugging rabbitmq crash</H1>
    <B>Matt Calder</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Debugging%20rabbitmq%20crash&In-Reply-To=%3CAANLkTil5gYdTEucaSjhO8dW62elN6TTs_epaWFd4n6O1%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Debugging rabbitmq crash">mvcalder at gmail.com
       </A><BR>
    <I>Thu Jun 24 12:19:29 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007731.html">[rabbitmq-discuss] Debugging rabbitmq crash
</A></li>
        <LI>Next message: <A HREF="007757.html">[rabbitmq-discuss] Debugging rabbitmq crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7736">[ date ]</a>
              <a href="thread.html#7736">[ thread ]</a>
              <a href="subject.html#7736">[ subject ]</a>
              <a href="author.html#7736">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The second run stopped in the same manner. I was running rabbitmq
1.7.2 and erlang 13B03. I had started before I got Matthias's
suggestion to upgrade rabbit.  This time I captured the stack traces
of the two processes when they stopped.

The server process:

...
    self._mq_channel.basic_publish(amqp.Message(body), exchange =
self._mq_exchange, routing_key = &quot;reply&quot;)
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/channel.py&quot;,
line 2223, in basic_publish
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/abstract_channel.py&quot;,
line 70, in _send_method
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/method_framing.py&quot;,
line 240, in write_method
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/transport.py&quot;,
line 125, in write_frame
  File &quot;&lt;string&gt;&quot;, line 1, in sendall
socket.error: [Errno 32] Broken pipe

The client process:
...
    self.clientProcess._mq_channel.wait()
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/abstract_channel.py&quot;,
line 89, in wait
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/connection.py&quot;,
line 198, in _wait_method
  File &quot;build/bdist.linux-i686/egg/amqplib/client_0_8/method_framing.py&quot;,
line 215, in read_method
IOError: Socket closed

I will rerun with rabbit 1.8.0.

Matt



2010/6/23 Nicol&#225;s C&#233;sar &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">nico at nicocesar.com</A>&gt;:
&gt;<i> Simon told me once, It was helpful for me that time.:
</I>&gt;<i> -------------------------------------------
</I>&gt;<i> Well, there's erlang:memory/0.
</I>&gt;<i>
</I>&gt;<i> If you're using the Debian packages, type:
</I>&gt;<i>
</I>&gt;<i> $ sudo -u rabbitmq -H erl -remsh rabbit@`hostname` -sname foo
</I>&gt;<i>
</I>&gt;<i> to establish a connection to the RabbitMQ Erlang process then at the Erlang
</I>&gt;<i> prompt:
</I>&gt;<i>
</I>&gt;<i> memory().
</I>&gt;<i>
</I>&gt;<i> to give some high level statistics about what's using memory.
</I>&gt;<i> ---------------------------------------
</I>&gt;<i>
</I>&gt;<i> My 2 cents.
</I>&gt;<i>
</I>&gt;<i> 2010/6/23 Matt Calder &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mvcalder at gmail.com</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matthias,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Jun 23, 2010 at 2:52 PM, Matthias Radestock
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; I strongly recommend you upgrade to rabbit 1.8.0 as well.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Will do.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; That's the producer and consumer, right? So actually rabbit might still
</I>&gt;&gt;<i> &gt; be
</I>&gt;&gt;<i> &gt; running happily? Did you try restarting the clients?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I believe it was still running because I recall seeing a message that
</I>&gt;&gt;<i> it was being stopped during the upgrade of erlang (I know, flimsy
</I>&gt;&gt;<i> evidence at best). I will be more diligent if I run into problems
</I>&gt;&gt;<i> again.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matt
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007731.html">[rabbitmq-discuss] Debugging rabbitmq crash
</A></li>
	<LI>Next message: <A HREF="007757.html">[rabbitmq-discuss] Debugging rabbitmq crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7736">[ date ]</a>
              <a href="thread.html#7736">[ thread ]</a>
              <a href="subject.html#7736">[ subject ]</a>
              <a href="author.html#7736">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
