<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit crash, new persister
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20crash%2C%20new%20persister&In-Reply-To=%3CAANLkTilcG-PS1sWdmXHpDmGQ3WUszta5I5SxJmZRGTjs%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007692.html">
   <LINK REL="Next"  HREF="007700.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit crash, new persister</H1>
    <B>John Apps</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20crash%2C%20new%20persister&In-Reply-To=%3CAANLkTilcG-PS1sWdmXHpDmGQ3WUszta5I5SxJmZRGTjs%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Rabbit crash, new persister">johndapps at gmail.com
       </A><BR>
    <I>Mon Jun 21 12:15:01 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007692.html">[rabbitmq-discuss] Rabbit crash, new persister
</A></li>
        <LI>Next message: <A HREF="007700.html">[rabbitmq-discuss] Rabbit crash, new persister
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7695">[ date ]</a>
              <a href="thread.html#7695">[ thread ]</a>
              <a href="subject.html#7695">[ subject ]</a>
              <a href="author.html#7695">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you for the lengthy response.

You may read 'casting aspersions' for 'devious' if you wish.

I have suggested before that you place an official statement saying that
Linux is the platform of choice; Windows is tolerated, or words to that
effect. If you prefer to have everyone use Linux, then say so!
I find it hard to take a product seriously when doubts are constantly raised
about the platform I am running it on; makes me wonder if I am using the
wrong product as I have no choice with the platform.

There is no point in discussing the future of Windows versus Linux as a
server OS as it gets emotional and subjective.

*&gt;&gt;&gt;*I'm yet to hear of anyone talking about Windows in the
cloud*(presumably because if you added a window to a cloud, you'd let
the rain
out).*
You may consider the above statement as in the category &quot;devious&quot; or
&quot;dubious&quot; - not helpful at all and blatantly incorrect. Amazon offers
Windows in the cloud, MS offers it under the Azure label, MS Business Online
Productivity Services is making inroads into Google Applications. To name
but a few.

I have been following AMQP since before its first publication and am a big
supporter of it, so try as many of the implementations as I can, usually on
Windows and, where we manage to port the code, on OpenVMS.

Oh well, back to some testing: Qpid, StormMQ, RabbitMQ, ZeroMQ (got to keep
an open mind).

On Mon, Jun 21, 2010 at 12:43, Matthew Sackman &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at rabbitmq.com</A>&gt; wrote:

&gt;<i> John,
</I>&gt;<i>
</I>&gt;<i> On Sun, Jun 20, 2010 at 03:58:55PM +0200, John Apps wrote:
</I>&gt;<i> &gt; &lt;Begin of Soapbox&gt;
</I>&gt;<i> &gt; I have to ask what the rather strange approach to Windows is with the
</I>&gt;<i> &gt; RabbitMQ folks?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Bashing Windows might be a great hobby, not terribly helpful though.
</I>&gt;<i>
</I>&gt;<i> There is actually very little bashing going on, IMO.
</I>&gt;<i>
</I>&gt;<i> 1. No one at RabbitMQ uses Windows as their main development environment
</I>&gt;<i> because we tend to find it unpleasant.
</I>&gt;<i>
</I>&gt;<i> 2. One of the reasons it's unpleasant is that it seems to be full of
</I>&gt;<i> surprises - we're not making it up when we say that we have seen issues
</I>&gt;<i> with firewalls stopping AMQP clients from working *only* when XML is
</I>&gt;<i> being sent across the network. Not even Ubuntu contains such
</I>&gt;<i> &quot;functionality&quot; (see, I can bash Ubuntu too).
</I>&gt;<i>
</I>&gt;<i> 3. We *do* support Windows. If we didn't, we wouldn't have bothered
</I>&gt;<i> investing so much time in the various bat scripts that there are, and we
</I>&gt;<i> do test under Windows. However, it is, I'm sure very obviously the case,
</I>&gt;<i> that we do not test as thoroughly under Windows. For example, I suspect
</I>&gt;<i> this is the first time that the new persister is being tested in anger
</I>&gt;<i> under Windows. If we didn't support Windows, then we also wouldn't have
</I>&gt;<i> done the 1.7.2 release, which was almost entirely made up of fixes for
</I>&gt;<i> Windows. We do take Windows support seriously and have invested a lot of
</I>&gt;<i> time in trying to make it less painful for Windows users. If you have
</I>&gt;<i> specific suggestions as to where we could do more, we'd be happy to hear
</I>&gt;<i> them.
</I>&gt;<i>
</I>&gt;<i> 4. To date, and we recognise this may change, not many people have
</I>&gt;<i> complained about the status of our Windows support. I'm yet to hear of
</I>&gt;<i> anyone talking about Windows in the cloud (presumably because if you
</I>&gt;<i> added a window to a cloud, you'd let the rain out). I'm quite sure
</I>&gt;<i> Windows will continue to survive as a desktop OS, but *personally* I
</I>&gt;<i> would estimate that under 10% of our users are using Windows on servers.
</I>&gt;<i> Now sure, you could argue that's *because* of the status of Rabbit on
</I>&gt;<i> Windows - it could well be a chicken and egg situation. On the other
</I>&gt;<i> hand, if it really was that bad, I would have thought we'd have received
</I>&gt;<i> a lot more complaints.
</I>&gt;<i>
</I>&gt;<i> &gt; I understand that RabbitMQ and others are awaiting Erlang support for X64
</I>&gt;<i> &gt; Windows, but to belittle the probably largest market you will find, and
</I>&gt;<i> one
</I>&gt;<i> &gt; that is very stable now with Windows Server 2008 and 7, I do wonder what
</I>&gt;<i> the
</I>&gt;<i> &gt; whole point is.
</I>&gt;<i>
</I>&gt;<i> About 3 years ago, a couple of users were confused because Windows
</I>&gt;<i> seemed to be running Rabbit *much* faster than under Linux, particularly
</I>&gt;<i> with persistent messages in transactions. I spent about half a day
</I>&gt;<i> tracing fsync calls all through the Erlang VM to eventually find that,
</I>&gt;<i> under Windows, it was implemented as &quot;return 1;&quot;. The Erlang developers
</I>&gt;<i> themselves very much treat Windows as a second class citizen. Now the
</I>&gt;<i> situation has improved somewhat since then, but there are still cases
</I>&gt;<i> where bugs likely exist under Windows in Erlang because Erlang
</I>&gt;<i> developers tend to assume Unix or Linux-ish behaviour. For example,
</I>&gt;<i> deleting mmap'd files is quite different under Linux and Windows, and it
</I>&gt;<i> would appear that Erlang with R14A is only now starting to try to ensure
</I>&gt;<i> file operations are the same under Linux and Windows.
</I>&gt;<i>
</I>&gt;<i> The absence of a 64-bit Erlang under Windows is a *massive* issue for
</I>&gt;<i> us, but not one that we're in a position to do anything about. To a
</I>&gt;<i> certain extent, the new persister will alleviate the problem somewhat,
</I>&gt;<i> but really, without a 64-bit Erlang, RabbitMQ is unsuitable for *heavy*
</I>&gt;<i> workloads under Windows without some careful planning. That said, we do
</I>&gt;<i> have (some very large) customers using Rabbit under Windows without any
</I>&gt;<i> problem, in mission critical settings. It is not an issue *provided*
</I>&gt;<i> that you use Rabbit for routing rather than store-and-forward - i.e. try
</I>&gt;<i> to design your architecture so that the queues stay short. But this
</I>&gt;<i> advice applies not just to Windows - you will always get better
</I>&gt;<i> performance out of Rabbit if you, by design, avoid your queues becoming
</I>&gt;<i> very long.
</I>&gt;<i>
</I>&gt;<i> The issue that &#216;yvind has identified *probably* exists with all previous
</I>&gt;<i> versions of Rabbit as I see no reason why it doesn't affect mnesia.
</I>&gt;<i> However, it could have something to do with multiple threads accessing
</I>&gt;<i> the same file, one as a reader and one as a writer, and then the writer
</I>&gt;<i> closing and deleting the file before the reader's closed it. We do this
</I>&gt;<i> in the new persister and it works fine under Linux. We have no idea
</I>&gt;<i> whether it could be a problem under Windows.
</I>&gt;<i>
</I>&gt;<i> Currently we are a team of 7 developers. We have a roadmap that
</I>&gt;<i> stretches at least 3 years with the current head count. We are not in a
</I>&gt;<i> position to start tearing out and replacing large parts of the Erlang VM
</I>&gt;<i> or to try and understand every subtlety of developing to a closed
</I>&gt;<i> platform. Thus we rely on the API provided by the Erlang libraries and
</I>&gt;<i> the environment provided by the Erlang VM. When we come across bugs, we
</I>&gt;<i> report them to the Erlang developers - I have reported several bugs,
</I>&gt;<i> mainly regarding issues with the SSL modules, but beyond reporting bugs,
</I>&gt;<i> and the occasional patch, there's not a great deal more we can do.
</I>&gt;<i>
</I>&gt;<i> &gt; Why not come out with an explicit statement that RabbitMQ is simply NOT
</I>&gt;<i> &gt; supported on Windows?
</I>&gt;<i>
</I>&gt;<i> Because that's not the case. Please explain why you think this is the
</I>&gt;<i> case, and what we should be doing to convince you this isn't the case.
</I>&gt;<i>
</I>&gt;<i> &gt; Make it clear from the beginning rather than writing
</I>&gt;<i> &gt; somewhat devious entries in discussion lists?
</I>&gt;<i>
</I>&gt;<i> Please let us know what these &quot;devious entries&quot; are that we are making.
</I>&gt;<i>
</I>&gt;<i> Best wishes,
</I>&gt;<i>
</I>&gt;<i> Matthew
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
---
John Apps
(49) 171 869 1813
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100621/7163e22c/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100621/7163e22c/attachment.htm</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007692.html">[rabbitmq-discuss] Rabbit crash, new persister
</A></li>
	<LI>Next message: <A HREF="007700.html">[rabbitmq-discuss] Rabbit crash, new persister
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7695">[ date ]</a>
              <a href="thread.html#7695">[ thread ]</a>
              <a href="subject.html#7695">[ subject ]</a>
              <a href="author.html#7695">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
