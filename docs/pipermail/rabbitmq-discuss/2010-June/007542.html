<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] list_queues times out
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20list_queues%20times%20out&In-Reply-To=%3C20100610193812.GB2141%40wellquite.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007541.html">
   <LINK REL="Next"  HREF="007545.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] list_queues times out</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20list_queues%20times%20out&In-Reply-To=%3C20100610193812.GB2141%40wellquite.org%3E"
       TITLE="[rabbitmq-discuss] list_queues times out">matthew at rabbitmq.com
       </A><BR>
    <I>Thu Jun 10 20:38:12 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007541.html">[rabbitmq-discuss] list_queues times out
</A></li>
        <LI>Next message: <A HREF="007545.html">[rabbitmq-discuss] debugging via Java client causes handshake	timeout?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7542">[ date ]</a>
              <a href="thread.html#7542">[ thread ]</a>
              <a href="subject.html#7542">[ subject ]</a>
              <a href="author.html#7542">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jun 10, 2010 at 03:23:23PM -0400, Tyler Williams wrote:
&gt;<i> I've run rabbitmqctl list_queues and waited for hours with no response. I still see activity in the logs, and I can still connect to rabbit and do stuff, but I don't get any output from list_queues.
</I>
That's interesting. That suggests there's just one (or very few) queue
that's blocked or otherwise churning away which is refusing to respond
to your list_queues query. Can you come up with a recipe that reproduces
this? - there's really no what that it should sit there unresponsive for
hours!

&gt;<i> Ok, I'll look into this. This is not exactly the failure mode we're seeing though, because in our case, rabbit is still using cpu and disk. It even clears and resets the watermark. I just can't list the queues at all.
</I>
Yup, sounds like it's not a total memory exhaustion issue at all then,
just a temporary issue, but certainly no queue should get stuck for that
long.

&gt;<i> As an addendum, after this happened today, I restarted rabbitmq, and it recovered it's previous queues without error. After using it for about 5 minutes though, it died, this time with an error in the log, which I've posted here: <A HREF="http://pastebin.com/BAaGpJab">http://pastebin.com/BAaGpJab</A>
</I>
That's bizarre. That's a queue trying to read a message off disk and
failing to find it there. Rabbit goes to great lengths to ensure it
remains in a consistent state so this kind of thing should never happen.
Again, if you can come up with a recipe to reproduce this, that would be
great. Just a guess, but have you run out of disk space on whichever
partition Rabbit is storing messages?

Also, which revision are you running? - it's possible you've uncovered a
bug which has since been fixed anyway - the 21673 branch has move quite
a lot over the last couple of weeks so if you're not running the latest,
it's definitely worth updating.

Matthew
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007541.html">[rabbitmq-discuss] list_queues times out
</A></li>
	<LI>Next message: <A HREF="007545.html">[rabbitmq-discuss] debugging via Java client causes handshake	timeout?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7542">[ date ]</a>
              <a href="thread.html#7542">[ thread ]</a>
              <a href="subject.html#7542">[ subject ]</a>
              <a href="author.html#7542">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
