<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] WCF and queue creation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20WCF%20and%20queue%20creation&In-Reply-To=%3C4C1665A8.8020806%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007544.html">
   <LINK REL="Next"  HREF="007558.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] WCF and queue creation</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20WCF%20and%20queue%20creation&In-Reply-To=%3C4C1665A8.8020806%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] WCF and queue creation">emile at rabbitmq.com
       </A><BR>
    <I>Mon Jun 14 18:23:52 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="007544.html">[rabbitmq-discuss] WCF and queue creation
</A></li>
        <LI>Next message: <A HREF="007558.html">[rabbitmq-discuss] WCF and queue creation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7557">[ date ]</a>
              <a href="thread.html#7557">[ thread ]</a>
              <a href="subject.html#7557">[ subject ]</a>
              <a href="author.html#7557">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Jonathan,


On 11/06/10 16:18, Jonathan Graham wrote:
&gt;<i> Hi Emile,
</I>

&gt;<i> I have two WCF services (let's call them A and B) in an existing
</I>&gt;<i> application.  I want to send asynchronous, one-way messages from service
</I>&gt;<i> A to service B.  The operation being invoked on service B can take some
</I>&gt;<i> time to complete, and service A's call to B is due to an end user
</I>&gt;<i> initiated operation on A. I don't want to make end users wait for B to
</I>&gt;<i> complete, hence the asynchronous requirement.  Service B is also a
</I>&gt;<i> little fragile and is not always available, so I want any messages sent
</I>&gt;<i> to it to be stored in a durable queue until B is able to process the
</I>&gt;<i> messages.
</I>
I agree that a one-way (fire &amp; forget) channel is appropriate for your 
use case. Queue durability alone will not be sufficient to accomplish 
your goal though, because the service host will need to reconnect to the 
same queue. If you are comfortable with recompiling the ServiceModel 
project in order to experiment with a possible approach, try replacing 
line 171 in RabbitMQInputChannel with:

string queue = m_model.QueueDeclare(LocalAddress.Uri.AbsolutePath, true);

This will cause the service queue to have a fixed name and be durable. 
The queue will then accumulate requests in the event of service B 
temporarily disconnecting.

Caveats apply: This code has not been through our formal QA process. It 
is meant for experimentation only and may break other things.

&gt;<i> [...] Unfortunately because Rabbit's WCF
</I>&gt;<i> binding doesn't let us use durable queues, we haven't yet been able to
</I>&gt;<i> make use of it.
</I>
This is a feature that could be added if there was sufficient demand, 
but you are the first to suggest it.

&gt;<i> It looks like the following options are available:
</I>&gt;<i>
</I>&gt;<i> 1. Change the way the WCF binding works so that existing queues can be
</I>&gt;<i> used and/or that queues declared by the binding can be made durable. (As
</I>&gt;<i> an aside, if I can find the time, I wouldn't mind contributing this
</I>&gt;<i> change, but I don't have a whole lot of free time at present.)
</I>
I'm hoping that the line of code above gives you a useful place to 
start. I'd be interested to know if it works for you.

&gt;<i> 2. No longer implement service B as a WCF service and instead use the
</I>&gt;<i> RabbitMQ .NET client API to consume messages from RabbitMQ.
</I>
If you are not bound to the strictures of WCF then this can work very 
simply. There are many examples in the RabbitMQ.Client.Examples that 
illustrate how to send messages from a message producer to a consumer. 
You will need to do some of the work that RabbitMQ ServiceModel does for 
you, such as declaring and binding a queue and structuring the message 
in the way that the consumer can understand it.

Regards

Emile

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007544.html">[rabbitmq-discuss] WCF and queue creation
</A></li>
	<LI>Next message: <A HREF="007558.html">[rabbitmq-discuss] WCF and queue creation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7557">[ date ]</a>
              <a href="thread.html#7557">[ thread ]</a>
              <a href="subject.html#7557">[ subject ]</a>
              <a href="author.html#7557">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
