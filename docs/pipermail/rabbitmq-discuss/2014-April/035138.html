<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Possible memory leak in the management plugin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Possible%20memory%20leak%20in%20the%20management%20plugin&In-Reply-To=%3C53455722.6050906%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035668.html">
   <LINK REL="Next"  HREF="035144.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Possible memory leak in the management plugin</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Possible%20memory%20leak%20in%20the%20management%20plugin&In-Reply-To=%3C53455722.6050906%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Possible memory leak in the management plugin">matthias at rabbitmq.com
       </A><BR>
    <I>Wed Apr  9 15:20:18 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035668.html">[rabbitmq-discuss] Possible memory leak in the management plugin
</A></li>
        <LI>Next message: <A HREF="035144.html">[rabbitmq-discuss] Possible memory leak in the management plugin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35138">[ date ]</a>
              <a href="thread.html#35138">[ thread ]</a>
              <a href="subject.html#35138">[ subject ]</a>
              <a href="author.html#35138">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/04/14 06:15, Pavel wrote:
&gt;<i> We are running RabbitMQ 3.1.5 on Erlang R15B.
</I>&gt;<i>
</I>&gt;<i> Last week we had a couple incidents, where RabbitMQ would go from stable
</I>&gt;<i> ~1Gb RAM to ~10Gb in ~10 mins and keep growing up to the high watermark. It
</I>&gt;<i> was quickly identified that mgmt_db is a culprit, so we disabled management
</I>&gt;<i> plugin and attempted to reproduce the issue in the lab. Although the lab
</I>&gt;<i> test wasn't exactly representing the production setup, we managed to achieve
</I>&gt;<i> similar behavior with rapid unbounded growth of mgmt_db using the following
</I>&gt;<i> scenario:
</I>&gt;<i>
</I>&gt;<i> - declare 1000 exchanges with 1 queue (maxlength=5) bound to each one
</I>&gt;<i> - run a single threaded script that will
</I>&gt;<i>     - create 1 connection with 1000 channels
</I>&gt;<i>     - publish 1000 messages (1 per channel) to each of exchanges sequentially
</I>
I am unable to reproduce this with the attached RabbitMQ Erlang Client 
code. This stabilises at around 150MB total memory use reported in the 
management UI, with just 11MB of that taken up by the management DB.

Matthias.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: loadsa_channels.erl
Type: text/x-erlang
Size: 1042 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140409/dd68bb3d/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140409/dd68bb3d/attachment.bin</A>&gt;
</PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035668.html">[rabbitmq-discuss] Possible memory leak in the management plugin
</A></li>
	<LI>Next message: <A HREF="035144.html">[rabbitmq-discuss] Possible memory leak in the management plugin
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35138">[ date ]</a>
              <a href="thread.html#35138">[ thread ]</a>
              <a href="subject.html#35138">[ subject ]</a>
              <a href="author.html#35138">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
