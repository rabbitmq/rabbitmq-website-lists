<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Dynamic Shovels
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Dynamic%20Shovels&In-Reply-To=%3CB855D678E23BB94F9DE9D3B21C96081F2003821BDF%40MX21A.corp.emc.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035378.html">
   <LINK REL="Next"  HREF="035384.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Dynamic Shovels</H1>
    <B>Smithnosky, Jesse</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Dynamic%20Shovels&In-Reply-To=%3CB855D678E23BB94F9DE9D3B21C96081F2003821BDF%40MX21A.corp.emc.com%3E"
       TITLE="[rabbitmq-discuss] Dynamic Shovels">Jesse.Smithnosky at emc.com
       </A><BR>
    <I>Fri Apr 18 01:15:41 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035378.html">[rabbitmq-discuss] cluster_status changes with rabbitmq - 3.3.0
</A></li>
        <LI>Next message: <A HREF="035384.html">[rabbitmq-discuss] Dynamic Shovels
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35379">[ date ]</a>
              <a href="thread.html#35379">[ thread ]</a>
              <a href="subject.html#35379">[ subject ]</a>
              <a href="author.html#35379">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Everyone,

I'm trying to get the new (in version 3.3) Dynamic Shovels feature up and running, but I'm seeing some weird behavior using curl and not having much luck setting it up in java either.  Here is the curl command I am trying:

curl -i -u guest:guest -H &quot;content-type:application/json&quot; -XPUT -d'{&quot;value&quot;:{&quot;src-uri&quot;:&quot;<A HREF="amqp://">amqp://</A>&quot;,&quot;src-queue&quot;:&quot;my-queue&quot;,&quot;dest-uri&quot;:&quot;<A HREF="amqp://remote-server">amqp://remote-server</A>&quot;,&quot;dest-queue&quot;:&quot;another-queue&quot;}}' <A HREF="http://localhost:15672/api/parameters/shovel/%2f/edShovel">http://localhost:15672/api/parameters/shovel/%2f/edShovel</A>
HTTP/1.1 204 No Content
Server: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)
Date: Thu, 17 Apr 2014 23:16:58 GMT
Content-Type: application/json
Content-Length: 0

It appears that the shovel is getting created correctly, but a 204 is coming back.  This is really just a proof of concept, but it has me a little worried about whether or not I can get it working in Java.  I'm trying to do something like this:

    String jsonString = jackson.writeValueAsString(shovel);
    HttpClient client = HttpClientBuilder.create().build();
    HttpPost post = new HttpPost(RABBIT_URL_BASE+vhost+&quot;/&quot;+shovelName);
    post.setEntity(new StringEntity(jsonString));
    post.addHeader(&quot;content-type&quot;, &quot;application/json&quot;);
    String userPassword = &quot;guest:guest&quot;;
    String encoding = DatatypeConverter.printBase64Binary(userPassword.getBytes(&quot;UTF-8&quot;));
    post.setHeader( &quot;Authorization&quot;, &quot;Basic &quot; + encoding );
    HttpResponse response = client.execute(post);

No matter what I seem to do, however, I'm getting back a 405 Method not allowed response.  Has anyone gotten these working yet?  Am I doing something obvious incorrectly?  Any help is appreciated.

Thanks,
Jesse
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140417/b5a1e338/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140417/b5a1e338/attachment.html</A>&gt;
</PRE>





















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035378.html">[rabbitmq-discuss] cluster_status changes with rabbitmq - 3.3.0
</A></li>
	<LI>Next message: <A HREF="035384.html">[rabbitmq-discuss] Dynamic Shovels
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35379">[ date ]</a>
              <a href="thread.html#35379">[ thread ]</a>
              <a href="subject.html#35379">[ subject ]</a>
              <a href="author.html#35379">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
