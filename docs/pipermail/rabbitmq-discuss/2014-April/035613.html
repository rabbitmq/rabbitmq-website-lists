<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login refused
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5BRUBY%20AMPQ%5D%20SSL%20LOGIN%20ERROR%20EXTERNAL%20login%0A%20refused&In-Reply-To=%3C535F664B.1070404%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035616.html">
   <LINK REL="Next"  HREF="035617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login refused</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20%5BRUBY%20AMPQ%5D%20SSL%20LOGIN%20ERROR%20EXTERNAL%20login%0A%20refused&In-Reply-To=%3C535F664B.1070404%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login refused">simon at rabbitmq.com
       </A><BR>
    <I>Tue Apr 29 09:43:55 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035616.html">[rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login	refused
</A></li>
        <LI>Next message: <A HREF="035617.html">[rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login	refused
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35613">[ date ]</a>
              <a href="thread.html#35613">[ thread ]</a>
              <a href="subject.html#35613">[ subject ]</a>
              <a href="author.html#35613">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/04/2014 09:05, Loganathan Sellapa wrote:
&gt;<i> After restarting the rabbitmq server I tried to connect to RabbitMq via
</I>&gt;<i> AMQP Gem with the below code, but I am getting authentication failure error.
</I>&gt;<i>
</I>&gt;<i> *_RUBY CODE:_*
</I>&gt;<i> *
</I>&gt;<i> *
</I>&gt;<i> RMQ_CONFIGURATIONS = {:host=&gt;&quot;127.0.0.1&quot;, :port=&gt;5671, :vhost=&gt;&quot;/&quot;,
</I>&gt;<i> :auth_mechanism=&gt;&quot;EXTERNAL&quot;,
</I>&gt;<i> :ssl=&gt;{:cert_chain_file=&gt;&quot;/opt/ssl/client/cert.pem&quot;,
</I>&gt;<i> :private_key_file=&gt;&quot;/opt/ssl/client/key.pem&quot;}}
</I>
Do you actually want to use EXTERNAL authentication? That's the 
authentication mode where you do not specify a username and password, 
but the authentication is done via SSL client certs and the username 
comes from the client cert DN / CN.

&gt;<i> =ERROR REPORT==== 29-Apr-2014::13:26:22 ===
</I>&gt;<i> closing AMQP connection &lt;0.862.0&gt; (127.0.0.1:40657
</I>&gt;<i> &lt;<A HREF="http://127.0.0.1:40657">http://127.0.0.1:40657</A>&gt; -&gt; 127.0.0.1:5671 &lt;<A HREF="http://127.0.0.1:5671">http://127.0.0.1:5671</A>&gt;):
</I>&gt;<i> {handshake_error,starting,0,
</I>&gt;<i>                   {amqp_error,access_refused,
</I>&gt;<i> *         &quot;EXTERNAL login refused: user 'ubuntu' - invalid credentials&quot;,*
</I>&gt;<i>                               'connection.start_ok'}}
</I>
Note that the user is 'ubuntu' here, not 'guest'. I guess that's the CN 
of your client cert. RabbitMQ is complianing because although the 
SSL-based auth succeeded, it then couldn't find the user in the internal 
database (to find out what permissions it has).

So if you *do* want to use EXTERNAL, you need to make sure that the user 
'ubuntu' exists in the user database. The user can be set to have no 
password. You can also remove the

If you do *not* want to use EXTERNAL and instead wanted to log in as 
'guest' secured by SSL, remove 'auth_mechanisms' and 
'ssl_cert_login_from' from the config.

Cheers, Simon
</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035616.html">[rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login	refused
</A></li>
	<LI>Next message: <A HREF="035617.html">[rabbitmq-discuss] [RUBY AMPQ] SSL LOGIN ERROR EXTERNAL login	refused
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35613">[ date ]</a>
              <a href="thread.html#35613">[ thread ]</a>
              <a href="subject.html#35613">[ subject ]</a>
              <a href="author.html#35613">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
