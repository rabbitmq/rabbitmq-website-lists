<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] UNEXPECTED_FRAME - expected content header for class 60, got non content header frame instead
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20UNEXPECTED_FRAME%20-%20expected%20content%20header%20for%0A%20class%2060%2C%20got%20non%20content%20header%20frame%20instead&In-Reply-To=%3Cdd399de5-8a93-4fd3-a6d6-49581af5bc59%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035421.html">
   <LINK REL="Next"  HREF="035426.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] UNEXPECTED_FRAME - expected content header for class 60, got non content header frame instead</H1>
    <B>xeon Mailinglist</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20UNEXPECTED_FRAME%20-%20expected%20content%20header%20for%0A%20class%2060%2C%20got%20non%20content%20header%20frame%20instead&In-Reply-To=%3Cdd399de5-8a93-4fd3-a6d6-49581af5bc59%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] UNEXPECTED_FRAME - expected content header for class 60, got non content header frame instead">xeonmailinglist at gmail.com
       </A><BR>
    <I>Mon Apr 21 19:07:42 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035421.html">[rabbitmq-discuss] Flow control behavior
</A></li>
        <LI>Next message: <A HREF="035426.html">[rabbitmq-discuss] UNEXPECTED_FRAME - expected content header for class 60, got non content header frame instead
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35424">[ date ]</a>
              <a href="thread.html#35424">[ thread ]</a>
              <a href="subject.html#35424">[ subject ]</a>
              <a href="author.html#35424">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am trying to run python multiprocessing to execute a remote function that 
I call with the help of celery. My program runs  ok if I just run one 
process. But when I run more than one process, I get the error below. Is it 
because of incompatible versions in python plugins and rabbitmq?

Process Process-1:
Traceback (most recent call last):
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 258, in 
_bootstrap
    self.run()
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 114, in run
    self._target(*self._args, **self._kwargs)
  File &quot;testHello.py&quot;, line 16, in test_hello_aux
    print output.get()
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/result.py&quot;, line 169, 
in get
    no_ack=no_ack,
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 155, in wait_for
    on_interval=on_interval)
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 229, in consume
    no_ack=no_ack, accept=self.accept) as consumer:
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
359, in __init__
    self.revive(self.channel)
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
371, in revive
    self.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
381, in declare
    queue.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 505, 
in declare
    self.queue_declare(nowait, passive=False)
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 531, 
in queue_declare
    nowait=nowait)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/channel.py&quot;, line 1254, 
in queue_declare
    self._send_method((50, 10), args)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py&quot;, 
line 56, in _send_method
    self.channel_id, method_sig, args, content,
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/method_framing.py&quot;, 
line 221, in write_method
    write_frame(1, channel, payload)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/transport.py&quot;, line 
177, in write_frame
    frame_type, channel, size, payload, 0xce,
  File &quot;/usr/lib/python2.7/socket.py&quot;, line 224, in meth
    return getattr(self._sock,name)(*args)
error: [Errno 32] Broken pipe
Process Process-2:
Traceback (most recent call last):
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 258, in 
_bootstrap
    self.run()
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 114, in run
    self._target(*self._args, **self._kwargs)
  File &quot;testHello.py&quot;, line 16, in test_hello_aux
    print output.get()
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/result.py&quot;, line 169, 
in get
    no_ack=no_ack,
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 155, in wait_for
    on_interval=on_interval)
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 229, in consume
    no_ack=no_ack, accept=self.accept) as consumer:
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
359, in __init__
Process Process-3:
    self.revive(self.channel)
Traceback (most recent call last):
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
371, in revive
    self.declare()
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 258, in 
_bootstrap
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
381, in declare
    queue.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 504, 
in declare
    self.run()
    self.exchange.declare(nowait)
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 114, in run
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 166, 
in declare
    self._target(*self._args, **self._kwargs)
    nowait=nowait, passive=passive,
  File &quot;testHello.py&quot;, line 16, in test_hello_aux
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/channel.py&quot;, line 613, 
in exchange_declare
    print output.get()
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/result.py&quot;, line 169, 
in get
    no_ack=no_ack,
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 155, in wait_for
    on_interval=on_interval)
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 229, in consume
    no_ack=no_ack, accept=self.accept) as consumer:
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
359, in __init__
    self._send_method((40, 10), args)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py&quot;, 
line 56, in _send_method
    self.channel_id, method_sig, args, content,
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/method_framing.py&quot;, 
line 221, in write_method
    self.revive(self.channel)
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
371, in revive
    self.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
381, in declare
    write_frame(1, channel, payload)
    queue.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/transport.py&quot;, line 
177, in write_frame
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 504, 
in declare
    frame_type, channel, size, payload, 0xce,
  File &quot;/usr/lib/python2.7/socket.py&quot;, line 224, in meth
    self.exchange.declare(nowait)
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 166, 
in declare
    nowait=nowait, passive=passive,
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/channel.py&quot;, line 620, 
in exchange_declare
    return getattr(self._sock,name)(*args)
error: [Errno 32] Broken pipe
    (40, 11),  # Channel.exchange_declare_ok
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py&quot;, 
line 67, in wait
    self.channel_id, allowed_methods)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/connection.py&quot;, line 
237, in _wait_method
    self.method_reader.read_method()
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/method_framing.py&quot;, 
line 189, in read_method
    raise m
error: [Errno 104] Connection reset by peer
Process Process-4:
Traceback (most recent call last):
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 258, in 
_bootstrap
    self.run()
  File &quot;/usr/lib/python2.7/multiprocessing/process.py&quot;, line 114, in run
    self._target(*self._args, **self._kwargs)
  File &quot;testHello.py&quot;, line 16, in test_hello_aux
    print output.get()
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/result.py&quot;, line 169, 
in get
    no_ack=no_ack,
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 155, in wait_for
    on_interval=on_interval)
  File &quot;/usr/local/lib/python2.7/dist-packages/celery/backends/amqp.py&quot;, 
line 229, in consume
    no_ack=no_ack, accept=self.accept) as consumer:
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
359, in __init__
    self.revive(self.channel)
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
371, in revive
    self.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/messaging.py&quot;, line 
381, in declare
    queue.declare()
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 505, 
in declare
    self.queue_declare(nowait, passive=False)
  File &quot;/usr/local/lib/python2.7/dist-packages/kombu/entity.py&quot;, line 531, 
in queue_declare
    nowait=nowait)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/channel.py&quot;, line 1258, 
in queue_declare
    (50, 11),  # Channel.queue_declare_ok
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py&quot;, 
line 67, in wait
    self.channel_id, allowed_methods)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/connection.py&quot;, line 
270, in _wait_method
    self.wait()
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py&quot;, 
line 69, in wait
    return self.dispatch_method(method_sig, args, content)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py&quot;, 
line 87, in dispatch_method
    return amqp_method(self, args)
  File &quot;/usr/local/lib/python2.7/dist-packages/amqp/connection.py&quot;, line 
526, in _close
    (class_id, method_id), ConnectionError)
UnexpectedFrame: Basic.publish: (505) UNEXPECTED_FRAME - expected content 
header for class 60, got non content header frame instead

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140421/00d8903d/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140421/00d8903d/attachment.html</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035421.html">[rabbitmq-discuss] Flow control behavior
</A></li>
	<LI>Next message: <A HREF="035426.html">[rabbitmq-discuss] UNEXPECTED_FRAME - expected content header for class 60, got non content header frame instead
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35424">[ date ]</a>
              <a href="thread.html#35424">[ thread ]</a>
              <a href="subject.html#35424">[ subject ]</a>
              <a href="author.html#35424">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
