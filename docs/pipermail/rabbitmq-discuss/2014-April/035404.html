<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Causing%20Segmentation%20Fault%20on%0A%09FreeBSD&In-Reply-To=%3CCACsJ2H4XMjSYc_JbnJzLyu%3DDJTY3gthS%3DkHBY6Pn41u4BMOa%3DA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035401.html">
   <LINK REL="Next"  HREF="035405.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD</H1>
    <B>Brandon Munroe</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Causing%20Segmentation%20Fault%20on%0A%09FreeBSD&In-Reply-To=%3CCACsJ2H4XMjSYc_JbnJzLyu%3DDJTY3gthS%3DkHBY6Pn41u4BMOa%3DA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD">brandon.munroe at gmail.com
       </A><BR>
    <I>Fri Apr 18 18:15:41 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="035401.html">[rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD
</A></li>
        <LI>Next message: <A HREF="035405.html">[rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35404">[ date ]</a>
              <a href="thread.html#35404">[ thread ]</a>
              <a href="subject.html#35404">[ subject ]</a>
              <a href="author.html#35404">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here's the output of the command around (within 10s) when it segfaults.
I've truncated a bunch of similar lines, since there are more than 25k
lines.

USER     CMD          PID   FD MOUNT      INUM MODE         SZ|DV R/W
brandon  beam.smp   65462 text /        17977559 -r-xr-xr-x  2397040  r
brandon  beam.smp   65462 ctty /dev         89 crw--w----   pts/0 rw
brandon  beam.smp   65462   wd /        15810621 drwxr-xr-x    1024  r
brandon  beam.smp   65462 root /             2 drwxr-xr-x    1024  r
brandon  beam.smp   65462    0 /dev         89 crw--w----   pts/0 rw
brandon  beam.smp   65462    1 /dev         89 crw--w----   pts/0 rw
brandon  beam.smp   65462    2 /dev         89 crw--w----   pts/0 rw
brandon  beam.smp   65462    3
brandon  beam.smp   65462    4* pipe fffff8000a978000 &lt;-&gt;
fffff8000a978160      0 rw
brandon  beam.smp   65462    5* pipe fffff8000a978160 &lt;-&gt;
fffff8000a978000      0 rw
brandon  beam.smp   65462    6* pipe fffff8008b5b22e8 &lt;-&gt;
fffff8008b5b2448      0 rw
brandon  beam.smp   65462    7* pipe fffff8008b5b2448 &lt;-&gt;
fffff8008b5b22e8      0 rw
brandon  beam.smp   65462    8* internet stream tcp fffff8027d821000
brandon  beam.smp   65462    9* internet stream tcp fffff80566596800
brandon  beam.smp   65462   10 -        15810857 -rw-r--r--  3093764  w
brandon  beam.smp   65462   11 -        15810858 -rw-r--r--       0  w
brandon  beam.smp   65462   12 -        15891126 -rw-r--r--      96 rw
brandon  beam.smp   65462   13 -        15891137 -rw-r--r--       0 rw
brandon  beam.smp   65462   14 -        15891139 -rw-r--r--       0 rw
brandon  beam.smp   65462   15* internet6 stream tcp fffff80458487800
brandon  beam.smp   65462   16* pipe fffff803c3f4b000 &lt;-&gt;
fffff803c3f4b160      0 rw
brandon  beam.smp   65462   17* internet stream tcp fffff80458449400
brandon  beam.smp   65462   18* internet stream tcp fffff802be9b4c00
brandon  beam.smp   65462   19* pipe fffff8000a9bca18 &lt;-&gt;
fffff8000a9bc8b8      0 rw
brandon  beam.smp   65462   20* internet stream tcp fffff802bee95400
brandon  beam.smp   65462   21* internet stream tcp fffff802be4ad400
brandon  beam.smp   65462   22* pipe fffff801ea5f52e8 &lt;-&gt;
fffff801ea5f5448      0 rw
brandon  beam.smp   65462   23* internet stream tcp fffff804edad0800
brandon  beam.smp   65462   24* internet stream tcp fffff80249ff8400
brandon  beam.smp   65462   25* internet stream tcp fffff80566026400
...
brandon  beam.smp   65462 25018* internet stream tcp fffff8045848d000
brandon  beam.smp   65462 25019* internet stream tcp fffff805662fb400
brandon  beam.smp   65462 25020* internet stream tcp fffff804a4633400
brandon  beam.smp   65462 25021* internet stream tcp fffff802495a8000
brandon  beam.smp   65462 25024* pipe fffff8049522a160 &lt;-&gt;
fffff8049522a000      0 rw

Let me know if you need anything else, or if you spot anything that I can
do to mitigate the issue.

-Brandon


On Fri, Apr 18, 2014 at 8:16 AM, Matthias Radestock
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;wrote:

&gt;<i> Brandon,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 15/04/14 17:25, Brandon Munroe wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> The message in the logs reads:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ** Generic server rabbit_mgmt_external_stats terminating
</I>&gt;&gt;<i> ** Last message in was emit_update
</I>&gt;&gt;<i> ** When Server state == {state,707130}
</I>&gt;&gt;<i> ** Reason for termination ==
</I>&gt;&gt;<i> ** {function_clause,[{lists,nth,[1,[]],[{file,&quot;lists.erl&quot;},{line,168}]},
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> {rabbit_mgmt_external_stats,'-get_used_fd/1-fun-1-',2,[]},
</I>&gt;&gt;<i>                       {lists,'-filter/2-lc$^0/1-0-',2,
</I>&gt;&gt;<i>                              [{file,&quot;lists.erl&quot;},{line,1271}]},
</I>&gt;&gt;<i>                       {lists,'-filter/2-lc$^0/1-0-',2,
</I>&gt;&gt;<i>                              [{file,&quot;lists.erl&quot;},{line,1271}]},
</I>&gt;&gt;<i>                       {rabbit_mgmt_external_stats,get_used_fd,1,[]},
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> {rabbit_mgmt_external_stats,'-infos/2-lc$^0/1-0-',2,[]},
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> {rabbit_mgmt_external_stats,'-infos/2-lc$^0/1-0-',2,[]},
</I>&gt;&gt;<i>                       {rabbit_mgmt_external_stats,emit_update,1,[]}]}
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On BSD RabbitMQ invokes 'fstat -p &lt;pid&gt;' to determine the number of used
</I>&gt;<i> file descriptors. In the above it is tripping over the parsing of the
</I>&gt;<i> output. If you can, please post the output of that command just before
</I>&gt;<i> rabbit dies. Meanwhile I've filed a bug to make our parsing code more
</I>&gt;<i> robust.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140418/e8d8ab9a/attachment.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20140418/e8d8ab9a/attachment.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035401.html">[rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD
</A></li>
	<LI>Next message: <A HREF="035405.html">[rabbitmq-discuss] RabbitMQ Causing Segmentation Fault on	FreeBSD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35404">[ date ]</a>
              <a href="thread.html#35404">[ thread ]</a>
              <a href="subject.html#35404">[ subject ]</a>
              <a href="author.html#35404">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
