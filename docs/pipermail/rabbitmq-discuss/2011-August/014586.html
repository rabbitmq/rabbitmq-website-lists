<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue: internal crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.2.0%20message%20delivery%20issue%3A%0A%20internal%20crash&In-Reply-To=%3C20110817111929.GE1444%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014585.html">
   <LINK REL="Next"  HREF="014593.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue: internal crash</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%202.2.0%20message%20delivery%20issue%3A%0A%20internal%20crash&In-Reply-To=%3C20110817111929.GE1444%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue: internal crash">matthew at rabbitmq.com
       </A><BR>
    <I>Wed Aug 17 12:19:30 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014585.html">[rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue: internal crash
</A></li>
        <LI>Next message: <A HREF="014593.html">[rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue:	internal crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14586">[ date ]</a>
              <a href="thread.html#14586">[ thread ]</a>
              <a href="subject.html#14586">[ subject ]</a>
              <a href="author.html#14586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Aug 17, 2011 at 12:06:05PM +0100, Matthew Sackman wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> On Wed, Aug 17, 2011 at 03:57:30AM -0700, Alfonso Pantoja wrote:
</I>&gt;<i> &gt; We are experiencing an issue with version 2.2.0 which causes to
</I>&gt;<i> &gt; RabbitMQ to not deliver messages to a consumer.
</I>&gt;<i> &gt; The consumer is connected to RabbitMQ and performs a create queue/
</I>&gt;<i> &gt; exchange/binding when it is started but sometimes when there are
</I>&gt;<i> &gt; messages in the queue they are not being delivered by Rabbit.
</I>&gt;<i> &gt; Restarting the consumer (it is a windows service) does not solve the
</I>&gt;<i> &gt; problem and the consumer remains connected but without any message
</I>&gt;<i> &gt; although the queue contains 3000 messages.
</I>&gt;<i> 
</I>&gt;<i> I vaguely remember this bug. It has been fixed. The solution would be to
</I>&gt;<i> upgrade to the latest version of RabbitMQ (2.5.1).
</I>
If it's the bug I'm thinking of then this was caused by a bug in the
erlang client which is widely used by various plugins, and was not
encoding messages in the correct way. So if you are using a STOMP or
XMPP or some other plugin (i.e. you're getting messages into Rabbit
without explicitly using an AMQP client) then I think the bug I'm
thinking of is the culprit.

If this is the case then you'll need to upgrade both the broker and its
plugins because they must both be matched in terms of versions.

Unfortunately, because the messages were corrupted by the erlang client
and the corruption only manifests itself when the messages are sent out,
they're likely stored on disk in a corrupted form and just upgrading
Rabbit will not solve the problem. If this is the case, then I'm afraid
there's really nothing for it but to wipe out the msgs on disk and start
from a clean slate - sorry. There is a slim chance that if you're using
some plugin such as STOMP it might be able to ignore this issue but it
depends very much on the details of the plugin.

A colleague has just recalled that there was a similar bug at one point
with the STOMP plugin itself which you might be tripping over.

Without further details of how you're using Rabbit and with what
protocols, it's difficult to suggest your best path forward. However,
that aside, 2.2.0 is fairly ancient and many bugs have been fixed (and
hopefully fewer created) since then.

Matthew
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014585.html">[rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue: internal crash
</A></li>
	<LI>Next message: <A HREF="014593.html">[rabbitmq-discuss] RabbitMQ 2.2.0 message delivery issue:	internal crash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14586">[ date ]</a>
              <a href="thread.html#14586">[ thread ]</a>
              <a href="subject.html#14586">[ subject ]</a>
              <a href="author.html#14586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
