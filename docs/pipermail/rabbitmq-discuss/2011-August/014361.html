<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Channel error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Channel%20error&In-Reply-To=%3C20110805082505.GA2718%40dakota.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014353.html">
   <LINK REL="Next"  HREF="014354.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Channel error</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Channel%20error&In-Reply-To=%3C20110805082505.GA2718%40dakota.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Channel error">alexandru at rabbitmq.com
       </A><BR>
    <I>Fri Aug  5 09:25:05 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014353.html">[rabbitmq-discuss] Channel error
</A></li>
        <LI>Next message: <A HREF="014354.html">[rabbitmq-discuss] How to use Long Polling with RabbitMQ and Rails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14361">[ date ]</a>
              <a href="thread.html#14361">[ thread ]</a>
              <a href="subject.html#14361">[ subject ]</a>
              <a href="author.html#14361">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I can confirm that error never happened on 2.0.0. Let me know if you need any other information.
</I>
Thank you.

&gt;<i> Can you tell me what this error means (does it mean a channel was closed by server?
</I>
It happens when the server is closing a connection.  The error seems to
mean that we're trying to shutdown the same process twice, and we're not
sure exactly how that can happen.

Channel_sup_sup is the process that supervises all the channels in a
connection.  Its supervisor is complaining that we tried to shut it down
twice.

&gt;<i> Does it affect producing channels or consuming channels?).
</I>
Not that we know of, no.  The error happens when closing a connection
and doesn't affect other connections.

Cheers,
Alex

On Thu, Aug 04, 2011 at 11:24:34AM -0700, Dave Greggory wrote:
&gt;<i> I can confirm that error never happened on 2.0.0. Let me know if you need any other information. Can you tell me what this error means (does it mean a channel was closed by server? Does it affect producing channels or consuming channels?).
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ----- Original Message -----
</I>&gt;<i> From: Alexandru Scvor&#355;ov &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexandru at rabbitmq.com</A>&gt;
</I>&gt;<i> To: Dave Greggory &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">davegreggory at yahoo.com</A>&gt;
</I>&gt;<i> Cc: &quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;<i> Sent: Thursday, August 4, 2011 1:51 PM
</I>&gt;<i> Subject: Re: [rabbitmq-discuss] Channel error
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> We've had reports of similar errors to this (not exactly this one,
</I>&gt;<i> though).&#160; We have a bug open, but we haven't been able to
</I>&gt;<i> reproduce them.
</I>&gt;<i> 
</I>&gt;<i> As far as we know, it doesn't cause any problems on either the client or
</I>&gt;<i> the server; it's just annoying.
</I>&gt;<i> 
</I>&gt;<i> &gt; Usage pattern -
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 6 fanout exchanges used for publish/subscribe pattern with 56 exclusive, auto-deleting queues (total, not each) bound to them
</I>&gt;<i> &gt; 37 topic exchanges used for work queue pattern with 34 durable queues (total, not each) bound to them
</I>&gt;<i> 
</I>&gt;<i> Thanks for the info.&#160; We'll have another look at this issue soon.
</I>&gt;<i> 
</I>&gt;<i> &gt; We upgraded to RabbitMQ 2.5.1 from 2.0.0 and have been running 2.5.1 in production for over month. 
</I>&gt;<i> 
</I>&gt;<i> I don't suppose you had the script running for 2.0.0 and can confirm
</I>&gt;<i> that the error doesn't happen there, right?
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Alex
</I>&gt;<i> 
</I>&gt;<i> On Thu, Aug 04, 2011 at 10:40:06AM -0700, Dave Greggory wrote:
</I>&gt;<i> &gt; We upgraded to RabbitMQ 2.5.1 from 2.0.0 and have been running 2.5.1 in production for over month. We have monitoring in on rabbitmq log that alerts us whenever there's any entries in those logs that we do not expect. Basically we look for lines that match following query. 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Query Terms: 'host=rabbitmq* AND NOT
</I>&gt;<i> &gt; &quot;starting TCP connection&quot; AND NOT &quot;closing TCP connection&quot;
</I>&gt;<i> &gt; AND NOT &quot;accepted TCP connection&quot; AND NOT
</I>&gt;<i> &gt; &quot;connection_closed_abruptly&quot; AND NOT &quot;timeout,running&quot;' 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Several times within the last week or so, it alerted us with the following error in the SASL logs. Client functionality seems to be unaffected, but I'm curious to what this error means. Can anybody from the Rabbit team clarify?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; =SUPERVISOR REPORT==== 3-Aug-2011::14:22:30 ===
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; Supervisor: {&lt;0.16968.672&gt;,
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rabbit_channel_sup_sup}
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; Context:&#160;&#160;&#160; shutdown_error
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; Reason:&#160;&#160;&#160;&#160; shutdown
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; Offender:&#160;&#160; [{pid,&lt;0.20327.672&gt;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {name,channel_sup},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {restart_type,temporary},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {shutdown,infinity},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {child_type,supervisor}]
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Usage pattern -
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 6 fanout exchanges used for publish/subscribe pattern with 56 exclusive, auto-deleting queues (total, not each) bound to them
</I>&gt;<i> &gt; 37 topic exchanges used for work queue pattern with 34 durable queues (total, not each) bound to them
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; At peak times we have less than 100 messages/sec going through RabbitMQ
</I>&gt;<i> &gt; Total connections = ~60-70 (2 connections each per app node, 1 for producing, 1 for consuming)
</I>&gt;<i> &gt; Heartbeat of 30 seconds enabled, no transactions used, work queue messages are persistent
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; RabbitMQ setup info -
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; [13:22:00 <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq at rabbitmq1</A> /opt/rabbitmq_server/sbin] ./rabbitmqctl status
</I>&gt;<i> &gt; Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq1</A> ...
</I>&gt;<i> &gt; [{pid,3841},
</I>&gt;<i> &gt; &#160;{running_applications,
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; [{rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;2.5.1&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {webmachine,&quot;webmachine&quot;,&quot;1.7.0-rmq2.5.1-hg0c4b60a&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {rabbitmq_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;2.5.1&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.5.1&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {rabbit,&quot;RabbitMQ&quot;,&quot;2.5.1&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {os_mon,&quot;CPO&#160; CXC 138 46&quot;,&quot;2.2.5&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {sasl,&quot;SASL&#160; CXC 138 11&quot;,&quot;2.1.9&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {rabbitmq_mochiweb,&quot;RabbitMQ Mochiweb Embedding&quot;,&quot;2.5.1&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {mochiweb,&quot;MochiMedia Web Server&quot;,&quot;1.3-rmq2.5.1-git9a53dbd&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {inets,&quot;INETS&#160; CXC 138 49&quot;,&quot;5.3&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {mnesia,&quot;MNESIA&#160; CXC 138 12&quot;,&quot;4.4.13&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {stdlib,&quot;ERTS&#160; CXC 138 10&quot;,&quot;1.16.5&quot;},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {kernel,&quot;ERTS&#160; CXC 138 10&quot;,&quot;2.13.5&quot;}]},
</I>&gt;<i> &gt; &#160;{os,{unix,linux}},
</I>&gt;<i> &gt; &#160;{erlang_version,
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; &quot;Erlang R13B04 (erts-5.7.5) [source] [64-bit] [smp:2:2] [rq:2] [async-threads:30] [hipe] [kernel-poll:true]\n&quot;},
</I>&gt;<i> &gt; &#160;{memory,
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160; [{total,149009336},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {processes,82465760},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {processes_used,82358928},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {system,66543576},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {atom,1279561},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {atom_used,1275735},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {binary,5745136},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {code,15200224},
</I>&gt;<i> &gt; &#160;&#160;&#160;&#160;&#160; {ets,7624288}]}]
</I>&gt;<i> &gt; ...done.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I></PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014353.html">[rabbitmq-discuss] Channel error
</A></li>
	<LI>Next message: <A HREF="014354.html">[rabbitmq-discuss] How to use Long Polling with RabbitMQ and Rails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14361">[ date ]</a>
              <a href="thread.html#14361">[ thread ]</a>
              <a href="subject.html#14361">[ subject ]</a>
              <a href="author.html#14361">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
