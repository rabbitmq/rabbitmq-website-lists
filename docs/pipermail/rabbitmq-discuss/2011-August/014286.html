<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ actively refuses connections after connectity issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20actively%20refuses%20connections%20after%0A%20connectity%20issues&In-Reply-To=%3C4E37C91E.3010902%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014285.html">
   <LINK REL="Next"  HREF="014287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ actively refuses connections after connectity issues</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20actively%20refuses%20connections%20after%0A%20connectity%20issues&In-Reply-To=%3C4E37C91E.3010902%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ actively refuses connections after connectity issues">simon at rabbitmq.com
       </A><BR>
    <I>Tue Aug  2 10:53:34 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014285.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
        <LI>Next message: <A HREF="014287.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14286">[ date ]</a>
              <a href="thread.html#14286">[ thread ]</a>
              <a href="subject.html#14286">[ subject ]</a>
              <a href="author.html#14286">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/08/11 10:44, Alfonso Pantoja wrote:
&gt;<i> More info:
</I>&gt;<i> when we had the problem, in RabbitMQ web admin we could see that file
</I>&gt;<i> descriptors monitor were in red (file descriptors were near the
</I>&gt;<i> maximum)
</I>
Well that's basically your problem - when RabbitMQ runs out of file 
descriptors it simply can't accept any more TCP connections. In practice 
it will stop accepting connections slightly before it runs out 
completely, to give itself some wriggle room when writing new files.

This is a pure OS-level limitation, Rabbit gives you some monitoring of 
the situation but that's it.

The most likely problem was that something was holding connections open 
- check the connections page in mgmt to see what that was.

Ubuntu has a fairly low limit on file descriptors by default (1000) - if 
you think you could legitimately want to accept more than ~800 
connections at once you might want to add something like:

rabbitmq        soft    nofile          100000
rabbitmq        hard    nofile          100000

to /etc/security/limits.conf and restart Rabbit.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014285.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
	<LI>Next message: <A HREF="014287.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14286">[ date ]</a>
              <a href="thread.html#14286">[ thread ]</a>
              <a href="subject.html#14286">[ subject ]</a>
              <a href="author.html#14286">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
