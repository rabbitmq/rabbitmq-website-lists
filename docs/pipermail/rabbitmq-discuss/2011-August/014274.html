<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queuing fundamentals.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queuing%20fundamentals.&In-Reply-To=%3CCANVKUrUUzdabtSg4c5CS3N3MYLyKSQ6QR-ikq5bySkSWSf7GNA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014273.html">
   <LINK REL="Next"  HREF="014275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queuing fundamentals.</H1>
    <B>Eugene Kirpichov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queuing%20fundamentals.&In-Reply-To=%3CCANVKUrUUzdabtSg4c5CS3N3MYLyKSQ6QR-ikq5bySkSWSf7GNA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Queuing fundamentals.">ekirpichov at gmail.com
       </A><BR>
    <I>Mon Aug  1 17:41:09 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014273.html">[rabbitmq-discuss] Queuing fundamentals.
</A></li>
        <LI>Next message: <A HREF="014275.html">[rabbitmq-discuss] Queuing fundamentals.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14274">[ date ]</a>
              <a href="thread.html#14274">[ thread ]</a>
              <a href="subject.html#14274">[ subject ]</a>
              <a href="author.html#14274">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I suppose that you haven't set the prefetch count to 1.

So in fact you had messages 3,4,5,6 all delivered to you (so thought
the broker) and when the consumer died, the broker requeued all of
them in no particular sequence.

2011/8/1 Andrew &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aph at repido.co.uk</A>&gt;:
&gt;<i> Hi everybody,
</I>&gt;<i>
</I>&gt;<i> I wondered if somebody might be able to clarify some behaviour for me
</I>&gt;<i> as I am getting confused about whether the scenario I am experiencing
</I>&gt;<i> is due to a lack of understanding of how RabbitMQ works or something
</I>&gt;<i> else.
</I>&gt;<i>
</I>&gt;<i> I have one reader process which may die due to system failure and at
</I>&gt;<i> restart I'd like the same single consumer process to start up again
</I>&gt;<i> and pick up where it left off. So a summary of what I'd like to happen
</I>&gt;<i> is:
</I>&gt;<i>
</I>&gt;<i> (1) My transmitter process sends and queues up messages 1, 2, 3, 4, 5
</I>&gt;<i> &amp; 6.
</I>&gt;<i> (2) My single consumer process reads and acknowledges messages 1 and 2
</I>&gt;<i> in sequence.
</I>&gt;<i> (3) My consumer process reads message 3 and then dies without
</I>&gt;<i> acknowledging.
</I>&gt;<i> (4) I restart my consumer process which will request the next message,
</I>&gt;<i> which should be the unacknowledged message (3).
</I>&gt;<i> (5) My consumer process would then continue reading messages from the
</I>&gt;<i> queue (4, 5, &amp; 6) in sequence.
</I>&gt;<i>
</I>&gt;<i> What I am experiencing is that when my consumer process is restarted
</I>&gt;<i> messages 3, 4, 5 &amp; 6 are delivered out of sequence and all with a
</I>&gt;<i> redelivery count of 1. I understand that message 3 might be out of
</I>&gt;<i> sequence because it was unacknowledged and from what I have read, when
</I>&gt;<i> a message is redelivered then it's sequence is no longer guaranteed.
</I>&gt;<i> However I'm not clear as to why the remaining queued messages are out
</I>&gt;<i> of sequence too.
</I>&gt;<i>
</I>&gt;<i> More importantly is what I am trying to do is something that is
</I>&gt;<i> contrary to how RabbitMQ works, or am I just going about it the wrong
</I>&gt;<i> way?
</I>&gt;<i>
</I>&gt;<i> Many thanks for your help,
</I>&gt;<i> Andrew
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>


-- 
Eugene Kirpichov
Principal Engineer, Mirantis Inc. <A HREF="http://www.mirantis.com/">http://www.mirantis.com/</A>
Editor, <A HREF="http://fprog.ru/">http://fprog.ru/</A>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014273.html">[rabbitmq-discuss] Queuing fundamentals.
</A></li>
	<LI>Next message: <A HREF="014275.html">[rabbitmq-discuss] Queuing fundamentals.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14274">[ date ]</a>
              <a href="thread.html#14274">[ thread ]</a>
              <a href="subject.html#14274">[ subject ]</a>
              <a href="author.html#14274">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
