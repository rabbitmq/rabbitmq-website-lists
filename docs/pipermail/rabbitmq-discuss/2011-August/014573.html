<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20NotImplementedError%3A%20%3Cclass%0A%20%27pika.spec.CancelOk%27%3E&In-Reply-To=%3CBLU0-SMTP14978B01F378C85A35DB285D6290%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014564.html">
   <LINK REL="Next"  HREF="014574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20NotImplementedError%3A%20%3Cclass%0A%20%27pika.spec.CancelOk%27%3E&In-Reply-To=%3CBLU0-SMTP14978B01F378C85A35DB285D6290%40phx.gbl%3E"
       TITLE="[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;">mpietrek at hotmail.com
       </A><BR>
    <I>Tue Aug 16 17:18:14 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014564.html">[rabbitmq-discuss] NotImplementedError: &lt;class	'pika.spec.CancelOk'&gt;
</A></li>
        <LI>Next message: <A HREF="014574.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14573">[ date ]</a>
              <a href="thread.html#14573">[ thread ]</a>
              <a href="subject.html#14573">[ subject ]</a>
              <a href="author.html#14573">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alas, no luck with a Pika reinstall. I did a &quot;pip uninstall&quot; of what was
there, verified the files were removed, then &quot;pip install&quot;.

All other aspects of my Pika-based code seem to work. I'm sending and
receiving 1000's of messages before shutting down. It's only at shutdown
where the problem occurs.

Does my shutdown sequence look OK? That is, calling
channel.stop_consuming() from a different thread than I called
.start_consuming on?



On 8/16/11 4:29 AM, &quot;Marek Majkowski&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">majek04 at gmail.com</A>&gt; wrote:

&gt;<i>On Tue, Aug 16, 2011 at 00:36, Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at hotmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> I'm getting the following error from code that used to work without
</I>&gt;&gt;<i> error until I did an &quot;apt-get upgrade&quot; today.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is an Ubuntu 11.04 system running Python 2.7 and Pika 0.95. Any
</I>&gt;&gt;<i> clues what's happening?
</I>&gt;<i>
</I>&gt;<i>Nope. Maybe it's just a python installation issue?
</I>&gt;<i>
</I>&gt;<i>Can you try removing pika and installing it again? Or maybe
</I>&gt;<i>installing a fresh local copy (for example using venv)?
</I>&gt;<i>
</I>&gt;<i>Cheers,
</I>&gt;<i>  Marek
</I>&gt;<i>
</I>&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;<i>  File &quot;/usr/lib/python2.7/threading.py&quot;, line 552, in
</I>&gt;&gt;<i> __bootstrap_inner
</I>&gt;&gt;<i>    self.run()
</I>&gt;&gt;<i>  File &quot;ConfigMgr.py&quot;, line 101, in run
</I>&gt;&gt;<i>    self.channel.start_consuming()
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;&gt;<i> blocking_connection.py&quot;, line 293, in start_consuming
</I>&gt;&gt;<i>    self.transport.connection.process_data_events()
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;&gt;<i> blocking_connection.py&quot;, line 94, in process_data_events
</I>&gt;&gt;<i>    self._handle_read()
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;&gt;<i> base_connection.py&quot;, line 162, in _handle_read
</I>&gt;&gt;<i>    self._on_data_available(data)
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/connection.py&quot;,
</I>&gt;&gt;<i> line 599, in _on_data_available
</I>&gt;&gt;<i>    self._channels[frame.channel_number].transport.deliver(frame)
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/channel.py&quot;, line
</I>&gt;&gt;<i> 64, in deliver
</I>&gt;&gt;<i>    self.frame_dispatcher.process(frame)
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/frame.py&quot;, line
</I>&gt;&gt;<i> 202, in process
</I>&gt;&gt;<i>    self._handler(frame)
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/frame.py&quot;, line
</I>&gt;&gt;<i> 220, in _handle_method_frame
</I>&gt;&gt;<i>    raise NotImplementedError(frame.method.__class__)
</I>&gt;&gt;<i> NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here's what my code looks like:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> class ListenForLongRunningEventCompletion(threading.Thread):
</I>&gt;&gt;<i>    def run(self):
</I>&gt;&gt;<i>        self.connection =
</I>&gt;&gt;<i> pika.BlockingConnection(pika.ConnectionParameters(host=MQ_BINDING))
</I>&gt;&gt;<i>        self.channel = self.connection.channel()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        self.channel.queue_declare(queue=RESPONSE_QUEUE_NAME)
</I>&gt;&gt;<i>        self.channel.basic_consume(ResponseCallback,
</I>&gt;&gt;<i>                              queue=RESPONSE_QUEUE_NAME,
</I>&gt;&gt;<i>                              no_ack=True)
</I>&gt;&gt;<i>        self.channel.start_consuming()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    def shutdown(self):
</I>&gt;&gt;<i>        self.channel.stop_consuming()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def ResponseCallback(ch, method, properties, body):
</I>&gt;&gt;<i>    print &quot;Long Running Task response({0})&quot;.format(body)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>#========================================================================
</I>&gt;&gt;<i>======
</I>&gt;&gt;<i> #
</I>&gt;&gt;<i> # Main program
</I>&gt;&gt;<i> #
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>#========================================================================
</I>&gt;&gt;<i>======
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> if __name__ == '__main__':
</I>&gt;&gt;<i>    listener = ListenForLongRunningEventCompletion()
</I>&gt;&gt;<i>    listener.start()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    # Main app logic - not important here
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    # Shut down the connections we've opened up
</I>&gt;&gt;<i>    listener.shutdown()
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014564.html">[rabbitmq-discuss] NotImplementedError: &lt;class	'pika.spec.CancelOk'&gt;
</A></li>
	<LI>Next message: <A HREF="014574.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14573">[ date ]</a>
              <a href="thread.html#14573">[ thread ]</a>
              <a href="subject.html#14573">[ subject ]</a>
              <a href="author.html#14573">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
