<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Configure VM memory high watermark
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Configure%20VM%20memory%20high%20watermark&In-Reply-To=%3C20110811162322.GJ7618%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014499.html">
   <LINK REL="Next"  HREF="014560.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Configure VM memory high watermark</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Configure%20VM%20memory%20high%20watermark&In-Reply-To=%3C20110811162322.GJ7618%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Configure VM memory high watermark">matthew at rabbitmq.com
       </A><BR>
    <I>Thu Aug 11 17:23:22 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014499.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
        <LI>Next message: <A HREF="014560.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14500">[ date ]</a>
              <a href="thread.html#14500">[ thread ]</a>
              <a href="subject.html#14500">[ subject ]</a>
              <a href="author.html#14500">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Aug 11, 2011 at 06:15:45PM +0200, CORDIER-AKKA Sylvain (MORPHO) wrote:
&gt;<i> Following Rabbitmq discuss &quot;unexplained broker shutdown&quot;, what are the risks to configure the vm_memory_high_watermark to a higher value in order to not start paging messages at 8% of installed RAM but at 30% or more?
</I>
In extremis, it could crash due to the Erlang VM being unable to
allocate sufficient RAM for things like garbage collection. Note this is
really quite unlikely, but not impossible.

Also, Rabbit can't actually stop Erlang from using more RAM. There are
scenarios in which Rabbit will eat up vastly more than the 40% it's
notionally meant to throttle publishers at, so a good amount of buffer
space is well advised. Finally, a good amount of space for the OS to
cache disk in is also helpful.

More likely is that you run out of RAM, which means you then have no
disk cache, so performance will suffer, and then Rabbit will start being
swapped out to disk, which will utterly cripple performance. Once
performance starts to drop, as it's likely Rabbit is overloaded anyway
(otherwise it wouldn't have used up so much RAM), performance will fall
off very rapidly, and this can go from bad to worse.

Matthew
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014499.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
	<LI>Next message: <A HREF="014560.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14500">[ date ]</a>
              <a href="thread.html#14500">[ thread ]</a>
              <a href="subject.html#14500">[ subject ]</a>
              <a href="author.html#14500">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
