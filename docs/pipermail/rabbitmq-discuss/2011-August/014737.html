<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Management Plugin stops gathering stats ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Management%20Plugin%20stops%20gathering%20stats%20%3F&In-Reply-To=%3C4E5685F1.2060900%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014736.html">
   <LINK REL="Next"  HREF="014693.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Management Plugin stops gathering stats ?</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Management%20Plugin%20stops%20gathering%20stats%20%3F&In-Reply-To=%3C4E5685F1.2060900%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Management Plugin stops gathering stats ?">simon at rabbitmq.com
       </A><BR>
    <I>Thu Aug 25 18:27:13 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014736.html">[rabbitmq-discuss] Management Plugin stops gathering stats ?
</A></li>
        <LI>Next message: <A HREF="014693.html">[rabbitmq-discuss] Message CorrelationId
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14737">[ date ]</a>
              <a href="thread.html#14737">[ thread ]</a>
              <a href="subject.html#14737">[ subject ]</a>
              <a href="author.html#14737">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/08/11 18:12, Rene Parra wrote:
&gt;<i> The publish rates seem to only work if I use the CachingConnectionFactory in
</I>&gt;<i> Spring vs the SingleConnectionFactory. Makes sense, because when I use
</I>&gt;<i> SingleConnectionFactory, my publisher is creating and closing a connection
</I>&gt;<i> on every single publish.... therefore rabbit only can create statistics for
</I>&gt;<i> a connection that no longer exists (wouldn't make sense unless you are doing
</I>&gt;<i> historic stats, which I'd be surprised if you do).
</I>
Ah, that makes sense. Yes, we want to do historical stats at some point, 
but we don't now.

&gt;<i> FWIW,
</I>&gt;<i>
</I>&gt;<i> The stats bug, and the memory bug seem to be better in 2.5.1/R14B03. We are
</I>&gt;<i> progressing with our soak / load tests at a very light load (100 TPS).
</I>&gt;<i>
</I>&gt;<i> I was able to exhibit the stats bug, and hence memory bug however in
</I>&gt;<i> 2.5.1/R14B03 under high load.
</I>&gt;<i>
</I>&gt;<i> The video is here:
</I>&gt;<i>
</I>&gt;<i> TimePoints:
</I>&gt;<i> * @ 0m00s:  - Memory Pressure WORKING, Throttling ACTIVE
</I>&gt;<i> * @ 0m37s:  - BANG! Statistics stop collecting
</I>&gt;<i> * @ 0m56s:  - Showing how Memory Level now exceeded.
</I>&gt;<i>
</I>&gt;<i> Good news is all the messages were indeed delivered.
</I>&gt;<i> Bad news even after the test completed, I had to restart RabbitMQ to recover
</I>&gt;<i> the memory back down to a normal state and get the stats/memory
</I>&gt;<i> level/publish throttling working again.
</I>
Thanks. Looking at the logs for the previous run I now see that the 
process within mgmt that actually keeps track of memory use crashed at 
around this point, so it's possible that mgmt is no longer reporting the 
memory use accurately. So that's a bug.

Anyway, I think I now have enough information to make a better go of 
replicating this, which I'll do tomorrow. Thanks for the information.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014736.html">[rabbitmq-discuss] Management Plugin stops gathering stats ?
</A></li>
	<LI>Next message: <A HREF="014693.html">[rabbitmq-discuss] Message CorrelationId
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14737">[ date ]</a>
              <a href="thread.html#14737">[ thread ]</a>
              <a href="subject.html#14737">[ subject ]</a>
              <a href="author.html#14737">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
