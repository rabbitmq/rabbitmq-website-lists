<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Configure VM memory high watermark
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Configure%20VM%20memory%20high%20watermark&In-Reply-To=%3C6FC2A47F1B2CCC4C804736A81522E83018932E5382%40Y000IMRV02.rd1.rf1%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014500.html">
   <LINK REL="Next"  HREF="014632.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Configure VM memory high watermark</H1>
    <B>CORDIER-AKKA Sylvain (MORPHO)</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Configure%20VM%20memory%20high%20watermark&In-Reply-To=%3C6FC2A47F1B2CCC4C804736A81522E83018932E5382%40Y000IMRV02.rd1.rf1%3E"
       TITLE="[rabbitmq-discuss] Configure VM memory high watermark">sylvain.cordier.ext at morpho.com
       </A><BR>
    <I>Tue Aug 16 09:27:20 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014500.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
        <LI>Next message: <A HREF="014632.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14560">[ date ]</a>
              <a href="thread.html#14560">[ thread ]</a>
              <a href="subject.html#14560">[ subject ]</a>
              <a href="author.html#14560">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you for this explanation, but I search again a solution about the memory : 
Our RabbitMQ host has got 64GB installed RAM and RabbitMQ server process uses in normal use about 5GB of RAM.
The normal use point is just above the 8% of installed RAM (8% of 64GB is 5.12GB) and a small variation of the use point makes the RabbitMQ starts paging messages and causes a final system slowdown.

If the vm_memory_high_watermark is not the good solution, what are the available solutions?
Increase the amount of installed RAM to 96GB for the system starts paging at 7.68GB? 
Isn't there another way to delay RabbitMQ to start swapping?

Best regards

Sylvain

-----Original Message-----
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] On Behalf Of Matthew Sackman
Sent: Thursday, August 11, 2011 6:23 PM
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Configure VM memory high watermark

On Thu, Aug 11, 2011 at 06:15:45PM +0200, CORDIER-AKKA Sylvain (MORPHO) wrote:
&gt;<i> Following Rabbitmq discuss &quot;unexplained broker shutdown&quot;, what are the risks to configure the vm_memory_high_watermark to a higher value in order to not start paging messages at 8% of installed RAM but at 30% or more?
</I>
In extremis, it could crash due to the Erlang VM being unable to
allocate sufficient RAM for things like garbage collection. Note this is
really quite unlikely, but not impossible.

Also, Rabbit can't actually stop Erlang from using more RAM. There are
scenarios in which Rabbit will eat up vastly more than the 40% it's
notionally meant to throttle publishers at, so a good amount of buffer
space is well advised. Finally, a good amount of space for the OS to
cache disk in is also helpful.

More likely is that you run out of RAM, which means you then have no
disk cache, so performance will suffer, and then Rabbit will start being
swapped out to disk, which will utterly cripple performance. Once
performance starts to drop, as it's likely Rabbit is overloaded anyway
(otherwise it wouldn't have used up so much RAM), performance will fall
off very rapidly, and this can go from bad to worse.

Matthew
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
#
&quot; Ce courriel et les documents qui lui sont joints peuvent contenir des informations confidentielles ou ayant un caract&#232;re priv&#233;. S'ils ne vous sont pas destin&#233;s, nous vous signalons qu'il est strictement interdit de les divulguer, de les reproduire ou d'en utiliser de quelque mani&#232;re que ce soit le contenu. Si ce message vous a &#233;t&#233; transmis par erreur, merci d'en informer l'exp&#233;diteur et de supprimer imm&#233;diatement de votre syst&#232;me informatique ce courriel ainsi que tous les documents qui y sont attach&#233;s.&quot;
******
&quot; This e-mail and any attached documents may contain confidential or proprietary information. If you are not the intended recipient, you are notified that any dissemination, copying of this e-mail and any attachments thereto or use of their contents by any means whatsoever is strictly prohibited. If you have received this e-mail in error, please advise the sender immediately and delete this e-mail and all attached documents from your computer system.&quot;
#
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014500.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
	<LI>Next message: <A HREF="014632.html">[rabbitmq-discuss] Configure VM memory high watermark
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14560">[ date ]</a>
              <a href="thread.html#14560">[ thread ]</a>
              <a href="subject.html#14560">[ subject ]</a>
              <a href="author.html#14560">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
