<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20while%20connect%20to%20rabbitmq%20using%0A%20rabbitmq-erlang-client%20library&In-Reply-To=%3C20110802140912.GA25255%40dakota.eng.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014295.html">
   <LINK REL="Next"  HREF="014305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library</H1>
    <B>Alexandru Scvor&#355;ov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20while%20connect%20to%20rabbitmq%20using%0A%20rabbitmq-erlang-client%20library&In-Reply-To=%3C20110802140912.GA25255%40dakota.eng.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library">alexandru at rabbitmq.com
       </A><BR>
    <I>Tue Aug  2 15:09:12 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014295.html">[rabbitmq-discuss] Error while connect to rabbitmq using	rabbitmq-erlang-client library
</A></li>
        <LI>Next message: <A HREF="014305.html">[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14298">[ date ]</a>
              <a href="thread.html#14298">[ thread ]</a>
              <a href="subject.html#14298">[ subject ]</a>
              <a href="author.html#14298">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> ** Reason for termination ==
</I>&gt;<i> ** {{badmatch,{error,enomem}},
</I>&gt;<i>     [{amqp_main_reader,handle_inet_async,2},
</I>&gt;<i>      {gen_server,handle_msg,5},
</I>&gt;<i>      {proc_lib,init_p_do_apply,3}]}
</I>
Strictly speaking, that means you've run out of memory.  Not sure how
that could happen, though.

There's an error in your example:

&gt;<i>         Get = #'basic.get'{queue = Queue},
</I>
should be

&gt;<i>         Get = #'basic.get'{queue = list_to_binary(Queue)},
</I>
Actually, you'd probably be better off converting Queue to a binary from
the start.

Still, the failure is during the initial handshake, so that can't be the
cause.

Have a look in the server logs: is there a matching error?  Is there any mention
of the memory alarms being set off?

What OS are you using?  What version of Erlang?  Is there anything
special about the system's configuration?  Is it under heavy load?

&gt;<i>   I kept get error message while connect to rabbitmq server using
</I>&gt;<i> rabbitmq-erlang-client library. Anyone can help, thanks.
</I>
Does this mean you *always* get this error?  Or only occasionally?

Cheers,
Alex

On Tue, Aug 02, 2011 at 09:43:46PM +0800, Fisher Yu wrote:
&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i>   I kept get error message while connect to rabbitmq server using
</I>&gt;<i> rabbitmq-erlang-client library. Anyone can help, thanks.
</I>&gt;<i> 
</I>&gt;<i> Erlang R14B03 (erts-5.8.4) [source] [64-bit] [smp:24:24] [rq:24]
</I>&gt;<i> [async-threads:0] [kernel-poll:false]
</I>&gt;<i> Eshell V5.8.4  (abort with ^G)
</I>&gt;<i> 1&gt; test:start().
</I>&gt;<i> =ERROR REPORT==== 2-Aug-2011::08:40:18 ===
</I>&gt;<i> ** Generic server &lt;0.46.0&gt; terminating
</I>&gt;<i> ** Last message in was
</I>&gt;<i> {inet_async,#Port&lt;0.1109&gt;,1,{ok,&lt;&lt;65,77,81,80,1,1,8&gt;&gt;}}
</I>&gt;<i> ** When Server state == {state,#Port&lt;0.1109&gt;,&lt;0.39.0&gt;,&lt;0.41.0&gt;,
</I>&gt;<i>                                {method,rabbit_framing_amqp_0_9_1},
</I>&gt;<i>                                none}
</I>&gt;<i> ** Reason for termination ==
</I>&gt;<i> ** {{badmatch,{error,enomem}},
</I>&gt;<i>     [{amqp_main_reader,handle_inet_async,2},
</I>&gt;<i>      {gen_server,handle_msg,5},
</I>&gt;<i>      {proc_lib,init_p_do_apply,3}]}
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> %%test.erl
</I>&gt;<i> 
</I>&gt;<i> -module(test).
</I>&gt;<i> -include_lib(&quot;amqp_client/include/amqp_client.hrl&quot;).
</I>&gt;<i> -compile(export_all).
</I>&gt;<i> start() -&gt;
</I>&gt;<i>         {ok, Connection} =
</I>&gt;<i> amqp_connection:start(#amqp_params_network{username= &lt;&lt;&quot;myuser&quot;&gt;&gt;, password=
</I>&gt;<i> &lt;&lt;&quot;mypassword&quot;&gt;&gt;}),
</I>&gt;<i>         {ok, Channel} = amqp_connection:open_channel(Connection),
</I>&gt;<i>         Queue = &quot;my_queue&quot;,
</I>&gt;<i>         Declare = #'queue.declare'{queue = list_to_binary(Queue),
</I>&gt;<i> durable=true},
</I>&gt;<i>         #'queue.declare_ok'{} = amqp_channel:call(Channel, Declare),
</I>&gt;<i>         Get = #'basic.get'{queue = Queue},
</I>&gt;<i>         {#'basic.get_ok'{delivery_tag = Tag}, Content}
</I>&gt;<i>                        = amqp_channel:call(Channel, Get),
</I>&gt;<i>         io:format(&quot;received message ~p&quot;, [Content]),
</I>&gt;<i>         %% Close the channel
</I>&gt;<i>         amqp_channel:close(Channel),
</I>&gt;<i>         %% Close the connection
</I>&gt;<i>         amqp_connection:close(Connection),
</I>&gt;<i>         ok.
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014295.html">[rabbitmq-discuss] Error while connect to rabbitmq using	rabbitmq-erlang-client library
</A></li>
	<LI>Next message: <A HREF="014305.html">[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14298">[ date ]</a>
              <a href="thread.html#14298">[ thread ]</a>
              <a href="subject.html#14298">[ subject ]</a>
              <a href="author.html#14298">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
