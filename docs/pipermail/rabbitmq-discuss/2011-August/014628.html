<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumer without a valid connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20without%20a%20valid%20connection&In-Reply-To=%3C4E4E4585.2010309%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014627.html">
   <LINK REL="Next"  HREF="014679.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumer without a valid connection</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20without%20a%20valid%20connection&In-Reply-To=%3C4E4E4585.2010309%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Consumer without a valid connection">emile at rabbitmq.com
       </A><BR>
    <I>Fri Aug 19 12:14:13 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014627.html">[rabbitmq-discuss] Consumer without a valid connection
</A></li>
        <LI>Next message: <A HREF="014679.html">[rabbitmq-discuss] Consumer without a valid connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14628">[ date ]</a>
              <a href="thread.html#14628">[ thread ]</a>
              <a href="subject.html#14628">[ subject ]</a>
              <a href="author.html#14628">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Andrea,

On 19/08/11 11:27, Rosa, Andrea wrote:

&gt;<i> For some reason, that we can&#8217;t understand, we have got a queue with two
</I>&gt;<i> consumers and one of this consumer is using a channel of a connection
</I>&gt;<i> that is not present in the list of connections.
</I>
That should not be possible. If you check the connection pid of each
channel with &quot;rabbitmqctl list_channels connection&quot; each of them should
appear in the output of &quot;rabbitmqctl list_connections pid&quot;. Is that not
the case?

The output of &quot;rabbitmqctl report&quot; will also contain this information.

&gt;<i> When the publisher send a message to that queue the message is grabbed
</I>&gt;<i> from the queue after 15 minutes!
</I>
There are a few ways to diagnose who is responsible for that delay. You
could make all connections via the AMQP Tracer:
<A HREF="http://www.rabbitmq.com/javadoc/com/rabbitmq/tools/Tracer.html">http://www.rabbitmq.com/javadoc/com/rabbitmq/tools/Tracer.html</A>

You could observe the AMQP exchanges on the network between the broker
and peers using a protocol analyser, such as Wireshark.

Also consider debugging with the Firehose, which lets you observe
messages entering and leaving the broker. Avoid the network when
consuming the firehose messages. For details see
<A HREF="http://www.rabbitmq.com/firehose.html">http://www.rabbitmq.com/firehose.html</A>

&gt;<i> My questions are:
</I>&gt;<i> 
</I>&gt;<i> -        How is it possible that the consumer is using a channel on a
</I>&gt;<i> connection that no more  exists?
</I>&gt;<i> 
</I>&gt;<i> -        Why there is this delay in grabbing messages? My expectation is
</I>&gt;<i> that the consumer listening to the correct connection can fetch the
</I>&gt;<i> message immediately
</I>&gt;<i> 
</I>&gt;<i> -        The &#8220;wrong&#8221; consumer can block the access to the queue?
</I>
Is the network between the broker and peers reliable? Consider turning
on AMQP heartbeats if the broker and peers do not about connections.


Emile

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014627.html">[rabbitmq-discuss] Consumer without a valid connection
</A></li>
	<LI>Next message: <A HREF="014679.html">[rabbitmq-discuss] Consumer without a valid connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14628">[ date ]</a>
              <a href="thread.html#14628">[ thread ]</a>
              <a href="subject.html#14628">[ subject ]</a>
              <a href="author.html#14628">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
