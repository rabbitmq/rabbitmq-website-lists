<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ on EC2 performance challenge
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20on%20EC2%20performance%20challenge&In-Reply-To=%3CCAO%3D2P%2B%2BajSeJ_tN7Rye03EF4ezH-pCShC%3DhQCd4ez02kBzOTvA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014391.html">
   <LINK REL="Next"  HREF="014336.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ on EC2 performance challenge</H1>
    <B>Jaymin Shah</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20on%20EC2%20performance%20challenge&In-Reply-To=%3CCAO%3D2P%2B%2BajSeJ_tN7Rye03EF4ezH-pCShC%3DhQCd4ez02kBzOTvA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ on EC2 performance challenge">sjaymin at gmail.com
       </A><BR>
    <I>Thu Aug  4 11:12:23 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014391.html">[rabbitmq-discuss] RabbitMQ on EC2 performance challenge
</A></li>
        <LI>Next message: <A HREF="014336.html">[rabbitmq-discuss] RabbitMQ RPM and its dependencies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14330">[ date ]</a>
              <a href="thread.html#14330">[ thread ]</a>
              <a href="subject.html#14330">[ subject ]</a>
              <a href="author.html#14330">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What could be performance expectations of RabbitMQ on EC2? Would appreciate
sharing experience here.


I am trying to do some performance test of RabbitMQ on aws EC2. I have 3
separate EC2 instance running for RabbitMQ, Publisher and consumer/worker.


The scenario I have is that Publisher pushes JSON string (approx 165-200
bytes) to exchange type direct with durable set to true and bind queue with
durable set to true (i.e. both in persistent mode). Consumer/worker is
running on separate box - keeps pulling messages. (Moving forward these
messages at worker are expected to be persisted in MongoDB and Publisher
would be replaced with Restful  service using REST easy)


To keep things simple I have simulated this scenario by using Multicast
sample code. I had split multicast code in to two separate java file namely
&#8220;Producer&#8221; and &#8220;Worker&#8221; to run each on separate box. I have used &#8220;c1.mediam&#8221;
EC2 with Ubuntu server v11.4 32 bit for running producer and consumer and
&#8220;m1.large&#8221; with Ubuntu server v11.4 64 bit for RabbitMQ.


I am able to achieve a throughput of 3-5k messages per second i.e. keeping
study message push rate to 5K. (This concur
<A HREF="withhttp://www.rabbitmq.com/faq.html#performance-latency">withhttp://www.rabbitmq.com/faq.html#performance-latency</A>
)


Further, when I increase the push rate to 10-12k messages per second.
Consumer&#8217;s ability to consume messages drops to 1-2k messages per second and
it generates backlog (Many time it goes below 800 messages per second too).


With above scenario, I have following questions and would appreciate
thoughts/suggestion to improve throughput of consumer as well.  (NOTE: all
the messages in my scenario are expected to similar type giving no
opportunity to group them for setting routing therefore may need some kind
of load-balancer approach)


1) This performance is observed with one rabbitMQ server, one exchange and
one queue. Is anything further can be configured, fine-tuned to improvise
throughput to more than 5k with persistent mode.


2) I do understand, clustering could be another option. However, I need to
set cluster based on incoming load and I may not get message grouping /
identity to define routing (since messages are expected to be just log
description). Can I have clustering following load balancing option for
worker/consumer?


3) I am expected to process several hundred thousand requests per second. I
would appreciate sharing some experience and approach to achieve this.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110804/9ae7c51f/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110804/9ae7c51f/attachment.htm</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014391.html">[rabbitmq-discuss] RabbitMQ on EC2 performance challenge
</A></li>
	<LI>Next message: <A HREF="014336.html">[rabbitmq-discuss] RabbitMQ RPM and its dependencies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14330">[ date ]</a>
              <a href="thread.html#14330">[ thread ]</a>
              <a href="subject.html#14330">[ subject ]</a>
              <a href="author.html#14330">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
