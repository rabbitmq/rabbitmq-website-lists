<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20NotImplementedError%3A%20%3Cclass%0A%20%27pika.spec.CancelOk%27%3E&In-Reply-To=%3C39C8DD04C7C04F10879AF2EF8BF8E901%40myyearbook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014573.html">
   <LINK REL="Next"  HREF="014575.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;</H1>
    <B>Gavin M. Roy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20NotImplementedError%3A%20%3Cclass%0A%20%27pika.spec.CancelOk%27%3E&In-Reply-To=%3C39C8DD04C7C04F10879AF2EF8BF8E901%40myyearbook.com%3E"
       TITLE="[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;">gmr at myyearbook.com
       </A><BR>
    <I>Tue Aug 16 17:32:44 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014573.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
        <LI>Next message: <A HREF="014575.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14574">[ date ]</a>
              <a href="thread.html#14574">[ thread ]</a>
              <a href="subject.html#14574">[ subject ]</a>
              <a href="author.html#14574">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> It looks like to me that you have a non-standard pika install, perhaps the new debian package? 

I say that because I see:

&gt;<i> &gt; &gt; /usr/local/lib/python2.7/dist-packages/pika/connection.py
</I>And I'd expect something like:

/usr/lib/python2.7/site-packages/pika/connection.py

Can you use slocate or find to see if you have more than one version of pika installed?

What happens when you run the following in python2.7 interactively?

import pika
pika.__version__




On Tuesday, August 16, 2011 at 12:18 PM, Matt Pietrek wrote:

&gt;<i> Alas, no luck with a Pika reinstall. I did a &quot;pip uninstall&quot; of what was
</I>&gt;<i> there, verified the files were removed, then &quot;pip install&quot;.
</I>&gt;<i> 
</I>&gt;<i> All other aspects of my Pika-based code seem to work. I'm sending and
</I>&gt;<i> receiving 1000's of messages before shutting down. It's only at shutdown
</I>&gt;<i> where the problem occurs.
</I>&gt;<i> 
</I>&gt;<i> Does my shutdown sequence look OK? That is, calling
</I>&gt;<i> channel.stop_consuming() from a different thread than I called
</I>&gt;<i> .start_consuming on?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 8/16/11 4:29 AM, &quot;Marek Majkowski&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">majek04 at gmail.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">majek04 at gmail.com</A>)&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; On Tue, Aug 16, 2011 at 00:36, Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at hotmail.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at hotmail.com</A>)&gt; wrote:
</I>&gt;<i> &gt; &gt; I'm getting the following error from code that used to work without
</I>&gt;<i> &gt; &gt; error until I did an &quot;apt-get upgrade&quot; today.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; This is an Ubuntu 11.04 system running Python 2.7 and Pika 0.95. Any
</I>&gt;<i> &gt; &gt; clues what's happening?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Nope. Maybe it's just a python installation issue?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Can you try removing pika and installing it again? Or maybe
</I>&gt;<i> &gt; installing a fresh local copy (for example using venv)?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Cheers,
</I>&gt;<i> &gt;  Marek
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; Traceback (most recent call last):
</I>&gt;<i> &gt; &gt;  File &quot;/usr/lib/python2.7/threading.py&quot;, line 552, in
</I>&gt;<i> &gt; &gt; __bootstrap_inner
</I>&gt;<i> &gt; &gt;  self.run()
</I>&gt;<i> &gt; &gt;  File &quot;ConfigMgr.py&quot;, line 101, in run
</I>&gt;<i> &gt; &gt;  self.channel.start_consuming()
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;<i> &gt; &gt; blocking_connection.py&quot;, line 293, in start_consuming
</I>&gt;<i> &gt; &gt;  self.transport.connection.process_data_events()
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;<i> &gt; &gt; blocking_connection.py&quot;, line 94, in process_data_events
</I>&gt;<i> &gt; &gt;  self._handle_read()
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;<i> &gt; &gt; base_connection.py&quot;, line 162, in _handle_read
</I>&gt;<i> &gt; &gt;  self._on_data_available(data)
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/connection.py&quot;,
</I>&gt;<i> &gt; &gt; line 599, in _on_data_available
</I>&gt;<i> &gt; &gt;  self._channels[frame.channel_number].transport.deliver(frame)
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/channel.py&quot;, line
</I>&gt;<i> &gt; &gt; 64, in deliver
</I>&gt;<i> &gt; &gt;  self.frame_dispatcher.process(frame)
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/frame.py&quot;, line
</I>&gt;<i> &gt; &gt; 202, in process
</I>&gt;<i> &gt; &gt;  self._handler(frame)
</I>&gt;<i> &gt; &gt;  File &quot;/usr/local/lib/python2.7/dist-packages/pika/frame.py&quot;, line
</I>&gt;<i> &gt; &gt; 220, in _handle_method_frame
</I>&gt;<i> &gt; &gt;  raise NotImplementedError(frame.method.__class__)
</I>&gt;<i> &gt; &gt; NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Here's what my code looks like:
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; class ListenForLongRunningEventCompletion(threading.Thread):
</I>&gt;<i> &gt; &gt;  def run(self):
</I>&gt;<i> &gt; &gt;  self.connection =
</I>&gt;<i> &gt; &gt; pika.BlockingConnection(pika.ConnectionParameters(host=MQ_BINDING))
</I>&gt;<i> &gt; &gt;  self.channel = self.connection.channel()
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt;  self.channel.queue_declare(queue=RESPONSE_QUEUE_NAME)
</I>&gt;<i> &gt; &gt;  self.channel.basic_consume(ResponseCallback,
</I>&gt;<i> &gt; &gt;  queue=RESPONSE_QUEUE_NAME,
</I>&gt;<i> &gt; &gt;  no_ack=True)
</I>&gt;<i> &gt; &gt;  self.channel.start_consuming()
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt;  def shutdown(self):
</I>&gt;<i> &gt; &gt;  self.channel.stop_consuming()
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; def ResponseCallback(ch, method, properties, body):
</I>&gt;<i> &gt; &gt;  print &quot;Long Running Task response({0})&quot;.format(body)
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; #========================================================================
</I>&gt;<i> &gt; &gt; ======
</I>&gt;<i> &gt; &gt; #
</I>&gt;<i> &gt; &gt; # Main program
</I>&gt;<i> &gt; &gt; #
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; #========================================================================
</I>&gt;<i> &gt; &gt; ======
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; if __name__ == '__main__':
</I>&gt;<i> &gt; &gt;  listener = ListenForLongRunningEventCompletion()
</I>&gt;<i> &gt; &gt;  listener.start()
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt;  # Main app logic - not important here
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt;  # Shut down the connections we've opened up
</I>&gt;<i> &gt; &gt;  listener.shutdown()
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>)
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A> (mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>)
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110816/5b29ee6e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110816/5b29ee6e/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014573.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
	<LI>Next message: <A HREF="014575.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14574">[ date ]</a>
              <a href="thread.html#14574">[ thread ]</a>
              <a href="subject.html#14574">[ subject ]</a>
              <a href="author.html#14574">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
