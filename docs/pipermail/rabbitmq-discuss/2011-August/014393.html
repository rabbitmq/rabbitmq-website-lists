<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ and Stomp topic behavior
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20and%20Stomp%20topic%20behavior&In-Reply-To=%3CCAMOXM28hGfczSAUH5ELmhYzaZ0QfQe3T_1D-Ju5Hmaf-Zmef3w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014390.html">
   <LINK REL="Next"  HREF="014394.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ and Stomp topic behavior</H1>
    <B>Massimo Paladin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20and%20Stomp%20topic%20behavior&In-Reply-To=%3CCAMOXM28hGfczSAUH5ELmhYzaZ0QfQe3T_1D-Ju5Hmaf-Zmef3w%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ and Stomp topic behavior">Massimo.Paladin at cern.ch
       </A><BR>
    <I>Mon Aug  8 16:19:11 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014390.html">[rabbitmq-discuss] RabbitMQ and Stomp topic behavior
</A></li>
        <LI>Next message: <A HREF="014394.html">[rabbitmq-discuss] RabbitMQ and Stomp topic behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14393">[ date ]</a>
              <a href="thread.html#14393">[ thread ]</a>
              <a href="subject.html#14393">[ subject ]</a>
              <a href="author.html#14393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I tried in two machines, in one I had 0.5, in the other I did not set it
which means the default is 0.4.

They both crashed and I get many memory alarms and clears in the log.

The memory goes up and down through the test, and soon or later it fills
both memory and swap until it gets to crash.

Cheers,
---
Massimo Paladin

email: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">massimo.paladin at gmail.com</A>
website: <A HREF="http://www.mpaladin.com">http://www.mpaladin.com</A>
flickr's page: <A HREF="http://flickr.com/photos/massimop">http://flickr.com/photos/massimop</A>


On Mon, Aug 8, 2011 at 5:06 PM, Matthias Radestock &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;wrote:

&gt;<i> Massimo,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 07/08/11 20:52, Massimo Paladin wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Why does the memory goes up if there are no consumers attached to the
</I>&gt;&gt;<i> topic?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Messages are processed in a fully asynchronous pipeline, and the decision
</I>&gt;<i> on whether to discard a message is made at a later stage.
</I>&gt;<i>
</I>&gt;<i> Having this pipeline allows rabbit to absorb spikes in message load, i.e.
</I>&gt;<i> it can read messages off the socket quickly and pass them to the next stage
</I>&gt;<i> of the pipeline.
</I>&gt;<i>
</I>&gt;<i> However, if the load is not a spike and instead is consistently high then
</I>&gt;<i> obviously rabbit will run out of memory eventually. To prevent that, memory
</I>&gt;<i> usage is monitored and producers are temporarily blocked to relieve memory
</I>&gt;<i> pressure. So...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  The scenario provided makes memory increasing and if you let it run for
</I>&gt;&gt;<i> some time at some point rabbitmq crashes because it can not allocate
</I>&gt;&gt;<i> memory.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That shouldn't happen. Do you get any memory alarms in the rabbit logs?
</I>&gt;<i> Also, does Rabbit run out of memory with the default threshold of 0.4?
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110808/7bb9a00a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110808/7bb9a00a/attachment.htm</A>&gt;
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014390.html">[rabbitmq-discuss] RabbitMQ and Stomp topic behavior
</A></li>
	<LI>Next message: <A HREF="014394.html">[rabbitmq-discuss] RabbitMQ and Stomp topic behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14393">[ date ]</a>
              <a href="thread.html#14393">[ thread ]</a>
              <a href="subject.html#14393">[ subject ]</a>
              <a href="author.html#14393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
