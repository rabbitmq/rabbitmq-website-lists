<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20while%20connect%20to%20rabbitmq%20using%0A%20rabbitmq-erlang-client%20library&In-Reply-To=%3CCAPnrV9_XPKqRnn9RHdf0%3DUerCJ71nT1mfD5gJ0iW_dk%3Dz0WygQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014298.html">
   <LINK REL="Next"  HREF="014319.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library</H1>
    <B>Fisher Yu</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Error%20while%20connect%20to%20rabbitmq%20using%0A%20rabbitmq-erlang-client%20library&In-Reply-To=%3CCAPnrV9_XPKqRnn9RHdf0%3DUerCJ71nT1mfD5gJ0iW_dk%3Dz0WygQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library">fisher at yun.io
       </A><BR>
    <I>Wed Aug  3 04:31:27 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014298.html">[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
</A></li>
        <LI>Next message: <A HREF="014319.html">[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14305">[ date ]</a>
              <a href="thread.html#14305">[ thread ]</a>
              <a href="subject.html#14305">[ subject ]</a>
              <a href="author.html#14305">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2011/8/2 Alexandru Scvor&#355;ov &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexandru at rabbitmq.com</A>&gt;

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> &gt; ** Reason for termination ==
</I>&gt;<i> &gt; ** {{badmatch,{error,enomem}},
</I>&gt;<i> &gt;     [{amqp_main_reader,handle_inet_async,2},
</I>&gt;<i> &gt;      {gen_server,handle_msg,5},
</I>&gt;<i> &gt;      {proc_lib,init_p_do_apply,3}]}
</I>&gt;<i>
</I>&gt;<i> Strictly speaking, that means you've run out of memory.  Not sure how
</I>&gt;<i> that could happen, though.
</I>&gt;<i>
</I>&gt;<i> There's an error in your example:
</I>&gt;<i>
</I>&gt;<i> &gt;         Get = #'basic.get'{queue = Queue},
</I>&gt;<i>
</I>&gt;<i> should be
</I>&gt;<i>
</I>&gt;<i> &gt;         Get = #'basic.get'{queue = list_to_binary(Queue)},
</I>&gt;<i>
</I>&gt;<i> Actually, you'd probably be better off converting Queue to a binary from
</I>&gt;<i> the start.
</I>&gt;<i>
</I>
Changed this, thanks.


&gt;<i>
</I>&gt;<i> Still, the failure is during the initial handshake, so that can't be the
</I>&gt;<i> cause.
</I>&gt;<i>
</I>&gt;<i> Have a look in the server logs: is there a matching error?  Is there any
</I>&gt;<i> mention
</I>&gt;<i> of the memory alarms being set off?
</I>&gt;<i>
</I>
There is nothing happening in the server logs, at least nothing being
raised.  There is 24G RAM in here, with about 4G active and 11G free at the
time of testing.



&gt;<i>
</I>&gt;<i> What OS are you using?  What version of Erlang?  Is there anything
</I>&gt;<i> special about the system's configuration?  Is it under heavy load?
</I>&gt;<i>
</I>

The distribution is Ubuntu 10.04,
uname -a
Linux fs21 2.6.32-31-generic #61-Ubuntu SMP Fri Apr 8 18:25:51 UTC 2011
x86_64 GNU/Linux

Erlang version
Erlang R14B03 (erts-5.8.4) [source] [64-bit] [smp:24:24] [rq:24]
[async-threads:0] [kernel-poll:false]

This machine is almost completely idle at the moment as it's a development
server.  There is nothing special for the configuration.


&gt;<i>
</I>&gt;<i> &gt;   I kept get error message while connect to rabbitmq server using
</I>&gt;<i> &gt; rabbitmq-erlang-client library. Anyone can help, thanks.
</I>&gt;<i>
</I>&gt;<i> Does this mean you *always* get this error?  Or only occasionally?
</I>&gt;<i>
</I>
Every time the test case is run, this error is produced.


&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Alex
</I>&gt;<i>
</I>&gt;<i> On Tue, Aug 02, 2011 at 09:43:46PM +0800, Fisher Yu wrote:
</I>&gt;<i> &gt; Hi
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   I kept get error message while connect to rabbitmq server using
</I>&gt;<i> &gt; rabbitmq-erlang-client library. Anyone can help, thanks.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Erlang R14B03 (erts-5.8.4) [source] [64-bit] [smp:24:24] [rq:24]
</I>&gt;<i> &gt; [async-threads:0] [kernel-poll:false]
</I>&gt;<i> &gt; Eshell V5.8.4  (abort with ^G)
</I>&gt;<i> &gt; 1&gt; test:start().
</I>&gt;<i> &gt; =ERROR REPORT==== 2-Aug-2011::08:40:18 ===
</I>&gt;<i> &gt; ** Generic server &lt;0.46.0&gt; terminating
</I>&gt;<i> &gt; ** Last message in was
</I>&gt;<i> &gt; {inet_async,#Port&lt;0.1109&gt;,1,{ok,&lt;&lt;65,77,81,80,1,1,8&gt;&gt;}}
</I>&gt;<i> &gt; ** When Server state == {state,#Port&lt;0.1109&gt;,&lt;0.39.0&gt;,&lt;0.41.0&gt;,
</I>&gt;<i> &gt;                                {method,rabbit_framing_amqp_0_9_1},
</I>&gt;<i> &gt;                                none}
</I>&gt;<i> &gt; ** Reason for termination ==
</I>&gt;<i> &gt; ** {{badmatch,{error,enomem}},
</I>&gt;<i> &gt;     [{amqp_main_reader,handle_inet_async,2},
</I>&gt;<i> &gt;      {gen_server,handle_msg,5},
</I>&gt;<i> &gt;      {proc_lib,init_p_do_apply,3}]}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; %%test.erl
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -module(test).
</I>&gt;<i> &gt; -include_lib(&quot;amqp_client/include/amqp_client.hrl&quot;).
</I>&gt;<i> &gt; -compile(export_all).
</I>&gt;<i> &gt; start() -&gt;
</I>&gt;<i> &gt;         {ok, Connection} =
</I>&gt;<i> &gt; amqp_connection:start(#amqp_params_network{username= &lt;&lt;&quot;myuser&quot;&gt;&gt;,
</I>&gt;<i> password=
</I>&gt;<i> &gt; &lt;&lt;&quot;mypassword&quot;&gt;&gt;}),
</I>&gt;<i> &gt;         {ok, Channel} = amqp_connection:open_channel(Connection),
</I>&gt;<i> &gt;         Queue = &quot;my_queue&quot;,
</I>&gt;<i> &gt;         Declare = #'queue.declare'{queue = list_to_binary(Queue),
</I>&gt;<i> &gt; durable=true},
</I>&gt;<i> &gt;         #'queue.declare_ok'{} = amqp_channel:call(Channel, Declare),
</I>&gt;<i> &gt;         Get = #'basic.get'{queue = Queue},
</I>&gt;<i> &gt;         {#'basic.get_ok'{delivery_tag = Tag}, Content}
</I>&gt;<i> &gt;                        = amqp_channel:call(Channel, Get),
</I>&gt;<i> &gt;         io:format(&quot;received message ~p&quot;, [Content]),
</I>&gt;<i> &gt;         %% Close the channel
</I>&gt;<i> &gt;         amqp_channel:close(Channel),
</I>&gt;<i> &gt;         %% Close the connection
</I>&gt;<i> &gt;         amqp_connection:close(Connection),
</I>&gt;<i> &gt;         ok.
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110803/a0941cea/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110803/a0941cea/attachment.htm</A>&gt;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014298.html">[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
</A></li>
	<LI>Next message: <A HREF="014319.html">[rabbitmq-discuss] Error while connect to rabbitmq using rabbitmq-erlang-client library
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14305">[ date ]</a>
              <a href="thread.html#14305">[ thread ]</a>
              <a href="subject.html#14305">[ subject ]</a>
              <a href="author.html#14305">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
