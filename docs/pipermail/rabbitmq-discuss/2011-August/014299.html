<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20actively%20refuses%20connections%20after%0A%09connectity%20issues&In-Reply-To=%3C4E38062A.7040608%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014287.html">
   <LINK REL="Next"  HREF="014300.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20actively%20refuses%20connections%20after%0A%09connectity%20issues&In-Reply-To=%3C4E38062A.7040608%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues">simon at rabbitmq.com
       </A><BR>
    <I>Tue Aug  2 15:14:02 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014287.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
        <LI>Next message: <A HREF="014300.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14299">[ date ]</a>
              <a href="thread.html#14299">[ thread ]</a>
              <a href="subject.html#14299">[ subject ]</a>
              <a href="author.html#14299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 02/08/11 11:17, Alfonso Pantoja wrote:
&gt;<i> Thanks for your response.
</I>
No problem!

&gt;<i> We have about 8 windows services and all use the heartbeat feature. 6
</I>&gt;<i> of them use the basicGet approach (this should be changed)
</I>&gt;<i> I think default Ubuntu's configuration has not been modified so I
</I>&gt;<i> think it is strange that those few consumers/publishers could run out
</I>&gt;<i> the file descriptors.
</I>
Yes.

&gt;<i> Windows services try to connect to RabbitMQ continously so when the
</I>&gt;<i> connection is lost there are trying to connect permanently. Can these
</I>&gt;<i> behavior lead to a  file descriptor lack while Rabbit is restarting
</I>&gt;<i> and about to be operative?
</I>
It shouldn't: one of the last things RabbitMQ does when starting up is 
to listen for network connections, by the time it's capable of starting 
to consume file descriptors everything else should already be running.

&gt;<i> After reading some posts in this group I'm wondering if a large amount
</I>&gt;<i> of queues could be a problem. We have more 1000 durable queues. The
</I>&gt;<i> most of them are created due to the use of a custom mod_rabbitmq in
</I>&gt;<i> Ejabberd where all users have their message queue.
</I>
No, RabbitMQ will use a pool of file descriptors for reading and writing 
to queues, so you can easily have more queues than FDs (but you'll get 
some FD-swapping; if you have large numbers of queues all writing to 
disc you may get better performance by increasing the number of FDs 
available).

I really think your problem is that one of your clients was somehow 
opening connections in an uncontrolled way. If this happens again I 
would strongly recommend checking the connections list in mgmt or 
rabbitmqctl list_connections to see where they all are.

Obviously it's too late now but if you still have the log files from 
around then you might be able to cross reference &quot;accepted TCP 
connection&quot; and &quot;closing TCP connection&quot; and see what you have left over.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014287.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
	<LI>Next message: <A HREF="014300.html">[rabbitmq-discuss] RabbitMQ actively refuses connections after	connectity issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14299">[ date ]</a>
              <a href="thread.html#14299">[ thread ]</a>
              <a href="subject.html#14299">[ subject ]</a>
              <a href="author.html#14299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
