<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20NotImplementedError%3A%20%3Cclass%0A%20%27pika.spec.CancelOk%27%3E&In-Reply-To=%3CBLU0-SMTP2688BC4CF69521FBC5ACCEBD6290%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014574.html">
   <LINK REL="Next"  HREF="014689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20NotImplementedError%3A%20%3Cclass%0A%20%27pika.spec.CancelOk%27%3E&In-Reply-To=%3CBLU0-SMTP2688BC4CF69521FBC5ACCEBD6290%40phx.gbl%3E"
       TITLE="[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;">mpietrek at hotmail.com
       </A><BR>
    <I>Tue Aug 16 17:51:50 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="014574.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
        <LI>Next message: <A HREF="014689.html">[rabbitmq-discuss] NotImplementedError: &lt;class	'pika.spec.CancelOk'&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14575">[ date ]</a>
              <a href="thread.html#14575">[ thread ]</a>
              <a href="subject.html#14575">[ subject ]</a>
              <a href="author.html#14575">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the quick reply Gavin.

I've got no idea how my install would be non-standard. It's an Ubuntu 11.04
box, recently updated via &quot;sudo apt-get upgrade&quot;. FWIW, my Python 2.7
install is based in /usr/local/lib/python2.7, so the /local/ in the path
isn't surprising (to me at least...)

Per the instructions on the RabbitMq site, I did: &quot;sudo pip install
pika==0.9.5&quot;. I didn't notice any errors:

----------------
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at rabbitmq</A>:/usr/local/lib/python2.7$sudo pip install pika==0.9.5
Downloading/unpacking pika==0.9.5
  Downloading pika-0.9.5.tar.gz
  Running setup.py egg_info for package pika
    
Installing collected packages: pika
  Running setup.py install for pika
    
Successfully installed pika
Cleaning up...
----------------

The output from Interactive Python that you requested:

Python 2.7.1+ (r271:86832, Apr 11 2011, 18:13:53)
[GCC 4.5.2] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;<i> import pika
</I>&gt;&gt;&gt;<i> pika.__version__
</I>'0.9.5'

Also, FWIW, the contents of
/usr/local/lib/python2.7/dist-packages/pika-0.9.5.egg-info/PKG_INFO are:

Metadata-Version: 1.0
Name: pika
Version: 0.9.5
Summary: Pika Python AMQP Client Library
Home-page: <A HREF="http://pika.github.com/">http://pika.github.com/</A>
Author: Gavin M. Roy
Author-email: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">gmr at myyearbook.com</A>
License: MPL v1.1 and GPL v2.0 or newer
Description: Pika is a pure-Python implementation of the AMQP 0-9-1 protocol
that
        tries to stay fairly independent of the underlying network support
        library. Pika was developed primarily for use with RabbitMQ, but
        should also work with other AMQP 0-9-1 brokers.
        
Platform: UNKNOWN
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: GNU General Public License (GPL)
Classifier: License :: OSI Approved :: Mozilla Public License 1.1 (MPL 1.1)
Classifier: Operating System :: OS Independent
Classifier: Topic :: Communications
Classifier: Topic :: Internet
Classifier: Topic :: Software Development :: Libraries

Thanks much for your help,

Matt

From:  &quot;Gavin M. Roy&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">gmr at myyearbook.com</A>&gt;
Date:  Tue, 16 Aug 2011 12:32:44 -0400
To:  Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at hotmail.com</A>&gt;
Cc:  Marek Majkowski &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">majek04 at gmail.com</A>&gt;,
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Subject:  Re: [rabbitmq-discuss] NotImplementedError: &lt;class
'pika.spec.CancelOk'&gt;

 
 It looks like to me that you have a non-standard pika install, perhaps the
new debian package?

I say that because I see:

&gt;&gt;&gt;<i> /usr/local/lib/python2.7/dist-packages/pika/connection.py
</I>And I'd expect something like:

/usr/lib/python2.7/site-packages/pika/connection.py

Can you use slocate or find to see if you have more than one version of pika
installed?

What happens when you run the following in python2.7 interactively?

import pika
pika.__version__
 
 
  

On Tuesday, August 16, 2011 at 12:18 PM, Matt Pietrek wrote:
 
&gt;<i>  
</I>&gt;<i> Alas, no luck with a Pika reinstall. I did a &quot;pip uninstall&quot; of what was
</I>&gt;<i> there, verified the files were removed, then &quot;pip install&quot;.
</I>&gt;<i> 
</I>&gt;<i> All other aspects of my Pika-based code seem to work. I'm sending and
</I>&gt;<i> receiving 1000's of messages before shutting down. It's only at shutdown
</I>&gt;<i> where the problem occurs.
</I>&gt;<i> 
</I>&gt;<i> Does my shutdown sequence look OK? That is, calling
</I>&gt;<i> channel.stop_consuming() from a different thread than I called
</I>&gt;<i> .start_consuming on?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 8/16/11 4:29 AM, &quot;Marek Majkowski&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">majek04 at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> On Tue, Aug 16, 2011 at 00:36, Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at hotmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> I'm getting the following error from code that used to work without
</I>&gt;&gt;&gt;<i> error until I did an &quot;apt-get upgrade&quot; today.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> This is an Ubuntu 11.04 system running Python 2.7 and Pika 0.95. Any
</I>&gt;&gt;&gt;<i> clues what's happening?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Nope. Maybe it's just a python installation issue?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Can you try removing pika and installing it again? Or maybe
</I>&gt;&gt;<i> installing a fresh local copy (for example using venv)?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i>  Marek
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;&gt;<i>  File &quot;/usr/lib/python2.7/threading.py&quot;, line 552, in
</I>&gt;&gt;&gt;<i> __bootstrap_inner
</I>&gt;&gt;&gt;<i>    self.run()
</I>&gt;&gt;&gt;<i>  File &quot;ConfigMgr.py&quot;, line 101, in run
</I>&gt;&gt;&gt;<i>    self.channel.start_consuming()
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;&gt;&gt;<i> blocking_connection.py&quot;, line 293, in start_consuming
</I>&gt;&gt;&gt;<i>    self.transport.connection.process_data_events()
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;&gt;&gt;<i> blocking_connection.py&quot;, line 94, in process_data_events
</I>&gt;&gt;&gt;<i>    self._handle_read()
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/
</I>&gt;&gt;&gt;<i> base_connection.py&quot;, line 162, in _handle_read
</I>&gt;&gt;&gt;<i>    self._on_data_available(data)
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/connection.py&quot;,
</I>&gt;&gt;&gt;<i> line 599, in _on_data_available
</I>&gt;&gt;&gt;<i>    self._channels[frame.channel_number].transport.deliver(frame)
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/channel.py&quot;, line
</I>&gt;&gt;&gt;<i> 64, in deliver
</I>&gt;&gt;&gt;<i>    self.frame_dispatcher.process(frame)
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/frame.py&quot;, line
</I>&gt;&gt;&gt;<i> 202, in process
</I>&gt;&gt;&gt;<i>    self._handler(frame)
</I>&gt;&gt;&gt;<i>  File &quot;/usr/local/lib/python2.7/dist-packages/pika/frame.py&quot;, line
</I>&gt;&gt;&gt;<i> 220, in _handle_method_frame
</I>&gt;&gt;&gt;<i>    raise NotImplementedError(frame.method.__class__)
</I>&gt;&gt;&gt;<i> NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Here's what my code looks like:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> class ListenForLongRunningEventCompletion(threading.Thread):
</I>&gt;&gt;&gt;<i>    def run(self):
</I>&gt;&gt;&gt;<i>        self.connection =
</I>&gt;&gt;&gt;<i> pika.BlockingConnection(pika.ConnectionParameters(host=MQ_BINDING))
</I>&gt;&gt;&gt;<i>        self.channel = self.connection.channel()
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i>        self.channel.queue_declare(queue=RESPONSE_QUEUE_NAME)
</I>&gt;&gt;&gt;<i>        self.channel.basic_consume(ResponseCallback,
</I>&gt;&gt;&gt;<i>                              queue=RESPONSE_QUEUE_NAME,
</I>&gt;&gt;&gt;<i>                              no_ack=True)
</I>&gt;&gt;&gt;<i>        self.channel.start_consuming()
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i>    def shutdown(self):
</I>&gt;&gt;&gt;<i>        self.channel.stop_consuming()
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> def ResponseCallback(ch, method, properties, body):
</I>&gt;&gt;&gt;<i>    print &quot;Long Running Task response({0})&quot;.format(body)
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> #========================================================================
</I>&gt;&gt;&gt;<i> ======
</I>&gt;&gt;&gt;<i> #
</I>&gt;&gt;&gt;<i> # Main program
</I>&gt;&gt;&gt;<i> #
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> #========================================================================
</I>&gt;&gt;&gt;<i> ======
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> if __name__ == '__main__':
</I>&gt;&gt;&gt;<i>    listener = ListenForLongRunningEventCompletion()
</I>&gt;&gt;&gt;<i>    listener.start()
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i>    # Main app logic - not important here
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i>    # Shut down the connections we've opened up
</I>&gt;&gt;&gt;<i>    listener.shutdown()
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>      
</I>  
 
 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110816/aff6b60d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110816/aff6b60d/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014574.html">[rabbitmq-discuss] NotImplementedError: &lt;class 'pika.spec.CancelOk'&gt;
</A></li>
	<LI>Next message: <A HREF="014689.html">[rabbitmq-discuss] NotImplementedError: &lt;class	'pika.spec.CancelOk'&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14575">[ date ]</a>
              <a href="thread.html#14575">[ thread ]</a>
              <a href="subject.html#14575">[ subject ]</a>
              <a href="author.html#14575">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
