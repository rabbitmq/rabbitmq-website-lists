<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Rabbit Client Supervision Architecture
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20Client%20Supervision%20Architecture&In-Reply-To=%3Cloom.20100922T090432-103%40post.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009027.html">
   <LINK REL="Next"  HREF="009031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Rabbit Client Supervision Architecture</H1>
    <B>Erik Seres</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Rabbit%20Client%20Supervision%20Architecture&In-Reply-To=%3Cloom.20100922T090432-103%40post.gmane.org%3E"
       TITLE="[rabbitmq-discuss] Rabbit Client Supervision Architecture">erikseres at exosite.com
       </A><BR>
    <I>Wed Sep 22 08:42:46 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009027.html">[rabbitmq-discuss] Generally known configuration for open file	descriptor limits
</A></li>
        <LI>Next message: <A HREF="009031.html">[rabbitmq-discuss] Rabbit Client Supervision Architecture
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9029">[ date ]</a>
              <a href="thread.html#9029">[ thread ]</a>
              <a href="subject.html#9029">[ subject ]</a>
              <a href="author.html#9029">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a few questions regarding the RabbitMQ Erlang client library...

1) The client now has layers of supervision built in. Apparently, however, the 
maximum restart count for the various supervisors is set to 0. This will prevent 
the supervisor from trying to restart its children in case of a crash. I have 
verified this to be the case by the following:
 - created a network type connection to the server,
 - opened 2 channels within that connection,
 - sent a non-normal exit signal to the newly opened channel process.

The channel process crashed, its supervisor propagated the exit signal to the 
other channel and finally, it shut down itself, too. The client has never 
started back up again.

Question: What would be the intended use case of a supervisor with MaxRetryCount 
set to 0?

2) There is a channels manager process sitting at the same level in the 
supervision tree as the supervisor that supervises the supervisors of the 
channels (and writer and framing channel). The channels manager process does not 
have any links to the channels it apparently is to manage.

Question: What is the intended purpose of the channels manager?

3) I am trying to figure out how the four layers of supervision is supposed to 
work and can't really wrap my head around it. The way I conceive it should work 
is something like this, from top down:
 - Layer 1: supervise the entire client library
 - Layer 2: one_for_all supervision per connection. That is, when the 
connection, main reader or writer dies, shutdown all channels within that 
connection, restart the connection and all previously open channels.
 - Layer 3: one_for_one supervision per channel. That is, when a channel dies, 
restart the channel only and not affect anything else.

Question: Is this the intended behavior or am I on the wrong track?

Thanks,
Erik

</PRE>












































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009027.html">[rabbitmq-discuss] Generally known configuration for open file	descriptor limits
</A></li>
	<LI>Next message: <A HREF="009031.html">[rabbitmq-discuss] Rabbit Client Supervision Architecture
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9029">[ date ]</a>
              <a href="thread.html#9029">[ thread ]</a>
              <a href="subject.html#9029">[ subject ]</a>
              <a href="author.html#9029">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
