<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Active/active HA setup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Active/active%20HA%20setup&In-Reply-To=%3C4C800D2E.9070409%40krutil.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008765.html">
   <LINK REL="Next"  HREF="008768.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Active/active HA setup</H1>
    <B>Jiri Krutil</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Active/active%20HA%20setup&In-Reply-To=%3C4C800D2E.9070409%40krutil.com%3E"
       TITLE="[rabbitmq-discuss] Active/active HA setup">jiri at krutil.com
       </A><BR>
    <I>Thu Sep  2 21:46:38 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008765.html">[rabbitmq-discuss] Active/active HA setup
</A></li>
        <LI>Next message: <A HREF="008768.html">[rabbitmq-discuss] Active/active HA setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8767">[ date ]</a>
              <a href="thread.html#8767">[ thread ]</a>
              <a href="subject.html#8767">[ subject ]</a>
              <a href="author.html#8767">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alexis

Sorry I probably didn't express myself well.

We don't plan a primary and secondary broker, but a pair of brokers that 
are both active at the same time. A load balancer divides client 
connections to these brokers. A request queue with the same name exists 
on both brokers, but with different contents. Some clients send requests 
to one broker, some to the other. Our back-end server listens to both 
queues, processes requests and sends each response to an exclusive 
client queue on the broker from where the request came.

Ideally this would be transparent to the clients, because the brokers 
would be hidden by a virtual IP address. Of course it can't be 
transparent to the back-end server, which needs to talk to both brokers 
at the same time.

So (a) is correct, but (b) not.

Hope that makes it a bit clearer...

Cheers
Jiri


&gt;<i> Jiri
</I>&gt;<i>
</I>&gt;<i> That answered my questions.  Now, as I understood your example:
</I>&gt;<i>
</I>&gt;<i> a. you don't mind messages being lost
</I>&gt;<i> *and*
</I>&gt;<i> b. you don't use the secondary until after the primary has failed.
</I>&gt;<i>
</I>&gt;<i> Note that if consumption is completely 'fire and forget' then it is 
</I>&gt;<i> possible that a message from the primary may *arrive* after a message 
</I>&gt;<i> from the secondary.  But this can happen whether you use sequence 
</I>&gt;<i> numbers or not.
</I>&gt;<i>
</I>&gt;<i> So if the primary broker fails, why not just forget all undelivered 
</I>&gt;<i> messages?  Consumers will know that any message consumed from the 
</I>&gt;<i> secondary must be later in *all* orderings than any message consumed 
</I>&gt;<i> from the primary.  So, additional sequence numbering is not necessary.
</I>&gt;<i>
</I>&gt;<i> alexis
</I></PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008765.html">[rabbitmq-discuss] Active/active HA setup
</A></li>
	<LI>Next message: <A HREF="008768.html">[rabbitmq-discuss] Active/active HA setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8767">[ date ]</a>
              <a href="thread.html#8767">[ thread ]</a>
              <a href="subject.html#8767">[ subject ]</a>
              <a href="author.html#8767">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
