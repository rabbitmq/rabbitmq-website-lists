<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] HA and database schema changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20and%20database%20schema%20changes&In-Reply-To=%3CA1CB3D904533654CB64599397AC43ADE013D444C5F36%40NAMBX02.corp.adobe.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008948.html">
   <LINK REL="Next"  HREF="009037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] HA and database schema changes</H1>
    <B>Steve Haneman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20and%20database%20schema%20changes&In-Reply-To=%3CA1CB3D904533654CB64599397AC43ADE013D444C5F36%40NAMBX02.corp.adobe.com%3E"
       TITLE="[rabbitmq-discuss] HA and database schema changes">shaneman at adobe.com
       </A><BR>
    <I>Tue Sep 21 19:08:56 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008948.html">[rabbitmq-discuss] HA and database schema changes
</A></li>
        <LI>Next message: <A HREF="009037.html">[rabbitmq-discuss] HA and database schema changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9025">[ date ]</a>
              <a href="thread.html#9025">[ thread ]</a>
              <a href="subject.html#9025">[ subject ]</a>
              <a href="author.html#9025">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the reply Vlad.  Is there any possible way to migrate the mnesia db or do live upgrades without bringing down a HA RabbitMQ cluster?
I'm looking specifically at the Pacemaker/Corosync/drdb HA RabbitMQ cluster configuration.

--Steve

From: Vlad Alexandru Ionescu [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">vlad at rabbitmq.com</A>]
Sent: Wednesday, September 15, 2010 8:32 AM
To: Steve Haneman
Cc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] HA and database schema changes


Hi Steve,

There is currently no easy way to migrate the database.

In general, it is advisable to use the same code which you first used to create the exchanges, queues etc. on the new version of Rabbit to reconstruct your setup.
In order to migrate messages, you would have to use the rabbitmq-shovel plugin, which would consume messages from the old broker and would publish them into the new one (you must come up with a sensible configuration, depending on you setup).

Hope that answers your question.

Rgds,
Vlad.



On 09/14/2010 09:28 PM, Steve Haneman wrote:
Hello,

I was looking over the release notes for &quot;Release: RabbitMQ 2.0.0&quot; and saw the following:

<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-announce/attachments/20100825/2c672695/attachment.txt">http://lists.rabbitmq.com/pipermail/rabbitmq-announce/attachments/20100825/2c672695/attachment.txt</A>

Upgrading
=========
The database schema and the format in which persistent messages are
stored have both changed since the last release (1.8.1). When
starting, the RabbitMQ server will detect the existence of an old
database and will move it to a backup location, before creating a
fresh, empty database, and will log a warning. If your RabbitMQ
installation contains important data then we recommend you contact
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">support at ...</A> for assistance with the upgrade.

We are considering deploying a HA RabbitMQ cluster with Pacemaker and DRBD.  HA is very important for us.
If there is a database schema change in the future, specifically what is the process for the upgrade and how does it affect HA during the upgrade?
Also during the upgrade, how do we maintain durable exchanges and queues?

Thanks,
   Steve





_______________________________________________

rabbitmq-discuss mailing list

<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;

<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100921/e512165c/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20100921/e512165c/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008948.html">[rabbitmq-discuss] HA and database schema changes
</A></li>
	<LI>Next message: <A HREF="009037.html">[rabbitmq-discuss] HA and database schema changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9025">[ date ]</a>
              <a href="thread.html#9025">[ thread ]</a>
              <a href="subject.html#9025">[ subject ]</a>
              <a href="author.html#9025">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
