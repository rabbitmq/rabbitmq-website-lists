<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Generally known configuration for open file descriptor limits
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Generally%20known%20configuration%20for%20open%20file%0A%20descriptor%20limits&In-Reply-To=%3CAANLkTikWa4-tWvSHJWvjtybB5Hv8W9W4hvt6MO00J6j%3D%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009021.html">
   <LINK REL="Next"  HREF="009024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Generally known configuration for open file descriptor limits</H1>
    <B>Marek Majkowski</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Generally%20known%20configuration%20for%20open%20file%0A%20descriptor%20limits&In-Reply-To=%3CAANLkTikWa4-tWvSHJWvjtybB5Hv8W9W4hvt6MO00J6j%3D%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Generally known configuration for open file descriptor limits">majek04 at gmail.com
       </A><BR>
    <I>Tue Sep 21 15:50:37 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009021.html">[rabbitmq-discuss] Generally known configuration for open file	descriptor limits
</A></li>
        <LI>Next message: <A HREF="009024.html">[rabbitmq-discuss] Generally known configuration for open file descriptor limits
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9023">[ date ]</a>
              <a href="thread.html#9023">[ thread ]</a>
              <a href="subject.html#9023">[ subject ]</a>
              <a href="author.html#9023">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dave,

You definitely need more file descriptors than number of connections.

As a rule of thumb I'd suggest:
 - 1 file descriptor for every connection
 - 3+ file descriptors for every queue that might be written to disk
 - reserve about 100 descriptors for internal erlang stuff

There isn't any penalty from setting high 'ulimit -n', so why not just
set it to maximum?

On linux:
cat /proc/sys/fs/file-max
ulimit -n 1048576

On Tue, Sep 21, 2010 at 13:42, Dave Greggory &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">davegreggory at yahoo.com</A>&gt; wrote:
&gt;<i> What do you recommend setting the system wide and rabbitmq user's hard and soft limits for open file descriptors?
</I>&gt;<i>
</I>&gt;<i> This is on a production RabbitMQ cluster (2 disk nodes). We currently have about 100 connections to the cluster (not necessarily balanced between nodes). Machines have 2.5 gb and RabbitMQ allocated about 993 MB for itself. Since the cluster is very low volume currently the a Rabbit node's memory usage stays around 30-50 MB. Consumers are pretty fast so there's hardly any messages waiting in queues.
</I>&gt;<i>
</I>&gt;<i> Rabbitmq user has the default hard/soft limit of 1024 currently. Given the above environment and adding a quite a bit of room to spare, what is a generally acceptable limit?
</I>&gt;<i>
</I>&gt;<i> Over the next 6 months to an year this will become a very high volume environment with lot of messages waiting in queues and probably over 1000 connections. When we scale up, what should watch for as an indication that we need to increase open file descriptor limits?
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I></PRE>














































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009021.html">[rabbitmq-discuss] Generally known configuration for open file	descriptor limits
</A></li>
	<LI>Next message: <A HREF="009024.html">[rabbitmq-discuss] Generally known configuration for open file descriptor limits
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9023">[ date ]</a>
              <a href="thread.html#9023">[ thread ]</a>
              <a href="subject.html#9023">[ subject ]</a>
              <a href="author.html#9023">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
