<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] gen_server2 ques. and was: Re: clarifying plugin supervision, configuration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20gen_server2%20ques.%20and%20was%3A%20Re%3A%20clarifying%0A%20plugin%20supervision%2C%20configuration&In-Reply-To=%3C20100907150241.GA25578%40wellquite.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008762.html">
   <LINK REL="Next"  HREF="008761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] gen_server2 ques. and was: Re: clarifying plugin supervision, configuration</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20gen_server2%20ques.%20and%20was%3A%20Re%3A%20clarifying%0A%20plugin%20supervision%2C%20configuration&In-Reply-To=%3C20100907150241.GA25578%40wellquite.org%3E"
       TITLE="[rabbitmq-discuss] gen_server2 ques. and was: Re: clarifying plugin supervision, configuration">matthew at rabbitmq.com
       </A><BR>
    <I>Tue Sep  7 16:02:42 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="008762.html">[rabbitmq-discuss] gen_server2 ques. and was: Re: clarifying	plugin supervision, configuration
</A></li>
        <LI>Next message: <A HREF="008761.html">[rabbitmq-discuss] Active/active HA setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8828">[ date ]</a>
              <a href="thread.html#8828">[ thread ]</a>
              <a href="subject.html#8828">[ subject ]</a>
              <a href="author.html#8828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon,

On Thu, Sep 02, 2010 at 10:13:20AM -0500, Jon Brisbin wrote:
&gt;<i> &gt; Best explained by reading the comments at the top of the gen_server2
</I>&gt;<i> &gt; module.
</I>&gt;<i> 
</I>&gt;<i> Sure. Did that. But I'm wondering (out loud ;) if some of the
</I>&gt;<i> situations described there (ordered delivery, hibernate etc...)
</I>&gt;<i> wouldn't nicely fit what the webhooks plugin is doing. It will sit for
</I>&gt;<i> periods of time with little activity and it would be nice to have that
</I>&gt;<i> hibernation (though I don't know that I could take full advantage of
</I>&gt;<i> it). I'm just not sure that spending time trying to use those features
</I>&gt;<i> would really buy that much. I was wondering if there's a rule of thumb
</I>&gt;<i> that's been discovered here that your situation should hit X number of
</I>&gt;<i> messages or it should be doing Y before you really need to worry about
</I>&gt;<i> using gen_server2? I'm not terribly afraid of being tied to an
</I>&gt;<i> internal API because it'll likely stay a plugin for the foreseeable
</I>&gt;<i> future.
</I>
There is no especial rule of thumb there. We tend to use gen_server2
when any of the following are met:

a) we need message priorities
b) we know that this process is going to need to make calls to other
processes whilst its mailbox is massive
c) we want the process to hibernate, but we also know that it might be
woken up fairly frequently and we don't want it to burn huge amounts of
CPU endlessly hibernating and waking up

Point (b) is now irrelevant if you're using a modern erlang - I think
they fixed that in either R13B04 or R14A - check the release notes.

Point (c) is really the motivation behind the backoff stuff - we noticed
that if you had lots of idle queues, and were doing a &quot;watch rabbitmqctl
list_queues&quot; you could max out your CPU because every queue was
hibernating and then waking up.

Matthew

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008762.html">[rabbitmq-discuss] gen_server2 ques. and was: Re: clarifying	plugin supervision, configuration
</A></li>
	<LI>Next message: <A HREF="008761.html">[rabbitmq-discuss] Active/active HA setup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8828">[ date ]</a>
              <a href="thread.html#8828">[ thread ]</a>
              <a href="subject.html#8828">[ subject ]</a>
              <a href="author.html#8828">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
