<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] number of Erlang processes being used?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20number%20of%20Erlang%20processes%20being%20used%3F&In-Reply-To=%3CD14F65F7-757B-4095-B1CB-6D173A5EE774%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009074.html">
   <LINK REL="Next"  HREF="009075.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] number of Erlang processes being used?</H1>
    <B>Alvaro Videla</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20number%20of%20Erlang%20processes%20being%20used%3F&In-Reply-To=%3CD14F65F7-757B-4095-B1CB-6D173A5EE774%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] number of Erlang processes being used?">videlalvaro at gmail.com
       </A><BR>
    <I>Fri Sep 24 12:59:42 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009074.html">[rabbitmq-discuss] number of Erlang processes being used?
</A></li>
        <LI>Next message: <A HREF="009075.html">[rabbitmq-discuss] multiple threads in one queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9076">[ date ]</a>
              <a href="thread.html#9076">[ thread ]</a>
              <a href="subject.html#9076">[ subject ]</a>
              <a href="author.html#9076">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

In prod we are using a script like this: <A HREF="http://gist.github.com/595243">http://gist.github.com/595243</A> to find the number of Erlang processes and then we send that to Graphite to keep some nice graphs about it.

We had the same problem as you, running out of Erlang processes. That happened because our client library was creating one channel per message sent, that meant one new process on the Erlang side AFAIK. We gave the channels specific IDs and the problem got solved.

Regards,

Alvaro

On Sep 24, 2010, at 7:33 PM, Mario Menti wrote:

&gt;<i> Matthew Sackman wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Fri, Sep 24, 2010 at 12:07:13PM +0100, Mario Menti wrote:
</I>&gt;&gt;&gt;<i> Is there a way to see the number of lightweight Erlang processes
</I>&gt;&gt;&gt;<i> currently in use by rabbitmq? We regularly run out of them, even
</I>&gt;&gt;&gt;<i> with a higher-than-default number being specified (65535), and while
</I>&gt;&gt;&gt;<i> I realise that there may be an underlying issue, it would still be
</I>&gt;&gt;&gt;<i> very useful to monitor the usage.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> No - there's no way of figuring this out other than the total number of
</I>&gt;&gt;<i> processes being used in the erlang VM. Thus if you're using other
</I>&gt;&gt;<i> applications within the same VM, you won't be able to separate them out.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> length(erlang:processes()).
</I>&gt;&gt;<i>  will tell you the total number of processes running in the VM.
</I>&gt;<i> Thanks - there's nothing else running in the VM, so this should be good enough.
</I>&gt;&gt;<i> Btw, you're not helping yourselves by running such an old version - we
</I>&gt;&gt;<i> pushed the default limit up to 1e6 around 1.8. You shouldn't have many
</I>&gt;&gt;<i> concerns with raising your limit substantially further (though it will
</I>&gt;&gt;<i> mean the VM will take up a bit more memory which might be relevant if
</I>&gt;&gt;<i> you're running in an embedded environment). The absolute maximum is 16bn
</I>&gt;&gt;<i> but if you use that I think I found the base VM on its own takes up some
</I>&gt;&gt;<i> 400MB after booting (just due to the various arrays and bookkeeping
</I>&gt;&gt;<i> needed for every process). Given your 24GB of RAM, I would think that
</I>&gt;&gt;<i> you're not in an embedded enviroment and such paltry amounts of memory
</I>&gt;&gt;<i> are not a concern!
</I>&gt;<i> 
</I>&gt;<i> Yes, these are dedicated servers. Thanks for the additional info - updating to latest/later versions of rabbitmq is pretty high somewhere on our Todo list :)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>







































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009074.html">[rabbitmq-discuss] number of Erlang processes being used?
</A></li>
	<LI>Next message: <A HREF="009075.html">[rabbitmq-discuss] multiple threads in one queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9076">[ date ]</a>
              <a href="thread.html#9076">[ thread ]</a>
              <a href="subject.html#9076">[ subject ]</a>
              <a href="author.html#9076">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
