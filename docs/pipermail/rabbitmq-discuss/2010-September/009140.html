<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Erlang has closed?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Erlang%20has%20closed%3F&In-Reply-To=%3C29827331.post%40talk.nabble.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009154.html">
   <LINK REL="Next"  HREF="009141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Erlang has closed?</H1>
    <B>Brian_Fox</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Erlang%20has%20closed%3F&In-Reply-To=%3C29827331.post%40talk.nabble.com%3E"
       TITLE="[rabbitmq-discuss] Erlang has closed?">genkuro at gmail.com
       </A><BR>
    <I>Tue Sep 28 16:42:10 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="009154.html">[rabbitmq-discuss] Uncaught exception 'AMQPConnectionException' with message 'Parameter 'host' exceeds 32 characters limit
</A></li>
        <LI>Next message: <A HREF="009141.html">[rabbitmq-discuss] Erlang has closed?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9140">[ date ]</a>
              <a href="thread.html#9140">[ thread ]</a>
              <a href="subject.html#9140">[ subject ]</a>
              <a href="author.html#9140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>


Matthew Sackman wrote:
&gt;<i> 
</I>&gt;<i> On Wed, May 19, 2010 at 11:06:23AM -0400, Tyler Williams wrote:
</I>&gt;&gt;<i> =INFO REPORT==== 17-May-2010::14:24:30 ===
</I>&gt;&gt;<i>     application: rabbit
</I>&gt;&gt;<i>     exited: {{timeout_waiting_for_tables,[rabbit_disk_queue]},
</I>&gt;&gt;<i>              {rabbit,start,[normal,[]]}}
</I>&gt;&gt;<i>     type: temporary
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> =ERROR REPORT==== 17-May-2010::14:24:30 ===
</I>&gt;&gt;<i> Error in process &lt;0.100.0&gt; on node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at echonest03</A>' with exit
</I>&gt;&gt;<i> value:
</I>&gt;&gt;<i> {badarg,[{ets,insert,[rabbit_disk_queue,[{dq_msg_loc,{{resource,&lt;&lt;1
</I>&gt;&gt;<i> byte&gt;&gt;,queue,&lt;&lt;9 bytes&gt;&gt;},553567},false,true,&lt;&lt;16
</I>&gt;&gt;<i> bytes&gt;&gt;},{dq_msg_loc,{{resource,&lt;&lt;1 byte&gt;&gt;,queue,&lt;&lt;18
</I>&gt;&gt;<i> bytes&gt;&gt;},563611},false,true,&lt;&lt;16 bytes&gt;&gt;},{dq_msg_loc,{{resource,&lt;&lt;1
</I>&gt;&gt;<i> byte&gt;&gt;,queue,&lt;&lt;18 bytes&gt;&gt;},80964},false,true,&lt;&lt;16
</I>&gt;&gt;<i> bytes&gt;&gt;},{dq_msg_loc,{{resource,&lt;&lt;1 byte&gt;&gt;,queue...
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> =INFO REPORT==== 17-May-2010::14:24:33 ===
</I>&gt;&gt;<i>     application: mnesia
</I>&gt;&gt;<i>     exited: stopped
</I>&gt;&gt;<i>     type: temporary
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> =INFO REPORT==== 17-May-2010::14:24:33 ===
</I>&gt;&gt;<i>     application: os_mon
</I>&gt;&gt;<i>     exited: stopped
</I>&gt;&gt;<i>     type: temporary
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Can you shed any light on this error?
</I>&gt;<i> 
</I>&gt;<i> I might have been able to last October when I was writing that code. So
</I>&gt;<i> much has changed since then that I really can't remember too much about
</I>&gt;<i> what was going on back then.
</I>&gt;<i> 
</I>&gt;<i> Also, pyamqplib does not support channel.flow. Even with the new
</I>&gt;<i> persister, there are times where rabbit gets overwhelmed (disks just
</I>&gt;<i> aren't fast enough most of the time) and so needs to temporarily stop
</I>&gt;<i> publishers. It does this by using channel.flow. Given that pyamqplib
</I>&gt;<i> doesn't support channel.flow, you are very likely to run into problems.
</I>&gt;<i> There's a highly experimental patch by Tony (search the mailing list for
</I>&gt;<i> it) which adds support for channel.flow, but you might also try looking
</I>&gt;<i> at the other python clients such as txamqp and pika.
</I>&gt;<i> 
</I>&gt;<i> Matthew
</I>&gt;<i> 
</I>
(Sorry to resurrect an older thread)

Has this rabbitmq + pyamqplib problem ever been resolved?  

Our group is experimenting with bringing up a massive amount of AMQP clients
using EC2.  And we're running into the same error described above,
presumably slamming memory on the broker.  It seems like we have a few
choices: bump up the memory (8GB currently), choose a different library with
flow control, or choose a different strategy to rapidly boot several hundred
clients.  Of the three, the last would be the least attractive option.

Any suggestions on the best alternative lib to avoid this error?  I'm
hearing mixed things about txAMQP's support of channel flow.  

Would clustering help the issue or make it worse?  (we're currently a single
broker on a development platform)

Thanks much,
Brian  
-- 
View this message in context: <A HREF="http://old.nabble.com/Erlang-has-closed--tp28600093p29827331.html">http://old.nabble.com/Erlang-has-closed--tp28600093p29827331.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.

</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009154.html">[rabbitmq-discuss] Uncaught exception 'AMQPConnectionException' with message 'Parameter 'host' exceeds 32 characters limit
</A></li>
	<LI>Next message: <A HREF="009141.html">[rabbitmq-discuss] Erlang has closed?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9140">[ date ]</a>
              <a href="thread.html#9140">[ thread ]</a>
              <a href="subject.html#9140">[ subject ]</a>
              <a href="author.html#9140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
