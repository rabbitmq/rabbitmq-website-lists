<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] how to send a message including a array via .net client?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20how%20to%20send%20a%20message%20including%20a%20array%20via%0A%20.net%20client%3F&In-Reply-To=%3CAANLkTikcextxUGfKv_-ZAaqtEG70DC4S4s%3DTVa3UJJAY%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010532.html">
   <LINK REL="Next"  HREF="010534.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] how to send a message including a array via .net client?</H1>
    <B>Steven Taylor</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20how%20to%20send%20a%20message%20including%20a%20array%20via%0A%20.net%20client%3F&In-Reply-To=%3CAANLkTikcextxUGfKv_-ZAaqtEG70DC4S4s%3DTVa3UJJAY%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] how to send a message including a array via .net client?">taylste at gmail.com
       </A><BR>
    <I>Tue Jan  4 10:22:47 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010532.html">[rabbitmq-discuss] how to send a message including a array via .net client?
</A></li>
        <LI>Next message: <A HREF="010534.html">[rabbitmq-discuss] how to send a message including a array via	.net client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10533">[ date ]</a>
              <a href="thread.html#10533">[ thread ]</a>
              <a href="subject.html#10533">[ subject ]</a>
              <a href="author.html#10533">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chen,

I like binary serialization at the moment.

<A HREF="http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatter.aspx">http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatter.aspx</A>

In future I'd like to use binary Json, and there's also google protobuffers
which look pretty good (not sure on how good the .net support is though).
Json is certainly better IMHO than XML. The binary / cross-platform binary
options are more suited to my purposes.

Under .net Json / Binary / Soap serialization works just about the same way.

<A HREF="http://pietschsoft.com/post/2008/02/NET-35-JSON-Serialization-using-the-DataContractJsonSerializer.aspx">http://pietschsoft.com/post/2008/02/NET-35-JSON-Serialization-using-the-DataContractJsonSerializer.aspx</A>

Start off serializing / deserializing an object with one property. Get that
going and you'll find it's the same set of steps for anything that inherits
from &quot;object&quot; (includes arrays).  Tag it up / decorate it correctly, and job
done.  Step two, see if Rabbit handles it faithfully (it does for me).

cheers,
-Steven
On 4 January 2011 08:27, Chen Houwu &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">chenhouwu at gmail.com</A>&gt; wrote:

&gt;<i> Do you mean that .net client has no build-in support for simple data
</I>&gt;<i> structure?
</I>&gt;<i> But I have found it should support according to the AMQP 1.0
</I>&gt;<i> specification.
</I>&gt;<i> AMQP is a binary protocol, but json is text.
</I>&gt;<i> Though I can send binary content after encoding it to BASE64, it is
</I>&gt;<i> too inefficient.
</I>&gt;<i>
</I>&gt;<i> It seams as if the python client support array and dictionary
</I>&gt;<i> object.....
</I>&gt;<i>
</I>&gt;<i> On 2010&#24180;12&#26376;29&#26085;, &#19979;&#21320;6&#26102;47&#20998;, Marek Majkowski &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">maje... at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I think you should be using some standardized encoding,
</I>&gt;<i> &gt; like for example json.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Take a look at this library:
</I>&gt;<i> <A HREF="http://james.newtonking.com/pages/json-net.aspxhttp://stackoverflow.com/questions/571168/what-json-library-works-wel.">http://james.newtonking.com/pages/json-net.aspxhttp://stackoverflow.com/questions/571168/what-json-library-works-wel.</A>
</I>&gt;<i> ..
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Cheers,
</I>&gt;<i> &gt;   Marek
</I>&gt;<i>  &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Mon, Dec 27, 2010 at 11:22, Chen Houwu &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">chenho... at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt;   I am a newbie to rabbitmq, I want to send a message object as
</I>&gt;<i> &gt; &gt; following via .net client:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;   public class Message
</I>&gt;<i> &gt; &gt;    {
</I>&gt;<i> &gt; &gt;        public int ID { get; set; }
</I>&gt;<i> &gt; &gt;        public string Name { get; set; }
</I>&gt;<i> &gt; &gt;        public byte[] Binary { get; set; }
</I>&gt;<i> &gt; &gt;        public string[] Infos{get;set;}
</I>&gt;<i> &gt; &gt;        public Dictionary&lt;string,int&gt; CountMap { get; set; }
</I>&gt;<i> &gt; &gt;    }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Here is my code:
</I>&gt;<i> &gt; &gt; -------------------------------------------
</I>&gt;<i> &gt; &gt; var builder = new
</I>&gt;<i> &gt; &gt; RabbitMQ.Client.Content.StreamMessageBuilder(_channel);
</I>&gt;<i> &gt; &gt; builder.writeObject(msg.ID);
</I>&gt;<i> &gt; &gt; builder.writeObject(msg.Name);
</I>&gt;<i> &gt; &gt; /*----------How to deal with msg.Infos and CountMap here?------------/
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; /*shoud it be written by myself such as: */
</I>&gt;<i> &gt; &gt; builder.writeObject(infos.count)
</I>&gt;<i> &gt; &gt; foreach(var info in infos)
</I>&gt;<i> &gt; &gt; {
</I>&gt;<i> &gt; &gt;   builder.writerObject(info)
</I>&gt;<i> &gt; &gt; }
</I>&gt;<i> &gt; &gt; /* or the suporting to array and dictionary already exists?*/
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; /* I have found in&quot;src/client/impl/WireFormatting.cs&quot;&#65292; there are
</I>&gt;<i> &gt; &gt; methods like &quot;WriteArray&quot;, and &quot;WriteTable&quot;*/
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;  IBasicProperties props = _channel.CreateBasicProperties();
</I>&gt;<i> &gt; &gt; props.DeliveryMode = 2;
</I>&gt;<i> &gt; &gt;  _channel.BasicPublish(_exchangeName, &quot;some key&quot;, props,
</I>&gt;<i> &gt; &gt; builder.GetContentBody());
</I>&gt;<i> &gt; &gt; -----------------
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; &gt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://
</I>&gt;<i> lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I>&gt;<i>  _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110104/8245a5f2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110104/8245a5f2/attachment.htm</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010532.html">[rabbitmq-discuss] how to send a message including a array via .net client?
</A></li>
	<LI>Next message: <A HREF="010534.html">[rabbitmq-discuss] how to send a message including a array via	.net client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10533">[ date ]</a>
              <a href="thread.html#10533">[ thread ]</a>
              <a href="subject.html#10533">[ subject ]</a>
              <a href="author.html#10533">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
