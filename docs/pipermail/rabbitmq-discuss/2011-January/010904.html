<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Low message publish throughput
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Low%20message%20publish%20throughput&In-Reply-To=%3C4D40074B.1020608%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010894.html">
   <LINK REL="Next"  HREF="010906.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Low message publish throughput</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Low%20message%20publish%20throughput&In-Reply-To=%3C4D40074B.1020608%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Low message publish throughput">emile at rabbitmq.com
       </A><BR>
    <I>Wed Jan 26 11:36:43 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010894.html">[rabbitmq-discuss] Low message publish throughput
</A></li>
        <LI>Next message: <A HREF="010906.html">[rabbitmq-discuss] Low message publish throughput
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10904">[ date ]</a>
              <a href="thread.html#10904">[ thread ]</a>
              <a href="subject.html#10904">[ subject ]</a>
              <a href="author.html#10904">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Cameron,

On 25/01/11 14:42, Cameron Harris wrote:

&gt;<i> I attached a profiler to my publisher and I found that more than 90% of
</I>&gt;<i> the CPU time was spent calling Flush in WriteFrame (called by
</I>&gt;<i> BasicPublish). I created an alternate non-flushing code path in the
</I>&gt;<i> RabbitMQ for BasicPublish, and the publishing speed went up to between
</I>&gt;<i> 35 000 and 45 000 messages per second, and the messages still got to the
</I>&gt;<i> client quickly.
</I>
I would advise caution when removing the flush. Synchronous methods 
during AMQP connection establishment can timeout and cause failure 
unless the stream is flushed.

I'd be interested to know whether disabling the socket nodelay option 
has any impact on your test. This would be another way of obtaining a 
different latency/throughput trade-off.


Regards

Emile

</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010894.html">[rabbitmq-discuss] Low message publish throughput
</A></li>
	<LI>Next message: <A HREF="010906.html">[rabbitmq-discuss] Low message publish throughput
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10904">[ date ]</a>
              <a href="thread.html#10904">[ thread ]</a>
              <a href="subject.html#10904">[ subject ]</a>
              <a href="author.html#10904">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
