<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] HA between data centers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20between%20data%20centers&In-Reply-To=%3C20110114162024.GF18402%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010634.html">
   <LINK REL="Next"  HREF="010700.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] HA between data centers</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20between%20data%20centers&In-Reply-To=%3C20110114162024.GF18402%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] HA between data centers">matthew at rabbitmq.com
       </A><BR>
    <I>Fri Jan 14 16:20:24 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010634.html">[rabbitmq-discuss] HA between data centers
</A></li>
        <LI>Next message: <A HREF="010700.html">[rabbitmq-discuss] HA between data centers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10691">[ date ]</a>
              <a href="thread.html#10691">[ thread ]</a>
              <a href="subject.html#10691">[ subject ]</a>
              <a href="author.html#10691">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Bill,

On Tue, Jan 11, 2011 at 07:57:19PM -0800, Bill Moseley wrote:
&gt;<i> The High Availablity docs at <A HREF="http://www.rabbitmq.com/pacemaker.html">http://www.rabbitmq.com/pacemaker.html</A> seem
</I>&gt;<i> pretty thorough.  Are there any other approaches commonly used for HA? What
</I>&gt;<i> about for syncing between data centers? Can anyone discuss their HA approach
</I>&gt;<i> if it differs from the link above?
</I>
There are a couple of other things to mention. One is that work is
currently been done on active/active HA, but that will provide
&quot;mirrored&quot; queues (think RAID-1) within a cluster only. The other thing
to mention is the shovel plugin, which can be used for a very
rudimentary form of federation between different brokers. The main
limitation with the shovel though is that its configuration can't be
dynamically changed, so it's only really a sensible solution if you're
topology is mainly static.

&gt;<i> We are evaluating messaging systems and the question of HA has come up
</I>&gt;<i> frequently.  The concern is that some items, once entered onto the queue,
</I>&gt;<i> should never be lost -- even if the entire data center goes down.
</I>
Right, but is that &quot;lost&quot; as in &quot;provided it's stored on disk, that's
ok, even if it takes us a month to get the data back off disk&quot;, or is it
&quot;lost&quot; as it &quot;must always be (near) instantly available&quot;?

&gt;<i> We are comparing RabbitMQ with writing a system in-house.  The in-house
</I>&gt;<i> queue system would use a Postgresql table for the queue with replication
</I>&gt;<i> (currently via Slony) for hot-backup (it's not really HA).  We also
</I>&gt;<i> replicate to a secondary data center with the eventual goal of reasonably
</I>&gt;<i> fast tip-over between data centers.  We are not in the financial or medical
</I>&gt;<i> industry so nobody's life is at risk if we drop a few jobs.  I suspect we
</I>&gt;<i> only need to handle three to five million message a day -- nothing too big.
</I>&gt;<i>  (Oddly, one argument against using RabbitMQ was it was overkill for our
</I>&gt;<i> needs.)
</I>
Yeah, rather obviously, we're somewhat biased against building message
brokers on top of databases ;) I guess the things I'd suggest you look
as is whilst you may be fine with postgres at the moment, what happens
in a couple of years time? What will your messaging requirements be
then, and will you have sufficient flexibility in your home-grown system
to be able to cope with those needs?

&gt;<i> Postgresql and replication is what we use for application data currently, so
</I>&gt;<i> it is a familiar technology for us.  Another reason we are considering
</I>&gt;<i> building a custom message queue system is to put more functionality into the
</I>&gt;<i> broker -- such as scheduling and job routing that would be specific to our
</I>&gt;<i> business.  And there's fear that nobody knows Erlang if something broke and
</I>&gt;<i> we needed to try and resolve.
</I>
Sure, those are valid concerns. There are ways of extending the
functionality of Rabbit, for example through exchange types, or even
custom plugins, but these do normally require writing in Erlang.

&gt;<i> My opinion is AMQP is very flexible and we should be able to make it meet
</I>&gt;<i> our needs.  We are not doing anything that unusual.  And I suspect building
</I>&gt;<i> something as reliable as RabbitMQ is no easy task -- especially if the point
</I>&gt;<i> is to make a system more complex than what RabbitMQ provides.  Scheduling,
</I>&gt;<i> for example, seems like something a simple database table and cron could
</I>&gt;<i> solve easily with RabbitMQ.
</I>
Indeed - use the right tool for the job etc. Job scheduling and such are
probably on the boundary of what we consider pure messaging, and so it
does normally require additional client-side applications to add to
Rabbit to provide such functionality. You might like to look at celery
in this space which does job scheduling on top of Rabbit.

&gt;<i> Another argument for a custom broker was to make better use of workers --
</I>&gt;<i> i.e. the broker would look at load and other factors when determining where
</I>&gt;<i> to send jobs.  My feeling here is resources are limited so it's a matter of
</I>&gt;<i> balancing the number and type of consumers with queue load -- and an
</I>&gt;<i> external process can manage starting and stopping consumers easily as demand
</I>&gt;<i> profile changes (by looking at queue sizes and rates) without having to be
</I>&gt;<i> part of the broker.  Are there common approaches for dynamically adjusting
</I>&gt;<i> workers?
</I>
I suspect that's something that falls squarely in the remit of tools
like celery. It's definitely outside the scope of Rabbit itself.

Matthew
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010634.html">[rabbitmq-discuss] HA between data centers
</A></li>
	<LI>Next message: <A HREF="010700.html">[rabbitmq-discuss] HA between data centers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10691">[ date ]</a>
              <a href="thread.html#10691">[ thread ]</a>
              <a href="subject.html#10691">[ subject ]</a>
              <a href="author.html#10691">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
