<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Are queues replicated across a cluster?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Are%20queues%20replicated%20across%20a%20cluster%3F&In-Reply-To=%3CAANLkTik6DTYcEVy%2BMtiaQ7k397zkCepeRb1TG8%2Br0snR%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010771.html">
   <LINK REL="Next"  HREF="010695.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Are queues replicated across a cluster?</H1>
    <B>Bill Moseley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Are%20queues%20replicated%20across%20a%20cluster%3F&In-Reply-To=%3CAANLkTik6DTYcEVy%2BMtiaQ7k397zkCepeRb1TG8%2Br0snR%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Are queues replicated across a cluster?">moseley at hank.org
       </A><BR>
    <I>Thu Jan 13 14:42:19 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010771.html">[rabbitmq-discuss] Unable to get automatic clustering to work
</A></li>
        <LI>Next message: <A HREF="010695.html">[rabbitmq-discuss] Are queues replicated across a cluster?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10660">[ date ]</a>
              <a href="thread.html#10660">[ thread ]</a>
              <a href="subject.html#10660">[ subject ]</a>
              <a href="author.html#10660">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://www.rabbitmq.com/clustering.html">http://www.rabbitmq.com/clustering.html</A> says:

All data/state required for the operation of a RabbitMQ broker is replicated
&gt;<i> across all nodes, for reliability and scaling, with full ACID properties. An
</I>&gt;<i> exception to this are message queues, which currently only reside on the
</I>&gt;<i> node that created them, though they are visible and reachable from all
</I>&gt;<i> nodes. Future releases of RabbitMQ will introduce migration and replication
</I>&gt;<i> of message queues.
</I>

I don't understand that sentence that says the queues only reside on the
node that created them -- but they are visible on both.  Is that talking
about replicating *messages* or queues?  Queues and messages are separate
things.  I understand that messages are not duplicated/replicated in the
cluster.

I have two nodes in a cluster node1 and node2 (on same server, different
ports).  I declare an exchange, queue, and binding on node1 only.  Next, I
start consumers on node1 and node2 -- these do not declare the queue, they
only consume.  This succeeds so therefore the queue is accessible from both
node1 and node2.

Next I connect to node1 and send two messages to the queue.  One message
ends up with the consumer on node1 and the consumer on node2 receives the
other message.

What's the distinction between &quot;residing&quot; and &quot;visible&quot;?  Does it mean the
messages are only stored on node1 until consumed (by either node)?  But, I
can declare the same queue on both nodes and see the same behavior.  Can
someone please clear this up for me?


What I have failed to find when reading about clustering is how to connect
to the nodes in a cluster.  If I have node1 and node2 in my cluster and 10
producers (say web servers) and 4 worker machines do I configure 5 producers
to connect to node1 and 5 to node2, and then likewise split the consumer
connections across the two nodes?

To be clear, this is not HA.  So, if node1 fails then 1/2 the producers and
1/2 the consumers can no longer function.  Correct?


Or is the typical approach to use something like HAProxy in front of node1
and node2 and have all consumers and producers connect to HAProxy?  (That
ends up as a single point of failure.)



-- 
Bill Moseley
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">moseley at hank.org</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110113/c118e4f0/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110113/c118e4f0/attachment-0001.htm</A>&gt;
</PRE>






























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010771.html">[rabbitmq-discuss] Unable to get automatic clustering to work
</A></li>
	<LI>Next message: <A HREF="010695.html">[rabbitmq-discuss] Are queues replicated across a cluster?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10660">[ date ]</a>
              <a href="thread.html#10660">[ thread ]</a>
              <a href="subject.html#10660">[ subject ]</a>
              <a href="author.html#10660">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
