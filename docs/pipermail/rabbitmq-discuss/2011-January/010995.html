<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Slow consumer disconnect availability on RAbbitMQ
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Slow%20consumer%20disconnect%20availability%20on%0A%20RAbbitMQ&In-Reply-To=%3C20110131153049.GC16743%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010927.html">
   <LINK REL="Next"  HREF="010928.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Slow consumer disconnect availability on RAbbitMQ</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Slow%20consumer%20disconnect%20availability%20on%0A%20RAbbitMQ&In-Reply-To=%3C20110131153049.GC16743%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Slow consumer disconnect availability on RAbbitMQ">matthew at rabbitmq.com
       </A><BR>
    <I>Mon Jan 31 15:30:49 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010927.html">[rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ
</A></li>
        <LI>Next message: <A HREF="010928.html">[rabbitmq-discuss] Headers Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10995">[ date ]</a>
              <a href="thread.html#10995">[ thread ]</a>
              <a href="subject.html#10995">[ subject ]</a>
              <a href="author.html#10995">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Prashant,

On Thu, Jan 27, 2011 at 05:15:50AM +0530, Prashant Yadav wrote:
&gt;<i> Actually we do have a requirement where I want consumer to stop getting message once I know that its slow( my consumption logic connects to remote server and if server is not responding or is slow for any reason I dont want my queue to get clogged), I would want to stop queue from populating.
</I>
Why?

In general, it seems to me that slow consumer detection is solving the
problem the wrong way.

Rabbit and message brokers in general are there to decouple components.
Rabbit is pretty good these days at coping with receiving messages
faster than they're being sent out, buffering messages in RAM and on
disk and generally absorbing such pressure.

It seems odd to me that because you have pressure downstream (slow
responding server) you want to address that upstream by throwing away
the queue and its messages. If your messages are of transient value then
I'd have thought that the per-queue message TTL would be ideal: that
will silently drop messages from the queue once they have resided in the
queue for more than the specified time.

&gt;<i> The catch here is , I too dont want to purge all the messages or drop it . I too tried to use TTL and queue lease , but am not sure about messages resisding in the queue i.e whether they are requed or silently dropped( in my case I want them to by returned back to exchange and make the queue alive after some duration)
</I>
What you seem to be asking for is that the broker buffers
(store+forward) messages whenever things are going fine, but that once
the consumer starts going slowly, the back pressure is passed all the
way back up to the producer. This negates one of the key purposes of the
broker - if you want this level of direct connection between the
producer and consumer then why not connect them directly together - why
are you using RabbitMQ at all in the middle?

You may also like to look at the &quot;immediate&quot; flag on basic.publish which
might do what you want.

Best wishes,

Matthew
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010927.html">[rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ
</A></li>
	<LI>Next message: <A HREF="010928.html">[rabbitmq-discuss] Headers Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10995">[ date ]</a>
              <a href="thread.html#10995">[ thread ]</a>
              <a href="subject.html#10995">[ subject ]</a>
              <a href="author.html#10995">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
