<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Strange RabbitMQ management plugin error!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Strange%20RabbitMQ%20management%20plugin%20error%21&In-Reply-To=%3CAANLkTi%3DAqzaHFpHZmVnVhuxU%2BkQr%3Di7-2r4QUb%2B4MfOg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010613.html">
   <LINK REL="Next"  HREF="010640.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Strange RabbitMQ management plugin error!</H1>
    <B>Ciprian Dorin Craciun</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Strange%20RabbitMQ%20management%20plugin%20error%21&In-Reply-To=%3CAANLkTi%3DAqzaHFpHZmVnVhuxU%2BkQr%3Di7-2r4QUb%2B4MfOg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Strange RabbitMQ management plugin error!">ciprian.craciun at gmail.com
       </A><BR>
    <I>Tue Jan 11 18:48:02 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010613.html">[rabbitmq-discuss] Strange RabbitMQ management plugin error!
</A></li>
        <LI>Next message: <A HREF="010640.html">[rabbitmq-discuss] Strange RabbitMQ management plugin error!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10631">[ date ]</a>
              <a href="thread.html#10631">[ thread ]</a>
              <a href="subject.html#10631">[ subject ]</a>
              <a href="author.html#10631">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Jan 11, 2011 at 12:34, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:
&gt;<i> On 10/01/11 22:30, Ciprian Dorin Craciun wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; Hello all!
</I>&gt;<i>
</I>&gt;<i> Hi Ciprian.
</I>&gt;<i>
</I>&gt;&gt;<i> &#160; &#160;I've installed the management plugin (and it's dependencies), and
</I>&gt;&gt;<i> when accessing it I get the following error on almost all pages and I
</I>&gt;&gt;<i> don't see any counters... (But it seems to work otherwise as I can see
</I>&gt;&gt;<i> and manipulate other entities: queues, exchanges, etc.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ~~~~
</I>&gt;&gt;<i> TypeError: overview.queue_totals is undefined
</I>&gt;&gt;<i> ~~~~
</I>&gt;<i>
</I>&gt;<i> Thanks for explaining the unusual way you're starting RabbitMQ. That is
</I>&gt;<i> likely to be the problem.
</I>
    It seems that indeed this is the problem...


&gt;<i> The management plugin uses a feature (fine grained statistics) that it needs
</I>&gt;<i> to turn on in the main rabbit application. It sounds like this is not
</I>&gt;<i> happening. This is controlled via a couple of application configuration
</I>&gt;<i> parameters. Normally they default to turning this on, and the management
</I>&gt;<i> plugin should detect if that's switched off and adjust the interface (and
</I>&gt;<i> display warnings) accordingly, but that might not be happening for you.
</I>
    I don't see any errors displayed from the management plugin. It
just says that it started the web server, serving the usual URL.
    I've also tried to set both the `force_fine_statistics` and
`collect_statistics` but they don't seem to have any effect.


&gt;<i> What does your config file look like?
</I>
~~~~
[
	{sasl, [
		{errlog_type, error}]},
	{os_mon, [
		{start_cpu_sup, true},
		{start_memsup, true},
		{start_disksup, true},
		{start_os_sup, false}]},
	{mnesia, [
		{dir, &quot;/tmp/rabbit.db&quot;}]},
	{rabbit, [
		{tcp_listeners, [{&quot;127.0.0.1&quot;, 5672}]},
		{collect_statistics, fine}]},
	{rabbit_management_agent, [
		{force_fine_statistics, true}]},
	{rabbit_mochiweb, [
		{port, 55672}]},
	{rabbit_management, [
		{http_log_dir, none}]}
].
~~~~

    And this is how I've started the whole thing up -- not by using
the boot script:

~~~~
erl -env ERL_LIBS /tmp/rabbit.lib -config /tmp/rabbit.config -run run_rabbit run
~~~~

-module (run_rabbit).

-export ([run/0]).

run () -&gt;
	
	ok = application:start (sasl, permanent),
	ok = application:start (os_mon, permanent),
	ok = application:start (mnesia, permanent),
	
	if
		true -&gt;
			ok = application:start (inets, permanent),
			ok = application:start (crypto, permanent),
			ok = application:start (mochiweb, permanent),
			ok = application:start (rabbit_mochiweb, permanent);
		true -&gt; ok
	end,
	
	ok = rabbit:prepare (),
	ok = application:start (rabbit, permanent),
	ok = application:start (amqp_client, permanent),
	
	if
		true -&gt;
			ok = application:start (rabbit_management_agent, permanent),
			ok = application:start (webmachine, permanent),
			ok = application:start (rabbit_management, permanent);
		true -&gt; ok
	end,
	
	ok = timer:sleep (120 * 1000),
	
	ok = init:stop(),
	ok.
~~~~

    I've also tried to start with that module and the default RabbitMQ
installation and the same problem appears... So it's definitely a
configuration problem... But I'm not seeing where I'm wrong...


&gt;<i> Also, why have you done this? What problem is it solving?
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>
    Good question. :) We'll I'm trying to &quot;embed&quot; RabbitMQ into
another Erlang application -- a web server that instead of handling
the requests it just puts them on a queue, and waits for the response
(the same pattern as in the rpc module is doing). I intend to use
`amqp_client` in with the `direct` connector. I've seen that there is
a similar project but for SMTP -- `rabbitmq-smtp`.

    Thanks for your time,
    Ciprian.
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010613.html">[rabbitmq-discuss] Strange RabbitMQ management plugin error!
</A></li>
	<LI>Next message: <A HREF="010640.html">[rabbitmq-discuss] Strange RabbitMQ management plugin error!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10631">[ date ]</a>
              <a href="thread.html#10631">[ thread ]</a>
              <a href="subject.html#10631">[ subject ]</a>
              <a href="author.html#10631">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
