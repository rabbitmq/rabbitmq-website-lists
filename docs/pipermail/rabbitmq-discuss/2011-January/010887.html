<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Erlang crashes trying to allocate 583848200	bytes of memory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Erlang%20crashes%20trying%20to%20allocate%20583848200%0A%09bytes%20of%20memory&In-Reply-To=%3C6afff39e-c2b7-4308-9f0e-08f1c6ad95ee%40i32g2000pri.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010882.html">
   <LINK REL="Next"  HREF="010892.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Erlang crashes trying to allocate 583848200	bytes of memory</H1>
    <B>Dom54</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Erlang%20crashes%20trying%20to%20allocate%20583848200%0A%09bytes%20of%20memory&In-Reply-To=%3C6afff39e-c2b7-4308-9f0e-08f1c6ad95ee%40i32g2000pri.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Erlang crashes trying to allocate 583848200	bytes of memory">D.Rotondi at Computer.Org
       </A><BR>
    <I>Tue Jan 25 11:44:17 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010882.html">[rabbitmq-discuss] Erlang crashes trying to allocate 583848200 bytes of memory
</A></li>
        <LI>Next message: <A HREF="010892.html">[rabbitmq-discuss] Erlang crashes trying to allocate 583848200	bytes of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10887">[ date ]</a>
              <a href="thread.html#10887">[ thread ]</a>
              <a href="subject.html#10887">[ subject ]</a>
              <a href="author.html#10887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On Jan 25, 11:44&#160;am, Matthias Radestock &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matth... at rabbitmq.com</A>&gt; wrote:
Hi Matthias,
&gt;<i> Dom,
</I>&gt;<i>
</I>&gt;<i> Dom54 wrote:
</I>&gt;<i> &gt; To our understanding the RabbitMQ broker (and its supporting
</I>&gt;<i> &gt; Erlang environment) keeps to be delivered messages in memory; if the
</I>&gt;<i> &gt; consumer is not fast enough the Erlang memory footprint grows till the
</I>&gt;<i> &gt; broker crash.
</I>&gt;<i>
</I>&gt;<i> The rabbit code does not hold on to messages in memory when it has
</I>&gt;<i> delivered them to consumers and it is under memory pressure.
</I>
Thats what I stated above. In memory seems to be buffered only
messages that have not been delivered.

&gt;<i>
</I>&gt;<i> But we do rely on the underlying erlang network stack and O/S to tell us
</I>&gt;<i> when it can't send messages to the consumers. Rather than, say, blindly
</I>&gt;<i> buffering them. It's possible that therein lies the problem on Windows.
</I>&gt;<i>
</I>&gt;<i> Btw, when you tweaked the vm_memory_high_watermark settings, did you
</I>&gt;<i> check that they were actually taking effect? There is a message near the
</I>&gt;<i> beginning of the rabbit log file indicating how much memory it is trying
</I>&gt;<i> to limit itself to.
</I>
Yes we checked the tweak effect in the log file and the log file
reflects the setting.
BTW we have just completed another test using a Windows Server 2008 R2
64 bit version on a vM with 4 BG RAM, and the problem is still there.
We are now trying using the last Erlang release (R14B01) instead of
the R13B03 included in the RabbitMQ distribution, hoping this release
has fixed some of the problems.
Thanks, ciao
   Dom

&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010882.html">[rabbitmq-discuss] Erlang crashes trying to allocate 583848200 bytes of memory
</A></li>
	<LI>Next message: <A HREF="010892.html">[rabbitmq-discuss] Erlang crashes trying to allocate 583848200	bytes of memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10887">[ date ]</a>
              <a href="thread.html#10887">[ thread ]</a>
              <a href="subject.html#10887">[ subject ]</a>
              <a href="author.html#10887">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
