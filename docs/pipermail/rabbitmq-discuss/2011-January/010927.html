<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Slow%20consumer%20disconnect%20availability%20on%0A%09RAbbitMQ&In-Reply-To=%3C11EC96EC521B304EA05595E6F2987FC20234DE3B%40EXCHBAN.machcorp.lan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010920.html">
   <LINK REL="Next"  HREF="010995.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ</H1>
    <B>Prashant Yadav</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Slow%20consumer%20disconnect%20availability%20on%0A%09RAbbitMQ&In-Reply-To=%3C11EC96EC521B304EA05595E6F2987FC20234DE3B%40EXCHBAN.machcorp.lan%3E"
       TITLE="[rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ">PRYD at mach.com
       </A><BR>
    <I>Wed Jan 26 23:45:50 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010920.html">[rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ
</A></li>
        <LI>Next message: <A HREF="010995.html">[rabbitmq-discuss] Slow consumer disconnect availability on RAbbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10927">[ date ]</a>
              <a href="thread.html#10927">[ thread ]</a>
              <a href="subject.html#10927">[ subject ]</a>
              <a href="author.html#10927">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jerry,

Thanks for getting back. 

Actually we do have a requirement where I want consumer to stop getting message once I know that its slow( my consumption logic connects to remote server and if server is not responding or is slow for any reason I dont want my queue to get clogged), I would want to stop queue from populating.

The catch here is , I too dont want to purge all the messages or drop it . I too tried to use TTL and queue lease , but am not sure about messages resisding in the queue i.e whether they are requed or silently dropped( in my case I want them to by returned back to exchange and make the queue alive after some duration)

N.B: I guess suspending the queue can be little tricky , let me know yout thoughts

Regds
Prashant


-----Original Message-----
From: Jerry Kuch [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jerryk at vmware.com</A>]
Sent: Wed 1/26/2011 11:45 PM
To: Prashant Yadav; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: RE: Slow consumer disconnect availability on RAbbitMQ
 
Hi, Prashant...

&gt;<i> Do we have slow consumer detection available in RabbitMQ like we have
</I>&gt;<i> in Apache qpid ( Slow Consumer Disconnect (SCD) is a new feature in
</I>&gt;<i> Qpid that provides a configurable mechanism to prevent a single slow
</I>&gt;<i> consumer from causing a back up of unconsumed messages on the broker )
</I>
Possibly, but can I ask a couple of questions about your actual use
case?  First, are you actually seeing cases where your consumers are
so slow that the broker's own self defense mechanisms like paging
messages to disk and memory-based producer flow control either aren't
engaging, or are being overwhelmed in some way?  Second, are you sure
you actually want to disconnect clients that are consuming slowly, but
whose connections are otherwise alive and healthy?

&gt;<i> This is a very nice feature wherein we could identify and take
</I>&gt;<i> corrective actions against the consumer. Please suggest any
</I>&gt;<i> alternative method to achieve this behavior. Also when we identify SCD
</I>&gt;<i> can we defer the queue for some time( timed defer) before it comes
</I>&gt;<i> back to service something like suspend Queue for 5 mins and try
</I>&gt;<i> again.
</I>
I presume that one of the requirements of the behavior you desire
would be that you discard messages from a queue whose consumers aren't
keeping up to its load since simply disconnecting a slow consumer
without some ability to replace it by one or more less slow ones isn't
going to help.  In that case, you could try the per-queue message TTL
extension that Rabbit supports.  It's documented here:

<A HREF="http://www.rabbitmq.com/extensions.html#queue-ttl">http://www.rabbitmq.com/extensions.html#queue-ttl</A>

This lets you declare queues with a limit on how long a message
published to a queue can remain there before it is discarded.  This
would let you escape the back up of unconsumed messages that you're
concerned about and, for many types of message flows, is a sensible
behavior in any event since the relevance of ancient messages that
have been languishing unconsumed in queues probably degrades with time
anyway.

Best regards,
Jerry

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110127/792f2061/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110127/792f2061/attachment-0001.htm</A>&gt;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010920.html">[rabbitmq-discuss] Slow consumer disconnect availability on	RAbbitMQ
</A></li>
	<LI>Next message: <A HREF="010995.html">[rabbitmq-discuss] Slow consumer disconnect availability on RAbbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10927">[ date ]</a>
              <a href="thread.html#10927">[ thread ]</a>
              <a href="subject.html#10927">[ subject ]</a>
              <a href="author.html#10927">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
