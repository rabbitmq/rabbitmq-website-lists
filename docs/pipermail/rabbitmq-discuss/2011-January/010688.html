<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Node hung and not responding to rabbitmqctl
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Node%20hung%20and%20not%20responding%20to%20rabbitmqctl&In-Reply-To=%3CAANLkTikJqw-js4DyEjh82Vmd7%2BuRRvh9OieTEtZvDFtZ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010696.html">
   <LINK REL="Next"  HREF="010702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Node hung and not responding to rabbitmqctl</H1>
    <B>Bill Moseley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Node%20hung%20and%20not%20responding%20to%20rabbitmqctl&In-Reply-To=%3CAANLkTikJqw-js4DyEjh82Vmd7%2BuRRvh9OieTEtZvDFtZ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Node hung and not responding to rabbitmqctl">moseley at hank.org
       </A><BR>
    <I>Fri Jan 14 15:01:06 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010696.html">[rabbitmq-discuss] Distributing clients across a cluster
</A></li>
        <LI>Next message: <A HREF="010702.html">[rabbitmq-discuss] Node hung and not responding to rabbitmqctl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10688">[ date ]</a>
              <a href="thread.html#10688">[ thread ]</a>
              <a href="subject.html#10688">[ subject ]</a>
              <a href="author.html#10688">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been working with clustering (on a single test machine) and I stopped
the 2nd RAM node w/o problem but now the initial disk node seems
unresponsive.  All of the rabbitmqctl commands hang.   Initially, connecting
to the node would also hang, but not Rabbit doesn't seem to be listening to
the port any more.


$ sudo rabbitmqctl stop_app
Stopping node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at bumby2</A> ...


After a few minutes I abort and &quot;k&quot; for kill and get the following:

^C
BREAK: (a)bort (c)ontinue (p)roc info (i)nfo (l)oaded
       (v)ersion (k)ill (D)b-tables (d)istribution

k

Process Information

--------------------------------------------------
=proc:&lt;0.38.0&gt;
State: Waiting
Name: inet_gethost_native
Spawned as: inet_gethost_native:server_init/2
Spawned by: &lt;0.37.0&gt;
Started: Fri Jan 14 06:38:10 2011
Message queue length: 0
Number of heap fragments: 0
Heap fragment data: 0
Link list: [#Port&lt;0.288&gt;, &lt;0.37.0&gt;]
Dictionary: [{rid,1},{num_requests,0}]
Reductions: 64
Stack+heap: 233
OldHeap: 0
Heap unused: 190
OldHeap unused: 0
Stack dump:
Program counter: 0xb771c718 (inet_gethost_native:main_loop/1 + 20)
CP: 0x00000000 (invalid)
arity = 0

0xb74eeecc Return addr 0x08201594 (&lt;terminate process normally&gt;)
y(0)
{state,#Port&lt;0.288&gt;,8000,12302,16399,&lt;0.37.0&gt;,4,{statistics,0,0,0,0,0,0,0,0}}
(k)ill (n)ext (r)eturn:

Seems to be a lot of these hanging around:


$ ps auxf | grep gethost
rabbitmq  3700  0.0  0.0   1868   436 ?        Ss   Jan13   0:00  \_
inet_gethost 4
rabbitmq  3701  0.0  0.0   1916   540 ?        S    Jan13   0:00  |   \_
inet_gethost 4
rabbitmq  3995  0.0  0.0   1868   436 ?        Ss   Jan13   0:00  \_
inet_gethost 4
rabbitmq  3996  0.0  0.0   1916   536 ?        S    Jan13   0:00      \_
inet_gethost 4
rabbitmq  4370  0.0  0.0   1868   432 ?        Ss   Jan13   0:00  \_
inet_gethost 4
rabbitmq  4371  0.0  0.0   1916   536 ?        S    Jan13   0:00      \_
inet_gethost 4


And logs:

=WARNING REPORT==== 13-Jan-2011::21:39:43 ===
exception on TCP connection &lt;0.30329.54&gt; from 127.0.0.1:50222
connection_closed_abruptly

=INFO REPORT==== 13-Jan-2011::21:39:43 ===
closing TCP connection &lt;0.30329.54&gt; from 127.0.0.1:50222

=ERROR REPORT==== 14-Jan-2011::06:39:16 ===
** Node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmqctl7173 at bumby2</A> not responding **
** Removing (timedout) connection **



Ubuntu Erlang1:13.b.1-dfsg-2ubuntu1.1 / RabbitMQ 2.2.0-1

Are there any docs that describe debugging techniques for those of us that
have no Erlang experience?   I'm not even sure what to kill -9 if I had to.
;)

-- 
Bill Moseley
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">moseley at hank.org</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110114/8adc523a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110114/8adc523a/attachment.htm</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010696.html">[rabbitmq-discuss] Distributing clients across a cluster
</A></li>
	<LI>Next message: <A HREF="010702.html">[rabbitmq-discuss] Node hung and not responding to rabbitmqctl
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10688">[ date ]</a>
              <a href="thread.html#10688">[ thread ]</a>
              <a href="subject.html#10688">[ subject ]</a>
              <a href="author.html#10688">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
