<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Cleaning up unhandled messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cleaning%20up%20unhandled%20messages&In-Reply-To=%3CF78BCF638F95D74A99D036114107EDB5023948CC35%40EXCH-MBX-3.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010829.html">
   <LINK REL="Next"  HREF="010832.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Cleaning up unhandled messages</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Cleaning%20up%20unhandled%20messages&In-Reply-To=%3CF78BCF638F95D74A99D036114107EDB5023948CC35%40EXCH-MBX-3.vmware.com%3E"
       TITLE="[rabbitmq-discuss] Cleaning up unhandled messages">jerryk at vmware.com
       </A><BR>
    <I>Fri Jan 21 18:53:16 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010829.html">[rabbitmq-discuss] Cleaning up unhandled messages
</A></li>
        <LI>Next message: <A HREF="010832.html">[rabbitmq-discuss] Cleaning up unhandled messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10831">[ date ]</a>
              <a href="thread.html#10831">[ thread ]</a>
              <a href="subject.html#10831">[ subject ]</a>
              <a href="author.html#10831">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I've implemented the following before.
</I>&gt;<i>
</I>&gt;<i> * Consumer gets a message
</I>&gt;<i> * Consumer throws exception
</I>&gt;<i> * Consumer stores md5sum of message in array of &quot;bad messages&quot;
</I>&gt;<i> * Consumer gets the message again
</I>&gt;<i> * Consumer throws exception
</I>&gt;<i> * Consumer checks bad messages array
</I>&gt;<i> * Bad message exists already, ack it, and publish the message to an
</I>errors exchange.
&gt;<i> * Errors exchange has a queue/consumer that logs to disk, sends alerts, etc.
</I>
This is a viable sounding scheme, although I wonder...  Would the
semantics of AMQP's basic.reject, as described here:

<A HREF="http://www.rabbitmq.com/blog/2010/08/03/well-ill-let-you-go-basicreject-in-rabbitmq/">http://www.rabbitmq.com/blog/2010/08/03/well-ill-let-you-go-basicreject-in-rabbitmq/</A>

...do what you want?

This method allows your consumer to, rather than basic.ack-ing a
message that has been delivered to it, to sort of &quot;anti-ACK&quot; it,
declaring that it can't be processed.  If you basic.reject a method
with the 'requeue' parameter set to false, the message will be
discarded rather than put back into the queue for future redelivery.

As described in the post I link above, there's some modestly
Mephistophelean details in what the AMQP spec says about the
basic.reject method and how it should work, but what RabbitMQ has
chosen to implement aims to be the most straightforward thing that is
actually useful.  Modulo a special circumstance such as you having
multiple consumers on a queue, with only some of them for some reason
unable to cope with the so called &quot;bad message,&quot; it seems it should handle
your needs.

Best regards,
Jerry
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010829.html">[rabbitmq-discuss] Cleaning up unhandled messages
</A></li>
	<LI>Next message: <A HREF="010832.html">[rabbitmq-discuss] Cleaning up unhandled messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10831">[ date ]</a>
              <a href="thread.html#10831">[ thread ]</a>
              <a href="subject.html#10831">[ subject ]</a>
              <a href="author.html#10831">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
