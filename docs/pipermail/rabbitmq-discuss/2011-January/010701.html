<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Are queues replicated across a cluster?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Are%20queues%20replicated%20across%20a%20cluster%3F&In-Reply-To=%3CAANLkTi%3DfkvhKYod5x%2BinA9nSs73K2eeDEdyZ%3DdyMbSC8%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010695.html">
   <LINK REL="Next"  HREF="010662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Are queues replicated across a cluster?</H1>
    <B>Bill Moseley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Are%20queues%20replicated%20across%20a%20cluster%3F&In-Reply-To=%3CAANLkTi%3DfkvhKYod5x%2BinA9nSs73K2eeDEdyZ%3DdyMbSC8%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Are queues replicated across a cluster?">moseley at hank.org
       </A><BR>
    <I>Fri Jan 14 22:24:44 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010695.html">[rabbitmq-discuss] Are queues replicated across a cluster?
</A></li>
        <LI>Next message: <A HREF="010662.html">[rabbitmq-discuss] List queues via AMQP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10701">[ date ]</a>
              <a href="thread.html#10701">[ thread ]</a>
              <a href="subject.html#10701">[ subject ]</a>
              <a href="author.html#10701">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jan 14, 2011 at 9:08 AM, Matthew Sackman &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at rabbitmq.com</A>&gt;wrote:

&gt;<i>
</I>&gt;<i> Entirely up to you - resources are visible throughout the cluster and so
</I>&gt;<i> any sane load balancing should be just fine. If they all connect to the
</I>&gt;<i> same node then you'll likely find that all resources exist solely on
</I>&gt;<i> that node and thus the other nodes are not being used at all. Thus
</I>&gt;<i> really, you want to make sure that the clients which create resources
</I>&gt;<i> (queues in particular) are connected across all the nodes.
</I>&gt;<i>
</I>&gt;<i> The other thing to consider is the inter-node hops required to route
</I>&gt;<i> messages. Thus you may wish to make sure that if client 1 is
</I>&gt;<i> predominantly sending messages to or consuming messages from queue 1,
</I>&gt;<i> that client 1 is connected to the same node on which queue 1 resides.
</I>&gt;<i>
</I>
Hum.  There's always trade-offs.

The top concern is that a producer (and consumer) can connect to a node.
 What looks like a good choice is HAProxy in front of a set of RabbitMQ
nodes.  And maybe a pair of HAProxy machines with Heartbeat to avoid the
single point of failure.  Configuration is easier because workers just talk
to one HAProxy.

But, then there's no control over which node a producer or consumer connects
to.  So, then there's going to be be some (probably half) cross-node
messages.

Perhaps if the point of the second node is for HA then should just configure
HAProxy to only use the second node as a hot-backup and make both nodes disk
nodes.  The nature of a backup is that it must be able to handle all
traffic, anyway.

If we design with the idea messages might get dropped, and always declare
exchanges, queues, and bindings on every connection then maybe there's no
need for a cluster or using the Pacemaker HA example and just run
independent RabbitMQ instances with a method of fail-over.


Thanks very much for the help, Matthew.


Would I be wrong to assume that these configuration issues have been solved
by many people already?


-- 
Bill Moseley
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">moseley at hank.org</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110114/36bea295/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110114/36bea295/attachment.htm</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010695.html">[rabbitmq-discuss] Are queues replicated across a cluster?
</A></li>
	<LI>Next message: <A HREF="010662.html">[rabbitmq-discuss] List queues via AMQP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10701">[ date ]</a>
              <a href="thread.html#10701">[ thread ]</a>
              <a href="subject.html#10701">[ subject ]</a>
              <a href="author.html#10701">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
