<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Test%20case%20-%20Possible%20Memory%20Leak%0A%20problem&In-Reply-To=%3C20110114160023.GE18402%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010619.html">
   <LINK REL="Next"  HREF="010818.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak problem</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Test%20case%20-%20Possible%20Memory%20Leak%0A%20problem&In-Reply-To=%3C20110114160023.GE18402%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak problem">matthew at rabbitmq.com
       </A><BR>
    <I>Fri Jan 14 16:00:24 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010619.html">[rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak problem
</A></li>
        <LI>Next message: <A HREF="010818.html">[rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10690">[ date ]</a>
              <a href="thread.html#10690">[ thread ]</a>
              <a href="subject.html#10690">[ subject ]</a>
              <a href="author.html#10690">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On Tue, Jan 11, 2011 at 12:44:54PM +0100, Crisoforo Seccia wrote:
&gt;<i> . Am I adopting a very strange test case which is not well handled by
</I>&gt;<i> RabbitMQ?
</I>
Not really, no. However, there are problems with RabbitMQ under Windows,
and you may have to do some tweaking of the configuration. The fact that
you crashed on an eheap allocation suggests that Rabbit tried to
allocate memory that Windows refused it.
<A HREF="http://www.rabbitmq.com/extensions.html#memsup">http://www.rabbitmq.com/extensions.html#memsup</A>

Rabbit by default assumes that it's the only application running on a
machine, and thus it can expect to be allocated all memory. You may
wish, as suggested in the above page, to try reducing the
vm_memory_high_watermark and repeat the tests.

&gt;<i> . Is there any connection with the solved bug described in the RabbitMQ 2.2
</I>&gt;<i> release notes (&#8220;fix memory leak when long-running channels consume and
</I>&gt;<i> cancel on many queues&#8221;)?
</I>
Nope - that bug would have likely taken months of constant tripping to
actually result in any sizable memory leak.

&gt;<i> . How does RabbitMQ handle message flooding? As stated in ActiveMQ official
</I>&gt;<i> page, the flow control, in the current version means that: &#8220;if the broker
</I>&gt;<i> detects that the memory limit for the destination, or the temp- or
</I>&gt;<i> file-store limits for the broker, have been exceeded, then the flow of
</I>&gt;<i> messages can be slowed down. The producer will be either blocked until
</I>&gt;<i> resources are available or will receive a JMSException&#8221;.
</I>
Again, the above link will explain it all, but in short, Rabbit uses TCP
back pressure to prevent producers flooding it with too many messages.
Ultimately, you're always limited by the rate at which you can get rid
of messages - whether to clients or to disk. In effect, RAM just acts as
a huge (hopefully!) buffer.

Matthew
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010619.html">[rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak problem
</A></li>
	<LI>Next message: <A HREF="010818.html">[rabbitmq-discuss] RabbitMQ Test case - Possible Memory Leak	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10690">[ date ]</a>
              <a href="thread.html#10690">[ thread ]</a>
              <a href="subject.html#10690">[ subject ]</a>
              <a href="author.html#10690">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
