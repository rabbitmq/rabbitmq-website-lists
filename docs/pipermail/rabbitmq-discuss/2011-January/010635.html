<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Implementing a &quot;processing&quot; queue with	message expiry
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Implementing%20a%20%22processing%22%20queue%20with%0A%09message%20expiry&In-Reply-To=%3CAANLkTimdxj6ZH5O%3D5qMirVcL2Oa%2B5NZCkpKBq4EuNeAK%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010623.html">
   <LINK REL="Next"  HREF="010641.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Implementing a &quot;processing&quot; queue with	message expiry</H1>
    <B>Steven Taylor</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Implementing%20a%20%22processing%22%20queue%20with%0A%09message%20expiry&In-Reply-To=%3CAANLkTimdxj6ZH5O%3D5qMirVcL2Oa%2B5NZCkpKBq4EuNeAK%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Implementing a &quot;processing&quot; queue with	message expiry">taylste at gmail.com
       </A><BR>
    <I>Wed Jan 12 06:37:01 GMT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="010623.html">[rabbitmq-discuss] Implementing a &quot;processing&quot; queue with message expiry
</A></li>
        <LI>Next message: <A HREF="010641.html">[rabbitmq-discuss] Implementing a &quot;processing&quot; queue with	message expiry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10635">[ date ]</a>
              <a href="thread.html#10635">[ thread ]</a>
              <a href="subject.html#10635">[ subject ]</a>
              <a href="author.html#10635">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> Often, a bit like threading, things can get split off, but later reconverge
/ reconvene / rejoin the same execution stream (e.g. do the resutls end up
in a database / are they sent to the same end client)

&quot;idempotent&quot; as mentioned is a very useful solution (i.e. the job could get
done twice, but results/persistent state will look the same). You could
implement that as reject 2nd duplicated worker results, or copy it in again,
it doesn't matter. Assuming subsystems underneath the worker are transaction
based (in the database sense), you can ensure nothing gets inconsistent.

It took me a a few days to get comfortable with the &quot;idempotent&quot; idea, but
now I think I can work that idea into most situations.  The resulting code
while not materially that different appears to me to be more complete, and
thinking through an additional edge case, once you get used to it, in my
opinion adds value and doesn't get in the way of the development process.

-Steven
On 11 January 2011 15:21, Derek Chen-Becker &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dbecker at cpicorp.com</A>&gt; wrote:

&gt;<i> On 01/10/2011 06:15 PM, Sami Samhuri wrote:
</I>&gt;<i> &gt; Hi all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm designing a small distributed system with some queueing involved and
</I>&gt;<i> &gt; have some doubts that Rabbit is the right solution for parts of it.
</I>&gt;<i> &gt; Hoping that some of you can shed some light and let me know if Rabbit
</I>&gt;<i> &gt; can do it all, which would be great, or if there's a better and/or
</I>&gt;<i> &gt; simpler solution I've missed. I realize that Rabbit is for message
</I>&gt;<i> &gt; passing and is not a work queue, so perhaps I'm trying to shove a square
</I>&gt;<i> &gt; peg into a round hole. If so please tell me that I'm barking up the
</I>&gt;<i> &gt; wrong tree.
</I>&gt;<i>
</I>&gt;<i> We use RabbitMQ for a render farm work queue and the way you deal with
</I>&gt;<i> possible &quot;lost&quot; consumers is with ACKs. You need to turn off auto-ack
</I>&gt;<i> when you set up the consumer, and then after you process the message you
</I>&gt;<i> explicitly ACK it (BasicAck). If, for some reason, your client dies
</I>&gt;<i> while in the middle of processing messages, any unacked messages it was
</I>&gt;<i> holding on to get re-inserted into the queue.
</I>&gt;<i>
</I>&gt;<i> Derek
</I>&gt;<i>  _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110112/222d1f37/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110112/222d1f37/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010623.html">[rabbitmq-discuss] Implementing a &quot;processing&quot; queue with message expiry
</A></li>
	<LI>Next message: <A HREF="010641.html">[rabbitmq-discuss] Implementing a &quot;processing&quot; queue with	message expiry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10635">[ date ]</a>
              <a href="thread.html#10635">[ thread ]</a>
              <a href="subject.html#10635">[ subject ]</a>
              <a href="author.html#10635">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
