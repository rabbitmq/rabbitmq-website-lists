<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] queue hands - timeout
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20queue%20hands%20-%20timeout&In-Reply-To=%3C9C5CE94A-0666-4633-8E86-A5EF80A809BE%40digitalriver.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012933.html">
   <LINK REL="Next"  HREF="012939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] queue hands - timeout</H1>
    <B>Thomas Stagl</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20queue%20hands%20-%20timeout&In-Reply-To=%3C9C5CE94A-0666-4633-8E86-A5EF80A809BE%40digitalriver.com%3E"
       TITLE="[rabbitmq-discuss] queue hands - timeout">tstagl at digitalriver.com
       </A><BR>
    <I>Thu May 19 13:35:34 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012933.html">[rabbitmq-discuss] Unable to run RabbitMQ Server as no-root user
</A></li>
        <LI>Next message: <A HREF="012939.html">[rabbitmq-discuss] queue hands - timeout
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12935">[ date ]</a>
              <a href="thread.html#12935">[ thread ]</a>
              <a href="subject.html#12935">[ subject ]</a>
              <a href="author.html#12935">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

we are running a queue in our test environment with different vhosts. When we do a long running perf test, we recognise that the responses from the queue are timing out and from that moment on, it is not possible to connect to the queue again. Neither with the java lib (which we use in our application) nor with celery (which I use for testing purposes.)

We have recognised that beam.smp is running on 30% CPU time from that moment on.

When we trace a connection, we see this with tcpdump:
12:23:52.700093 IP CLIENT.43248 &gt; RABBIT.amqp: Flags [P.], seq 2421288989:2421289002, ack 2617563671, win 54, options [nop,nop,TS val 2047452 ecr 1377663677], length 13
12:23:52.700124 IP RABBIT.amqp &gt; CLIENT.43248: Flags [.], ack 13, win 62, options [nop,nop,TS val 1377881158 ecr 2047452], length 0

From that moment on, the connection is hanging.

After a restart of the rabbitmq server, everything is running fine again, for a certain amount of time.

We also have a second test stack and we switched to the second rabbitmq test server, same behaviour here. It worked fine and after a couple of hours it stopped responding.

Any ideas? Any though about where we can start debugging would be very much appreciated.

Best regards, tom

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012933.html">[rabbitmq-discuss] Unable to run RabbitMQ Server as no-root user
</A></li>
	<LI>Next message: <A HREF="012939.html">[rabbitmq-discuss] queue hands - timeout
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12935">[ date ]</a>
              <a href="thread.html#12935">[ thread ]</a>
              <a href="subject.html#12935">[ subject ]</a>
              <a href="author.html#12935">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
