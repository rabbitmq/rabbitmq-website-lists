<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] behavior when erlang processes exhausted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20behavior%20when%20erlang%20processes%20exhausted&In-Reply-To=%3CBANLkTikiUH740bEt1Bt8%3D_PbXh%3DT9NvGUw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012988.html">
   <LINK REL="Next"  HREF="012990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] behavior when erlang processes exhausted</H1>
    <B>Aaron Westendorf</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20behavior%20when%20erlang%20processes%20exhausted&In-Reply-To=%3CBANLkTikiUH740bEt1Bt8%3D_PbXh%3DT9NvGUw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] behavior when erlang processes exhausted">aaron at agoragames.com
       </A><BR>
    <I>Wed May 25 20:31:31 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012988.html">[rabbitmq-discuss] RabbitMQ and Erlang R14B03
</A></li>
        <LI>Next message: <A HREF="012990.html">[rabbitmq-discuss] behavior when erlang processes exhausted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12989">[ date ]</a>
              <a href="thread.html#12989">[ thread ]</a>
              <a href="subject.html#12989">[ subject ]</a>
              <a href="author.html#12989">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What is the expected behavior of Rabbit when Erlang runs out of
processes? We had an event over the past weekend that went something
like this:

  =ERROR REPORT==== 22-May-2011::17:35:58 ===
  Too many processes

This continued for many hours. Rabbit is configured with 1048576 procs
and with mid-day load is reporting 595400 in use. At the time of this
event, our databases were beginning a prolonged period of fail, and
messages were starting to pile up. I don't have numbers for count of
pending messages at the time of this first log report, but when it
outright crashed 2.5 hours later, the backlog had spiked to more than
2 million and was declining after we fixed the databases and messages
were finally draining.

I have mountains of application and SASL logs and have already poured
through them to highlight notable sections. I'll gladly provide any
data to help diagnose the crash. The final seconds, triggered by a
rabbitmqctl call to list queues, resulted in rex dying and mnesia
exiting.

-Aaron


-- 
Aaron Westendorf
Senior Software Engineer
Agora Games
359 Broadway
Troy, NY 12180
Phone: 518.268.1000
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aaron at agoragames.com</A>
www.agoragames.com
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012988.html">[rabbitmq-discuss] RabbitMQ and Erlang R14B03
</A></li>
	<LI>Next message: <A HREF="012990.html">[rabbitmq-discuss] behavior when erlang processes exhausted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12989">[ date ]</a>
              <a href="thread.html#12989">[ thread ]</a>
              <a href="subject.html#12989">[ subject ]</a>
              <a href="author.html#12989">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
