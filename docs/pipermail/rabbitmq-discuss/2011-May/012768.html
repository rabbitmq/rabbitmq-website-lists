<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Acks versus Publisher confirms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Acks%20versus%20Publisher%20confirms&In-Reply-To=%3C4DC9104A.2030202%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012767.html">
   <LINK REL="Next"  HREF="012772.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Acks versus Publisher confirms</H1>
    <B>Tim Fox</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Acks%20versus%20Publisher%20confirms&In-Reply-To=%3C4DC9104A.2030202%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Acks versus Publisher confirms">tim at rabbitmq.com
       </A><BR>
    <I>Tue May 10 11:15:38 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012767.html">[rabbitmq-discuss] Acks versus Publisher confirms
</A></li>
        <LI>Next message: <A HREF="012772.html">[rabbitmq-discuss] Acks versus Publisher confirms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12768">[ date ]</a>
              <a href="thread.html#12768">[ thread ]</a>
              <a href="subject.html#12768">[ subject ]</a>
              <a href="author.html#12768">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 10/05/11 11:01, Simone wrote:
&gt;<i> Ok so I get publisher confirms have to do with messages getting from 
</I>&gt;<i> the publisher to the broker, while acks concern the link from the 
</I>&gt;<i> broker to the consumer, correct?
</I>&gt;<i>
</I>&gt;<i> With strongest delivery warranty I mean to make sure that once a 
</I>&gt;<i> message has been published by a publisher it is going to reach all of 
</I>&gt;<i> the consumers supposed to be receiving it.
</I>&gt;<i>
</I>&gt;<i> Therefore to achieve this sort of thing without using transactions I 
</I>&gt;<i> have to use both publisher confirms and consumer acks, right? Just 
</I>&gt;<i> trying to get a better understanding at how this works.
</I>If you want a &quot;once and only once&quot; QoS, as opposed to a &quot;at least once&quot;, 
then you'll need to deal with duplicates.

If you use publisher acks, then, when you receive the publisher ack from 
the broker you know the message has reached the server ok. However, if 
the server crashes, then it's possible the message did reach the server 
ok, but you didn't get the ack back before the server died.

If, on recovery, you resend any messages that you didn't receive 
publisher acks for, there is a possibility of duplicate messages on the 
server.

Similarly with consuming messages, if you ack messages from the consumer 
once they have been consumed, then if the server crashes after a message 
has been consumed but before the ack for that message is processed on 
the server, on recovery of the server the message may be redelivered.

if you build your message consumption logic to be idempotent (i.e. no 
harm comes in processing the same message twice), you can get an 
&quot;effective&quot; once and only once QoS. This may be hard or easy depending 
on your application semantics.
&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110510/32219ec3/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110510/32219ec3/attachment.htm</A>&gt;
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012767.html">[rabbitmq-discuss] Acks versus Publisher confirms
</A></li>
	<LI>Next message: <A HREF="012772.html">[rabbitmq-discuss] Acks versus Publisher confirms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12768">[ date ]</a>
              <a href="thread.html#12768">[ thread ]</a>
              <a href="subject.html#12768">[ subject ]</a>
              <a href="author.html#12768">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
