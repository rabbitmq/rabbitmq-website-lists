<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Stress testing RabbitMQ
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Stress%20testing%20RabbitMQ&In-Reply-To=%3CA1A9378F-8190-4310-845C-22C553644944%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012867.html">
   <LINK REL="Next"  HREF="012872.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Stress testing RabbitMQ</H1>
    <B>Alvaro Videla</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Stress%20testing%20RabbitMQ&In-Reply-To=%3CA1A9378F-8190-4310-845C-22C553644944%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Stress testing RabbitMQ">videlalvaro at gmail.com
       </A><BR>
    <I>Sat May 14 15:02:05 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012867.html">[rabbitmq-discuss] Stress testing RabbitMQ
</A></li>
        <LI>Next message: <A HREF="012872.html">[rabbitmq-discuss] Stress testing RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12868">[ date ]</a>
              <a href="thread.html#12868">[ thread ]</a>
              <a href="subject.html#12868">[ subject ]</a>
              <a href="author.html#12868">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias,

Yes, the binding add/removal is slow. In that case I thought that is more common to be routing messages than adding removing bindings.

Also my goal was to easily get an implementation to see if the route part could be improved by skipping the mnesia:dirty_select. One reason I thought Mnesia could be a problem was because I started getting logs like: Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mrhyde</A>): ** WARNING ** Mnesia is overloaded&#8230;

My reasoning was that scanning the table every time a message is routed could be slower than just returning a somehow cached list of bindings, which is what I tried to do.

As you say if the bulk of the job for message routing is done somewhere else, then of course optimizing here won't matter that much. Is like when people get their uber fast web frameworks for hello world benchmarks but then writing or reading form MySQL makes the app slow.

BTW, thanks for taking the time of testing all this.

Alvaro

On May 14, 2011, at 3:42 PM, Matthias Radestock wrote:

&gt;<i> Alvaro,
</I>&gt;<i> 
</I>&gt;<i> Alvaro Videla wrote:
</I>&gt;&gt;<i> Here's my na&#238;ve implementation of the exchange:  <A HREF="https://github.com/videlalvaro/rabbitmq-alternate-fanout">https://github.com/videlalvaro/rabbitmq-alternate-fanout</A>
</I>&gt;&gt;<i> The binding storage seems to be suboptimal. I think the main
</I>&gt;&gt;<i> difference with the default fanout is how it retrieves the list of
</I>&gt;&gt;<i> matches for the *route* call.
</I>&gt;<i> 
</I>&gt;<i> The representation chosen there results in O(n^2) time complexity for binding addition and removal.
</I>&gt;<i> 
</I>&gt;<i> Btw, for massive fanout the bulk of the time and space complexity is likely in the distribution of the messages to the queues, storage of the messages in the queues, and sending of the messages to consumers. The routing logic should only take up a fraction of the overall time, so by Amdahl's law any improvements there will have little impact on the overall performance.
</I>&gt;<i> 
</I>&gt;<i> Matthias.
</I>
Sent form my Nokia 1100



</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012867.html">[rabbitmq-discuss] Stress testing RabbitMQ
</A></li>
	<LI>Next message: <A HREF="012872.html">[rabbitmq-discuss] Stress testing RabbitMQ
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12868">[ date ]</a>
              <a href="thread.html#12868">[ thread ]</a>
              <a href="subject.html#12868">[ subject ]</a>
              <a href="author.html#12868">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
