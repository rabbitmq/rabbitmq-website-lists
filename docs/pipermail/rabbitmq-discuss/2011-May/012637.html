<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] looks like a memory leak, 2.4.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20looks%20like%20a%20memory%20leak%2C%202.4.1&In-Reply-To=%3CBANLkTimFD%3Dk1Pms1f81hJvL7a4LFRgQ-Fg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012769.html">
   <LINK REL="Next"  HREF="012638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] looks like a memory leak, 2.4.1</H1>
    <B>Gavin M. Roy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20looks%20like%20a%20memory%20leak%2C%202.4.1&In-Reply-To=%3CBANLkTimFD%3Dk1Pms1f81hJvL7a4LFRgQ-Fg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] looks like a memory leak, 2.4.1">gmr at myyearbook.com
       </A><BR>
    <I>Mon May  2 19:32:16 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012769.html">[rabbitmq-discuss] difficulties with prefetch count
</A></li>
        <LI>Next message: <A HREF="012638.html">[rabbitmq-discuss] looks like a memory leak, 2.4.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12637">[ date ]</a>
              <a href="thread.html#12637">[ thread ]</a>
              <a href="subject.html#12637">[ subject ]</a>
              <a href="author.html#12637">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In checking my cluster, I am seeing this too.  Looks like it pre-existed
2.4.1, the drop at week 16 is an upgrade from 2.3.1 to 2.4.1:

   [image: Memory.png]

The management plugin is reporting RAM usage for this node at 330MB and
Rabbit is the only service running on the box.  Anyone have some ideas on
how to try and figure out where the leak is?

Gavin


On Thu, Apr 28, 2011 at 8:34 AM, Aaron Westendorf &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aaron at agoragames.com</A>&gt;wrote:

&gt;<i> Are you running the management plugin?  Specifically the web
</I>&gt;<i> interface? We haven't had trouble with the agents, but we observed the
</I>&gt;<i> same pattern you're describing on a node that was running the web
</I>&gt;<i> stack, with similar traffic loads. Haven't had time to write up a bug
</I>&gt;<i> report yet but I mentioned it in another thread.
</I>&gt;<i>
</I>&gt;<i> -Aaron
</I>&gt;<i>
</I>&gt;<i> On Wed, Apr 27, 2011 at 7:31 PM, Mark Geib &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mark.geib at echostar.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> &gt; Hash: SHA1
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We have rabbitmq 2.4.1 on debian squeeze, erlang is R14A.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Currently we have a dozen or some queue and 2-3 exchanges with message
</I>&gt;<i> &gt; rates of about 500/sec to 2000/sec over all the queues. These are all
</I>&gt;<i> &gt; direct exchanges, but both the exchanges and queues are durable and
</I>&gt;<i> &gt; all publishing is persistent.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What we see is that the memory footprint of rabbitmq grows after
</I>&gt;<i> &gt; running for just a couple to a few hours. And eventually we get VM
</I>&gt;<i> &gt; alarms in the rabbitmq log. The funny thing is that we never queue up
</I>&gt;<i> &gt; more a 10-50 messages in any queue, usually in the single digits. So
</I>&gt;<i> &gt; the activity seems low, and the queue sizes are small, based on number
</I>&gt;<i> &gt; of messages.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We have seem this with 2.3.1 and then upgraded to 2.4.1 and see the
</I>&gt;<i> &gt; same thing.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; With this level of usage, etc. this does not make sense. Any ideas.??
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; Mark.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - --
</I>&gt;<i> &gt; Principal Engineer
</I>&gt;<i> &gt; Cheyenne Software Engineering
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mark.geib at echostar.com</A> / 35-215
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; PGP fingerprint:6DFC 389D 9796 0188 92E5 58F5 34C5 6B47 D091 76FD
</I>&gt;<i> &gt; -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> &gt; Version: GnuPG v1.4.10 (GNU/Linux)
</I>&gt;<i> &gt; Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org/">http://enigmail.mozdev.org/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; iEYEARECAAYFAk24p0sACgkQNMVrR9CRdv0kCQCfVya+xhlE6cN6MCdICPjzdWJq
</I>&gt;<i> &gt; kLQAnjgJQ+skYHgfirUatLLZxjjVhroc
</I>&gt;<i> &gt; =HBcw
</I>&gt;<i> &gt; -----END PGP SIGNATURE-----
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Aaron Westendorf
</I>&gt;<i> Senior Software Engineer
</I>&gt;<i> Agora Games
</I>&gt;<i> 359 Broadway
</I>&gt;<i> Troy, NY 12180
</I>&gt;<i> Phone: 518.268.1000
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aaron at agoragames.com</A>
</I>&gt;<i> www.agoragames.com
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110502/c8a8a6f7/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110502/c8a8a6f7/attachment-0001.htm</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 20393 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110502/c8a8a6f7/attachment-0001.png">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110502/c8a8a6f7/attachment-0001.png</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012769.html">[rabbitmq-discuss] difficulties with prefetch count
</A></li>
	<LI>Next message: <A HREF="012638.html">[rabbitmq-discuss] looks like a memory leak, 2.4.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12637">[ date ]</a>
              <a href="thread.html#12637">[ thread ]</a>
              <a href="subject.html#12637">[ subject ]</a>
              <a href="author.html#12637">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
