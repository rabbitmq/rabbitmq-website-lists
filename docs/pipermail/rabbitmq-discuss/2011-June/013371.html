<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Persistent messages and durable queue questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Persistent%20messages%20and%20durable%20queue%20questions&In-Reply-To=%3CBANLkTinehFtF17CT6koQ-W_kUV-7fdJWSw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013370.html">
   <LINK REL="Next"  HREF="013373.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Persistent messages and durable queue questions</H1>
    <B>Elias Levy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Persistent%20messages%20and%20durable%20queue%20questions&In-Reply-To=%3CBANLkTinehFtF17CT6koQ-W_kUV-7fdJWSw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Persistent messages and durable queue questions">fearsome.lucidity at gmail.com
       </A><BR>
    <I>Tue Jun 21 23:51:43 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013370.html">[rabbitmq-discuss] haigha 0.3.0
</A></li>
        <LI>Next message: <A HREF="013373.html">[rabbitmq-discuss] Persistent messages and durable queue	questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13371">[ date ]</a>
              <a href="thread.html#13371">[ thread ]</a>
              <a href="subject.html#13371">[ subject ]</a>
              <a href="author.html#13371">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good day,

I was wondering whether someone my know the answer to the following
questions.  I've read the FAQ and manuals, but they are not completely
clear.

The first question is does a persistent message will hit the disk even if
there is a consumer on the queue the message is being delivered to, and do
automatic acknowledgements (i.e. no-wait) make a difference?

We are in a situation where writing to disk is expensive, and usually there
will be a waiting and willing consumer attached to the queue, but we are not
using automatic acks, rather we ack the message when the consumer has
processed it, which may take a second or two.  So we'd like to know whether
in the common case in this situation messages will be written to disk or
not.

The docs are unclear.  One could interpret them to mean that if there is a
willing consumer the message will not be written to disk, but its unclear if
this requires no-wait to be true.


The second question is what happens to persistent messages coming in through
a node that are to be routed to a durable queue attached to a different
node?

I believe this is answered by a question in the FAQ, &quot;What happens to
messages when a network outage removes the route between an exchange and a
bound queue?&quot;, which states that the messages will be silently dropped
unless I set the mandatory flag on basic.publish.

Alas, that is not feasible in our use-case.  We are publishing to a topic
exchange and creating bindings to to match a subset of the published
messages to some durable queues.  Thus, we actually expect many messages to
be routed to no queue.  Even if we set the mandatory flag, we'd not be able
to tell whether the error received by the publisher was a result of no
binding matching the message (a normal condition) or the loss a node, along
with all the queues and bindings associated with it (an exceptional
condition).

Any suggestions on how to handle this issue and distinguish between these
two conditions?

Thanks,

Elias Levy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110621/4232fec2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110621/4232fec2/attachment.htm</A>&gt;
</PRE>





























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013370.html">[rabbitmq-discuss] haigha 0.3.0
</A></li>
	<LI>Next message: <A HREF="013373.html">[rabbitmq-discuss] Persistent messages and durable queue	questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13371">[ date ]</a>
              <a href="thread.html#13371">[ thread ]</a>
              <a href="subject.html#13371">[ subject ]</a>
              <a href="author.html#13371">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
