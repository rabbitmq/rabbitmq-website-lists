<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Fw: high availability solutions?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Fw%3A%20high%20availability%20solutions%3F&In-Reply-To=%3C20110617110845.GA5178%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013313.html">
   <LINK REL="Next"  HREF="013315.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Fw: high availability solutions?</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Fw%3A%20high%20availability%20solutions%3F&In-Reply-To=%3C20110617110845.GA5178%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Fw: high availability solutions?">matthew at rabbitmq.com
       </A><BR>
    <I>Fri Jun 17 12:08:45 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013313.html">[rabbitmq-discuss] Fw: high availability solutions?
</A></li>
        <LI>Next message: <A HREF="013315.html">[rabbitmq-discuss] Fw: high availability solutions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13314">[ date ]</a>
              <a href="thread.html#13314">[ thread ]</a>
              <a href="subject.html#13314">[ subject ]</a>
              <a href="author.html#13314">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jun 17, 2011 at 02:59:39PM +0400, Michael Klishin wrote:
&gt;<i> Does it mean client maintainers should discourage transaction use by
</I>&gt;<i> focusing on publisher confirms and message acknowledgements? It just
</I>&gt;<i> so happens that I am in the process of expanding Ruby amqp gem
</I>&gt;<i> documentation on transactions and their relation to publisher confirms
</I>&gt;<i> &amp; message acknowledgements. I am not sure what to do now.
</I>
There problem with AMQP transactions as they're defined is that they're
essentially useless once you have publisher confirms.

The only compelling use case is if you had a client that wanted to
receive a message, transform it, and republish it as one action. In that
case, wrapping that lot in a transaction makes sense. However, what
you'll immediately notice is that the transaction precludes you from
publishing to a different broker than you received from.

Instead, you should publish with confirms, wait for the confirm, and
then ack the message you received. This allows you to use different
brokers, and allows you to pipeline actions, substantially increasing
performance.

Yes, in the event of a failure of a client, you could end up with
duplicates - the ack could be lost and so that initial message will be
requeued and delivered. But in the event of client (and broker)
failures, there's always the chance of duplicates anyway, and even
transactions do not actually solve this (for one thing, the
implementation of transactions in Rabbit is _not_ atomic).

We would encourage all 3rd party clients to work to support the
extensions to AMQP 0-9-1 that we add. That does not mean that we
recommend you remove functionality that we remove - you can certainly
implement a superset of the functionality. But normally when we add and
remove features, it's because there is some fundamental deficiency that
needs to be addressed and so it's obviously helpful if 3rd party clients
are aware of that.

I hope that helps,

Matthew
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013313.html">[rabbitmq-discuss] Fw: high availability solutions?
</A></li>
	<LI>Next message: <A HREF="013315.html">[rabbitmq-discuss] Fw: high availability solutions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13314">[ date ]</a>
              <a href="thread.html#13314">[ thread ]</a>
              <a href="subject.html#13314">[ subject ]</a>
              <a href="author.html#13314">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
