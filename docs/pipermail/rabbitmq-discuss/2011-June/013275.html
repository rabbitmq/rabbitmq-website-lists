<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] 2.5.0 stomp ssl Windows 2008R2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%202.5.0%20stomp%20ssl%20Windows%202008R2&In-Reply-To=%3C4DF8D81F.60306%40pfgltd.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013376.html">
   <LINK REL="Next"  HREF="013277.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] 2.5.0 stomp ssl Windows 2008R2</H1>
    <B>Sam Domonkos</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%202.5.0%20stomp%20ssl%20Windows%202008R2&In-Reply-To=%3C4DF8D81F.60306%40pfgltd.com%3E"
       TITLE="[rabbitmq-discuss] 2.5.0 stomp ssl Windows 2008R2">sam at pfgltd.com
       </A><BR>
    <I>Wed Jun 15 17:04:47 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013376.html">[rabbitmq-discuss] rabbitmq-lvc-plugin broken with 2.5.0 release
</A></li>
        <LI>Next message: <A HREF="013277.html">[rabbitmq-discuss] 2.5.0 stomp ssl Windows 2008R2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13275">[ date ]</a>
              <a href="thread.html#13275">[ thread ]</a>
              <a href="subject.html#13275">[ subject ]</a>
              <a href="author.html#13275">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Looks like <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Massimo.Paladin at cern.ch</A> is further along in his question.

Maybe I just have ssl setup wrong which I suspect because of the following:
=ERROR REPORT==== 15-Jun-2011::10:22:27 ===
SSL: hello: ./ssl_handshake.erl:247:Fatal error: internal error

I am trying to use the stomp plugin-2.5.0 with ssl (no certificates yet) 
on RabbitMQ-2.5.0 on a Windows 2008R2 server.  I have openssl-32bit 
installed with VS 2008 Redistributables. Stomp with ssl is a requirement 
in our search for the right mq broker.
I know this is not in the docs yet, but I see some unit tests using ssl 
with stomp so just seeing if this is fully functional as of 2.5.0.

Thanks in advance for any direction.
-Sam

################ rabbitmq.config #################################
[
   {rabbitmq_stomp, [{ssl_listeners, [61614]}]},
   {rabbit, [
      {ssl_listeners, [5671]},
      {ssl_options, [{verify,verify_none},
                     {fail_if_no_peer_cert,false}]}
    ]}
].

################ stomp_ssl_test.py ###############################
#!/usr/bin/env python
import stomp # using stomp.py
import time
import logging
import sys
import random
import yaml

logging.basicConfig()

class MyListener(object):
     def on_error(self, headers, message):
         print 'received an error %s' % message

     def on_message(self, headers, message):
         print 'received a message %s' % message

dest='/queue/test'
host='192.168.0.108'
# port=61614
# ssl=True
port=61613
ssl=False
conn=stomp.Connection(host_and_ports=[(host,port)], user='guest', 
passcode='guest',use_ssl=ssl)
print('set up Connection')
conn.set_listener('somename',MyListener())
print('Set up listener')

conn.start()
print('started connection')

conn.connect(wait=True, headers={'login':'guest', 'passcode':'guest'})
print('connected')
conn.subscribe(destination=dest, ack='auto', headers={})
print('subscribed')

message = 'hi'

headers = {'destination':dest,
             'type':'textMessage',
             'id': str(random.randint(0,65535)),
             'routing_key':'xxxxxx'}
conn.send(message=message, destination=dest,headers=headers,ack='auto')
print('sent message')
time.sleep(2)
print('slept')
conn.disconnect()
print('disconnected')

########################## rabbitmq logging 
#######################################

=INFO REPORT==== 15-Jun-2011::10:22:27 ===
accepted TCP connection on 0.0.0.0:61614 from 192.168.0.30:64098

=ERROR REPORT==== 15-Jun-2011::10:22:27 ===
SSL: hello: ./ssl_handshake.erl:247:Fatal error: internal error

=ERROR REPORT==== 15-Jun-2011::10:22:27 ===
** Generic server &lt;0.531.0&gt; terminating
** Last message in was {inet_async,#Port&lt;0.5451&gt;,572,{ok,#Port&lt;0.6286&gt;}}
** When Server state == {state,
                             {rabbit_stomp_sup,start_ssl_client,
                                 [[{verify,verify_none},
                                   {fail_if_no_peer_cert,false}]]},
                             #Port&lt;0.5451&gt;,572}
** Reason for termination ==
** {{badmatch,{error,{ssl_upgrade_error,&quot;internal error&quot;}}},
     [{rabbit_stomp_sup,start_ssl_client,2},
      {tcp_acceptor,handle_info,2},
      {gen_server,handle_msg,5},
      {proc_lib,init_p_do_apply,3}]}
##################################################################################
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013376.html">[rabbitmq-discuss] rabbitmq-lvc-plugin broken with 2.5.0 release
</A></li>
	<LI>Next message: <A HREF="013277.html">[rabbitmq-discuss] 2.5.0 stomp ssl Windows 2008R2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13275">[ date ]</a>
              <a href="thread.html#13275">[ thread ]</a>
              <a href="subject.html#13275">[ subject ]</a>
              <a href="author.html#13275">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
