<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] high availability solutions?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20high%20availability%20solutions%3F&In-Reply-To=%3C4DF746AF.9000204%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013080.html">
   <LINK REL="Next"  HREF="013236.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] high availability solutions?</H1>
    <B>Rob Harrop</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20high%20availability%20solutions%3F&In-Reply-To=%3C4DF746AF.9000204%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] high availability solutions?">rob at rabbitmq.com
       </A><BR>
    <I>Tue Jun 14 12:31:59 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013080.html">[rabbitmq-discuss] high availability solutions?
</A></li>
        <LI>Next message: <A HREF="013236.html">[rabbitmq-discuss] high availability solutions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13234">[ date ]</a>
              <a href="thread.html#13234">[ thread ]</a>
              <a href="subject.html#13234">[ subject ]</a>
              <a href="author.html#13234">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

E R wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I am wondering generally how one architects a rabbitmq system so that
</I>&gt;<i> it is tolerant of a node going down or being taken offline.
</I>&gt;<i>
</I>&gt;<i> Specifically...
</I>&gt;<i>
</I>&gt;<i> 1. Is there ever a need to stop and restart the rabbitmq process, i.e.
</I>&gt;<i> for maintenance, re-configuration, etc.?
</I>
The only real need to stop a rabbit node is for upgrade or to tweak some 
configuration settings.

&gt;<i>
</I>&gt;<i> 2. If there is a need to restart the rabbitmq process, how do people
</I>&gt;<i> generally assure that the queuing system is available when a rabbitmq
</I>&gt;<i> server is down? Put retry code in the client? Have multiple servers
</I>&gt;<i> that the client automatically fails over to?
</I>
You can run a cluster of servers each of which has a copy of the routing 
network set up by your client code.

You can kill one of these nodes, and with retry code in your client, 
have the client failover on to another node in the cluster.

However, in the current version of Rabbit, queue contents are *not* 
clustered - queues reside on a single node. So if you kill a node with a 
queue on it then you will lose any non-persistent messages from that queue.

This is currently being addressed and indeed, we are close to releasing 
our full Active/Active HA queues.

&gt;<i>
</I>&gt;<i> 3. As a solution to the above problem, what about running a &quot;buffering
</I>&gt;<i> queue&quot; in front of a main queue server? This would allow the main
</I>&gt;<i> server to be taken offline for short periods of time while still
</I>&gt;<i> allowing the application to continue inject messages into the queuing
</I>&gt;<i> system. Good idea? overkill? introduces other problems?
</I>
This is certainly not a bad choice, and works quite well with the above 
situation. You simply have a process (which you could run using the 
shovel) that moves messages from your buffer to your backend queues.

At maintenance time, you disable this shovel process, wait for your 
backend queues to be empty and take the backend instances down.

&gt;<i>
</I>&gt;<i> In my particular case latency in the queuing system is not a concern,
</I>&gt;<i> but I don't want to hold up the application if a queuing node goes
</I>&gt;<i> down or is taken offline.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> ER
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013080.html">[rabbitmq-discuss] high availability solutions?
</A></li>
	<LI>Next message: <A HREF="013236.html">[rabbitmq-discuss] high availability solutions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13234">[ date ]</a>
              <a href="thread.html#13234">[ thread ]</a>
              <a href="subject.html#13234">[ subject ]</a>
              <a href="author.html#13234">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
