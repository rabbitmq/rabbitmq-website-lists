<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Persistent messages and durable queue	questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Persistent%20messages%20and%20durable%20queue%0A%09questions&In-Reply-To=%3CBANLkTikBasN97dpS2XaPxh-Mr9rz4Ft-Xg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013373.html">
   <LINK REL="Next"  HREF="013387.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Persistent messages and durable queue	questions</H1>
    <B>Elias Levy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Persistent%20messages%20and%20durable%20queue%0A%09questions&In-Reply-To=%3CBANLkTikBasN97dpS2XaPxh-Mr9rz4Ft-Xg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Persistent messages and durable queue	questions">fearsome.lucidity at gmail.com
       </A><BR>
    <I>Fri Jun 24 18:33:06 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013373.html">[rabbitmq-discuss] Persistent messages and durable queue	questions
</A></li>
        <LI>Next message: <A HREF="013387.html">[rabbitmq-discuss] RabbitMQ broker behind an ELB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13432">[ date ]</a>
              <a href="thread.html#13432">[ thread ]</a>
              <a href="subject.html#13432">[ subject ]</a>
              <a href="author.html#13432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Jun 22, 2011 at 1:15 AM, Rob Harrop &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rob at rabbitmq.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> When there is a consumer ready to receive the message, the message will
</I>&gt;<i> only be written to disk if:
</I>&gt;<i>
</I>&gt;<i> 1. The queue is durable
</I>&gt;<i> 2. The message is peristent
</I>&gt;<i> 3. Automatic ack is disabled
</I>

Rob,

Thanks for your response.  I was afraid that might be the case.  That said,
I've read with interest the discussion on the upcoming HA queue feature.
 It's exactly what we are looking for.  Hopefully it will be release in not
too long a time.


&gt;<i> You can use publisher confirms to allow your application code to know when
</I>&gt;<i> a message has successfully been routed or when it has been lost.
</I>&gt;<i>
</I>&gt;<i> See: <A HREF="http://www.rabbitmq.com/**extensions.html#confirms&lt;http://www.rabbitmq.com/extensions.html#confirms">http://www.rabbitmq.com/**extensions.html#confirms&lt;http://www.rabbitmq.com/extensions.html#confirms</A>&gt;
</I>

Alas, I believe, publisher confirms do not solve the problem. As I stated, I
expect only a subset of the messages published to the topic exchange to have
matching bindings.  Most messages will not be routed anywhere.  Publisher
confirms will return basic.ack for such messages.  That is all well and good
under normal conditions.

But if there is a node with a queue with a binding that matches the message,
and that node goes down, then it is my understanding that the rest of the
cluster will discard the binding since the queue is no longer reachable.  If
that is the case, then publisher confirms will return a basic.ack rather
than a basic.nack.  Thus the publisher will not know that there was a queue
with a binding that matched the message, but its just not available at this
time.

Is my understanding incorrect?

This becomes less of an issue once the HA queues feature is shipped, as I
configure the cluster the deliver the message to a queue even in the face a
configurable number of nodes being down.

Elias Levy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110624/7f65acee/attachment-0001.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20110624/7f65acee/attachment-0001.htm</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013373.html">[rabbitmq-discuss] Persistent messages and durable queue	questions
</A></li>
	<LI>Next message: <A HREF="013387.html">[rabbitmq-discuss] RabbitMQ broker behind an ELB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13432">[ date ]</a>
              <a href="thread.html#13432">[ thread ]</a>
              <a href="subject.html#13432">[ subject ]</a>
              <a href="author.html#13432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
