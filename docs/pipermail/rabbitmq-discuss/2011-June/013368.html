<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] LATEST.LOG growth on clustered ram node
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20LATEST.LOG%20growth%20on%20clustered%20ram%20node&In-Reply-To=%3CABA42E48EC654326B9E2F059573DA9BE%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013366.html">
   <LINK REL="Next"  HREF="013377.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] LATEST.LOG growth on clustered ram node</H1>
    <B>Chris Madden</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20LATEST.LOG%20growth%20on%20clustered%20ram%20node&In-Reply-To=%3CABA42E48EC654326B9E2F059573DA9BE%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] LATEST.LOG growth on clustered ram node">chris.madden at gmail.com
       </A><BR>
    <I>Tue Jun 21 16:18:36 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013366.html">[rabbitmq-discuss] About rabbitmq queue list
</A></li>
        <LI>Next message: <A HREF="013377.html">[rabbitmq-discuss] LATEST.LOG growth on clustered ram node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13368">[ date ]</a>
              <a href="thread.html#13368">[ thread ]</a>
              <a href="subject.html#13368">[ subject ]</a>
              <a href="author.html#13368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> On Mon, Jun 20, 2011 at 06:24:45PM -0400, Chris Madden wrote:
</I>&gt;<i> &gt; In a nutshell, the LATEST.LOG file on my ram clustered node grows, by
</I>&gt;<i> &gt; all accounts, forever. I left it running over the weekend and it was
</I>&gt;<i> &gt; well over 500meg. In the past I've let it run until it consumed all
</I>&gt;<i> &gt; the space on the partition and the broker instance cratered. Running
</I>&gt;<i> &gt; it as a ram node instead of a disc node obviates the problem, but is
</I>&gt;<i> &gt; sub-optimal.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I'm using rabbit 2.5.0, though I've seen the problem on 2.4.0 and
</I>&gt;<i> &gt; 2.4.1. The OS is linux based (2.6.32), and our Erlang version is R14A.
</I>&gt;<i> 
</I>&gt;<i> Very interesting. I've not heard of that one before and it certainly
</I>&gt;<i> points to an mnesia issue. R14A is a beta release and I would strongly
</I>&gt;<i> point an accusing finger at that first. Please try the latest Erlang
</I>&gt;<i> R14B03.
</I>&gt;<i> 
</I>&gt;<i> Matthew
</I>&gt;<i> 
</I>&gt;<i> 
</I> I upgraded our erlang version to R14B03, but the LATEST.LOG still continues to be growing, albeit, more slowly perhaps? 

I'm kind of suspicious of one of the queue usage models I'm using. When one of the processes needs to make a one-off request (rpc like), it creates a queue dedicated to that request, and expects the reply to come back on that queue. After a timeout or the response is delivered, the queue is taken down. As a result, we have queues come and go a few times a minute... not really ideal, but it helps with debugging. Beyond this, I think the rabbit setup is pretty standard. Any ideas?


Below is the status/cluster_status output, in case it points at something obvious:

drone:0:~ # rabbitmqctl status
Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at drone</A> ...
[{pid,12348},
{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;2.5.0&quot;},
{os_mon,&quot;CPO CXC 138 46&quot;,&quot;2.2.6&quot;},
{sasl,&quot;SASL CXC 138 11&quot;,&quot;2.1.9.4&quot;},
{mnesia,&quot;MNESIA CXC 138 12&quot;,&quot;4.4.19&quot;},
{stdlib,&quot;ERTS CXC 138 10&quot;,&quot;1.17.4&quot;},
{kernel,&quot;ERTS CXC 138 10&quot;,&quot;2.14.4&quot;}]},
{os,{unix,linux}},
{erlang_version,&quot;Erlang R14B03 (erts-5.8.4) [source] [64-bit] [smp:4:4] [rq:4] [async-threads:30] [hipe] [kernel-poll:true]\n&quot;},
{memory,[{total,30529744},
{processes,10871688},
{processes_used,10849544},
{system,19658056},
{atom,1114745},
{atom_used,1105101},
{binary,4144112},
{code,11021554},
{ets,1404144}]}]
...done.

drone:0:~ # rabbitmqctl cluster_status
Cluster status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at drone</A> ...
[{nodes,[{disc,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at controller</A>]},{ram,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at drone</A>]}]},
{running_nodes,[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at controller</A><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at drone</A>]}]
...done.

</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013366.html">[rabbitmq-discuss] About rabbitmq queue list
</A></li>
	<LI>Next message: <A HREF="013377.html">[rabbitmq-discuss] LATEST.LOG growth on clustered ram node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13368">[ date ]</a>
              <a href="thread.html#13368">[ thread ]</a>
              <a href="subject.html#13368">[ subject ]</a>
              <a href="author.html#13368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
