<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Consumer setup performance / starvation issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20setup%20performance%20/%20starvation%20issue&In-Reply-To=%3C4DFF9E01.1050309%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013353.html">
   <LINK REL="Next"  HREF="013358.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Consumer setup performance / starvation issue</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Consumer%20setup%20performance%20/%20starvation%20issue&In-Reply-To=%3C4DFF9E01.1050309%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Consumer setup performance / starvation issue">matthias at rabbitmq.com
       </A><BR>
    <I>Mon Jun 20 20:22:41 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013353.html">[rabbitmq-discuss] Consumer setup performance / starvation issue
</A></li>
        <LI>Next message: <A HREF="013358.html">[rabbitmq-discuss] Consumer setup performance / starvation issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13356">[ date ]</a>
              <a href="thread.html#13356">[ thread ]</a>
              <a href="subject.html#13356">[ subject ]</a>
              <a href="author.html#13356">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Etrik,

On 20/06/11 19:55, flzz wrote:
&gt;<i> Yup, certainly does change the behavior.  I put a 1ms sleep before the
</I>&gt;<i> ack and all the workers establish a full consumer connection in a
</I>&gt;<i> reasonable amount of time.
</I>
Excellent.

Currently rabbit queues prioritise certain operations over others. There 
are good reasons for doing that which I don't want you to bore with, but 
the outcome in this case is that when a set of workers can keep up with 
the flow of messages dispatched to them by a queue, then additional 
workers may get starved.

Note that when this happens the additional workers wouldn't actually 
result in the work getting processed more quickly, even if they were 
getting messages.

Nevertheless, this behaviour is undesirable, so I've filed a bug to fix it.

Thanks for reporting this! It's interesting that you are the first 
person to spot the issue even though the behaviour has been like this 
for years. I guess most users either run fewer workers than you or their 
workers spend longer processing each message.


Regards,

Matthias.
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013353.html">[rabbitmq-discuss] Consumer setup performance / starvation issue
</A></li>
	<LI>Next message: <A HREF="013358.html">[rabbitmq-discuss] Consumer setup performance / starvation issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13356">[ date ]</a>
              <a href="thread.html#13356">[ thread ]</a>
              <a href="subject.html#13356">[ subject ]</a>
              <a href="author.html#13356">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
