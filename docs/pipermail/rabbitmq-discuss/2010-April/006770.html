<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] java client swallows interrupts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20java%20client%20swallows%20interrupts&In-Reply-To=c26271fb1003180358j67f500b1yd3ffff9ba934535c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006769.html">
   <LINK REL="Next"  HREF="006771.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] java client swallows interrupts</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20java%20client%20swallows%20interrupts&In-Reply-To=c26271fb1003180358j67f500b1yd3ffff9ba934535c%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] java client swallows interrupts">matthew at lshift.net
       </A><BR>
    <I>Fri Apr  2 16:11:39 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006769.html">[rabbitmq-discuss] rabbits rabbits
</A></li>
        <LI>Next message: <A HREF="006771.html">[rabbitmq-discuss] sub-request a message using a message batch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6770">[ date ]</a>
              <a href="thread.html#6770">[ thread ]</a>
              <a href="subject.html#6770">[ subject ]</a>
              <a href="author.html#6770">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Anton,

Sorry for the slow reply.

On Thu, Mar 18, 2010 at 01:58:13PM +0300, mabrek wrote:
&gt;<i> I came across java client issue: it clears thread interrupted status
</I>&gt;<i> and/or swallows InterruptedException in Channel operations (close,
</I>&gt;<i> basicPublish) and Connection.close, maybe in others.
</I>&gt;<i> It creates a problem when I need to stop consumer thread pool by
</I>&gt;<i> issuing ExecutorService.shutdownNow, they won't stop.
</I>
Yup, I think this is the catch in the quiescingTransmit method in
com/rabbitmq/client/impl/AMQChannel.java

Of course, I'd actually recommend that you shutdown by closing the
consumers, channels and connections down explicitly rather than just
trying to kill off the threads. The Javadoc for shutdownNow does say:
&quot;There are no guarantees beyond best-effort attempts to stop processing
actively executing tasks&quot;

Is there a reason why you can't more gracefully shutdown the threads?

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006769.html">[rabbitmq-discuss] rabbits rabbits
</A></li>
	<LI>Next message: <A HREF="006771.html">[rabbitmq-discuss] sub-request a message using a message batch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6770">[ date ]</a>
              <a href="thread.html#6770">[ thread ]</a>
              <a href="subject.html#6770">[ subject ]</a>
              <a href="author.html#6770">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
