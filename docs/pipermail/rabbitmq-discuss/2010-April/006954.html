<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] erlang 1.6.0 client possible problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20erlang%201.6.0%20client%20possible%20problem&In-Reply-To=20100422165849.GB5655%40mrnibble.lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006953.html">
   <LINK REL="Next"  HREF="006956.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] erlang 1.6.0 client possible problem</H1>
    <B>Mark Geib</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20erlang%201.6.0%20client%20possible%20problem&In-Reply-To=20100422165849.GB5655%40mrnibble.lshift.net"
       TITLE="[rabbitmq-discuss] erlang 1.6.0 client possible problem">mark.geib at echostar.com
       </A><BR>
    <I>Thu Apr 22 19:43:14 BST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006953.html">[rabbitmq-discuss] erlang 1.6.0 client possible problem
</A></li>
        <LI>Next message: <A HREF="006956.html">[rabbitmq-discuss] erlang 1.6.0 client possible problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6954">[ date ]</a>
              <a href="thread.html#6954">[ thread ]</a>
              <a href="subject.html#6954">[ subject ]</a>
              <a href="author.html#6954">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Matthew,

Followup question. Will the 1.7.x erlang client work with 1.6.0 brokers.?

I have also tried to use the erlang client tagged with the broker
version number.

Mark.

On 04/22/2010 10:58 AM, Matthew Sackman wrote:
&gt;<i> Hi Mark,
</I>&gt;<i>
</I>&gt;<i> Needless to say, 1.6.0 is pretty ancient and we'd recommend that
</I>&gt;<i> you upgrade to the latest 1.7.2, where lib_amqp has vanished, and
</I>&gt;<i> the problem you're reporting has been abstracted away by the
</I>&gt;<i> library.
</I>&gt;<i>
</I>&gt;<i> On Thu, Apr 22, 2010 at 10:36:07AM -0600, Mark Geib wrote:
</I>&gt;&gt;<i> case lib_amqp:get(Channel, Queue, false) of basic.get_emtpy -&gt;
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> {DeliveryTag, Content} -&gt; #content{payload_fragments_rev =
</I>&gt;&gt;<i> Payload, class_id = ClassId, properties_bin = Props} = Content,
</I>&gt;&gt;<i> Message = list_to_binary(Payload),
</I>&gt;<i>
</I>&gt;<i> The clue is in the name ;) payload_fragments_rev is a *reversed*
</I>&gt;<i> list of fragments. Thus you'll need to reverse it first. The reason
</I>&gt;<i> this only affects you with large messages is that smaller messages
</I>&gt;<i> will be under the max frame size, and thus will only be a single
</I>&gt;<i> fragment.
</I>&gt;<i>
</I>&gt;<i> Just ftr, if you do upgrade to 1.7.2, the API is now:
</I>&gt;<i>
</I>&gt;<i> {#'basic.get_ok'{}, #amqp_msg{payload = Payload}} =
</I>&gt;<i> amqp_channel:call(Channel, #'basic.get'{queue = Q, no_ack =
</I>&gt;<i> false}),
</I>&gt;<i>
</I>&gt;<i> There, Payload is a single binary, not reversed, and not a list,
</I>&gt;<i> thus all the work has been done for you.
</I>&gt;<i>
</I>&gt;<i> Best wishes,
</I>&gt;<i>
</I>&gt;<i> Matthew
</I>
- -- 
Principal Engineer
Cheyenne Software Engineering
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mark.geib at echostar.com</A> / 35-215

PGP fingerprint:6DFC 389D 9796 0188 92E5 58F5 34C5 6B47 D091 76FD
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org/">http://enigmail.mozdev.org/</A>

iEYEARECAAYFAkvQmMIACgkQNMVrR9CRdv2jWQCfYxKz6uns4tXcojEXFoeovgxb
uNIAnRhFVhazu02sOqR22dfyxTsq8E+s
=4ncH
-----END PGP SIGNATURE-----



</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006953.html">[rabbitmq-discuss] erlang 1.6.0 client possible problem
</A></li>
	<LI>Next message: <A HREF="006956.html">[rabbitmq-discuss] erlang 1.6.0 client possible problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6954">[ date ]</a>
              <a href="thread.html#6954">[ thread ]</a>
              <a href="subject.html#6954">[ subject ]</a>
              <a href="author.html#6954">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
