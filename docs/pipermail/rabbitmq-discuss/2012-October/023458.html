<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] cluster reboot of death
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20cluster%20reboot%20of%20death&In-Reply-To=%3C79c287d0-f76e-482b-884c-97fb7a27cc7b%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023461.html">
   <LINK REL="Next"  HREF="023462.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] cluster reboot of death</H1>
    <B>Mark Ward</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20cluster%20reboot%20of%20death&In-Reply-To=%3C79c287d0-f76e-482b-884c-97fb7a27cc7b%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] cluster reboot of death">ward.mark at gmail.com
       </A><BR>
    <I>Tue Oct 30 18:52:41 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023461.html">[rabbitmq-discuss] RabbitMQ .net client KeepAlive for RMQ behind a load balancer
</A></li>
        <LI>Next message: <A HREF="023462.html">[rabbitmq-discuss] ANN amqp gem docs have moved to rubyamqp.info
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23458">[ date ]</a>
              <a href="thread.html#23458">[ thread ]</a>
              <a href="subject.html#23458">[ subject ]</a>
              <a href="author.html#23458">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The scenario:

Maintenance on servers in a cluster require server restart.  When each 
server is restarted the next oldest node will be come master of the 
orphaned queues made by the restart. This will continue to happen until the 
last server is the master of all queues.  (ignoring newly created queues 
during maintenance.)  Idle queues with data would be left not synchronized 
and the data would only exist on the master server.  The problem now is the 
last server cannot be restarted or else the rest of the cluster will derive 
a new master for the queues and the idle data would be lost.  Active queues 
will eventually work out and become synchronized in the cluster.  Idle 
queues create a problem.

It appears server maintenance can't be scheduled but is at the mercy of the 
cluster's queues.  If there are idle queues best not perform maintenance 
when synchronized mirrored nodes is down to low &quot;watermark&quot;?  Stagger 
server maintenance in a way that there are frequent update servers and less 
update servers to balance out the cluster?

What is the best way to handle cluster server maintenance?   Is there a way 
to manage an idle queue in a cluster, possibly shuffle it between servers?

-Mark





-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121030/77407882/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121030/77407882/attachment.htm</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023461.html">[rabbitmq-discuss] RabbitMQ .net client KeepAlive for RMQ behind a load balancer
</A></li>
	<LI>Next message: <A HREF="023462.html">[rabbitmq-discuss] ANN amqp gem docs have moved to rubyamqp.info
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23458">[ date ]</a>
              <a href="thread.html#23458">[ thread ]</a>
              <a href="subject.html#23458">[ subject ]</a>
              <a href="author.html#23458">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
