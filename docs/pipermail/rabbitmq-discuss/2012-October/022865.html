<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] memory flow control
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20memory%20flow%20control&In-Reply-To=%3CCACx7p4AWe_qG%2Bjoee2a3JFYsWVib6S-bKXmAaLcSLuqVX7Likg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022846.html">
   <LINK REL="Next"  HREF="022833.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] memory flow control</H1>
    <B>Raviv Pavel</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20memory%20flow%20control&In-Reply-To=%3CCACx7p4AWe_qG%2Bjoee2a3JFYsWVib6S-bKXmAaLcSLuqVX7Likg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] memory flow control">raviv at gigya-inc.com
       </A><BR>
    <I>Thu Oct  4 16:44:22 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022846.html">[rabbitmq-discuss] memory flow control
</A></li>
        <LI>Next message: <A HREF="022833.html">[rabbitmq-discuss] Memory watermark alert not resetting.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22865">[ date ]</a>
              <a href="thread.html#22865">[ thread ]</a>
              <a href="subject.html#22865">[ subject ]</a>
              <a href="author.html#22865">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Because it's not slower - it's blocked and the SDK doesn't allow me to
specify a timeout.
So once a rabbit node gets clogged with unacked messages and hits it's
memory watermark, any thread in my app trying to publish will get blocked
forever.
I've been looking at the source for the .NET SDK (which w'ere using) and it
blocks on flushing to the TCP stream.
I ended up modifying the SDK to set a send timeout on the socket, so when
the server blocks producers, I get an exception after 2 seconds instead of
being blocked.

Thanks
*--*Raviv
*
*



On Thu, Oct 4, 2012 at 4:54 PM, Matthias Radestock &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>&gt;wrote:

&gt;<i> On 04/10/12 11:47, Raviv Pavel wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I think I've read somewhere that it's not currently possible.
</I>&gt;&gt;<i> I need the same thing :(
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Tuesday, September 25, 2012 11:47:18 PM UTC+2, Dmitriy Stolyarov
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Hi,
</I>&gt;&gt;<i>     Is there a way to have the producer throw an exception instead of
</I>&gt;&gt;<i>     just being blocked when high memory water mark is reached on the
</I>&gt;&gt;<i>     server? (Using java client)
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Why you would want to treat this condition any different from a network
</I>&gt;<i> delay/disruption or a slow server?
</I>&gt;<i>
</I>&gt;<i> It possible to detect that, indirectly, using a technique I described in
</I>&gt;<i> <A HREF="http://rabbitmq.1065348.n5.**nabble.com/Memory-Management-**">http://rabbitmq.1065348.n5.**nabble.com/Memory-Management-**</A>
</I>&gt;<i> Concerns-Questions-**tp13225p13233.html&lt;<A HREF="http://rabbitmq.1065348.n5.nabble.com/Memory-Management-Concerns-Questions-tp13225p13233.html">http://rabbitmq.1065348.n5.nabble.com/Memory-Management-Concerns-Questions-tp13225p13233.html</A>&gt;(which I shall henceforth call &quot;user level EWOULDBLOCK&quot; ;)
</I>&gt;<i>
</I>&gt;<i> Matthias.
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121004/dbd7270e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121004/dbd7270e/attachment.htm</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022846.html">[rabbitmq-discuss] memory flow control
</A></li>
	<LI>Next message: <A HREF="022833.html">[rabbitmq-discuss] Memory watermark alert not resetting.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22865">[ date ]</a>
              <a href="thread.html#22865">[ thread ]</a>
              <a href="subject.html#22865">[ subject ]</a>
              <a href="author.html#22865">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
