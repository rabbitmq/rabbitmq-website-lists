<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] What can cause mnesia partitioning?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20What%20can%20cause%20mnesia%20partitioning%3F&In-Reply-To=%3CCALKcMwLx8N1KgbXjDpSKAAPX8szouTxMJCof3%2BYcF%2BJm0oOCBQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023014.html">
   <LINK REL="Next"  HREF="023045.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] What can cause mnesia partitioning?</H1>
    <B>tsuraan</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20What%20can%20cause%20mnesia%20partitioning%3F&In-Reply-To=%3CCALKcMwLx8N1KgbXjDpSKAAPX8szouTxMJCof3%2BYcF%2BJm0oOCBQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] What can cause mnesia partitioning?">tsuraan at gmail.com
       </A><BR>
    <I>Fri Oct 12 19:06:07 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023014.html">[rabbitmq-discuss] RabbitMQ Examples/Libraries and Visual Studio 2012 .Net C#
</A></li>
        <LI>Next message: <A HREF="023045.html">[rabbitmq-discuss] What can cause mnesia partitioning?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23015">[ date ]</a>
              <a href="thread.html#23015">[ thread ]</a>
              <a href="subject.html#23015">[ subject ]</a>
              <a href="author.html#23015">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We had a pair of computers running a rabbit cluster, and somehow their
mnesia databases diverged.  Each computer was running its own rabbit
happily, but they both had cluster_status messages showing only
themselves as the only &quot;running&quot; node, and they both had log messages
to the effect of:

Mnesia('<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at node-1</A>'): ** ERROR ** mnesia_event got
{inconsistent_database, starting_partitioned_network, '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at node-2</A>'}

I restarted both rabbit instances, and they both came up in an
apparently functional single-node instance (cluster_status on each
still showed the other node as a disc node, but not as a running
node).  From my reading of <A HREF="http://www.rabbitmq.com/clustering.html,">http://www.rabbitmq.com/clustering.html,</A> it
doesn't seem like that should happen, unless each node was somehow
convinced that it was the most up to date disc node.  Otherwise, one
of the nodes should have waited 30 seconds for the other one, and then
crashed if it couldn't be reached, right?  What sort of circumstances
would cause both nodes to think they were the most up to date, and
that they should continue running on their own?

Along that line, is there any way to configure a rabbit node to only
run if it can contact a strict majority of disc nodes?  I think that
would make this sort of problem less likely to happen, assuming the
problem stems from a network partition, or perhaps even from some
period of time where each machine was running while the other was not.
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023014.html">[rabbitmq-discuss] RabbitMQ Examples/Libraries and Visual Studio 2012 .Net C#
</A></li>
	<LI>Next message: <A HREF="023045.html">[rabbitmq-discuss] What can cause mnesia partitioning?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23015">[ date ]</a>
              <a href="thread.html#23015">[ thread ]</a>
              <a href="subject.html#23015">[ subject ]</a>
              <a href="author.html#23015">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
