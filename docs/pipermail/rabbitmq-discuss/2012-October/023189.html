<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20consumers%20are%20blocked%20on%0A%09SocketInputStream.socketRead0&In-Reply-To=%3C508150EB.2010108%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023175.html">
   <LINK REL="Next"  HREF="023191.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20consumers%20are%20blocked%20on%0A%09SocketInputStream.socketRead0&In-Reply-To=%3C508150EB.2010108%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0">tim at rabbitmq.com
       </A><BR>
    <I>Fri Oct 19 14:08:59 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023175.html">[rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0
</A></li>
        <LI>Next message: <A HREF="023191.html">[rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23189">[ date ]</a>
              <a href="thread.html#23189">[ thread ]</a>
              <a href="subject.html#23189">[ subject ]</a>
              <a href="author.html#23189">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

Please do not use the google group, as we do not own or subscribe to it. 
Thanks!

In terms of your question, please see my comments inline (below).

On 10/18/2012 04:50 PM, Nicolas Bosansky wrote:
&gt;<i> Hello,
</I>&gt;<i> We have a rabbitMQ consumer that takes messages from a queue and write 
</I>&gt;<i> them in a HBase store.
</I>&gt;<i> When HBase connection fails, the consumer get an exception and 
</I>&gt;<i> messages are not acknowledged, that's ok.
</I>&gt;<i> After a few minutes, the consumer doesn't get messages anymore, even 
</I>&gt;<i> after restarting Hbase.
</I>&gt;<i>
</I>
Firstly, I don't really understand what you're describing here. What 
does the HBase connection failure have to do with the rabbitmq consumer? 
Are you saying that the HBase connection failure causes an unhandled 
exception on the thread which the consumer is running in? What does this 
have to do with acks - are you saying that your client code does not ack 
messages which arrive that cannot be written to HBase? That's fine, but 
you ought to nack/reject them unless you're hanging on to them 
deliberately in order to deal with them later on. Perhaps this is what 
is causing the problem?

&quot;If a consumer dies without sending an acknowledgement the AMQP broker 
will redeliver it to another consumer or, if none are available at the 
time, the broker will wait until at least one consumer is registered for 
the same queue before attempting redelivery.&quot; - 
<A HREF="http://www.rabbitmq.com/tutorials/amqp-concepts.html">http://www.rabbitmq.com/tutorials/amqp-concepts.html</A>

So if you do not ack the messages you've already received *nor* 
nack/reject them, then you're not going to get any more messages until 
you do? Am I missing something here, or are you just not instructing the 
broker that you're ready to continue consuming from the queue (by 
dealing with the messages it has already sent you which need to be 
ack'ed or rejected)?

&gt;<i> When debugging rabbitMQ client, we have noticed, that it is blocked on 
</I>&gt;<i> the following line: SocketInputStream:129 ( Java build 1.6.0_33-b03)
</I>&gt;<i> The Frame class is waiting for messages, but the used socket doesn't 
</I>&gt;<i> receive any data anymore.
</I>&gt;<i> We also notice, that there is no timeout on this socket.
</I>&gt;<i>
</I>
There isn't meant to be a timeout when reading frames.
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023175.html">[rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0
</A></li>
	<LI>Next message: <A HREF="023191.html">[rabbitmq-discuss] Queue consumers are blocked on	SocketInputStream.socketRead0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23189">[ date ]</a>
              <a href="thread.html#23189">[ thread ]</a>
              <a href="subject.html#23189">[ subject ]</a>
              <a href="author.html#23189">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
