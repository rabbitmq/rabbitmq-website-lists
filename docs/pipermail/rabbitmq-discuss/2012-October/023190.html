<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] STOMP plugin - durable subscription	limitation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20plugin%20-%20durable%20subscription%0A%09limitation&In-Reply-To=%3C50815415.8090308%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023164.html">
   <LINK REL="Next"  HREF="023193.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] STOMP plugin - durable subscription	limitation</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20STOMP%20plugin%20-%20durable%20subscription%0A%09limitation&In-Reply-To=%3C50815415.8090308%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] STOMP plugin - durable subscription	limitation">emile at rabbitmq.com
       </A><BR>
    <I>Fri Oct 19 14:22:29 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023164.html">[rabbitmq-discuss] STOMP plugin - durable subscription limitation
</A></li>
        <LI>Next message: <A HREF="023193.html">[rabbitmq-discuss] STOMP plugin - durable subscription	limitation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23190">[ date ]</a>
              <a href="thread.html#23190">[ thread ]</a>
              <a href="subject.html#23190">[ subject ]</a>
              <a href="author.html#23190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Michael,

On 18/10/12 17:11, Michael Justin wrote:
&gt;<i> However, RabbitMQ uses the id header differently for topic 
</I>&gt;<i> subscriptions. Sending and receiving requires to set the same value, so 
</I>&gt;<i> that consumers are not able to assign any random identifier in the 
</I>&gt;<i> SUBSCRIBE frame. Is this correct so far and as designed?
</I>
Consumers are able to assign arbitrary values in the id header when
subscribing with any kind of destination, precisely for the reason that
you need: so that messages delivered for that subscription can be
matched up.

Unless I'm misunderstanding your question, your examples even show that
this works. The subscriptions with id
{F09BD8A4-0C7B-4830-B4B5-B3F5D76E5A7C} has messages delivered with the
same value in the subscription: header. Likewise with the subscription
containing &quot;durable-subscription-name&quot; as the value of the id header.
The delivered message has &quot;durable-subscription-name&quot; in the
subscription header so that the client can match the message up with the
subscription.

&gt;<i> This has the effect that a client can not handle more than one consumer 
</I>&gt;<i> for the same durable subscription because a SUBSCRIBE frame can not use 
</I>&gt;<i> a client-side assigned identifier in the same way and use it to route 
</I>&gt;<i> incoming messages based on this id between internal 'consumers'.
</I>
This is what the &quot;id:&quot; and &quot;subscription:&quot; headers were designed for.

&gt;<i> Example:
</I>&gt;<i> 
</I>&gt;<i> 2. RabbitMQ with durable subscription
</I>&gt;<i> 
</I>&gt;<i> SUBSCRIBE
</I>&gt;<i> destination:/topic/TOOL.DEFAULT
</I>&gt;<i> receipt:yes
</I>&gt;<i> ack:auto
</I>&gt;<i> id:durable-subscription-name
</I>
This value ^

&gt;<i> persistent:true
</I>&gt;<i> 
</I>&gt;<i> received:
</I>&gt;<i> MESSAGE
</I>&gt;<i> receipt:receipt
</I>&gt;<i> persistent:true
</I>&gt;<i> content-type:text/plain
</I>&gt;<i> subscription:durable-subscription-name
</I>
is the same as this one ^

&gt;<i> destination:/topic/TOOL.DEFAULT
</I>&gt;<i> message-id:T_durable-subscription-name@@session-whuoJn95NxH3Ic-lQIr-Wl@@1
</I>&gt;<i> content-length:9
</I>
&gt;<i> The STOMP 1.0 specification says:
</I>&gt;<i> 
</I>&gt;<i> &quot;You can also specify an id header which can then later on be used to 
</I>&gt;<i> UNSUBSCRIBE from the specific subscription as you may end up with 
</I>&gt;<i> overlapping subscriptions using selectors with the same destination.&quot;
</I>
As far as I can see RabbitMQ fully adheres to the spec, which also says
of MESSAGE frames: &quot;The subscription header will be set to match the id
header of the subscription that is receiving the message&quot;.

&gt;<i> In RabbitMQ however, overlapping subscriptions seem to be impossible for 
</I>&gt;<i> a durable topic, as there is no way to specify unique values for the id. 
</I>&gt;<i> Is this correct?
</I>
If I'm misunderstanding your question then please send another
illustration that shows what information is missing. Is the problem with
the STOMP spec or with the RabbitMQ implementation of it?



-Emile

</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023164.html">[rabbitmq-discuss] STOMP plugin - durable subscription limitation
</A></li>
	<LI>Next message: <A HREF="023193.html">[rabbitmq-discuss] STOMP plugin - durable subscription	limitation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23190">[ date ]</a>
              <a href="thread.html#23190">[ thread ]</a>
              <a href="subject.html#23190">[ subject ]</a>
              <a href="author.html#23190">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
