<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Web Management Plugin Sluggishness
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Web%20Management%20Plugin%20Sluggishness&In-Reply-To=%3CCAHW0W4NTLsb8_RCFvac56q8G-OmkQcyb9X%2B9yvxSa5FuyCjp3w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023198.html">
   <LINK REL="Next"  HREF="023201.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Web Management Plugin Sluggishness</H1>
    <B>Dave Seltzer</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Web%20Management%20Plugin%20Sluggishness&In-Reply-To=%3CCAHW0W4NTLsb8_RCFvac56q8G-OmkQcyb9X%2B9yvxSa5FuyCjp3w%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Web Management Plugin Sluggishness">dseltzer at tveyes.com
       </A><BR>
    <I>Fri Oct 19 17:51:43 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023198.html">[rabbitmq-discuss] Web Management Plugin Sluggishness
</A></li>
        <LI>Next message: <A HREF="023201.html">[rabbitmq-discuss] Web Management Plugin Sluggishness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23200">[ date ]</a>
              <a href="thread.html#23200">[ thread ]</a>
              <a href="subject.html#23200">[ subject ]</a>
              <a href="author.html#23200">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Simon,

Running that revealed that both of my RabbitMQ servers are equally slow:

The output shows:
[{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">1966992,rabbit at queue02</A>},{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">1302805,rabbit at queue01</A>}]
...done.

I believe this means that data took 1.9 seconds from egressqueue02 and 1.3
seconds from egressqueue01.

In terms of looking for the cause of the slowness is this usually related
to DiskIO, or am I looking at a CPU issue.

Thanks!

-Dave


On Fri, Oct 19, 2012 at 12:41 PM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;wrote:

&gt;<i> In 2.8.x (and prior), /api/nodes will make an RPC call to each node in
</I>&gt;<i> turn to get the node-specific stats. If one node is heavily loaded or slow
</I>&gt;<i> in responding for whatever reason this will mean /api/nodes will take a
</I>&gt;<i> long time to return.
</I>&gt;<i>
</I>&gt;<i> This has changed on default already, for basically the reason you're
</I>&gt;<i> running into, and the nodes emit stats events for the management DB to pick
</I>&gt;<i> up.
</I>&gt;<i>
</I>&gt;<i> If you invoke:
</I>&gt;<i>
</I>&gt;<i> rabbitmqctl eval '[timer:tc(fun () -&gt; rabbit_mgmt_external_stats:**info(N),
</I>&gt;<i> N end) || N &lt;- rabbit_mnesia:running_**clustered_nodes()].'
</I>&gt;<i>
</I>&gt;<i> (all one line)
</I>&gt;<i>
</I>&gt;<i> then rabbitmqctl will make all these RPC calls and time them (the times
</I>&gt;<i> are in microseconds). That might let you know if you have a problem node.
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> On 19/10/12 17:26, Dave Seltzer wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Digging a little bit deeper, the symptom I'm seeing is that it's taking
</I>&gt;&gt;<i> a while to load key json data from the http API.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Specifically: <A HREF="_http://queue01:55672/api/**nodes_&lt;http://queue01:55672/api/nodes_">_http://queue01:55672/api/**nodes_&lt;http://queue01:55672/api/nodes_</A>&gt;is taking more than 3
</I>&gt;&gt;<i> seconds to load.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is anyone aware of what would cause this slowness?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Dave
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Fri, Oct 19, 2012 at 11:47 AM, Dave Seltzer &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dseltzer at tveyes.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dseltzer at tveyes.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     We have a number of RabbitMQ clusters in our environment. Recently
</I>&gt;&gt;<i>     I&#8217;ve started rolling out some new HA Clusters running RabbitMQ 2.8.7
</I>&gt;&gt;<i>     on Erlang R15B02 in Centos.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     In the most recent version of RabbitMQ we&#8217;re seeing some significant
</I>&gt;&gt;<i>     sluggishness in the Web Management Plugin. It almost seems like it&#8217;s
</I>&gt;&gt;<i>     javascript related because the whole browser (Chrome) gets a bit
</I>&gt;&gt;<i>     sluggish.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Is anyone else seeing this?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     We have introduced one other change which is that I&#8217;ve switched from
</I>&gt;&gt;<i>     HAProxy to Zen Load Balancer. I don&#8217;t think this has anything to do
</I>&gt;&gt;<i>     with it though, because when I test against an individual server I
</I>&gt;&gt;<i>     still get sluggishness.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     -Dave
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Dave Seltzer &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dseltzer at tveyes.com</A>&gt;
</I>&gt;&gt;<i> Chief Systems Architect
</I>&gt;&gt;<i> TVEyes
</I>&gt;&gt;<i> (203) 254-3600 x222
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ______________________________**_________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.</A>**rabbitmq.com&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/**cgi-bin/mailman/listinfo/**rabbitmq-discuss&lt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i>
</I>


-- 
Dave Seltzer &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">dseltzer at tveyes.com</A>&gt;
Chief Systems Architect
TVEyes
(203) 254-3600 x222
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121019/018fc0ce/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121019/018fc0ce/attachment.htm</A>&gt;
</PRE>


















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023198.html">[rabbitmq-discuss] Web Management Plugin Sluggishness
</A></li>
	<LI>Next message: <A HREF="023201.html">[rabbitmq-discuss] Web Management Plugin Sluggishness
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23200">[ date ]</a>
              <a href="thread.html#23200">[ thread ]</a>
              <a href="subject.html#23200">[ subject ]</a>
              <a href="author.html#23200">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
