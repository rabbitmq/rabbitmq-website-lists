<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Errors starting RabbitMQ when cluster membership changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Errors%20starting%20RabbitMQ%20when%20cluster%0A%20membership%20changes&In-Reply-To=%3CCACLE7iyWe0g-i50yB%2BhT6c%2BSwpLyqDTEEupYN2%3D4XePp02A28A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022754.html">
   <LINK REL="Next"  HREF="022771.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Errors starting RabbitMQ when cluster membership changes</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Errors%20starting%20RabbitMQ%20when%20cluster%0A%20membership%20changes&In-Reply-To=%3CCACLE7iyWe0g-i50yB%2BhT6c%2BSwpLyqDTEEupYN2%3D4XePp02A28A%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Errors starting RabbitMQ when cluster membership changes">mpietrek at skytap.com
       </A><BR>
    <I>Mon Oct  1 18:07:11 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022754.html">[rabbitmq-discuss] Errors starting RabbitMQ when cluster membership changes
</A></li>
        <LI>Next message: <A HREF="022771.html">[rabbitmq-discuss] Errors starting RabbitMQ when cluster	membership changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22770">[ date ]</a>
              <a href="thread.html#22770">[ thread ]</a>
              <a href="subject.html#22770">[ subject ]</a>
              <a href="author.html#22770">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Tim,

I was expecting that basic response. Thanks!

However... I still think there may an issue here that hinders RabbitMQ's
deployment in production scenarios. Please correct me if I'm wrong or
missing something.

Hypothetically, what would happen if my 'util' node was zapped by lightning
and I had no way to bring it up in a timely manner. Would I be able to
start the existing cluster nodes (play, play2) &quot;far enough&quot; to run the
proper rabbitmqctl command to remove util from the cluster?

That is, once I've gotten into a bad situation, can I back out of it
gracefully and without message loss? Or is the only option to reset the
entire cluster?

Thanks,

Matt
On Mon, Oct 1, 2012 at 3:04 AM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:

&gt;<i>  Hi Matt,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 09/28/2012 08:23 PM, Matt Pietrek wrote:
</I>&gt;<i>
</I>&gt;<i> For example, at one point I had a three node cluster: play, play2, and
</I>&gt;<i> util. I then removed util from the cluster, although to be honest, simply
</I>&gt;<i> by changing the rabbitmq.config file, rather than explicitly running
</I>&gt;<i> rabbitmqctl stop_app while the cluster is still running.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm pretty sure you're not supposed to do that! :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My steps:
</I>&gt;<i>
</I>&gt;<i>    - Running as three node cluster, stop all brokers
</I>&gt;<i>    - Create a new rabbitmq.config file with just two brokers
</I>&gt;<i>    - Attempt to start the new cluster.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If you don't take util offline using the right procedure, I suspect mnesia
</I>&gt;<i> will get out of sorts and this isn't something you want to happen. It's
</I>&gt;<i> important to make cluster changes using the right procedure, as mnesia is
</I>&gt;<i> rather a fussy beast.
</I>&gt;<i>
</I>&gt;<i> BTW we've made some improvements that (hopefully) simplify working with
</I>&gt;<i> clusters and these will be in the forthcoming feature release!
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Tim
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121001/16657d8a/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121001/16657d8a/attachment.htm</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022754.html">[rabbitmq-discuss] Errors starting RabbitMQ when cluster membership changes
</A></li>
	<LI>Next message: <A HREF="022771.html">[rabbitmq-discuss] Errors starting RabbitMQ when cluster	membership changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22770">[ date ]</a>
              <a href="thread.html#22770">[ thread ]</a>
              <a href="subject.html#22770">[ subject ]</a>
              <a href="author.html#22770">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
