<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ stops responding for a few seconds,	logs a &quot;Context: shutdown_error&quot;,	then resumes as if nothing happened
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20stops%20responding%20for%20a%20few%20seconds%2C%0A%09logs%20a%20%22Context%3A%20shutdown_error%22%2C%0A%09then%20resumes%20as%20if%20nothing%20happened&In-Reply-To=%3CD03E1C14-36D6-46BF-B4E8-DD7F7D4FB6C0%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023061.html">
   <LINK REL="Next"  HREF="023021.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ stops responding for a few seconds,	logs a &quot;Context: shutdown_error&quot;,	then resumes as if nothing happened</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20stops%20responding%20for%20a%20few%20seconds%2C%0A%09logs%20a%20%22Context%3A%20shutdown_error%22%2C%0A%09then%20resumes%20as%20if%20nothing%20happened&In-Reply-To=%3CD03E1C14-36D6-46BF-B4E8-DD7F7D4FB6C0%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ stops responding for a few seconds,	logs a &quot;Context: shutdown_error&quot;,	then resumes as if nothing happened">tim at rabbitmq.com
       </A><BR>
    <I>Mon Oct 15 20:50:11 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023061.html">[rabbitmq-discuss] RabbitMQ stops responding for a few seconds, logs a &quot;Context: shutdown_error&quot;, then resumes as if nothing happened
</A></li>
        <LI>Next message: <A HREF="023021.html">[rabbitmq-discuss] Is the release date typo for 2.8.7 ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23064">[ date ]</a>
              <a href="thread.html#23064">[ thread ]</a>
              <a href="subject.html#23064">[ subject ]</a>
              <a href="author.html#23064">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt,

Ok no problem, but do let us know if anything like this shows up again!

Cheers,
Tim


On 15 Oct 2012, at 18:50, Matt Pietrek wrote:

&gt;<i> Tim,
</I>&gt;<i> 
</I>&gt;<i> Unfortunately, the RabbitMQ logs are rather silent around the time of this observed behavior. However, looking at other logs, I'm starting to suspect that something triggered rsyslog (running on the same box) to send hundreds of thousands of old log lines to another server, thus potentially choking the ability of other processes (e.g. Rabbit) from responding during this time.
</I>&gt;<i> 
</I>&gt;<i> I'll update this thread if I subsequently find something else beyond this. For now, I'm inclined to call this closed.
</I>&gt;<i> 
</I>&gt;<i> On Mon, Oct 15, 2012 at 12:25 AM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i> Hi Matt,
</I>&gt;<i> 
</I>&gt;<i> Usual request for any scrubbed log(s) you can provide please! :)
</I>&gt;<i> 
</I>&gt;<i> Also, if you could confirm that /api/queues every 5 seconds is the only non-amqp traffic the broker(s) will be subject to, that'd be quite useful to know as well.
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> 
</I>&gt;<i> Tim
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 13 Oct 2012, at 00:43, Matt Pietrek wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; We've hit an odd circumstance in production that we can't make heads or tails of. Our setup is two RabbitMQ 2.8.6 nodes running clustered with all HA queues.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In front of them is a VIP managed by a keepalive instances running on the same host as the RabbitMQ nodes. Every 5 seconds the keepalive instance runs a custom script that queries the node local broker via the HTTP API,  requesting the set of queues (/api/queues).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; From our logs, I can see that there was a single interval where the HTTP request returned a 404 error. (The time was the same on both brokers) Previous to this moment in time, all HTTP queries were successful, and after this moment in time, all queries were sucessful - As I said, just one blip on each broker.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The only interesting thing we noticed in the logs was that the primary broker's <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at xxx-sasl</A> file had this little snippet about 30 seconds after the hiccup occurred:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; =SUPERVISOR REPORT==== 12-Oct-2012::15:06:47 ===
</I>&gt;<i> &gt; Supervisor: {&lt;0.25499.41&gt;, rabbit_channel_sup_sup}
</I>&gt;<i> &gt; Context: shutdown_error
</I>&gt;<i> &gt; Reason: shutdown
</I>&gt;<i> &gt; Offender: [{pid,&lt;0.25503.41&gt;},
</I>&gt;<i> &gt; {name,channel_sup},
</I>&gt;<i> &gt; {mfa,{rabbit_channel_sup,start_link,[]}},
</I>&gt;<i> &gt; {restart_type,temporary},
</I>&gt;<i> &gt; {shutdown,infinity},
</I>&gt;<i> &gt; {child_type,supervisor}]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm mostly at a loss to process what the snippet is telling me, nor can tell if the two things are related. Any help is appreciated!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Matt
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023061.html">[rabbitmq-discuss] RabbitMQ stops responding for a few seconds, logs a &quot;Context: shutdown_error&quot;, then resumes as if nothing happened
</A></li>
	<LI>Next message: <A HREF="023021.html">[rabbitmq-discuss] Is the release date typo for 2.8.7 ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23064">[ date ]</a>
              <a href="thread.html#23064">[ thread ]</a>
              <a href="subject.html#23064">[ subject ]</a>
              <a href="author.html#23064">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
