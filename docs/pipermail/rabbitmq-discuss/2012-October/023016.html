<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Loss of queues after network partition?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Loss%20of%20queues%20after%20network%20partition%3F&In-Reply-To=%3CCACLE7iyF8XFc2hGmy0YyaUJmGkV05dDZ6v5dXOsTJeq_6%2BKcKg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023045.html">
   <LINK REL="Next"  HREF="023041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Loss of queues after network partition?</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Loss%20of%20queues%20after%20network%20partition%3F&In-Reply-To=%3CCACLE7iyF8XFc2hGmy0YyaUJmGkV05dDZ6v5dXOsTJeq_6%2BKcKg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Loss of queues after network partition?">mpietrek at skytap.com
       </A><BR>
    <I>Fri Oct 12 21:01:21 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023045.html">[rabbitmq-discuss] What can cause mnesia partitioning?
</A></li>
        <LI>Next message: <A HREF="023041.html">[rabbitmq-discuss] Loss of queues after network partition?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23016">[ date ]</a>
              <a href="thread.html#23016">[ thread ]</a>
              <a href="subject.html#23016">[ subject ]</a>
              <a href="author.html#23016">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'll be the first to admit that this is a somewhat unusual/complicated
circumstance, but I'm posting this on the chance there's something unusual.
This is RabbitMQ is *2.8.7 *on Erlang R15B01.

We have two brokers (mq1, mq2) running clustered with all HA queues. A VIP
is in front of them.

At some point there was a network event, and afterwards, a queue vanished.
(Still trying to figure out exactly what the network hiccup was, but it's
fair to say there was a communication disruption between the nodes.)  My
guess from looking at the logs is that each node had a moment where it
couldn't see the other, so took actions that were ultimately incompatible
when both nodes were visible to each other.

The actual error as seen by our code is a missing queue named &quot;charon&quot;.
You'll see it near the end of the <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.log</A> (below):

*{amqp_error,not_found,&quot;no queue 'charon' in vhost '/'&quot;,'queue.declare'}*

Prior to the network event, our client was successfully reading from the
charon queue.


*Here's the relevant parts of the <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.log</A> file
====================================================*
=INFO REPORT==== 11-Oct-2012::14:01:58 ===
rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A> down

=ERROR REPORT==== 11-Oct-2012::14:02:03 ===
Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>): ** ERROR ** mnesia_event got {inconsistent_database,
running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>}

=ERROR REPORT==== 11-Oct-2012::14:02:03 ===
** Generic server &lt;0.547.0&gt; terminating
** Last message in was {<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mnesia_locker,rabbit at mq2</A>,granted}
** When Server state == {state,
                            {0,&lt;0.547.0&gt;},
                            {{0,&lt;0.547.0&gt;},undefined},
                            {{0,&lt;0.547.0&gt;},undefined},
                            {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                            rabbit_mirror_queue_coordinator,
                            {3,
                             [{{0,&lt;0.547.0&gt;},
                               {view_member,
                                   {0,&lt;0.547.0&gt;},
                                   [],
                                   {0,&lt;0.547.0&gt;},
                                   {0,&lt;0.547.0&gt;}}}]},
                            1,[],
                            [&lt;0.546.0&gt;],
                            {[],[]},
                            [],undefined}
** Reason for termination ==
** {function_clause,
       [{gm,handle_info,
            [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mnesia_locker,rabbit at mq2</A>,granted},
             {state,
                 {0,&lt;0.547.0&gt;},
                 {{0,&lt;0.547.0&gt;},undefined},
                 {{0,&lt;0.547.0&gt;},undefined},
                 {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                 rabbit_mirror_queue_coordinator,
                 {3,
                  [{{0,&lt;0.547.0&gt;},
                    {view_member,
                        {0,&lt;0.547.0&gt;},
                        [],
                        {0,&lt;0.547.0&gt;},
                        {0,&lt;0.547.0&gt;}}}]},
                 1,[],
                 [&lt;0.546.0&gt;],
                 {[],[]},
                 [],undefined}],
            [{file,&quot;src/gm.erl&quot;},{line,665}]},

{gen_server2,handle_msg,2,[{file,&quot;src/gen_server2.erl&quot;},{line,912}]},
        {proc_lib,wake_up,3,[{file,&quot;proc_lib.erl&quot;},{line,237}]}]}

=ERROR REPORT==== 11-Oct-2012::14:02:03 ===
** Generic server &lt;0.545.0&gt; terminating
** Last message in was {'EXIT',&lt;0.546.0&gt;,
                        {function_clause,
                         [{gm,handle_info,
                           [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mnesia_locker,rabbit at mq2</A>,granted},
                            {state,
                             {0,&lt;0.547.0&gt;},
                             {{0,&lt;0.547.0&gt;},undefined},
                             {{0,&lt;0.547.0&gt;},undefined},
                             {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                             rabbit_mirror_queue_coordinator,
                             {3,
                              [{{0,&lt;0.547.0&gt;},
                                {view_member,
                                 {0,&lt;0.547.0&gt;},
                                 [],
                                 {0,&lt;0.547.0&gt;},
                                 {0,&lt;0.547.0&gt;}}}]},
                             1,[],
                             [&lt;0.546.0&gt;],
                             {[],[]},
                             [],undefined}],
                           [{file,&quot;src/gm.erl&quot;},{line,665}]},
                          {gen_server2,handle_msg,2,
                           [{file,&quot;src/gen_server2.erl&quot;},{line,912}]},
                          {proc_lib,wake_up,3,
                           [{file,&quot;proc_lib.erl&quot;},{line,237}]}]}}
** When Server state == {q,
                         {amqqueue,
                          {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                          true,false,none,
                          [{&lt;&lt;&quot;x-ha-policy&quot;&gt;&gt;,longstr,&lt;&lt;&quot;all&quot;&gt;&gt;}],
                          &lt;0.545.0&gt;,[],all},
                         none,false,rabbit_mirror_queue_master,
                         {state,&lt;0.547.0&gt;,&lt;0.546.0&gt;,rabbit_variable_queue,
                          {vqstate,
                           {0,{[],[]}},
                           {0,{[],[]}},
                           {delta,undefined,0,undefined},
                           {0,{[],[]}},
                           {0,{[],[]}},
                           0,
                           {0,nil},
                           undefined,
                           {0,nil},
                           {qistate,
                            &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>
/queues/4L2SY4TVRPM8HP85JDVO85BPL&quot;,
                            {{dict,0,16,16,8,80,48,
                              {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                               []},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                []}}},
                             []},
                            undefined,0,262144,
                            #Fun&lt;rabbit_variable_queue.2.121500735&gt;,
                            {0,nil}},
                           {{client_msstate,msg_store_persistent,

&lt;&lt;112,32,84,92,54,73,67,43,231,35,164,79,106,8,27,
                               132&gt;&gt;,
                             {dict,0,16,16,8,80,48,
                              {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                               []},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                []}}},
                             {state,237637,
                              &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>
/msg_store_persistent&quot;},
                             rabbit_msg_store_ets_index,
                             &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>
/msg_store_persistent&quot;,
                             &lt;0.289.0&gt;,241734,233540,245831,249928},
                            {client_msstate,msg_store_transient,

&lt;&lt;204,18,155,40,29,120,124,76,144,83,195,135,250,
                               91,216,3&gt;&gt;,
                             {dict,0,16,16,8,80,48,
                              {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                               []},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                []}}},
                             {state,217152,
                              &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>
/msg_store_transient&quot;},
                             rabbit_msg_store_ets_index,
                             &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>
/msg_store_transient&quot;,
                             &lt;0.284.0&gt;,221249,213055,225346,229443}},

true,0,#Fun&lt;rabbit_amqqueue_process.5.24780734&gt;,0,
                           0,infinity,0,0,0,0,0,
                           {rates,
                            {{1349,988602,967125},0},
                            {{1349,988602,967125},0},
                            0.0,0.0,
                            {1349,988606,141019}},
                           {0,nil},
                           {0,nil},
                           {0,nil},
                           {0,nil},
                           0,0,
                           {rates,
                            {{1349,988602,967125},0},
                            {{1349,988602,967125},0},
                            0.0,0.0,
                            {1349,988606,141019}}},
                          0,
                          {dict,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                             []}}},
                          [],
                          {dict,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                             []}}},
                          {set,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                             []}}}},
                         {[],[]},
                         undefined,undefined,undefined,undefined,
                         {state,fine,5000,undefined},
                         {0,nil},
                         undefined,undefined,undefined,
                         {dict,0,16,16,8,80,48,
                          {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]}}},
                         1,
                         {{0,nil},{0,nil}},
                         undefined,
                         {dict,0,16,16,8,80,48,
                          {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]}}},
                         undefined,undefined}
** Reason for termination ==
** {noproc,{gen_server2,call,[&lt;0.547.0&gt;,info,infinity]}}
** In 'terminate' callback with reason ==
** {function_clause,
       [{gm,handle_info,
            [{<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mnesia_locker,rabbit at mq2</A>,granted},
             {state,
                 {0,&lt;0.547.0&gt;},
                 {{0,&lt;0.547.0&gt;},undefined},
                 {{0,&lt;0.547.0&gt;},undefined},
                 {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                 rabbit_mirror_queue_coordinator,
                 {3,
                  [{{0,&lt;0.547.0&gt;},
                    {view_member,
                        {0,&lt;0.547.0&gt;},
                        [],
                        {0,&lt;0.547.0&gt;},
                        {0,&lt;0.547.0&gt;}}}]},
                 1,[],
                 [&lt;0.546.0&gt;],
                 {[],[]},
                 [],undefined}],
            [{file,&quot;src/gm.erl&quot;},{line,665}]},

{gen_server2,handle_msg,2,[{file,&quot;src/gen_server2.erl&quot;},{line,912}]},
        {proc_lib,wake_up,3,[{file,&quot;proc_lib.erl&quot;},{line,237}]}]}

=INFO REPORT==== 11-Oct-2012::14:02:03 ===
Mirrored-queue (queue 'cmcmd' in vhost '/'): Master &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.2.665.0</A>&gt;
saw deaths of mirrors &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.383.0</A>&gt;

=INFO REPORT==== 11-Oct-2012::14:02:03 ===
Mirrored-queue (queue 'ConfigurationManager' in vhost '/'): Master
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.2.605.0</A>&gt; saw deaths of mirrors &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.377.0</A>&gt;

=INFO REPORT==== 11-Oct-2012::14:02:03 ===
global: Name conflict terminating {rabbit_mgmt_db,&lt;3198.32532.0&gt;}

=INFO REPORT==== 11-Oct-2012::14:26:40 ===
accepting AMQP connection &lt;0.6507.1&gt; (10.72.0.50:46742 -&gt; 10.72.0.47:5672)

=INFO REPORT==== 11-Oct-2012::14:26:40 ===
closing AMQP connection &lt;0.6507.1&gt; (10.72.0.50:46742 -&gt; 10.72.0.47:5672)




*And here's the relevant parts of the <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at m2.log</A> file
====================================================*
=ERROR REPORT==== 11-Oct-2012::14:01:37 ===
** Node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A> not responding **
** Removing (timedout) connection **

=INFO REPORT==== 11-Oct-2012::14:01:37 ===
rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A> down

=INFO REPORT==== 11-Oct-2012::14:01:40 ===
Statistics database started.

=INFO REPORT==== 11-Oct-2012::14:01:43 ===
Mirrored-queue (queue 'cmcmd' in vhost '/'): Slave &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.383.0</A>&gt; saw
deaths of mirrors &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.2.665.0</A>&gt;

=INFO REPORT==== 11-Oct-2012::14:01:43 ===
Mirrored-queue (queue 'cmcmd' in vhost '/'): Promoting slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.383.0</A>&gt; to master

=INFO REPORT==== 11-Oct-2012::14:01:43 ===
Mirrored-queue (queue 'charon' in vhost '/'): Slave &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.371.0</A>&gt;
saw deaths of mirrors &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.2.545.0</A>&gt;

=INFO REPORT==== 11-Oct-2012::14:01:43 ===
Mirrored-queue (queue 'charon' in vhost '/'): Promoting slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.371.0</A>&gt; to master

=INFO REPORT==== 11-Oct-2012::14:01:43 ===
Mirrored-queue (queue 'ConfigurationManager' in vhost '/'): Slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.377.0</A>&gt; saw deaths of mirrors &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.2.605.0</A>&gt;

=INFO REPORT==== 11-Oct-2012::14:01:43 ===
Mirrored-queue (queue 'ConfigurationManager' in vhost '/'): Promoting slave
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2.1.377.0</A>&gt; to master

=ERROR REPORT==== 11-Oct-2012::14:05:03 ===
Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>): ** ERROR ** mnesia_event got {inconsistent_database,
running_partitioned_network, <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>}

=INFO REPORT==== 11-Oct-2012::14:05:03 ===
Statistics database started.

=ERROR REPORT==== 11-Oct-2012::14:29:39 ===
** Generic server &lt;0.32583.0&gt; terminating
** Last message in was {'$gen_cast',{gm_deaths,[&lt;0.5504.1&gt;]}}
** When Server state == {state,
                            {amqqueue,
                                {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                                true,false,none,
                                [{&lt;&lt;&quot;x-ha-policy&quot;&gt;&gt;,longstr,&lt;&lt;&quot;all&quot;&gt;&gt;}],
                                &lt;0.371.0&gt;,[],all},
                            &lt;0.372.0&gt;,
                            {dict,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            #Fun&lt;rabbit_mirror_queue_master.1.32244930&gt;,
                            #Fun&lt;rabbit_mirror_queue_master.2.32244930&gt;}
** Reason for termination ==
** {bad_return_value,
       {error,
           {{badmatch,[]},
            [{rabbit_mirror_queue_misc,'-remove_from_queue/2-fun-0-',2,
                 [{file,&quot;src/rabbit_mirror_queue_misc.erl&quot;},{line,63}]},
             {mnesia_tm,apply_fun,3,[{file,&quot;mnesia_tm.erl&quot;},{line,829}]},
             {mnesia_tm,execute_transaction,5,
                 [{file,&quot;mnesia_tm.erl&quot;},{line,809}]},
             {rabbit_misc,'-execute_mnesia_transaction/1-fun-0-',1,
                 [{file,&quot;src/rabbit_misc.erl&quot;},{line,440}]},
             {worker_pool_worker,handle_call,3,
                 [{file,&quot;src/worker_pool_worker.erl&quot;},{line,80}]},
             {gen_server2,handle_msg,2,
                 [{file,&quot;src/gen_server2.erl&quot;},{line,879}]},
             {proc_lib,wake_up,3,[{file,&quot;proc_lib.erl&quot;},{line,237}]}]}}}

=ERROR REPORT==== 11-Oct-2012::14:29:39 ===
** Generic server &lt;0.371.0&gt; terminating
** Last message in was {'EXIT',&lt;0.32583.0&gt;,
                        {bad_return_value,
                         {error,
                          {{badmatch,[]},
                           [{rabbit_mirror_queue_misc,
                             '-remove_from_queue/2-fun-0-',2,
                             [{file,&quot;src/rabbit_mirror_queue_misc.erl&quot;},
                              {line,63}]},
                            {mnesia_tm,apply_fun,3,
                             [{file,&quot;mnesia_tm.erl&quot;},{line,829}]},
                            {mnesia_tm,execute_transaction,5,
                             [{file,&quot;mnesia_tm.erl&quot;},{line,809}]},
                            {rabbit_misc,
                             '-execute_mnesia_transaction/1-fun-0-',1,
                             [{file,&quot;src/rabbit_misc.erl&quot;},{line,440}]},
                            {worker_pool_worker,handle_call,3,

[{file,&quot;src/worker_pool_worker.erl&quot;},{line,80}]},
                            {gen_server2,handle_msg,2,
                             [{file,&quot;src/gen_server2.erl&quot;},{line,879}]},
                            {proc_lib,wake_up,3,
                             [{file,&quot;proc_lib.erl&quot;},{line,237}]}]}}}}
** When Server state == {q,
                         {amqqueue,
                          {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;},
                          true,false,none,
                          [{&lt;&lt;&quot;x-ha-policy&quot;&gt;&gt;,longstr,&lt;&lt;&quot;all&quot;&gt;&gt;}],
                          &lt;0.371.0&gt;,[],all},
                         none,false,rabbit_mirror_queue_master,
                         {state,&lt;0.372.0&gt;,&lt;0.32583.0&gt;,rabbit_variable_queue,
                          {vqstate,
                           {0,{[],[]}},
                           {0,{[],[]}},
                           {delta,undefined,0,undefined},
                           {0,{[],[]}},
                           {0,{[],[]}},
                           0,
                           {0,nil},
                           undefined,
                           {0,nil},
                           {qistate,
                            &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>
/queues/4L2SY4TVRPM8HP85JDVO85BPL&quot;,
                            {{dict,0,16,16,8,80,48,
                              {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                               []},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                []}}},
                             []},
                            undefined,0,262144,
                            #Fun&lt;rabbit_variable_queue.2.121500735&gt;,
                            {0,nil}},
                           {{client_msstate,msg_store_persistent,

&lt;&lt;23,245,132,154,3,96,225,184,108,75,232,224,184,
                               114,108,141&gt;&gt;,
                             {dict,0,16,16,8,80,48,
                              {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                               []},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                []}}},
                             {state,282693,
                              &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>
/msg_store_persistent&quot;},
                             rabbit_msg_store_ets_index,
                             &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>
/msg_store_persistent&quot;,
                             &lt;0.285.0&gt;,286790,278596,290887,294984},
                            {client_msstate,msg_store_transient,

&lt;&lt;17,62,75,125,126,21,66,37,170,44,198,72,18,94,
                               170,197&gt;&gt;,
                             {dict,0,16,16,8,80,48,
                              {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                               []},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                []}}},
                             {state,262208,
                              &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>
/msg_store_transient&quot;},
                             rabbit_msg_store_ets_index,
                             &quot;/highland/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq2</A>
/msg_store_transient&quot;,
                             &lt;0.280.0&gt;,266305,258111,270402,274499}},

true,0,#Fun&lt;rabbit_mirror_queue_slave.1.69615989&gt;,
                           0,0,infinity,0,0,0,0,0,
                           {rates,
                            {{1349,989325,677031},0},
                            {{1349,989325,677031},0},
                            0.0,0.0,
                            {1349,989505,348090}},
                           {0,nil},
                           {0,nil},
                           {0,nil},
                           {0,nil},
                           0,0,
                           {rates,
                            {{1349,989325,677031},0},
                            {{1349,989325,677031},0},
                            0.0,0.0,
                            {1349,989505,348090}}},
                          0,
                          {dict,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                             []}}},
                          [],
                          {dict,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                             []}}},
                          {set,0,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
                           {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                             []}}}},
                         {[],[]},
                         undefined,undefined,undefined,undefined,
                         {state,fine,5000,undefined},
                         {0,nil},
                         undefined,undefined,undefined,
                         {dict,0,16,16,8,80,48,
                          {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]}}},
                         1,
                         {{0,nil},{0,nil}},
                         undefined,
                         {dict,0,16,16,8,80,48,
                          {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},

{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]}}},
                         undefined,undefined}
** Reason for termination ==
** {noproc,{gen_server2,call,[&lt;0.372.0&gt;,info,infinity]}}
** In 'terminate' callback with reason ==
** {bad_return_value,
       {error,
           {{badmatch,[]},
            [{rabbit_mirror_queue_misc,'-remove_from_queue/2-fun-0-',2,
                 [{file,&quot;src/rabbit_mirror_queue_misc.erl&quot;},{line,63}]},
             {mnesia_tm,apply_fun,3,[{file,&quot;mnesia_tm.erl&quot;},{line,829}]},
             {mnesia_tm,execute_transaction,5,
                 [{file,&quot;mnesia_tm.erl&quot;},{line,809}]},
             {rabbit_misc,'-execute_mnesia_transaction/1-fun-0-',1,
                 [{file,&quot;src/rabbit_misc.erl&quot;},{line,440}]},
             {worker_pool_worker,handle_call,3,
                 [{file,&quot;src/worker_pool_worker.erl&quot;},{line,80}]},
             {gen_server2,handle_msg,2,
                 [{file,&quot;src/gen_server2.erl&quot;},{line,879}]},
             {proc_lib,wake_up,3,[{file,&quot;proc_lib.erl&quot;},{line,237}]}]}}}

=INFO REPORT==== 11-Oct-2012::14:29:43 ===
accepting AMQP connection &lt;0.5524.1&gt; (10.72.0.23:36056 -&gt; 10.72.0.56:5672)

=INFO REPORT==== 11-Oct-2012::14:29:44 ===
accepting AMQP connection &lt;0.5574.1&gt; (10.72.0.23:36064 -&gt; 10.72.0.56:5672)

=INFO REPORT==== 11-Oct-2012::17:56:16 ===
accepting AMQP connection &lt;0.23868.1&gt; (10.72.0.53:57122 -&gt; 10.72.0.56:5672)

=ERROR REPORT==== 11-Oct-2012::17:56:16 ===
connection &lt;0.23868.1&gt;, channel 1 - error:
{amqp_error,not_found,&quot;no queue 'charon' in vhost '/'&quot;,'queue.declare'}

=WARNING REPORT==== 11-Oct-2012::17:56:16 ===
closing AMQP connection &lt;0.23868.1&gt; (10.72.0.53:57122 -&gt; 10.72.0.56:5672):
connection_closed_abruptly

=INFO REPORT==== 11-Oct-2012::17:56:16 ===
accepting AMQP connection &lt;0.23878.1&gt; (10.72.0.52:56025 -&gt; 10.72.0.56:5672)

=ERROR REPORT==== 11-Oct-2012::17:56:16 ===
connection &lt;0.23878.1&gt;, channel 1 - error:
{amqp_error,not_found,&quot;no queue 'charon' in vhost '/'&quot;,'queue.declare'}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121012/891ba884/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121012/891ba884/attachment.htm</A>&gt;
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023045.html">[rabbitmq-discuss] What can cause mnesia partitioning?
</A></li>
	<LI>Next message: <A HREF="023041.html">[rabbitmq-discuss] Loss of queues after network partition?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23016">[ date ]</a>
              <a href="thread.html#23016">[ thread ]</a>
              <a href="subject.html#23016">[ subject ]</a>
              <a href="author.html#23016">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
