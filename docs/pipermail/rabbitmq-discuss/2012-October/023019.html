<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Disable Per-Connection Flow Control
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disable%20Per-Connection%20Flow%20Control&In-Reply-To=%3CCAHo58sjJYn3XiBguctA2ohvrfeh1EjUqU_018%3D%3D7cTAAYcVDhw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023008.html">
   <LINK REL="Next"  HREF="023042.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Disable Per-Connection Flow Control</H1>
    <B>Dwayne Campbell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disable%20Per-Connection%20Flow%20Control&In-Reply-To=%3CCAHo58sjJYn3XiBguctA2ohvrfeh1EjUqU_018%3D%3D7cTAAYcVDhw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Disable Per-Connection Flow Control">dwaynecampbell13 at gmail.com
       </A><BR>
    <I>Sat Oct 13 02:16:10 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023008.html">[rabbitmq-discuss] Disable Per-Connection Flow Control
</A></li>
        <LI>Next message: <A HREF="023042.html">[rabbitmq-discuss] Disable Per-Connection Flow Control
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23019">[ date ]</a>
              <a href="thread.html#23019">[ thread ]</a>
              <a href="subject.html#23019">[ subject ]</a>
              <a href="author.html#23019">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Simon,

Thank you very much for your reply.

 **

Using HIPE compilation reduced the flow control significantly.I now get
flow controlled at around 4.1 MB/S to 7.2 MB/S .However flow control
 seems to steadily remain on at 3.8MB/s for the rest of the time RabbitMQ
runs.


Each message is about approximately 300 bytes at most 800 bytes

Multiple connections(independent applications) will be made from the same
host to the RabbitMQ Server. Each connection will be sending small messages
really fast to the broker(RabbitMQ Server)****

** **

What optimizations can be made to increase throughput on RabbitMQ Server or
 the routing part of the pipeline ? Would cluster be the next option to
evaluate ?

** **

** **
Is there any output that i can gather to analyze which part of
the pipeline is the bottleneck ?


--

Dwayne


On Fri, Oct 12, 2012 at 7:14 AM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:

&gt;<i> On 11/10/12 13:14, Dwayne Campbell wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Guys,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> RabbitMQ now turns on flow control often even at 1.5 MB/s.  I have read
</I>&gt;&gt;<i> before to increase the TCP buffer size, however I do not have access to
</I>&gt;&gt;<i> increase the TCP buffer size o the machines.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How can i disable Per-Connection Flow Control ?   Memory based  and Disk
</I>&gt;&gt;<i> based control is enough for me.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi. You should be aware that the flow control is indicating that some part
</I>&gt;<i> of the message pipeline is overloaded. If you were to turn off flow control
</I>&gt;<i> it would just lead to messages backing up ahead of that part of the
</I>&gt;<i> pipeline - leading to memory use ballooning very rapidly and no increase in
</I>&gt;<i> throughput.
</I>&gt;<i>
</I>&gt;<i> If you are sending lots of tiny messages then the routing part of the
</I>&gt;<i> pipeline can be the most expensive - my workstation manages only about
</I>&gt;<i> 2.5MB/s with zero-length messages.
</I>&gt;<i>
</I>&gt;<i> The advice about increasing the buffer size is to allow your machine to
</I>&gt;<i> handle short bursts of messages, at higher rates than it can manage in a
</I>&gt;<i> steady state. It won't get you a higher steady state rate.
</I>&gt;<i>
</I>&gt;<i> To process messages faster on a single machine you might enable HiPE
</I>&gt;<i> compilation: see <A HREF="http://www.rabbitmq.com/**configure.html&lt;http://www.rabbitmq.com/configure.html">http://www.rabbitmq.com/**configure.html&lt;http://www.rabbitmq.com/configure.html</A>&gt;
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121012/216aea06/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121012/216aea06/attachment.htm</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023008.html">[rabbitmq-discuss] Disable Per-Connection Flow Control
</A></li>
	<LI>Next message: <A HREF="023042.html">[rabbitmq-discuss] Disable Per-Connection Flow Control
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23019">[ date ]</a>
              <a href="thread.html#23019">[ thread ]</a>
              <a href="subject.html#23019">[ subject ]</a>
              <a href="author.html#23019">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
