<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Batching messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Batching%20messages&In-Reply-To=%3C50890C49.60705%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023331.html">
   <LINK REL="Next"  HREF="023375.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Batching messages</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Batching%20messages&In-Reply-To=%3C50890C49.60705%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Batching messages">tim at rabbitmq.com
       </A><BR>
    <I>Thu Oct 25 10:54:17 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023331.html">[rabbitmq-discuss] Batching messages
</A></li>
        <LI>Next message: <A HREF="023375.html">[rabbitmq-discuss] Batching messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23333">[ date ]</a>
              <a href="thread.html#23333">[ thread ]</a>
              <a href="subject.html#23333">[ subject ]</a>
              <a href="author.html#23333">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

On 10/25/2012 06:33 AM, Srdan Kvrgic wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Short story:
</I>&gt;<i> Are there any plans to support batching of messages within the rabbitmq eco-system?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Long story:
</I>[snip]
&gt;<i> Optimally you would want a system that sends and receives batches of messages but allows you to reject single messages. Have your cake and eat it, as it were...
</I>
Sounds good, but...

AMQP already provides batching delivery capabilities and these have been 
discussed previously, for example 
<A HREF="https://groups.google.com/forum/?fromgroups=#!topic/rabbitmq-discuss/CidFKmJrBFI.">https://groups.google.com/forum/?fromgroups=#!topic/rabbitmq-discuss/CidFKmJrBFI.</A> 
But what you seem to be running up against is the fact that your many 
small messages limit throughput, so you want to bundle them up. I would 
suggest putting a processor between the publisher and consumer which 
unpacks the batches and forwards individual messages to the target 
exchange. This could be achieved by writing a custom exchange type, 
configured to understand how to 'unpack' the batch and where to route 
the forwarded messages to. The consumers would then receive these 
individual messages (possibly in batches!) and could reject some or all 
of them, but that rejection would not be apparent to the outside world 
in any way! So you'd need to then change your design somewhat, perhaps 
by putting 'failed' messages onto a different 'error queue' *or* by 
rejecting them and setting up a TTL and Dead Letter eXchange on the 
destination queue so that you can identify failures transparently. In 
either case, you'd want to add some kind of x-batch-id header to the 
'broken up' messages so that your reprocessing procedure is able to 
identify the source batch from which they came.

Doing this 'in the broker' doesn't really make sense to me. How would 
transactions and/or confirms continue to work, for example?

&gt;<i> Also automatic de-/compression in the driver. That also was a great performance boost when the batches started getting big. Lzf ftw!
</I>
Hmn, that's an interesting one! Which client library are you using?

&gt;<i> You think?
</I>&gt;<i>
</I>&gt;<i> Kind regards,
</I>&gt;<i> Srdan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023331.html">[rabbitmq-discuss] Batching messages
</A></li>
	<LI>Next message: <A HREF="023375.html">[rabbitmq-discuss] Batching messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23333">[ date ]</a>
              <a href="thread.html#23333">[ thread ]</a>
              <a href="subject.html#23333">[ subject ]</a>
              <a href="author.html#23333">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
