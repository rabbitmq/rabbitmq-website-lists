<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Failure to return from call to newConnection()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Failure%20to%20return%20from%20call%20to%0A%20newConnection%28%29&In-Reply-To=%3C242E9559AA2C354CB60C81A952FCBEB501801E%40TSEAMB01%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022906.html">
   <LINK REL="Next"  HREF="022925.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Failure to return from call to newConnection()</H1>
    <B>McMahon, James S (TASC)</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Failure%20to%20return%20from%20call%20to%0A%20newConnection%28%29&In-Reply-To=%3C242E9559AA2C354CB60C81A952FCBEB501801E%40TSEAMB01%3E"
       TITLE="[rabbitmq-discuss] Failure to return from call to newConnection()">james.mcmahon at TASC.COM
       </A><BR>
    <I>Tue Oct  9 11:19:57 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022906.html">[rabbitmq-discuss] Failure to return from call to	newConnection()
</A></li>
        <LI>Next message: <A HREF="022925.html">[rabbitmq-discuss] Failure to return from call to	newConnection()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22918">[ date ]</a>
              <a href="thread.html#22918">[ thread ]</a>
              <a href="subject.html#22918">[ subject ]</a>
              <a href="author.html#22918">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>     Thank you for your help, Simon. I did look more closely at the situation as you suggested. It seems that I can only start one process listening to a specific port at IP address of the rabbitMQ server. I can't start the second listening to the same port at the same address.

     In one command shell, I start my listener on port 5672. It works great. I then start up a second command shell, the first still running. I tell the second instance of my listener process to listen to the same port. It never returns, and I get the connection timed out error. If I start my second process without pointing it to a port or using an IP address, it works just fine. To the untrained (ie, me), this tells me that the second works because it goes to my rabbitMQ server instance locally, rather than through IP and port.

    So in summary: two listener processes in different command shells on the same physical laptop, started from the command line. Trying to listen on the same port, to the same rabbitMQ server instance at IP. Not being familiar with port configurations and limitations, shouldn't I be able to have multiple listener processes listening to incoming on the same port? The evidence appears to say &quot;no&quot;. Why is that?

- Jim

________________________________________
From: Simon MacMullen [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>]
Sent: Monday, October 08, 2012 5:22 PM
To: Discussions about RabbitMQ
Cc: McMahon, James S (TASC)
Subject: Re: [rabbitmq-discuss] Failure to return from call to newConnection()

The stack trace you have posted really does look like a standard case of
the TCP connection timing out. I suggest you make absolutely sure that
you really are connecting to the host/port you think you are.

Cheers, Simon

On 08/10/2012 9:02PM, McMahon, James S (TASC) wrote:
&gt;<i>        I am experiencing a problem that I have been unable to pin down.
</I>&gt;<i> When I attempt to use a java class to listen for messages bound to a
</I>&gt;<i> particular exchange by a particular routing key, I get a &quot;Connection
</I>&gt;<i> timed out&quot; error. Here is my code:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> public class ReceiveLogsDirect {
</I>&gt;<i>
</I>&gt;<i>    private static final String EXCHANGE_NAME = &quot;ABC_SERVER&quot;;
</I>&gt;<i>
</I>&gt;<i>    public static void main(String[] argv) throws Exception {
</I>&gt;<i>
</I>&gt;<i>        String hostName = &quot;localhost&quot;;
</I>&gt;<i>        int portNumber = 5672;
</I>&gt;<i>
</I>&gt;<i>        if (argv.length &lt; 1 || argv.length == 2 || argv.length &gt; 3){
</I>&gt;<i>            System.err.println(&quot;Usage: ReceiveLogsDirect [session ID]
</I>&gt;<i> [RabbitMQ server IP, optional] [RabbitMQ server port #, optional]&quot;);
</I>&gt;<i>            System.exit(1);
</I>&gt;<i>        }
</I>&gt;<i>        else if (argv.length == 1) {
</I>&gt;<i>            hostName = &quot;localhost&quot;;
</I>&gt;<i>            portNumber = 5672; // default port that rabbitMQ listens to
</I>&gt;<i>        }
</I>&gt;<i>        else if  (argv.length == 3) {
</I>&gt;<i>            hostName = argv[1];
</I>&gt;<i>            portNumber = Integer.parseInt(argv[2]);
</I>&gt;<i>        }
</I>&gt;<i>
</I>&gt;<i>        ConnectionFactory factory = new ConnectionFactory();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>        factory.setHost(hostName);
</I>&gt;<i>        factory.setPort(portNumber);
</I>&gt;<i>        factory.setUsername(&quot;guest&quot;);
</I>&gt;<i>        factory.setPassword(&quot;guest&quot;);
</I>&gt;<i>        factory.setVirtualHost(&quot;/&quot;);
</I>&gt;<i>
</I>&gt;<i>        System.out.println(&quot; [*] HERE 1&quot;);
</I>&gt;<i>        Connection connection = factory.newConnection();
</I>&gt;<i>        System.out.println(&quot; [*] HERE 2&quot;);
</I>&gt;<i>        Channel channel = connection.createChannel();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>      channel.exchangeDeclare(EXCHANGE_NAME, &quot;direct&quot;);
</I>&gt;<i>      String queueName = channel.queueDeclare().getQueue();
</I>&gt;<i>
</I>&gt;<i>          channel.queueBind(queueName, EXCHANGE_NAME, argv[0]);
</I>&gt;<i>          System.out.println(&quot; [*] bindingKey &quot; + argv[0]  +  &quot; is bound
</I>&gt;<i> to queue on exchange &quot; + EXCHANGE_NAME );
</I>&gt;<i>
</I>&gt;<i>      System.out.println(&quot; [*] Waiting for messages. To exit press CTRL+C&quot;);
</I>&gt;<i>
</I>&gt;<i>      QueueingConsumer consumer = new QueueingConsumer(channel);
</I>&gt;<i>      channel.basicConsume(queueName, true, consumer);
</I>&gt;<i>
</I>&gt;<i>      while (true) {
</I>&gt;<i>        QueueingConsumer.Delivery delivery = consumer.nextDelivery();
</I>&gt;<i>        String message = new String(delivery.getBody());
</I>&gt;<i>        String routingKey = delivery.getEnvelope().getRoutingKey();
</I>&gt;<i>
</I>&gt;<i>        System.out.println(&quot; [x] Received message for &quot; + routingKey + &quot;
</I>&gt;<i>  &gt;&gt;&gt;&quot; + message);
</I>&gt;<i>      }
</I>&gt;<i>    }
</I>&gt;<i>
</I>&gt;<i> I used simple print statements to pinpoint the source of the problem at
</I>&gt;<i> the line where I call newConnection().
</I>&gt;<i>
</I>&gt;<i>       The error I get is this:
</I>&gt;<i>
</I>&gt;<i>   [*] HERE 1
</I>&gt;<i> Exception in thread &quot;main&quot; java.net.ConnectException: Connection timed
</I>&gt;<i> out: connect
</I>&gt;<i>      at java.net.PlainSocketImpl.socketConnect(Native Method)
</I>&gt;<i>      at java.net.PlainSocketImpl.doConnect(Unknown Source)
</I>&gt;<i>      at java.net.PlainSocketImpl.connectToAddress(Unknown Source)
</I>&gt;<i>      at java.net.PlainSocketImpl.connect(Unknown Source)
</I>&gt;<i>      at java.net.SocksSocketImpl.connect(Unknown Source)
</I>&gt;<i>      at java.net.Socket.connect(Unknown Source)
</I>&gt;<i>      at
</I>&gt;<i> com.rabbitmq.client.ConnectionFactory.createFrameHandler(ConnectionFactory.java:441)
</I>&gt;<i>      at
</I>&gt;<i> com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:480)
</I>&gt;<i>      at
</I>&gt;<i> com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:509)
</I>&gt;<i>      at
</I>&gt;<i> com.tasc.prism.queue.ReceiveLogsDirect.main(ReceiveLogsDirect.java:55)
</I>&gt;<i>
</I>&gt;<i>       My install of rabbitMQ is 2.7.0. Oddly, I have been able to
</I>&gt;<i> execute this in another command shell window and it works. I am
</I>&gt;<i> wondering why I'm having trouble in the second shell? Surely I must be
</I>&gt;<i> able to execute multiple instances of ReceiveLogsDirect simultaneously,
</I>&gt;<i> right?
</I>&gt;<i>
</I>&gt;<i>      Could it be a runtime environment problem? I set my class path
</I>&gt;<i> exactly the same in both shells.
</I>&gt;<i>
</I>&gt;<i>      Any thoughts or similar experience with such a problem? Thank you.
</I>&gt;<i>
</I>&gt;<i> - Jim
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> CONFIDENTIALITY NOTICE: This message and any attachments or files
</I>&gt;<i> transmitted with it (collectively, the &quot;Message&quot;) are intended only for
</I>&gt;<i> the addressee and may contain information that is privileged,
</I>&gt;<i> proprietary and/or prohibited from disclosure by law or contract. If you
</I>&gt;<i> are not the intended recipient: (a) please do not read, copy or
</I>&gt;<i> retransmit the Message; (b) permanently delete and/or destroy all
</I>&gt;<i> electronic and hard copies of the Message; (c) notify us by return
</I>&gt;<i> email; and (d) you are hereby notified that any dissemination,
</I>&gt;<i> distribution or copying of the Message is strictly prohibited.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>CONFIDENTIALITY NOTICE: This message and any attachments or files transmitted with it (collectively, the &quot;Message&quot;) are intended only for the addressee and may contain information that is privileged, proprietary and/or prohibited from disclosure by law or contract. If you are not the intended recipient: (a) please do not read, copy or retransmit the Message; (b) permanently delete and/or destroy all electronic and hard copies of the Message; (c) notify us by return email; and (d) you are hereby notified that any dissemination, distribution or copying of the Message is strictly prohibited.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022906.html">[rabbitmq-discuss] Failure to return from call to	newConnection()
</A></li>
	<LI>Next message: <A HREF="022925.html">[rabbitmq-discuss] Failure to return from call to	newConnection()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22918">[ date ]</a>
              <a href="thread.html#22918">[ thread ]</a>
              <a href="subject.html#22918">[ subject ]</a>
              <a href="author.html#22918">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
