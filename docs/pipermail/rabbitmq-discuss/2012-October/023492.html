<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] loadbalancer configuration for clustered	rabbitmq cluster.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20loadbalancer%20configuration%20for%20clustered%0A%09rabbitmq%20cluster.&In-Reply-To=%3CE28E44216D833A45A77BB45901475E8412CE2C91%40BY2PRD0511MB416.namprd05.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023488.html">
   <LINK REL="Next"  HREF="023505.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] loadbalancer configuration for clustered	rabbitmq cluster.</H1>
    <B>Anuj Lal</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20loadbalancer%20configuration%20for%20clustered%0A%09rabbitmq%20cluster.&In-Reply-To=%3CE28E44216D833A45A77BB45901475E8412CE2C91%40BY2PRD0511MB416.namprd05.prod.outlook.com%3E"
       TITLE="[rabbitmq-discuss] loadbalancer configuration for clustered	rabbitmq cluster.">alal at adchemy.com
       </A><BR>
    <I>Wed Oct 31 17:09:41 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023488.html">[rabbitmq-discuss] Lost messages on dead-letter + ttl queue while process is restarted?
</A></li>
        <LI>Next message: <A HREF="023505.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks	received from subscribers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23492">[ date ]</a>
              <a href="thread.html#23492">[ thread ]</a>
              <a href="subject.html#23492">[ subject ]</a>
              <a href="author.html#23492">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have set up clustered HA two node rabitmq cluster &#8211; one running in file mode and other in in memory.
This takes cares of continued flow of messages if one node in cluster is down. I am still testing this scenario.

Load balancing to consumer side ( worker queue or consistent hash  exchange etc) is working. I have got question regarding some load balancing from producer to broker side.

Lets say our load requirement is very very high and one cluster of rabbitMQ is not sufficient to handle  that large load.  To handle very large load,  and to test this configuration I am thinking about create another cluster of rabbitMQ and put both cluster nodes behind  load balancer.  I have  following question


  1.  Is this  approach recommended or tried by anyone.
  2.  What configuration I need to specify in load balancer ? For example, I need to specify server addresses in load balancer. If I have cluster of server, can I specify  like this

            server  cluster1server1.dev.aws.xyz.net:5672,cluster1server2.dev.aws.xyz.net:5672
    server  cluster2server1.dev.aws.xyz.net:5672,cluster2server2.dev.aws.xyz.net:5672

   3. If I don't use load balancer, I use cache of connection like this
      &lt;bean id=&quot;connectionFactory&quot;
class=&quot;org.springframework.amqp.rabbit.connection.CachingConnectionFactory&quot;&gt;
&lt;property name=&quot;username&quot; value=&quot;${message.broker.apr.userName}&quot; /&gt;
&lt;property name=&quot;password&quot; value=&quot;${message.broker.apr.password}&quot; /&gt;
&lt;property name=&quot;channelCacheSize&quot; value=&quot;${message.broker.numberOfCachedChannelsForBroker}&quot; /&gt;
&lt;property name=&quot;addresses&quot; value=&quot;
cluster1server1.dev.aws.xyz.net:5672,cluster1server2.dev.aws.xyz.net:5672&quot;  /&gt;
&lt;/bean&gt;

        How can I specify these if I am using load balancer?

In short anybody has used clustered HA rabbitmq behind loadbalancer.  If this option is not recommended than other option I was thinking about cadd more node in a sinle cluster and add other exchange and node, but in that case publisher is going to do round robin kind of mechanish to balance load between two exchanges.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/e22b815b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/e22b815b/attachment.htm</A>&gt;
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023488.html">[rabbitmq-discuss] Lost messages on dead-letter + ttl queue while process is restarted?
</A></li>
	<LI>Next message: <A HREF="023505.html">[rabbitmq-discuss] Pub/Sub -- block publisher until all acks	received from subscribers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23492">[ date ]</a>
              <a href="thread.html#23492">[ thread ]</a>
              <a href="subject.html#23492">[ subject ]</a>
              <a href="author.html#23492">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
