<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] consumer cancel notify support in pika
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20consumer%20cancel%20notify%20support%20in%20pika&In-Reply-To=%3C10AD22196924954389ADAB923E16F65715437EB115%40DFW1MBX10.mex07a.mlsrvr.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023506.html">
   <LINK REL="Next"  HREF="023476.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] consumer cancel notify support in pika</H1>
    <B>Peter Friend</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20consumer%20cancel%20notify%20support%20in%20pika&In-Reply-To=%3C10AD22196924954389ADAB923E16F65715437EB115%40DFW1MBX10.mex07a.mlsrvr.com%3E"
       TITLE="[rabbitmq-discuss] consumer cancel notify support in pika">pfriend at gehrytech.com
       </A><BR>
    <I>Wed Oct 31 22:01:29 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023506.html">[rabbitmq-discuss] consumer cancel notify support in pika
</A></li>
        <LI>Next message: <A HREF="023476.html">[rabbitmq-discuss] the problem about the consumer connection can be	closed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23501">[ date ]</a>
              <a href="thread.html#23501">[ thread ]</a>
              <a href="subject.html#23501">[ subject ]</a>
              <a href="author.html#23501">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gavin,

The cancel callback is being called when I use async methods, so it appears this is just an issue with BlockingConnection. Thanks!

Peter

From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] On Behalf Of Gavin M. Roy
Sent: Wednesday, October 31, 2012 11:13 AM
To: Discussions about RabbitMQ
Subject: Re: [rabbitmq-discuss] consumer cancel notify support in pika


On Wed, Oct 31, 2012 at 11:52 AM, Peter Friend &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pfriend at gehrytech.com</A>&lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pfriend at gehrytech.com</A>&gt;&gt; wrote:
1) Which version are you using?
0.9.5.

0.9.5 didn't pay as close attention to the protocol as 0.9.6 does. I'd recommend 0.9.6 at this point, especially for RPC calls from RabbitMQ.

The 0.9.6 version has method signature changes that make it incompatible with most of the docs out there and I had trouble getting it to work.

Hmm which methods changed that you're having problems with?  Also docs should be up to date at <A HREF="https://pika.readthedocs.org/&lt;https://pika.readthedocs.org/en/0.9.6/index.html">https://pika.readthedocs.org/&lt;https://pika.readthedocs.org/en/0.9.6/index.html</A>&gt; -- let me know if you're having any problems with them.
3) Did you register for a callback? Channel.add_on_cancel_callback(your_callback_method)
I have tried when using BlockingConnection but not the asynchronous one yet. My understanding from the docs was that an exception would be thrown in consume(). Is that not correct?

The problem with BlockingConnection in 0.9.5 is it doesn't pay attention to what RabbitMQ is telling it to do, unless you explicitly tell it to do so. It's likely a bug related to that causing your issue.

Here is an async consumer example that uses 0.9.6 and handles Basic.Cancel being invoked by RabbitMQ:

<A HREF="https://pika.readthedocs.org/en/latest/examples/asynchronous_consumer_example.html">https://pika.readthedocs.org/en/latest/examples/asynchronous_consumer_example.html</A>

In the blocking connection, you should see a pika.exceptions.ConsumerCancelled exception raised.

Hope this helps,

Gavin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/c365cdc6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/c365cdc6/attachment.htm</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023506.html">[rabbitmq-discuss] consumer cancel notify support in pika
</A></li>
	<LI>Next message: <A HREF="023476.html">[rabbitmq-discuss] the problem about the consumer connection can be	closed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23501">[ date ]</a>
              <a href="thread.html#23501">[ thread ]</a>
              <a href="subject.html#23501">[ subject ]</a>
              <a href="author.html#23501">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
