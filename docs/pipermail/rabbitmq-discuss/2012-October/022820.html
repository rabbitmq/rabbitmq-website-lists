<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Messages bigger than 150kb
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Messages%20bigger%20than%20150kb&In-Reply-To=%3CCAE3HoVT61FtUSLyjJFw_pmeq6v4JNFiOxsdU6azFwAs-UQG%3Dgg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022817.html">
   <LINK REL="Next"  HREF="022829.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Messages bigger than 150kb</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Messages%20bigger%20than%20150kb&In-Reply-To=%3CCAE3HoVT61FtUSLyjJFw_pmeq6v4JNFiOxsdU6azFwAs-UQG%3Dgg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Messages bigger than 150kb">michael.s.klishin at gmail.com
       </A><BR>
    <I>Thu Oct  4 09:50:00 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022817.html">[rabbitmq-discuss] Messages bigger than 150kb
</A></li>
        <LI>Next message: <A HREF="022829.html">[rabbitmq-discuss] Messages bigger than 150kb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22820">[ date ]</a>
              <a href="thread.html#22820">[ thread ]</a>
              <a href="subject.html#22820">[ subject ]</a>
              <a href="author.html#22820">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2012/10/4 Thomas Spycher &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">thomas.spycher at tech.swisssign.com</A>&gt;

&gt;<i> timeStart = time.time()
</I>&gt;<i>
</I>&gt;<i> self.rpcchannel.basic_publish(exchange='', routing_key='secureObjects',
</I>&gt;<i> properties=pika.BasicProperties(reply_to=self.rpcqueue ,
</I>&gt;<i> correlation_id=self._correlation_id,content_type=&quot;text/plain&quot;,delivery_mode=2),
</I>&gt;<i> body=serializedObject)
</I>&gt;<i>
</I>&gt;<i> print time.time() - timeStart
</I>&gt;<i>
</I>
This does not measure actual end-to-end throughput, only how fast Pika can
push things down the socket.
In that case, of course more data will take more time. In fact, Pika may
even delay sending the data
(I am not familiar with its internals but it is event loop-based AFAIR).

So what you are seeing is most likely Pika's internal buffer being
completely filled once you go above 150K,
in which case it has to do extra work, unlike with tiny messages. The same
can be true for buffers in layers below (OS does buffering for network I/O,
drivers may do that, etc).

When benchmarking a messaging system throughput, you need to do it
end-to-end, with [at least] 2 machines, a realistic
network link between them and understanding about how exactly your client
does publishing.

TCP settings like Nagle's algorithm [1] and phenomenons like TCP incast [2]
can make a noticeable difference in some cases.

1.
<A HREF="http://boundary.com/blog/2012/05/02/know-a-delay-nagles-algorithm-and-you/">http://boundary.com/blog/2012/05/02/know-a-delay-nagles-algorithm-and-you/</A>
2. <A HREF="http://www.snookles.com/slf-blog/2012/01/05/tcp-incast-what-is-it/">http://www.snookles.com/slf-blog/2012/01/05/tcp-incast-what-is-it/</A>
-- 
MK

<A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
<A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121004/492ff75f/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121004/492ff75f/attachment.htm</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022817.html">[rabbitmq-discuss] Messages bigger than 150kb
</A></li>
	<LI>Next message: <A HREF="022829.html">[rabbitmq-discuss] Messages bigger than 150kb
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22820">[ date ]</a>
              <a href="thread.html#22820">[ thread ]</a>
              <a href="subject.html#22820">[ subject ]</a>
              <a href="author.html#22820">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
