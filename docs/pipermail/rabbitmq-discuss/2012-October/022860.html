<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem installing RabbitMQ with Puppet on	CentOS 6.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20installing%20RabbitMQ%20with%20Puppet%20on%0A%09CentOS%206.2&In-Reply-To=%3C5a61a2fa-495c-49dd-8345-d6a591ea2832%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022875.html">
   <LINK REL="Next"  HREF="022871.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on	CentOS 6.2</H1>
    <B>Tobias Wissm&#252;ller</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20installing%20RabbitMQ%20with%20Puppet%20on%0A%09CentOS%206.2&In-Reply-To=%3C5a61a2fa-495c-49dd-8345-d6a591ea2832%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on	CentOS 6.2">tobias.wissmueller at googlemail.com
       </A><BR>
    <I>Fri Oct  5 07:05:07 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022875.html">[rabbitmq-discuss] Declaring bindings by an app that is not the	consumer
</A></li>
        <LI>Next message: <A HREF="022871.html">[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on CentOS 6.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22860">[ date ]</a>
              <a href="thread.html#22860">[ thread ]</a>
              <a href="subject.html#22860">[ subject ]</a>
              <a href="author.html#22860">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Everyone,

I encounter a strange problem when applying my puppet module I have created 
for installing RabbitMQ. To be more precise, I encounter the problem when 
enabling the plugins. 

The relevant resources look as follows:

$version = &quot;2.8.7&quot;
$url     = &quot;<A HREF="http://www.rabbitmq.com/releases/rabbitmq-server/v${version}/rabbitmq-server-${version}-1.noarch.rpm&quot;">http://www.rabbitmq.com/releases/rabbitmq-server/v${version}/rabbitmq-server-${version}-1.noarch.rpm&quot;</A>

package{&quot;erlang&quot;:
    ensure =&gt; &quot;present&quot;,
}

package{&quot;rabbitmq-server&quot;:
    provider =&gt; &quot;rpm&quot;,
    source   =&gt; $url,
    require  =&gt; Package[&quot;erlang&quot;]
}

exec{&quot;rabbitmq-plugins&quot;:
    path    =&gt; &quot;/usr/bin:/usr/sbin:/bin&quot;,
    command =&gt; &quot;rabbitmq-plugins enable rabbitmq_management&quot;,
    require =&gt; Package[&quot;rabbitmq-server&quot;]
}


The error I get:

/Stage[main]/Rabbitmq/Exec[rabbitmq-plugins]/returns: erlexec: HOME must be set

/Stage[main]/Rabbitmq/Service[rabbitmq-server]: Dependency Exec[rabbitmq-plugins] has failures: true

The thing is, that HOME is set. Have checked that during a puppet run by 
creating an exec resource to echo HOME.

When I log into the box that I create with veewee and vagrant, I can 
execute &quot;rabbitmq-plugins enable rabbitmq_management&quot; without any problems. 
But I always get the error from within puppet.

Starting rabbitmq-server leaves me with the following:

[{pid,2834},
{running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;2.8.7&quot;},
                    {ssl,&quot;Erlang/OTP SSL application&quot;,&quot;4.1.6&quot;},
                    {public_key,&quot;Public key infrastructure&quot;,&quot;0.13&quot;},
                    {crypto,&quot;CRYPTO version 2&quot;,&quot;2.0.4&quot;},
                    {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.5&quot;},
                    {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.7&quot;},
                    {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.10&quot;},
                    {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.5&quot;},
                    {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.5&quot;}]},
{os,{unix,linux}},
{erlang_version,&quot;Erlang R14B04 (erts-5.8.5) [source] [64-bit] [rq:1] [async-threads:30] [kernel-poll:true]\n&quot;},
{memory,[{total,24993120},
      {processes,10328496},
      {processes_used,10321296},
      {system,14664624},
      {atom,1175905},
      {atom_used,1143841},
      {binary,17192},
      {code,11416020},
      {ets,766168}]},
{vm_memory_high_watermark,0.4},
{vm_memory_limit,205851852},
{disk_free_limit,1000000000},
{disk_free,7089795072},
{file_descriptors,[{total_limit,924},
                {total_used,4},
                {sockets_limit,829},
                {sockets_used,2}]},
{processes,[{limit,1048576},{used,131}]},
{run_queue,0},
{uptime,6}]


The whole puppet manifest can be found under 
<A HREF="https://github.com/tobias-wissmueller/dev_ops_central/blob/master/modules/rabbitmq/manifests/init.pp">https://github.com/tobias-wissmueller/dev_ops_central/blob/master/modules/rabbitmq/manifests/init.pp</A>

Also have posted this problem over at Serverfault&lt;<A HREF="http://serverfault.com/questions/434942/veewee-vagrant-puppet-erlang-and-rabbitmq">http://serverfault.com/questions/434942/veewee-vagrant-puppet-erlang-and-rabbitmq</A>&gt;
.

Any help is highly appreciated since I am totally stuck here.

Thanks a lot!

Cheers,
Tobi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121004/df315e5f/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121004/df315e5f/attachment.htm</A>&gt;
</PRE>






































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022875.html">[rabbitmq-discuss] Declaring bindings by an app that is not the	consumer
</A></li>
	<LI>Next message: <A HREF="022871.html">[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on CentOS 6.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22860">[ date ]</a>
              <a href="thread.html#22860">[ thread ]</a>
              <a href="subject.html#22860">[ subject ]</a>
              <a href="author.html#22860">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
