<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem installing RabbitMQ with Puppet on CentOS 6.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20installing%20RabbitMQ%20with%20Puppet%20on%0A%20CentOS%206.2&In-Reply-To=%3C506EAC55.7040003%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022860.html">
   <LINK REL="Next"  HREF="022876.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on CentOS 6.2</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20installing%20RabbitMQ%20with%20Puppet%20on%0A%20CentOS%206.2&In-Reply-To=%3C506EAC55.7040003%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on CentOS 6.2">simon at rabbitmq.com
       </A><BR>
    <I>Fri Oct  5 10:45:57 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022860.html">[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on	CentOS 6.2
</A></li>
        <LI>Next message: <A HREF="022876.html">[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22871">[ date ]</a>
              <a href="thread.html#22871">[ thread ]</a>
              <a href="subject.html#22871">[ subject ]</a>
              <a href="author.html#22871">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hmm. There's nothing very obvious that I can think of. I've looked in 
the OTP source and that message really only appears if HOME is not set.

Things you might try:

* Run /usr/lib/rabbitmq/bin/rabbitmq-plugins instead, to remove a 
wrapper script

* Edit /usr/lib/rabbitmq/bin/rabbitmq-plugins to insert &quot;echo $HOME&quot; 
just before &quot;exec erl&quot;, see if it's really set at that point.

* If all else fails, edit the enabled plugins file directly rather than 
invoking rabbitmq-plugins. Set the contents of 
/etc/rabbitmq/enabled_plugins to exactly the string:

[rabbitmq_management].

including the full stop.

Cheers, Simon

On 05/10/12 07:05, Tobias Wissm&#252;ller wrote:
&gt;<i> Hi Everyone,
</I>&gt;<i>
</I>&gt;<i> I encounter a strange problem when applying my puppet module I have
</I>&gt;<i> created for installing RabbitMQ. To be more precise, I encounter the
</I>&gt;<i> problem when enabling the plugins.
</I>&gt;<i>
</I>&gt;<i> The relevant resources look as follows:
</I>&gt;<i>
</I>&gt;<i> |$version = &quot;2.8.7&quot;
</I>&gt;<i> $url     = &quot;<A HREF="http://www.rabbitmq.com/releases/rabbitmq-server/v${version}/rabbitmq-server-${version}-1.noarch.rpm&quot;">http://www.rabbitmq.com/releases/rabbitmq-server/v${version}/rabbitmq-server-${version}-1.noarch.rpm&quot;</A>
</I>&gt;<i>
</I>&gt;<i> package{&quot;erlang&quot;:
</I>&gt;<i>      ensure =&gt; &quot;present&quot;,
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> package{&quot;rabbitmq-server&quot;:
</I>&gt;<i>      provider =&gt; &quot;rpm&quot;,
</I>&gt;<i>      source   =&gt; $url,
</I>&gt;<i>      require  =&gt; Package[&quot;erlang&quot;]
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> exec{&quot;rabbitmq-plugins&quot;:
</I>&gt;<i>      path    =&gt; &quot;/usr/bin:/usr/sbin:/bin&quot;,
</I>&gt;<i>      command =&gt; &quot;rabbitmq-plugins enable rabbitmq_management&quot;,
</I>&gt;<i>      require =&gt; Package[&quot;rabbitmq-server&quot;]
</I>&gt;<i> }|
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The error I get:
</I>&gt;<i>
</I>&gt;<i> |/Stage[main]/Rabbitmq/Exec[rabbitmq-plugins]/returns: erlexec: HOME must be set|
</I>&gt;<i>
</I>&gt;<i> |/Stage[main]/Rabbitmq/Service[rabbitmq-server]: Dependency Exec[rabbitmq-plugins] has failures: true
</I>&gt;<i> |
</I>&gt;<i>
</I>&gt;<i> The thing is, that HOME is set. Have checked that during a puppet run by
</I>&gt;<i> creating an exec resource to echo HOME.
</I>&gt;<i>
</I>&gt;<i> When I log into the box that I create with veewee and vagrant, I can
</I>&gt;<i> execute &quot;rabbitmq-plugins enable rabbitmq_management&quot; without any
</I>&gt;<i> problems. But I always get the error from within puppet.
</I>&gt;<i>
</I>&gt;<i> Starting rabbitmq-server leaves me with the following:
</I>&gt;<i>
</I>&gt;<i> |[{pid,2834},
</I>&gt;<i> {running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;2.8.7&quot;},
</I>&gt;<i>                      {ssl,&quot;Erlang/OTP SSL application&quot;,&quot;4.1.6&quot;},
</I>&gt;<i>                      {public_key,&quot;Public key infrastructure&quot;,&quot;0.13&quot;},
</I>&gt;<i>                      {crypto,&quot;CRYPTO version 2&quot;,&quot;2.0.4&quot;},
</I>&gt;<i>                      {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.5&quot;},
</I>&gt;<i>                      {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.7&quot;},
</I>&gt;<i>                      {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.10&quot;},
</I>&gt;<i>                      {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.5&quot;},
</I>&gt;<i>                      {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.5&quot;}]},
</I>&gt;<i> {os,{unix,linux}},
</I>&gt;<i> {erlang_version,&quot;Erlang R14B04 (erts-5.8.5) [source] [64-bit] [rq:1] [async-threads:30] [kernel-poll:true]\n&quot;},
</I>&gt;<i> {memory,[{total,24993120},
</I>&gt;<i>        {processes,10328496},
</I>&gt;<i>        {processes_used,10321296},
</I>&gt;<i>        {system,14664624},
</I>&gt;<i>        {atom,1175905},
</I>&gt;<i>        {atom_used,1143841},
</I>&gt;<i>        {binary,17192},
</I>&gt;<i>        {code,11416020},
</I>&gt;<i>        {ets,766168}]},
</I>&gt;<i> {vm_memory_high_watermark,0.4},
</I>&gt;<i> {vm_memory_limit,205851852},
</I>&gt;<i> {disk_free_limit,1000000000},
</I>&gt;<i> {disk_free,7089795072},
</I>&gt;<i> {file_descriptors,[{total_limit,924},
</I>&gt;<i>                  {total_used,4},
</I>&gt;<i>                  {sockets_limit,829},
</I>&gt;<i>                  {sockets_used,2}]},
</I>&gt;<i> {processes,[{limit,1048576},{used,131}]},
</I>&gt;<i> {run_queue,0},
</I>&gt;<i> {uptime,6}]|
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The whole puppet manifest can be found under
</I>&gt;<i> <A HREF="https://github.com/tobias-wissmueller/dev_ops_central/blob/master/modules/rabbitmq/manifests/init.pp">https://github.com/tobias-wissmueller/dev_ops_central/blob/master/modules/rabbitmq/manifests/init.pp</A>
</I>&gt;<i>
</I>&gt;<i> Also have posted this problem over at Serverfault
</I>&gt;<i> &lt;<A HREF="http://serverfault.com/questions/434942/veewee-vagrant-puppet-erlang-and-rabbitmq">http://serverfault.com/questions/434942/veewee-vagrant-puppet-erlang-and-rabbitmq</A>&gt;.
</I>&gt;<i>
</I>&gt;<i> Any help is highly appreciated since I am totally stuck here.
</I>&gt;<i>
</I>&gt;<i> Thanks a lot!
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Tobi
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022860.html">[rabbitmq-discuss] Problem installing RabbitMQ with Puppet on	CentOS 6.2
</A></li>
	<LI>Next message: <A HREF="022876.html">[rabbitmq-discuss] RabbitMQ very slow (or never) shuts down
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22871">[ date ]</a>
              <a href="thread.html#22871">[ thread ]</a>
              <a href="subject.html#22871">[ subject ]</a>
              <a href="author.html#22871">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
