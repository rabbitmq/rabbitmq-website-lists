<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Persistent messages on durable queue sometimes not delivered to consumers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Persistent%20messages%20on%20durable%20queue%0A%20sometimes%20not%20delivered%20to%20consumers&In-Reply-To=%3C508A68C7.2080604%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023372.html">
   <LINK REL="Next"  HREF="023365.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Persistent messages on durable queue sometimes not delivered to consumers</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Persistent%20messages%20on%20durable%20queue%0A%20sometimes%20not%20delivered%20to%20consumers&In-Reply-To=%3C508A68C7.2080604%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Persistent messages on durable queue sometimes not delivered to consumers">emile at rabbitmq.com
       </A><BR>
    <I>Fri Oct 26 11:41:11 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023372.html">[rabbitmq-discuss] Persistent messages on durable queue sometimes not delivered to consumers
</A></li>
        <LI>Next message: <A HREF="023365.html">[rabbitmq-discuss] Validity of /api/aliveness-test in a clustered	environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23378">[ date ]</a>
              <a href="thread.html#23378">[ thread ]</a>
              <a href="subject.html#23378">[ subject ]</a>
              <a href="author.html#23378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On 26/10/12 00:50, Tyler Power wrote:
&gt;<i> I am using RabbitMQ Server 2.4
</I>
That's quite old. You should consider upgrading.

&gt;<i> I am using the default exchange (&quot;&quot;), which sounds adequate for our
</I>&gt;<i> needs right now, but thought I'd point it out incase I'm not using it
</I>&gt;<i> the way it was intended.
</I>
Using the default exchange is fine.

&gt;<i> In the server I can see the SubmitDeploymentToQueue() method always
</I>&gt;<i> completes successfully, so it appears messages are /always/ being
</I>&gt;<i> submitted to RabbitMQ, but in the Consume() method of the consumer,
</I>&gt;<i> the consumer.Queue.Dequeue() method /sometimes/ does not return a
</I>&gt;<i> message, so the next line (the console.writeline) is never called etc.
</I>&gt;<i> and it will just sit there blocking.
</I>
This is normal behaviour if there is no message. If you think there is
an error then you should independently confirm using the management
plugin or using rabbitmqctl whether there are any messages.

&gt;<i> In this situation where messages appear to be lost, restarting the
</I>&gt;<i> consumers doesn't fix it, the messages are simply never delivered and
</I>&gt;<i> seem to be lost forever.
</I>
Messages should never inadvertently get lost.

You can use publisher confirms to make sure messages don't get lost
between the publisher and the broker:
<A HREF="http://www.rabbitmq.com/confirms.html">http://www.rabbitmq.com/confirms.html</A>

You can use the mandatory flag to make sure unroutable messages are
detected:
<A HREF="http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.publish.mandatory">http://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.publish.mandatory</A>

You can declare queues durable and publish messages persistent to guard
against the broker crashing.

You can use dead-letter-exchanges to make sure messages don't get lost
from queues:
<A HREF="http://www.rabbitmq.com/dlx.html">http://www.rabbitmq.com/dlx.html</A>

You can use consumer acknowledgements to make sure messages don't get
lost when consumers crash while processing messages:
<A HREF="http://www.rabbitmq.com/amqp-0-9-1-quickref.html#basic.ack">http://www.rabbitmq.com/amqp-0-9-1-quickref.html#basic.ack</A>

If you have found a way for messages to get lost then please post a
minimal self-contained piece of code that demonstrates the error on the
latest released version.


-Emile






</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023372.html">[rabbitmq-discuss] Persistent messages on durable queue sometimes not delivered to consumers
</A></li>
	<LI>Next message: <A HREF="023365.html">[rabbitmq-discuss] Validity of /api/aliveness-test in a clustered	environment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23378">[ date ]</a>
              <a href="thread.html#23378">[ thread ]</a>
              <a href="subject.html#23378">[ subject ]</a>
              <a href="author.html#23378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
