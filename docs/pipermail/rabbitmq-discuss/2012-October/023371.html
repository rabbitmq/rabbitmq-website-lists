<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Implementation of EAI Detour Pattern with	the JAVA API v2.8.7
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Implementation%20of%20EAI%20Detour%20Pattern%20with%0A%09the%20JAVA%20API%20v2.8.7&In-Reply-To=%3C8BA63735-5C34-412C-A185-C13C1AB39DD9%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023370.html">
   <LINK REL="Next"  HREF="023386.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Implementation of EAI Detour Pattern with	the JAVA API v2.8.7</H1>
    <B>Tim Watson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Implementation%20of%20EAI%20Detour%20Pattern%20with%0A%09the%20JAVA%20API%20v2.8.7&In-Reply-To=%3C8BA63735-5C34-412C-A185-C13C1AB39DD9%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Implementation of EAI Detour Pattern with	the JAVA API v2.8.7">tim at rabbitmq.com
       </A><BR>
    <I>Fri Oct 26 09:47:42 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023370.html">[rabbitmq-discuss] Implementation of EAI Detour Pattern with the	JAVA API v2.8.7
</A></li>
        <LI>Next message: <A HREF="023386.html">[rabbitmq-discuss] RabbbitMQ Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23371">[ date ]</a>
              <a href="thread.html#23371">[ thread ]</a>
              <a href="subject.html#23371">[ subject ]</a>
              <a href="author.html#23371">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi - where does the detour need to go? This kind of content based routing is normally dealt with via a control bus, although you could implement the choice logic using a headers or topic exchange. The *big* question is where this detour takes you - is it to another consumer that is acting as a content enricher, which sounds like what you've described? Anyway, we'd need a bit more information to make any useful suggestions I think

a) where does the additional content come from?
b) is this (a) running in another Java/AMQP client?
c) *how* do you decide to get to (a)? Can you make this decision based on message headers/properties?

If the answer to (b) is 'yes' then you can probably do something quite easily. Bare in mind that any AMQP client can inspect message headers as well as content. So the following points might help you figure this out...

- your (a) is a good example of a Content Enricher
- you can keep track of where messages have been by adding a Routing Slip
- if your Content Enricher is another AMQP client, it can add additional headers and resend transformed messages anywhere it likes
- RabbitMQ provides exchanges that can be used to route messages based on routing keys or header properties

With all those facilities at your disposal, you should be able to do everything you need:

* route messages that 'need enrichment' to the correct processor, based on the presence/lack of a Routine Slip
* route messages marked as 'complete' directly, based on the presence/value of a Routing Slip

I'd need to know more to suggest anything more specific. I can also suggest that frameworks like Spring Integration and Apache Camel provide neat capabilities for integrating with RabbitMQ (using AMQP of course) so that you can write your processing/enriching and header munging code easily.

HTH

Cheers,
Tim


On 26 Oct 2012, at 09:14, Chikhi Mimoun wrote:

&gt;<i> Hi,
</I>&gt;<i>  
</I>&gt;<i> I juste began few days ago on rabbitmq and I need some help.
</I>&gt;<i>  
</I>&gt;<i> a part of the project is :
</I>&gt;<i> - we have a producer that send a message (sometimes with less data)
</I>&gt;<i> - we have a consumer that receive the message but needs all datas.
</I>&gt;<i>  
</I>&gt;<i> So, sometimes, after the message sent, we need to make a detour in order to complete the message,
</I>&gt;<i> before being re-sent to the consumer.
</I>&gt;<i>  
</I>&gt;<i> It's a kind of content-based routing.
</I>&gt;<i>  
</I>&gt;<i> I found a pattern that matches with this case : the Detour Pattern.
</I>&gt;<i>  
</I>&gt;<i> Is it possible to implement this with the current rabbitmq java API and how ?
</I>&gt;<i>  
</I>&gt;<i> thx.
</I>&gt;<i>  
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
</PRE>





































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023370.html">[rabbitmq-discuss] Implementation of EAI Detour Pattern with the	JAVA API v2.8.7
</A></li>
	<LI>Next message: <A HREF="023386.html">[rabbitmq-discuss] RabbbitMQ Queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23371">[ date ]</a>
              <a href="thread.html#23371">[ thread ]</a>
              <a href="subject.html#23371">[ subject ]</a>
              <a href="author.html#23371">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
