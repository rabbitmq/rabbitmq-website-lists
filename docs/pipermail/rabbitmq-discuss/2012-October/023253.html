<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Channel thread-safety
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Channel%20thread-safety&In-Reply-To=%3CCAM8Y7yBqrHE8kvF38htNLnqZ3CSCGqkUQLJoaTwDK0p0qfWpoQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023294.html">
   <LINK REL="Next"  HREF="023255.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Channel thread-safety</H1>
    <B>Laurent Vauthrin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Channel%20thread-safety&In-Reply-To=%3CCAM8Y7yBqrHE8kvF38htNLnqZ3CSCGqkUQLJoaTwDK0p0qfWpoQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Channel thread-safety">lvauthrin at gmail.com
       </A><BR>
    <I>Mon Oct 22 20:05:42 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023294.html">[rabbitmq-discuss] Help
</A></li>
        <LI>Next message: <A HREF="023255.html">[rabbitmq-discuss] Channel thread-safety
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23253">[ date ]</a>
              <a href="thread.html#23253">[ thread ]</a>
              <a href="subject.html#23253">[ subject ]</a>
              <a href="author.html#23253">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I've done some searching but can't seem to answer a couple of questions.
 In the API guide, I saw:

&quot;Channel instances are safe for use by multiple threads. Requests into a
Channel are serialized, with only one thread being able to run a command on
the Channel at a time. Even so, applications should prefer using a Channel
per thread instead of sharing the same Channel across multiple threads.&quot;

And in the Javadocs for Channel, I saw:

&quot;While a Channel can be used by multiple threads, it's important to ensure
that only one thread executes a command at once. Concurrent execution of
commands will likely cause an UnexpectedFrameError to be thrown.&quot;

Currently, our service shares the same channel across each request thread
and we synchronize the call to 'basicPublish'.  Looking at the basicPublish
code, it looks like the sequence number member variable is not thread safe
but it doesn't affect us since we're not ack'ing our messages.

My questions are:
1. Should we be using a channel per thread considering that we're
synchronizing the basicPublish call anyway?
2. Can we just share one channel across all threads and not synchronize the
call to basicPublish?

Thanks,
Laurent
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121022/ab4de8ca/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121022/ab4de8ca/attachment.htm</A>&gt;
</PRE>












































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023294.html">[rabbitmq-discuss] Help
</A></li>
	<LI>Next message: <A HREF="023255.html">[rabbitmq-discuss] Channel thread-safety
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23253">[ date ]</a>
              <a href="thread.html#23253">[ thread ]</a>
              <a href="subject.html#23253">[ subject ]</a>
              <a href="author.html#23253">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
