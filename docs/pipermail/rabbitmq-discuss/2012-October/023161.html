<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] question on message ordering guarantees
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20question%20on%20message%20ordering%20guarantees&In-Reply-To=%3CCACOPnvfyOUAUMb5KeHZxeXmc6O8%3DeKBAXWDVV7c5JppzZjeO4w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023159.html">
   <LINK REL="Next"  HREF="023162.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] question on message ordering guarantees</H1>
    <B>Alexis Richardson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20question%20on%20message%20ordering%20guarantees&In-Reply-To=%3CCACOPnvfyOUAUMb5KeHZxeXmc6O8%3DeKBAXWDVV7c5JppzZjeO4w%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] question on message ordering guarantees">alexis at rabbitmq.com
       </A><BR>
    <I>Thu Oct 18 12:05:47 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023159.html">[rabbitmq-discuss] question on message ordering guarantees
</A></li>
        <LI>Next message: <A HREF="023162.html">[rabbitmq-discuss] question on message ordering guarantees
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23161">[ date ]</a>
              <a href="thread.html#23161">[ thread ]</a>
              <a href="subject.html#23161">[ subject ]</a>
              <a href="author.html#23161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>See the long discussion on ordering posted in the depths of the thread here:

<A HREF="http://www.quora.com/RabbitMQ/RabbitMQ-vs-Kafka-which-one-for-durable-messaging-with-good-query-features/">http://www.quora.com/RabbitMQ/RabbitMQ-vs-Kafka-which-one-for-durable-messaging-with-good-query-features/</A>

Note that Kafka has at most one consumer per 'partition' which is
equivalent to the property Tim described.


On Thu, Oct 18, 2012 at 12:03 PM, Alexis Richardson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt; wrote:
&gt;<i> If you use the consistent hashing exchange, then you can make sure
</I>&gt;<i> that two messages with the same key are sent to the same queue.  Then,
</I>&gt;<i> provided you do not allow parallel processing of those messages due to
</I>&gt;<i> how they are consumed, you can &quot;process in order&quot; as required.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Oct 18, 2012 at 11:43 AM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
</I>&gt;&gt;<i> Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 10/18/2012 10:30 AM, Artur Ejsmont wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi there everyone,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am working on a rabbitmq based messaging system and i was wondering if you
</I>&gt;&gt;<i> could help me out :)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was wondering how could i enforce events being processed in the order they
</I>&gt;&gt;<i> are published?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So from <A HREF="http://www.rabbitmq.com/semantics.html,">http://www.rabbitmq.com/semantics.html,</A> we can see:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;Section 4.7 of the AMQP 0-9-1 core specification explains the conditions
</I>&gt;&gt;<i> under which ordering is guaranteed: messages published in one channel,
</I>&gt;&gt;<i> passing through one exchange and one queue and one outgoing channel will be
</I>&gt;&gt;<i> received in the same order that they were sent. RabbitMQ offers stronger
</I>&gt;&gt;<i> guarantees since release 2.7.0.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Messages can be returned to the queue using AMQP methods that feature a
</I>&gt;&gt;<i> requeue parameter (basic.recover, basic.reject and basic.nack), or due to a
</I>&gt;&gt;<i> channel closing while holding unacknowledged messages. Any of these
</I>&gt;&gt;<i> scenarios caused messages to be requeued at the back of the queue for
</I>&gt;&gt;<i> RabbitMQ releases earlier than 2.7.0. From RabbitMQ release 2.7.0, messages
</I>&gt;&gt;<i> are always held in the queue in publication order, even in the presence of
</I>&gt;&gt;<i> requeueing or channel closure.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> With release 2.7.0 and later it is still possible for individual consumers
</I>&gt;&gt;<i> to observe messages out of order if the queue has multiple subscribers. This
</I>&gt;&gt;<i> is due to the actions of other subscribers who may requeue messages. From
</I>&gt;&gt;<i> the perspective of the queue the messages are always held in the publication
</I>&gt;&gt;<i> order.&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So you've got to think about it in those terms. It's exactly the same with
</I>&gt;&gt;<i> ActiveMQ message groups, because they are based on the Exclusive Consumer
</I>&gt;&gt;<i> feature, which states: &quot;The broker will pick a single MessageConsumer to get
</I>&gt;&gt;<i> all the messages for a queue to ensure ordering. If that consumer fails, the
</I>&gt;&gt;<i> broker will auto failover and choose another consumer.&quot;
</I>&gt;&gt;<i> (<A HREF="http://activemq.apache.org/exclusive-consumer.html">http://activemq.apache.org/exclusive-consumer.html</A>) except that groups are
</I>&gt;&gt;<i> parallel, so: &quot;... logically Message Groups are kinda like a parallel
</I>&gt;&gt;<i> Exclusive Consumer. Rather than all messages going to a single consumer, the
</I>&gt;&gt;<i> standard JMS header JMSXGroupID is used to define which message group the
</I>&gt;&gt;<i> message belongs to. The Message Group feature then ensures that all messages
</I>&gt;&gt;<i> for the same message group will be sent to the same JMS consumer - while
</I>&gt;&gt;<i> that consumer stays alive. As soon as the consumer dies another will be
</I>&gt;&gt;<i> chosen.&quot; (<A HREF="http://activemq.apache.org/message-groups.html">http://activemq.apache.org/message-groups.html</A>).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You might be able kludge something similar using the consistent hash
</I>&gt;&gt;<i> exchange plugin
</I>&gt;&gt;<i> (<A HREF="http://hg.rabbitmq.com/rabbitmq-consistent-hash-exchange/file/rabbitmq_v2_8_7/README.md">http://hg.rabbitmq.com/rabbitmq-consistent-hash-exchange/file/rabbitmq_v2_8_7/README.md</A>)
</I>&gt;&gt;<i> but you will *not* get the same kind of guarantees.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We have been asked about this feature before and will probably implement
</I>&gt;&gt;<i> something like it in a future release.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i> Tim
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I></PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023159.html">[rabbitmq-discuss] question on message ordering guarantees
</A></li>
	<LI>Next message: <A HREF="023162.html">[rabbitmq-discuss] question on message ordering guarantees
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23161">[ date ]</a>
              <a href="thread.html#23161">[ thread ]</a>
              <a href="subject.html#23161">[ subject ]</a>
              <a href="author.html#23161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
