<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] question on message ordering guarantees
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20question%20on%20message%20ordering%20guarantees&In-Reply-To=%3CCABv2Cn3i6AW1Fto38NqFj0Tp-kY8p3i1XSjrAguS0wV3GWS8Ug%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023161.html">
   <LINK REL="Next"  HREF="023166.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] question on message ordering guarantees</H1>
    <B>Artur Ejsmont</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20question%20on%20message%20ordering%20guarantees&In-Reply-To=%3CCABv2Cn3i6AW1Fto38NqFj0Tp-kY8p3i1XSjrAguS0wV3GWS8Ug%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] question on message ordering guarantees">ejsmont.artur at gmail.com
       </A><BR>
    <I>Thu Oct 18 12:25:04 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023161.html">[rabbitmq-discuss] question on message ordering guarantees
</A></li>
        <LI>Next message: <A HREF="023166.html">[rabbitmq-discuss] Typos on tutorials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23162">[ date ]</a>
              <a href="thread.html#23162">[ thread ]</a>
              <a href="subject.html#23162">[ subject ]</a>
              <a href="author.html#23162">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks guys! these were very helpful and quick responses.

I will read the docs you recommended and come back in case of any further
ideas or questions :)

Thanks a lot

Art

On 18 October 2012 22:05, Alexis Richardson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt; wrote:

&gt;<i> See the long discussion on ordering posted in the depths of the thread
</I>&gt;<i> here:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.quora.com/RabbitMQ/RabbitMQ-vs-Kafka-which-one-for-durable-messaging-with-good-query-features/">http://www.quora.com/RabbitMQ/RabbitMQ-vs-Kafka-which-one-for-durable-messaging-with-good-query-features/</A>
</I>&gt;<i>
</I>&gt;<i> Note that Kafka has at most one consumer per 'partition' which is
</I>&gt;<i> equivalent to the property Tim described.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Oct 18, 2012 at 12:03 PM, Alexis Richardson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">alexis at rabbitmq.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; If you use the consistent hashing exchange, then you can make sure
</I>&gt;<i> &gt; that two messages with the same key are sent to the same queue.  Then,
</I>&gt;<i> &gt; provided you do not allow parallel processing of those messages due to
</I>&gt;<i> &gt; how they are consumed, you can &quot;process in order&quot; as required.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Thu, Oct 18, 2012 at 11:43 AM, Tim Watson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tim at rabbitmq.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; Hi
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On 10/18/2012 10:30 AM, Artur Ejsmont wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Hi there everyone,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I am working on a rabbitmq based messaging system and i was wondering
</I>&gt;<i> if you
</I>&gt;<i> &gt;&gt; could help me out :)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I was wondering how could i enforce events being processed in the order
</I>&gt;<i> they
</I>&gt;<i> &gt;&gt; are published?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So from <A HREF="http://www.rabbitmq.com/semantics.html,">http://www.rabbitmq.com/semantics.html,</A> we can see:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &quot;Section 4.7 of the AMQP 0-9-1 core specification explains the
</I>&gt;<i> conditions
</I>&gt;<i> &gt;&gt; under which ordering is guaranteed: messages published in one channel,
</I>&gt;<i> &gt;&gt; passing through one exchange and one queue and one outgoing channel
</I>&gt;<i> will be
</I>&gt;<i> &gt;&gt; received in the same order that they were sent. RabbitMQ offers stronger
</I>&gt;<i> &gt;&gt; guarantees since release 2.7.0.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Messages can be returned to the queue using AMQP methods that feature a
</I>&gt;<i> &gt;&gt; requeue parameter (basic.recover, basic.reject and basic.nack), or due
</I>&gt;<i> to a
</I>&gt;<i> &gt;&gt; channel closing while holding unacknowledged messages. Any of these
</I>&gt;<i> &gt;&gt; scenarios caused messages to be requeued at the back of the queue for
</I>&gt;<i> &gt;&gt; RabbitMQ releases earlier than 2.7.0. From RabbitMQ release 2.7.0,
</I>&gt;<i> messages
</I>&gt;<i> &gt;&gt; are always held in the queue in publication order, even in the presence
</I>&gt;<i> of
</I>&gt;<i> &gt;&gt; requeueing or channel closure.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; With release 2.7.0 and later it is still possible for individual
</I>&gt;<i> consumers
</I>&gt;<i> &gt;&gt; to observe messages out of order if the queue has multiple subscribers.
</I>&gt;<i> This
</I>&gt;<i> &gt;&gt; is due to the actions of other subscribers who may requeue messages.
</I>&gt;<i> From
</I>&gt;<i> &gt;&gt; the perspective of the queue the messages are always held in the
</I>&gt;<i> publication
</I>&gt;<i> &gt;&gt; order.&quot;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So you've got to think about it in those terms. It's exactly the same
</I>&gt;<i> with
</I>&gt;<i> &gt;&gt; ActiveMQ message groups, because they are based on the Exclusive
</I>&gt;<i> Consumer
</I>&gt;<i> &gt;&gt; feature, which states: &quot;The broker will pick a single MessageConsumer
</I>&gt;<i> to get
</I>&gt;<i> &gt;&gt; all the messages for a queue to ensure ordering. If that consumer
</I>&gt;<i> fails, the
</I>&gt;<i> &gt;&gt; broker will auto failover and choose another consumer.&quot;
</I>&gt;<i> &gt;&gt; (<A HREF="http://activemq.apache.org/exclusive-consumer.html">http://activemq.apache.org/exclusive-consumer.html</A>) except that
</I>&gt;<i> groups are
</I>&gt;<i> &gt;&gt; parallel, so: &quot;... logically Message Groups are kinda like a parallel
</I>&gt;<i> &gt;&gt; Exclusive Consumer. Rather than all messages going to a single
</I>&gt;<i> consumer, the
</I>&gt;<i> &gt;&gt; standard JMS header JMSXGroupID is used to define which message group
</I>&gt;<i> the
</I>&gt;<i> &gt;&gt; message belongs to. The Message Group feature then ensures that all
</I>&gt;<i> messages
</I>&gt;<i> &gt;&gt; for the same message group will be sent to the same JMS consumer - while
</I>&gt;<i> &gt;&gt; that consumer stays alive. As soon as the consumer dies another will be
</I>&gt;<i> &gt;&gt; chosen.&quot; (<A HREF="http://activemq.apache.org/message-groups.html">http://activemq.apache.org/message-groups.html</A>).
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; You might be able kludge something similar using the consistent hash
</I>&gt;<i> &gt;&gt; exchange plugin
</I>&gt;<i> &gt;&gt; (
</I>&gt;<i> <A HREF="http://hg.rabbitmq.com/rabbitmq-consistent-hash-exchange/file/rabbitmq_v2_8_7/README.md">http://hg.rabbitmq.com/rabbitmq-consistent-hash-exchange/file/rabbitmq_v2_8_7/README.md</A>
</I>&gt;<i> )
</I>&gt;<i> &gt;&gt; but you will *not* get the same kind of guarantees.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; We have been asked about this feature before and will probably implement
</I>&gt;<i> &gt;&gt; something like it in a future release.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Cheers,
</I>&gt;<i> &gt;&gt; Tim
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; rabbitmq-discuss mailing list
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i>
</I>


-- 
Visit me at:
<A HREF="http://artur.ejsmont.org/blog/">http://artur.ejsmont.org/blog/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121018/e3d754b3/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121018/e3d754b3/attachment.htm</A>&gt;
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023161.html">[rabbitmq-discuss] question on message ordering guarantees
</A></li>
	<LI>Next message: <A HREF="023166.html">[rabbitmq-discuss] Typos on tutorials
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23162">[ date ]</a>
              <a href="thread.html#23162">[ thread ]</a>
              <a href="subject.html#23162">[ subject ]</a>
              <a href="author.html#23162">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
