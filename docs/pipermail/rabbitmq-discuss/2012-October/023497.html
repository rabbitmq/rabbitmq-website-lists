<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbit_mgmt_db crashed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbit_mgmt_db%20crashed&In-Reply-To=%3CBCC407A444557E41B0D8B0260D684992058F7213%40CA1EXCLV07.adcorp.kla-tencor.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023494.html">
   <LINK REL="Next"  HREF="023466.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbit_mgmt_db crashed</H1>
    <B>Chen, Bin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbit_mgmt_db%20crashed&In-Reply-To=%3CBCC407A444557E41B0D8B0260D684992058F7213%40CA1EXCLV07.adcorp.kla-tencor.com%3E"
       TITLE="[rabbitmq-discuss] rabbit_mgmt_db crashed">Bin.Chen at kla-tencor.com
       </A><BR>
    <I>Wed Oct 31 18:48:43 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023494.html">[rabbitmq-discuss] rabbit_mgmt_db crashed
</A></li>
        <LI>Next message: <A HREF="023466.html">[rabbitmq-discuss] Production ready C++ client library?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23497">[ date ]</a>
              <a href="thread.html#23497">[ thread ]</a>
              <a href="subject.html#23497">[ subject ]</a>
              <a href="author.html#23497">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Simon,

I found the similar crash reports on another RMQ server.
It had happened a few times.
However, the memory utilization didn't went up greatly as another
server.

Two of the attached zip files are the eval output and report output.
The other one is the sasl log file containing the crash reports.

 
Thanks,
--Bin Chen


-----Original Message-----
From: Simon MacMullen [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>] 
Sent: Wednesday, October 31, 2012 4:07 AM
To: Discussions about RabbitMQ
Cc: Chen, Bin
Subject: Re: [rabbitmq-discuss] rabbit_mgmt_db crashed

Hi. I remember you posted a similar stack trace six months ago:

<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2012-May/019990.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2012-May/019990.htm</A>
l

I stared at the code involved for some time but was completely unable to
see how that could occur. I don't suppose you have any way to replicate
this?

Apart from that, could you post the output of:

rabbitmqctl.bat eval
&quot;lists:sublist(lists:reverse(lists:sort([{process_info(Pid, memory),
Pid, process_info(Pid)} || Pid &lt;- processes()])), 30).&quot;

(all on one line)

and

rabbitmqctl.bat report

somewhere please?

Cheers, Simon

On 31/10/12 00:09, Chen, Bin wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I just noticed a crash report in sasl log of one of our RMQ server.
</I>&gt;<i>
</I>&gt;<i> It seems the management plug-in crashed. The management web page 
</I>&gt;<i> cannot be opened any more.
</I>&gt;<i>
</I>&gt;<i> I had this problem before with an old version. Now I am using 2.8.6 
</I>&gt;<i> 64-bit version on Windows 2008 Server.
</I>&gt;<i>
</I>&gt;<i> The RMQ server is still running fine, but the memory utilization is 
</I>&gt;<i> much higher than other similar servers without such crash.
</I>&gt;<i>
</I>&gt;<i> This &quot;bad&quot; server uses about 8 GB memory now, while other normal 
</I>&gt;<i> servers use only about 500 MB memory.
</I>&gt;<i>
</I>&gt;<i> It may eventually hit the high memory water mark soon at 9.6 GB.
</I>&gt;<i>
</I>&gt;<i> Here is the complete crash report.
</I>&gt;<i>
</I>&gt;<i> =CRASH REPORT==== 29-Oct-2012::23:01:08 ===
</I>&gt;<i>
</I>&gt;<i>    crasher:
</I>&gt;<i>
</I>&gt;<i>      initial call: rabbit_mgmt_db:init/1
</I>&gt;<i>
</I>&gt;<i>      pid: &lt;0.284.0&gt;
</I>&gt;<i>
</I>&gt;<i>      registered_name: []
</I>&gt;<i>
</I>&gt;<i>      exception exit: {badarith,
</I>&gt;<i>
</I>&gt;<i>                          [{rabbit_mgmt_db,rate,5,[]},
</I>&gt;<i>
</I>&gt;<i>                           {rabbit_mgmt_db,'-rates/5-lc$^0/1-0-',5,[]},
</I>&gt;<i>
</I>&gt;<i>                           {rabbit_mgmt_db,'-rates/5-lc$^1/1-1-',6,[]},
</I>&gt;<i>
</I>&gt;<i>                           {rabbit_mgmt_db,rates,5,[]},
</I>&gt;<i>
</I>&gt;<i>                           {rabbit_mgmt_db,handle_fine_stat,7,[]},
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> {rabbit_mgmt_db,'-handle_fine_stats/4-lc$^1/1-1-',4,
</I>&gt;<i>
</I>&gt;<i>                               []},
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         {rabbit_mgmt_db,'-handle_event/2-lc$^1/1-0-',4,[]},
</I>&gt;<i>
</I>&gt;<i>                           {rabbit_mgmt_db,handle_event,2,[]}]}
</I>&gt;<i>
</I>&gt;<i>        in function  gen_server:terminate/6 (gen_server.erl, line 747)
</I>&gt;<i>
</I>&gt;<i>      ancestors: [&lt;0.281.0&gt;,rabbit_mgmt_sup,&lt;0.262.0&gt;]
</I>&gt;<i>
</I>&gt;<i>      messages: [{'$gen_cast',
</I>&gt;<i>
</I>&gt;<i>                        {event,
</I>&gt;<i>
</I>&gt;<i>                            {event,channel_stats,
</I>&gt;<i>
</I>&gt;<i>                                [{pid,&lt;0.12756.396&gt;},
</I>&gt;<i>
</I>&gt;<i>                                 {transactional,false},
</I>&gt;<i>
</I>&gt;<i>                                 {confirm,false},
</I>&gt;<i>
</I>&gt;<i>                                 {consumer_count,0},
</I>&gt;<i>
</I>&gt;<i>                                 {messages_unacknowledged,0},
</I>&gt;<i>
</I>&gt;<i>                                 {messages_unconfirmed,0},
</I>&gt;<i>
</I>&gt;<i>                                 {messages_uncommitted,0},
</I>&gt;<i>
</I>&gt;<i>                                 {acks_uncommitted,0},
</I>&gt;<i>
</I>&gt;<i>                                 {prefetch_count,1},
</I>&gt;<i>
</I>&gt;<i>                                 {client_flow_blocked,false},
</I>&gt;<i>
</I>&gt;<i>                                 {channel_queue_stats,[]},
</I>&gt;<i>
</I>&gt;<i>                                 {channel_exchange_stats,[]},
</I>&gt;<i>
</I>&gt;<i>                                 {channel_queue_exchange_stats,[]}],
</I>&gt;<i>
</I>&gt;<i>                                {1351,576868,812003}}}}]
</I>&gt;<i>
</I>&gt;<i>      links: [&lt;0.281.0&gt;]
</I>&gt;<i>
</I>&gt;<i>      dictionary: []
</I>&gt;<i>
</I>&gt;<i>      trap_exit: false
</I>&gt;<i>
</I>&gt;<i>      status: running
</I>&gt;<i>
</I>&gt;<i>      heap_size: 6765
</I>&gt;<i>
</I>&gt;<i>      stack_size: 24
</I>&gt;<i>
</I>&gt;<i>      reductions: 3730467164
</I>&gt;<i>
</I>&gt;<i>    neighbours:
</I>&gt;<i>
</I>&gt;<i> Here is the output of &quot;rabbitmqctl.bat status&quot;
</I>&gt;<i>
</I>&gt;<i> Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RACK4UNIT001</A> ...
</I>&gt;<i>
</I>&gt;<i> [{pid,4708},
</I>&gt;<i>
</I>&gt;<i> {running_applications,
</I>&gt;<i>
</I>&gt;<i>       [{rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;2.8.6&quot;},
</I>&gt;<i>
</I>&gt;<i>        {rabbitmq_management_agent,&quot;RabbitMQ Management 
</I>&gt;<i> Agent&quot;,&quot;2.8.6&quot;},
</I>&gt;<i>
</I>&gt;<i>        {amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.8.6&quot;},
</I>&gt;<i>
</I>&gt;<i>        {rabbit,&quot;RabbitMQ&quot;,&quot;2.8.6&quot;},
</I>&gt;<i>
</I>&gt;<i>        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.10&quot;},
</I>&gt;<i>
</I>&gt;<i>        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.2.1&quot;},
</I>&gt;<i>
</I>&gt;<i>        {rabbitmq_mochiweb,&quot;RabbitMQ Mochiweb Embedding&quot;,&quot;2.8.6&quot;},
</I>&gt;<i>
</I>&gt;<i>        {webmachine,&quot;webmachine&quot;,&quot;1.9.1-rmq2.8.6-git52e62bc&quot;},
</I>&gt;<i>
</I>&gt;<i>        {mochiweb,&quot;MochiMedia Web Server&quot;,&quot;2.3.1-rmq2.8.6-gitd541e9a&quot;},
</I>&gt;<i>
</I>&gt;<i>        {xmerl,&quot;XML parser&quot;,&quot;1.3.2&quot;},
</I>&gt;<i>
</I>&gt;<i>        {inets,&quot;INETS  CXC 138 49&quot;,&quot;5.9.1&quot;},
</I>&gt;<i>
</I>&gt;<i>        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.7.1&quot;},
</I>&gt;<i>
</I>&gt;<i>        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.18.2&quot;},
</I>&gt;<i>
</I>&gt;<i>        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.15.2&quot;}]},
</I>&gt;<i>
</I>&gt;<i> {os,{win32,nt}},
</I>&gt;<i>
</I>&gt;<i> {erlang_version,
</I>&gt;<i>
</I>&gt;<i>       &quot;Erlang R15B02 (erts-5.9.2) [64-bit] [smp:12:12] 
</I>&gt;<i> [async-threads:30]\n&quot;},
</I>&gt;<i>
</I>&gt;<i> {memory,
</I>&gt;<i>
</I>&gt;<i>       [{total,8512001360},
</I>&gt;<i>
</I>&gt;<i>        {processes,7401925315},
</I>&gt;<i>
</I>&gt;<i>        {processes_used,7401754972},
</I>&gt;<i>
</I>&gt;<i>        {system,1110076045},
</I>&gt;<i>
</I>&gt;<i>        {atom,662409},
</I>&gt;<i>
</I>&gt;<i>        {atom_used,652416},
</I>&gt;<i>
</I>&gt;<i>        {binary,857726336},
</I>&gt;<i>
</I>&gt;<i>        {code,17969722},
</I>&gt;<i>
</I>&gt;<i>        {ets,4550280}]},
</I>&gt;<i>
</I>&gt;<i> {vm_memory_high_watermark,0.4},
</I>&gt;<i>
</I>&gt;<i> {vm_memory_limit,10304190873},
</I>&gt;<i>
</I>&gt;<i> {disk_free_limit,1000000000},
</I>&gt;<i>
</I>&gt;<i> {disk_free,39365828608},
</I>&gt;<i>
</I>&gt;<i> {file_descriptors,
</I>&gt;<i>
</I>&gt;<i>       [{total_limit,16284},
</I>&gt;<i>
</I>&gt;<i>        {total_used,142},
</I>&gt;<i>
</I>&gt;<i>        {sockets_limit,14653},
</I>&gt;<i>
</I>&gt;<i>        {sockets_used,113}]},
</I>&gt;<i>
</I>&gt;<i> {processes,[{limit,1048576},{used,5986}]},
</I>&gt;<i>
</I>&gt;<i> {run_queue,0},
</I>&gt;<i>
</I>&gt;<i> {uptime,104350}]
</I>&gt;<i>
</I>&gt;<i> ...done.
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i>
</I>&gt;<i> --Bin Chen
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>

--
Simon MacMullen
RabbitMQ, VMware
-------------- next part --------------
A non-text attachment was scrubbed...
Name: report-output.zip
Type: application/x-zip-compressed
Size: 51941 bytes
Desc: report-output.zip
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/1876792b/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/1876792b/attachment.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: eval-output.zip
Type: application/x-zip-compressed
Size: 492573 bytes
Desc: eval-output.zip
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/1876792b/attachment-0001.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/1876792b/attachment-0001.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RACK3UNIT001-sasl.log.2012.10.31-10.00.00.zip</A>
Type: application/x-zip-compressed
Size: 2130 bytes
Desc: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at RACK3UNIT001-sasl.log.2012.10.31-10.00.00.zip</A>
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/1876792b/attachment-0002.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121031/1876792b/attachment-0002.bin</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023494.html">[rabbitmq-discuss] rabbit_mgmt_db crashed
</A></li>
	<LI>Next message: <A HREF="023466.html">[rabbitmq-discuss] Production ready C++ client library?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23497">[ date ]</a>
              <a href="thread.html#23497">[ thread ]</a>
              <a href="subject.html#23497">[ subject ]</a>
              <a href="author.html#23497">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
