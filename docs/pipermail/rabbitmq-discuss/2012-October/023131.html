<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Safely replaying archived messages from an external store
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Safely%20replaying%20archived%20messages%20from%20an%0A%20external%20store&In-Reply-To=%3CCAEHm_siDaCBSS-hr-C0fAPwo-gU1perJ9_WNWpFQN9weVShJmA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023109.html">
   <LINK REL="Next"  HREF="023095.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Safely replaying archived messages from an external store</H1>
    <B>Charles Duffy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Safely%20replaying%20archived%20messages%20from%20an%0A%20external%20store&In-Reply-To=%3CCAEHm_siDaCBSS-hr-C0fAPwo-gU1perJ9_WNWpFQN9weVShJmA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Safely replaying archived messages from an external store">charles at dyfis.net
       </A><BR>
    <I>Wed Oct 17 15:32:30 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023109.html">[rabbitmq-discuss] Safely replaying archived messages from an external store
</A></li>
        <LI>Next message: <A HREF="023095.html">[rabbitmq-discuss] &#12304;SOS&#12305;issues about  execution javascript in IPhone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23131">[ date ]</a>
              <a href="thread.html#23131">[ thread ]</a>
              <a href="subject.html#23131">[ subject ]</a>
              <a href="author.html#23131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[Please pardon any duplicates -- cancelled an initial reply held for
moderation; sending this one as a subscriber].

On Wed, Oct 17, 2012 at 5:14 AM, Emile Joubert &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>&gt; wrote:

&gt;<i> You are correct that AMQP timestamps have 1sec resolution, but nothing
</I>&gt;<i> prevents publishers from adding a custom header with greater resolution.
</I>&gt;<i>
</I>&gt;<i> There is a potential for messages to arrive inbetween retrieving
</I>&gt;<i> messages from the database and normally consuming messages from the
</I>&gt;<i> broker. Make sure you don't leave the door open for race conditions.
</I>&gt;<i>
</I>
Thank you for your response.

I was under the impression, in generating the initial proposal, that the
second-resolution timestamp was provided by the AMQP server, not the client
-- being client-provided, I can't trust it for the same reason that I can't
trust a milisecond-resolution timestamp in a client-provided header.
Consequently, it's back to the drawing board there.

My current approach assumes that delivery order will be consistent across
clients. This seems to be required by the section of the AMQP spec reading &quot;The
server MUST deliver messages of the same priority in order irrespective of
their individual persistence&quot;; if this is the case, I can pull the first
message off the queue, find it in the database (polling until it exists),
and use the database insert ordering (as recorded by an AUTO_INCREMENT key)
to manage replay.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121017/412042ba/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121017/412042ba/attachment.htm</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023109.html">[rabbitmq-discuss] Safely replaying archived messages from an external store
</A></li>
	<LI>Next message: <A HREF="023095.html">[rabbitmq-discuss] &#12304;SOS&#12305;issues about  execution javascript in IPhone
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23131">[ date ]</a>
              <a href="thread.html#23131">[ thread ]</a>
              <a href="subject.html#23131">[ subject ]</a>
              <a href="author.html#23131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
