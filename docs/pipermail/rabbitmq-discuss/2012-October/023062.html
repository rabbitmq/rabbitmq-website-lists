<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Monitoring A Queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Monitoring%20A%20Queue&In-Reply-To=%3C602d0b86-217f-4bc2-9896-72a1334a8e12%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023089.html">
   <LINK REL="Next"  HREF="023093.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Monitoring A Queue</H1>
    <B>Jason Antman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Monitoring%20A%20Queue&In-Reply-To=%3C602d0b86-217f-4bc2-9896-72a1334a8e12%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Monitoring A Queue">inebriectomy at gmail.com
       </A><BR>
    <I>Mon Oct 15 17:10:02 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023089.html">[rabbitmq-discuss] Response times for publisher confirms
</A></li>
        <LI>Next message: <A HREF="023093.html">[rabbitmq-discuss] Fwd: Monitoring A Queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23062">[ date ]</a>
              <a href="thread.html#23062">[ thread ]</a>
              <a href="subject.html#23062">[ subject ]</a>
              <a href="author.html#23062">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've been tasked with monitoring a queue used by two applications, which 
are considered black boxes from my point of view (App A puts messages into 
a queue, App B consumes them; I have no control over the code for either 
app). I need to measure the rate of messages (messages/second) moving 
successfully from App A to App B through the queue. We're concerned with 
both pileups in the queue (producer working normally, consumer halted) and 
lack of new messages (producer halted). The end result will be a Nagios 
check plugin, which alerts when messages/second throughput falls below a 
given level, and also produces performance data for graphing.

I've been examining the JSON results from the management API 
(/api/queues/vhost_name/queue_name), and have come to the following 
conclusions:
1) There are no monotonically increasing counters of the number of messages 
in to the queue and number of messages out of the queue. Therefore, there's 
no way for me to figure the rate on an arbitrary time scale.
2) The &quot;messages&quot; element in the JSON array is the number of messages 
currently sitting in the queue, not a counter of the number that have 
passed through it.
3) The API does provide backing_queue_status.avg_ingress_rate and 
backing_queue_status.avg_egress_rate. Going by Matthew's post to 
&quot;Monitoring Message Throughput&quot; 
(<A HREF="http://rabbitmq.1065348.n5.nabble.com/Monitoring-Message-Throughput-td17436.html#a17438">http://rabbitmq.1065348.n5.nabble.com/Monitoring-Message-Throughput-td17436.html#a17438</A>) 
from February, 2010, I gather that these values are averaged over approx. 
10 seconds. I'm also assuming that ingress is *every* message into the 
queue, and egress is... *every* message grabbed from the queue, regardless 
of ACK? So even if consumers are not acking any messages, this rate will 
still show them? 

Are these correct?

It would be really helpful if someone could explain exactly what 
avg_in/egress_rate and avg_ack_in/egress_rate mean.

I also found some reference to a Ticket 23 (though I don't see any links to 
the RMQ ticketing system) that dealt with monitoring:
<A HREF="http://grokbase.com/t/rabbitmq/rabbitmq-discuss/10ag2hejbb/ticket-23-new-comment-monitoring-message-throughput">http://grokbase.com/t/rabbitmq/rabbitmq-discuss/10ag2hejbb/ticket-23-new-comment-monitoring-message-throughput</A>

Any guidance would be greatly appreciated. I've been trying to monitor this 
for over a day now, and can't seem to figure out the best way to do it...

Thanks,
Jason Antman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121015/c25b2214/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121015/c25b2214/attachment.htm</A>&gt;
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023089.html">[rabbitmq-discuss] Response times for publisher confirms
</A></li>
	<LI>Next message: <A HREF="023093.html">[rabbitmq-discuss] Fwd: Monitoring A Queue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23062">[ date ]</a>
              <a href="thread.html#23062">[ thread ]</a>
              <a href="subject.html#23062">[ subject ]</a>
              <a href="author.html#23062">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
