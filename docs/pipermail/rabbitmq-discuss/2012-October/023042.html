<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Disable Per-Connection Flow Control
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disable%20Per-Connection%20Flow%20Control&In-Reply-To=%3C507BE7A9.7090000%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023019.html">
   <LINK REL="Next"  HREF="022979.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Disable Per-Connection Flow Control</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Disable%20Per-Connection%20Flow%20Control&In-Reply-To=%3C507BE7A9.7090000%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Disable Per-Connection Flow Control">simon at rabbitmq.com
       </A><BR>
    <I>Mon Oct 15 11:38:33 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023019.html">[rabbitmq-discuss] Disable Per-Connection Flow Control
</A></li>
        <LI>Next message: <A HREF="022979.html">[rabbitmq-discuss] Reg: Total Transfers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23042">[ date ]</a>
              <a href="thread.html#23042">[ thread ]</a>
              <a href="subject.html#23042">[ subject ]</a>
              <a href="author.html#23042">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 13/10/12 02:16, Dwayne Campbell wrote:
&gt;<i> Simon,
</I>&gt;<i>
</I>&gt;<i> Thank you very much for your reply.
</I>
No problem!

&gt;<i> Using HIPE compilation reduced the flow control significantly.I now get
</I>&gt;<i> flow controlled at around 4.1 MB/S to 7.2 MB/S .However flow control
</I>&gt;<i>   seems to steadily remain on at 3.8MB/s for the rest of the time
</I>&gt;<i> RabbitMQ runs.
</I>
When sending tiny messages almost all of your costs are per message 
rather than per byte - so it makes more sense to think in terms of the 
number of messages / second rather than bytes / second.

&gt;<i> Each message is about approximately 300 bytes at most 800 bytes
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Multiple connections(independent applications) will be made from the
</I>&gt;<i> same host to the RabbitMQ Server. Each connection will be sending small
</I>&gt;<i> messages really fast to the broker(RabbitMQ Server)____
</I>
I'm not currently sure about whether you've been describing the 
behaviour of a live system or some tests you've been running - if you've 
been describing tests then bear in mind that RabbitMQ will exhibit a 
reasonable amount of parallelism - so just testing with one connection 
will not tell you the total message rate you can handle.

&gt;<i> What optimizations can be made to increase throughput on RabbitMQ Server
</I>&gt;<i> or the routing part of the pipeline ?
</I>
It sounds like you're CPU bound in routing - so the next step is to 
ensure your routing is as simple as possible. Exchange type is the 
primary factor here. Headers is (a lot) slower than topic, topic is 
slower than direct and direct is slower than fanout (except in the 
default direct exchange, which is as fast as fanout).

&gt;<i> Would cluster be the next option to evaluate ?
</I>
Yes, it should scale pretty much linearly for this workload.

&gt;<i> Is there any output that i can gather to analyze which part of
</I>&gt;<i> the pipeline is the bottleneck ?
</I>
Not at the moment within RabbitMQ; future releases might expose more 
details about this. But in the tiny-non-persistent-messages (I think 
your messages are not persistent?) case it's usually routing, with 
framing coming a close second.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023019.html">[rabbitmq-discuss] Disable Per-Connection Flow Control
</A></li>
	<LI>Next message: <A HREF="022979.html">[rabbitmq-discuss] Reg: Total Transfers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23042">[ date ]</a>
              <a href="thread.html#23042">[ thread ]</a>
              <a href="subject.html#23042">[ subject ]</a>
              <a href="author.html#23042">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
