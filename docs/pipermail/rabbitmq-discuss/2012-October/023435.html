<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] backup and fail-over to remote disaster recovery site
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20backup%20and%20fail-over%20to%20remote%20disaster%0A%20recovery%20site&In-Reply-To=%3CCAK76X7RsZL6d4JekXRjVZ_f_R14hmsoj5NGARv_DEPXMR%2B0s1g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023188.html">
   <LINK REL="Next"  HREF="023194.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] backup and fail-over to remote disaster recovery site</H1>
    <B>Terance Dias</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20backup%20and%20fail-over%20to%20remote%20disaster%0A%20recovery%20site&In-Reply-To=%3CCAK76X7RsZL6d4JekXRjVZ_f_R14hmsoj5NGARv_DEPXMR%2B0s1g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] backup and fail-over to remote disaster recovery site">terance at socialtwist.com
       </A><BR>
    <I>Tue Oct 30 10:19:44 GMT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="023188.html">[rabbitmq-discuss] backup and fail-over to remote disaster recovery site
</A></li>
        <LI>Next message: <A HREF="023194.html">[rabbitmq-discuss] nodename variable and mnesia directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23435">[ date ]</a>
              <a href="thread.html#23435">[ thread ]</a>
              <a href="subject.html#23435">[ subject ]</a>
              <a href="author.html#23435">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for your reply Simon.

Is it possible to use MySQL for persistence of messages in RabbitMQ and
then use the Master-Slave replication that MySQL provides to replicate the
data at the remote site? Are there any performance numbers for this kind of
configuration?

Thanks,
Terance.

On Fri, Oct 19, 2012 at 6:30 PM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:

&gt;<i> On 19/10/12 12:48, Terance wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> We want to set up RabbitMQ such that the current state of the broker is
</I>&gt;&gt;<i> backed up at a remote disaster recovery site at real time. We also want
</I>&gt;&gt;<i> our
</I>&gt;&gt;<i> clients (producers and consumers) to fail-over to this remote broker in
</I>&gt;&gt;<i> case
</I>&gt;&gt;<i> the main broker becomes unreachable for some reason. I was looking at the
</I>&gt;&gt;<i> Distributed broker approaches supported by RabbitMQ at
</I>&gt;&gt;<i> <A HREF="http://www.rabbitmq.com/**distributed.html&lt;http://www.rabbitmq.com/distributed.html">http://www.rabbitmq.com/**distributed.html&lt;http://www.rabbitmq.com/distributed.html</A>&gt;but I'm not sure If what we are
</I>&gt;&gt;<i> looking for can be achieved. Please let me know if you know how to do
</I>&gt;&gt;<i> this.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi. Interesting question. Some thoughts:
</I>&gt;<i>
</I>&gt;<i> CAP theorem tells us you're not going to get a transparent solution to
</I>&gt;<i> this problem. If it's remote you need to be partition-tolerant, and you
</I>&gt;<i> almost certainly want to be available too. So consistency has to go. That
</I>&gt;<i> rules out clustering.
</I>&gt;<i>
</I>&gt;<i> So you could use the shovel or federation to get messages published from
</I>&gt;<i> your main site to your recovery site. That's fairly easy (assuming your
</I>&gt;<i> broker definitions are not too dynamic); what is harder is ensuring that
</I>&gt;<i> messages are consumed from the recovery site in some sort of correlation
</I>&gt;<i> with them being consumed at the main site. There's nothing built in to
</I>&gt;<i> Rabbit which can do that.
</I>&gt;<i>
</I>&gt;<i> There are some possibilities which may or may not work for you. You could
</I>&gt;<i> federate / shovel into queues with a message TTL at the remote site to
</I>&gt;<i> bound the amount of data you hold - but at failover you could have a lot of
</I>&gt;<i> duplicate messages to work through, and if your main site queues back up
</I>&gt;<i> enough, messages could be expired at the remote site when they have not
</I>&gt;<i> been processed at the main site.
</I>&gt;<i>
</I>&gt;<i> Possibly the most plausible solution is to synchronise the mnesia
</I>&gt;<i> directory from main to remote and only boot the remote broker on failover.
</I>&gt;<i> This stands a decent chance of recovering your persistent messages of
</I>&gt;<i> failure; but keeping the filesystems reliably in sync is its own challenge.
</I>&gt;<i> And we don't guarantee to recover everything after (the equivalent of) an
</I>&gt;<i> unclean shutdown.
</I>&gt;<i>
</I>&gt;<i> Hmm, you've got me thinking about replication now...
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121030/c8e13752/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20121030/c8e13752/attachment.htm</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023188.html">[rabbitmq-discuss] backup and fail-over to remote disaster recovery site
</A></li>
	<LI>Next message: <A HREF="023194.html">[rabbitmq-discuss] nodename variable and mnesia directory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23435">[ date ]</a>
              <a href="thread.html#23435">[ thread ]</a>
              <a href="subject.html#23435">[ subject ]</a>
              <a href="author.html#23435">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
