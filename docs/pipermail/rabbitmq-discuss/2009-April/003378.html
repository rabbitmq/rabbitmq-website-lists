<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss]  RabbitMQ dying during evaluation testing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20RabbitMQ%20dying%20during%20evaluation%20testing&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003389.html">
   <LINK REL="Next"  HREF="003379.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss]  RabbitMQ dying during evaluation testing</H1>
    <B>Jacek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20RabbitMQ%20dying%20during%20evaluation%20testing&In-Reply-To="
       TITLE="[rabbitmq-discuss]  RabbitMQ dying during evaluation testing">jacek99 at gmail.com
       </A><BR>
    <I>Tue Apr 21 18:29:23 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003389.html">[rabbitmq-discuss] RabbitMQ in .NET Compact Framework
</A></li>
        <LI>Next message: <A HREF="003379.html">[rabbitmq-discuss] RabbitMQ dying during evaluation testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3378">[ date ]</a>
              <a href="thread.html#3378">[ thread ]</a>
              <a href="subject.html#3378">[ subject ]</a>
              <a href="author.html#3378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
We're looking at replacing our creaky Weblogic 9 JMS with an alternative and
evaluating RabbitMQ as an replacement. We're all (mostly) Java guys here, so
we're newbies both to Erlang and RabbitMQ (but willing to learn, so bear
with us).

Anyway, as part of our test I wrote a *very* simple client that posts a few
million short messages. It seems to work very well for the first few
million, but after the first few runs RabbitMQ seems to die.

Looking at /var/log/rabbitmq/rabbit.log I see things like:

=WARNING REPORT==== 21-Apr-2009::13:12:59 ===
Mnesia('<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jacek-desktop</A>'): ** WARNING ** Mnesia is overloaded:
{dump_log,
                                                                    
time_threshold}

What makes this worse that after we get the initial socket exception on the
java side, RabbitMQ seems to be left in a really bad state. Asking for
status returns the dreaded

{badrpc,nodedown}

and even restarting it seems to fail:

<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jacek at jacek-desktop</A>:/var/log/rabbitmq$ sudo rabbitmqctl stop
Stopping and halting node '<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at jacek-desktop</A>' ...
Error: {badrpc,nodedown}

The only solution seems to be to actually log in/out, but we can reliably
reproduce this every time.

I am sure this is something related to configuration, etc. so I would be
grateful for any pointers. I am attaching my simple Java test client.

Thank you in advance for any pointers or suggestions,
Jacek <A HREF="http://www.nabble.com/file/p23160957/Producer.java">http://www.nabble.com/file/p23160957/Producer.java</A> Producer.java 
-- 
View this message in context: <A HREF="http://www.nabble.com/RabbitMQ-dying-during-evaluation-testing-tp23160957p23160957.html">http://www.nabble.com/RabbitMQ-dying-during-evaluation-testing-tp23160957p23160957.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003389.html">[rabbitmq-discuss] RabbitMQ in .NET Compact Framework
</A></li>
	<LI>Next message: <A HREF="003379.html">[rabbitmq-discuss] RabbitMQ dying during evaluation testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3378">[ date ]</a>
              <a href="thread.html#3378">[ thread ]</a>
              <a href="subject.html#3378">[ subject ]</a>
              <a href="author.html#3378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
