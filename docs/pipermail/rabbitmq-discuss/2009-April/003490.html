<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ HTTP interface
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20HTTP%20interface&In-Reply-To=e25246b60904221455w1fd5623cv14e9570cbc3f5312%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003410.html">
   <LINK REL="Next"  HREF="003411.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ HTTP interface</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20HTTP%20interface&In-Reply-To=e25246b60904221455w1fd5623cv14e9570cbc3f5312%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ HTTP interface">tonyg at lshift.net
       </A><BR>
    <I>Thu Apr 30 18:18:55 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003410.html">[rabbitmq-discuss] RabbitMQ HTTP interface
</A></li>
        <LI>Next message: <A HREF="003411.html">[rabbitmq-discuss] &quot;pubsub&quot; meet-ups
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3490">[ date ]</a>
              <a href="thread.html#3490">[ thread ]</a>
              <a href="subject.html#3490">[ subject ]</a>
              <a href="author.html#3490">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

lenz wrote:
&gt;<i> from the javascript client that comes with the rabbit-http2 repo i kind
</I>&gt;<i> of got an idea how things are supposed to work but i wanted to ask if
</I>&gt;<i> there is some sort of documentation/API description around that i could
</I>&gt;<i> use to implement a client from?
</I>
I can think of a few things to get you started -- and BTW this sounds
like a really interesting project, do keep us up-to-date with your
progress as you go!

1. The service is standard JSON-RPC 1.1 (see spec mirrored here:
<A HREF="http://hg.opensource.lshift.net/erlang-rfc4627/raw-file/default/doc/JSON-RPC-1-1-WD-20060807.html">http://hg.opensource.lshift.net/erlang-rfc4627/raw-file/default/doc/JSON-RPC-1-1-WD-20060807.html</A>).
You can probably use an off-the-shelf JSON-RPC client library.

2. There is plenty of documentation on the Erlang JSON-RPC service that
the RabbitMQ HTTP2 adapter uses here:
<A HREF="http://hg.opensource.lshift.net/erlang-rfc4627/raw-file/default/doc/index.html">http://hg.opensource.lshift.net/erlang-rfc4627/raw-file/default/doc/index.html</A>

3. The service descriptions (see the JSON-RPC 1.1 spec, &#167;10) are as follows:

* The channel factory at .../rpc/rabbitmq:

{
    &quot;sdversion&quot;:&quot;1.0&quot;,
    &quot;name&quot;:&quot;rabbitmq&quot;,
    &quot;id&quot;:&quot;urn:uuid:f98a4235-20a9-4321-a15c-94878a6a14f3&quot;,
    &quot;version&quot;:&quot;1.2&quot;,
    &quot;address&quot;:&quot;<A HREF="http://rabbitmq.lshift.net:55672/rpc/rabbitmq&quot;,">http://rabbitmq.lshift.net:55672/rpc/rabbitmq&quot;,</A>
    &quot;procs&quot;:[{&quot;name&quot;:&quot;open&quot;,&quot;idempotent&quot;:false,
	      &quot;params&quot;:[{&quot;name&quot;:&quot;username&quot;,&quot;type&quot;:&quot;str&quot;},
			{&quot;name&quot;:&quot;password&quot;,&quot;type&quot;:&quot;str&quot;},
			{&quot;name&quot;:&quot;sessionTimeout&quot;,&quot;type&quot;:&quot;num&quot;},
			{&quot;name&quot;:&quot;virtualHost&quot;,&quot;type&quot;:&quot;str&quot;}]}]
}

* Each individual channel, at .../rpc/SOMEUNGUESSABLEHEXIDENTIFIER:

{
    &quot;sdversion&quot;:&quot;1.0&quot;,
    &quot;name&quot;:&quot;B10D3152ED205726DC3A8EF03FD00C7B&quot;,
    &quot;id&quot;:&quot;urn:uuid:b3f82f69-4f63-424b-8dbb-4fa53f63cf06&quot;,
    &quot;version&quot;:&quot;1.2&quot;,

&quot;address&quot;:&quot;<A HREF="http://rabbitmq.lshift.net:55672/rpc/SOMEUNGUESSABLEHEXIDENTIFIER&quot;,">http://rabbitmq.lshift.net:55672/rpc/SOMEUNGUESSABLEHEXIDENTIFIER&quot;,</A>
    &quot;procs&quot;:[{&quot;name&quot;:&quot;poll&quot;,&quot;idempotent&quot;:false,
	      &quot;params&quot;:[]},
	     {&quot;name&quot;:&quot;close&quot;,&quot;idempotent&quot;:false,
	      &quot;params&quot;:[]},
	     {&quot;name&quot;:&quot;call&quot;,&quot;idempotent&quot;:false,
	      &quot;params&quot;:[{&quot;name&quot;:&quot;method&quot;,&quot;type&quot;:&quot;str&quot;},
			{&quot;name&quot;:&quot;args&quot;,&quot;type&quot;:&quot;arr&quot;}]},
	     {&quot;name&quot;:&quot;cast&quot;,&quot;idempotent&quot;:false,
	      &quot;params&quot;:[{&quot;name&quot;:&quot;method&quot;,&quot;type&quot;:&quot;str&quot;},
			{&quot;name&quot;:&quot;args&quot;,&quot;type&quot;:&quot;arr&quot;},
			{&quot;name&quot;:&quot;content&quot;,&quot;type&quot;:&quot;str&quot;},
			{&quot;name&quot;:&quot;props&quot;,&quot;type&quot;:&quot;arr&quot;}]}]
}

The &quot;poll&quot; method returns details of all the asynchronous events that
have arrived for the channel -- the basic.delivers, the basic.returns.

The &quot;close&quot; method is used to shut down the channel.

The &quot;call&quot; and &quot;cast&quot; methods are used to perform synchronous (e.g.
exchange.declare) and asynchronous (e.g. basic.publish, basic.ack) AMQP
operations, respectively.

&quot;call&quot; returns the response to the synchronous call.

&quot;cast&quot; returns a list of asynchronous events that had been queued up at
the server-side of the Channel, *just like poll does*. So both poll and
cast can return deliveries intended for your program!

See rabbitmq.js's definitions of such as basicPublish() and
exchangeDeclare() for examples of usage.


Here's a login call (to .../rpc/rabbitmq):

REQUEST:
{&quot;version&quot;:&quot;1.1&quot;,&quot;id&quot;:2,&quot;method&quot;:&quot;open&quot;,&quot;params&quot;:[&quot;guest&quot;,&quot;guest&quot;,5,null]}

RESPONSE:
{&quot;version&quot;:&quot;1.1&quot;,&quot;id&quot;:2,&quot;result&quot;:{&quot;service&quot;:&quot;SOMEUNGUESSABLEHEXIDENTIFIER&quot;}}

Then, in the URL you're using to access the channel-opening service
(i.e. .../rpc/rabbitmq), replace &quot;rabbitmq&quot; with the &quot;service&quot; result
parameter, yielding .../rpc/SOMEUNGUESSABLEHEXIDENTIFIER. This is the
URL for your channel object. You use this to begin subscriptions and
issue AMQP commands.

Here's a queue declaration:

REQUEST:
{&quot;version&quot;:&quot;1.1&quot;,&quot;id&quot;:6,&quot;method&quot;:&quot;call&quot;,&quot;params&quot;:[&quot;queue.declare&quot;,[1,&quot;test-queue-1a&quot;,false,false,false,true,false,{}]]}

RESPONSE:
{&quot;version&quot;:&quot;1.1&quot;,&quot;id&quot;:6,&quot;result&quot;:{&quot;method&quot;:&quot;queue.declare_ok&quot;,&quot;args&quot;:[&quot;test-queue-1a&quot;,0,0]}}

Here's a use of &quot;cast&quot;:

REQUEST:
{&quot;version&quot;:&quot;1.1&quot;,&quot;id&quot;:10,&quot;method&quot;:&quot;cast&quot;,&quot;params&quot;:[&quot;basic.publish&quot;,[1,&quot;&quot;,&quot;test-queue-1a&quot;,false,false
],
&quot;hello, world&quot;,
[null,null,null,null,null,null,null,null,null,null,null,null,null,null]]}

RESPONSE:
{&quot;version&quot;:&quot;1.1&quot;,&quot;id&quot;:10,&quot;result&quot;:[{&quot;method&quot;:&quot;basic.deliver&quot;,&quot;args&quot;:[&quot;aa-cons-tag1&quot;,1,false,&quot;&quot;,&quot;test-queue-1a&quot;
],&quot;content&quot;:&quot;hello,
world&quot;,&quot;props&quot;:[null,null,null,null,null,null,null,null,null,null,null,null,null
,null]}]}

Note how the &quot;result&quot; array is non-empty, and that RabbitMQ is quick
enough that by the time the JSON-RPC object is ready to return to its
caller, the method that was just published has already been delivered :-)

Generally, for method arguments, follow the definitions given in the 0-8
json document:
<A HREF="http://hg.rabbitmq.com/rabbitmq-codegen/raw-file/default/amqp-0.8.json">http://hg.rabbitmq.com/rabbitmq-codegen/raw-file/default/amqp-0.8.json</A>

Hopefully that is enough to get you started!

Regards,
  Tony
-- 
 [][][] Tony Garnock-Jones     | Mob: +44 (0)7905 974 211
   [][] LShift Ltd             | Tel: +44 (0)20 7729 7060
 []  [] <A HREF="http://www.lshift.net/">http://www.lshift.net/</A> | Email: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tonyg at lshift.net</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003410.html">[rabbitmq-discuss] RabbitMQ HTTP interface
</A></li>
	<LI>Next message: <A HREF="003411.html">[rabbitmq-discuss] &quot;pubsub&quot; meet-ups
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3490">[ date ]</a>
              <a href="thread.html#3490">[ thread ]</a>
              <a href="subject.html#3490">[ subject ]</a>
              <a href="author.html#3490">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
