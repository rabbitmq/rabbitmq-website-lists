<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Durable queues &amp; bindings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Durable%20queues%20%26%20bindings&In-Reply-To=1239541221.6519.106.camel%40localhost">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003341.html">
   <LINK REL="Next"  HREF="003349.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Durable queues &amp; bindings</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Durable%20queues%20%26%20bindings&In-Reply-To=1239541221.6519.106.camel%40localhost"
       TITLE="[rabbitmq-discuss] Durable queues &amp; bindings">matthias at lshift.net
       </A><BR>
    <I>Tue Apr 14 16:31:03 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003341.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
        <LI>Next message: <A HREF="003349.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3348">[ date ]</a>
              <a href="thread.html#3348">[ thread ]</a>
              <a href="subject.html#3348">[ subject ]</a>
              <a href="author.html#3348">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Levi,

Levi Greenspan wrote:
&gt;<i> I have the following settings in /etc/rabbitmq/rabbitmq.conf
</I>&gt;<i> 
</I>&gt;<i> RABBITMQ_NODE_IP_ADDRESS=127.0.0.1
</I>&gt;<i> RABBITMQ_LOG_BASE=/opt/logs/rabbitmq
</I>&gt;<i> RABBITMQ_MNESIA_BASE=/opt/otp/mnesia
</I>&gt;<i> RABBITMQ_PIDS_FILE=/opt/otp/pids
</I>&gt;<i> 
</I>&gt;<i> and in /etc/rabbitmq/rabbitmq_cluster.conf:
</I>&gt;<i> 
</I>&gt;<i> [<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost</A>].
</I>
The default location of the cluster config file is 
/etc/rabbitmq/cluster.config. The docs say 
/etc/rabbitmq/rabbitmq_cluster.config, which is wrong.

Did you change that setting to point to /etc/rabbitmq/rabbitmq_cluster.conf?

If not that would explain why getKnownHosts returns one node only, 
though it doesn't explain why it would only do that for 1.5.4 and not 
1.5.3. Perhaps your config changed?

To check whether the clustering is set up correctly, run &quot;rabbitmqctl 
status&quot;. That should show both nodes as running.

&gt;&gt;&gt;<i> I upgraded to version 1.5.4 and now I see the queues and bindings after
</I>&gt;&gt;&gt;<i> &gt; &gt; the node is running again. However in 1.5.3 it didn't work for me.
</I>&gt;<i> [...]
</I>&gt;<i> I have attached a small Java test client and a transcript which shows
</I>&gt;<i> the different behavior between version 1.5.3 and 1.5.4. Maybe you can
</I>&gt;<i> reproduce it.
</I>
I can indeed reproduce your findings: bindings to durable queues 
residing on nodes in a cluster are not restored when the queues' nodes 
restart. Thanks for reporting this; I have filed a bug.

This happens for me in both 1.5.3 and 1.5.4; the reason that it works 
for you in 1.5.4 is probably the same reason that getKnownHosts returns 
just one node, namely that the clustering was not set up correctly when 
you ran that test.


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003341.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
	<LI>Next message: <A HREF="003349.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3348">[ date ]</a>
              <a href="thread.html#3348">[ thread ]</a>
              <a href="subject.html#3348">[ subject ]</a>
              <a href="author.html#3348">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
