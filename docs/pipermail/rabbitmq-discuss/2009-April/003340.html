<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Durable queues &amp; bindings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Durable%20queues%20%26%20bindings&In-Reply-To=1239485264.20272.18.camel%40localhost">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003339.html">
   <LINK REL="Next"  HREF="003341.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Durable queues &amp; bindings</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Durable%20queues%20%26%20bindings&In-Reply-To=1239485264.20272.18.camel%40localhost"
       TITLE="[rabbitmq-discuss] Durable queues &amp; bindings">matthias at lshift.net
       </A><BR>
    <I>Sun Apr 12 00:32:53 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003339.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
        <LI>Next message: <A HREF="003341.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3340">[ date ]</a>
              <a href="thread.html#3340">[ thread ]</a>
              <a href="subject.html#3340">[ subject ]</a>
              <a href="author.html#3340">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Levi,

Levi Greenspan wrote:
&gt;<i> On Sat, 2009-04-11 at 08:46 +0100, Matthias Radestock wrote:
</I>&gt;&gt;<i> Levi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Levi Greenspan wrote:
</I>&gt;&gt;&gt;<i> I upgraded to version 1.5.4 and now I see the queues and bindings after
</I>&gt;&gt;&gt;<i> the node is running again. However in 1.5.3 it didn't work for me.
</I>&gt;&gt;<i> I can't think of anything that has changed between 1.5.3 and 1.5.4 that 
</I>&gt;&gt;<i> would cause this, except that startup times for when there are lots of 
</I>&gt;&gt;<i> durable exchanges, queues or bindings have improved significantly. The 
</I>&gt;&gt;<i> recreation of these entities is now also happening incrementally. So 
</I>&gt;&gt;<i> it's possible that previously rabbitmqctl would not list any queues for 
</I>&gt;&gt;<i> you if it was called right after you started the broker - though it 
</I>&gt;&gt;<i> should have done so eventually - whereas now it does.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I have attached a small Java test client and a transcript which shows
</I>&gt;<i> the different behavior between version 1.5.3 and 1.5.4. Maybe you can
</I>&gt;<i> reproduce it.
</I>
What user did you run these as? Looks like 'user', based on the 
transcript. But usually only the 'rabbitmq' user can write to 
/var/log/rabbitmq etc, which would cause the script invocations to fail.

Did you make any adjustments to the permissions, or set some env vars to 
adjust the paths, or tweak the scripts?

Also, did you try running these tests when no clustering has been 
configured and you have just a single node?

&gt;&gt;&gt;<i> Anyway I noticed another difference between 1.5.3 and 1.5.4 - the call
</I>&gt;&gt;&gt;<i> to com.rabbitmq.client.Connection.getKnownHosts() in that Java client
</I>&gt;&gt;&gt;<i> API returns the list of all running node addresses in 1.5.3, but only
</I>&gt;&gt;&gt;<i> one host address in 1.5.4 - a bug?
</I>&gt;&gt;<i> Nothing has changed in that area of the code. Are you sure that all your 
</I>&gt;&gt;<i> nodes are running and listening?
</I>&gt;<i> 
</I>&gt;<i> Yes, I am. The test client prints the known hosts and for 1.5.3 the
</I>&gt;<i> reult is &quot;localhost:5672&quot;, whereas for 1.5.4 it is &quot;localhost:5673&quot; and
</I>&gt;<i> &quot;localhost:5672&quot;. Again I hope you can reproduce it with the attached
</I>&gt;<i> client. I am using Ubuntu 8.10 on x86 and I compiled erlang using the
</I>&gt;<i> offically released source, not the Ubuntu packages.
</I>
So is it 1.5.3 that returns both hosts (which is what you said 
originally) or 1.5.4?

And how did you configure the clustering?


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003339.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
	<LI>Next message: <A HREF="003341.html">[rabbitmq-discuss] Durable queues &amp; bindings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3340">[ date ]</a>
              <a href="thread.html#3340">[ thread ]</a>
              <a href="subject.html#3340">[ subject ]</a>
              <a href="author.html#3340">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
