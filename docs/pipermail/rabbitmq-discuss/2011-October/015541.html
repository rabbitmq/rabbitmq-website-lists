<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Windows Server 2003 Server Cluster Hack Active	/Passive
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Windows%20Server%202003%20Server%20Cluster%20Hack%20Active%0A%09/Passive&In-Reply-To=%3CCAGnU7ujhz%3DSbfUqff2QqTh1wVaJUv%3DQ-modvby5%3DozamGgOzmg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015553.html">
   <LINK REL="Next"  HREF="015542.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Windows Server 2003 Server Cluster Hack Active	/Passive</H1>
    <B>Benjamin Bennett</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Windows%20Server%202003%20Server%20Cluster%20Hack%20Active%0A%09/Passive&In-Reply-To=%3CCAGnU7ujhz%3DSbfUqff2QqTh1wVaJUv%3DQ-modvby5%3DozamGgOzmg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Windows Server 2003 Server Cluster Hack Active	/Passive">benbennett at gmail.com
       </A><BR>
    <I>Sat Oct 15 22:52:16 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015553.html">[rabbitmq-discuss] clustering behind a firewall
</A></li>
        <LI>Next message: <A HREF="015542.html">[rabbitmq-discuss] rabbitmq-discuss Digest, Vol 53, Issue 15
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15541">[ date ]</a>
              <a href="thread.html#15541">[ thread ]</a>
              <a href="subject.html#15541">[ subject ]</a>
              <a href="author.html#15541">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I seen this older posting about rabbitmq in windows server
<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008559.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008559.html</A>
 .

I just wanted to pass it along if it hasn't been done already. I am
pretty sure I know what the user was trying to do .

In a Windows Server Cluster , there is a Cluster Administrator that
allows adding generic windows services to the cluster.

The only hang up in with default service installer is the actual
service name has a guid appended to the name.

So trying to add it as a Generic Cluster Service fails because it
needs to have the exact same service name on all nodes.

So in our cluster we have shared disk that the rabbitmq data is stored
on (scsi multi path between the two machines) .

I had to hack by calling the erlsrv directly just adding the rabbitmq
service and then calling the service installer .

So my steps were :

1) Set the RABBITMQ_BASE to a shared disk path that is cluster
resource in the windows clustering admin tool
2) Install erlang on all nodes in the active passive cluster
3) Set the RABBITMQ_NODE_IP_ADDRESS to the clustered ip address .
4) Set the RABBITMQ_NODENAME to the some form of the cluster hostname
example <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">node0 at cluster_dns_name</A>
5) Hack probably better way to do this but call the erlsrv add
RabbitMq -i RabbitMq
6) Call the rabbitmq windows service installer
7) Shut down rabbitmq on the current node
8) Fail over the shared hostname,disk resources  to the next node to
install on , repeat the steps above
9) After all nodes have the RabbitMq service installed , add a generic
service in the cluster administrator , set the dependencies on the
shared ip, hostname and disk, call it RabbitMq

That is what I got Active / Passive clustering to work on a two node
Windows 2003 Server cluster . It is failing over back and forth as
expected.
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015553.html">[rabbitmq-discuss] clustering behind a firewall
</A></li>
	<LI>Next message: <A HREF="015542.html">[rabbitmq-discuss] rabbitmq-discuss Digest, Vol 53, Issue 15
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15541">[ date ]</a>
              <a href="thread.html#15541">[ thread ]</a>
              <a href="subject.html#15541">[ subject ]</a>
              <a href="author.html#15541">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
