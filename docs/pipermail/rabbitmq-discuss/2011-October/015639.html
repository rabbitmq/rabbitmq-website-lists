<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Pika IOLoop issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pika%20IOLoop%20issue&In-Reply-To=%3C1319127111.42857.YahooMailNeo%40web26508.mail.ukl.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015632.html">
   <LINK REL="Next"  HREF="015774.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Pika IOLoop issue</H1>
    <B>E Hope-Morley</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Pika%20IOLoop%20issue&In-Reply-To=%3C1319127111.42857.YahooMailNeo%40web26508.mail.ukl.yahoo.com%3E"
       TITLE="[rabbitmq-discuss] Pika IOLoop issue">zedhm at yahoo.co.uk
       </A><BR>
    <I>Thu Oct 20 17:11:51 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015632.html">[rabbitmq-discuss] Pika IOLoop issue
</A></li>
        <LI>Next message: <A HREF="015774.html">[rabbitmq-discuss] Pika IOLoop issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15639">[ date ]</a>
              <a href="thread.html#15639">[ thread ]</a>
              <a href="subject.html#15639">[ subject ]</a>
              <a href="author.html#15639">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Gavin, I do not have a trace and this is not an easy issue to trigger but I think I have understood what is going on. This issue happens, in my case, when the connection drops and Pika handles the error. This results in the on_connection_closed callback getting called which I have instructed to stop the connection.ioloop. I think the problem is that if you have a nested poll()s you end up with nested handlers so even if the poller (i.e. the while loop in poller.start())is stopped, when the call stack unwinds you can end up with calls to poll() getting executed as a result of a transport.rpc(). Does this make any sense?



________________________________
From: Gavin M. Roy &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">gmr at myyearbook.com</A>&gt;
To: E Hope-Morley &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">zedhm at yahoo.co.uk</A>&gt;
Cc: &quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Sent: Thursday, 20 October 2011, 14:29
Subject: Re: [rabbitmq-discuss] Pika IOLoop issue


That is peculiar. What is the duration of time between the stop and pending event? Is an exception being thrown? Do you have a traceback?

Gavin


On Thursday, October 20, 2011 at 12:55 PM, E Hope-Morley wrote:
Hi,
&gt;<i>
</I>&gt;<i>&#160;&#160;&#160; I am using Pika on Ubuntu 11.04. When I call SelectConnection.ioloop.stop() following a connection drop on my connection, it sometimes fails to actually stop the ioloop i.e. following the call to stop(), a callback may sometimes be called in response to a pending event. Any ideas?
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>rabbitmq-discuss mailing list
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i><A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i> 
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111020/befec880/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111020/befec880/attachment.htm</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015632.html">[rabbitmq-discuss] Pika IOLoop issue
</A></li>
	<LI>Next message: <A HREF="015774.html">[rabbitmq-discuss] Pika IOLoop issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15639">[ date ]</a>
              <a href="thread.html#15639">[ thread ]</a>
              <a href="subject.html#15639">[ subject ]</a>
              <a href="author.html#15639">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
