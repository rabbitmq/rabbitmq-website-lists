<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] HA active/active cluster in a bad state
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20active/active%20cluster%20in%20a%20bad%20state&In-Reply-To=%3CCAP%2B1M2dKnBfAx2%2BV6d6b-HenDAyq0mdu2c7dx%2BPyb0B00U232g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015508.html">
   <LINK REL="Next"  HREF="015517.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] HA active/active cluster in a bad state</H1>
    <B>Bryan Murphy</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20HA%20active/active%20cluster%20in%20a%20bad%20state&In-Reply-To=%3CCAP%2B1M2dKnBfAx2%2BV6d6b-HenDAyq0mdu2c7dx%2BPyb0B00U232g%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] HA active/active cluster in a bad state">bmurphy1976 at gmail.com
       </A><BR>
    <I>Thu Oct 13 21:28:39 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015508.html">[rabbitmq-discuss] HA active/active cluster in a bad state
</A></li>
        <LI>Next message: <A HREF="015517.html">[rabbitmq-discuss] HA active/active cluster in a bad state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15515">[ date ]</a>
              <a href="thread.html#15515">[ thread ]</a>
              <a href="subject.html#15515">[ subject ]</a>
              <a href="author.html#15515">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Oct 13, 2011 at 10:48 AM, Matthew Sackman &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthew at rabbitmq.com</A>&gt;wrote:

&gt;<i> On Thu, Oct 13, 2011 at 10:44:43AM -0500, Bryan Murphy wrote:
</I>&gt;<i> &gt; I'll try to get it into a bad state later today.  If I can manage that, I
</I>&gt;<i> &gt; can easily grant temporary remote access to anybody who needs it.
</I>&gt;<i>
</I>&gt;<i> That'd be great, many thanks. However, please note that almost all of
</I>&gt;<i> the Rabbit team is in London, UK, and so there's the usual fun-and-games
</I>&gt;<i> with timezones...
</I>&gt;<i>
</I>&gt;<i> Matthew
</I>&gt;<i>
</I>
I've managed to get it into a bad state, but yet again the behavior is
inconsistent with what I've seen before.  Now, I've got the following
behavior:

/etc/init.d/rabbitmq-server stop works
/etc/init.d/rabbitmq-server start never exits

rabbitmqctl list_queues works
rabbitmqctl cluster_status works

Sending messages to the server fails:

WARNING:root:Traceback (most recent call last):
  File &quot;/usr/local/lib/python2.7/dist-packages/mediafly/bus/__init__.py&quot;,
line 111, in publish
    connection = pika.BlockingConnection(host)
  File
&quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/blocking_connection.py&quot;,
line 32, in __init__
    BaseConnection.__init__(self, parameters, None, reconnection_strategy)
  File
&quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/base_connection.py&quot;,
line 50, in __init__
    reconnection_strategy)
  File &quot;/usr/local/lib/python2.7/dist-packages/pika/connection.py&quot;, line
170, in __init__
    self._connect()
  File &quot;/usr/local/lib/python2.7/dist-packages/pika/connection.py&quot;, line
228, in _connect
    self.parameters.port or  spec.PORT)
  File
&quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/blocking_connection.py&quot;,
line 36, in _adapter_connect
    BaseConnection._adapter_connect(self, host, port)
  File
&quot;/usr/local/lib/python2.7/dist-packages/pika/adapters/base_connection.py&quot;,
line 58, in _adapter_connect
    self.socket.connect((host, port))
  File &quot;/usr/lib/python2.7/socket.py&quot;, line 224, in meth
    return getattr(self._sock,name)(*args)
error: [Errno 111] Connection refused

I was able to get it into this state by repeatedly stopping and/or killing
the first node in the cluster and restarting it while simultaneously trying
various ways of tickling it with our application.

startup_log is getting stuck at &quot;starting database&quot; but there's no activity
going on in the cluster and I'd be surprised if I've sent &gt;100 messages
since I provisioned it.

I can provide remote access to whomever needs it, I just need their public
ssh key.

Thanks,
Bryan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111013/b5f13bcf/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111013/b5f13bcf/attachment.htm</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015508.html">[rabbitmq-discuss] HA active/active cluster in a bad state
</A></li>
	<LI>Next message: <A HREF="015517.html">[rabbitmq-discuss] HA active/active cluster in a bad state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15515">[ date ]</a>
              <a href="thread.html#15515">[ thread ]</a>
              <a href="subject.html#15515">[ subject ]</a>
              <a href="author.html#15515">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
