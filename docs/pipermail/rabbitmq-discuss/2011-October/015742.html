<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue Clustering and Sequencing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20Clustering%20and%20Sequencing&In-Reply-To=%3C4EA6D9DA.4070701%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015710.html">
   <LINK REL="Next"  HREF="015759.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue Clustering and Sequencing</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20Clustering%20and%20Sequencing&In-Reply-To=%3C4EA6D9DA.4070701%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Queue Clustering and Sequencing">simon at rabbitmq.com
       </A><BR>
    <I>Tue Oct 25 16:46:34 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015710.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
        <LI>Next message: <A HREF="015759.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15742">[ date ]</a>
              <a href="thread.html#15742">[ thread ]</a>
              <a href="subject.html#15742">[ subject ]</a>
              <a href="author.html#15742">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It's not completely obvious what you're asking. Are you saying that only 
(all?) messages with the same key are dependent on each other or is it 
something else? Are the messages just in dependent pairs or are they 
streams?

Also, please subscribe to the list if you want to ask questions here.

Cheers, Simon

On 24/10/11 21:05, Roger Fischer wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I am curious if RabbitMQ addresses the following use case.
</I>&gt;<i>
</I>&gt;<i> A single queue. Persistent.
</I>&gt;<i>
</I>&gt;<i> A producer creates messages fast (average 10 msg/sec).
</I>&gt;<i>
</I>&gt;<i> Consumers process messages slow (average 1 msg/sec). Thus 10 consumers
</I>&gt;<i> are required to keep up.
</I>&gt;<i>
</I>&gt;<i> Challenge 1: Some messages (&lt; 1%) are related and need to be processed
</I>&gt;<i> in order. If two dependent messages are less than 10 messages apart,
</I>&gt;<i> they are processed in parallel. That&#8217;s a problem.
</I>&gt;<i>
</I>&gt;<i> Obvious solution: create 10 queues, each with a different key, and each
</I>&gt;<i> with only one consumer. But:
</I>&gt;<i>
</I>&gt;<i> * Non-related messages are unnecessarily sequenced. When the key
</I>&gt;<i> distribution is not exactly even, one queue may have a backup while
</I>&gt;<i> another is idle.
</I>&gt;<i>
</I>&gt;<i> * Complex to configure for differently sized systems.
</I>&gt;<i>
</I>&gt;<i> Challenge 1+: earlier message could fail processing and be re-queued
</I>&gt;<i> with a delay. Obvious solution doesn&#8217;t fix that.
</I>&gt;<i>
</I>&gt;<i> Desired solution: Queue knows what messages are being processed /
</I>&gt;<i> re-queued and holds messages with the same key.
</I>&gt;<i>
</I>&gt;<i> But that&#8217;s not all. Consumers are clustered, with load balancing
</I>&gt;<i> (scalability) and failover (availability).
</I>&gt;<i>
</I>&gt;<i> Challenge 2a: related messages must still be processed by the same
</I>&gt;<i> consumer (and thus loadbalanced to the same node).
</I>&gt;<i>
</I>&gt;<i> Challenge 2b: related messages must be processed in order across node
</I>&gt;<i> failures.
</I>&gt;<i>
</I>&gt;<i> Obvious solution: Solution to 1 and migrate file store and consumer from
</I>&gt;<i> failed node to another node. But:
</I>&gt;<i>
</I>&gt;<i> * Need external system to manage migration.
</I>&gt;<i>
</I>&gt;<i> * Very complex to configure for differently sized systems (different
</I>&gt;<i> workloads, different node sizes and different cluster sizes).
</I>&gt;<i>
</I>&gt;<i> Desired solution: Solution 1 queues, and coordinate across nodes what
</I>&gt;<i> keys have messages being processed or re-queued. Will affect throughput
</I>&gt;<i> (we need only 250 msg/sec).
</I>&gt;<i>
</I>&gt;<i> Thanks&#8230;
</I>&gt;<i>
</I>&gt;<i> Roger
</I>&gt;<i>
</I>&gt;<i> PS: Please copy the response to my email (roger dot fischer at abb dot
</I>&gt;<i> Ventyx dot com) as I am not a subscriber of the list.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *Mindshare 2012 | May 8-10 | Orlando, FL *
</I>&gt;<i> *More details coming soon. *
</I>&gt;<i>
</I>&gt;<i> *Dates and location for European Mindshare coming soon. *
</I>&gt;<i>
</I>&gt;<i> DISCLAIMER:
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> This email message and all attachments transmitted with it are for the
</I>&gt;<i> sole use of the intended recipient(s) and may contain confidential and
</I>&gt;<i> privileged information. Please DO NOT forward this email outside of the
</I>&gt;<i> recipient's Company unless expressly authorized to do so herein. Any
</I>&gt;<i> unauthorized review, use, disclosure or distribution is prohibited. If
</I>&gt;<i> you are not the intended recipient, please contact the sender by reply
</I>&gt;<i> email and destroy all copies of the original message.
</I>&gt;<i>
</I>&gt;<i> Any views expressed in this email message are those of the individual
</I>&gt;<i> sender except where the sender specifically states them to be the views
</I>&gt;<i> of Ventyx.
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015710.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
	<LI>Next message: <A HREF="015759.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15742">[ date ]</a>
              <a href="thread.html#15742">[ thread ]</a>
              <a href="subject.html#15742">[ subject ]</a>
              <a href="author.html#15742">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
