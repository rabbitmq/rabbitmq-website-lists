<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20tell%20Java%20Client%20running%20in%20a%0A%09separate%20thread%20to%20stop%20consuming&In-Reply-To=%3C57B0E637-F358-4C18-B13B-9DAAB9524F3A%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015649.html">
   <LINK REL="Next"  HREF="015767.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20tell%20Java%20Client%20running%20in%20a%0A%09separate%20thread%20to%20stop%20consuming&In-Reply-To=%3C57B0E637-F358-4C18-B13B-9DAAB9524F3A%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming">steve at rabbitmq.com
       </A><BR>
    <I>Tue Oct 25 17:02:43 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015649.html">[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming
</A></li>
        <LI>Next message: <A HREF="015767.html">[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15747">[ date ]</a>
              <a href="thread.html#15747">[ thread ]</a>
              <a href="subject.html#15747">[ subject ]</a>
              <a href="author.html#15747">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>dusura,

As I said, there is no 'safe' general mechanism for stopping
one Java Thread from another.  The Interrupt mechanism in Java is
simply a convenience for *very simple cases*, or for debugging,
and cannot be regarded as safe on public interfaces.

In particular:

* changes to the design of a service might involve invoking more
  or fewer other threads (in which case you might be interrupting
  the wrong one);
* services might be invoked which themselves quietly consume
  interrupts;
* interrupts which fail to be trapped (due to timing considerations)
  can contaminate the thread for the next time it is run;
* it is not possible to tell the difference between spurious interrupts
  (part of the Java VM rules for wait(timeout)) and deliberate
  external interrupts.

It is much better to architect a solution. For example, in your case,
send a message to your client application which causes it to perform 
an orderly shutdown (including, one would expect, cancelling consumers 
and closing connections as we have discussed).  The client might
already have such a message architected, or if not, design one.

In the next release of RabbitMQ the thread upon which consumers
perform their callbacks need neither be the client thread, nor the 
connection thread, nor a thread dedicated to a particular channel.

In these circumstances, you are much better off calling a standard
interface like basicCancel().

Steve Powell  (a happy bunny)
----------some definitions from the SPD----------
Rigatoni n. A prime-ministerial grin.
Nigella n. The next bottle-size up from a Nebuchadnezzar.
Homily adv. Rather like a frenchman.

On 21 Oct 2011, at 01:28, dusura wrote:
&gt;<i> <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-October/015649.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-October/015649.html</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111025/7dcc704e/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111025/7dcc704e/attachment.htm</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015649.html">[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming
</A></li>
	<LI>Next message: <A HREF="015767.html">[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15747">[ date ]</a>
              <a href="thread.html#15747">[ thread ]</a>
              <a href="subject.html#15747">[ subject ]</a>
              <a href="author.html#15747">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
