<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Highest Reliability simple publish to a queue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Highest%20Reliability%20simple%20publish%20to%20a%20queue&In-Reply-To=%3C7ed78015-8608-4d7b-aec3-8efbb856f1ca%40u10g2000prl.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015594.html">
   <LINK REL="Next"  HREF="015584.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Highest Reliability simple publish to a queue</H1>
    <B>Matt G</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Highest%20Reliability%20simple%20publish%20to%20a%20queue&In-Reply-To=%3C7ed78015-8608-4d7b-aec3-8efbb856f1ca%40u10g2000prl.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Highest Reliability simple publish to a queue">mattgurney at gmail.com
       </A><BR>
    <I>Wed Oct 19 15:27:46 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015594.html">[rabbitmq-discuss] Highest Reliability simple publish to a queue
</A></li>
        <LI>Next message: <A HREF="015584.html">[rabbitmq-discuss] Round robin dispatch between N queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15600">[ date ]</a>
              <a href="thread.html#15600">[ thread ]</a>
              <a href="subject.html#15600">[ subject ]</a>
              <a href="author.html#15600">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Simon, that answers all my questions.

Matt.

On Oct 19, 9:43&#160;pm, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">si... at rabbitmq.com</A>&gt; wrote:
&gt;<i> On 18/10/11 15:16, Matt G wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; So far it appears to me that I should use the following, can you
</I>&gt;<i> &gt; review my list and edit as necessary:
</I>&gt;<i> &gt; Durable exchange
</I>&gt;<i> &gt; ExchangeType.Direct
</I>&gt;<i> &gt; Durable queue
</I>&gt;<i> &gt; Persistent message (Delivery Mode = 2)
</I>&gt;<i> &gt; Mandatory message
</I>&gt;<i> &gt; Model/Channel.ConfirmSelect&amp; &#160; Model.WaitForConfirmsOrDie();
</I>&gt;<i>
</I>&gt;<i> Sure, makes sense. The only thing that's unusual in your case is the use
</I>&gt;<i> of mandatory in order to test if the queue has been unbound. Normally I
</I>&gt;<i> would say &quot;well, don't unbind it then&quot;, this is not the sort of thing
</I>&gt;<i> that will happen spontaneously :)
</I>&gt;<i>
</I>&gt;<i> If you know the name of the queue you want to publish to then an
</I>&gt;<i> alternative would be to publish via the default exchange. Since queues
</I>&gt;<i> are always implicitly bound to the default exchange you could lose the
</I>&gt;<i> use of &quot;mandatory&quot; there. Assuming you are not going to delete the queue
</I>&gt;<i> in question...
</I>&gt;<i>
</I>&gt;<i> &gt; I also setup event handlers BasicAcks, BasicNacks&amp; &#160;BasicReturn.
</I>&gt;<i> &gt; If for testing purposes I unbind the queue from the exchange, and send
</I>&gt;<i> &gt; a single message, &#160;I get a BasicAck and a BasicReturn(NO_ROUTE) back,
</I>&gt;<i> &gt; however the Model.WaitForConfirmsOrDie() returns without error.
</I>&gt;<i>
</I>&gt;<i> Yes, WaitForConfirmsOrDie() is just counting acks aka confirms.
</I>&gt;<i> Basic.return is a different thing. RabbitMQ will ensure that by the time
</I>&gt;<i> you get an ack back, you will have received a basic.return if one was
</I>&gt;<i> going to be sent.
</I>&gt;<i>
</I>&gt;<i> &gt; This
</I>&gt;<i> &gt; seems inconsistent in that my message has been lost as there is no
</I>&gt;<i> &gt; queue bound to the exchange and I have specified mandatory and every
</I>&gt;<i> &gt; persistent option I can find. Is this correct, or am I doing something
</I>&gt;<i> &gt; wrong? Do I need to do/check both (WaitForConfirms&amp; &#160;BasicReturn event
</I>&gt;<i> &gt; msg) to be sure the message was successfully delivered to the queue?
</I>&gt;<i>
</I>&gt;<i> Yes.
</I>&gt;<i>
</I>&gt;<i> The meaning of a confirm is &quot;RabbitMQ has taken responsibility for the
</I>&gt;<i> message, and handled it in whatever way it was meant to be handled&quot;. If
</I>&gt;<i> that means dropping it on the floor as unrouted then so be it - the
</I>&gt;<i> assumption is that the routing is set up how you wanted it. manadtory /
</I>&gt;<i> basic.return then adds on top of that the ability to check that a
</I>&gt;<i> message got routed somewhere.
</I>&gt;<i>
</I>&gt;<i> &gt; Where is the documentation for API calls which are not documented in
</I>&gt;<i> &gt; the API doc, an example is WaitForConfirmsOrDie, but there are many
</I>&gt;<i> &gt; others?
</I>&gt;<i>
</I>&gt;<i> Hmm. The HTMLdoc for those is not coming through. Looks like invalid
</I>&gt;<i> XML. Will file a bug.
</I>&gt;<i>
</I>&gt;<i> It's in the source:<A HREF="http://hg.rabbitmq.com/rabbitmq-dotnet-client/file/rabbitmq_v2_6_1/pr...">http://hg.rabbitmq.com/rabbitmq-dotnet-client/file/rabbitmq_v2_6_1/pr...</A>
</I>&gt;<i>
</I>&gt;<i> &gt; I read one of the other posts directing people away from transactions
</I>&gt;<i> &gt; and towards the Model/Channel.ConfirmSelect&amp;
</I>&gt;<i> &gt; Model.WaitForConfirmsOrDie() model, so I have not investigated
</I>&gt;<i> &gt; transactions.
</I>&gt;<i>
</I>&gt;<i> That's reasonable.
</I>&gt;<i>
</I>&gt;<i> &gt; What about connection heart beating? I know from my experience with
</I>&gt;<i> &gt; other products HB's are good way to keep the client and server in-sync
</I>&gt;<i> &gt; and aware if the other party has gone off line. Should I overwrite the
</I>&gt;<i> &gt; default which appears to be no heartbeats?
</I>&gt;<i>
</I>&gt;<i> Yes, that would be reasonable. Depends on whether you're more concerned
</I>&gt;<i> about a short connectivity loss killing your connections or a long one
</I>&gt;<i> going undetected...
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Simon MacMullen
</I>&gt;<i> RabbitMQ, VMware
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-disc... at lists.rabbitmq.comhttps</A>://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss
</I></PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015594.html">[rabbitmq-discuss] Highest Reliability simple publish to a queue
</A></li>
	<LI>Next message: <A HREF="015584.html">[rabbitmq-discuss] Round robin dispatch between N queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15600">[ date ]</a>
              <a href="thread.html#15600">[ thread ]</a>
              <a href="subject.html#15600">[ subject ]</a>
              <a href="author.html#15600">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
