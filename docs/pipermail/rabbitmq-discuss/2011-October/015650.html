<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Creating mirrored queues via STOMP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Creating%20mirrored%20queues%20via%20STOMP&In-Reply-To=%3C4EA11E2D.4070700%40strategicdata.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015635.html">
   <LINK REL="Next"  HREF="015667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Creating mirrored queues via STOMP</H1>
    <B>Toby Corkindale</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Creating%20mirrored%20queues%20via%20STOMP&In-Reply-To=%3C4EA11E2D.4070700%40strategicdata.com.au%3E"
       TITLE="[rabbitmq-discuss] Creating mirrored queues via STOMP">toby.corkindale at strategicdata.com.au
       </A><BR>
    <I>Fri Oct 21 08:24:29 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015635.html">[rabbitmq-discuss] Creating mirrored queues via STOMP
</A></li>
        <LI>Next message: <A HREF="015667.html">[rabbitmq-discuss] Creating mirrored queues via STOMP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15650">[ date ]</a>
              <a href="thread.html#15650">[ thread ]</a>
              <a href="subject.html#15650">[ subject ]</a>
              <a href="author.html#15650">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 21/10/11 01:53, Steve Powell wrote:
&gt;<i> Hi Toby,
</I>&gt;<i>
</I>&gt;<i> Unfortunately it is not possible to set ha policy or ttl
</I>&gt;<i> settings on a rabbit STOMP-created queue. [1] [2]
</I>&gt;<i>
</I>&gt;<i> However, it is possible to send to and subscribe from
</I>&gt;<i> a queue created in AMQP using /amq/queue/&lt;name&gt;
</I>&gt;<i> destinations inSTOMP. These queues can have any of the
</I>&gt;<i> rabbit-supported properties.
</I>&gt;<i>
</I>&gt;<i> We currently have an enhancement under discussion that
</I>&gt;<i> puts these headers on SUBSCRIBE or SEND, so that the
</I>&gt;<i> STOMP adapter can create the right sort of queue; but
</I>&gt;<i> we are not sure what to do if the header values disagree
</I>&gt;<i> on two commands referring to the &quot;same&quot; queue.
</I>&gt;<i>
</I>&gt;<i> The STOMP protocol design makes it hard to define queue
</I>&gt;<i> properties, as opposed to message properties, since
</I>&gt;<i> queue-creation is implicit and conditional. It would be
</I>&gt;<i> a surprise if one application sets a queue property and
</I>&gt;<i> another removes it or resets it (or fails if the property
</I>&gt;<i> is different).
</I>&gt;<i>
</I>&gt;<i> A description of your application which requires this
</I>&gt;<i> would help us with future design.
</I>
Hi Steve,
It's nothing terribly complex.

There are several applications which generate task requests; they 
generate hundreds of these very rapidly, but only from time to time.

The tasks go through several stages. Each stage has some application 
servers that are subscribed to a queue to process precisely one request, 
then enqueue a new message for the next stage.

RabbitMQ works to hold the queue of pending tasks at each stage. Each 
stage has a separate queue. The backlog of messages surges up to a few 
hundred, then back down to zero as they get processed.

It all works quite nicely, but if I power off one of the two nodes in 
our rabbitmq cluster, then there's a 50% chance we have just lost all 
the messages in some queues. The messages are all marked as persistent, 
so as long as the machine recovers, they'll be safe.. but there's still 
a pause until you fix the machine.

So I was thinking the mirrored queues would work well for us - if a 
machine dies, then it's OK, messages will still carry on being processed 
out of the backlog.

Cheers,
Toby
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015635.html">[rabbitmq-discuss] Creating mirrored queues via STOMP
</A></li>
	<LI>Next message: <A HREF="015667.html">[rabbitmq-discuss] Creating mirrored queues via STOMP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15650">[ date ]</a>
              <a href="thread.html#15650">[ thread ]</a>
              <a href="subject.html#15650">[ subject ]</a>
              <a href="author.html#15650">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
