<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20tell%20Java%20Client%20running%20in%20a%0A%09separate%20thread%20to%20stop%20consuming&In-Reply-To=%3C60778BB2-58CE-456E-9713-850F3D59C31B%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015624.html">
   <LINK REL="Next"  HREF="015643.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming</H1>
    <B>Steve Powell</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20tell%20Java%20Client%20running%20in%20a%0A%09separate%20thread%20to%20stop%20consuming&In-Reply-To=%3C60778BB2-58CE-456E-9713-850F3D59C31B%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] How to tell Java Client running in a	separate thread to stop consuming">steve at rabbitmq.com
       </A><BR>
    <I>Thu Oct 20 15:09:39 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015624.html">[rabbitmq-discuss] How to tell Java Client running in a separate	thread to stop consuming
</A></li>
        <LI>Next message: <A HREF="015643.html">[rabbitmq-discuss] How to tell Java Client running in a separate thread to stop consuming
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15633">[ date ]</a>
              <a href="thread.html#15633">[ thread ]</a>
              <a href="subject.html#15633">[ subject ]</a>
              <a href="author.html#15633">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I cannot tell from where you wish to stop the client.
I will assume you mean from another Java thread.

To start consuming, you issued basicConsume(...) and either 
supplied a tag (java.lang.String) to or had one returned
from this call.  The tag identifies the consumer.  To stop 
consuming you issue basicCancel(tag) on the same channel.  
This stops just this one Consumer. It can be issued from 
another thread.

The Consumer will be called once before it stops: 
handleCancelOk() is the last callback it receives.

But you asked about stopping a &gt;client&lt; from consuming; in
general there is no general and reliable Java way of stopping 
a thread, and a client may in any case have several threads 
running. To stop a whole client from consuming would require
application specific code.

Of course closing the channel will stop all the consumers
but I guess you want something less draconian.

I hope this helps you. If not, please supply more details 
of your application and requirement.

Steve Powell  (a happy bunny)
----------some definitions from the SPD----------
Rigatoni n. A prime-ministerial grin.
Nigella n. The next bottle-size up from a Nebuchadnezzar.
Homily adv. Rather like a frenchman.

On 20 Oct 2011, at 07:52, dusura wrote:

&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I would like to tell a Java Client to stop consuming. The client is
</I>&gt;<i> running in a separate thread. How can I do this?
</I>&gt;<i> 
</I>&gt;<i> I tried interrupting the thread but the RabbitMQ impl swallows
</I>&gt;<i> InterruptedException.
</I>&gt;<i> 
</I>&gt;<i> Any suggestions would be appreciated.
</I>&gt;<i> 
</I>&gt;<i> Cheers.
</I>&gt;<i> 
</I>&gt;<i> My thread looks like this:
</I>&gt;<i> 
</I>&gt;<i> &quot;Thread-1&quot; prio=6 tid=0x03766400 nid=0x738 in Object.wait()
</I>&gt;<i> [0x03f0f000]
</I>&gt;<i>   java.lang.Thread.State: WAITING (on object monitor)
</I>&gt;<i> 	at java.lang.Object.wait(Native Method)
</I>&gt;<i> 	at java.lang.Object.wait(Object.java:485)
</I>&gt;<i> 	at com.rabbitmq.utility.BlockingCell.get(BlockingCell.java:50)
</I>&gt;<i> 	- locked &lt;0x22ce4fd8&gt; (a
</I>&gt;<i> com.rabbitmq.utility.BlockingValueOrException)
</I>&gt;<i> 	at
</I>&gt;<i> com.rabbitmq.utility.BlockingCell.uninterruptibleGet(BlockingCell.java:
</I>&gt;<i> 89)
</I>&gt;<i> 	- locked &lt;0x22ce4fd8&gt; (a
</I>&gt;<i> com.rabbitmq.utility.BlockingValueOrException)
</I>&gt;<i> 	at
</I>&gt;<i> com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:
</I>&gt;<i> 33)
</I>&gt;<i> 	at com.rabbitmq.client.impl.AMQChannel
</I>&gt;<i> $BlockingRpcContinuation.getReply(AMQChannel.java:337)
</I>&gt;<i> 	at com.rabbitmq.client.impl.AMQChannel.privateRpc(AMQChannel.java:
</I>&gt;<i> 210)
</I>&gt;<i> 	at com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:
</I>&gt;<i> 128)
</I>&gt;<i> 	at com.rabbitmq.client.impl.ChannelN.basicGet(ChannelN.java:808)
</I>&gt;<i> 	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
</I>&gt;<i> 	at
</I>&gt;<i> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:
</I>&gt;<i> 25)
</I>&gt;<i> 	at java.lang.reflect.Method.invoke(Method.java:597)
</I>&gt;<i> ..............
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111020/888702cd/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111020/888702cd/attachment.htm</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015624.html">[rabbitmq-discuss] How to tell Java Client running in a separate	thread to stop consuming
</A></li>
	<LI>Next message: <A HREF="015643.html">[rabbitmq-discuss] How to tell Java Client running in a separate thread to stop consuming
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15633">[ date ]</a>
              <a href="thread.html#15633">[ thread ]</a>
              <a href="subject.html#15633">[ subject ]</a>
              <a href="author.html#15633">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
