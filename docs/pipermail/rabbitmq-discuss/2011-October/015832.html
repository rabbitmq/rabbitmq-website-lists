<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Queue Clustering and Sequencing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20Clustering%20and%20Sequencing&In-Reply-To=%3Cb89a44ba-69a4-4463-a61e-fd1f08328e7c%40l19g2000yqm.googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015809.html">
   <LINK REL="Next"  HREF="015851.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Queue Clustering and Sequencing</H1>
    <B>RogerF</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Queue%20Clustering%20and%20Sequencing&In-Reply-To=%3Cb89a44ba-69a4-4463-a61e-fd1f08328e7c%40l19g2000yqm.googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Queue Clustering and Sequencing">roger.fischer at abb.ventyx.com
       </A><BR>
    <I>Thu Oct 27 18:59:33 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015809.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
        <LI>Next message: <A HREF="015851.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15832">[ date ]</a>
              <a href="thread.html#15832">[ thread ]</a>
              <a href="subject.html#15832">[ subject ]</a>
              <a href="author.html#15832">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mathias,

thanks for your reply.

&gt;<i> have you tried the obvious approach suggested in your first post, i.e.
</I>&gt;<i> have one queue per consumer and ensure that messages for the same key
</I>&gt;<i> always end up in the same queue?
</I>
Yes, that is what we currently are doing (in the single instance
environment).

&gt;<i> &gt; Non-related messages are unnecessarily sequenced. When the key
</I>&gt;<i> &gt; distribution is not exactly even, one queue may have a backup while
</I>&gt;<i> &gt; another is idle.
</I>&gt;<i>
</I>&gt;<i> ...but is that really an issue in practice?
</I>
Yes. But a bigger problem is a slow messages. Most messages are
processed in a few hundred milliseconds. But occasionally a message
takes a few seconds to process. That delays the following, unrelaed
messages that happen to be in the same queue. The other queues would
have capacity to process these messages with minimal delay.

&gt;<i> Take a look <A HREF="athttps://github.com/rabbitmq/rabbitmq-consistent-hash-exchange">athttps://github.com/rabbitmq/rabbitmq-consistent-hash-exchange</A>
</I>
That helps a lot.

Though one problem remains. When a node fails, the messages on that
node's queues are still stuck there. The consistent-hash-exchange will
re-route future messages to a different queue, avoiding the need to
migrate the consumer. But the message already delivered to the
original queue will not be processed until the node recovers, at which
time they are out of sequence.

Roger
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015809.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
	<LI>Next message: <A HREF="015851.html">[rabbitmq-discuss] Queue Clustering and Sequencing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15832">[ date ]</a>
              <a href="thread.html#15832">[ thread ]</a>
              <a href="subject.html#15832">[ subject ]</a>
              <a href="author.html#15832">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
