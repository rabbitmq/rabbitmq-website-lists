<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Temp Queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Temp%20Queues&In-Reply-To=%3C4EA5351B.9060903%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015692.html">
   <LINK REL="Next"  HREF="015701.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Temp Queues</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Temp%20Queues&In-Reply-To=%3C4EA5351B.9060903%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Temp Queues">simon at rabbitmq.com
       </A><BR>
    <I>Mon Oct 24 10:51:23 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015692.html">[rabbitmq-discuss] Temp Queues
</A></li>
        <LI>Next message: <A HREF="015701.html">[rabbitmq-discuss] about server start
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15699">[ date ]</a>
              <a href="thread.html#15699">[ thread ]</a>
              <a href="subject.html#15699">[ subject ]</a>
              <a href="author.html#15699">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 23/10/11 19:31, Gil Strauss wrote:
&gt;<i> On publisher:
</I>&gt;<i> 1.
</I>&gt;<i>      channel.exchangeDeclare(exchangeName, &quot;direct&quot;)
</I>&gt;<i>
</I>&gt;<i>      val queueName = channel.queueDeclare().getQueue()
</I>&gt;<i>
</I>&gt;<i>      channel.queueBind(queueName, exchangeName, routingKey)
</I>
The zero-args version of queueDeclare() creates a server-named exclusive 
queue - this is one that is owned by the connection and will be deleted 
when it is closed.

Here you are declaring such an exclusive queue and then binding it in 
your publisher - if you are only going to publish then you don't need to 
do this.

&gt;<i> 2.
</I>&gt;<i>   Publish message
</I>&gt;<i>
</I>&gt;<i> 3.
</I>&gt;<i> On subscriber:
</I>&gt;<i>      channel.exchangeDeclare(exchangeName, &quot;direct&quot;)
</I>&gt;<i>
</I>&gt;<i>      val queueName = channel.queueDeclare().getQueue()
</I>&gt;<i>
</I>&gt;<i>      channel.queueBind(queueName, exchangeName, routingKey)
</I>&gt;<i>
</I>&gt;<i> 4.
</I>&gt;<i> Result: Subscriber is not getting the message
</I>&gt;<i>
</I>&gt;<i> On the other hand, if I do 3 and only then 1 and 2: the subscriber is
</I>&gt;<i> getting the message.
</I>&gt;<i>
</I>&gt;<i> So the questions are:
</I>&gt;<i> a. Am I doing something wrong
</I>&gt;<i> b. How can I ensure that the subscriber gets the message even if it
</I>&gt;<i> was published before it subscribed to it?
</I>
The queue must exist before the message is published to it. You'll want 
to create queues which are non-exclusive and probably durable, and 
probably have your subscribers create names for them so they always 
connect to the same one (alternately have each subscriber declare a 
server-named queue the first time it starts up, then stash the name 
somewhere so it can connect again later).

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015692.html">[rabbitmq-discuss] Temp Queues
</A></li>
	<LI>Next message: <A HREF="015701.html">[rabbitmq-discuss] about server start
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15699">[ date ]</a>
              <a href="thread.html#15699">[ thread ]</a>
              <a href="subject.html#15699">[ subject ]</a>
              <a href="author.html#15699">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
