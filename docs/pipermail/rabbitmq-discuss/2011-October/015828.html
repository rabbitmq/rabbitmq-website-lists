<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20RabbitMQ%20API%20bug%20in%0A%09response.getHeaders%28%29%3F&In-Reply-To=%3CCAM8fPiRnLhL2zgEj1nkeBMFpbX7gFdu3QniagHY4b4ZL6B26wA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015827.html">
   <LINK REL="Next"  HREF="015830.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?</H1>
    <B>Tony Garnock-Jones</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20RabbitMQ%20API%20bug%20in%0A%09response.getHeaders%28%29%3F&In-Reply-To=%3CCAM8fPiRnLhL2zgEj1nkeBMFpbX7gFdu3QniagHY4b4ZL6B26wA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?">tonygarnockjones+rabbitmq at gmail.com
       </A><BR>
    <I>Thu Oct 27 17:51:31 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015827.html">[rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?
</A></li>
        <LI>Next message: <A HREF="015830.html">[rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15828">[ date ]</a>
              <a href="thread.html#15828">[ thread ]</a>
              <a href="subject.html#15828">[ subject ]</a>
              <a href="author.html#15828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 27 October 2011 12:23, Mario Leyton &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mleyton at niclabs.cl</A>&gt; wrote:

&gt;<i> If there are no headers, it doesn't matter why, a good API should always
</I>&gt;<i> return an empty Map o List and not null because it contaminates the API
</I>&gt;<i> user's code.
</I>

It may do so for Java. Other languages do things like this differently.
AMQP is language-neutral, and has its own semantics. The API should make it
easy for the user to work with AMQP semantics, and should not, for example,
lull the user into a false sense that all the world is a Java program. If a
sender sent a message with a missing username header, for instance, that
should be hard to misinterpret as the sender having sent a message with an
empty-string username header. IMO, the same applies to maps, integers,
booleans, timestamps etc. (I'm not even sure what a sensible
&quot;default&quot;/&quot;missing&quot; value for a timestamp would be.)

You're right that we could do what the C library does, and use a separate
flag, but I believe this would make it more likely that subtle
interoperability issues would arise. At least with the NPE you get rapid
feedback that someone isn't following the communication contract; either
the local Java code, in which case adding a null check lets you conform to
the language being spoken by the remote party, or the remote party's code,
in which case you can either choose to work around the difference locally
or get the remote party to change. Papering over the difference at the API
level masks the underlying problem.

If you are working in an all-java environment, a good choice for your code
might be to abstract away the difference between a missing map and an empty
map.

Regards,
  Tony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111027/3601f689/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111027/3601f689/attachment.htm</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015827.html">[rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?
</A></li>
	<LI>Next message: <A HREF="015830.html">[rabbitmq-discuss] Java RabbitMQ API bug in	response.getHeaders()?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15828">[ date ]</a>
              <a href="thread.html#15828">[ thread ]</a>
              <a href="subject.html#15828">[ subject ]</a>
              <a href="author.html#15828">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
