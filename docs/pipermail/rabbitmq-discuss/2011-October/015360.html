<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] upgrade rabbitmq from 1.7.1 without loosing any	messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20upgrade%20rabbitmq%20from%201.7.1%20without%20loosing%20any%0A%09messages&In-Reply-To=%3C11222305.1636.1317726643909.JavaMail.geo-discussion-forums%40yqjw35%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015375.html">
   <LINK REL="Next"  HREF="015361.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] upgrade rabbitmq from 1.7.1 without loosing any	messages</H1>
    <B>Ivan Glushkov</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20upgrade%20rabbitmq%20from%201.7.1%20without%20loosing%20any%0A%09messages&In-Reply-To=%3C11222305.1636.1317726643909.JavaMail.geo-discussion-forums%40yqjw35%3E"
       TITLE="[rabbitmq-discuss] upgrade rabbitmq from 1.7.1 without loosing any	messages">gli.work at gmail.com
       </A><BR>
    <I>Tue Oct  4 12:10:43 BST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="015375.html">[rabbitmq-discuss] Is there a channel publish throughput limit to a queue?
</A></li>
        <LI>Next message: <A HREF="015361.html">[rabbitmq-discuss] upgrade rabbitmq from 1.7.1 without loosing any	messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15360">[ date ]</a>
              <a href="thread.html#15360">[ thread ]</a>
              <a href="subject.html#15360">[ subject ]</a>
              <a href="author.html#15360">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all.

We have several separate rabbitmq nodes with version &quot;1.7.1&quot; and we want to 
upgrade them to the newest version.
As I've read on this forum we can't do this just updating rabbitmq version 
as db schema has changed (so we will have all our messages lost)

The only possibility I see is the following sequence:
1. Create new server with the newest rabbitmq version.
2. For every subscriber in old_rmq_server create new subscriber with the 
same characteristics in new_rmq_server. Pause them all.
3. Switch publishers to use new_rmq_server.  
    At this point all new messages go to the new_rmq_server, but they are 
not processed as all readers are paused. While old subscribers process 
messages from the old_rmq_server
4. When all queues in old_rmq_server are empty turn old subscribers off
Done.


But it's quite a difficult process as it requires a lot of code changes, 
manual work, etc.

Is there any other option to switch from the old version to the newest one?

Best,
Ivan.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111004/23580ceb/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20111004/23580ceb/attachment.htm</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015375.html">[rabbitmq-discuss] Is there a channel publish throughput limit to a queue?
</A></li>
	<LI>Next message: <A HREF="015361.html">[rabbitmq-discuss] upgrade rabbitmq from 1.7.1 without loosing any	messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15360">[ date ]</a>
              <a href="thread.html#15360">[ thread ]</a>
              <a href="subject.html#15360">[ subject ]</a>
              <a href="author.html#15360">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
