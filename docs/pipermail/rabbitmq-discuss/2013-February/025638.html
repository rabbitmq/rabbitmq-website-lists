<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ dying
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20dying&In-Reply-To=%3CCAMxMOAuTB75Q%2B3KUEhCt8z8uGNg%3Dk9VspvS2mbo%2BQrLteUmFFg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025637.html">
   <LINK REL="Next"  HREF="025639.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ dying</H1>
    <B>Christian S. Perone</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20dying&In-Reply-To=%3CCAMxMOAuTB75Q%2B3KUEhCt8z8uGNg%3Dk9VspvS2mbo%2BQrLteUmFFg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ dying">christian.perone at gmail.com
       </A><BR>
    <I>Sat Feb 23 01:00:34 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025637.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
        <LI>Next message: <A HREF="025639.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25638">[ date ]</a>
              <a href="thread.html#25638">[ thread ]</a>
              <a href="subject.html#25638">[ subject ]</a>
              <a href="author.html#25638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Jerry, great thanks for the quick reply. I'll try to update the
Erlang VM to a newer one, the directory '/etc/rabbitmq/rabbitmq.conf.d'
didn't exist (I think it was removed on the upgrade process to the 3.0.2
version), but this message is only showing on the version 3.0.2, when I was
using the 2.7.1 the conf.d was present and the same thing happened, so I
think that this couldn't be the cause. I'll upgrade the Erlang and stress
it again to check how it works.


On Fri, Feb 22, 2013 at 9:55 PM, Jerry Kuch &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">jerryk at rbcon.com</A>&gt; wrote:

&gt;<i> Hi, Christian:
</I>&gt;<i>
</I>&gt;<i> Hello, I'm facing some problems with different versions of RabbitMQ (2.7.1
</I>&gt;&gt;<i> and 3.0.2), and I couldn't
</I>&gt;&gt;<i> find any trace of problem in the logs (perhaps I'm looking the wrong log
</I>&gt;&gt;<i> file), anyway, the rabbitmq is dying after running well for some time, I'm
</I>&gt;&gt;<i> using only two queues and the messages are working on a rate of 132
</I>&gt;&gt;<i> msgs/sec, but after 2 or 3 hours the rabbitmq simple dies and the only log
</I>&gt;&gt;<i> I can see is from the kernel log (dmesg), with RabbitMQ 3.0.2:
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That's pretty tiny load... one wouldn't expect a Rabbit to stress much
</I>&gt;<i> under that.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> [38178.105567] beam.smp[1514] general protection ip:4d8b48
</I>&gt;&gt;<i> sp:7f979f41e7a0 error:0 in beam.smp[400000+1af000]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ... which looks pretty bad. The same message appeared with version 2.7.1
</I>&gt;&gt;<i> and all logs in /var/log/rabbitmq didn't showed anything that could be an
</I>&gt;&gt;<i> error, just info about connections, etc. Also, after I updated it to the
</I>&gt;&gt;<i> version 3.0.2, the only log that RabbitMQ touched was
</I>&gt;&gt;<i> /var/log/rabbitmq/startup_err, which contained the messages:
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Egads...  that's your Erlang VM crashing hard.  Erlang R14B04 is a little
</I>&gt;<i> bit old, but was a pretty solid release.  You might try upgrading your
</I>&gt;<i> Erlang release to one of the newer R15s, although bits of this make me
</I>&gt;<i> wonder if something worse is afoot on this machine.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> ls: cannot access /etc/rabbitmq/rabbitmq.conf.d: No such file or directory
</I>&gt;&gt;<i> Segmentation fault (core dumped)
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Does the rabbitmq.conf.d directory and any of its contents exist?  What's
</I>&gt;<i> the story on permissions?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Besides the conf error message the server worked for nearly 2 hours and
</I>&gt;&gt;<i> then died, but now it is showing the segfault message that wasn't show on
</I>&gt;&gt;<i> the 2.7.1 version.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm using Ubuntu server 12.04.2 (LTS) with kernel 3.2.0 (x86_64) and
</I>&gt;&gt;<i> Erlang v.5.8.5.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Does anyone already faced this problem or have any clue about what could
</I>&gt;&gt;<i> be causing this ?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'd:
</I>&gt;<i>
</I>&gt;<i> 1. Upgrade Erlang
</I>&gt;<i> 2. Possibly reinstall Rabbit
</I>&gt;<i>
</I>&gt;<i> Segmentation faults of the Erlang VM are relatively rare, and it's not
</I>&gt;<i> easy to cause one from Rabbit's own code...  Usually if one sees one
</I>&gt;<i> something more wretched is afoot on the system....
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i> Jerry
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Blog &lt;<A HREF="http://pyevolve.sourceforge.net/wordpress/">http://pyevolve.sourceforge.net/wordpress/</A>&gt; |
Github&lt;<A HREF="https://github.com/perone">https://github.com/perone</A>&gt;
|<i> Twitter &lt;<A HREF="https://twitter.com/tarantulae">https://twitter.com/tarantulae</A>&gt;
</I>&quot;Forgive, O Lord, my little jokes on Thee, and I'll forgive Thy great big
joke on me.&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130222/aa6d2cd1/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130222/aa6d2cd1/attachment.htm</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025637.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
	<LI>Next message: <A HREF="025639.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25638">[ date ]</a>
              <a href="thread.html#25638">[ thread ]</a>
              <a href="subject.html#25638">[ subject ]</a>
              <a href="author.html#25638">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
