<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ Producer Flow Control
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Producer%20Flow%20Control&In-Reply-To=%3CCAJsfpELF%3DheJrjK0hbi7aWm5XcCnMhVtn8%2BOUT22e7uTTT6-dg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025304.html">
   <LINK REL="Next"  HREF="025320.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ Producer Flow Control</H1>
    <B>Aaron Blew</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20Producer%20Flow%20Control&In-Reply-To=%3CCAJsfpELF%3DheJrjK0hbi7aWm5XcCnMhVtn8%2BOUT22e7uTTT6-dg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ Producer Flow Control">aaronblew at gmail.com
       </A><BR>
    <I>Fri Feb  1 17:31:14 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025304.html">[rabbitmq-discuss] configure rabbitmq disk_free_limit
</A></li>
        <LI>Next message: <A HREF="025320.html">[rabbitmq-discuss] RabbitMQ Producer Flow Control
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25305">[ date ]</a>
              <a href="thread.html#25305">[ thread ]</a>
              <a href="subject.html#25305">[ subject ]</a>
              <a href="author.html#25305">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,
I'm currently using RabbitMQ 2.8.1 as the backbone of my Logstash
architecture.  Currently I've got 5 RabbitMQ servers running shovels that
push messages onto the &quot;mothership&quot;, where data is consumed by a Logstash
agent that feeds into various endpoints.

The issue is that under high load the Logstash consumer on the mothership
isn't fast enough at to keep up with the data coming in (generally above
4,000 messages/sec).  Normally this wouldn't be a problem since we've got
capacity to buffer things on the mothership, but RabbitMQ starts rate
limiting the shovels that are sending data in, which compounds the issue
since the nodes shoveling data don't have as much IO capacity as the
mothership does.  If I stop the slow consumer on the mothership, the
shovels play data in as fast as they can acknowledge it.

Ideally I'd be able to turn off producer flow control on the mothership
side so the shovels wouldn't be slowed down except in cases where I'm
approaching high watermarks or something along those lines.

Can anyone offer any suggestions on how I might be able to adjust the
behavior?

Thanks,
-Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130201/919d9ce2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130201/919d9ce2/attachment.htm</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025304.html">[rabbitmq-discuss] configure rabbitmq disk_free_limit
</A></li>
	<LI>Next message: <A HREF="025320.html">[rabbitmq-discuss] RabbitMQ Producer Flow Control
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25305">[ date ]</a>
              <a href="thread.html#25305">[ thread ]</a>
              <a href="subject.html#25305">[ subject ]</a>
              <a href="author.html#25305">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
