<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ dying
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20dying&In-Reply-To=%3CCAE0Sz%3DxEPNZJRB4ucwdGj7-ACxbgwc%3DvVZ7rHdOPv%2BZYpae%2BtQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025636.html">
   <LINK REL="Next"  HREF="025638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ dying</H1>
    <B>Jerry Kuch</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20dying&In-Reply-To=%3CCAE0Sz%3DxEPNZJRB4ucwdGj7-ACxbgwc%3DvVZ7rHdOPv%2BZYpae%2BtQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ dying">jerryk at rbcon.com
       </A><BR>
    <I>Sat Feb 23 00:55:23 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025636.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
        <LI>Next message: <A HREF="025638.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25637">[ date ]</a>
              <a href="thread.html#25637">[ thread ]</a>
              <a href="subject.html#25637">[ subject ]</a>
              <a href="author.html#25637">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi, Christian:

Hello, I'm facing some problems with different versions of RabbitMQ (2.7.1
&gt;<i> and 3.0.2), and I couldn't
</I>&gt;<i> find any trace of problem in the logs (perhaps I'm looking the wrong log
</I>&gt;<i> file), anyway, the rabbitmq is dying after running well for some time, I'm
</I>&gt;<i> using only two queues and the messages are working on a rate of 132
</I>&gt;<i> msgs/sec, but after 2 or 3 hours the rabbitmq simple dies and the only log
</I>&gt;<i> I can see is from the kernel log (dmesg), with RabbitMQ 3.0.2:
</I>&gt;<i>
</I>
That's pretty tiny load... one wouldn't expect a Rabbit to stress much
under that.


&gt;<i> [38178.105567] beam.smp[1514] general protection ip:4d8b48 sp:7f979f41e7a0
</I>&gt;<i> error:0 in beam.smp[400000+1af000]
</I>&gt;<i>
</I>&gt;<i> ... which looks pretty bad. The same message appeared with version 2.7.1
</I>&gt;<i> and all logs in /var/log/rabbitmq didn't showed anything that could be an
</I>&gt;<i> error, just info about connections, etc. Also, after I updated it to the
</I>&gt;<i> version 3.0.2, the only log that RabbitMQ touched was
</I>&gt;<i> /var/log/rabbitmq/startup_err, which contained the messages:
</I>&gt;<i>
</I>
Egads...  that's your Erlang VM crashing hard.  Erlang R14B04 is a little
bit old, but was a pretty solid release.  You might try upgrading your
Erlang release to one of the newer R15s, although bits of this make me
wonder if something worse is afoot on this machine.


&gt;<i> ls: cannot access /etc/rabbitmq/rabbitmq.conf.d: No such file or directory
</I>&gt;<i> Segmentation fault (core dumped)
</I>&gt;<i>
</I>
Does the rabbitmq.conf.d directory and any of its contents exist?  What's
the story on permissions?


&gt;<i> Besides the conf error message the server worked for nearly 2 hours and
</I>&gt;<i> then died, but now it is showing the segfault message that wasn't show on
</I>&gt;<i> the 2.7.1 version.
</I>&gt;<i>
</I>&gt;<i> I'm using Ubuntu server 12.04.2 (LTS) with kernel 3.2.0 (x86_64) and
</I>&gt;<i> Erlang v.5.8.5.
</I>&gt;<i>
</I>&gt;<i> Does anyone already faced this problem or have any clue about what could
</I>&gt;<i> be causing this ?
</I>&gt;<i>
</I>
I'd:

1. Upgrade Erlang
2. Possibly reinstall Rabbit

Segmentation faults of the Erlang VM are relatively rare, and it's not easy
to cause one from Rabbit's own code...  Usually if one sees one something
more wretched is afoot on the system....

Best regards,
Jerry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130222/31e22554/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130222/31e22554/attachment.htm</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025636.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
	<LI>Next message: <A HREF="025638.html">[rabbitmq-discuss] RabbitMQ dying
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25637">[ date ]</a>
              <a href="thread.html#25637">[ thread ]</a>
              <a href="subject.html#25637">[ subject ]</a>
              <a href="author.html#25637">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
