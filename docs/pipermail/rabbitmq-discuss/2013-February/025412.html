<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ blocking issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20blocking%20issue&In-Reply-To=%3C0C5C3C8F51B90E4596BB1263843DEB15013774F678%40hq-ex-mb03.ad.navteq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025416.html">
   <LINK REL="Next"  HREF="025415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ blocking issue</H1>
    <B>Konar Peter (Nokia-LC/Chicago)</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20blocking%20issue&In-Reply-To=%3C0C5C3C8F51B90E4596BB1263843DEB15013774F678%40hq-ex-mb03.ad.navteq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ blocking issue">peter.konar at nokia.com
       </A><BR>
    <I>Thu Feb  7 23:00:29 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025416.html">[rabbitmq-discuss] The mechanics of message exchange between the broker and consumer
</A></li>
        <LI>Next message: <A HREF="025415.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25412">[ date ]</a>
              <a href="thread.html#25412">[ thread ]</a>
              <a href="subject.html#25412">[ subject ]</a>
              <a href="author.html#25412">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
We have an issue with our RabbitMQ clients not publishing to our RabbitMQ server. We see that the client hangs approx. every 2 hours and never recovers.

Versions:
Client: amqp-client-2.8.7.jar  , spring-amqp-1.1.1.RELEASE.jar
server: noarch/rabbitmq-server-2.8.7-1.noarch.rpm

On the client side we see that our application stops working. When we query the port we see:
[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pkonar at ajtrafp067</A> ~]$ netstat -an | grep 5672
tcp        0 194017 ::ffff:10.196.42.93:47657   ::ffff:10.196.42.43:5672    FIN_WAIT1
tcp        0   2722 ::ffff:10.196.42.93:46361   ::ffff:10.196.42.43:5672    ESTABLISHED

The FIN_WAIT1 is from the application restart and never recovers the port. Meaning never releases the port from FIN_WAIT1. After restarting the application we see a new connection created the works, but we would prefer not restarting the app every 2 hours.

Server side
 [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pkonar at ajtrafp017</A> ~]$ sudo rabbitmqctl list_connections name last_blocked_age last_blocked_by Listing connections ...
10.196.42.90:35923 -&gt; 10.196.42.43:5672 497412.591327   flow
10.196.42.93:46361 -&gt; 10.196.42.43:5672 912.850887      flow
10.196.42.92:45603 -&gt; 10.196.42.43:5672 912.554772      flow
10.196.42.94:46145 -&gt; 10.196.42.43:5672 319388.635685   flow
10.196.42.93:47657 -&gt; 10.196.42.43:5672 83830.533463    flow
10.196.42.94:44100 -&gt; 10.196.42.43:5672 10568.909981    flow
10.196.42.94:33175 -&gt; 10.196.42.43:5672 166511.852811   flow
10.196.42.91:56200 -&gt; 10.196.42.43:5672 912.849807      flow
10.196.42.90:40466 -&gt; 10.196.42.43:5672 126071.593769   flow
10.196.42.90:56644 -&gt; 10.196.42.43:5672 912.628977      flow
...done.


Looking for any help possible.

Thanks
Peter Konar

The information contained in this communication may be CONFIDENTIAL and is intended only for the use of the recipient(s) named above.  If you are not the intended recipient, you are hereby notified that any dissemination, distribution, or copying of this communication, or any of its contents, is strictly prohibited.  If you have received this communication in error, please notify the sender and delete/destroy the original message and any copy of it from your computer or paper files.
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025416.html">[rabbitmq-discuss] The mechanics of message exchange between the broker and consumer
</A></li>
	<LI>Next message: <A HREF="025415.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25412">[ date ]</a>
              <a href="thread.html#25412">[ thread ]</a>
              <a href="subject.html#25412">[ subject ]</a>
              <a href="author.html#25412">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
