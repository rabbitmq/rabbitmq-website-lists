<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ blocking issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20blocking%20issue&In-Reply-To=%3C201563F6B444B14C89BEA66003DD401414392B81AD%40exch-mbx-113.vmware.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025641.html">
   <LINK REL="Next"  HREF="025677.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ blocking issue</H1>
    <B>Daniel Buchko</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20blocking%20issue&In-Reply-To=%3C201563F6B444B14C89BEA66003DD401414392B81AD%40exch-mbx-113.vmware.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ blocking issue">dbuchko at vmware.com
       </A><BR>
    <I>Tue Feb 26 19:12:35 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025641.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
        <LI>Next message: <A HREF="025677.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25676">[ date ]</a>
              <a href="thread.html#25676">[ thread ]</a>
              <a href="subject.html#25676">[ subject ]</a>
              <a href="author.html#25676">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matthias, could you please send Nokia a bug tracking number for reference purposes?

Thanks,
Dan


-----Original Message-----
From: Matthias Radestock [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>] 
Sent: Saturday, February 23, 2013 8:29 AM
To: Konar Peter (Nokia-LC/Chicago)
Cc: Daniel Buchko; Carroll James (Nokia-LC/Malvern); Hancock Craig (Nokia-LC/Chicago); Venus Justin (Nokia-LC/Chicago); Yu Jerry.3 (Nokia-LC/Alpharetta); Lieber Dick (Nokia-LC/Chicago); Johnson Anthony (Nokia-LC/Alpharetta); Mccuiston Mitchell (Nokia-LC/Chicago); <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] RabbitMQ blocking issue

Peter,

On 21/02/13 17:26, Matthias Radestock wrote:
&gt;<i> After staring at the code for a couple of days I have identified and 
</I>&gt;<i> fixed one scenarios in which a connection could end up in the state 
</I>&gt;<i> you are seeing. It happens only after an illegal sequence of 
</I>&gt;<i> channel.close followed by basic.publish on the same channel, and only 
</I>&gt;<i> during a very narrow window in conjunction with flow control. So I 
</I>&gt;<i> doubt this is the cause, but it would still be worth giving that fix a 
</I>&gt;<i> try, just to rule out that scenario. I will send you a patch by private email.
</I>
After staring at the code some more, it turns out that there is a
*legal* sequence of AMQP commands that triggers the bug: a bunch of basic.publish commands followed by a channel.close, followed by a basic.publish on *another* channel.

The precise conditions are very intricate and highly timing sensitive, which explains why we have not seen any prior reports of this even though the bug was introduced nearly a year ago, in 2.8.0.

The patch I sent you fixes the problem and will appear in the next RabbitMQ bugfix release.

Thank you very much for the detailed reports and all the effort you invested in helping us track this down.

Regards,

Matthias.
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025641.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
	<LI>Next message: <A HREF="025677.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25676">[ date ]</a>
              <a href="thread.html#25676">[ thread ]</a>
              <a href="subject.html#25676">[ subject ]</a>
              <a href="author.html#25676">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
