<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Internal Server Error message on RabbitMQ 3.0.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Internal%20Server%20Error%20message%20on%20RabbitMQ%203.0.2&In-Reply-To=%3CCACLE7iw_RMZ7SemkwQCfTQxQ2X6LBsTZWBwKrY6fZWC8T%3DbJPw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025468.html">
   <LINK REL="Next"  HREF="025470.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Internal Server Error message on RabbitMQ 3.0.2</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Internal%20Server%20Error%20message%20on%20RabbitMQ%203.0.2&In-Reply-To=%3CCACLE7iw_RMZ7SemkwQCfTQxQ2X6LBsTZWBwKrY6fZWC8T%3DbJPw%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Internal Server Error message on RabbitMQ 3.0.2">mpietrek at skytap.com
       </A><BR>
    <I>Tue Feb 12 18:48:03 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025468.html">[rabbitmq-discuss] ANN Bunny 0.9.0.pre7 is released
</A></li>
        <LI>Next message: <A HREF="025470.html">[rabbitmq-discuss] Internal Server Error message on RabbitMQ 3.0.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25469">[ date ]</a>
              <a href="thread.html#25469">[ thread ]</a>
              <a href="subject.html#25469">[ subject ]</a>
              <a href="author.html#25469">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm getting error messages like this from the server. Nothing works till I
restart the broker:


Got response code 500 with body
Internal Server ErrorThe server encountered an error while processing this
request:

{error,badarg,
       [{ets,lookup,[rabbit_user,&lt;&lt;&quot;guest&quot;&gt;&gt;],[]},
        {rabbit_misc,dirty_read,1,[]},
        {rabbit_auth_backend_internal,internal_check_user_login,2,[]},
        {rabbit_access_control,'-check_user_login/2-fun-0-',4,[]},
        {lists,foldl,3,[{file,&quot;lists.erl&quot;},{line,1197}]},
        {rabbit_mgmt_util,is_authorized,4,[]},
        {webmachine_resource,resource_call,3,[]},
        {webmachine_resource,do,3,[]}]}



The rabbit@&lt;host&gt;.log file from around the time shows:

=ERROR REPORT==== 12-Feb-2013::10:30:08 ===
Mnesia(<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>): ** ERROR ** (core dumped to file:
&quot;/home/mpietrek/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">MnesiaCore.rabbit at mq1_1360_693808_817246</A>&quot;)
 ** FATAL ** {error,{&quot;Cannot rename disk_log file&quot;,latest_log,
                     &quot;/home/mpietrek/work/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>/PREVIOUS.LOG&quot;,
                     {log_header,trans_log,&quot;4.3&quot;,&quot;4.7&quot;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">,rabbit at mq1</A>,
                                 {1360,693808,799354}},

{file_error,&quot;/home/mpietrek/work/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>/PREVIOUS.LOG&quot;,
                                 enoent}}}

=ERROR REPORT==== 12-Feb-2013::10:30:18 ===
** Generic server mnesia_subscr terminating
** Last message in was {'EXIT',&lt;0.129.0&gt;,killed}
** When Server state == {state,&lt;0.129.0&gt;,131092}
** Reason for termination ==
** killed

=ERROR REPORT==== 12-Feb-2013::10:30:18 ===
** gen_event handler mnesia_event crashed.
** Was installed in mnesia_event
** Last event was: {mnesia_system_event,
                       {mnesia_info,&quot;~p terminated: ~p~n&quot;,
                           [mnesia_recover,killed]}}
** When handler state == {state,[],false,[]}
** Reason == {terminated,
                 [{io,format,
                      [&lt;0.125.0&gt;,&quot;Mnesia(~p): ~p terminated: ~p~n&quot;,
                       [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>,mnesia_recover,killed]],
                      []},
                  {mnesia_event,handle_system_event,2,
                      [{file,&quot;mnesia_event.erl&quot;},{line,160}]},
                  {mnesia_event,handle_call,2,
                      [{file,&quot;mnesia_event.erl&quot;},{line,77}]},
                  {gen_event,server_call_update,3,
                      [{file,&quot;gen_event.erl&quot;},{line,617}]},
                  {gen_event,server_call,4,
                      [{file,&quot;gen_event.erl&quot;},{line,566}]},
                  {gen_event,handle_msg,5,[{file,&quot;gen_event.erl&quot;},{line,258}]},
                  {proc_lib,init_p_do_apply,3,
                      [{file,&quot;proc_lib.erl&quot;},{line,227}]}]}

=ERROR REPORT==== 12-Feb-2013::10:30:18 ===
** gen_event handler rabbit_error_logger crashed.
** Was installed in error_logger
** Last event was: {error,&lt;0.125.0&gt;,
                       {&lt;0.12681.17&gt;,
                        &quot;** gen_event handler ~p crashed.~n** Was
installed in ~p~n** Last event was: ~p~n** When handler state ==
~p~n** Reason == ~p~n&quot;,
                        [mnesia_event,mnesia_event,
                         {mnesia_system_event,
                             {mnesia_info,&quot;~p terminated: ~p~n&quot;,
                                 [mnesia_recover,killed]}},
                         {state,[],false,[]},
                         {terminated,
                             [{io,format,
                                  [&lt;0.125.0&gt;,
                                   &quot;Mnesia(~p): ~p terminated: ~p~n&quot;,
                                   [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>,mnesia_recover,killed]],
                                  []},
                              {mnesia_event,handle_system_event,2,
                                  [{file,&quot;mnesia_event.erl&quot;},{line,160}]},
                              {mnesia_event,handle_call,2,
                                  [{file,&quot;mnesia_event.erl&quot;},{line,77}]},
                              {gen_event,server_call_update,3,
                                  [{file,&quot;gen_event.erl&quot;},{line,617}]},
                              {gen_event,server_call,4,
                                  [{file,&quot;gen_event.erl&quot;},{line,566}]},
                              {gen_event,handle_msg,5,
                                  [{file,&quot;gen_event.erl&quot;},{line,258}]},
                              {proc_lib,init_p_do_apply,3,
                                  [{file,&quot;proc_lib.erl&quot;},{line,227}]}]}]}}
** When handler state == {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;amq.rabbitmq.log&quot;&gt;&gt;}
** Reason == {badarg,[{ets,lookup,
                           [rabbit_exchange,
                            {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,
                                      &lt;&lt;&quot;amq.rabbitmq.log&quot;&gt;&gt;}],
                           []},
                      {rabbit_misc,dirty_read,1,[]},
                      {rabbit_basic,publish,1,[]},
                      {rabbit_error_logger,publish1,4,[]},
                      {rabbit_error_logger,handle_event,2,[]},
                      {gen_event,server_update,4,
                                 [{file,&quot;gen_event.erl&quot;},{line,504}]},
                      {gen_event,server_notify,4,
                                 [{file,&quot;gen_event.erl&quot;},{line,486}]},
                      {gen_event,handle_msg,5,
                                 [{file,&quot;gen_event.erl&quot;},{line,248}]}]}

=INFO REPORT==== 12-Feb-2013::10:30:18 ===
    application: mnesia
    exited: shutdown
    type: temporary


=ERROR REPORT==== 12-Feb-2013::10:30:18 ===
** Generic server &lt;0.12822.13&gt; terminating
** Last message in was {'$gen_cast',
                           {method,
                               {'basic.get',0,&lt;&lt;&quot;charon&quot;&gt;&gt;,false},
                               none,noflow}}
** When Server state == {ch,running,rabbit_framing_amqp_0_9_1,1,&lt;0.12816.13&gt;,
                            &lt;0.12820.13&gt;,&lt;0.12816.13&gt;,
                            &lt;&lt;&quot;192.168.78.21:38843 -&gt; 192.168.78.16:5672&quot;&gt;&gt;,
                            {token,&lt;0.12821.13&gt;,false},
                            in_progress,1,
                            {[],[]},
                            {[],[]},
                            [],[],
                            {user,&lt;&lt;&quot;guest&quot;&gt;&gt;,
                                [administrator],
                                rabbit_auth_backend_internal,
                                {internal_user,&lt;&lt;&quot;guest&quot;&gt;&gt;,
                                    &lt;&lt;93,38,120,113,16,14,172,225,248,216,74,
                                      218,230,161,150,138,14,49,216,172&gt;&gt;,
                                    [administrator]}},
                            &lt;&lt;&quot;/&quot;&gt;&gt;,&lt;&lt;&gt;&gt;,
                            {dict,0,16,16,8,80,48,
                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            {dict,0,16,16,8,80,48,
                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            {set,0,16,16,8,80,48,
                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            {dict,0,16,16,8,80,48,
                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            {set,0,16,16,8,80,48,
                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            &lt;0.12814.13&gt;,
                            {state,fine,5000,#Ref&lt;0.0.46.55948&gt;},
                            false,1,
                            {{0,nil},{0,nil}},
                            [],
                            [{&lt;&lt;&quot;consumer_cancel_notify&quot;&gt;&gt;,bool,true},
                             {&lt;&lt;&quot;publisher_confirms&quot;&gt;&gt;,bool,true},
                             {&lt;&lt;&quot;basic.nack&quot;&gt;&gt;,bool,true}],
                            none}
** Reason for termination ==
** {badarg,[{ets,lookup,
                 [rabbit_queue,{resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;charon&quot;&gt;&gt;}],
                 []},
            {rabbit_misc,dirty_read,1,[]},
            {rabbit_amqqueue,with,3,[]},
            {rabbit_channel,handle_method,3,[]},
            {rabbit_channel,handle_cast,2,[]},
            {gen_server2,handle_msg,2,[]},
            {proc_lib,init_p_do_apply,3,[{file,&quot;proc_lib.erl&quot;},{line,227}]}]}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130212/564742e4/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130212/564742e4/attachment.htm</A>&gt;
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025468.html">[rabbitmq-discuss] ANN Bunny 0.9.0.pre7 is released
</A></li>
	<LI>Next message: <A HREF="025470.html">[rabbitmq-discuss] Internal Server Error message on RabbitMQ 3.0.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25469">[ date ]</a>
              <a href="thread.html#25469">[ thread ]</a>
              <a href="subject.html#25469">[ subject ]</a>
              <a href="author.html#25469">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
