<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ blocking issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20blocking%20issue&In-Reply-To=%3C511A9EFA.9010909%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025466.html">
   <LINK REL="Next"  HREF="025473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ blocking issue</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20blocking%20issue&In-Reply-To=%3C511A9EFA.9010909%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ blocking issue">matthias at rabbitmq.com
       </A><BR>
    <I>Tue Feb 12 19:58:50 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025466.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
        <LI>Next message: <A HREF="025473.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25472">[ date ]</a>
              <a href="thread.html#25472">[ thread ]</a>
              <a href="subject.html#25472">[ subject ]</a>
              <a href="author.html#25472">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Peter,

On 12/02/13 13:27, Konar Peter (Nokia-LC/Chicago) wrote:
&gt;<i> Connections:
</I>&gt;<i> pid     name    port    peer_port       host    peer_host       ssl     peer_cert_subject       peer_cert_issuer        peer_cert_validity      auth_mechanism  ssl_protocol    ssl_key_exchange        ssl_cipher      ssl_hash        protocol        user    vhost     timeout frame_max       client_properties       recv_oct        recv_cnt        send_oct        send_cnt        send_pend       state   last_blocked_by last_blocked_age        channels
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp063.3.3992.0</A>&gt;    10.196.42.119:48485 -&gt; 10.196.42.21:5672        5672    48485   10.196.42.21    10.196.42.119   false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2012 VMware, Inc.&quot;},{&quot;version&quot;,&quot;2.8.4&quot;}] 149398118       6460971 2122464675      7082940 0       running none    infinity        1
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp063.3.4254.0</A>&gt;    10.196.42.120:59485 -&gt; 10.196.42.21:5672        5672    59485   10.196.42.21    10.196.42.120   false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2012 VMware, Inc.&quot;},{&quot;version&quot;,&quot;2.8.4&quot;}] 109362206       4866571 3624114636      5187935 0       running none    infinity        1
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp063.3.20125.0</A>&gt;   147.243.130.14:34613 -&gt; 10.196.42.21:5672       5672    34613   10.196.42.21    147.243.130.14  false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2012 VMware, Inc.&quot;},{&quot;version&quot;,&quot;2.8.4&quot;}] 2254516 41540   96969022        93165   0       running none    infinity        1
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp064.1.14970.129</A>&gt; 10.196.42.182:50012 -&gt; 10.196.42.22:5672        5672    50012   10.196.42.22    10.196.42.182   false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2013 VMware, Inc.&quot;},{&quot;version&quot;,&quot;3.0.2&quot;}] 892971313       13406695        65127580        4651947 0       running flow    708.153401      2
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp064.1.13886.130</A>&gt; 10.196.42.180:57261 -&gt; 10.196.42.22:5672        5672    57261   10.196.42.22    10.196.42.180   false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2013 VMware, Inc.&quot;},{&quot;version&quot;,&quot;3.0.2&quot;}] 991521388       13254940        64474148        4605273 0       running flow    1012.465014     1
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp064.1.5604.131</A>&gt;  10.196.42.128:38983 -&gt; 10.196.42.22:5672        5672    38983   10.196.42.22    10.196.42.128   false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2013 VMware, Inc.&quot;},{&quot;version&quot;,&quot;3.0.2&quot;}] 1260443690      13146545        63815924        4558257 0       running flow    713.080137      1
</I>&gt;<i> &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at ajtrafp064.1.31824.131</A>&gt; 10.196.42.179:41165 -&gt; 10.196.42.22:5672        5672    41165   10.196.42.22    10.196.42.179   false                           PLAIN                                   {0,9,1} guest   /       600     131072  [{&quot;product&quot;,&quot;RabbitMQ&quot;},{&quot;information&quot;,&quot;Licensed under the MPL. See <A HREF="http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright">http://www.rabbitmq.com/&quot;},{&quot;platform&quot;,&quot;Java&quot;},{&quot;capabilities&quot;,[{&quot;exchange_exchange_bindings&quot;,true},{&quot;consumer_cancel_notify&quot;,true},{&quot;basic.nack&quot;,true},{&quot;publisher_confirms&quot;,true}]},{&quot;copyright&quot;,&quot;Copyright</A> (C) 2007-2013 VMware, Inc.&quot;},{&quot;version&quot;,&quot;3.0.2&quot;}] 1207139221      13617335        66191024        4727907 0       running flow    1314.712837     1
</I>
So there are 7 connections here, all of them in the 'running' state, 
which means they should be reading data...

&gt;<i> RabbitMQ Netstat
</I>&gt;<i> Proto Recv-Q Send-Q Local Address               Foreign Address             State
</I>&gt;<i> tcp        0      0 :::5672                     :::*                        LISTEN
</I>&gt;<i> tcp        0      0 ::ffff:10.196.42.21:5672    ::ffff:10.196.42.119:48485  ESTABLISHED
</I>&gt;<i> tcp        0      0 ::ffff:10.196.42.21:5672    ::ffff:10.196.42.120:59485  ESTABLISHED
</I>&gt;<i> tcp        0      0 ::ffff:10.196.42.21:5672    ::ffff:147.243.130.14:34613 ESTABLISHED
</I>
But why does this only show three connections? Is that really the 
complete list?

Note that all the above connections show a Recv-Q of 0, indicating that 
rabbit has read all the data from the socket. Contrary to what James 
suggested. Though...

&gt;<i> TSA Client Netstat
</I>&gt;<i> Proto Recv-Q Send-Q Local Address               Foreign Address             State
</I>&gt;<i> tcp        0 246112 ::ffff:10.196.42.182:50012  ::ffff:10.196.42.22:5672    ESTABLISHED
</I>
...this client-side blocked connection (as evidenced by the non-zero 
Send-Q) doesn't show up in the server netstat report. Which can't be 
right since that connection *does* show up in the rabbit report (4th row).

So I think something went wrong with the server-side netstat report.

Matthias
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025466.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
	<LI>Next message: <A HREF="025473.html">[rabbitmq-discuss] RabbitMQ blocking issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25472">[ date ]</a>
              <a href="thread.html#25472">[ thread ]</a>
              <a href="subject.html#25472">[ subject ]</a>
              <a href="author.html#25472">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
