<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Help getting 2.8.7 to run after removing 3.0.2	(maybe_upgrade_mnesia???)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Help%20getting%202.8.7%20to%20run%20after%20removing%203.0.2%0A%09%28maybe_upgrade_mnesia%3F%3F%3F%29&In-Reply-To=%3CCACLE7iwN7RtffL-_BcSoN-BF%3DmQKyHjHFZB1j-Bh5K3fTDWWCQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025389.html">
   <LINK REL="Next"  HREF="025385.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Help getting 2.8.7 to run after removing 3.0.2	(maybe_upgrade_mnesia???)</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Help%20getting%202.8.7%20to%20run%20after%20removing%203.0.2%0A%09%28maybe_upgrade_mnesia%3F%3F%3F%29&In-Reply-To=%3CCACLE7iwN7RtffL-_BcSoN-BF%3DmQKyHjHFZB1j-Bh5K3fTDWWCQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Help getting 2.8.7 to run after removing 3.0.2	(maybe_upgrade_mnesia???)">mpietrek at skytap.com
       </A><BR>
    <I>Wed Feb  6 19:49:15 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="025389.html">[rabbitmq-discuss] RabbitMQ cluster doesn't restart as it should
</A></li>
        <LI>Next message: <A HREF="025385.html">[rabbitmq-discuss] Help getting 2.8.7 to run after removing 3.0.2 (maybe_upgrade_mnesia???)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25377">[ date ]</a>
              <a href="thread.html#25377">[ thread ]</a>
              <a href="subject.html#25377">[ subject ]</a>
              <a href="author.html#25377">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So, I was recently experimenting with 3.0.2 and needing to go back to 2.8.7
for some additional experimentation.

However, RabbitMQ 2.8.7 won't start for me any more. I'm using Erlang R15B01

Here's the console spew for the mq1 node, which I'm unable to start:

--------
Activating RabbitMQ plugins ...
8 plugins activated:
* amqp_client-0.0.0
* mochiweb-2.3.1-rmq0.0.0-gitd541e9a
* rabbitmq_federation-0.0.0
* rabbitmq_federation_management-0.0.0
* rabbitmq_management-0.0.0
* rabbitmq_management_agent-0.0.0
* rabbitmq_mochiweb-0.0.0
* webmachine-1.9.1-rmq0.0.0-git52e62bc

{&quot;init terminating in do_boot&quot;,{function_clause,[{lists,usort,[['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>
'|{['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at play</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at play2</A>
'],disc}]],[{file,&quot;lists.erl&quot;},{line,992}]},{rabbit_upgrade,maybe_upgrade_mnesia,0,[{file,&quot;src/rabbit_upgrade.erl&quot;},{line,126}]},{rabbit,prepare,0,[{file,&quot;src/rabbit.erl&quot;},{line,288}]},{init,eval_script,8,[]},{init,do_boot,3,[]}]}}

Crash dump was written to: erl_crash.dump
init terminating in do_boot ()
--------

I've blown away both the <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A> and
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1-plugins-expanddirectories</A> multiple times.
In the past, blowing away these directories has always worked to get me to
a &quot;fresh state&quot; where Rabbit would always start. Is there some additional
places that are referenced?

Here's the rabbitmq.config file for mq1:

--------
[
{rabbit, [{cluster_nodes, {['<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at play</A>','<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at play2</A>'],
disc}}, {disk_free_limit, 104857600}]},
{mnesia, [{debug, trace}]},
{rabbitmq_federation, [{exchanges, [[{type, &quot;topic&quot;}, {upstream_set,
&quot;skytap_upstreams&quot;}, {virtual_host, &quot;/&quot;}, {exchange, &quot;skytap&quot;}]]},
{upstream_sets, [{&quot;skytap_upstreams&quot;, [[{connection, &quot;upstream-us-west&quot;},
{max_hops, 1}, {exchange, &quot;skytap&quot;}],[{connection, &quot;upstream-us-east&quot;},
{max_hops, 1}, {exchange, &quot;skytap&quot;}]]}]},
{connections, [{&quot;upstream-us-west&quot;, [{username, &quot;guest&quot;}, {ha_policy,
&quot;all&quot;}, {host, &quot;mq2&quot;}, {heartbeat, 5}, {password, &quot;guest&quot;}, {port, 5672}]},
{&quot;upstream-us-east&quot;, [{username, &quot;guest&quot;}, {ha_policy, &quot;all&quot;}, {host,
&quot;mq3&quot;}, {heartbeat, 5}, {password, &quot;guest&quot;}, {port, 5672}]}]},
{local_nodename, &quot;mq_mpietrek&quot;}]}
].
--------

Just for laughs I've taken out the play and play2 nodes from the config
file and I get the same problem, so I don't think it's clustering related.

Thanks,

Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130206/783047e2/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130206/783047e2/attachment.htm</A>&gt;
</PRE>
























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025389.html">[rabbitmq-discuss] RabbitMQ cluster doesn't restart as it should
</A></li>
	<LI>Next message: <A HREF="025385.html">[rabbitmq-discuss] Help getting 2.8.7 to run after removing 3.0.2 (maybe_upgrade_mnesia???)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25377">[ date ]</a>
              <a href="thread.html#25377">[ thread ]</a>
              <a href="subject.html#25377">[ subject ]</a>
              <a href="author.html#25377">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
