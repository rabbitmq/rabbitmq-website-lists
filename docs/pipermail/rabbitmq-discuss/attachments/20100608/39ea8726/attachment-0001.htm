<tt>
Hi.&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;a&nbsp;having&nbsp;issues&nbsp;with&nbsp;a&nbsp;huge&nbsp;memory&nbsp;consumption&nbsp;with&nbsp;rabbit.&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;uting&nbsp;rabbit&nbsp;1.7.2&nbsp;with&nbsp;Debian&nbsp;Linux&lt;br&gt;&lt;br&gt;&lt;br&gt;-----&nbsp;/etc/rabbitmq/rabbitmq.config&nbsp;----&lt;br&gt;[{rabbit,&nbsp;[{vm_memory_high_watermark,&nbsp;0.2}]}].&lt;br&gt;<br>
<br>
------------------------------------------------------&lt;br&gt;&lt;br&gt;I&nbsp;hit&nbsp;the&nbsp;maximum:&lt;br&gt;------&nbsp;tail&nbsp;-f&nbsp;/var/log/rabbitmq/rabbit.log&nbsp;|&nbsp;grep&nbsp;-i&nbsp;memory&nbsp;------&lt;br&gt;vm_memory_high_watermark&nbsp;set.&nbsp;Memory&nbsp;used:434801384&nbsp;allowed:429496729&lt;br&gt;<br>
<br>
   &nbsp;alarm_handler:&nbsp;{set,{vm_memory_high_watermark,[]}}&lt;br&gt;------------------------------------------------------&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;I&amp;#39;m &nbsp;sopposed &nbsp;to&nbsp;use&nbsp;channel.flow&nbsp;to&nbsp;stop&nbsp;the&nbsp;producer.&nbsp;My&nbsp;python&nbsp;code&nbsp;is:&lt;br&gt;&lt;br&gt;-------------------------------------------&lt;br&gt;       &nbsp;while&nbsp;not&nbsp;self.chan.flow(True):&lt;br&gt;           &nbsp;sys.stdout.write(&amp;quot;W&amp;quot;)&lt;br&gt;<br>
<br>
           &nbsp;sys.stdout.flush()&lt;br&gt;           &nbsp;time.sleep(1)&lt;br&gt;&lt;br&gt;       &nbsp;self.chan.basic_publish(msg,&lt;br&gt;                               &nbsp;exchange=self.config_amqp[&amp;quot;exchange&amp;quot;],&lt;br&gt;                               &nbsp;routing_key=self.config_amqp[&amp;#39;routing_key&amp;#39;])&lt;br&gt;<br>
<br>
-------------------------------------------&lt;br&gt;<br>
&lt;br&gt;What&nbsp;i&amp;#39;m&nbsp;doing&nbsp;wrong?&lt;br&gt;&lt;br&gt;BTW,&nbsp;Im&nbsp;using&nbsp;delivery_mode=2&nbsp;and&nbsp;a&nbsp;durable&nbsp;exchange&nbsp;and&nbsp;queue&lt;br&gt;&lt;br&gt;PS:&nbsp;thanks&nbsp;&lt;span&nbsp;class=&quot;irc-black&quot;&gt;tonyg&nbsp;for&nbsp;your&nbsp;irclog: &lt;/span&gt;&nbsp;&lt;a&nbsp;href=&quot;http://dev.rabbitmq.com/irclog/index.php?date=2010-05-13&quot;&gt;http://dev.rabbitmq.com/irclog/index.php?date=2010-05-13&lt;/a&gt;&nbsp;&lt;br&gt;<br>
<br>
&lt;br&nbsp;clear=&quot;all&quot;&gt;Nico&nbsp;César&lt;br&gt;<br>

</tt>
