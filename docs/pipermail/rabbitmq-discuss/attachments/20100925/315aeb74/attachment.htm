<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Sep&nbsp;25,&nbsp;2010,&nbsp;at&nbsp;6:07&nbsp;AM,&nbsp;Ralf&nbsp;Kistner&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;2&nbsp;a.&nbsp;Are&nbsp;there&nbsp;any&nbsp;recommended&nbsp;practices&nbsp;for&nbsp;running&nbsp;a&nbsp;(Ruby)&nbsp;process&lt;br&gt;to&nbsp;consume&nbsp;messages&nbsp;in&nbsp;an&nbsp;infinite&nbsp;loop?&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Check&nbsp;out&nbsp;the&nbsp;AMQP&nbsp;stuff&nbsp;in&nbsp;Ruby.&nbsp;It&nbsp;uses&nbsp;EventMachine.&nbsp;EM&nbsp;will&nbsp;run&nbsp;until&nbsp;you&nbsp;tell&nbsp;it&nbsp;to&nbsp;stop,&nbsp;which&nbsp;is&nbsp;what&nbsp;you're&nbsp;looking&nbsp;for.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;2&nbsp;b.&nbsp;The&nbsp;Ruby&nbsp;script&nbsp;would&nbsp;occasionally&nbsp;be&nbsp;unable&nbsp;to&nbsp;process&nbsp;a&lt;br&gt;message.&nbsp;This&nbsp;could&nbsp;be&nbsp;because&nbsp;of&nbsp;a&nbsp;temporary&nbsp;lock&nbsp;on&nbsp;the&nbsp;database,&nbsp;an&lt;br&gt;invalid&nbsp;message&nbsp;from&nbsp;the&nbsp;mobile&nbsp;client,&nbsp;or&nbsp;a&nbsp;bug&nbsp;on&nbsp;the&nbsp;server.&nbsp;The&lt;br&gt;ideal&nbsp;would&nbsp;be&nbsp;for&nbsp;these&nbsp;messages&nbsp;to&nbsp;be&nbsp;retried&nbsp;a&nbsp;few&nbsp;times,&nbsp;then&lt;br&gt;moved&nbsp;to&nbsp;a&nbsp;different&nbsp;queue&nbsp;if&nbsp;it&nbsp;still&nbsp;fails.&nbsp;The&nbsp;messages&nbsp;in&nbsp;the&lt;br&gt;queue&nbsp;could&nbsp;then&nbsp;be&nbsp;inspected&nbsp;manually,&nbsp;and&nbsp;moved&nbsp;back&nbsp;to&nbsp;the&nbsp;original&lt;br&gt;queue&nbsp;when&nbsp;the&nbsp;bug&nbsp;was&nbsp;fixed.&lt;br&gt;How&nbsp;would&nbsp;this&nbsp;be&nbsp;accomplished?&nbsp;Does&nbsp;RabbitMQ&nbsp;have&nbsp;something&nbsp;like&nbsp;a&lt;br&gt;dead&nbsp;letter&nbsp;queue?&nbsp;Or&nbsp;would&nbsp;I&nbsp;have&nbsp;to&nbsp;move&nbsp;the&nbsp;message&nbsp;to&nbsp;a&nbsp;different&lt;br&gt;queue&nbsp;myself&nbsp;(in&nbsp;the&nbsp;Ruby&nbsp;script),&nbsp;in&nbsp;case&nbsp;of&nbsp;an&nbsp;error?&lt;br&gt;Note&nbsp;that&nbsp;I&nbsp;can't&nbsp;return&nbsp;any&nbsp;messages&nbsp;to&nbsp;the&nbsp;sender,&nbsp;I&nbsp;want&nbsp;to&nbsp;keep&nbsp;it&lt;br&gt;on&nbsp;the&nbsp;server&nbsp;in&nbsp;a&nbsp;different&nbsp;queue.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Redelivery&nbsp;is&nbsp;something&nbsp;I'm&nbsp;working&nbsp;on&nbsp;in&nbsp;my&nbsp;own&nbsp;application.&nbsp;I&nbsp;use&nbsp;it&nbsp;to&nbsp;update&nbsp;databases&nbsp;at&nbsp;remote&nbsp;locations&nbsp;that&nbsp;might&nbsp;or&nbsp;might&nbsp;not&nbsp;be&nbsp;online.&nbsp;If&nbsp;I&nbsp;get&nbsp;a&nbsp;timeout&nbsp;error,&nbsp;I&nbsp;write&nbsp;my&nbsp;message&nbsp;into&nbsp;a&nbsp;Riak&nbsp;bucket.&nbsp;There&nbsp;is&nbsp;a&nbsp;Quartz-based&nbsp;job&nbsp;that&nbsp;runs&nbsp;every&nbsp;five&nbsp;minutes&nbsp;that&nbsp;checks&nbsp;this&nbsp;retry&nbsp;bucket&nbsp;and&nbsp;simply&nbsp;deletes&nbsp;the&nbsp;messages&nbsp;and&nbsp;dumps&nbsp;them&nbsp;back&nbsp;into&nbsp;the&nbsp;broker.&nbsp;I&nbsp;haven't&nbsp;put&nbsp;it&nbsp;in&nbsp;yet,&nbsp;but&nbsp;I'm&nbsp;planning&nbsp;on&nbsp;implementing&nbsp;a&nbsp;&quot;maxRetries&quot;&nbsp;so&nbsp;that&nbsp;when&nbsp;a&nbsp;message&nbsp;exceeds&nbsp;the&nbsp;retry&nbsp;number,&nbsp;it&nbsp;will&nbsp;be&nbsp;either&nbsp;sent&nbsp;to&nbsp;a&nbsp;notification&nbsp;queue&nbsp;where&nbsp;it&nbsp;gets&nbsp;emailed,&nbsp;or&nbsp;moved&nbsp;to&nbsp;another&nbsp;Riak&nbsp;bucket&nbsp;where&nbsp;I&nbsp;can&nbsp;write&nbsp;an&nbsp;RSS&nbsp;feed&nbsp;over&nbsp;the&nbsp;top&nbsp;of&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;3.&nbsp;What&nbsp;is&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;create&nbsp;a&nbsp;backup&nbsp;of&nbsp;all&nbsp;the&nbsp;message&nbsp;sent&nbsp;to&lt;br&gt;the&nbsp;server?&nbsp;Does&nbsp;RabbitMQ&nbsp;automatically&nbsp;do&nbsp;this,&nbsp;or&nbsp;should&nbsp;I&nbsp;write&nbsp;an&lt;br&gt;additional&nbsp;consumer&nbsp;to&nbsp;create&nbsp;a&nbsp;backup?&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;A&nbsp;NoSQL&nbsp;store&nbsp;where&nbsp;you&nbsp;keep&nbsp;the&nbsp;entire&nbsp;message&nbsp;in&nbsp;JSON&nbsp;format&nbsp;seems&nbsp;to&nbsp;me&nbsp;the&nbsp;safest&nbsp;and&nbsp;most&nbsp;performant&nbsp;way&nbsp;to&nbsp;persist&nbsp;messages&nbsp;with&nbsp;enough&nbsp;information&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;resubmit&nbsp;the&nbsp;message&nbsp;at&nbsp;a&nbsp;later&nbsp;time.&nbsp;I&nbsp;have&nbsp;security&nbsp;tokens&nbsp;in&nbsp;the&nbsp;headers&nbsp;(I&nbsp;don't&nbsp;use&nbsp;logins&nbsp;but&nbsp;tokens)&nbsp;and&nbsp;of&nbsp;course&nbsp;I&nbsp;have&nbsp;to&nbsp;capture&nbsp;the&nbsp;exchange&nbsp;and&nbsp;routing&nbsp;key&nbsp;information.&nbsp;I&nbsp;use&nbsp;JSON&nbsp;data&nbsp;for&nbsp;my&nbsp;messages,&nbsp;so&nbsp;this&nbsp;fits&nbsp;nicely&nbsp;together&nbsp;but&nbsp;you&nbsp;could&nbsp;also&nbsp;base64&nbsp;encode&nbsp;your&nbsp;data.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;could&nbsp;use&nbsp;an&nbsp;additional&nbsp;consumer&nbsp;(e.g.&nbsp;on&nbsp;routing&nbsp;key&nbsp;&quot;#&quot;)&nbsp;but&nbsp;I&nbsp;let&nbsp;the&nbsp;consumer&nbsp;decide&nbsp;whether&nbsp;to&nbsp;persist&nbsp;a&nbsp;message&nbsp;to&nbsp;Riak&nbsp;or&nbsp;not.&lt;br&gt;&lt;div&gt;<br>
&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Palatino;&nbsp;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-align:&nbsp;auto;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Times;&nbsp;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;0px;&nbsp;-webkit-border-vertical-spacing:&nbsp;0px;&nbsp;-webkit-text-decorations-in-effect:&nbsp;none;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;Thanks!&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;J.&nbsp;Brisbin&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;a&nbsp;href=&quot;http://jbrisbin.com/&quot;&gt;http://jbrisbin.com/&lt;/a&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Palatino&quot;&nbsp;size=&quot;4&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/span&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;/span&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;/span&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
