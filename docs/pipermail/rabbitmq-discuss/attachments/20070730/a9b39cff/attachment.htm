<tt>
Hello&nbsp;-&nbsp;&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;in&nbsp;the&nbsp;early&nbsp;days&nbsp;of&nbsp;testing&nbsp;RabbitMQ&nbsp;and&nbsp;have&nbsp;been<br>
experiencing&nbsp;the&nbsp;symptoms&nbsp;described&nbsp;below&nbsp;when&nbsp;letting&nbsp;my&nbsp;sample<br>
applications&nbsp;run&nbsp;uninterrupted&nbsp;for&nbsp;500,000&nbsp;-&nbsp;1,000,000&nbsp;messages&nbsp;or&nbsp;so.<br>
Unfortunately&nbsp;the&nbsp;errors&nbsp;appear&nbsp;inconsistently&nbsp;(ie&nbsp;after&nbsp;different<br>
numbers&nbsp;of&nbsp;consumed&nbsp;messages)&nbsp;and&nbsp;do&nbsp;not&nbsp;always&nbsp;appear&nbsp;on&nbsp;every&nbsp;run.<br>
I&amp;#39;ve&nbsp;included&nbsp;the&nbsp;output&nbsp;from&nbsp;my&nbsp;client&nbsp;application&nbsp;(very&nbsp;similar&nbsp;to<br>
the&nbsp;ConsumerMain&nbsp;class&nbsp;included&nbsp;in&nbsp;the&nbsp;examples&nbsp;-&nbsp;I&amp;#39;ve&nbsp;also&nbsp;had&nbsp;the<br>
&amp;#39;read&nbsp;timed&nbsp;out&amp;#39;&nbsp;exception&nbsp;raised&nbsp;when&nbsp;running&nbsp;that&nbsp;class&nbsp;&amp;#39;as&nbsp;is&amp;#39;)&nbsp;as<br>
well&nbsp;as&nbsp;the&nbsp;log&nbsp;contents&nbsp;entries&nbsp;from&nbsp;rabbit&nbsp;at&nbsp;the&nbsp;point&nbsp;of&nbsp;the<br>
exception.&nbsp;&amp;nbsp;<br>
&lt;br&gt;&lt;br&gt;Out&nbsp;testing&nbsp;environment&nbsp;is&nbsp;described&nbsp;below.&lt;br&gt;&lt;br&gt;2x&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;4&nbsp;core&nbsp;AMD&nbsp;Opteron&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;8G&nbsp;memory&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;eth0&nbsp;interface&nbsp;with&nbsp;MTU&nbsp;set&nbsp;to&nbsp;9000&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;*&nbsp;Centos&nbsp;OS&nbsp;-&nbsp;kernel&nbsp;version&nbsp;2.6.18&nbsp;&lt;br&gt;&lt;br&gt;One<br>
of&nbsp;these&nbsp;machines&nbsp;is&nbsp;the&nbsp;RabbitMQ&nbsp;server&nbsp;and&nbsp;hosts&nbsp;the&nbsp;consumer<br>
application,&nbsp;the&nbsp;other&nbsp;hosts&nbsp;only&nbsp;the&nbsp;producer&nbsp;application.&nbsp;The&nbsp;rabbit<br>
connection&nbsp;and&nbsp;channel&nbsp;are&nbsp;configured&nbsp;as&nbsp;follows.<br>
&lt;br&gt;&lt;br&gt;Multiple&nbsp;threads&nbsp;are&nbsp;generating&nbsp;messages&nbsp;from&nbsp;the&nbsp;producer&nbsp;application&lt;br&gt;Version&nbsp;=&nbsp;1.0.0&nbsp;alpha&lt;br&gt;Ack&nbsp;sent&nbsp;=&nbsp;yes,&nbsp;every&nbsp;50&nbsp;messages&lt;br&gt;framesize&nbsp;=&nbsp;9000&nbsp;(our&nbsp;message&nbsp;size&nbsp;is&nbsp;200&nbsp;objects&nbsp;*&nbsp;40&nbsp;bytes&nbsp;+&nbsp;12&nbsp;byte&nbsp;header&nbsp;=&nbsp;8012&nbsp;bytes)<br>
&lt;br&gt;queue&nbsp;type&nbsp;=&nbsp;direct<br>
&lt;br&gt;persistent&nbsp;=&nbsp;true&nbsp;(using&nbsp;ChannelN.MINIMAL_PERSISTENT_BASIC_PROPERTIES)&lt;br&gt;&lt;div&nbsp;id=&quot;mb_0&quot;&gt;transactional&nbsp;=&nbsp;false&lt;br&gt;&lt;br&gt;This<br>
is&nbsp;designed&nbsp;as&nbsp;a&nbsp;performance&nbsp;test&nbsp;and&nbsp;so&nbsp;is&nbsp;hammering&nbsp;as&nbsp;much&nbsp;load<br>
through&nbsp;the&nbsp;applications&nbsp;as&nbsp;possible.&nbsp;I&nbsp;appreciate&nbsp;that&nbsp;it&nbsp;may&nbsp;be<br>
difficult&nbsp;to&nbsp;diagnose&nbsp;the&nbsp;issue&nbsp;from&nbsp;this&nbsp;description&nbsp;but&nbsp;I&nbsp;would&nbsp;like<br>
to&nbsp;know&nbsp;if&nbsp;this&nbsp;is&nbsp;something&nbsp;that&nbsp;has&nbsp;been&nbsp;seen&nbsp;before&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;a<br>
way&nbsp;I&nbsp;can&nbsp;modify&nbsp;the&nbsp;level&nbsp;of&nbsp;logging&nbsp;to&nbsp;get&nbsp;more&nbsp;information&nbsp;about&nbsp;the<br>
problems&nbsp;from&nbsp;RabbitMQ&nbsp;itself.<br>
&lt;br&gt;&lt;br&gt;Thanks&nbsp;&amp;amp;&nbsp;regards&lt;br&gt;&lt;br&gt;James&nbsp;Wolstenholme&lt;br&gt;Software&nbsp;Engineer&lt;br&gt;&lt;br&gt;&lt;br&gt;==============&lt;br&gt;Connection&nbsp;reset&lt;br&gt;==============&lt;br&gt;&lt;br&gt;RabbitMQ&nbsp;log&lt;br&gt;&lt;br&gt;=INFO&nbsp;REPORT====&nbsp;30-Jul-2007::14:52:05&nbsp;===&lt;br&gt;Rolling&nbsp;persister&nbsp;log&nbsp;to&nbsp;&amp;quot;/usr/local/lib/erlang/lib<br>
/rabbitmq-<br>
server-1.0.0-alpha/mnesia/rabbit/rabbit_persister.LOG.previous&amp;quot;&lt;br&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;30-Jul-2007::14:52:42&nbsp;===&lt;br&gt;Reader&nbsp;timeout&nbsp;(3&nbsp;s)&nbsp;in&nbsp;state&nbsp;frame_header&lt;br&gt;&lt;br&gt;=INFO&nbsp;REPORT====&nbsp;30-Jul-2007::14:53:03&nbsp;===&lt;br&gt;&amp;lt;<br>
0.166.0&amp;gt;:&nbsp;Clean&nbsp;connection&nbsp;shutdown.&lt;br&gt;&lt;br&gt;&lt;br&gt;Consumer&nbsp;application&nbsp;stdout&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;117544&nbsp;ms:&nbsp;Received&nbsp;210538&nbsp;-&nbsp;285&nbsp;since&nbsp;last&nbsp;report&nbsp;(80&nbsp;Hz)&nbsp;-&nbsp;objects&nbsp;:&amp;nbsp;&nbsp;42107600&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;AMQConnection.mainLoop:&nbsp;exception&nbsp;<br>
java.net.SocketException:&nbsp;Connection&nbsp;reset&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;java.net.SocketException:&nbsp;Connection&nbsp;reset&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.net.SocketInputStream.read(SocketInputStream.java:168)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.net.SocketInputStream.read<br>
<br>
(SocketInputStream.java:182)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;Shutdown&nbsp;signal&nbsp;terminating&nbsp;consumer.&nbsp;com.rabbitmq.client.ShutdownSignal&nbsp;(hard&nbsp;error;&nbsp;reason:&nbsp;java.net.SocketException:&nbsp;Connection&nbsp;reset)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.io.DataInputStream.readUnsignedByte<br>
<br>
(DataInputStream.java:271)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.Frame.readFrom(Frame.java:84)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.AMQConnection.readFrame(AMQConnection.java:212)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.AMQConnection.mainLoop<br>
<br>
(AMQConnection.java:239)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.AMQConnection$1.run(AMQConnection.java:131)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.lang.Thread.run(Thread.java:619)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;Channel&nbsp;1&nbsp;received&nbsp;shutdown&nbsp;signal:<br>
com.rabbitmq.client.ShutdownSignal&nbsp;(hard&nbsp;error;&nbsp;reason:&nbsp;java.net.SocketException:&nbsp;Connection&nbsp;reset)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;Channel&nbsp;0&nbsp;received&nbsp;shutdown&nbsp;signal:com.rabbitmq.client.ShutdownSignal&nbsp;(hard&nbsp;error;&nbsp;reason:&nbsp;java.net.SocketException<br>
<br>
:&nbsp;Connection&nbsp;reset)&lt;br&gt;&lt;br&gt;&lt;br&gt;============&lt;br&gt;Read&nbsp;timed&nbsp;out&lt;br&gt;============&lt;br&gt;&lt;br&gt;RabbitMQ&nbsp;log&lt;br&gt;&lt;br&gt;=INFO&nbsp;REPORT====&nbsp;30-Jul-2007::15:15:01&nbsp;===&lt;br&gt;&amp;lt;0.230.0&amp;gt;:&nbsp;Opening&nbsp;channel&nbsp;1&lt;br&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;30-Jul-2007::15:16:44&nbsp;===<br>
&lt;br&gt;Error&nbsp;in&nbsp;process&nbsp;&amp;lt;0.220.0&amp;gt;&nbsp;on&nbsp;node&nbsp;&amp;#39;rabbit@tfweb01&amp;#39;&nbsp;with&nbsp;exit&nbsp;value:&nbsp;{{badmatch,{error,closed}},[{rabbit_writer,send,2},{rabbit_writer,internal_send_command,5},{rabbit_writer,do_deliver,9},{rabbit_writer,handle_message,2},{rabbit_writer,mainloop,1}]}<br>
&lt;br&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;30-Jul-2007::15:16:44&nbsp;===&lt;br&gt;Error&nbsp;in&nbsp;process&nbsp;&amp;lt;0.181.0&amp;gt;&nbsp;on&nbsp;node&nbsp;&amp;#39;rabbit@tfweb01&amp;#39;&nbsp;with&nbsp;exit&nbsp;value:&nbsp;{{badmatch,{error,enotconn}},[{rabbit_reader,switch_callback,3},{rabbit_reader,mainloop,1},{rabbit_reader,start_connection,1}]}<br>
&lt;br&gt;&lt;br&gt;=INFO&nbsp;REPORT====&nbsp;30-Jul-2007::15:16:44&nbsp;===&lt;br&gt;Requeueing&nbsp;1&nbsp;messages,&nbsp;365175&nbsp;already&nbsp;on&nbsp;queue&lt;br&gt;&lt;br&gt;&lt;br&gt;Consumer&nbsp;application&nbsp;stdout&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;101002&nbsp;ms:&nbsp;Received&nbsp;66492&nbsp;-&nbsp;693&nbsp;since&nbsp;last&nbsp;report&nbsp;(708&nbsp;Hz)&nbsp;-&nbsp;objects&nbsp;:&amp;nbsp;&nbsp;13298400<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;AMQConnection.mainLoop:&nbsp;exception&nbsp;java.net.SocketTimeoutException:&nbsp;Read&nbsp;timed&nbsp;out&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;java.net.SocketTimeoutException:&nbsp;Read&nbsp;timed&nbsp;out&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.net.SocketInputStream.socketRead0<br>
<br>
(Native&nbsp;Method)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.io.DataInputStream.readFully(DataInputStream.java:178)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.io.DataInputStream.readFully<br>
<br>
(DataInputStream.java:152)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.Frame.readFrom(Frame.java:101)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.AMQConnection.readFrame(AMQConnection.java:212)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.AMQConnection.mainLoop<br>
<br>
(AMQConnection.java:239)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.AMQConnection$1.run(AMQConnection.java:131)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.lang.Thread.run(Thread.java:619)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;Channel&nbsp;1&nbsp;received&nbsp;shutdown&nbsp;signal:<br>
com.rabbitmq.client.ShutdownSignal&nbsp;(hard&nbsp;error;&nbsp;reason:&nbsp;java.net.SocketTimeoutException:&nbsp;Read&nbsp;timed&nbsp;out)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;Shutdown&nbsp;signal&nbsp;terminating&nbsp;consumer.&nbsp;com.rabbitmq.client.ShutdownSignal&nbsp;(hard&nbsp;error;&nbsp;reason:&nbsp;java.net.SocketTimeoutException<br>
<br>
:&nbsp;Read&nbsp;timed&nbsp;out)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[java]&nbsp;Channel&nbsp;0&nbsp;received&nbsp;shutdown&nbsp;signal:com.rabbitmq.client.ShutdownSignal&nbsp;(hard&nbsp;error;&nbsp;reason:&nbsp;java.net.SocketTimeoutException:&nbsp;Read&nbsp;timed&nbsp;out)&lt;/div&gt;<br>

</tt>
