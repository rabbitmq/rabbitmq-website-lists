<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;We've&nbsp;seen&nbsp;this&nbsp;happen&nbsp;twice&nbsp;now&nbsp;and&nbsp;each&nbsp;time&nbsp;it's&nbsp;been&nbsp;a&nbsp;pain&nbsp;to&nbsp;work&nbsp;around&nbsp;(we&nbsp;ended&nbsp;up&nbsp;creating&nbsp;a&nbsp;whole&nbsp;new&nbsp;cluster&nbsp;each&nbsp;time).&nbsp;Here's&nbsp;the&nbsp;scenario&nbsp;we&nbsp;have&nbsp;seen:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Our&nbsp;setup:&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;Three&nbsp;RabbitMQ&nbsp;3.1.5&nbsp;nodes&nbsp;running&nbsp;on&nbsp;the&nbsp;Amazon&nbsp;Linux&nbsp;AMI.&nbsp;Each&nbsp;node&nbsp;is&nbsp;in&nbsp;a&nbsp;different&nbsp;availability&nbsp;zone&nbsp;in&nbsp;the&nbsp;US-EAST&nbsp;region&nbsp;on&nbsp;AWS.&nbsp;We'll&nbsp;call&nbsp;them&nbsp;nodes&nbsp;A,&nbsp;B,&nbsp;and&nbsp;C&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;Each&nbsp;queue&nbsp;is&nbsp;using&nbsp;an&nbsp;HA&nbsp;policy&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;All&nbsp;queues&nbsp;are&nbsp;durable&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;We&nbsp;Basic.Publish&nbsp;with&nbsp;DeliveryMode=2&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;All&nbsp;clients&nbsp;are&nbsp;initially&nbsp;connected&nbsp;to&nbsp;node&nbsp;A&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;The&nbsp;scenario:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;Node&nbsp;A&nbsp;is&nbsp;shutdown&nbsp;(the&nbsp;last&nbsp;time&nbsp;I&nbsp;did&nbsp;it&nbsp;via&nbsp;'sudo&nbsp;/etc/init.d/rabbitmq-server&nbsp;stop&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;All&nbsp;connected&nbsp;clients&nbsp;see&nbsp;the&nbsp;shutdown&nbsp;and&nbsp;successfully&nbsp;transition&nbsp;to&nbsp;using&nbsp;one&nbsp;of&nbsp;the&nbsp;other&nbsp;nodes.&nbsp;About&nbsp;half&nbsp;connect&nbsp;to&nbsp;node&nbsp;B&nbsp;and&nbsp;the&nbsp;other&nbsp;half&nbsp;connect&nbsp;to&nbsp;node&nbsp;C&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;We&nbsp;notice&nbsp;that&nbsp;a&nbsp;few&nbsp;of&nbsp;the&nbsp;queues&nbsp;still&nbsp;show&nbsp;their&nbsp;&quot;node&quot;&nbsp;as&nbsp;being&nbsp;node&nbsp;A,&nbsp;even&nbsp;though&nbsp;it&nbsp;is&nbsp;not&nbsp;currently&nbsp;running.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;Node&nbsp;A&nbsp;is&nbsp;brought&nbsp;back&nbsp;online.&nbsp;The&nbsp;RabbitMQ&nbsp;management&nbsp;console&nbsp;(webapp)&nbsp;shows&nbsp;everything&nbsp;is&nbsp;fine&nbsp;on&nbsp;the&nbsp;homepage.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;When&nbsp;A&nbsp;comes&nbsp;back&nbsp;online,&nbsp;those&nbsp;queues&nbsp;that&nbsp;show&nbsp;A&nbsp;as&nbsp;their&nbsp;'node'&nbsp;now&nbsp;show&nbsp;zero&nbsp;mirrors.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;I&nbsp;attempt&nbsp;to&nbsp;delete&nbsp;the&nbsp;queue&nbsp;via&nbsp;the&nbsp;management&nbsp;webapp.&nbsp;At&nbsp;that&nbsp;point&nbsp;all&nbsp;three&nbsp;nodes&nbsp;become&nbsp;100%&nbsp;unresponsive.&nbsp;The&nbsp;management&nbsp;webapp&nbsp;fails&nbsp;to&nbsp;respond&nbsp;and&nbsp;all&nbsp;communication&nbsp;in&nbsp;our&nbsp;application&nbsp;stops.&nbsp;CPU&nbsp;fluctuates&nbsp;between&nbsp;10-40%&nbsp;on&nbsp;but&nbsp;memory&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;be&nbsp;leaking.&nbsp;It's&nbsp;difficult&nbsp;to&nbsp;know&nbsp;what&nbsp;is&nbsp;happening&nbsp;because&nbsp;rabbitmqctl&nbsp;is&nbsp;also&nbsp;unresponsive.&nbsp;Attempts&nbsp;to&nbsp;gracefully&nbsp;stop&nbsp;the&nbsp;nodes&nbsp;all&nbsp;hang.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;Does&nbsp;anybody&nbsp;have&nbsp;experience&nbsp;with&nbsp;this?&nbsp;What&nbsp;additional&nbsp;information&nbsp;should&nbsp;I&nbsp;provide?&nbsp;It's&nbsp;causing&nbsp;a&nbsp;lot&nbsp;of&nbsp;stress&nbsp;and&nbsp;confuses&nbsp;the&nbsp;heck&nbsp;out&nbsp;of&nbsp;me.&nbsp;Any&nbsp;guidance&nbsp;is&nbsp;much&nbsp;appreciated.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
</tt>
