<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;br&gt;&lt;div&gt;I&nbsp;am&nbsp;new&nbsp;in&nbsp;Rabbit&nbsp;and&nbsp;I&nbsp;need&nbsp;to&nbsp;write&nbsp;consumer&nbsp;code&nbsp;which&nbsp;can&nbsp;1)&nbsp;subscribe&nbsp;to&nbsp;queue&nbsp;with&nbsp;specified&nbsp;name,&nbsp;2)&nbsp;recieve&nbsp;messages,&nbsp;3)&nbsp;if&nbsp;another&nbsp;queue&nbsp;name&nbsp;is&nbsp;specified&nbsp;switch&nbsp;to&nbsp;new&nbsp;queue&nbsp;and&nbsp;start&nbsp;to&nbsp;recieve&nbsp;messages&nbsp;from&nbsp;it&nbsp;4)&nbsp;go&nbsp;to&nbsp;step&nbsp;2).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;use&nbsp;official&nbsp;.NET&nbsp;client&nbsp;and&nbsp;my&nbsp;code&nbsp;looks&nbsp;like:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;\\consumer:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;private&nbsp;string&nbsp;_currentQueue;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;public&nbsp;T&nbsp;Consume(string&nbsp;queue)&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;...&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(_currentQueue&nbsp;!=&nbsp;queue)&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;Subscribe(queue);&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;...&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;var&nbsp;ea&nbsp;=&nbsp;(BasicDeliverEventArgs)&nbsp;_basicConsumer.Queue.Dequeue();&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;...&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;private&nbsp;void&nbsp;Subscribe(string&nbsp;queue)&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;_currentQueue&nbsp;=&nbsp;queue;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;if&nbsp;(_basicConsumer.IsRunning)&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;{&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;_channel.BasicCancel(_basicConsumer.ConsumerTag);&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;_basicConsumer&nbsp;=&nbsp;new&nbsp;QueueingBasicConsumer(_channel)&nbsp;{&nbsp;ConsumerTag&nbsp;=&nbsp;GetNewTag()};&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;_channel.BasicConsume(_currentQueue,&nbsp;false,&nbsp;_basicConsumer);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;example&nbsp;I&nbsp;have&nbsp;2&nbsp;queues&nbsp;(&quot;A&quot;,&nbsp;&quot;B&quot;)&nbsp;with&nbsp;2&nbsp;messages&nbsp;in&nbsp;each&nbsp;and&nbsp;I&nbsp;consume&nbsp;in&nbsp;A-B-A-B&nbsp;order.&lt;/div&gt;&lt;div&gt;My&nbsp;code&nbsp;successfully&nbsp;reads&nbsp;first&nbsp;messages&nbsp;from&nbsp;both&nbsp;A&nbsp;and&nbsp;B&nbsp;queues,&nbsp;but&nbsp;third&nbsp;time&nbsp;(second&nbsp;read&nbsp;from&nbsp;A)&nbsp;it&nbsp;stays&nbsp;at&nbsp;line&lt;/div&gt;&lt;div&gt;var&nbsp;ea&nbsp;=&nbsp;(BasicDeliverEventArgs)&nbsp;_basicConsumer.Queue.Dequeue();&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;nothing&nbsp;happens.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Moreover&nbsp;it'is&nbsp;strange&nbsp;that&nbsp;via&nbsp;control&nbsp;panel&nbsp;I&nbsp;can&nbsp;see&nbsp;2&nbsp;unacked&nbsp;messages&nbsp;in&nbsp;both&nbsp;A&nbsp;and&nbsp;B&nbsp;queues.&nbsp;Corresponding&nbsp;to&nbsp;program&nbsp;beheaviour&nbsp;I&nbsp;can&nbsp;understand&nbsp;unacked&nbsp;message&nbsp;in&nbsp;A&nbsp;queue&nbsp;but&nbsp;not&nbsp;in&nbsp;B&nbsp;-&nbsp;second&nbsp;consuming&nbsp;from&nbsp;B&nbsp;was&nbsp;not&nbsp;started&nbsp;yet.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Please,&nbsp;tell&nbsp;me&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;do&nbsp;this.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;consider&nbsp;that&nbsp;simple&nbsp;reconnection&nbsp;will&nbsp;solve&nbsp;my&nbsp;problem,&nbsp;but&nbsp;seems&nbsp;it's&nbsp;a&nbsp;bad&nbsp;practice.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;a&nbsp;lot.&lt;/div&gt;&lt;/div&gt;
</tt>
