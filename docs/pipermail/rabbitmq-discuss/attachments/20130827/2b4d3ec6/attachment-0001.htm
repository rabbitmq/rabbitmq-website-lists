<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;upgraded&nbsp;from&nbsp;3.0.4&nbsp;to&nbsp;3.1.5&nbsp;and&nbsp;from&nbsp;esl-erlang&nbsp;R15B03&nbsp;to&nbsp;esl-erlang&nbsp;R16B01.&nbsp; I&amp;#39;ve&nbsp;been&nbsp;doing&nbsp;some&nbsp;digging&nbsp;and&nbsp;can&amp;#39;t&nbsp;find&nbsp;any&nbsp;reason&nbsp;why&nbsp;this&nbsp;would&nbsp;happen,&nbsp;no&nbsp;additional&nbsp;log&nbsp;files,&nbsp;nothing.&nbsp; Note&nbsp;there&nbsp;are&nbsp;three&nbsp;nodes&nbsp;involved&nbsp;in&nbsp;a&nbsp;cluster.&nbsp; I&nbsp;upgraded&nbsp;my&nbsp;&amp;quot;dvlp&amp;quot;&nbsp;sample&nbsp;box&nbsp;which&nbsp;wasn&amp;#39;t&nbsp;clustered&nbsp;with&nbsp;no&nbsp;problem&nbsp;using&nbsp;the&nbsp;exact&nbsp;same&nbsp;script&nbsp;I&nbsp;used&nbsp;to&nbsp;upgrade&nbsp;my&nbsp;alpha&nbsp;cluster.&nbsp; Below&nbsp;is&nbsp;the&nbsp;script&nbsp;I&amp;#39;m&nbsp;using&nbsp;(might&nbsp;be&nbsp;useful&nbsp;for&nbsp;others&nbsp;upgrading&nbsp;a&nbsp;cluster).&nbsp; I&amp;#39;m&nbsp;going&nbsp;to&nbsp;try&nbsp;recreating&nbsp;my&nbsp;&amp;quot;Alpha&amp;quot; environment and&nbsp;redoing&nbsp;the&nbsp;upgrade.&nbsp; The&nbsp;ONLY&nbsp;thing&nbsp;that&nbsp;I&nbsp;can&nbsp;think&nbsp;of&nbsp;-&nbsp;I&nbsp;was&nbsp;doing&nbsp;stop/starts&nbsp;as&nbsp;part&nbsp;of&nbsp;training&nbsp;of&nbsp;the&nbsp;cluster&nbsp;about&nbsp;20&nbsp;minutes&nbsp;before&nbsp;I&nbsp;did&nbsp;the&nbsp;upgrade&nbsp;to&nbsp;test&nbsp;various&nbsp;concepts,&nbsp;e.g.&nbsp;message&nbsp;loss,&nbsp;master&nbsp;node&nbsp;recovery,&nbsp;etc.&nbsp;etc.&nbsp; At&nbsp;this&nbsp;point,&nbsp;if&nbsp;people&nbsp;haven&amp;#39;t&nbsp;seen&nbsp;or&nbsp;heard&nbsp;of&nbsp;this,&nbsp;I&amp;#39;ll&nbsp;chalk&nbsp;it&nbsp;up&nbsp;to&nbsp;something&nbsp;funky&nbsp;disk&nbsp;or&nbsp;otherwise&nbsp;until&nbsp;I&nbsp;can&nbsp;try&nbsp;and&nbsp;replicate&nbsp;it.&nbsp; My&nbsp;biggest&nbsp;concern&nbsp;at&nbsp;this&nbsp;point&nbsp;is&nbsp;that&nbsp;because&nbsp;i&nbsp;no&nbsp;longer&nbsp;have&nbsp;the&nbsp;backup&amp;#39;s&nbsp;of&nbsp;the&nbsp;mnesia&nbsp;database,&nbsp;replicating&nbsp;the&nbsp;environment&nbsp;won&amp;#39;t&nbsp;replicate&nbsp;exactly&nbsp;what&nbsp;was&nbsp;in&nbsp;the&nbsp;database,&nbsp;and&nbsp;so&nbsp;I&nbsp;won&amp;#39;t&nbsp;be&nbsp;able&nbsp;to&nbsp;replicate&nbsp;it.&nbsp; When&nbsp;I&nbsp;start&nbsp;deploying&nbsp;to&nbsp;our&nbsp;production&nbsp;environment,&nbsp;I&nbsp;won&amp;#39;t&nbsp;make&nbsp;that&nbsp;mistake&nbsp;-&nbsp;I&amp;#39;ll&nbsp;shutdown&nbsp;rabbit,&nbsp;back&nbsp;up&nbsp;my&nbsp;whole&nbsp;rabbit_data_directory&nbsp;first&nbsp;:)&lt;div&nbsp;style&gt;<br>
Thanks!&lt;br&gt;Jason&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;########################################&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;04/22/2013&nbsp;-&nbsp;JasonMcIntosh&nbsp;-&nbsp;core&nbsp;upgrade&nbsp;script&nbsp;to&nbsp;go&nbsp;through&nbsp;each&nbsp;reported&nbsp;node&nbsp;in&nbsp;a&nbsp;cluster&nbsp;and&nbsp;upgrade&nbsp;it&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;########################################&lt;/div&gt;&lt;div&gt;if&nbsp;[&nbsp;!&nbsp;-e&nbsp;/data/rabbitmq&nbsp;];&nbsp;then&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;echo&nbsp;&amp;quot;No&nbsp;rabbit&nbsp;found&nbsp;on&nbsp;$1&amp;quot;&nbsp;&amp;gt;&nbsp;/var/log/rabbit_upgrade.log&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;exit&nbsp;0&lt;/div&gt;&lt;div&gt;fi&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;export&nbsp;LOG_FILE=/var/log/rabbitmq/upgrade.log&lt;/div&gt;&lt;div&gt;rm&nbsp;-f&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;export&nbsp;CLUSTER_STATUS=&amp;quot;`rabbitmqctl&nbsp;cluster_status`&amp;quot;&lt;/div&gt;<br>
&lt;div&gt;export&nbsp;CLUSTER_STATUS=&amp;quot;`echo&nbsp;$CLUSTER_STATUS|tr&nbsp;-d&nbsp;&amp;#39;&nbsp;\n&amp;#39;`&amp;quot;&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;Started&nbsp;at&nbsp;`date`&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;$CLUSTER_STATUS&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;getServerFQDN()&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;SERVER_FQDN=`echo&nbsp;$1&nbsp;|&nbsp;awk&nbsp;-F@&nbsp;&amp;#39;{print&nbsp;$2};&amp;#39;`&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;FQDN=`nslookup&nbsp;$SERVER_FQDN|grep&nbsp;Name|awk&nbsp;-F\:&nbsp;&amp;#39;{print&nbsp;$2}&amp;#39;|sed&nbsp;&amp;#39;s/&nbsp;//g&amp;#39;`&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;echo&nbsp;$FQDN&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;upgradeRabbitNode()&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;SERVER_FQDN=`getServerFQDN&nbsp;$1`&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;echo&nbsp;&amp;quot;Doing&nbsp;upgrade&nbsp;of&nbsp;$SERVER_FQDN&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;#&nbsp;The&nbsp;upgrade&nbsp;deploy&nbsp;job&nbsp;actually&nbsp;stops&nbsp;the&nbsp;rabbit&nbsp;server,&nbsp;shouldn&amp;#39;t&nbsp;need&nbsp;this,&nbsp;but&nbsp;we&amp;#39;ll&nbsp;do&nbsp;it&nbsp;anways&lt;/div&gt;&lt;div&nbsp;style&gt; &nbsp;#&nbsp;Not&nbsp;exact&nbsp;commands&nbsp;below&nbsp;as&nbsp;I&amp;#39;m&nbsp;using&nbsp;bladelogic&nbsp;internal&nbsp;commands&nbsp;to&nbsp;do&nbsp;these,&nbsp;but&nbsp;the&nbsp;idea&nbsp;should&nbsp;be&nbsp;the&nbsp;same.&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;remote_exec&nbsp;${SERVER_FQDN}&nbsp;service&nbsp;rabbitmq-server&nbsp;stop&nbsp; &amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;remote_exec $SERVER_FQDN&nbsp;yum&nbsp;-y&nbsp;erase&nbsp;rabbit*&nbsp;erlang*&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;  remote_exec  $SERVER_FQDN&nbsp;yum&nbsp;-y&nbsp;install&nbsp;rabbitmq-server-3.1.5...&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;  remote_exec $SERVER_FQDN&nbsp;rabbitmq-plugins&nbsp;enable&nbsp;rabbitmq_management&nbsp;rabbitmq_management_agent&nbsp;rabbitmq_management_visualiser&nbsp;rabbitmq_shovel&nbsp;rabbitmq_shovel_management&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;br&gt;<br>
&lt;/div&gt;&lt;div&nbsp;style&gt; &nbsp; &nbsp; &nbsp;  remote_exec  $SERVER_FQDN chkconfig&nbsp;rabbitmq-server&nbsp;on&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Get&nbsp;the&nbsp;cluster&nbsp;nodes&nbsp;and&nbsp;pick&nbsp;the&nbsp;first&nbsp;disk&nbsp;node&nbsp;as&nbsp;the&nbsp;&amp;quot;upgrader&amp;quot;&nbsp;node&lt;/div&gt;<br>
&lt;div&gt;export&nbsp;UPGRADER_NODE=`echo&nbsp;&amp;quot;$CLUSTER_STATUS&amp;quot;|awk&nbsp;-F\[&nbsp;&amp;#39;{print&nbsp;$4}&amp;#39;|awk&nbsp;-F\]&nbsp;&amp;#39;{print&nbsp;$1}&amp;#39;|awk&nbsp;-F,&nbsp;&amp;#39;{print&nbsp;$1}&amp;#39;`&lt;/div&gt;&lt;div&gt;export&nbsp;UPGRADER_FQDN=`getServerFQDN&nbsp;$UPGRADER_NODE`&lt;/div&gt;&lt;div&gt;<br>
export&nbsp;NODE_LIST=&amp;quot;`echo&nbsp;$CLUSTER_STATUS|awk&nbsp;-F\[&nbsp;&amp;#39;{sub(/.*running_nodes/,\&amp;quot;\&amp;quot;)};1&amp;#39;|awk&nbsp;-F\[&nbsp;&amp;#39;{print&nbsp;$2}&amp;#39;|awk&nbsp;-F\]&nbsp;&amp;#39;{print&nbsp;$1}&amp;#39;|sed&nbsp;-e&nbsp;&amp;#39;s/,/&nbsp;/g&amp;#39;`&amp;quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
echo&nbsp;&amp;quot;Node&nbsp;list:&nbsp;$NODE_LIST&nbsp;&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;Disk&nbsp;node&nbsp;for&nbsp;last&nbsp;upgrade&nbsp;$UPGRADER_NODE&amp;quot;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if&nbsp;[&nbsp;&amp;quot;$UPGRADER_NODE&amp;quot;&nbsp;=&nbsp;&amp;quot;&amp;quot;&nbsp;];&nbsp;then&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;echo&nbsp;&amp;quot;&nbsp;**&nbsp;No&nbsp;upgrader&nbsp;node&nbsp;found!&nbsp;EXITING&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;exit&nbsp;-1&lt;/div&gt;&lt;div&gt;fi&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Shutdown&nbsp;and&nbsp;upgrade&nbsp;all&nbsp;other&nbsp;nodes&nbsp;than&nbsp;the&nbsp;upgrader&nbsp;node&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;Doing&nbsp;upgrade&nbsp;of&nbsp;all&nbsp;non&nbsp;upgrade&nbsp;nodes...&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;for&nbsp;clusterNode&nbsp;in&nbsp;${NODE_LIST};&nbsp;do&lt;/div&gt;&lt;div&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;if&nbsp;[&nbsp;$clusterNode&nbsp;!=&nbsp;$UPGRADER_NODE&nbsp;];&nbsp;then &lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;upgradeRabbitNode&nbsp;$clusterNode&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;fi&lt;/div&gt;<br>
&lt;div&gt;done&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#Upgrade&nbsp;the&nbsp;upgrader&nbsp;node&nbsp;now.&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;Upgrade&nbsp;the&nbsp;core&nbsp;upgrade&nbsp;node&nbsp;...&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;upgradeRabbitNode&nbsp;$UPGRADER_NODE&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#NOW&nbsp;start&nbsp;all&nbsp;nodes,&nbsp;starting&nbsp;with&nbsp;the&nbsp;upgrader&nbsp;node.&lt;/div&gt;<br>
&lt;div&gt;echo&nbsp;&amp;quot;Starting&nbsp;rabbit&nbsp;on&nbsp;upgrader&nbsp;node...&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;remote_exec $UPGRADER_FQDN&nbsp;service&nbsp;rabbitmq-server&nbsp;start&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;for&nbsp;clusterNode&nbsp;in&nbsp;${NODE_LIST};&nbsp;do&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;if&nbsp;[&nbsp;$clusterNode&nbsp;!=&nbsp;$UPGRADER_NODE&nbsp;];&nbsp;then &lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;SERVER_FQDN=`getServerFQDN&nbsp;$clusterNode`&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;echo&nbsp;&amp;quot;Starting&nbsp;rabbit&nbsp;on&nbsp;NON&nbsp;upgrade&nbsp;nodes...&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;remote_exec $SERVER_FQDN&nbsp;service&nbsp;rabbitmq-server&nbsp;start&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;fi&lt;/div&gt;&lt;div&gt;done&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;#Finally,&nbsp;make&nbsp;sure&nbsp;our&nbsp;HA&nbsp;Policy&nbsp;is&nbsp;applied&nbsp;to&nbsp;all&nbsp;our&nbsp;virtual&nbsp;hosts&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;Finished&nbsp;with&nbsp;upgrade...&amp;quot;&nbsp;&amp;gt;&amp;gt;&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;#Report&nbsp;how&nbsp;we&nbsp;worked&nbsp;out...&lt;/div&gt;&lt;div&gt;echo&nbsp;&amp;quot;&lt;/div&gt;<br>
&lt;div&gt;RESULTS&lt;/div&gt;&lt;div&gt;&amp;quot;&lt;/div&gt;&lt;div&gt;cat&nbsp;$LOG_FILE&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Aug&nbsp;27,&nbsp;2013&nbsp;at&nbsp;4:58&nbsp;AM,&nbsp;Emile&nbsp;Joubert&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;23/08/13&nbsp;23:01,&nbsp;Jason&nbsp;McIntosh&nbsp;wrote:&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;A&nbsp;ps&nbsp;auf&nbsp;shows&nbsp;/usr/lib/erlang/erts-5.9.3.1/bin/epmd&nbsp;-daemon&nbsp;as&nbsp;still&lt;br&gt;<br>
&amp;gt;&nbsp;running.&nbsp; SO&nbsp;I&amp;#39;m&nbsp;wondering&nbsp;if&nbsp;that&nbsp;might&nbsp;have&nbsp;an&nbsp;impact.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Depending&nbsp;on&nbsp;how&nbsp;you&nbsp;upgraded&nbsp;Erlang&nbsp;you&nbsp;may&nbsp;need&nbsp;to&nbsp;stop&nbsp;this&nbsp;process&lt;br&gt;<br>
manually.&nbsp;I&amp;#39;d&nbsp;be&nbsp;surprised&nbsp;if&nbsp;this&nbsp;was&nbsp;the&nbsp;cause&nbsp;of&nbsp;the&nbsp;error&nbsp;though.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;stop&nbsp;rabbit&nbsp;on&nbsp;server&nbsp;X&nbsp;(upgrader&nbsp;is&nbsp;Z,&nbsp;other&nbsp;node&nbsp;is&nbsp;Y)&lt;br&gt;<br>
&amp;gt;&nbsp;remove&nbsp;all&nbsp;rabbit/erlang&nbsp;RPM&amp;#39;s&lt;br&gt;<br>
&amp;gt;&nbsp;Reinstall&nbsp;rabbit&nbsp;software&lt;br&gt;<br>
&amp;gt;&nbsp;Update&nbsp;rabbitmqadmin&lt;br&gt;<br>
&amp;gt;&nbsp;Enable&nbsp;management&nbsp;plugins&nbsp;(just&nbsp;in&nbsp;case)&lt;br&gt;<br>
&amp;gt;&nbsp;Enable&nbsp;auto&nbsp;start.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Rinse&nbsp;and&nbsp;repeat&nbsp;on&nbsp;servers&nbsp;Y,&nbsp;then&nbsp;Z&nbsp;and&nbsp;then&nbsp;start&nbsp;bringing&nbsp;them&nbsp;up&lt;br&gt;<br>
&amp;gt;&nbsp;starting&nbsp;with&nbsp;upgrader&nbsp;node.&nbsp;First&nbsp;start&nbsp;Z,&nbsp;then&nbsp;start&nbsp;Y,&nbsp;then&nbsp;start&nbsp;X.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;From&nbsp;which&nbsp;versions&nbsp;did&nbsp;you&nbsp;upgrade?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;Aug&nbsp;23,&nbsp;2013&nbsp;at&nbsp;4:51&nbsp;PM,&nbsp;Jason&nbsp;McIntosh&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp;=INFO&nbsp;REPORT====&nbsp;23-Aug-2013::15:37:45&nbsp;===&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp;Disk&nbsp;free&nbsp;limit&nbsp;set&nbsp;to&nbsp;1000MB&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Were&nbsp;there&nbsp;any&nbsp;other&nbsp;log&nbsp;messages&nbsp;in&nbsp;either&nbsp;logfile&nbsp;or&nbsp;console&nbsp;messages&lt;br&gt;<br>
on&nbsp;any&nbsp;nodes&nbsp;in&nbsp;the&nbsp;interval&nbsp;between&nbsp;or&nbsp;near&nbsp;15:37:45&nbsp;-&nbsp;15:37:50?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=ERROR&nbsp;REPORT====&nbsp;23-Aug-2013::15:37:50&nbsp;===&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;**&nbsp;Generic&nbsp;server&nbsp;&amp;lt;0.303.0&amp;gt;&nbsp;terminating&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;**&nbsp;Last&nbsp;message&nbsp;in&nbsp;was&nbsp;{&amp;#39;EXIT&amp;#39;,&amp;lt;0.350.0&amp;gt;,normal}&lt;br&gt;<br>
&lt;/div&gt;Did&nbsp;you&nbsp;perform&nbsp;the&nbsp;same&nbsp;upgrade&nbsp;in&nbsp;other&nbsp;environments,&nbsp;and&nbsp;the&nbsp;failure&lt;br&gt;<br>
only&nbsp;occurred&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;environments?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-Emile&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;Jason&nbsp;McIntosh&lt;br&gt;&lt;a&nbsp;href=&quot;http://mcintosh.poetshome.com/blog/&quot;&gt;http://mcintosh.poetshome.com/blog/&lt;/a&gt;&lt;br&gt;573-424-7612<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
