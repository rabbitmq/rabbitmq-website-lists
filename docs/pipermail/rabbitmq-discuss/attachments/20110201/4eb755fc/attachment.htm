<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Jan&nbsp;31,&nbsp;2011&nbsp;at&nbsp;9:59&nbsp;PM,&nbsp;yoav&nbsp;glazner&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:yoavglazner@gmail.com&quot;&gt;yoavglazner@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;implement&nbsp;a&nbsp;priority&nbsp;queue&nbsp;over&nbsp;Rabbit&nbsp;with&nbsp;python,&nbsp;and&nbsp;this&nbsp;is&nbsp;my&nbsp;idea&lt;/div&gt;&lt;div&gt;each&nbsp;batch&nbsp;of&nbsp;tasks&nbsp;has&nbsp;its&nbsp;own&nbsp;queue,&nbsp;each&nbsp;worker&nbsp;knows&nbsp;about&nbsp;all&nbsp;the&nbsp;batches&nbsp;and&nbsp;their&nbsp;priorities.&lt;/div&gt;<br>
<br>
&lt;div&gt;now&nbsp;the&nbsp;part&nbsp;where&nbsp;I&nbsp;don&amp;#39;t&nbsp;understand:&lt;/div&gt;&lt;div&gt;  how&nbsp;does&nbsp;a&nbsp;worker&nbsp;tries&nbsp;a&nbsp;take&nbsp;a&nbsp;task&nbsp;from&nbsp;a&nbsp;batch(queue)&nbsp; but&nbsp;if&nbsp;its&nbsp;empty&nbsp;it&nbsp;passes&nbsp;to&nbsp;the&nbsp;next&nbsp;batch?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;need&nbsp;somthing&nbsp;like:&lt;/div&gt;&lt;div&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;for&nbsp;q&nbsp;in&nbsp;queuesSortedByPriority:&lt;/div&gt;&lt;div&gt;  t&nbsp;=&nbsp;q.get()&lt;/div&gt;&lt;div&gt;  if&nbsp;t:&nbsp;break&lt;/div&gt;&lt;div&gt;else:&nbsp;raise&nbsp;NoTaskFound()&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;I&nbsp;saw&nbsp;in&nbsp;the&nbsp;java&nbsp;example-&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/tutorial-one-java.html&quot;&gt;http://www.rabbitmq.com/tutorial-one-java.html&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;the&nbsp;following&nbsp;line:&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;Verdana,&nbsp;sans-serif;&nbsp;font-size:&nbsp;9.02778px;&nbsp;color:&nbsp;rgb(85,&nbsp;85,&nbsp;85);&nbsp;line-height:&nbsp;18px;&nbsp;&quot;&gt;&lt;span&nbsp;class=&quot;code&nbsp;&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;139,&nbsp;139);&nbsp;background-image:&nbsp;initial;&nbsp;background-attachment:&nbsp;initial;&nbsp;background-origin:&nbsp;initial;&nbsp;background-clip:&nbsp;initial;&nbsp;background-color:&nbsp;rgb(246,&nbsp;252,&nbsp;176);&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;5px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;5px;&nbsp;background-position:&nbsp;initial&nbsp;initial;&nbsp;background-repeat:&nbsp;initial&nbsp;initial;&nbsp;&quot;&gt;QueueingConsumer.nextDelivery()&lt;/span&gt; blocks&nbsp;until&nbsp;another&nbsp;message&nbsp;has&nbsp;been&nbsp;delivered&nbsp;from&nbsp;the&nbsp;server.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;haven&amp;#39;t&nbsp;seen&nbsp;anything&nbsp;like&nbsp;this&nbsp;for&nbsp;python.&nbsp;is&nbsp;there&nbsp;anything&nbsp;similar?&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
