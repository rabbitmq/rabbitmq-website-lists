<tt>
I&amp;#39;m&nbsp;doing&nbsp;some&nbsp;load&nbsp;testing&nbsp;on&nbsp;Rabbit&nbsp;and&nbsp;I&amp;#39;m&nbsp;bumping&nbsp;into&nbsp;the&nbsp;following&nbsp;scenario:&lt;br&gt;<br>
&lt;br&gt;<br>
Fanout&nbsp;exchange&nbsp;&amp;gt;&nbsp;Durable&nbsp;queue&lt;br&gt;<br>
&lt;br&gt;<br>
I&amp;#39;m&nbsp;pushing&nbsp;~300~350&nbsp;message/s&nbsp;into&nbsp;Rabbit,&nbsp;each&nbsp;~10kb/s.&nbsp;Watching&nbsp;the&nbsp;network&nbsp;pipe,&nbsp;the&nbsp;input&nbsp;is&nbsp;fluctuating&nbsp;around&nbsp;3.5mb/s.&nbsp;Comparing&nbsp;these&nbsp;numbers&nbsp;to&nbsp;the&nbsp;docs,&nbsp;they&nbsp;seem&nbsp;to&nbsp;be&nbsp;consistent&nbsp;with&nbsp;the&nbsp;documented&nbsp;number&nbsp;of&nbsp;4000m/s&nbsp;at&nbsp;1kb&nbsp;each.&nbsp;(or&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;same&nbsp;ballpark).&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Rabbit&nbsp;seems&nbsp;to&nbsp;become&nbsp;unstable&nbsp;once&nbsp;the&nbsp;persister.LOG&nbsp;crosses&nbsp;the&nbsp;1GB&nbsp;limit.&nbsp;Disk&nbsp;syncs&nbsp;are&nbsp;taking&nbsp;longer&nbsp;and&nbsp;longer&nbsp;(for&nbsp;obvious&nbsp;reasons),&nbsp;and&nbsp;memory&nbsp;starts&nbsp;to&nbsp;fluctuate&nbsp;all&nbsp;over&nbsp;the&nbsp;map&nbsp;-&nbsp;from&nbsp;2GB&nbsp;to&nbsp;7GB&nbsp;(I&nbsp;am&nbsp;seeing&nbsp;high&nbsp;memory&nbsp;watermark&nbsp;warnings).&nbsp;Then,&nbsp;without&nbsp;any&nbsp;warnings&nbsp;in&nbsp;the&nbsp;log&nbsp;file,&nbsp;the&nbsp;process&nbsp;falls&nbsp;over&nbsp;and&nbsp;everyone&nbsp;gets&nbsp;disconnected.&nbsp;On&nbsp;the&nbsp;rabbit&nbsp;node,&nbsp;I&nbsp;still&nbsp;see&nbsp;epmd&nbsp;and&nbsp;beam.smp&nbsp;processes&nbsp;running,&nbsp;but&nbsp;the&nbsp;node&nbsp;is&nbsp;reported&nbsp;as&nbsp;down.&nbsp;Running&nbsp;the&nbsp;node&nbsp;in&nbsp;the&nbsp;foreground,&nbsp;I&nbsp;get:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
broker&nbsp;running&lt;br&gt;<br>
/usr/local/lib/erlang/lib/os_mon-2.1.8/priv/bin/memsup:&nbsp;Erlang&nbsp;has&nbsp;closed.&lt;br&gt;&lt;div&nbsp;id=&quot;:kv&quot;&nbsp;class=&quot;ArwC7c&nbsp;ckChnd&quot;&gt;<br>
Erlang&nbsp;has&nbsp;closed&lt;br&gt;<br>
&lt;br&gt;<br>
(Tried&nbsp;disabling&nbsp;memsup&nbsp;and&nbsp;lowering&nbsp;the&nbsp;mem&nbsp;watermark&nbsp;to&nbsp;0.7,&nbsp;same&nbsp;thing..&nbsp;Erlang&nbsp;closed)&lt;br&gt;<br>
&lt;br&gt;<br>
Looking&nbsp;at&nbsp;the&nbsp;persister&nbsp;logs&nbsp;(no&nbsp;.previous):&lt;br&gt;<br>
-rw-r--r--&nbsp;1&nbsp;root&nbsp;root&nbsp;2.0G&nbsp;Nov&nbsp;15&nbsp;10:24&nbsp;rabbit_persister.LOG&lt;br&gt;<br>
&lt;br&gt;<br>
At&nbsp;this&nbsp;point&nbsp;I&nbsp;can&amp;#39;t&nbsp;even&nbsp;restart&nbsp;the&nbsp;node.&nbsp;The&nbsp;only&nbsp;way&nbsp;to&nbsp;get&nbsp;it&nbsp;back&nbsp;up&nbsp;is&nbsp;to&nbsp;remove&nbsp;the&nbsp;persister&nbsp;logs&nbsp;and&nbsp;let&nbsp;is&nbsp;start&nbsp;clean.&lt;br&gt;<br>
&lt;br&gt;<br>
I&amp;#39;ve&nbsp;scanned&nbsp;the&nbsp;irc&nbsp;logs&nbsp;[1],&nbsp;and&nbsp;it&nbsp;does&nbsp;seem&nbsp;that&nbsp;persister&nbsp;is&nbsp;still&nbsp;up&nbsp;in&nbsp;the&nbsp;air..&nbsp;Having&nbsp;said&nbsp;that,&nbsp;any&nbsp;ideas&nbsp;or&nbsp;recommendations?&lt;br&gt;<br>
&lt;br&gt;<br>
[1]&nbsp;&lt;a&nbsp;href=&quot;http://dev.rabbitmq.com/irclog/index.php?date=2008-07-31&quot;&nbsp;target=&quot;_blank&quot;&gt;http://dev.rabbitmq.com/irclog/index.php?date=2008-07-31&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
P.S.&nbsp;Running&nbsp;latest&nbsp;version&nbsp;of&nbsp;RabbitMQ&nbsp;from&nbsp;trunk&nbsp;(as&nbsp;of&nbsp;Nov&nbsp;14th),&nbsp;erl:&nbsp;R12B-5&lt;/div&gt;<br>

</tt>
