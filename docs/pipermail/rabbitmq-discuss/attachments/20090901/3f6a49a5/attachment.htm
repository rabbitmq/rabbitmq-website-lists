<tt>
am&nbsp;I&nbsp;not&nbsp;already&nbsp;already&nbsp;using&nbsp;the&nbsp;same&nbsp;socket?&lt;br&gt;&lt;br&gt;       &nbsp;public&nbsp;void&nbsp;PublishMessage(string&nbsp;pstrExchangeName,&nbsp;string&nbsp;pstrReturnKey,&nbsp;string&nbsp;pstrXml)&lt;br&gt;       &nbsp;{&lt;br&gt;           &nbsp;try&lt;br&gt;           &nbsp;{&lt;br&gt;               &nbsp;using&nbsp;(IConnection&nbsp;conn&nbsp;=&nbsp;new&nbsp;ConnectionFactory().CreateConnection(&amp;quot;localhost:5672&amp;quot;))&lt;br&gt;<br>
               &nbsp;{&lt;br&gt;                   &nbsp;using&nbsp;(IModel&nbsp;ch&nbsp;=&nbsp;conn.CreateModel())&lt;br&gt;                   &nbsp;{&lt;br&gt;                       &nbsp;IBasicProperties&nbsp;props&nbsp;=&nbsp;ch.CreateBasicProperties();&lt;br&gt;                       &nbsp;IStreamMessageBuilder&nbsp;b&nbsp;=&nbsp;new&nbsp;StreamMessageBuilder(ch);&lt;br&gt;<br>
&lt;br&gt;                       &nbsp;byte[]&nbsp;bytes&nbsp;=&nbsp;Encoding.UTF8.GetBytes(pstrXml);&lt;br&gt;                       &nbsp;b.WriteBytes(bytes);&lt;br&gt;                       &nbsp;ch.BasicPublish(pstrExchangeName,&nbsp;pstrReturnKey,&nbsp;null,&nbsp;bytes);&lt;br&gt;                   &nbsp;}&lt;br&gt;<br>
               &nbsp;}&lt;br&gt;           &nbsp;}&lt;br&gt;&lt;br&gt;           &nbsp;catch&nbsp;(Exception&nbsp;ex)&lt;br&gt;           &nbsp;{&lt;br&gt;               &nbsp;throw&nbsp;ex;&lt;br&gt;           &nbsp;}&lt;br&gt;       &nbsp;}&lt;br&gt;&lt;br&gt;and&nbsp;from:&nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/faq.html&quot;&gt;http://www.rabbitmq.com/faq.html&lt;/a&gt;&nbsp;&lt;br&gt;<br>
&amp;lt;snip&amp;gt;&lt;br&gt;Q.&nbsp;How&nbsp;fast&nbsp;is&nbsp;RabbitMQ&nbsp;in&nbsp;persistent&nbsp;mode?&lt;br&gt;&lt;br&gt;A.&nbsp;From&nbsp;our&nbsp;testing,&nbsp;we&nbsp;expect&nbsp;easily-achievable&nbsp;throughputs&nbsp;of&nbsp;4000&nbsp;persistent,&nbsp;non-transacted&nbsp;one-kilobyte&nbsp;messages&nbsp;per&nbsp;second&nbsp;(Intel&nbsp;Pentium&nbsp;D,&nbsp;2.8GHz,&nbsp;dual&nbsp;core,&nbsp;gigabit&nbsp;ethernet)&nbsp;from&nbsp;a&nbsp;single&nbsp;RabbitMQ&nbsp;broker&nbsp;node&nbsp;writing&nbsp;to&nbsp;a&nbsp;single&nbsp;spindle.&nbsp;&lt;br&gt;<br>
&amp;lt;/snip&amp;gt;&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;not&nbsp;even&nbsp;remotely&nbsp;seeing&nbsp;this&nbsp;kind&nbsp;of&nbsp;performance&nbsp;on&nbsp;better&nbsp;then&nbsp;twice&nbsp;the&nbsp;hardware...&lt;br&gt;&lt;br&gt;am&nbsp;i&nbsp;missing&nbsp;something&nbsp;?&lt;br&gt;&lt;br&gt;thanks&nbsp;in&nbsp;advance.&lt;br&gt;&lt;br&gt;re:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;1,&nbsp;2009&nbsp;at&nbsp;4:10&nbsp;AM,&nbsp;Tony&nbsp;Garnock-Jones&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:tonyg@lshift.net&quot;&gt;tonyg@lshift.net&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;Patrick&nbsp;Kenney&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;seemed&nbsp;to&nbsp;closely&nbsp;resemble&nbsp;the&nbsp;condition,&nbsp;as&nbsp;I&nbsp;am&nbsp;sending&nbsp;4000&nbsp;copies&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;same&nbsp;message&nbsp;to&nbsp;the&nbsp;following&nbsp;method...&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Your&nbsp;operating&nbsp;system&nbsp;is&nbsp;probably&nbsp;running&nbsp;out&nbsp;of&nbsp;sockets.&nbsp;Try&nbsp;holding&nbsp;a&lt;br&gt;<br>
single&nbsp;connection&nbsp;open&nbsp;and&nbsp;reusing&nbsp;it&nbsp;for&nbsp;all&nbsp;the&nbsp;deliveries,&nbsp;rather&lt;br&gt;<br>
than&nbsp;opening&nbsp;a&nbsp;connection&nbsp;for&nbsp;each&nbsp;delivery.&nbsp;Connections&nbsp;are&nbsp;relatively&lt;br&gt;<br>
heavyweight&nbsp;compared&nbsp;to&nbsp;calls&nbsp;to&nbsp;BasicPublish.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;am&nbsp;thinking&nbsp;I&nbsp;am&nbsp;hitting&nbsp;some&nbsp;kind&nbsp;of&nbsp;configurable&nbsp;threshold&nbsp;in&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;RabbitMQ&nbsp;Client&nbsp; and&nbsp;or&nbsp;RabbitMQ&nbsp;ServiceModel...&nbsp;but&nbsp;have&nbsp;been&nbsp;unable&lt;br&gt;<br>
&amp;gt;&nbsp;thus&nbsp;far&nbsp;to&nbsp;pin&nbsp;it&nbsp;down...&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;It&nbsp;is&nbsp;more&nbsp;likely&nbsp;to&nbsp;be&nbsp;an&nbsp;operating&nbsp;system&nbsp;(or&nbsp;TCP,&nbsp;depending&nbsp;on&nbsp;how&lt;br&gt;<br>
you&nbsp;look&nbsp;at&nbsp;it)&nbsp;limitation.&nbsp;Neither&nbsp;the&nbsp;C#&nbsp;client,&nbsp;the&nbsp;WCF&nbsp;binding,&nbsp;nor&lt;br&gt;<br>
the&nbsp;RabbitMQ&nbsp;server&nbsp;have&nbsp;any&nbsp;preconfigured&nbsp;limitations&nbsp;of&nbsp;this&nbsp;kind.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Another&nbsp;interesting&nbsp;thing&nbsp;is&nbsp;that&nbsp;this&nbsp;exact&nbsp;code&nbsp;works&nbsp;unchanged&nbsp;on&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;much&nbsp;older,&nbsp;slower&nbsp;Pentium&nbsp;IV&nbsp;2ghz,&nbsp;2gig&nbsp;ram&nbsp;on&nbsp;windows&nbsp;xp&nbsp;pro&nbsp;vs.&lt;br&gt;<br>
&amp;gt;&nbsp;windows&nbsp;server&nbsp;2003&nbsp;enterprise&nbsp; sp2...&nbsp;quad&nbsp;core&nbsp;xeon,&nbsp;4gig,&nbsp;etc...&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;If&nbsp;it&nbsp;is&nbsp;socket&nbsp;exhaustion&nbsp;you&amp;#39;re&nbsp;seeing,&nbsp;one&nbsp;possible&nbsp;explanation&nbsp;for&lt;br&gt;<br>
the&nbsp;slower&nbsp;machine&nbsp;working&nbsp;better&nbsp;is&nbsp;that&nbsp;it&nbsp;gives&nbsp;the&nbsp;TCP&nbsp;timeouts&lt;br&gt;<br>
longer&nbsp;to&nbsp;run,&nbsp;so&nbsp;sockets&nbsp;are&nbsp;getting&nbsp;recycled&nbsp;&amp;quot;faster&amp;quot;&nbsp;from&nbsp;the&lt;br&gt;<br>
point-of-view&nbsp;of&nbsp;the&nbsp;slower&nbsp;socket-requiring&nbsp;code.&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&nbsp; Tony&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;--&lt;br&gt;<br>
 [][][]&nbsp;Tony&nbsp;Garnock-Jones&nbsp; &nbsp; &nbsp;|&nbsp;Mob:&nbsp;+44&nbsp;(0)7905&nbsp;974&nbsp;211&lt;br&gt;<br>
&nbsp; &nbsp;[][]&nbsp;LShift&nbsp;Ltd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp;Tel:&nbsp;+44&nbsp;(0)20&nbsp;7729&nbsp;7060&lt;br&gt;<br>
 []&nbsp; []&nbsp;&lt;a&nbsp;href=&quot;http://www.lshift.net/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.lshift.net/&lt;/a&gt;&nbsp;|&nbsp;Email:&nbsp;&lt;a&nbsp;href=&quot;mailto:tonyg@lshift.net&quot;&gt;tonyg@lshift.net&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
