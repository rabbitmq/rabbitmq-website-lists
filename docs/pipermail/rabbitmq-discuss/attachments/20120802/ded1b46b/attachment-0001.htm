<tt>
Hi&nbsp;Tim,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&nbsp;I&nbsp;found&nbsp;the&nbsp;heartbeat&nbsp;property&nbsp;on&nbsp;the&nbsp;connection&nbsp;class.&nbsp;connectionFactory.RequestedHeartbeat&amp;nbsp;&amp;nbsp;&nbsp;I&nbsp;didn't&nbsp;realize&nbsp;it&nbsp;was&nbsp;default&nbsp;off&nbsp;(0)&nbsp;and&nbsp;will&nbsp;test&nbsp;with&nbsp;a&nbsp;value.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Mark&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Verdana,&nbsp;Geneva,&nbsp;Helvetica,&nbsp;Arial,&nbsp;sans-serif;&nbsp;&quot;&gt;Hi&nbsp;Mark,&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Verdana,&nbsp;Geneva,&nbsp;Helvetica,&nbsp;Arial,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Verdana,&nbsp;Geneva,&nbsp;Helvetica,&nbsp;Arial,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Verdana,&nbsp;Geneva,&nbsp;Helvetica,&nbsp;Arial,&nbsp;sans-serif;&nbsp;&quot;&gt;You&nbsp;should&nbsp;try&nbsp;enabling&nbsp;AMQP&nbsp;heartbeats,&nbsp;as&nbsp;this&nbsp;should&nbsp;resolve&nbsp;the&nbsp;issue&nbsp;of&nbsp;detecting&nbsp;the&nbsp;connection&nbsp;is&nbsp;being&nbsp;closed.&amp;nbsp;&lt;/span&gt;&amp;nbsp;&lt;br&gt;&lt;br&gt;On&nbsp;Thursday,&nbsp;August&nbsp;2,&nbsp;2012&nbsp;9:58:51&nbsp;AM&nbsp;UTC-5,&nbsp;Mark&nbsp;Ward&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0;margin-left:&nbsp;0.8ex;border-left:&nbsp;1px&nbsp;#ccc&nbsp;solid;padding-left:&nbsp;1ex;&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;performing&nbsp;tests&nbsp;to&nbsp;a&nbsp;server&nbsp;across&nbsp;the&nbsp;internet.&nbsp;&amp;nbsp;During&nbsp;the&nbsp;night&nbsp;our&nbsp;firewall&nbsp;is&nbsp;rebooted&nbsp;and&nbsp;it&nbsp;appears&nbsp;the&nbsp;basic&nbsp;consumer&nbsp;is&nbsp;not&nbsp;detecting&nbsp;this&nbsp;and&nbsp;does&nbsp;not&nbsp;throw&nbsp;any&nbsp;exceptions&nbsp;on&nbsp;the&nbsp;connection.&nbsp;&amp;nbsp;When&nbsp;I&nbsp;arrive&nbsp;to&nbsp;the&nbsp;office&nbsp;each&nbsp;morning&nbsp;the&nbsp;subscriber&nbsp;client&nbsp;is&nbsp;still&nbsp;running&nbsp;and&nbsp;in&nbsp;the&nbsp;block&nbsp;state&nbsp;waiting&nbsp;for&nbsp;a&nbsp;message.&nbsp;&amp;nbsp;If&nbsp;I&nbsp;send&nbsp;messages&nbsp;to&nbsp;the&nbsp;server&nbsp;the&nbsp;client&nbsp;will&nbsp;not&nbsp;receive&nbsp;messages&nbsp;unless&nbsp;I&nbsp;restart&nbsp;the&nbsp;client.&nbsp;&amp;nbsp;The&nbsp;client&nbsp;works&nbsp;all&nbsp;day&nbsp;long&nbsp;as&nbsp;I&nbsp;push&nbsp;millions&nbsp;of&nbsp;messages&nbsp;through&nbsp;for&nbsp;testing.&nbsp;&amp;nbsp;It&nbsp;is&nbsp;after&nbsp;the&nbsp;firewall&nbsp;reset&nbsp;that&nbsp;the&nbsp;client&nbsp;does&nbsp;not&nbsp;continue&nbsp;to&nbsp;work&nbsp;or&nbsp;fail&nbsp;out.&nbsp;&amp;nbsp;This&nbsp;does&nbsp;appear&nbsp;to&nbsp;be&nbsp;a&nbsp;repeatable&nbsp;issue&nbsp;for&nbsp;the&nbsp;past&nbsp;two&nbsp;days&nbsp;it&nbsp;has&nbsp;performed&nbsp;this&nbsp;same&nbsp;issue.&nbsp;&amp;nbsp;I&nbsp;am&nbsp;going&nbsp;to&nbsp;continue&nbsp;tonight&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;repeats.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;something&nbsp;I&nbsp;need&nbsp;to&nbsp;enable&nbsp;to&nbsp;have&nbsp;the&nbsp;client&nbsp;detect&nbsp;the&nbsp;connection&nbsp;closure?&nbsp;&amp;nbsp;The&nbsp;testing&nbsp;I&nbsp;have&nbsp;manually&nbsp;performed&nbsp;on&nbsp;closing&nbsp;the&nbsp;network&nbsp;connection,&nbsp;shutting&nbsp;down&nbsp;the&nbsp;server,&nbsp;restarting&nbsp;the&nbsp;server&nbsp;have&nbsp;all&nbsp;caused&nbsp;the&nbsp;client&nbsp;to&nbsp;properly&nbsp;throw&nbsp;and&nbsp;exception&nbsp;that&nbsp;the&nbsp;connection&nbsp;was&nbsp;closed.&nbsp;&amp;nbsp;It&nbsp;is&nbsp;only&nbsp;when&nbsp;the&nbsp;firewall&nbsp;resets&nbsp;that&nbsp;the&nbsp;client&nbsp;does&nbsp;not&nbsp;detect&nbsp;the&nbsp;failed&nbsp;connection.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;the&nbsp;.NET&nbsp;client&nbsp;connecting&nbsp;to&nbsp;the&nbsp;port&nbsp;5672.&nbsp;&amp;nbsp;It&nbsp;is&nbsp;not&nbsp;using&nbsp;SSL.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;below&nbsp;is&nbsp;the&nbsp;example&nbsp;code&nbsp;I&nbsp;am&nbsp;working&nbsp;with.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;var&nbsp;connectionFactory&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;connectionFactory.HostName&nbsp;=&nbsp;hostName;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;connectionFactory.Port&nbsp;=&nbsp;port;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;IConnection&nbsp;connection&nbsp;=&nbsp;connectionFactory.&lt;wbr&gt;CreateConnection();&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;IModel&nbsp;channel&nbsp;=&nbsp;connection.CreateModel();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;QueueingBasicConsumer&nbsp;consumer&nbsp;=&nbsp;new&nbsp;QueueingBasicConsumer(channel)&lt;wbr&gt;;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;String&nbsp;consumer_tag&nbsp;=&nbsp;channel.BasicConsume(&quot;&lt;wbr&gt;QueueOne&quot;,&nbsp;false,&nbsp;consumer);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;ctrl+c&nbsp;to&nbsp;exit&quot;);&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;while&nbsp;(true)&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;{&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;BasicDeliverEventArgs&nbsp;evt_args&nbsp;=&nbsp;(BasicDeliverEventArgs)&lt;wbr&gt;consumer.Queue.Dequeue();&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;IBasicProperties&nbsp;msg_props&nbsp;=&nbsp;evt_args.BasicProperties;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;string&nbsp;message&nbsp;=&nbsp;Encoding.UTF8.GetString(evt_&lt;wbr&gt;args.Body);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;channel.BasicAck(evt_args.&lt;wbr&gt;DeliveryTag,&nbsp;false);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;Console.WriteLine(&quot;Message&nbsp;Body:&nbsp;&quot;&nbsp;+&nbsp;message);&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;channel.Close();&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;connection.Close();&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;
</tt>
