<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;Matthias,&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&quot;&gt;&amp;gt;&nbsp;That&nbsp;is&nbsp;expected.&nbsp;When&nbsp;clients&nbsp;are&nbsp;publishing&nbsp;at&nbsp;a&nbsp;higher&nbsp;rate&nbsp;than&nbsp;the&nbsp;broker&nbsp;can&nbsp;write&nbsp;to&nbsp;disk,&nbsp;and&nbsp;consumers&nbsp;aren't&nbsp;draining&nbsp;the&nbsp;queues,&nbsp;then&nbsp;eventually&nbsp;rabbit&nbsp;will&nbsp;have&nbsp;to&nbsp;pause&nbsp;producers&nbsp;so&nbsp;it&nbsp;can&nbsp;page&nbsp;messages&nbsp;to&nbsp;disk&nbsp;and&nbsp;free&nbsp;up&nbsp;some&nbsp;memory.&lt;br&gt;&lt;br&gt;i&nbsp;was&nbsp;able&nbsp;to&nbsp;increase&nbsp;the&nbsp;memory_high_watermark&nbsp;to&nbsp;0.8&nbsp;(6.4GB)&nbsp;and&nbsp;got&nbsp;50&nbsp;MB/sec&nbsp;publish&nbsp;rate&nbsp;all&nbsp;the&nbsp;way&nbsp;to&nbsp;200&nbsp;GB&nbsp;messages&nbsp;stored.&amp;nbsp;&nbsp;the&nbsp;broker&nbsp;used&nbsp;5.9&nbsp;GB&nbsp;and&nbsp;there&nbsp;was&nbsp;no&nbsp;throttling&nbsp;on&nbsp;publishers.&amp;nbsp;&amp;nbsp;&nbsp;However,&nbsp;when&nbsp;i&nbsp;started&nbsp;1000&nbsp;consumers,&nbsp;the&nbsp;same&nbsp;old&nbsp;errors&nbsp;happen&nbsp;again&nbsp;as&nbsp;described&nbsp;in&nbsp;my&nbsp;first&nbsp;email:&amp;nbsp;&nbsp;lots&nbsp;of&nbsp;consumers&nbsp;got&nbsp;errors&nbsp;on&nbsp;login&nbsp;or<br>
&nbsp;basic_consume:&lt;br&gt;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008420.html&lt;br&gt;&lt;br&gt;i&nbsp;am&nbsp;using&nbsp;erlang&nbsp;R14B&nbsp;for&nbsp;this&nbsp;test.&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;That&nbsp;threshold&nbsp;setting&nbsp;via&nbsp;vm_memory_high_watermark&nbsp;definitely&nbsp;still&nbsp;works&nbsp;in&nbsp;2.1.1.&lt;br&gt;&lt;br&gt;yes&nbsp;it&nbsp;works.&amp;nbsp;&nbsp;my&nbsp;/etc/rabbitmq/rabbitmq.config&nbsp;was&nbsp;a&nbsp;symlink&nbsp;instead&nbsp;of&nbsp;a&nbsp;regular&nbsp;file.&amp;nbsp;&nbsp;rabbitmq-server&nbsp;script&nbsp;uses&nbsp;-f&nbsp;instead&nbsp;of&nbsp;-e&nbsp;to&nbsp;check&nbsp;file&nbsp;exist,&nbsp;so&nbsp;it&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;symlink.&lt;br&gt;&lt;br&gt;thanks.&lt;br&gt;&lt;br&gt;-alex&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;&lt;/html&gt;
</tt>
