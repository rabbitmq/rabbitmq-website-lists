<tt>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;Incidentally,&nbsp;we&nbsp;figured&nbsp;out&nbsp;what&nbsp;the&nbsp;problem&nbsp;is.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;seems&nbsp;that&nbsp;when&nbsp;the&nbsp;watermark&nbsp;checking&nbsp;was&nbsp;added&nbsp;in&nbsp;RabbitMQ&nbsp;2.8.1,&nbsp;there&nbsp;was&nbsp;a&nbsp;feature&nbsp;that&nbsp;was&nbsp;added&nbsp;that&nbsp;basically&nbsp;blocks&nbsp;all&nbsp;currently-open&nbsp;connections&nbsp;until&nbsp;the&nbsp;watermark&nbsp;thresholds&nbsp;are&nbsp;cleared.&nbsp;What&nbsp;was&nbsp;happening&nbsp;on&nbsp;our&nbsp;build&nbsp;servers&nbsp;is&nbsp;that&nbsp;the&nbsp;test&nbsp;instance&nbsp;of&nbsp;RabbitMQ&nbsp;was&nbsp;just&nbsp;barely&nbsp;crossing&nbsp;the&nbsp;disk&nbsp;watermark&nbsp;threshold&nbsp;to&nbsp;where&nbsp;the&nbsp;MQ&nbsp;server&nbsp;started&nbsp;blocking&nbsp;connections.&nbsp;This&nbsp;would&nbsp;happen&nbsp;intermittently,&nbsp;depending&nbsp;on&nbsp;which&nbsp;side&nbsp;of&nbsp;the&nbsp;watermark&nbsp;the&nbsp;free&nbsp;disk&nbsp;space&nbsp;was&nbsp;at.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;seems&nbsp;that&nbsp;the&nbsp;connection&nbsp;blocking,&nbsp;in&nbsp;turn,&nbsp;&lt;i&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;also&lt;/i&gt;&amp;nbsp;blocks&nbsp;close&nbsp;requests&nbsp;from&nbsp;being&nbsp;ack'd!&nbsp;This&nbsp;certainly&nbsp;seems&nbsp;like&nbsp;a&nbsp;bug&nbsp;to&nbsp;me&nbsp;â€“&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;why&nbsp;the&nbsp;server&nbsp;should&nbsp;deny&nbsp;already-connected&nbsp;clients&nbsp;the&nbsp;ability&nbsp;to&nbsp;close&nbsp;their&nbsp;connections.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;any&nbsp;rate,&nbsp;I&nbsp;wanted&nbsp;to&nbsp;post&nbsp;to&nbsp;this&nbsp;thread&nbsp;in&nbsp;case&nbsp;anyone&nbsp;else&nbsp;ran&nbsp;into&nbsp;this&nbsp;error.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sankalp&nbsp;Acharya&lt;/div&gt;&lt;div&gt;WhaleShark&nbsp;Media&lt;br&gt;&lt;br&gt;On&nbsp;Friday,&nbsp;January&nbsp;11,&nbsp;2013&nbsp;3:58:31&nbsp;PM&nbsp;UTC-6,&nbsp;Sankalp&nbsp;Acharya&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0;margin-left:&nbsp;0.8ex;border-left:&nbsp;1px&nbsp;#ccc&nbsp;solid;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;are&nbsp;seeing&nbsp;this&nbsp;same&nbsp;exact&nbsp;behavior,&nbsp;but&nbsp;on&nbsp;a&nbsp;newer&nbsp;version&nbsp;of&nbsp;RabbitMQ&nbsp;(2.8.2).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What's&nbsp;strange&nbsp;is&nbsp;that&nbsp;the&nbsp;problem&nbsp;had&nbsp;not&nbsp;been&nbsp;occurring&nbsp;until&nbsp;recently.&nbsp;We&nbsp;are&nbsp;also&nbsp;using&nbsp;Spring&nbsp;AMQP&nbsp;(1.1.3),&nbsp;and&nbsp;we&nbsp;have&nbsp;virtually&nbsp;the&nbsp;same&nbsp;use&nbsp;case&nbsp;(running&nbsp;from&nbsp;unit&nbsp;tests,&nbsp;the&nbsp;test&nbsp;tries&nbsp;to&nbsp;wind&nbsp;down,&nbsp;and&nbsp;on&nbsp;disposing&nbsp;the&nbsp;Spring&nbsp;context,&nbsp;it&nbsp;tries&nbsp;to&nbsp;close&nbsp;the&nbsp;CachingConnectionFactory,&nbsp;upon&nbsp;which&nbsp;we&nbsp;are&nbsp;trying&nbsp;to&nbsp;close&nbsp;the&nbsp;connection&nbsp;to&nbsp;RabbitMQ,&nbsp;etc.)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;something&nbsp;else&nbsp;we&nbsp;are&nbsp;missing,&nbsp;that&nbsp;we&nbsp;need&nbsp;to&nbsp;do&nbsp;(either&nbsp;in&nbsp;the&nbsp;configuration&nbsp;of&nbsp;our&nbsp;CachingConnectionFactory,&nbsp;or&nbsp;in&nbsp;the&nbsp;rest&nbsp;of&nbsp;our&nbsp;Spring&nbsp;wireup)&nbsp;in&nbsp;order&nbsp;to&nbsp;not&nbsp;run&nbsp;into&nbsp;this&nbsp;issue?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Sankalp&nbsp;Acharya&lt;/div&gt;&lt;div&gt;WhaleShark&nbsp;Media&lt;/div&gt;&lt;div&gt;&lt;br&gt;On&nbsp;Wednesday,&nbsp;March&nbsp;7,&nbsp;2012&nbsp;9:11:45&nbsp;AM&nbsp;UTC-6,&nbsp;Simon&nbsp;MacMullen&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0;margin-left:0.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;07/03/12&nbsp;14:41,&nbsp;Benjamin&nbsp;Bennett&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Just&nbsp;wondering&nbsp;if&nbsp;this&nbsp;has&nbsp;been&nbsp;fixed&nbsp;in&nbsp;the&nbsp;latest&nbsp;releases?&lt;p&gt;Yes,&nbsp;it&nbsp;was&nbsp;fixed&nbsp;in&nbsp;2.7.1.&lt;/p&gt;&lt;p&gt;Cheers,&nbsp;Simon&lt;/p&gt;&lt;p&gt;--&nbsp;&lt;br&gt;Simon&nbsp;MacMullen&lt;br&gt;RabbitMQ,&nbsp;VMware&lt;br&gt;______________________________&lt;wbr&gt;_________________&lt;br&gt;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&gt;rabbitmq...@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/&lt;wbr&gt;cgi-bin/mailman/listinfo/&lt;wbr&gt;rabbitmq-discuss&lt;/a&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;
</tt>
