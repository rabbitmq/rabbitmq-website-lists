<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:#000;&nbsp;background-color:#fff;&nbsp;font-family:HelveticaNeue,&nbsp;Helvetica&nbsp;Neue,&nbsp;Helvetica,&nbsp;Arial,&nbsp;Lucida&nbsp;Grande,&nbsp;Sans-Serif;font-size:12pt&quot;&gt;&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;HelveticaNeue,&nbsp;'Helvetica&nbsp;Neue',&nbsp;Helvetica,&nbsp;Arial,&nbsp;'Lucida&nbsp;Grande',&nbsp;sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;Trying&nbsp;to&nbsp;setup&nbsp;rabbit&nbsp;stomp&nbsp;with&nbsp;SSL&nbsp;using&nbsp;existing&nbsp;certificate&nbsp;but&nbsp;keep&nbsp;getting&nbsp;errors.&nbsp;I&nbsp;am&nbsp;using&nbsp;Erlang&amp;nbsp;R14B&nbsp;and&nbsp;RabbitMQ&amp;nbsp;3.1.5.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;HelveticaNeue,&nbsp;'Helvetica&nbsp;Neue',&nbsp;Helvetica,&nbsp;Arial,&nbsp;'Lucida&nbsp;Grande',&nbsp;sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;HelveticaNeue,&nbsp;'Helvetica&nbsp;Neue',&nbsp;Helvetica,&nbsp;Arial,&nbsp;'Lucida&nbsp;Grande',&nbsp;sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;My&nbsp;rabbit&nbsp;config&nbsp;is<br>
&nbsp;following:&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;[&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;{rabbitmq_stomp,&nbsp;[&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;{ssl_listeners,&nbsp;[61614]},&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;{ssl_options,&nbsp;[{cacertfile,&quot;/tmp/ssl/certs/ca.pem&quot;},&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;{certfile,&quot;/tmp/ssl/certs/hostA.pem&quot;},&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;{keyfile,&quot;/tmp/ssl/private_keys/hostA.pem&quot;},&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;{verify,verify_peer},&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;{fail_if_no_peer_cert,false}]}&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span<br>
&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&amp;nbsp;&nbsp;]}&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;].&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;doing&nbsp;basic&nbsp;connection&nbsp;test&nbsp;using&nbsp;openssl&nbsp;s_client&nbsp;I&nbsp;get&nbsp;following:&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;openssl&nbsp;s_client&nbsp;-connect&nbsp;localhost:61614&nbsp;-cert&nbsp;/tmp/ssl/certs/hostA.pem&nbsp;-key&nbsp;/tmp/ssl/private_keys/hostA.pem&nbsp;-CAfile&nbsp;/tmp/ssl/certs/ca.pem&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;CONNECTED(00000003)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,<br>
&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;139852982814536:error:14094438:SSL&nbsp;routines:SSL3_READ_BYTES:tlsv1&nbsp;alert&nbsp;internal&nbsp;error:s3_pkt.c:1197:SSL&nbsp;alert&nbsp;number&nbsp;80&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;139852982814536:error:140790E5:SSL&nbsp;routines:SSL23_WRITE:ssl&nbsp;handshake&nbsp;failure:s23_lib.c:184:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;---&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;no&nbsp;peer&nbsp;certificate&nbsp;available&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;small;&quot;&gt;---&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;No&nbsp;client&nbsp;certificate&nbsp;CA&nbsp;names&nbsp;sent&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Rabbit&nbsp;log&nbsp;shows<br>
&nbsp;following&nbsp;error:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;=CRASH&nbsp;REPORT====&nbsp;14-Nov-2013::02:09:18&nbsp;===&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;crasher:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;initial&nbsp;call:&nbsp;rabbit_stomp_reader:init/2&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;pid:&nbsp;&amp;lt;0.328.0&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;registered_name:&nbsp;[]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;exception&nbsp;error:&nbsp;no&nbsp;match&nbsp;of&nbsp;right&nbsp;hand&nbsp;side<br>
&nbsp;value&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;{error,{ssl_upgrade_error,&quot;internal&nbsp;error&quot;}}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;in&nbsp;function&nbsp;&amp;nbsp;rabbit_stomp_reader:init/2&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;ancestors:&nbsp;[&amp;lt;0.327.0&amp;gt;,rabbit_stomp_client_sup_sup,rabbit_stomp_sup,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;lt;0.287.0&amp;gt;]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;<br>
&nbsp;messages:&nbsp;[]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;links:&nbsp;[&amp;lt;0.327.0&amp;gt;]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;dictionary:&nbsp;[]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;trap_exit:&nbsp;false&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;status:&nbsp;running&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;heap_size:&nbsp;377&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;stack_size:&nbsp;24&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,<br>
&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;reductions:&nbsp;852&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'Courier&nbsp;New',&nbsp;courier,&nbsp;monaco,&nbsp;monospace,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&amp;nbsp;&nbsp;neighbours:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Note&nbsp;the&nbsp;certificates&nbsp;are&nbsp;correct/valid&nbsp;and&nbsp;I&nbsp;am&nbsp;perfectly&nbsp;able&nbsp;to&nbsp;establish&nbsp;SSL&nbsp;connection&nbsp;with&nbsp;them&nbsp;using&nbsp;openssl&nbsp;s_server&nbsp;+&nbsp;s_client.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;idea&nbsp;what's&nbsp;wrong?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Antony.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
