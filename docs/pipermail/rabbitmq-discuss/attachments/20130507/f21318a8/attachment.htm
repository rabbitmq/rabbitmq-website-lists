<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;&lt;div&gt;No&nbsp;problem&nbsp;-&nbsp;if&nbsp;you&nbsp;need&nbsp;to&nbsp;alleviate&nbsp;this&nbsp;then&nbsp;AMQP&nbsp;heartbeats&nbsp;can&nbsp;ensure&nbsp;client&nbsp;and&nbsp;broker&nbsp;notice&nbsp;a&nbsp;downed&nbsp;peer&nbsp;in&nbsp;a&nbsp;more&nbsp;timely&nbsp;fashion.&lt;br&gt;&lt;br&gt;Cheers,&lt;/div&gt;&lt;div&gt;Tim&lt;/div&gt;&lt;div&gt;&lt;br&gt;On&nbsp;7&nbsp;May&nbsp;2013,&nbsp;at&nbsp;08:04,&nbsp;carlhoerberg&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:carl.hoerberg@gmail.com&quot;&gt;carl.hoerberg@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Ok,&nbsp;yes,&nbsp;suspected&nbsp;it&nbsp;had&nbsp;with&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;underlaying&nbsp;TCP&nbsp;stack,&nbsp;thank&nbsp;you&nbsp;for&nbsp;the&nbsp;detailed&nbsp;explanation!&nbsp;<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;On&nbsp;Tuesday&nbsp;7&nbsp;May&nbsp;2013&nbsp;at&nbsp;14:58,&nbsp;Tim&nbsp;Watson-6&nbsp;[via&nbsp;RabbitMQ]&nbsp;wrote:<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;shrinkable-quote&quot;&gt;&lt;br&gt;&amp;gt;&nbsp;Hi,&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;On&nbsp;7&nbsp;May&nbsp;2013,&nbsp;at&nbsp;04:32,&nbsp;carlhoerberg&nbsp;wrote:&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;It&nbsp;looks&nbsp;like&nbsp;the&nbsp;rabbitmq&nbsp;java&nbsp;client&nbsp;doesn't&nbsp;raise&nbsp;an&nbsp;exception&nbsp;as&nbsp;soon&nbsp;as&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;a&nbsp;connection&nbsp;fails,&nbsp;eg.&nbsp;due&nbsp;to&nbsp;network&nbsp;cable&nbsp;disconnection.&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;The&nbsp;following&nbsp;code&nbsp;will&nbsp;continue&nbsp;to&nbsp;run&nbsp;for&nbsp;2&nbsp;minutes&nbsp;after&nbsp;the&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;disconnection,&nbsp;and&nbsp;first&nbsp;then&nbsp;raise&nbsp;an&nbsp;exception.&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;That's&nbsp;perfectly&nbsp;normal,&nbsp;for&nbsp;a&nbsp;network&nbsp;driven&nbsp;application.&nbsp;It&nbsp;is&nbsp;not&nbsp;RabbitMQ's&nbsp;client&nbsp;library&nbsp;that&nbsp;wait's&nbsp;to&nbsp;throw&nbsp;an&nbsp;exception,&nbsp;but&nbsp;rather&nbsp;it&nbsp;is&nbsp;the&nbsp;operating&nbsp;system's&nbsp;network&nbsp;stack&nbsp;that&nbsp;takes&nbsp;time&nbsp;to&nbsp;determine&nbsp;that&nbsp;a&nbsp;peer&nbsp;socket&nbsp;is&nbsp;no&nbsp;longer&nbsp;available.&nbsp;This&nbsp;can&nbsp;take&nbsp;many&nbsp;minutes,&nbsp;even&nbsp;when&nbsp;you're&nbsp;connecting&nbsp;via&nbsp;the&nbsp;loopback&nbsp;interface&nbsp;(i.e.,&nbsp;localhost)&nbsp;for&nbsp;testing.&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;On&nbsp;most&nbsp;unices,&nbsp;the&nbsp;relevant&nbsp;bits&nbsp;of&nbsp;`man&nbsp;tcp`&nbsp;are:&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&quot;When&nbsp;a&nbsp;network&nbsp;error&nbsp;occurs,&nbsp;TCP&nbsp;tries&nbsp;to&nbsp;resend&nbsp;the&nbsp;packet.&nbsp;If&nbsp;it&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;doesn't&nbsp;succeed&nbsp;after&nbsp;some&nbsp;time,&nbsp;either&nbsp;ETIMEDOUT&nbsp;or&nbsp;the&nbsp;last&nbsp;received&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;error&nbsp;on&nbsp;this&nbsp;connection&nbsp;is&nbsp;reported.&quot;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;In&nbsp;that&nbsp;second&nbsp;sentence,&nbsp;&quot;after&nbsp;some&nbsp;time&quot;&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;OS&nbsp;kernel&nbsp;configured&nbsp;limits,&nbsp;viz&nbsp;tcp_retries1&nbsp;(defaults&nbsp;to&nbsp;3&nbsp;on&nbsp;linux)&nbsp;and&nbsp;tcp_retries2,&nbsp;and&nbsp;the&nbsp;configured&nbsp;retransmission&nbsp;timeout.&nbsp;Of&nbsp;course&nbsp;there&nbsp;are&nbsp;doubtless&nbsp;other&nbsp;parameters&nbsp;that&nbsp;interact&nbsp;with&nbsp;this&nbsp;behaviour.&nbsp;So&nbsp;you're&nbsp;quite&nbsp;lucky&nbsp;because&nbsp;it's&nbsp;a&nbsp;producer&nbsp;application&nbsp;that's&nbsp;trying&nbsp;to&nbsp;send&nbsp;-&nbsp;those&nbsp;time&nbsp;out&nbsp;much&nbsp;faster.&nbsp;For&nbsp;network&nbsp;consumer&nbsp;applications,&nbsp;this&nbsp;problem&nbsp;is&nbsp;quite&nbsp;a&nbsp;tricky&nbsp;on&nbsp;because&nbsp;the&nbsp;default&nbsp;settings&nbsp;on&nbsp;linux&nbsp;for&nbsp;example,&nbsp;mean&nbsp;delays&nbsp;of&nbsp;between&nbsp;10&nbsp;and&nbsp;30&nbsp;minutes&nbsp;before&nbsp;the&nbsp;OS&nbsp;networking&nbsp;layer&nbsp;&quot;notices&quot;&nbsp;the&nbsp;connection&nbsp;has&nbsp;timed&nbsp;out.&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;This&nbsp;problem&nbsp;is,&nbsp;of&nbsp;course,&nbsp;not&nbsp;specific&nbsp;to&nbsp;RabbitMQ.&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;Cheers,&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;Tim&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;_______________________________________________&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;[hidden&nbsp;email]&nbsp;(/user/SendEmail.jtp?type=node&amp;amp;node=26470&amp;amp;i=0)&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;If&nbsp;you&nbsp;reply&nbsp;to&nbsp;this&nbsp;email,&nbsp;your&nbsp;message&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;discussion&nbsp;below:&nbsp;&lt;a&nbsp;href=&quot;http://rabbitmq.1065348.n5.nabble.com/Java-client-closed-connection-doesn-t-raise-exception-immediately-tp26465p26470.html&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;http://rabbitmq.1065348.n5.nabble.com/Java-client-closed-connection-doesn-t-raise-exception-immediately-tp26465p26470.html&lt;/a&gt;&amp;nbsp;<br>
&lt;br&gt;&amp;gt;&nbsp;To&nbsp;unsubscribe&nbsp;from&nbsp;Java&nbsp;client:&nbsp;closed&nbsp;connection&nbsp;doesn't&nbsp;raise&nbsp;exception&nbsp;immediately,&nbsp;click&nbsp;here&nbsp;(&lt;a&nbsp;href=&quot;&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;<br>
&lt;br&gt;&amp;gt;&nbsp;NAML&nbsp;(&lt;/a&gt;&lt;a&nbsp;href=&quot;http://rabbitmq.1065348.n5.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;amp;id=instant_html%21nabble%3Aemail.naml&amp;amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml&quot;&nbsp;target=&quot;_top&quot;&nbsp;rel=&quot;nofollow&quot;&nbsp;link=&quot;external&quot;&gt;http://rabbitmq.1065348.n5.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&amp;amp;id=instant_html%21nabble%3Aemail.naml&amp;amp;base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&amp;amp;breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml&lt;/a&gt;)&nbsp;<br>
&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>
<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&lt;br&gt;&lt;hr&nbsp;align=&quot;left&quot;&nbsp;width=&quot;300&quot;&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://rabbitmq.1065348.n5.nabble.com/Java-client-closed-connection-doesn-t-raise-exception-immediately-tp26465p26472.html&quot;&gt;Re:&nbsp;Java&nbsp;client:&nbsp;closed&nbsp;connection&nbsp;doesn't&nbsp;raise&nbsp;exception&nbsp;immediately&lt;/a&gt;&lt;br&gt;<br>
Sent&nbsp;from&nbsp;the&nbsp;&lt;a&nbsp;href=&quot;http://rabbitmq.1065348.n5.nabble.com/&quot;&gt;RabbitMQ&nbsp;mailing&nbsp;list&nbsp;archive&lt;/a&gt;&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;http://Nabble.com&quot;&gt;Nabble.com&lt;/a&gt;.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;span&gt;_______________________________________________&lt;/span&gt;&lt;br&gt;&lt;span&gt;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;/span&gt;&lt;br&gt;&lt;span&gt;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;/span&gt;&lt;br&gt;&lt;span&gt;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
