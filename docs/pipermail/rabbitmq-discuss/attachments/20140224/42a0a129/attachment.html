<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;Hi&nbsp;RabbitMQ&nbsp;Discuss,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;problem&nbsp;with&nbsp;my&nbsp;client&nbsp;application,&nbsp;using&nbsp;the&nbsp;3.2.2&nbsp;Java&nbsp;library.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Multiple&nbsp;calls&nbsp;made&nbsp;to&nbsp;'RPC’&nbsp;methods,&nbsp;such&nbsp;as&nbsp;&lt;font&nbsp;face=&quot;Monaco&quot;&gt;exchangeDeclare&lt;/font&gt;&nbsp;block&nbsp;(interminably)&nbsp;if&nbsp;the&nbsp;call&nbsp;is&nbsp;made&nbsp;while&nbsp;the&nbsp;connection&nbsp;is&nbsp;down,&nbsp;but&nbsp;before&nbsp;it&nbsp;times&nbsp;out.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;From&nbsp;my&nbsp;basic&nbsp;understanding,&nbsp;it&nbsp;looks&nbsp;like&nbsp;AMQChannel&nbsp;blocks&nbsp;incoming&nbsp;‘RPC’&nbsp;methods&nbsp;using&nbsp;.&lt;font&nbsp;face=&quot;Monaco&quot;&gt;wait&lt;/font&gt;&nbsp;in&nbsp;&lt;font&nbsp;face=&quot;Monaco&quot;&gt;enqueueRpc&lt;/font&gt;.&nbsp;When&nbsp;a&nbsp;&lt;font&nbsp;face=&quot;Monaco&quot;&gt;ShutdownSignalException&lt;/font&gt;&nbsp;comes&nbsp;in&nbsp;via&nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;Monaco;&nbsp;font-size:&nbsp;11px;&quot;&gt;processShutdownSignal&lt;/span&gt;,&nbsp;it&nbsp;clears&nbsp;only&nbsp;one&nbsp;of&nbsp;the&nbsp;‘next’&nbsp;RPC&nbsp;calls&nbsp;waiting&nbsp;because,&nbsp;even&nbsp;though&nbsp;notifyAll&nbsp;is&nbsp;used,&nbsp;the&nbsp;while&nbsp;loop&nbsp;containing&nbsp;the&nbsp;.&lt;font&nbsp;face=&quot;Monaco&quot;&gt;wait&lt;/font&gt;&nbsp;will&nbsp;only&nbsp;be&nbsp;cleared&nbsp;by&nbsp;one&nbsp;of&nbsp;the&nbsp;incoming&nbsp;threads?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;situation&nbsp;is&nbsp;only&nbsp;apparent&nbsp;for&nbsp;my&nbsp;application&nbsp;during&nbsp;a&nbsp;ConnectionTimeout,&nbsp;which&nbsp;I&nbsp;haven’t&nbsp;been&nbsp;able&nbsp;to&nbsp;simulate&nbsp;in&nbsp;a&nbsp;controlled&nbsp;manner.&nbsp;For&nbsp;testing&nbsp;connection&nbsp;failures,&nbsp;I&nbsp;use&nbsp;a&nbsp;script&nbsp;which&nbsp;makes&nbsp;and&nbsp;breaks&nbsp;a&nbsp;proxy&nbsp;to&nbsp;the&nbsp;real&nbsp;server&nbsp;(mkfifo&nbsp;backpipe&nbsp;&amp;&amp;&nbsp;nc&nbsp;-l&nbsp;5672&nbsp;&lt;&nbsp;backpipe&nbsp;|&nbsp;nc&nbsp;realserver&nbsp;5672&nbsp;&gt;&nbsp;backpipe),&nbsp;but&nbsp;this&nbsp;results&nbsp;in&nbsp;immediate&nbsp;connection&nbsp;failure&nbsp;which&nbsp;is&nbsp;not&nbsp;(so)&nbsp;susceptible&nbsp;to&nbsp;this&nbsp;problem&nbsp;as&nbsp;the&nbsp;exchangeDeclares&nbsp;are&nbsp;rejected&nbsp;before&nbsp;blocking.&nbsp;I&nbsp;wonder&nbsp;if&nbsp;anyone&nbsp;has&nbsp;a&nbsp;method&nbsp;for&nbsp;simulating&nbsp;connection&nbsp;timeouts?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Very&nbsp;best,&nbsp;Dan.&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
