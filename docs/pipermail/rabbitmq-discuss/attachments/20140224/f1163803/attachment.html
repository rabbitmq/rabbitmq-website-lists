<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hi&nbsp;Simon,&lt;br&gt;&lt;/div&gt;When&nbsp;using&nbsp;Federation&nbsp;queues&nbsp;for&nbsp;all&nbsp;queues&nbsp;in&nbsp;our&nbsp;3&nbsp;brokers&nbsp;environment,&nbsp;we&nbsp;met&nbsp;a&nbsp;performance&nbsp;issue.&nbsp;I&nbsp;know&nbsp;we&nbsp;can&nbsp;set&nbsp;less&nbsp;queues&nbsp;to&nbsp;use&nbsp;the&nbsp;feature,&nbsp;but&nbsp;I&nbsp;want&nbsp;to&nbsp;check&nbsp;with&nbsp;you&nbsp;if&nbsp;there&nbsp;is&nbsp;possibility&nbsp;for&nbsp;optimize&nbsp;federation.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;&lt;/div&gt;The&nbsp;3&nbsp;brokers&nbsp;are&nbsp;federation&nbsp;queues&nbsp;each&nbsp;other&nbsp;and&nbsp;when&nbsp;we&nbsp;have&nbsp;4000&nbsp;queues&nbsp;to&nbsp;federated,&nbsp;we&nbsp;got&nbsp;many&nbsp;connections&nbsp;among&nbsp;brokers.&nbsp;When&nbsp;we&nbsp;upgrading&nbsp;erlang&nbsp;to&nbsp;latest&nbsp;version,&nbsp;the&nbsp;load&nbsp;becomes&nbsp;lower&nbsp;but&nbsp;still&nbsp;very&nbsp;big.&lt;br&gt;<br>
<br>
<br>
&lt;/div&gt;It&nbsp;looks&nbsp;like&nbsp;each&nbsp;federation&nbsp;queue&nbsp;will&nbsp;open&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;upstream&nbsp;broker,&nbsp;but&nbsp;is&nbsp;it&nbsp;possible&nbsp;to&nbsp;just&nbsp;use&nbsp;one&nbsp;connection&nbsp;for&nbsp;all&nbsp;queues&nbsp;and&nbsp;use&nbsp;&lt;br&gt;&lt;div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;-Joey&nbsp;Jiao<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
