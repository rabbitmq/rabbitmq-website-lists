<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Aug&nbsp;22,&nbsp;2008&nbsp;at&nbsp;4:25&nbsp;PM,&nbsp;Ben&nbsp;Hood&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:0x6e6562@gmail.com&quot;&gt;0x6e6562@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Torben,&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Fri,&nbsp;Aug&nbsp;22,&nbsp;2008&nbsp;at&nbsp;2:31&nbsp;PM,&nbsp;Torben&nbsp;Hoffmann&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:torben.lehoff@googlemail.com&quot;&gt;torben.lehoff@googlemail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&amp;gt;&nbsp;Not&nbsp;sure&nbsp;what&nbsp;a&nbsp;MOM&nbsp;system&nbsp;is,&nbsp;but&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;map&nbsp;the&nbsp;functionality&nbsp;of&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;legacy&nbsp;system&nbsp;to&nbsp;AMQP&nbsp;since&nbsp;I&nbsp;think&nbsp;it&nbsp;could&nbsp;save&nbsp;a&nbsp;lot&nbsp;of&nbsp;effort&nbsp;and&nbsp;money.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;MOM&nbsp;=&nbsp;Message-oriented&nbsp;middleware&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;For&nbsp;my&nbsp;basic&nbsp;problem&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;have&nbsp;a&nbsp;queue&nbsp;for&nbsp;the&nbsp;group&nbsp;G&nbsp;that&nbsp;I&nbsp;can&lt;br&gt;<br>
&amp;gt;&nbsp;send&nbsp;to&nbsp;and&nbsp;then&nbsp;all&nbsp;members&nbsp;of&nbsp;the&nbsp;queue&nbsp;(bar&nbsp;the&nbsp;sender)&nbsp;will&nbsp;receive&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;message.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;As&nbsp;indicated&nbsp;in&nbsp;my&nbsp;previous&nbsp;mail,&nbsp;one&nbsp;way&nbsp;this&nbsp;can&nbsp;be&nbsp;achieved&nbsp;is&lt;br&gt;<br>
using&nbsp;a&nbsp;fanout&nbsp;exchange.&lt;br&gt;<br>
&lt;br&gt;<br>
[Taken&nbsp;from&nbsp;the&nbsp;spec]&nbsp;The&nbsp;fanout&nbsp;exchange&nbsp;type&nbsp;works&nbsp;as&nbsp;follows:&lt;br&gt;<br>
&lt;br&gt;<br>
1.&nbsp;A&nbsp;message&nbsp;queue&nbsp;binds&nbsp;to&nbsp;the&nbsp;exchange&nbsp;with&nbsp;no&nbsp;arguments.&lt;br&gt;<br>
2.&nbsp;A&nbsp;publisher&nbsp;sends&nbsp;the&nbsp;exchange&nbsp;a&nbsp;message.&lt;br&gt;<br>
3.&nbsp;The&nbsp;message&nbsp;is&nbsp;passed&nbsp;to&nbsp;the&nbsp;message&nbsp;queue&nbsp;unconditionally.&lt;br&gt;<br>
&lt;br&gt;<br>
Here&nbsp;is&nbsp;a&nbsp;simple&nbsp;example&nbsp;using&nbsp;the&nbsp;Ruby&nbsp;client&nbsp;for&nbsp;AMQP:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://github.com/tmm1/amqp/tree/master/examples/mq/clock.rb&quot;&nbsp;target=&quot;_blank&quot;&gt;http://github.com/tmm1/amqp/tree/master/examples/mq/clock.rb&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Although&nbsp;this&nbsp;is&nbsp;a&nbsp;Ruby&nbsp;example,&nbsp;the&nbsp;basic&nbsp;principle&nbsp;of&nbsp;a&nbsp;creating&nbsp;a&lt;br&gt;<br>
queue,&nbsp;binding&nbsp;it&nbsp;to&nbsp;an&nbsp;exchange&nbsp;and&nbsp;subscribing&nbsp;a&nbsp;consumer&nbsp;to&nbsp;it&nbsp;hold&lt;br&gt;<br>
true&nbsp;of&nbsp;any&nbsp;client&nbsp;language.&nbsp;I&nbsp;just&nbsp;used&nbsp;this&nbsp;as&nbsp;an&nbsp;example&nbsp;because&nbsp;it&lt;br&gt;<br>
is&nbsp;a&nbsp;quick&nbsp;link.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Good&nbsp;example&nbsp;-&nbsp;that&nbsp;part&nbsp;is&nbsp;now&nbsp;under&nbsp;control&nbsp;for&nbsp;me.&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;does&nbsp;not&nbsp;matter&nbsp;if&nbsp;I&nbsp;have&nbsp;one&nbsp;or&nbsp;more&nbsp;logical&nbsp;instances,&nbsp;but&nbsp;from&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;architectural&nbsp;perspective&nbsp;I&nbsp;think&nbsp;that&nbsp;it&nbsp;would&nbsp;be&nbsp;best&nbsp;to&nbsp;have&nbsp;a&nbsp;single&lt;br&gt;<br>
&amp;gt;&nbsp;logical&nbsp;instance&nbsp;so&nbsp;that&nbsp;I&nbsp;could&nbsp;utilise&nbsp;the&nbsp;distribution&nbsp;mechanisms&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;RabbitMQ&nbsp;without&nbsp;knowing&nbsp;about&nbsp;the&nbsp;topology&nbsp;at&nbsp;the&nbsp;application&nbsp;level.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;I&nbsp;have&nbsp;more&nbsp;than&nbsp;one&nbsp;server&nbsp;how&nbsp;would&nbsp;the&nbsp;messages&nbsp;be&nbsp;distributed?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;is&nbsp;achieved&nbsp;using&nbsp;OTP&nbsp;distribution&nbsp;mechanisms&nbsp;with&nbsp;some&lt;br&gt;<br>
AMQP/Rabbit-specific&nbsp;optimizations&nbsp;between&nbsp;nodes.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;*very*&nbsp;loose&nbsp;terms,&nbsp;a&nbsp;client&nbsp;opens&nbsp;a&nbsp;channel&nbsp;on&nbsp;a&nbsp;particular&nbsp;node&lt;br&gt;<br>
and&nbsp;this&nbsp;broker-side&nbsp;channel&nbsp;creates&nbsp;a&nbsp;communication&nbsp;link&nbsp;between&lt;br&gt;<br>
itself&nbsp;and&nbsp;the&nbsp;underlying&nbsp;queue&nbsp;*instance*,&nbsp;wherever&nbsp;that&nbsp;may&lt;br&gt;<br>
physically&nbsp;reside.&nbsp;If&nbsp;it&nbsp;declares&nbsp;a&nbsp;queue&nbsp;that&nbsp;doesn&amp;#39;t&nbsp;already&nbsp;exist,&lt;br&gt;<br>
the&nbsp;queue&nbsp;will&nbsp;be&nbsp;created&nbsp;locally,&nbsp;if&nbsp;it&nbsp;already&nbsp;exists&nbsp;it&nbsp;*may*&lt;br&gt;<br>
already&nbsp;reside&nbsp;on&nbsp;another&nbsp;node,&nbsp;but&nbsp;OTP&nbsp;message&nbsp;passing&nbsp;keeps&nbsp;this&lt;br&gt;<br>
transparent.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Good&nbsp;-&nbsp;this&nbsp;is&nbsp;what&nbsp;I&nbsp;gather&nbsp;from&nbsp;the&nbsp;documentation.&nbsp;It&nbsp;fits&nbsp;my&nbsp;needs&nbsp;rather&nbsp;well.&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;I&nbsp;have&nbsp;a&nbsp;AMQP&nbsp;server&nbsp;at&nbsp;each&nbsp;of&nbsp;my&nbsp;machines&nbsp;and&nbsp;user&nbsp;A&nbsp;sends&nbsp;a&nbsp;message&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;group&nbsp;G&nbsp;how&nbsp;would&nbsp;that&nbsp;message&nbsp;be&nbsp;routed&nbsp;to&nbsp;&amp;nbsp;B&nbsp;and&nbsp;C?&nbsp;How&nbsp;should&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;servers&nbsp;be&nbsp;connected/configured&nbsp;to&nbsp;allow&nbsp;that&nbsp;routing?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;G&nbsp;would&nbsp;be&nbsp;the&nbsp;name&nbsp;an&nbsp;exchange&nbsp;and&nbsp;B&nbsp;&amp;amp;&nbsp;C&nbsp;create&nbsp;queues&nbsp;and&nbsp;bind&nbsp;them&lt;br&gt;<br>
to&nbsp;the&nbsp;exchange&nbsp;G.&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;indicated&nbsp;above&nbsp;this&nbsp;could&nbsp;be&nbsp;a&nbsp;simple&nbsp;fanout,&nbsp;but&nbsp;a&nbsp;direct&lt;br&gt;<br>
exchange&nbsp;with&nbsp;multiple&nbsp;bindings&nbsp;would&nbsp;work&nbsp;as&nbsp;well.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Okay,&nbsp;I&nbsp;did&nbsp;not&nbsp;think&nbsp;of&nbsp;this&nbsp;type&nbsp;of&nbsp;solution,&nbsp;but&nbsp;I&nbsp;think&nbsp;this&nbsp;would&nbsp;work&nbsp;just&nbsp;as&nbsp;fine.&nbsp;So&nbsp;either&nbsp;I&nbsp;get&nbsp;a&nbsp;lot&nbsp;of&nbsp;queues&nbsp;or&nbsp;a&nbsp;lot&nbsp;of&nbsp;exchanges&nbsp;depending&nbsp;on&nbsp;how&nbsp;I&nbsp;choose&nbsp;to&nbsp;represent&nbsp;the&nbsp;groups.&nbsp;I&nbsp;will&nbsp;let&nbsp;that&nbsp;be&nbsp;up&nbsp;to&nbsp;a&nbsp;practical&nbsp;test&nbsp;on&nbsp;a&nbsp;couple&nbsp;of&nbsp;machines.&amp;nbsp;&nbsp;&lt;br&gt;<br>
&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
Note&nbsp;that&nbsp;you&nbsp;do&nbsp;not&nbsp;necessarily&nbsp;need&nbsp;an&nbsp;AMQP&nbsp;instance&nbsp;on&nbsp;machine&nbsp;that&lt;br&gt;<br>
clients&nbsp;run&nbsp;on.&nbsp;Multiple&nbsp;remote&nbsp;clients&nbsp;can&nbsp;connect&nbsp;to&nbsp;a&nbsp;single&nbsp;broker&lt;br&gt;<br>
instance.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes,&nbsp;but&nbsp;for&nbsp;the&nbsp;sake&nbsp;of&nbsp;performance&nbsp;I&nbsp;think&nbsp;that&nbsp;the&nbsp;more&nbsp;I&nbsp;can&nbsp;distribute&nbsp;the&nbsp;work&nbsp;load&nbsp;the&nbsp;better.&lt;br&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Note&nbsp;that&nbsp;I&nbsp;could&nbsp;have&nbsp;hundreds&nbsp;of&nbsp;machines&nbsp;but&nbsp;I&nbsp;will&nbsp;send&nbsp;the&nbsp;message&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;few&nbsp;of&nbsp;them&nbsp;that&nbsp;has&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;group&nbsp;registered&nbsp;at&nbsp;the&nbsp;machine.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;When&nbsp;you&nbsp;say&nbsp;you&nbsp;have&nbsp;hundreds&nbsp;of&nbsp;machines,&nbsp;do&nbsp;you&nbsp;mean&nbsp;machines&nbsp;that&lt;br&gt;<br>
you&nbsp;will&nbsp;use&nbsp;to&nbsp;run&nbsp;consumer&nbsp;processes&nbsp;on?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Indeed!&nbsp;The&nbsp;machines&nbsp;are&nbsp;already&nbsp;there&nbsp;and&nbsp;cannot&nbsp;be&nbsp;removed,&nbsp;but&nbsp;with&nbsp;AMQP&nbsp;I&nbsp;think&nbsp;that&nbsp;I&nbsp;can&nbsp;let&nbsp;them&nbsp;do&nbsp;more&nbsp;of&nbsp;the&nbsp;work&nbsp;in&nbsp;my&nbsp;system&nbsp;and&nbsp;remove&nbsp;all&nbsp;the&nbsp;machines&nbsp;that&nbsp;connect&nbsp;the&nbsp;machines&nbsp;where&nbsp;the&nbsp;consumer&nbsp;processes&nbsp;run.&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
The&nbsp;size&nbsp;of&nbsp;your&nbsp;broker&nbsp;cluster&nbsp;will&nbsp;depend&nbsp;(amongst&nbsp;other&nbsp;factors)&nbsp;on&lt;br&gt;<br>
the&nbsp;amount&nbsp;of&nbsp;messages&nbsp;you&nbsp;need&nbsp;the&nbsp;system&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;A&nbsp;system&nbsp;today&nbsp;consisting&nbsp;of&nbsp;100&nbsp;&amp;quot;consumer&amp;quot;&nbsp;machines&nbsp;plus&nbsp;some&nbsp;inner&nbsp;machines&nbsp;handles&nbsp;in&nbsp;the&nbsp;neighbourhood&nbsp;of&nbsp;3,000&nbsp;message&nbsp;per&nbsp;second.&lt;br&gt;<br>
So&nbsp;when&nbsp;I&nbsp;aim&nbsp;to&nbsp;remove&nbsp;the&nbsp;inner&nbsp;machines&nbsp;that&nbsp;does&nbsp;the&nbsp;most&nbsp;of&nbsp;the&nbsp;intelligence&nbsp;regarding&nbsp;routing&nbsp;of&nbsp;the&nbsp;messages&nbsp;I&nbsp;expect&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;inner&nbsp;bottleneck&nbsp;and&nbsp;thus&nbsp;get&nbsp;a&nbsp;higher&nbsp;performance...&nbsp;or&nbsp;at&nbsp;least&nbsp;one&nbsp;that&nbsp;is&nbsp;closer&nbsp;to&nbsp;the&nbsp;limits&nbsp;of&nbsp;the&nbsp;&amp;quot;consumer&amp;quot;&nbsp;machines&nbsp;which&nbsp;I&nbsp;think&nbsp;is&nbsp;a&nbsp;better&nbsp;constraint.&lt;br&gt;<br>
&lt;br&gt;Sorry&nbsp;if&nbsp;I&nbsp;sound&nbsp;a&nbsp;bit&nbsp;vague&nbsp;at&nbsp;times&nbsp;but&nbsp;I&nbsp;have&nbsp;only&nbsp;just&nbsp;read&nbsp;about&nbsp;AMQP&nbsp;and&nbsp;are&nbsp;now&nbsp;trying&nbsp;to&nbsp;get&nbsp;the&nbsp;concepts&nbsp;for&nbsp;a&nbsp;new&nbsp;AMQP&nbsp;based&nbsp;architecture&nbsp;in&nbsp;place.&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;Torben&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
