<tt>
That&nbsp;was&nbsp;the&nbsp;big&nbsp;thing&nbsp;I&nbsp;was&nbsp;missing&nbsp;-&nbsp;channels&nbsp;can&nbsp;be&nbsp;subscribed&nbsp;to&nbsp;more&nbsp;than&nbsp;one&nbsp;queue!&nbsp; Thank&nbsp;you&nbsp;so&nbsp;much,&nbsp;that&nbsp;was&nbsp;a&nbsp;nice&nbsp;breakthrough.&lt;div&gt;Adam&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Oct&nbsp;11,&nbsp;2011&nbsp;at&nbsp;2:19&nbsp;AM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@rabbitmq.com&quot;&gt;matthias@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Adam,&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;11/10/11&nbsp;02:48,&nbsp;Adam&nbsp;Rabung&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hello,&lt;br&gt;<br>
I&nbsp;am&nbsp;trying&nbsp;to&nbsp;implement&nbsp;a&nbsp;work&nbsp;queue&nbsp;in&nbsp;RabbitMQ.&nbsp; I&nbsp;have&nbsp;several&lt;br&gt;<br>
machines&nbsp;that&nbsp;will&nbsp;act&nbsp;as&nbsp;worker&nbsp;pools&nbsp;for&nbsp;consuming&nbsp;my&nbsp;queues.&nbsp; I&nbsp;would&lt;br&gt;<br>
like&nbsp;each&nbsp;job&nbsp;to&nbsp;be&nbsp;processed&nbsp;only&nbsp;once.&nbsp; Some&nbsp;jobs&lt;br&gt;<br>
have&nbsp;environmental&nbsp;requirements,&nbsp;ie&nbsp;must&nbsp;be&nbsp;executed&nbsp;on&nbsp;a&nbsp;machine&nbsp;with&lt;br&gt;<br>
an&nbsp;SSD.&nbsp; Not&nbsp;all&nbsp;worker&nbsp;pools&nbsp;will&nbsp;meet&nbsp;these&nbsp;requirements.&nbsp; A&nbsp;first&lt;br&gt;<br>
approach&nbsp;would&nbsp;be&nbsp;to&nbsp;have&nbsp;a&nbsp;queue&nbsp;for&nbsp;every&nbsp;permutation&nbsp;of&nbsp;requirements:&lt;br&gt;<br>
&amp;quot;No&nbsp;Requirements&amp;quot;,&nbsp;&amp;quot;Requires&nbsp;SSD&amp;quot;,&nbsp;&amp;quot;Requires&nbsp;Certificate&amp;quot;,&nbsp;etc&nbsp;and&nbsp;have&lt;br&gt;<br>
each&nbsp;worker&nbsp;pool&nbsp;subscribe&nbsp;to&nbsp;all&nbsp;queues&nbsp;which&nbsp;it&nbsp;can&nbsp;handle.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
That&nbsp;is&nbsp;a&nbsp;sound&nbsp;approach.&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
A&nbsp;majority&nbsp;of&nbsp;the&nbsp;jobs&nbsp;will&nbsp;have&nbsp;no&nbsp;requirements,&nbsp;so&nbsp;many&nbsp;worker&nbsp;pools&lt;br&gt;<br>
will&nbsp;be&nbsp;underutilized.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
As&nbsp;you&nbsp;say,&nbsp;the&nbsp;worker&nbsp;pools&nbsp;would&nbsp;subscribe&nbsp;to&nbsp;all&nbsp;the&nbsp;queues&nbsp;with&nbsp;combinations&nbsp;of&nbsp;requirements&nbsp;they&nbsp;can&nbsp;handle.&nbsp;That&nbsp;includes&nbsp;the&nbsp;&amp;quot;No&nbsp;Requirements&amp;quot;&nbsp;queue.&nbsp;The&nbsp;subscriptions&nbsp;can&nbsp;be&nbsp;active&nbsp;*simultaneously*,&nbsp;so&nbsp;work&nbsp;in&nbsp;the&nbsp;&amp;quot;No&nbsp;Requirements&amp;quot;&nbsp;queue&nbsp;would&nbsp;be&nbsp;round-robin&nbsp;routed&nbsp;to&nbsp;all&nbsp;workers,&nbsp;jobs&nbsp;in&nbsp;the&nbsp;&amp;quot;Require&nbsp;SSD&amp;quot;&nbsp;queue&nbsp;will&nbsp;be&nbsp;routed&nbsp;to&nbsp;all&nbsp;workers&nbsp;that&nbsp;have&nbsp;SSDs,&nbsp;etc.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
If&nbsp;each&nbsp;worker&nbsp;uses&nbsp;a&nbsp;single&nbsp;channel&nbsp;with&nbsp;a&nbsp;basic.qos&nbsp;prefetch&nbsp;setting&nbsp;of&nbsp;1&nbsp;and&nbsp;subscribes&nbsp;to&nbsp;all&nbsp;the&nbsp;relevant&nbsp;queues&nbsp;on&nbsp;that&nbsp;channel,&nbsp;it&nbsp;will&nbsp;be&nbsp;fed&nbsp;work&nbsp;items&nbsp;one&nbsp;at&nbsp;a&nbsp;time&nbsp;from&nbsp;the&nbsp;subset&nbsp;of&nbsp;all&nbsp;these&nbsp;queues&nbsp;that&nbsp;have&nbsp;messages&nbsp;in&nbsp;them.&nbsp;There&amp;#39;s&nbsp;some&nbsp;logic&nbsp;at&nbsp;the&nbsp;server&nbsp;that&nbsp;ensures&nbsp;this&nbsp;is&nbsp;reasonably&nbsp;fair,&nbsp;though&nbsp;you&nbsp;will&nbsp;most&nbsp;likely&nbsp;find&nbsp;that&nbsp;queues&nbsp;which&nbsp;can&nbsp;be&nbsp;handled&nbsp;by&nbsp;many&nbsp;workers&nbsp;drain&nbsp;faster&nbsp;than&nbsp;others.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
