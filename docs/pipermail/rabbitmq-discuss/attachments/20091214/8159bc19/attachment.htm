<tt>
Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;you&nbsp;please&nbsp;help&nbsp;me&nbsp;understand&nbsp;what&nbsp;is&nbsp;going&nbsp;on&nbsp;when&nbsp;I&nbsp;lose&nbsp;a&nbsp;member&nbsp;of&nbsp;a&nbsp;cluster?&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;seeing&nbsp;an&nbsp;odd&nbsp;behaviour&nbsp;that&nbsp;makes&nbsp;me&nbsp;worry.&nbsp;This&nbsp;queue&nbsp;is&nbsp;supposed&nbsp;to&nbsp;hold&lt;/div&gt;&lt;div&gt;credit&nbsp;card&nbsp;transactions,&nbsp;so&nbsp;we&nbsp;_really_&nbsp;want&nbsp;to&nbsp;avoid&nbsp;double-processing&nbsp;messages.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cluster&nbsp;consists&nbsp;of&nbsp;2&nbsp;members:&nbsp;(rabbit@mq1,&nbsp;rabbit@mq2).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;client&nbsp;connects&nbsp;to&nbsp;mq1,&nbsp;creates&nbsp;durable&nbsp;queue,&nbsp;pushes&nbsp;100&nbsp;persistent&nbsp;messages&nbsp;in&lt;/div&gt;&lt;div&gt;  &nbsp; root@mq1:~#&nbsp;rabbitmqctl&nbsp;list_queues&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; Listing&nbsp;queues&nbsp;...&lt;/div&gt;&lt;div&gt;  &nbsp; testqueue&nbsp; &nbsp; &nbsp; &nbsp;100&lt;/div&gt;&lt;div&gt;  &nbsp; ...done.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2)&nbsp;mq1&nbsp;rabbitmq&nbsp;is&nbsp;stopped&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3)&nbsp;client&nbsp;connects&nbsp;to&nbsp;mq2,&nbsp;creates&nbsp;durable&nbsp;queue,&nbsp;pushes&nbsp;100&nbsp;persistent&nbsp;messages&nbsp;in&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; root@mq2:~#&nbsp;rabbitmqctl&nbsp;list_queues&lt;/div&gt;&lt;div&gt;  &nbsp; Listing&nbsp;queues&nbsp;...&lt;/div&gt;&lt;div&gt;  &nbsp; testqueue&nbsp; &nbsp; &nbsp; &nbsp;100&lt;/div&gt;&lt;div&gt;  &nbsp; ...done.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;4)&nbsp;mq1&nbsp;rabbitmq&nbsp;is&nbsp;started&lt;/div&gt;&lt;div&gt;  &nbsp; root@mq2:~#&nbsp;rabbitmqctl&nbsp;list_queues&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; Listing&nbsp;queues&nbsp;...&lt;/div&gt;&lt;div&gt;  &nbsp; testqueue&nbsp; &nbsp; &nbsp; &nbsp;200&lt;/div&gt;&lt;div&gt;  &nbsp; ...done.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;5)&nbsp;client&nbsp;drains&nbsp;the&nbsp;queue&lt;/div&gt;&lt;div&gt;&lt;div&gt;  &nbsp; rborkows@mq1:~/client/bunny$&nbsp;./bunny-subscriber &lt;/div&gt;&lt;div&gt;  &nbsp; Drained&nbsp;200&nbsp;messages&nbsp;in&nbsp;0.475371&nbsp;seconds&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;6)&nbsp;queue&nbsp;is&nbsp;now&nbsp;empty&lt;/div&gt;&lt;div&gt;  &nbsp; root@mq2:~#&nbsp;rabbitmqctl&nbsp;list_queues&lt;/div&gt;&lt;div&gt;  &nbsp; Listing&nbsp;queues&nbsp;...&lt;/div&gt;&lt;div&gt;  &nbsp; testqueue&nbsp; &nbsp; &nbsp; &nbsp;0&lt;/div&gt;&lt;div&gt;  &nbsp; ...done.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;7)&nbsp;mq1&nbsp;rabbitmq&nbsp;is&nbsp;restarted,&nbsp;100&nbsp;credit&nbsp;card&nbsp;transactions&nbsp;pop&nbsp;back&nbsp;into&nbsp;existence,&nbsp;unhappy&nbsp;customers,&nbsp;etc.&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; root@mq1:~#&nbsp;/etc/init.d/rabbitmq-server&nbsp;restart&lt;/div&gt;&lt;div&gt;  &nbsp; Restarting&nbsp;rabbitmq-server:&nbsp;SUCCESS&lt;/div&gt;&lt;div&gt;  &nbsp; rabbitmq-server.&lt;/div&gt;&lt;div&gt;  &nbsp; root@mq1:~#&nbsp;rabbitmqctl&nbsp;list_queues&lt;/div&gt;&lt;div&gt;  &nbsp; Listing&nbsp;queues&nbsp;...&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; testqueue&nbsp; &nbsp; &nbsp; &nbsp;100&lt;/div&gt;&lt;div&gt;  &nbsp; ...done.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;expected&nbsp;behaviour&nbsp;is&nbsp;that&nbsp;after&nbsp;step&nbsp;5&nbsp;the&nbsp;messages&nbsp;are&nbsp;_gone_&nbsp;from&nbsp;the&nbsp;queue,&nbsp;never&nbsp;to&nbsp;be&nbsp;seen&nbsp;again.&lt;/div&gt;&lt;div&gt;What&amp;#39;s&nbsp;going&nbsp;on&nbsp;here?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- &lt;/div&gt;&lt;div&gt;Robert&nbsp;Borkowski&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
