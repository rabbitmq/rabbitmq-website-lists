<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Apr&nbsp;2,&nbsp;2010,&nbsp;at&nbsp;1:54&nbsp;PM,&nbsp;Matthew&nbsp;Sackman&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Actually,&nbsp;I&nbsp;think&nbsp;you'll&nbsp;see&nbsp;this&nbsp;bug&nbsp;if&nbsp;you&nbsp;just&nbsp;do:&nbsp;subscribe,&lt;br&gt;unsubscribe,&nbsp;recover.&nbsp;The&nbsp;second&nbsp;subscription&nbsp;should&nbsp;be&nbsp;unnecessary.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yes,&nbsp;you're&nbsp;right.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;Yes.&nbsp;There's&nbsp;probably&nbsp;an&nbsp;argument&nbsp;for&nbsp;saying&nbsp;that&nbsp;in&nbsp;the&nbsp;absence&nbsp;of&nbsp;a&lt;br&gt;valid&nbsp;consumer&nbsp;tag,&nbsp;the&nbsp;messages&nbsp;should&nbsp;be&nbsp;sent&nbsp;to&nbsp;the&nbsp;client&nbsp;as&nbsp;a&lt;br&gt;sequence&nbsp;of&nbsp;basic.get-oks,&nbsp;or&nbsp;at&nbsp;least&nbsp;a&nbsp;basic.deliver&nbsp;with&nbsp;a&nbsp;very&lt;br&gt;special&nbsp;ctag&nbsp;to&nbsp;indicate&nbsp;to&nbsp;the&nbsp;clients&nbsp;that&nbsp;they&nbsp;shouldn't&nbsp;be&nbsp;suprised&lt;br&gt;by&nbsp;these&nbsp;deliveries&nbsp;which&nbsp;are&nbsp;apparently&nbsp;appearing&nbsp;outside&nbsp;of&nbsp;the&nbsp;scope&lt;br&gt;of&nbsp;any&nbsp;subscription&nbsp;it&nbsp;knows&nbsp;about.&nbsp;This&nbsp;really&nbsp;seems&nbsp;to&nbsp;be&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&lt;br&gt;spec&nbsp;rather&nbsp;than&nbsp;our&nbsp;implementation&nbsp;or&nbsp;the&nbsp;client.&lt;br&gt;&lt;br&gt;At&nbsp;the&nbsp;very&nbsp;least,&nbsp;the&nbsp;basic.recover_ok&nbsp;should&nbsp;contain&nbsp;a&nbsp;new&nbsp;ctag&nbsp;(which&lt;br&gt;for&nbsp;symmetry&nbsp;suggests&nbsp;the&nbsp;client&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;specify&nbsp;one&nbsp;in&lt;br&gt;basic.recover&nbsp;to&nbsp;mirror&nbsp;basic.consume&nbsp;and&nbsp;basic.consume_ok)&nbsp;which&nbsp;the&lt;br&gt;client&nbsp;can&nbsp;then&nbsp;use&nbsp;to&nbsp;identify&nbsp;these&nbsp;deliveries&nbsp;and&nbsp;route&nbsp;them&lt;br&gt;accordingly.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;At&nbsp;this&nbsp;point&nbsp;I&nbsp;should&nbsp;go&nbsp;and&nbsp;read&nbsp;the&nbsp;full&nbsp;specs&nbsp;to&nbsp;try&nbsp;to&nbsp;understand&nbsp;the&nbsp;reasons&nbsp;for&nbsp;this&lt;/div&gt;&lt;div&gt;design.&nbsp;However,&nbsp;I&nbsp;don't&nbsp;see&nbsp;the&nbsp;reason&nbsp;for&nbsp;redelivering&nbsp;messages&nbsp;to&nbsp;a&nbsp;consumer&nbsp;that&lt;/div&gt;&lt;div&gt;already&nbsp;said&nbsp;explicitly&nbsp;that&nbsp;it&nbsp;doesn't&nbsp;want&nbsp;to&nbsp;receive&nbsp;messages&nbsp;from&nbsp;that&nbsp;queue&nbsp;anymore.&lt;/div&gt;&lt;div&gt;Why&nbsp;don't&nbsp;just&nbsp;redeliver&nbsp;the&nbsp;messages&nbsp;to&nbsp;other&nbsp;possible&nbsp;subscribers&nbsp;after&nbsp;the&nbsp;subscription&lt;/div&gt;&lt;div&gt;cancel&nbsp;was&nbsp;received?&nbsp;Ok,&nbsp;maybe&nbsp;the&nbsp;consumer&nbsp;can&nbsp;subscribe&nbsp;again&nbsp;using&nbsp;the&nbsp;same&nbsp;ctag&nbsp;(the&nbsp;library&lt;/div&gt;&lt;div&gt;should&nbsp;allow&nbsp;to&nbsp;do&nbsp;so)&nbsp;or&nbsp;the&nbsp;server&nbsp;should&nbsp;understand&nbsp;the&nbsp;change&nbsp;of&nbsp;ctag,&nbsp;given&nbsp;that&nbsp;there&lt;/div&gt;&lt;div&gt;cannot&nbsp;be&nbsp;two&nbsp;consumers&nbsp;for&nbsp;the&nbsp;same&nbsp;queue&nbsp;on&nbsp;the&nbsp;same&nbsp;channel,&nbsp;right?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;just&nbsp;have&nbsp;a&nbsp;couple&nbsp;of&nbsp;weeks&nbsp;of&nbsp;experience&nbsp;with&nbsp;AMQP&nbsp;and&nbsp;RabbitMQ&nbsp;and&nbsp;I'm&nbsp;still&lt;/div&gt;&lt;div&gt;trying&nbsp;to&nbsp;figure&nbsp;out&nbsp;the&nbsp;architecture&nbsp;patters&nbsp;that&nbsp;I&nbsp;should&nbsp;follow&nbsp;for&nbsp;our&nbsp;design.&nbsp;One&nbsp;thing&lt;/div&gt;&lt;div&gt;that&nbsp;still&nbsp;results&nbsp;strange&nbsp;to&nbsp;me&nbsp;is&nbsp;that&nbsp;the&nbsp;recover&nbsp;operates&nbsp;only&nbsp;at&nbsp;a&nbsp;channel&nbsp;level&nbsp;and&nbsp;there&lt;/div&gt;&lt;div&gt;is&nbsp;no&nbsp;way&nbsp;to&nbsp;recover&nbsp;messages&nbsp;just&nbsp;for&nbsp;one&nbsp;queue.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;I&nbsp;would&nbsp;recommend&nbsp;that&nbsp;you&nbsp;don't&nbsp;use&nbsp;recover&nbsp;without&nbsp;also&nbsp;setting&lt;br&gt;requeue=true,&nbsp;thus&nbsp;ensuring&nbsp;the&nbsp;messages&nbsp;are&nbsp;inserted&nbsp;back&nbsp;into&nbsp;the&lt;br&gt;queue&nbsp;and&nbsp;can&nbsp;hence&nbsp;be&nbsp;redelivered&nbsp;to&nbsp;any&nbsp;valid&nbsp;consumer&nbsp;again&nbsp;(at&lt;br&gt;which&nbsp;point&nbsp;the&nbsp;ctag&nbsp;will&nbsp;be&nbsp;set&nbsp;correctly).&nbsp;Hopefully&nbsp;you'll&nbsp;at&lt;br&gt;least&nbsp;get&nbsp;unsurprising&nbsp;behaviour!&nbsp;I&nbsp;will&nbsp;raise&nbsp;some&nbsp;bugs&nbsp;to&nbsp;cover&nbsp;the&lt;br&gt;issues&nbsp;uncovered&nbsp;-&nbsp;many&nbsp;thanks&nbsp;for&nbsp;the&nbsp;report.&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yes!&nbsp;this&nbsp;solved&nbsp;my&nbsp;issue.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-&nbsp;Juan&lt;/body&gt;&lt;/html&gt;
</tt>
