<tt>
I&amp;#39;ve&nbsp;come&nbsp;across&nbsp;a&nbsp;situation&nbsp;that&amp;#39;s&nbsp;semi-obvious&nbsp;in&nbsp;retrospect&nbsp;given&nbsp;what&nbsp;I&nbsp;know&nbsp;of&nbsp;RabbitMQ,&nbsp;but&nbsp;nonetheless&nbsp;escaped&nbsp;me&nbsp;till&nbsp;now.&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;written&nbsp;a&nbsp;variety&nbsp;of&nbsp;automation&nbsp;code&nbsp;in&nbsp;Python&nbsp;using&nbsp;the&nbsp;rabbitmq&nbsp;management&nbsp;API.&nbsp;Things&nbsp;like&nbsp;purging&nbsp;queues,&nbsp;dumping&nbsp;queue&nbsp;contents&nbsp;to&nbsp;files,&nbsp;simulating&nbsp;broker&nbsp;failover,&nbsp;etc...&lt;br&gt;<br>
&lt;br&gt;Today&nbsp;I&nbsp;created&nbsp;a&nbsp;situation&nbsp;where&nbsp;I&nbsp;knew&nbsp;that&nbsp;there&nbsp;was&nbsp;an&nbsp;unacknowledged&nbsp;message&nbsp;in&nbsp;a&nbsp;queue,&nbsp;and&nbsp;I&nbsp;could&nbsp;observe&nbsp;that&nbsp;was&nbsp;the&nbsp;case&nbsp;via&nbsp;the&nbsp;Web&nbsp;UI.&nbsp;However,&nbsp;my&nbsp;code&nbsp;was&nbsp;getting&nbsp;a&nbsp;value&nbsp;of&nbsp;&amp;#39;0&amp;#39;&nbsp;for&nbsp;the&nbsp;messages_unacknowledged&nbsp;column&nbsp;from&nbsp;/api/queues.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;eventually&nbsp;figured&nbsp;out&nbsp;that&nbsp;my&nbsp;HTTP&nbsp;call&nbsp;occurred&nbsp;before&nbsp;the&nbsp;default&nbsp;five&nbsp;second&nbsp;statistics&nbsp;database&nbsp;update.&nbsp;Thus,&nbsp;if&nbsp;I&nbsp;waited&nbsp;a&nbsp;few&nbsp;seconds&nbsp;before&nbsp;issuing&nbsp;the&nbsp;call,&nbsp;I&nbsp;got&nbsp;back&nbsp;the&nbsp;expected&nbsp;value&nbsp;of&nbsp;&amp;#39;1&amp;#39;.&lt;br&gt;<br>
&lt;br&gt;Now,&nbsp;some&nbsp;of&nbsp;my&nbsp;automation&nbsp;depends&nbsp;on&nbsp;the&nbsp;values&nbsp;I&nbsp;get&nbsp;from&nbsp;the&nbsp;HTTP&nbsp;API&nbsp;to&nbsp;be&nbsp;correct&nbsp;&amp;quot;now&amp;quot;,&nbsp;rather&nbsp;than&nbsp;behind&nbsp;by&nbsp;some&nbsp;non-trivial&nbsp;interval.&lt;br&gt;&lt;br&gt;Now,&nbsp;I&nbsp;realize&nbsp;that&nbsp;this&nbsp;is&nbsp;an&nbsp;inherently&nbsp;racy&nbsp;circumstance.&nbsp;I&amp;#39;m&nbsp;just&nbsp;trying&nbsp;to&nbsp;reduce&nbsp;the&nbsp;window&nbsp;as&nbsp;much&nbsp;as&nbsp;possible.&nbsp;As&nbsp;I&nbsp;see&nbsp;it,&nbsp;I&nbsp;have&nbsp;three&nbsp;options:&lt;br&gt;<br>
&lt;ul&gt;&lt;li&gt;Crank&nbsp;up&nbsp;the&nbsp;default&nbsp;update&nbsp;interval,&nbsp;suppressing&nbsp;perf&nbsp;as&nbsp;I&nbsp;go&nbsp;to&nbsp;smaller&nbsp;intervals&lt;/li&gt;&lt;li&gt;Somehow&nbsp;query&nbsp;the&nbsp;broker&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;rabbitmqctl&nbsp;does.&nbsp;I&nbsp;assume&nbsp;this&nbsp;involves&nbsp;writing&nbsp;Erlang&nbsp;code,&nbsp;which&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;avoid&nbsp;for&nbsp;time&nbsp;reasons.&lt;/li&gt;<br>
&lt;li&gt;Call&nbsp;rabbitmqctl&nbsp;and&nbsp;capture/parse&nbsp;the&nbsp;output.&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;Again,&nbsp;I&nbsp;realize&nbsp;that&nbsp;any&nbsp;solution&nbsp;is&nbsp;inherently&nbsp;only&nbsp;a&nbsp;snapshot&nbsp;in&nbsp;time&nbsp;- &nbsp;Thoughts&nbsp;on&nbsp;how&nbsp;to&nbsp;best&nbsp;achieve&nbsp;the&nbsp;most&nbsp;recently&nbsp;correct&nbsp;values,&nbsp;ideally&nbsp;in&nbsp;Python&nbsp;and&nbsp;without&nbsp;learning&nbsp;Erlang?&nbsp;:-)&lt;br&gt;<br>
&lt;br&gt;Thanks,&lt;br&gt;&lt;br&gt;Matt&lt;br&gt;<br>

</tt>
