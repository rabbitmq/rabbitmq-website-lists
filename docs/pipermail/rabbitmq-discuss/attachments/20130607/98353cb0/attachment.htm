<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;have&nbsp;some&nbsp;questions:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;1)&nbsp;Why&nbsp;are&nbsp;you&nbsp;using &lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;basic_get&nbsp;instead&nbsp;of&nbsp;basic_consume&nbsp;as&nbsp;shown&nbsp;here: &lt;/span&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/videlalvaro/php-amqplib/blob/master/demo/amqp_consumer.php#L66&quot;&gt;https://github.com/videlalvaro/php-amqplib/blob/master/demo/amqp_consumer.php#L66&lt;/a&gt;&nbsp;This&nbsp;is&nbsp;much&nbsp;faster.&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;2)&nbsp;The&nbsp;&amp;quot;tnc&amp;quot;&nbsp;version&nbsp;of&nbsp;the&nbsp;library&nbsp;is&nbsp;not maintained anymore&nbsp;since&nbsp;2&nbsp;years&nbsp;already.&nbsp;There&nbsp;are&nbsp;many&nbsp;bug&nbsp;fixes&nbsp;in&nbsp;this&nbsp;version&nbsp;of&nbsp;the&nbsp;library: &lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/videlalvaro/php-amqplib/&quot;&gt;https://github.com/videlalvaro/php-amqplib/&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;3)&nbsp;As&nbsp;Michael&nbsp;pointed&nbsp;out,&nbsp;do&nbsp;you&nbsp;have&nbsp;any&nbsp;basic_reject&nbsp;calls&nbsp;in&nbsp;your&nbsp;code?&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;<br>
&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;Regards,&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;br&gt;Alvaro&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;7,&nbsp;2013&nbsp;at&nbsp;12:13&nbsp;PM,&nbsp;tluck&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:tilak.chauhan@ymail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;tilak.chauhan@ymail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;MK,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Something&nbsp;in&nbsp;your&nbsp;code&nbsp;rejects&nbsp;messages&nbsp;with&nbsp;unknown&nbsp;delivery&nbsp;tag.&nbsp;This&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;causes&lt;br&gt;<br>
the&nbsp;channel&nbsp;to&nbsp;be&nbsp;closed.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Even&nbsp;if&nbsp;a&nbsp;channel&nbsp;is&nbsp;being&nbsp;closed&nbsp;then&nbsp;why&nbsp;script&nbsp;has&nbsp;not&nbsp;been&nbsp;terminated&nbsp;?.&lt;br&gt;<br>
I&amp;#39;m&nbsp;using&nbsp;`basic_get`&nbsp;method&nbsp;to&nbsp;consume&nbsp;messages.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Can&nbsp;you&nbsp;post&nbsp;a&nbsp;fragment&nbsp;of&nbsp;your&nbsp;code&nbsp;that&nbsp;rejects&nbsp;messages&nbsp;and&nbsp;also&nbsp;be&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;more&nbsp;specific&nbsp;about&nbsp;which&nbsp;PHP&nbsp;library&nbsp;you&nbsp;use?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/tnc/php-amqplib&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/tnc/php-amqplib&lt;/a&gt;&nbsp;--&nbsp;This&nbsp;is&nbsp;the&nbsp;php&nbsp;library&nbsp;I&amp;#39;m&nbsp;using.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Here&nbsp;is&nbsp;my&nbsp;code&nbsp;sample&nbsp;:&lt;br&gt;<br>
&lt;br&gt;<br>
$connection&nbsp;=&nbsp;new&nbsp;AMQPConnection(HOST,&nbsp;PORT,&nbsp;USER,&nbsp;PASS,&nbsp;VHOST);&lt;br&gt;<br>
$channel&nbsp;=&nbsp;$connection-&amp;gt;channel();&lt;br&gt;<br>
$channel-&amp;gt;queue_declare($queue,&nbsp;false,&nbsp;true,&nbsp;false,&nbsp;false);&lt;br&gt;<br>
$channel-&amp;gt;exchange_declare(&amp;#39;myexchange&amp;#39;,&nbsp;&amp;#39;direct&amp;#39;,&nbsp;true,&nbsp;true,&nbsp;false);&lt;br&gt;<br>
$channel-&amp;gt;queue_bind(&amp;#39;myqueue&amp;#39;,&nbsp;$exchange,&nbsp;$queue);&lt;br&gt;<br>
&lt;br&gt;<br>
while&nbsp;($msg&nbsp;=&nbsp;$channel-&amp;gt;basic_get($queue))&nbsp;{&lt;br&gt;<br>
 &nbsp; &nbsp;consumerMessage($msg,&nbsp;$connection,&nbsp;$channel);&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
$channel-&amp;gt;close();&lt;br&gt;<br>
$connection-&amp;gt;close();&lt;br&gt;<br>
&lt;br&gt;<br>
function&nbsp;consumerMessage($msg,&nbsp;$connection,&nbsp;$channel){&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;$data&nbsp;=&nbsp;json_decode($msg-&amp;gt;body,&nbsp;true);&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;IF(thisConsumerIsNotAllowedToConsumeThisMessage){&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$channel-&amp;gt;basic_ack($msg-&amp;gt;delivery_info[&amp;#39;delivery_tag&amp;#39;]);&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;DoAllDataProcessing($data);&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;$channel-&amp;gt;basic_ack($msg-&amp;gt;delivery_info[&amp;#39;delivery_tag&amp;#39;]);&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;return;&lt;br&gt;<br>
}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
T.luck&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
View&nbsp;this&nbsp;message&nbsp;in&nbsp;context:&nbsp;&lt;a&nbsp;href=&quot;http://rabbitmq.1065348.n5.nabble.com/Script-Connection-not-getting-terminated-tp27265p27271.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://rabbitmq.1065348.n5.nabble.com/Script-Connection-not-getting-terminated-tp27265p27271.html&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;Sent&nbsp;from&nbsp;the&nbsp;RabbitMQ&nbsp;mailing&nbsp;list&nbsp;archive&nbsp;at&nbsp;Nabble.com.&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
