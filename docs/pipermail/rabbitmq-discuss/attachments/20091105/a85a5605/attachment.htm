<tt>
Its&nbsp;been&nbsp;awhile&nbsp;since&nbsp;I&nbsp;brought&nbsp;this&nbsp;up,&nbsp;but&nbsp;made&nbsp;I&nbsp;a&nbsp;small&nbsp;patch&nbsp;to&nbsp;the&nbsp;memory&nbsp;supervisor&nbsp;that&nbsp;has&nbsp;fixed&nbsp;most&nbsp;of&nbsp;the&nbsp;memory&nbsp;usage&nbsp;problems.&nbsp;Basically,&nbsp;I&nbsp;just&nbsp;force&nbsp;a&nbsp;garbage&nbsp;collect&nbsp;before&nbsp;checking&nbsp;the&nbsp;memory&nbsp;alarm&nbsp;condition:&lt;br&gt;<br>
&lt;br&gt;diff&nbsp;-r&nbsp;7b0512cdf3bc&nbsp;src/vm_memory_monitor.erl&lt;br&gt;---&nbsp;a/src/vm_memory_monitor.erl   &nbsp;Thu&nbsp;Nov&nbsp;05&nbsp;15:19:05&nbsp;2009&nbsp;+0000&lt;br&gt;+++&nbsp;b/src/vm_memory_monitor.erl   &nbsp;Thu&nbsp;Nov&nbsp;05&nbsp;13:48:06&nbsp;2009&nbsp;-0800&lt;br&gt;@@&nbsp;-174,6&nbsp;+174,7&nbsp;@@&lt;br&gt; &lt;br&gt; internal_update(State&nbsp;=&nbsp;#state&nbsp;{&nbsp;memory_limit&nbsp;=&nbsp;MemLimit,&lt;br&gt;<br>
                                 &nbsp;alarmed&nbsp;=&nbsp;Alarmed})&nbsp;-&amp;gt;&lt;br&gt;+   &nbsp;[garbage_collect(P)&nbsp;||&nbsp;P&nbsp;&amp;lt;-&nbsp;processes()],&lt;br&gt;    &nbsp;MemUsed&nbsp;=&nbsp;erlang:memory(total),&lt;br&gt;    &nbsp;NewAlarmed&nbsp;=&nbsp;MemUsed&nbsp;&amp;gt;&nbsp;MemLimit,&lt;br&gt;    &nbsp;case&nbsp;{Alarmed,&nbsp;NewAlarmed}&nbsp;of&lt;br&gt;<br>
&lt;br&gt;Indeed,&nbsp;this&nbsp;is&nbsp;a&nbsp;bit&nbsp;heinous,&nbsp;but&nbsp;it&nbsp;gets&nbsp;the&nbsp;job&nbsp;done.&nbsp;Unfortunately,&nbsp;I&nbsp;don&amp;#39;t&nbsp;have&nbsp;the&nbsp;appropriate&nbsp;bug&nbsp;id&nbsp;so&nbsp;I&nbsp;didn&amp;#39;t&nbsp;create&nbsp;an&nbsp;hg&nbsp;branch&nbsp;for&nbsp;you&nbsp;to&nbsp;pull&nbsp;from.&nbsp;&lt;br&gt;&lt;br&gt;As&nbsp;far&nbsp;as&nbsp;overall&nbsp;system&nbsp;effects&nbsp;go,&nbsp;I&nbsp;haven&amp;#39;t&nbsp;noticed&nbsp;any&nbsp;(aside&nbsp;from&nbsp;the&nbsp;lack&nbsp;of&nbsp;crashes).&nbsp;We&nbsp;have&nbsp;been&nbsp;running&nbsp;this&nbsp;in&nbsp;production&nbsp;for&nbsp;a&nbsp;bit&nbsp;and&nbsp;haven&amp;#39;t&nbsp;seen&nbsp;any&nbsp;large&nbsp;problems,&nbsp;although&nbsp;the&nbsp;application&nbsp;is&nbsp;low&nbsp;throughput.&nbsp;Are&nbsp;there&nbsp;any&nbsp;performance&nbsp;unit&nbsp;tests&nbsp;that&nbsp;I&nbsp;can&nbsp;run&nbsp;to&nbsp;check&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;Stephen&nbsp;J&nbsp;Day&nbsp;&lt;br&gt;<br>

</tt>
