<tt>
Martin,&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Sun,&nbsp;May&nbsp;9,&nbsp;2010&nbsp;at&nbsp;7:08&nbsp;PM,&nbsp;Martin&nbsp;Sustrik&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sustrik@250bpm.com&quot;&gt;sustrik@250bpm.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Gustavo&nbsp;Aquino&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Martin,&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Sun,&nbsp;May&nbsp;9,&nbsp;2010&nbsp;at&nbsp;6:02&nbsp;PM,&nbsp;Martin&nbsp;Sustrik&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:sustrik@250bpm.com&quot;&nbsp;target=&quot;_blank&quot;&gt;sustrik@250bpm.com&lt;/a&gt;&nbsp;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:sustrik@250bpm.com&quot;&nbsp;target=&quot;_blank&quot;&gt;sustrik@250bpm.com&lt;/a&gt;&amp;gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&nbsp; &nbsp; Gustavo,&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; Thanks&nbsp;but&nbsp;today&nbsp;we&nbsp;are&nbsp;trying&nbsp;to&nbsp;get&nbsp;this&nbsp;information&nbsp;by&nbsp;this&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; hard&nbsp;way.&nbsp;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;get&nbsp;a&nbsp;help&nbsp;here,&nbsp;someone&nbsp;may&nbsp;have&nbsp;done&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; it&nbsp;before&nbsp;or&nbsp;RabbitMQ&nbsp;owners&nbsp;can&nbsp;have&nbsp;this&nbsp;number&nbsp;and&nbsp;will&nbsp;help&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; me&nbsp;to&nbsp;get&nbsp;back&nbsp;time&nbsp;loosed&nbsp;hacking&nbsp;packages&nbsp;network.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; Per-message&nbsp;overhead&nbsp;for&nbsp;AMQP/0-8&nbsp;is&nbsp;50+&nbsp;bytes.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks,&nbsp;do&nbsp;you&nbsp;know&nbsp;if&nbsp;RabbitMQ&nbsp;cover&nbsp;this&nbsp;pattern&nbsp;?&lt;br&gt;<br>
&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Sure.&nbsp;It&amp;#39;s&nbsp;minimal&nbsp;size&nbsp;of&nbsp;envelope&nbsp;for&nbsp;AMQP/0-8.&nbsp;Actual&nbsp;envelope&nbsp;may&nbsp;be&nbsp;larger&nbsp;depending&nbsp;on&nbsp;what&nbsp;you&nbsp;put&nbsp;into&nbsp;it&nbsp;(exchange&nbsp;name,&nbsp;topic&nbsp;etc.)&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Well&nbsp;MTU&nbsp;is&nbsp;about&nbsp;maximum&nbsp;not&nbsp;minimal,&nbsp;so&nbsp;you&nbsp;sad&nbsp;a&nbsp;interest&nbsp;stuff,&nbsp;let&nbsp;say&nbsp;that&nbsp;we&nbsp;posting&nbsp;message&nbsp;to&nbsp;one&nbsp;exchange&nbsp;named&nbsp;&amp;quot;123&amp;quot;and&nbsp;it&nbsp;routed&nbsp;to&nbsp;one&nbsp;queue&nbsp;named&nbsp;&amp;quot;456&amp;quot;&nbsp;on&nbsp;other&nbsp;machine,&nbsp;so&nbsp;what&nbsp;is&nbsp;MTU&nbsp;from primarily message&nbsp;and&nbsp;what&nbsp;the&nbsp;size&nbsp;of&nbsp;second&nbsp;?&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; This&nbsp;number&nbsp;is&nbsp;very&nbsp;important,&nbsp;and&nbsp;have&nbsp;significant&nbsp;differences&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; between&nbsp;AMQP&nbsp;implementations.&nbsp;Just&nbsp;for&nbsp;example&nbsp;the&nbsp;Qpid&nbsp;package&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; have&nbsp;a&nbsp;oversize&nbsp;in&nbsp;message&nbsp;larger&nbsp;than&nbsp;RabbitMQ&nbsp;until&nbsp;you&nbsp;can&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; send&nbsp;32k&nbsp;messages&nbsp;per&nbsp;second&nbsp;using&nbsp;100mbps&nbsp;you&nbsp;can&nbsp;do&nbsp;only&nbsp;16k&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; messages&nbsp;per&nbsp;second&nbsp;with&nbsp;Qpid&nbsp;with&nbsp;the&nbsp;same&nbsp;100mbps.&nbsp;(Messages&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; with&nbsp;213bytes).&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; Resuming&nbsp;If&nbsp;you&nbsp;will&nbsp;have&nbsp;a&nbsp;high&nbsp;throughput&nbsp;and&nbsp;need&nbsp;high&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; performance&nbsp;make&nbsp;sure&nbsp;that&nbsp;you&nbsp;will&nbsp;not&nbsp;want&nbsp;to&nbsp;use&nbsp;jumbo&nbsp;frame.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; It&amp;#39;s&nbsp;very&nbsp;unlikely&nbsp;that&nbsp;MTU&nbsp;size&nbsp;setting&nbsp;will&nbsp;have&nbsp;any&nbsp;impact&nbsp;on&lt;br&gt;<br>
&nbsp; &nbsp; performance&nbsp;in&nbsp;your&nbsp;scenario.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;use&nbsp;jumbo&nbsp;frame&nbsp;you&nbsp;have&nbsp;a&nbsp;significant&nbsp;impact&nbsp;in&nbsp;your&nbsp;round&nbsp;trip,&nbsp;and&nbsp;make&nbsp;sure&nbsp;we&nbsp;are&nbsp;working&nbsp;to&nbsp;save&nbsp;microseconds/nanoseconds&nbsp;and&nbsp;a&nbsp;simple&nbsp;overhead&nbsp;in&nbsp;round&nbsp;trip&nbsp;message&nbsp;impact&nbsp;us&nbsp;so&nbsp;much.&nbsp;&lt;br&gt;<br>
Again&nbsp;the&nbsp;MTU&nbsp;question&nbsp;is&nbsp;to&nbsp;do&nbsp;some&nbsp;calc&nbsp;to&nbsp;refine&nbsp;our&nbsp;network&nbsp;configurations,&nbsp;not&nbsp;a&nbsp;simple&nbsp;configuration&nbsp;in&nbsp;Ethernet&nbsp;interface,&nbsp;a&nbsp;network&nbsp;admin&nbsp;use&nbsp;this&nbsp;calc&nbsp;to&nbsp;project&nbsp;your&nbsp;network&nbsp;to&nbsp;a&nbsp;specific&nbsp;requirement,&nbsp;and&nbsp;when&nbsp;you&nbsp;are&nbsp;talking&nbsp;in&nbsp;microseconds/nanoseconds&nbsp;this&nbsp;configuration&nbsp;made&nbsp;a&nbsp;big&nbsp;difference.&nbsp;For&nbsp;example&nbsp;we&nbsp;are&nbsp;getting&nbsp;bad&nbsp;performance&nbsp;in&nbsp;one&nbsp;of&nbsp;our&nbsp;nodes,&nbsp;and&nbsp;we&nbsp;discovered&nbsp;that&nbsp;router&nbsp;was&nbsp;configured&nbsp;for&nbsp;576&nbsp;MTU&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;overhead&nbsp;of&nbsp;0.500&nbsp;us&nbsp;each&nbsp;message&nbsp;with&nbsp;one&nbsp;specific&nbsp;throughput.&nbsp;&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
0.5&nbsp;us&nbsp;is&nbsp;presumably&nbsp;less&nbsp;than&nbsp;1%&nbsp;of&nbsp;overall&nbsp;latency.&nbsp;In&nbsp;fact,&nbsp;it&amp;#39;s&nbsp;pretty&nbsp;hard&nbsp;even&nbsp;to&nbsp;measure&nbsp;that&nbsp;kind&nbsp;of&nbsp;latency&nbsp;difference.&nbsp;Just&nbsp;the&nbsp;latency&nbsp;jitter&nbsp;is&nbsp;going&nbsp;to&nbsp;be&nbsp;many&nbsp;times&nbsp;higher&nbsp;than&nbsp;that.&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;exactly&nbsp;are&nbsp;you&nbsp;trying&nbsp;to&nbsp;achieve?&nbsp;And&nbsp;what&nbsp;are&nbsp;you&nbsp;measuring?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Look&nbsp;0.5us&nbsp;in&nbsp;each&nbsp;message&nbsp;based&nbsp;on&nbsp;a&nbsp;throughput,&nbsp;whats&nbsp;happend&nbsp;if&nbsp;your&nbsp;router&nbsp;have&nbsp;a&nbsp;576&nbsp;MTU&nbsp;and&nbsp;your&nbsp;other&nbsp;are&nbsp;sending&nbsp;1.500&nbsp;MTU?&nbsp;it&nbsp;will&nbsp;fragmente&nbsp;this&nbsp;packages&nbsp;in&nbsp;3&nbsp;packages&nbsp;of&nbsp;576&nbsp;MTU,&nbsp;this&nbsp;cause&nbsp;something&nbsp;like&nbsp;a&nbsp;full&nbsp;network bandwidth used,&nbsp;in&nbsp;other&nbsp;words&nbsp;if&nbsp;my&nbsp;router&nbsp;can&nbsp;use&nbsp;only&nbsp;1.500&nbsp;MTU&nbsp;how&nbsp;much&nbsp;messages&nbsp;I&nbsp;can&nbsp;put&nbsp;in&nbsp;this&nbsp;value&nbsp;?&nbsp;this&nbsp;is&nbsp;te&nbsp;basic&nbsp;calc&nbsp;that&nbsp;we&nbsp;want&nbsp;do&nbsp;do&nbsp;and&nbsp;about&nbsp;that&nbsp;we&nbsp;need&nbsp;to&nbsp;know&nbsp;the&nbsp;MTU&nbsp;of&nbsp;RabbitMQ&nbsp;messages&nbsp;understand&nbsp;?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;RabbitMQ&nbsp;are&nbsp;receiving&nbsp;20&nbsp;messages&nbsp;per&nbsp;millisecond&nbsp;from&nbsp;publisher&nbsp;and&nbsp;each&nbsp;message&nbsp;have&nbsp;213&nbsp;bytes,&nbsp;what&nbsp;the&nbsp;size&nbsp;of&nbsp;packages&nbsp;over&nbsp;network&nbsp;to&nbsp;a&nbsp;consumer&nbsp;or&nbsp;other&nbsp;broker?&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gustavo&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;<br>
Martin&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
