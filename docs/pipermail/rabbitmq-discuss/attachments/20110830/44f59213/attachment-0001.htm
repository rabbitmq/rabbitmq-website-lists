<tt>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;TITLE&gt;Cluster&nbsp;Disk&nbsp;Node&nbsp;vs&nbsp;Ram&nbsp;Node&nbsp;explanation&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;I&nbsp;know&nbsp;this&nbsp;has&nbsp;probably&nbsp;been&nbsp;discussed&nbsp;at&nbsp;length&nbsp;in&nbsp;this&nbsp;list&nbsp;and&nbsp;elsewhere.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Reference:&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;http://groups.google.com/group/rabbitmq-discuss/msg/baa8f8b30ba423e0&quot;&gt;http://groups.google.com/group/rabbitmq-discuss/msg/baa8f8b30ba423e0&lt;/a&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;just&nbsp;want&nbsp;to&nbsp;clarify:&lt;BR&gt;<br>
&lt;BR&gt;<br>
GIVEN:&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;UL&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;A&nbsp;load&nbsp;balanced&nbsp;cluster&nbsp;consisting&nbsp;of&nbsp;disk&nbsp;node&nbsp;A,&nbsp;ram&nbsp;node&nbsp;B,&nbsp;and&nbsp;ram&nbsp;node&nbsp;C&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/UL&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;&lt;BR&gt;<br>
WHEN:&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;UL&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;A&nbsp;client&nbsp;is&nbsp;routed&nbsp;to&nbsp;ram&nbsp;node&nbsp;B&nbsp;via&nbsp;the&nbsp;load&nbsp;balancer,<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;AND&nbsp;the&nbsp;client&nbsp;declares&nbsp;a&nbsp;&lt;B&gt;durable&lt;/B&gt;&nbsp;&lt;B&gt;queue&nbsp;&lt;/B&gt;on&nbsp;its&nbsp;connection&nbsp;to&nbsp;ram&nbsp;node&nbsp;B,<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;AND&nbsp;the&nbsp;client&nbsp;declares&nbsp;bindings&nbsp;to&nbsp;a&nbsp;topic&nbsp;exchange&nbsp;being&nbsp;serviced&nbsp;by&nbsp;a&nbsp;producer&nbsp;connected&nbsp;on&nbsp;ram&nbsp;node&nbsp;C;&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/UL&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;&lt;BR&gt;<br>
WHERE&nbsp;are&nbsp;the&nbsp;messages&nbsp;stored?&lt;BR&gt;<br>
WHAT&nbsp;happens&nbsp;to&nbsp;the&nbsp;producer&nbsp;on&nbsp;ram&nbsp;node&nbsp;C&nbsp;when&nbsp;ram&nbsp;node&nbsp;B&nbsp;fails?&nbsp;(Does&nbsp;it&nbsp;block?&nbsp;Do&nbsp;messages&nbsp;continue&nbsp;to&nbsp;be&nbsp;delivered?&nbsp;Are&nbsp;messages&nbsp;to&nbsp;the&nbsp;client&nbsp;lost?)&lt;BR&gt;<br>
&lt;BR&gt;<br>
POSSIBLE&nbsp;ANSWERS:&lt;BR&gt;<br>
&lt;BR&gt;<br>
A)&nbsp;Messages&nbsp;are&nbsp;stored&nbsp;on&nbsp;disk&nbsp;node&nbsp;A&nbsp;but&nbsp;served&nbsp;up&nbsp;through&nbsp;ram&nbsp;node&nbsp;B.&lt;BR&gt;<br>
If&nbsp;ram&nbsp;node&nbsp;B&nbsp;goes&nbsp;down,&nbsp;messages&nbsp;are&nbsp;preserved&nbsp;and&nbsp;when&nbsp;the&nbsp;client&nbsp;reconnects&nbsp;on&nbsp;any&nbsp;node,&nbsp;the&nbsp;messages&nbsp;can&nbsp;be&nbsp;retrieved.&nbsp;&amp;nbsp;Since&nbsp;the&nbsp;messages&nbsp;are&nbsp;stored&nbsp;on&nbsp;disk&nbsp;node&nbsp;A,&nbsp;the&nbsp;producer&nbsp;connected&nbsp;on&nbsp;ram&nbsp;node&nbsp;C&nbsp;continues&nbsp;to&nbsp;publish&nbsp;messages&nbsp;to&nbsp;its&nbsp;topic&nbsp;exchange&nbsp;without&nbsp;blocking.&lt;BR&gt;<br>
&lt;BR&gt;<br>
B)&nbsp;They&nbsp;are&nbsp;stored&nbsp;on&nbsp;disk&nbsp;for&nbsp;ram&nbsp;node&nbsp;B.&nbsp;If&nbsp;ram&nbsp;node&nbsp;B&nbsp;goes&nbsp;down,&nbsp;the&nbsp;queue&nbsp;is&nbsp;unavailable&nbsp;for&nbsp;delivery,&nbsp;the&nbsp;producer&nbsp;on&nbsp;ram&nbsp;node&nbsp;C&nbsp;blocks&nbsp;on&nbsp;publishing&nbsp;of&nbsp;messages&nbsp;until&nbsp;ram&nbsp;node&nbsp;B&nbsp;comes&nbsp;back&nbsp;up&nbsp;again.&nbsp;(I&amp;#8217;m&nbsp;assuming&nbsp;metadata&nbsp;of&nbsp;the&nbsp;network&nbsp;is&nbsp;shared&nbsp;by&nbsp;the&nbsp;cluster&nbsp;therefore&nbsp;ram&nbsp;node&nbsp;C,&nbsp;&amp;#8220;knows&amp;#8221;&nbsp;it&nbsp;has&nbsp;bindings&nbsp;to&nbsp;a&nbsp;durable&nbsp;queue&nbsp;on&nbsp;node&nbsp;B,&nbsp;which&nbsp;is&nbsp;unresponsive,&nbsp;so&nbsp;it&nbsp;blocks).&lt;BR&gt;<br>
&lt;BR&gt;<br>
C)&nbsp;They&nbsp;are&nbsp;not&nbsp;stored&nbsp;on&nbsp;disk&nbsp;for&nbsp;ram&nbsp;node&nbsp;B&nbsp;(unless&nbsp;under&nbsp;memory&nbsp;pressure).&nbsp;&amp;nbsp;Any&nbsp;messages&nbsp;in&nbsp;memory&nbsp;are&nbsp;lost.&nbsp;C&nbsp;does&nbsp;not&nbsp;block&nbsp;on&nbsp;publishing&nbsp;of&nbsp;messages,&nbsp;but&nbsp;continues&nbsp;to&nbsp;publish&nbsp;messages&nbsp;to&nbsp;topic&nbsp;exchange.&nbsp;Bindings&nbsp;are&nbsp;non-existent&nbsp;until&nbsp;ram&nbsp;node&nbsp;B&nbsp;comes&nbsp;back&nbsp;up&nbsp;again,&nbsp;or&nbsp;the&nbsp;client&nbsp;reconnects/redeclares&nbsp;durable&nbsp;queue&nbsp;on&nbsp;another&nbsp;node&nbsp;for&nbsp;servicing.&lt;BR&gt;<br>
&lt;BR&gt;<br>
D)&nbsp;Something&nbsp;else?&lt;BR&gt;<br>
&lt;BR&gt;<br>
My&nbsp;inclination&nbsp;is&nbsp;to&nbsp;say&nbsp;A)&nbsp;is&nbsp;the&nbsp;right&nbsp;answer&nbsp;above.&nbsp;&amp;nbsp;&lt;BR&gt;<br>
&lt;BR&gt;<br>
However,&nbsp;I&nbsp;just&nbsp;finished&nbsp;a&nbsp;soak&nbsp;test&nbsp;where&nbsp;my&nbsp;durable&nbsp;queue&nbsp;on&nbsp;ram&nbsp;node&nbsp;B&nbsp;lost&nbsp;messages&nbsp;over&nbsp;the&nbsp;weekend&nbsp;due&nbsp;to&nbsp;a&nbsp;network&nbsp;hiccup&nbsp;that&nbsp;crashed&nbsp;ram&nbsp;node&nbsp;B.&nbsp;When&nbsp;it&nbsp;came&nbsp;back&nbsp;up&nbsp;again&nbsp;messages&nbsp;were&nbsp;lost.&nbsp;&amp;nbsp;As&nbsp;such,&nbsp;we&nbsp;are&nbsp;recommending&nbsp;our&nbsp;production&nbsp;configuration&nbsp;to&nbsp;be&nbsp;unclustered,&nbsp;disk&nbsp;node&nbsp;only&nbsp;until&nbsp;we&nbsp;better&nbsp;understand&nbsp;the&nbsp;benefits&nbsp;and&nbsp;use&nbsp;cases&nbsp;associated&nbsp;with&nbsp;clustering&nbsp;with&nbsp;RabbitMQ&nbsp;2.5.1&lt;BR&gt;<br>
&lt;BR&gt;<br>
A&nbsp;simple&nbsp;tutorial&nbsp;or&nbsp;explanation&nbsp;of&nbsp;&amp;#8220;To&nbsp;Disk&nbsp;Node&nbsp;or&nbsp;To&nbsp;Ram&nbsp;Node...&nbsp;that&nbsp;is&nbsp;the&nbsp;question&amp;#8221;&nbsp;would&nbsp;be&nbsp;great&nbsp;and&nbsp;useful&nbsp;for&nbsp;those&nbsp;of&nbsp;us&nbsp;implementing,&nbsp;learning&nbsp;and&nbsp;teaching&nbsp;rabbit&nbsp;to&nbsp;our&nbsp;organizations.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Regards,&lt;BR&gt;<br>
--rparra&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
