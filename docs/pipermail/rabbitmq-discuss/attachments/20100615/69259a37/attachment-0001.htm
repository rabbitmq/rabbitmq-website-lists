<tt>
This&nbsp;is&nbsp;probably&nbsp;way&nbsp;off&nbsp;the&nbsp;mark,&nbsp;and&nbsp;something&nbsp;you&nbsp;have&nbsp;sure&nbsp;to&nbsp;have&nbsp;tried:&nbsp;changing&nbsp;the&nbsp;GC&nbsp;parameters?&nbsp;Or&nbsp;is&nbsp;this&nbsp;not&nbsp;possible&nbsp;on&nbsp;the&nbsp;Android?&nbsp;I&nbsp;assume&nbsp;this&nbsp;is&nbsp;Java&nbsp;6?&lt;div&gt;How&nbsp;is&nbsp;Java&nbsp;started&nbsp;on&nbsp;Android&nbsp;or,&nbsp;perhaps&nbsp;better&nbsp;question,&nbsp;can&nbsp;you&nbsp;influence&nbsp;the&nbsp;GC&nbsp;parameters?&lt;br&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jun&nbsp;15,&nbsp;2010&nbsp;at&nbsp;02:36,&nbsp;Miguel&nbsp;Morales&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:therevoltingx@gmail.com&quot;&gt;therevoltingx@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hi&nbsp;all,&lt;br&gt;<br>
&lt;br&gt;<br>
For&nbsp;the&nbsp;past&nbsp;few&nbsp;months&nbsp;I&amp;#39;ve&nbsp;been&nbsp;developing&nbsp;a&nbsp;game&nbsp;using&nbsp;Android&nbsp;and&lt;br&gt;<br>
the&nbsp;rabbitmq&nbsp;java&nbsp;client&nbsp;with&nbsp;fair&nbsp;results.&lt;br&gt;<br>
Setting&nbsp;it&nbsp;up&nbsp;was&nbsp;fairly&nbsp;painless,&nbsp;however,&nbsp;I&amp;#39;ve&nbsp;run&nbsp;into&nbsp;one&nbsp;issue&lt;br&gt;<br>
that&amp;#39;s&nbsp;making&nbsp;one&nbsp;of&nbsp;the&nbsp;key&nbsp;parts&nbsp;of&nbsp;my&nbsp;game&nbsp;suffer.&lt;br&gt;<br>
In&nbsp;Android,&nbsp;every&nbsp;time&nbsp;the&nbsp;garbage&nbsp;collector&nbsp;runs,&nbsp;the&nbsp;CPU&nbsp;is&nbsp;busy&nbsp;for&lt;br&gt;<br>
a&nbsp;few&nbsp;milliseconds,&nbsp;~200ms.&lt;br&gt;<br>
This&nbsp;slows&nbsp;the&nbsp;frame&nbsp;rate&nbsp;and&nbsp;causes&nbsp;the&nbsp;game&nbsp;to&nbsp;stutter&nbsp;for&nbsp;a&nbsp;bit.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;problem&nbsp;is&nbsp;in&nbsp;consuming&nbsp;messages,&nbsp;I&nbsp;have&nbsp;a&nbsp;thread&nbsp;that&nbsp;simply&lt;br&gt;<br>
reads&nbsp;from&nbsp;a&nbsp;queue&nbsp;as&nbsp;fast&nbsp;as&nbsp;it&nbsp;can&nbsp;delivers&nbsp;the&nbsp;body&nbsp;bytes&nbsp;to&nbsp;the&lt;br&gt;<br>
game&nbsp;client.&lt;br&gt;<br>
However,&nbsp;in&nbsp;the&nbsp;library&nbsp;there&nbsp;are&nbsp;a&nbsp;bunch&nbsp;of&nbsp;small&nbsp;allocations&nbsp;that&lt;br&gt;<br>
happen&nbsp;which&nbsp;causes&nbsp;the&nbsp;GC&nbsp;to&nbsp;run&nbsp;at&nbsp;least&nbsp;once&nbsp;every&nbsp;10&nbsp;seconds,&lt;br&gt;<br>
using&nbsp;both&nbsp;a&nbsp;consumer&nbsp;and&nbsp;a&nbsp;basicGet.&lt;br&gt;<br>
&lt;br&gt;<br>
I&amp;#39;ve&nbsp;tried&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;code&nbsp;and&nbsp;remove&nbsp;allocations,&nbsp;and&nbsp;have&nbsp;got&lt;br&gt;<br>
the&nbsp;GC&nbsp;runs&nbsp;down&nbsp;to&nbsp;about&nbsp;1&nbsp;every&nbsp;40&nbsp;seconds.&nbsp; Still,&nbsp;that&nbsp;GC&nbsp;runs&nbsp;and&lt;br&gt;<br>
constant&nbsp;allocations&lt;br&gt;<br>
are&nbsp;hindering&nbsp;my&nbsp;ability&nbsp;to&nbsp;render&nbsp;some&nbsp;decent&nbsp;maps&nbsp;on&nbsp;the&nbsp;older&lt;br&gt;<br>
Android&nbsp;models&nbsp;(I&nbsp;use&nbsp;a&nbsp;G1)&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;also&nbsp;tried&nbsp;briefly&nbsp;to&nbsp;get&nbsp;the&nbsp;rabbitmq-c&nbsp;client&nbsp;working,&nbsp;and&nbsp;I&nbsp;was&lt;br&gt;<br>
successful.&lt;br&gt;<br>
However,&nbsp;I&nbsp;hit&nbsp;a&nbsp;roadblock&nbsp;when&nbsp;trying&nbsp;to&nbsp;send&nbsp;the&nbsp;body&nbsp;bytes&nbsp;back&nbsp;to&lt;br&gt;<br>
the&nbsp;JVM&nbsp;using&nbsp;JNI.&lt;br&gt;<br>
I&nbsp;keep&nbsp;running&nbsp;out&nbsp;of&nbsp;memory&nbsp;or&nbsp;crashing&nbsp;using&nbsp;a&nbsp;jbyteArray&nbsp;buffer.&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;C&nbsp;is&nbsp;pretty&nbsp;rusty&nbsp;so&nbsp;I&nbsp;was&nbsp;hoping&nbsp;someone&nbsp;had&nbsp;some&nbsp;suggestions&lt;br&gt;<br>
regarding&nbsp;that.&lt;br&gt;<br>
Ideally,&nbsp;I&amp;#39;d&nbsp;just&nbsp;be&nbsp;able&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;allocations&nbsp;while&lt;br&gt;<br>
consuming&nbsp;messages,&nbsp;any&nbsp;help&nbsp;is&nbsp;appreciated!&lt;br&gt;<br>
&lt;br&gt;<br>
I&amp;#39;ve&nbsp;created&nbsp;a&nbsp;test&nbsp;application&nbsp;for&nbsp;android&nbsp;to&nbsp;test&nbsp;out&nbsp;the&nbsp;different&lt;br&gt;<br>
consuming&nbsp;implementations&nbsp;in&nbsp;github:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://github.com/therevoltingx/rabbitmq_android_test&quot;&nbsp;target=&quot;_blank&quot;&gt;http://github.com/therevoltingx/rabbitmq_android_test&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;see&nbsp;how&nbsp;fiddling&nbsp;around&nbsp;with&nbsp;the&nbsp;internal&nbsp;java&nbsp;client&nbsp;code&nbsp;I&lt;br&gt;<br>
was&nbsp;able&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;some&nbsp;allocations&nbsp;here&nbsp;(simply&nbsp;by&nbsp;caching&lt;br&gt;<br>
Basic.Get):&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://github.com/therevoltingx/rabbitmq_android_test/blob/master/src/com/diastrofunk/rabbitmqtest/JavaTests.java#L74&quot;&nbsp;target=&quot;_blank&quot;&gt;http://github.com/therevoltingx/rabbitmq_android_test/blob/master/src/com/diastrofunk/rabbitmqtest/JavaTests.java#L74&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;see&nbsp;the&nbsp;C/JNI&nbsp;version&nbsp;here:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://github.com/therevoltingx/rabbitmq_android_test/blob/master/jni/ndktests.c&quot;&nbsp;target=&quot;_blank&quot;&gt;http://github.com/therevoltingx/rabbitmq_android_test/blob/master/jni/ndktests.c&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Any&nbsp;help&nbsp;in&nbsp;this&nbsp;would&nbsp;be&nbsp;appreciated!&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
Miguel&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://diastrofunk.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://diastrofunk.com&lt;/a&gt;,&nbsp;&lt;a&nbsp;href=&quot;http://developingthedream.blogspot.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://developingthedream.blogspot.com/&lt;/a&gt;,&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.youtube.com/user/revoltingx&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.youtube.com/user/revoltingx&lt;/a&gt;,&nbsp;~Isaiah&nbsp;55:8-9&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;---&lt;br&gt;John&nbsp;Apps&lt;br&gt;(49)&nbsp;171&nbsp;869&nbsp;1813&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
