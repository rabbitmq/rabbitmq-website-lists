<tt>
Simon,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you&nbsp;very&nbsp;much&nbsp;for&nbsp;your&nbsp;reply.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;font-size:13px;color:rgb(34,34,34);font-family:arial,sans-serif;background-color:rgb(255,255,255)&quot;&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;font-size:13px;color:rgb(34,34,34);font-family:arial,sans-serif;background-color:rgb(255,255,255)&quot;&gt;Using&nbsp;HIPE&nbsp;compilation&nbsp;reduced&nbsp;the&nbsp;flow&nbsp;control&nbsp;significantly.I&nbsp;now&nbsp;get&nbsp;flow&nbsp;controlled&nbsp;at&nbsp;around&nbsp;4.1&nbsp;MB/S&nbsp;to&nbsp;7.2&nbsp;MB/S&nbsp;.However&nbsp;flow&nbsp;control&nbsp; seems to&nbsp;steadily&nbsp;remain&nbsp;on&nbsp;at&nbsp;3.8MB/s&nbsp;for&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;time&nbsp;RabbitMQ&nbsp;runs.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;font-size:13px;color:rgb(34,34,34);font-family:arial,sans-serif;background-color:rgb(255,255,255)&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;font-size:13px;color:rgb(34,34,34);font-family:arial,sans-serif;background-color:rgb(255,255,255)&quot;&gt;<br>
<br>
Each&nbsp;message&nbsp;is&nbsp;about&nbsp;approximately&nbsp;300&nbsp;bytes&nbsp;at&nbsp;most&nbsp;800&nbsp;bytes&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
Multiple&nbsp;connections(independent&nbsp;applications)&nbsp;will&nbsp;be&nbsp;made&nbsp;from&nbsp;the&nbsp;same&nbsp;host&nbsp;to&nbsp;the&nbsp;RabbitMQ&nbsp;Server.&nbsp;Each&nbsp;connection&nbsp;will&nbsp;be&nbsp;sending&nbsp;small&nbsp;messages&nbsp;really&nbsp;fast&nbsp;to&nbsp;the&nbsp;broker(RabbitMQ&nbsp;Server)&lt;u&gt;&lt;/u&gt;&lt;u&gt;&lt;/u&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;u&gt;&lt;/u&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
<br>
What&nbsp;optimizations&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;increase&nbsp;throughput&nbsp;on&nbsp;RabbitMQ&nbsp;Server&nbsp;or&nbsp; &lt;span&nbsp;style=&quot;background-color:transparent&quot;&gt;the&nbsp;routing&nbsp;part&nbsp;of&nbsp;the&nbsp;pipeline&nbsp;?&nbsp;Would&nbsp;cluster&nbsp;be&nbsp;the&nbsp;next&nbsp;option&nbsp;to&nbsp;evaluate&nbsp;?&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
<br>
&lt;u&gt;&lt;/u&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;u&gt;&lt;/u&gt; &lt;u&gt;&lt;/u&gt;&lt;/p&gt;&lt;font&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Is&nbsp;there&nbsp;any&nbsp;output&nbsp;that&nbsp;i&nbsp;can&nbsp;gather&nbsp;to&nbsp;analyze&nbsp;which&nbsp;part&nbsp;of&nbsp;the pipeline is&nbsp;the&nbsp;bottleneck&nbsp;?&lt;/font&gt;&lt;br&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;background-color:rgb(255,255,255)&quot;&gt;--&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;background-color:rgb(255,255,255)&quot;&gt;<br>
<br>
Dwayne&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Oct&nbsp;12,&nbsp;2012&nbsp;at&nbsp;7:14&nbsp;AM,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;On&nbsp;11/10/12&nbsp;13:14,&nbsp;Dwayne&nbsp;Campbell&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;Guys,&lt;br&gt;<br>
&lt;br&gt;<br>
RabbitMQ&nbsp;now&nbsp;turns&nbsp;on&nbsp;flow&nbsp;control&nbsp;often&nbsp;even&nbsp;at&nbsp;1.5&nbsp;MB/s.&nbsp; I&nbsp;have&nbsp;read&lt;br&gt;<br>
before&nbsp;to&nbsp;increase&nbsp;the&nbsp;TCP&nbsp;buffer&nbsp;size,&nbsp;however&nbsp;I&nbsp;do&nbsp;not&nbsp;have&nbsp;access&nbsp;to&lt;br&gt;<br>
increase&nbsp;the&nbsp;TCP&nbsp;buffer&nbsp;size&nbsp;o&nbsp;the&nbsp;machines.&lt;br&gt;<br>
&lt;br&gt;<br>
How&nbsp;can&nbsp;i&nbsp;disable&nbsp;Per-Connection&nbsp;Flow&nbsp;Control&nbsp;?&nbsp; &nbsp;Memory&nbsp;based&nbsp; and&nbsp;Disk&lt;br&gt;<br>
based&nbsp;control&nbsp;is&nbsp;enough&nbsp;for&nbsp;me.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Hi.&nbsp;You&nbsp;should&nbsp;be&nbsp;aware&nbsp;that&nbsp;the&nbsp;flow&nbsp;control&nbsp;is&nbsp;indicating&nbsp;that&nbsp;some&nbsp;part&nbsp;of&nbsp;the&nbsp;message&nbsp;pipeline&nbsp;is&nbsp;overloaded.&nbsp;If&nbsp;you&nbsp;were&nbsp;to&nbsp;turn&nbsp;off&nbsp;flow&nbsp;control&nbsp;it&nbsp;would&nbsp;just&nbsp;lead&nbsp;to&nbsp;messages&nbsp;backing&nbsp;up&nbsp;ahead&nbsp;of&nbsp;that&nbsp;part&nbsp;of&nbsp;the&nbsp;pipeline&nbsp;-&nbsp;leading&nbsp;to&nbsp;memory&nbsp;use&nbsp;ballooning&nbsp;very&nbsp;rapidly&nbsp;and&nbsp;no&nbsp;increase&nbsp;in&nbsp;throughput.&lt;br&gt;<br>
<br>
<br>
<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;are&nbsp;sending&nbsp;lots&nbsp;of&nbsp;tiny&nbsp;messages&nbsp;then&nbsp;the&nbsp;routing&nbsp;part&nbsp;of&nbsp;the&nbsp;pipeline&nbsp;can&nbsp;be&nbsp;the&nbsp;most&nbsp;expensive&nbsp;-&nbsp;my&nbsp;workstation&nbsp;manages&nbsp;only&nbsp;about&nbsp;2.5MB/s&nbsp;with&nbsp;zero-length&nbsp;messages.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;advice&nbsp;about&nbsp;increasing&nbsp;the&nbsp;buffer&nbsp;size&nbsp;is&nbsp;to&nbsp;allow&nbsp;your&nbsp;machine&nbsp;to&nbsp;handle&nbsp;short&nbsp;bursts&nbsp;of&nbsp;messages,&nbsp;at&nbsp;higher&nbsp;rates&nbsp;than&nbsp;it&nbsp;can&nbsp;manage&nbsp;in&nbsp;a&nbsp;steady&nbsp;state.&nbsp;It&nbsp;won&amp;#39;t&nbsp;get&nbsp;you&nbsp;a&nbsp;higher&nbsp;steady&nbsp;state&nbsp;rate.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;process&nbsp;messages&nbsp;faster&nbsp;on&nbsp;a&nbsp;single&nbsp;machine&nbsp;you&nbsp;might&nbsp;enable&nbsp;HiPE&nbsp;compilation:&nbsp;see&nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/configure.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/&lt;u&gt;&lt;/u&gt;configure.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;VMware&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
