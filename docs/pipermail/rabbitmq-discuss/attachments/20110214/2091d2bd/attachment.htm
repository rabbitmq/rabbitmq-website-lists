<tt>
Hello,&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;this&nbsp;is&nbsp;a&nbsp;piece&nbsp;of&nbsp;code&nbsp;to&nbsp;process&nbsp;a&nbsp;message:&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;public&nbsp;function&nbsp;processMessage($message)&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&gt;<br>
{&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;   &nbsp;try{ &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;        &nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;execute(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;$message&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;);&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&gt;<br>
        &nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;$this-&amp;gt;_queue-&amp;gt;remove($message);&lt;/span&gt;&lt;br&gt;                 &nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;$this-&amp;gt;_queue-&amp;gt;commit();&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;   &nbsp;}&nbsp;catch&nbsp;(Exception&nbsp;$e)&nbsp;{&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;           &nbsp;$this-&amp;gt;_queue-&amp;gt;getChannel()-&amp;gt;basic_reject($message-&amp;gt;getId(),&nbsp;true);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;           &nbsp;//$this-&amp;gt;_queue-&amp;gt;getChannel()-&amp;gt;basic_recover(true);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;           &nbsp;$this-&amp;gt;_queue-&amp;gt;rollback();&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;   &nbsp;}&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;All&nbsp;I&nbsp;want&nbsp;to&nbsp;do&nbsp;is&nbsp;just&nbsp;to&nbsp;redeliver&nbsp;a&nbsp;message&nbsp;after&nbsp;some&nbsp;exception&nbsp;occurs.&nbsp;But&nbsp;if&nbsp;I&nbsp;use&nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;basic_recover(true)&lt;/span&gt;I&nbsp;get&nbsp;an&nbsp;error&nbsp;-&nbsp;&amp;quot;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;PRECONDITION_FAILED&nbsp;-&nbsp;unknown&nbsp;delivery&nbsp;tag&nbsp;2&lt;/span&gt;&amp;quot;.&nbsp;&lt;br&gt;<br>
&lt;br&gt;Then&nbsp;I&nbsp;have&nbsp;noticed&nbsp;for&nbsp;example&nbsp;when&nbsp;I&nbsp;ask&nbsp;to&nbsp;redeliver&nbsp;a&nbsp;message&nbsp;with&nbsp;delivery&nbsp;tag&nbsp;[1]&nbsp;(because&nbsp;I&nbsp;have&nbsp;got&nbsp;an&nbsp;exception)&nbsp;I&nbsp;get&nbsp;a&nbsp;second&nbsp;message&nbsp;with&nbsp;delivery&nbsp;tag&nbsp;[2]&nbsp;and&nbsp;once&nbsp;I&nbsp;try&nbsp;to&nbsp;commit&nbsp;it&nbsp;I&nbsp;get&nbsp;&amp;quot;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;PRECONDITION_FAILED&nbsp;-&nbsp;unknown&nbsp;delivery&nbsp;tag&nbsp;2&lt;/span&gt;&amp;quot;.&nbsp;Its&nbsp;like&nbsp;if&nbsp;X&nbsp;message&nbsp;fails&nbsp;and&nbsp;I&nbsp;ask&nbsp;to&nbsp;redeliver&nbsp;it,&nbsp;next&nbsp;X+1&nbsp;message&nbsp;that&nbsp;arrives,&nbsp;will&nbsp;fail&nbsp;witn&nbsp;an&nbsp;error&nbsp;&amp;quot;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;PRECONDITION_FAILED&nbsp;-&nbsp;unknown&nbsp;delivery&nbsp;tag&nbsp;X+1&lt;/span&gt;&amp;quot;&nbsp;when&nbsp;i&nbsp;will&nbsp;try&nbsp;to&nbsp;commit&nbsp;it.&lt;br&gt;<br>
&lt;br&gt;Then&nbsp;I&nbsp;have&nbsp;tried&nbsp;to&nbsp;use&nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;basic_reject($message-&amp;gt;getId(),&nbsp;true);&nbsp;&lt;/span&gt;and&nbsp;it&nbsp;works,&nbsp;all&nbsp;messages&nbsp;are&nbsp;redelivered.&lt;br&gt;&lt;br&gt;Perhaps&nbsp;I&nbsp;am&nbsp;doing&nbsp;something&nbsp;wrong&nbsp;here&nbsp;regarding&nbsp;basic_recover?&nbsp;&lt;br&gt;<br>
&lt;br&gt;I&nbsp;am&nbsp;using&nbsp;RabbitMQ&nbsp;2.3.1&lt;br&gt;&lt;br&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;answers!&lt;br&gt;&lt;br&gt;Tomas&lt;br&gt;&nbsp;<br>

</tt>
