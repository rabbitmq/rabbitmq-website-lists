<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;&lt;div&gt;Hi,&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm&nbsp;using&nbsp;web-stomp&nbsp;plugin&nbsp;+&nbsp;SockJS/Stomp.js&nbsp;on&nbsp;PhoneGap&nbsp;and&nbsp;observed&nbsp;that&nbsp;under&nbsp;circumstances&nbsp;(probably&nbsp;related&nbsp;to&nbsp;3G&nbsp;network&nbsp;instability),&nbsp;traffic&nbsp;can&nbsp;stop&nbsp;without&nbsp;triggering&nbsp;a&nbsp;connection&nbsp;error&nbsp;on&nbsp;the&nbsp;STOMP&nbsp;client.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;solve&nbsp;this&nbsp;problem,&nbsp;I&nbsp;thought&nbsp;that&nbsp;I&nbsp;may&nbsp;use&nbsp;heart&nbsp;beat&nbsp;so&nbsp;I&nbsp;added&nbsp;the&nbsp;following&nbsp;to&nbsp;the&nbsp;Javascript&nbsp;using&nbsp;stomp.js:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;function&nbsp;Connect()&nbsp;{&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;console.log('Connecting...');&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Connect&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ws&nbsp;=&nbsp;new&nbsp;SockJS(mq_url);&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;=&nbsp;Stomp.over(ws);&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;client.heartbeat.outgoing&nbsp;=&nbsp;5000;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;5000&nbsp;means&nbsp;client&nbsp;will&nbsp;send&nbsp;heart&nbsp;beat&nbsp;every&nbsp;5000ms&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;client.heartbeat.incoming&nbsp;=&nbsp;5000;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;0&nbsp;means&nbsp;client&nbsp;does&nbsp;not&nbsp;want&nbsp;to&nbsp;receive&nbsp;heartbeats&nbsp;from&nbsp;server&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;client.debug&nbsp;=&nbsp;function&nbsp;(str)&nbsp;{&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#debug&quot;).append(timeStamp()&nbsp;+&nbsp;str&nbsp;+&nbsp;&quot;&lt;br&gt;&quot;);&nbsp;&nbsp;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;varmessage&nbsp;=&nbsp;str;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;};&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;client.connect(&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;mq_username,&nbsp;mq_password,&nbsp;on_connect,&nbsp;on_connect_error,&nbsp;mq_vhost);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However,&nbsp;the&nbsp;following&nbsp;error&nbsp;is&nbsp;thrown&nbsp;by&nbsp;the&nbsp;STOMP&nbsp;JS&nbsp;client,&nbsp;which&nbsp;I&nbsp;assume&nbsp;is&nbsp;because&nbsp;the&nbsp;broker&nbsp;is&nbsp;not&nbsp;sending&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&nbsp;heart&nbsp;beat&nbsp;(which&nbsp;I&nbsp;assumed&nbsp;so&nbsp;as&nbsp;I&nbsp;don't&nbsp;know&nbsp;how&nbsp;to&nbsp;check).&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&gt;&nbsp;PING&lt;/div&gt;&lt;div&gt;-&gt;&nbsp;PING&lt;/div&gt;&lt;div&gt;did&nbsp;not&nbsp;receive&nbsp;server&nbsp;activity&nbsp;for&nbsp;the&nbsp;last&nbsp;10017ms&lt;/div&gt;&lt;div&gt;Whoops!&nbsp;&nbsp;Lost&nbsp;connection&nbsp;to&nbsp;undefined&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;I&nbsp;tried&nbsp;adding&nbsp;param&nbsp;to&nbsp;rabbitmq.config,&nbsp;but&nbsp;that&nbsp;didn't&nbsp;appear&nbsp;to&nbsp;work.&nbsp;The&nbsp;doc&nbsp;doesn't&nbsp;mention&nbsp;whether&nbsp;the&nbsp;heartbeat&nbsp;parameter&nbsp;is&nbsp;for&nbsp;client&nbsp;or&nbsp;server&nbsp;heartbeat.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;[&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{rabbit,&nbsp;[&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{cluster_nodes,&nbsp;{['rabbit@server'],&nbsp;disc}},&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{cluster_partition_handling,&nbsp;autoheal},&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{heartbeat,&nbsp;1}&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]},&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Rgds,&lt;/div&gt;&lt;div&gt;Joshua&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
