<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Emile&nbsp;,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;reply.&nbsp;I&nbsp;had&nbsp;also&nbsp;looked&nbsp;at&nbsp;the&nbsp;link&nbsp;you&nbsp;shared&nbsp;in&nbsp;the&nbsp;reply. &lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;understand&nbsp;that&nbsp;throughout&nbsp;is&nbsp;a&nbsp;function&nbsp;of&nbsp;different&nbsp;parameters&nbsp;and&nbsp;it&nbsp;would&nbsp;behave&nbsp;based&nbsp;on&nbsp;configuration&nbsp;of&nbsp;these&nbsp;parameters.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;But&nbsp;since&nbsp;I&nbsp;am&nbsp;doing&nbsp;a&nbsp;detailed&nbsp;performance&nbsp;study,&nbsp;my&nbsp;goal&nbsp;will&nbsp;be&nbsp;to&nbsp;try&nbsp;different&nbsp;parameter&nbsp;configuration&nbsp;and&nbsp;see&nbsp;the&nbsp;difference&nbsp;in&nbsp;throughout&nbsp;,&nbsp;processor&nbsp;load&nbsp;etc.&nbsp;etc&nbsp;so&nbsp;that&nbsp;I&nbsp;finally&nbsp;propose&nbsp;a&nbsp;suitable&nbsp;configuration.&nbsp;My&nbsp;requirement&nbsp;is&nbsp;to&nbsp;atleast&nbsp;have&nbsp;10,000&nbsp;msg/sec.&nbsp;For&nbsp;maintaining&nbsp;this&nbsp;throughput&nbsp;requirement&nbsp;with&nbsp;zero&nbsp;message&nbsp;loss&nbsp;and&nbsp;100%&nbsp;availability&nbsp;of&nbsp;broker,&nbsp;I&nbsp;started&nbsp;with&nbsp;4&nbsp;node&nbsp;cluster&nbsp;with&nbsp;durable&nbsp;queues&nbsp;and&nbsp;exchanges.&nbsp;Since&nbsp;I&nbsp;knew&nbsp;that&nbsp;persistent&nbsp;messages&nbsp;would&nbsp;trigger&nbsp;disk&nbsp;activity,&nbsp;first&nbsp;I&nbsp;want&nbsp;to&nbsp;try&nbsp;with&nbsp;non-persistent&nbsp;messages&nbsp;and&nbsp;see&nbsp;what&nbsp;is&nbsp;throghput,&nbsp;processor&nbsp;utilization&nbsp;etc.&nbsp;etc. &lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;have&nbsp;very&nbsp;high&nbsp;end&nbsp;server&nbsp;with&nbsp;20&nbsp;CPUs&nbsp;and&nbsp;120&nbsp;GB&nbsp;of&nbsp;RAM&nbsp;so&nbsp;I&nbsp;think&nbsp;resources&nbsp;wise&nbsp;it&amp;#39;s&nbsp;not&nbsp;the&nbsp;bottleneck.&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;And&nbsp;as&nbsp;Tim&nbsp;pointed&nbsp;out&nbsp;before,&nbsp;I&nbsp;am&nbsp;also&nbsp;suspecting&nbsp;that&nbsp;bottleneck&nbsp;might&nbsp;be&nbsp;in&nbsp;the&nbsp;way&nbsp;I&nbsp;am&nbsp;using&nbsp;publisher/confirm&nbsp;and&nbsp;consumer&nbsp;ack.&nbsp;I&nbsp;have&nbsp;shared&nbsp;my&nbsp;scripts&nbsp;also&nbsp;now.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Did&nbsp;u&nbsp;and&nbsp;Tim&nbsp;received&nbsp;my&nbsp;scripts&nbsp;?&lt;/div&gt;&lt;div&nbsp;style&gt;It&nbsp;would&nbsp;really&nbsp;help&nbsp;me&nbsp;if&nbsp;you&nbsp;guys&nbsp;can&nbsp;have&nbsp;quick&nbsp;look&nbsp;at&nbsp;attached&nbsp;scripts&nbsp;and&nbsp;guide&nbsp;me&nbsp;if&nbsp;the&nbsp;way&nbsp;I&nbsp;am&nbsp;using&nbsp;publisher&nbsp;confirm&nbsp;and&nbsp;consumer&nbsp;ack&nbsp;is&nbsp;efficient&nbsp;and&nbsp;correct&nbsp;or&nbsp;not&nbsp;for&nbsp;securing&nbsp;message&nbsp;deliveries&nbsp;both&nbsp;by&nbsp;rabbitMQ&nbsp;server&nbsp;and&nbsp;then&nbsp;by&nbsp;consumer/s.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;also&nbsp;have&nbsp;configured&nbsp;prefetch&nbsp;count&nbsp;value&nbsp;but&nbsp;still&nbsp;I&nbsp;don&amp;#39;t&nbsp;see&nbsp;any&nbsp;difference&nbsp;in&nbsp;my&nbsp;throughout&nbsp;bcoz&nbsp;may&nbsp;be&nbsp;bottleneck&nbsp;is&nbsp;in&nbsp;my&nbsp;producer.&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Also,&nbsp;I&nbsp;tried&nbsp;to&nbsp;simulate&nbsp;four&nbsp;producers&nbsp;(each&nbsp;opening&nbsp;up&nbsp;it&amp;#39;s&nbsp;own&nbsp;TCP&nbsp;connection&nbsp;to&nbsp;server&nbsp;,&nbsp;each&nbsp;have&nbsp;it&amp;#39;s&nbsp;own&nbsp;channel&nbsp;and&nbsp;exchange)&nbsp;but&nbsp;I&nbsp;still&nbsp;don&amp;#39;t&nbsp;get&nbsp;higher&nbsp;throughput&nbsp;than&nbsp;300&nbsp;msg/sec.&nbsp;I&nbsp;have&nbsp;a&nbsp;single&nbsp;python&nbsp;script,&nbsp;which&nbsp;starts&nbsp;four&nbsp;producers&nbsp;and&nbsp;it&amp;#39;s&nbsp;only&nbsp;one&nbsp;process.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Here&nbsp;I&nbsp;am&nbsp;suspecting&nbsp;that&nbsp;since&nbsp;it&amp;#39;s&nbsp;just&nbsp;a&nbsp;single&nbsp;process,&nbsp;it&nbsp;still&nbsp;behave&nbsp;the&nbsp;same&nbsp;as&nbsp;single&nbsp;producer.&nbsp;If&nbsp;I&nbsp;run&nbsp;the&nbsp;same&nbsp;script&nbsp;again&nbsp;,y&nbsp;throughout&nbsp;doubles&nbsp;which&nbsp;is&nbsp;600&nbsp;msg/sec&nbsp;and&nbsp;I&nbsp;see&nbsp;that&nbsp;there&nbsp;are&nbsp;two&nbsp;processes&nbsp;each&nbsp;connected&nbsp;with&nbsp;one&nbsp;producer&nbsp;script. &lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;can&nbsp;see&nbsp;through&nbsp;web&nbsp;interface&nbsp;of&nbsp;rabbitMQ&nbsp;that&nbsp;my&nbsp;automatic&nbsp;producer&nbsp;script&nbsp;works&nbsp;since&nbsp;connection,&nbsp;channel&nbsp;gets&nbsp;updated&nbsp;accordingly.&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;also&nbsp;wanted&nbsp;to&nbsp;know&nbsp;what&nbsp;is&nbsp;internal&nbsp;mechanism&nbsp;within&nbsp;basic_publish&nbsp;and&nbsp;basic_consume.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;I&nbsp;learnt&nbsp;that&nbsp;basic_consume&nbsp;is&nbsp;better&nbsp;choice&nbsp;than&nbsp;basic_get&nbsp;since&nbsp;server&nbsp;will&nbsp;directly&nbsp;send&nbsp;messages&nbsp;to&nbsp;listening&nbsp;consumer&nbsp;without&nbsp;consumer&nbsp;polling&nbsp;it. &lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;hope,&nbsp;I&nbsp;have&nbsp;explained&nbsp;myself&nbsp;well&nbsp;and&nbsp;in&nbsp;detail&nbsp;manner&nbsp;for&nbsp;you&nbsp;guys&nbsp;to&nbsp;able&nbsp;to&nbsp;help/guide&nbsp;me.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Thanks&nbsp;!&lt;/div&gt;&lt;div&nbsp;style&gt;//Priyanki.&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jun&nbsp;25,&nbsp;2013&nbsp;at&nbsp;1:06&nbsp;PM,&nbsp;Emile&nbsp;Joubert&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Hi,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
On&nbsp;24/06/13&nbsp;16:55,&nbsp;Priyanki&nbsp;Vashi&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Also&nbsp;configured&nbsp;HAproxy&nbsp;TCP&nbsp;Load&nbsp;balancer&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;just&nbsp;provide&lt;br&gt;<br>
&amp;gt;&nbsp;single&nbsp;port&nbsp;to&nbsp;connect&nbsp;to&nbsp;the&nbsp;Cluster.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;A&nbsp;mirrored&nbsp;queue&nbsp;will&nbsp;be&nbsp;slower&nbsp;than&nbsp;a&nbsp;queue&nbsp;on&nbsp;a&nbsp;single&nbsp;server&nbsp;of&nbsp;the&lt;br&gt;<br>
same&nbsp;spec.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;-1&nbsp;producer&nbsp;and&nbsp;No&nbsp;consumer&nbsp;and&nbsp;no&nbsp;queue&nbsp;binded&nbsp;to&nbsp;exchange&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;In&nbsp;this&nbsp;case&nbsp;the&nbsp;broker&nbsp;throws&nbsp;messages&nbsp;away&nbsp;without&nbsp;queueing&nbsp;so&nbsp;it&lt;br&gt;<br>
should&nbsp;be&nbsp;extremely&nbsp;fast.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Also&nbsp;what&nbsp;points&nbsp;to&nbsp;take&nbsp;care,&nbsp;in&nbsp;order&nbsp;to&nbsp;improve&nbsp;throughput&nbsp;?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;There&nbsp;are&nbsp;several&nbsp;factors&nbsp;that&nbsp;could&nbsp;have&nbsp;a&nbsp;bearing&nbsp;on&nbsp;the&nbsp;overall&lt;br&gt;<br>
throughput.&nbsp;Here&nbsp;is&nbsp;a&nbsp;similar&nbsp;question&nbsp;I&nbsp;answered&nbsp; recently:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2013-March/026132.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2013-March/026132.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;numbers&nbsp;you&nbsp;quote&nbsp;are&nbsp;very&nbsp;low.&nbsp;For&nbsp;comparison,&nbsp;measure&nbsp;the&nbsp;network&lt;br&gt;<br>
and&nbsp;IO&nbsp;bandwidth&nbsp;by&nbsp;piping&nbsp;traffic&nbsp;across&nbsp;the&nbsp;network&nbsp;to&nbsp;disk&nbsp;(e.g.&lt;br&gt;<br>
using&nbsp;netcat)&nbsp;to&nbsp;determine&nbsp;what&nbsp;performance&nbsp;your&nbsp;servers&nbsp;are&nbsp;capable&nbsp;of.&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-Emile&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
