<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi, &lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;response. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;followed&nbsp;your&nbsp;advice&nbsp;and&nbsp;here&nbsp;are&nbsp;my&nbsp;results.&lt;/div&gt;&lt;div&gt; I&nbsp;see&nbsp;myself&nbsp;in&nbsp;the&nbsp;connection&nbsp;list&nbsp;when&nbsp;I&nbsp;invoke&nbsp;a&nbsp;connection&nbsp;from&nbsp;a&nbsp;computer&nbsp;that&nbsp;gets&nbsp;the&nbsp;exception.&nbsp;I&nbsp;see&nbsp;it&nbsp;with&nbsp;&amp;quot;starting&amp;quot;&nbsp; status&nbsp;and&nbsp;instantly&nbsp;it&nbsp;disappears.&nbsp;(I&nbsp;use&nbsp;new&nbsp;exchange&nbsp;name&nbsp;and&nbsp;no&nbsp;exchange&nbsp;is&nbsp;created)&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;tried&nbsp;to&nbsp;follow&nbsp;your&nbsp;advice&nbsp;about&nbsp;the&nbsp;tracer&nbsp;but&nbsp;i&nbsp;didn&amp;#39;t&nbsp;find&nbsp;enough&nbsp;info&nbsp;about&nbsp;the&nbsp;file&nbsp;runjava.bat&nbsp;in&nbsp;2.3.1&nbsp;(it&nbsp;exists&nbsp;only&nbsp;in&nbsp;the&nbsp;1.7.0&nbsp;package.&nbsp;not&nbsp;the&nbsp;2.3.1.)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;it&nbsp;happens&nbsp;from&nbsp;almost&nbsp;half&nbsp;of&nbsp;the&nbsp;servers.&nbsp;not&nbsp;only&nbsp;the&nbsp;ones&nbsp;with&nbsp;the&nbsp;NAT. &lt;/div&gt;<br>
&lt;div&gt;thanks.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Feb&nbsp;28,&nbsp;2011&nbsp;at&nbsp;5:34&nbsp;PM,&nbsp;Emile&nbsp;Joubert&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;is&nbsp;no&nbsp;reason&nbsp;why&nbsp;an&nbsp;AMQP&nbsp;connection&nbsp;won&amp;#39;t&nbsp;work&nbsp;over&nbsp;NAT.&nbsp;This&nbsp;is&nbsp;equally&nbsp;for&nbsp;version&nbsp;1.7.0&nbsp;and&nbsp;2.3.1.&nbsp;It&nbsp;is&nbsp;likely&nbsp;that&nbsp;the&nbsp;cause&nbsp;for&nbsp;this&nbsp;error&nbsp;is&nbsp;at&nbsp;the&nbsp;network&nbsp;layer.&lt;br&gt;<br>
&lt;br&gt;<br>
Does&nbsp;the&nbsp;broker&nbsp;logfile&nbsp;contain&nbsp;any&nbsp;other&nbsp;relevant&nbsp;messages&nbsp;other&nbsp;than&nbsp;the&nbsp;one&nbsp;about&nbsp;the&nbsp;abrupt&nbsp;disconnection?&lt;br&gt;<br>
&lt;br&gt;<br>
Can&nbsp;you&nbsp;get&nbsp;&amp;quot;rabbitmqctl&nbsp;list_connections&amp;quot;&nbsp;on&nbsp;the&nbsp;broker&nbsp;to&nbsp;list&nbsp;the&nbsp;connection&nbsp;from&nbsp;the&nbsp;client&nbsp;at&nbsp;any&nbsp;time?&lt;br&gt;<br>
Are&nbsp;you&nbsp;able&nbsp;to&nbsp;establish&nbsp;an&nbsp;AMQP&nbsp;channel&nbsp;and&nbsp;issue&nbsp;the&nbsp;basicConsume(),&nbsp;or&nbsp;does&nbsp;the&nbsp;error&nbsp;occur&nbsp;earlier&nbsp;during&nbsp;connection&nbsp;establishment?&lt;br&gt;<br>
&lt;br&gt;<br>
Do&nbsp;you&nbsp;have&nbsp;any&nbsp;way&nbsp;of&nbsp;checking&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;connection&nbsp;on&nbsp;the&nbsp;NAT&nbsp;device?&lt;br&gt;<br>
&lt;br&gt;<br>
Establishing&nbsp;the&nbsp;AMQP&nbsp;connection&nbsp;via&nbsp;the&nbsp;AMQP&nbsp;Tracer&nbsp;(&nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/javadoc/com/rabbitmq/tools/Tracer.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/javadoc/com/rabbitmq/tools/Tracer.html&lt;/a&gt;&nbsp;)&nbsp;might&nbsp;also&nbsp;provide&nbsp;useful&nbsp;diagnostic&nbsp;information.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-Emile&lt;/font&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;27/02/11&nbsp;13:06,&nbsp;mysurf&nbsp;mail&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;,&lt;br&gt;<br>
I&nbsp;am&nbsp;writing&nbsp;a&nbsp;new&nbsp;mail&nbsp;because&nbsp;my&nbsp;last&nbsp;issue&nbsp;was&nbsp;solved&nbsp;.&lt;br&gt;<br>
It&nbsp;is&nbsp;just&nbsp;that&nbsp;on&nbsp;a&nbsp;certain&nbsp;computer&nbsp;my&nbsp;application&nbsp;stopped&nbsp;working.&lt;br&gt;<br>
So&nbsp;it&nbsp;is&nbsp;a&nbsp;new&nbsp;issue&nbsp;and&nbsp;I&nbsp;will&nbsp;explain&nbsp;and&nbsp;paste&nbsp;the&nbsp;exception&nbsp;below.&lt;br&gt;<br>
&lt;br&gt;<br>
Basically,&nbsp;I&nbsp;did&nbsp;three&nbsp;things&nbsp;:&lt;br&gt;<br>
1.&nbsp;I&nbsp;upgraded&nbsp;from&nbsp;1.7.0&nbsp;to&nbsp;2.3.1&nbsp;(installed&nbsp;a&nbsp;new&nbsp;erlang&nbsp;also)&lt;br&gt;<br>
2.&nbsp;I&nbsp;upgraded&nbsp;the&nbsp;client&nbsp;jars&lt;br&gt;<br>
3.&nbsp;changed&nbsp;the&nbsp;protocol&nbsp;to&nbsp;ack&nbsp;=&nbsp;true;&lt;br&gt;<br>
&lt;br&gt;<br>
channel.basicConsume(queueName,&nbsp;true,&nbsp;queueingConsumer);&lt;br&gt;<br>
&lt;br&gt;<br>
well,&nbsp;that&nbsp;certain&nbsp;computer&nbsp;is&nbsp;behind&nbsp;a&nbsp;firewall,&nbsp;and&nbsp;has&nbsp;a&nbsp;NAT&nbsp;(Network&lt;br&gt;<br>
Address&nbsp;Translation&nbsp;).&lt;br&gt;<br>
It&nbsp;did&nbsp;work&nbsp;prior&nbsp;to&nbsp;the&nbsp;upgrade&nbsp;with&nbsp;the&nbsp;NAT&nbsp;(mySQL&nbsp;also&nbsp;handles&nbsp;it&lt;br&gt;<br>
pretty&nbsp;well).&lt;br&gt;<br>
with&nbsp;the&nbsp;same&nbsp;ports.&lt;br&gt;<br>
Maybe&nbsp;it&nbsp;is&nbsp;the&nbsp;bidirectional&nbsp;channel&nbsp;(since&nbsp;I&nbsp;added&nbsp;acking?&nbsp;I&nbsp;dont&lt;br&gt;<br>
think&nbsp;so...).&lt;br&gt;<br>
&lt;br&gt;<br>
what&nbsp;I&nbsp;can&nbsp;see&nbsp;is&nbsp;that.&lt;br&gt;<br>
when&nbsp;the&nbsp;client&nbsp;tries&nbsp;to&nbsp;connect&nbsp;it&nbsp;writes&nbsp;in&nbsp;the&nbsp;logs&lt;br&gt;<br>
&lt;br&gt;<br>
Connection&nbsp;closed&nbsp;abruptly&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;now,&nbsp;behold,&nbsp;the&nbsp;exception&nbsp;:&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
[...]&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
