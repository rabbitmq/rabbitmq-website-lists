<tt>
Unfortunately&nbsp;the&nbsp;API&nbsp;for&nbsp;rabbitmq-c&nbsp;is&nbsp;rather&nbsp;low-level&nbsp;when&nbsp;it&nbsp;comes&nbsp;to&nbsp;reading&nbsp;messages&nbsp;from&nbsp;the&nbsp;broker,&nbsp;so&nbsp;when&nbsp;using&nbsp;amqp_basic_get()&nbsp;or&nbsp;amqp_basic_consume(),&nbsp;you&nbsp;will&nbsp;have&nbsp;to&nbsp;deal&nbsp;with&nbsp;reading&nbsp;individual&nbsp;frames&nbsp;to&nbsp;read&nbsp;the&nbsp;header&nbsp;and&nbsp;message&nbsp;body.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;Off&nbsp;the&nbsp;top&nbsp;of&nbsp;my&nbsp;head&nbsp;here&amp;#39;s&nbsp;what&nbsp;you&amp;#39;d&nbsp;need&nbsp;to&nbsp;read&nbsp;a&nbsp;message&nbsp;off&nbsp;the&nbsp;wire&nbsp;using&nbsp;amqp_basic_get()&nbsp;(Note:&nbsp;this&nbsp;is&nbsp;off&nbsp;the&nbsp;top&nbsp;of&nbsp;my&nbsp;head,&nbsp;and&nbsp;doesn&amp;#39;t&nbsp;deal&nbsp;with&nbsp;error&nbsp;handling&nbsp;well&nbsp;(just&nbsp;returns).&nbsp; This&nbsp;is&nbsp;also&nbsp;using&nbsp;basic.get&nbsp;-&nbsp;which&nbsp;is&nbsp;a&nbsp;synchronous&nbsp;method&nbsp;of&nbsp;getting&nbsp;messages.&nbsp;For&nbsp;anything&nbsp;non-trivial,&nbsp;you&nbsp;probably&nbsp;want&nbsp;use&nbsp;amqp_basic_consume.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp;amqp_rpc_reply_t&nbsp;reply&nbsp;= &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;amqp_basic_get(&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;connection,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;1,&nbsp;/*&nbsp;channel&nbsp;id&nbsp;*/&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;amqp_cstring_bytes(&amp;quot;queue&nbsp;name&amp;quot;),&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;0);&nbsp;/*&nbsp;no_ack,&nbsp;the&nbsp;message&nbsp;will&nbsp;automatically&nbsp;be&nbsp;acked&nbsp;as&nbsp;its&nbsp;delievered&nbsp;*/&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;if&nbsp;(reply.reply_type&nbsp;!=&nbsp;AMQP_RESPONSE_NORMAL)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;return;&nbsp;/*&nbsp;bad&nbsp;reponse&nbsp;from&nbsp;broker&nbsp;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;if&nbsp;(&lt;a&nbsp;href=&quot;http://reply.reply.id&quot;&gt;reply.reply.id&lt;/a&gt;&nbsp;==&nbsp;AMQP_BASIC_GET_EMPTY_METHOD)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;return;&nbsp;/*&nbsp;no&nbsp;messages&nbsp;in&nbsp;the&nbsp;queue&nbsp;to&nbsp;get&nbsp;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;/*&nbsp;Read&nbsp;the&nbsp;header&nbsp;(1&nbsp;frame)&nbsp;and&nbsp;the&nbsp;body&nbsp;(1&nbsp;+&nbsp;x&nbsp;frames)&nbsp;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;size_t&nbsp;body_remaining;&lt;/div&gt;&lt;div&gt; &nbsp;amqp_frame_t&nbsp;frame;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;int&nbsp;res&nbsp;=&nbsp;amqp_simple_wait_frame(connection,&nbsp;&amp;amp;frame);&lt;/div&gt;&lt;div&gt; &nbsp;if&nbsp;(res&nbsp;!=&nbsp;0)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;return;&nbsp;/*&nbsp;failure&nbsp;waiting&nbsp;for&nbsp;frame&nbsp;*/&lt;/div&gt;&lt;div&gt; &nbsp;if&nbsp;(frame.frame_type&nbsp;!=&nbsp;AMQP_FRAME_HEADER)&lt;/div&gt;&lt;div&gt;<br>
 &nbsp; &nbsp;return;&nbsp;/*&nbsp;expecting&nbsp;AMQP_FRAME_HEADER&nbsp;type&nbsp;of&nbsp;frame&nbsp;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;/*&nbsp;This&nbsp;memory&nbsp;is&nbsp;valid&nbsp;until&nbsp;you&nbsp;call&nbsp;amqp_maybe_release_buffers()&nbsp;*/&lt;/div&gt;&lt;div&gt; &nbsp;amqp_basic_properties_t&nbsp;*props&nbsp;= &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;(amqp_basic_properties_t*)frame.payload.properties.decoded;&lt;/div&gt;<br>
&lt;div&gt; &nbsp;body_remaining&nbsp;=&nbsp;frame.payload.properties.body_size;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;char*&nbsp;body&nbsp;=&nbsp;malloc(body_remaining);&lt;/div&gt;&lt;div&gt; &nbsp;char*&nbsp;current_body_ptr&nbsp;=&nbsp;body;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;while&nbsp;(body_remaining)&lt;/div&gt;<br>
&lt;div&gt; &nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;res&nbsp;=&nbsp;amqp_simple_wait_frame(connection,&nbsp;&amp;amp;frame);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;if&nbsp;(res&nbsp;!=&nbsp;0)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;return;&nbsp;/*&nbsp;failure&nbsp;waiting&nbsp;for&nbsp;frame&nbsp;*/&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;if&nbsp;(frame.frame_type&nbsp;!=&nbsp;AMQP_FRAME_BODY)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;return;&nbsp;/*&nbsp;expecting&nbsp;AMQP_BODY_HEADER&nbsp;*/&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;memcpy(current_body_ptr,&nbsp;frame.payload.body_fragment.bytes,&nbsp;frame.payload.body_fragment.len);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;current_body_ptr&nbsp;+=&nbsp;frame.payload.body_fragment.len;&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp;body_remaining&nbsp;-=&nbsp;frame.payload.body_fragment.len;&lt;/div&gt;&lt;div&gt; &nbsp;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;HTH&lt;/div&gt;&lt;div&gt;-Alan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;8,&nbsp;2012&nbsp;at&nbsp;9:19&nbsp;AM,&nbsp;Mike&nbsp;Aubury&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mike@aubit.com&quot;&nbsp;target=&quot;_blank&quot;&gt;mike@aubit.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi,&nbsp;sorry&nbsp;for&nbsp;such&nbsp;a&nbsp;simple&nbsp;question...&lt;br&gt;I&nbsp;had&nbsp;written&nbsp;some&nbsp;interface&nbsp;code&nbsp;in&nbsp;C&nbsp;using&nbsp;openAMQ&nbsp;-&nbsp;but&nbsp;I&amp;#39;ve&nbsp;now&nbsp;realised&nbsp;that&nbsp;looks&nbsp;like&nbsp;its&nbsp;been&nbsp;canned&nbsp;-&nbsp;so&nbsp;I&amp;#39;m&nbsp;looking&nbsp;at&nbsp;porting&nbsp;to&nbsp;something&nbsp;else...&lt;br&gt;<br>
&lt;br&gt;I&nbsp;can&nbsp;get&nbsp;my&nbsp;head&nbsp;around&nbsp;putting&nbsp;stuff&nbsp;into&nbsp;the&nbsp;exchanges/queues&nbsp;etc&lt;i&gt;&nbsp;&lt;/i&gt;(amq_basic_publish)&nbsp;from&nbsp;this&nbsp;code&nbsp;: &lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp;char&nbsp;*messagebody=&amp;quot;Hello&nbsp;World&amp;quot;;&lt;/div&gt;&lt;div&gt; &nbsp;...&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;amqp_basic_properties_t&nbsp;props;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;props._flags&nbsp;=&nbsp;AMQP_BASIC_CONTENT_TYPE_FLAG&nbsp;|&nbsp;AMQP_BASIC_DELIVERY_MODE_FLAG;&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp;props.content_type&nbsp;=&nbsp;amqp_cstring_bytes(&amp;quot;text/plain&amp;quot;);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;props.delivery_mode&nbsp;=&nbsp;2;&nbsp;/*&nbsp;persistent&nbsp;delivery&nbsp;mode&nbsp;*/&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;die_on_error(amqp_basic_publish(conn,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1,&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;amqp_cstring_bytes(exchange),&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;amqp_cstring_bytes(routingkey),&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;amp;props,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;amqp_cstring_bytes(messagebody)),&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;Publishing&amp;quot;);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;but&nbsp;pulling&nbsp;data&nbsp;off&nbsp;is&nbsp;escaping&nbsp;me&nbsp;atm..&lt;br&gt;<br>
&lt;br&gt;Whats&nbsp;the&nbsp;**simplest&nbsp;way**&nbsp;of&nbsp;getting&nbsp;that&nbsp;data,&nbsp;as&nbsp;a&nbsp;full&nbsp;string&nbsp;I&nbsp;can&nbsp;then&nbsp;process&nbsp;?&lt;div&gt;(All&nbsp;the&nbsp;examples&nbsp;seem&nbsp;to&nbsp;do&nbsp;strange&nbsp;things&nbsp;with&nbsp;frames/frame&nbsp;headers&nbsp;etc)&nbsp;..&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ideally&nbsp;-&nbsp;I&nbsp;want&nbsp;to&nbsp;replace&nbsp;my&nbsp;existing&nbsp;: &lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#define BUFFSIZE&nbsp;10000&lt;/div&gt;&lt;div&gt; char&nbsp;message_text[BUFFSIZE];&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; content&nbsp;=&nbsp;amq_client_session_basic_arrived&nbsp;(session);&lt;/div&gt;&lt;div&gt;&lt;div&gt; message_size&nbsp;=&nbsp;amq_content_basic_get_body&nbsp;(content,&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (byte&nbsp;*)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message_text,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sizeof&nbsp;(message_text));&lt;/div&gt;&lt;/div&gt;&lt;div&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;-&nbsp;so&nbsp;far&nbsp;I&amp;#39;ve&nbsp;only&nbsp;got&nbsp;as&nbsp;far&nbsp;as&nbsp;: &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; #define BUFFSIZE&nbsp;10000&lt;/div&gt;&lt;div&gt; &nbsp; char&nbsp;message_text[BUFFSIZE];&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;<br>
<br>
 &nbsp; amqp_simple_wait_frame(conn,&nbsp;&amp;amp;frame);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;;)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;help,&nbsp;or&nbsp;pointers&nbsp;to&nbsp;some&nbsp;documentation&nbsp;would&nbsp;be&nbsp;much&nbsp;appreciated&nbsp;!<br>
&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
