<tt>
&lt;p&gt;What&nbsp;are&nbsp;the&nbsp;avg&nbsp;sizes&nbsp;and&nbsp;the&nbsp;size&nbsp;of&nbsp;a&nbsp;msg&nbsp;that&nbsp;is&nbsp;slow? &nbsp;Network? &nbsp;Mtu,nagle?  &nbsp;Does&nbsp;your&nbsp;NIC&nbsp;have&nbsp;tcp&nbsp;offload? &nbsp;As&nbsp;a&nbsp;black&nbsp;magic&nbsp;solution&nbsp;ser&nbsp;your&nbsp;system&nbsp;to&nbsp;use&nbsp;deadline&nbsp;schedulerr&nbsp;to&nbsp;see&nbsp;if&nbsp;its&nbsp;worse&nbsp;or&nbsp;better?&lt;br&gt;<br>
<br>
jacques&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Jul&nbsp;24,&nbsp;2012&nbsp;11:39&nbsp;AM,&nbsp;&amp;quot;Francesco&nbsp;Mazzoli&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:francesco@rabbitmq.com&quot;&gt;francesco@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;Brennan,&lt;br&gt;<br>
At&nbsp;Mon,&nbsp;23&nbsp;Jul&nbsp;2012&nbsp;15:57:24&nbsp;-0400,&lt;br&gt;<br>
Brennan&nbsp;Sellner&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;rabbitmq&nbsp;server&nbsp;(v2.8.2)&nbsp;is&nbsp;running&nbsp;on&nbsp;the&nbsp;same&nbsp;machine,&nbsp;so&nbsp;there&nbsp;aren&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;any&nbsp;external&nbsp;networks&nbsp;involved.&nbsp; We&amp;#39;re&nbsp;still&nbsp;running&nbsp;Fedora&nbsp;11&nbsp;(kernel&nbsp;2.6.29,&lt;br&gt;<br>
&amp;gt;&nbsp;Erlang&nbsp;R12B-5.8)&nbsp;for&nbsp;the&nbsp;moment,&nbsp;if&nbsp;that&amp;#39;s&nbsp;relevant.&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;upgrade&nbsp;both&nbsp;RabbitMQ&nbsp;and&nbsp;Erlang&nbsp;if&nbsp;you&nbsp;can&nbsp;(especially&nbsp;rabbit),&nbsp;or&lt;br&gt;<br>
things&nbsp;will&nbsp;be&nbsp;hard&nbsp;to&nbsp;diagnose&nbsp;for&nbsp;us.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Time&nbsp;0.90:&nbsp;The&nbsp;consumer&nbsp;receives&nbsp;and&nbsp;responds&nbsp;to&nbsp;an&nbsp;AMQP&nbsp;heartbeat&nbsp;from&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;server,&nbsp;and&nbsp;acks&nbsp;the&nbsp;delivery&nbsp;of&nbsp;a&nbsp;prior&nbsp;message.&nbsp; It&nbsp;again&nbsp;drops&lt;br&gt;<br>
&amp;gt;&nbsp;into&nbsp;an&nbsp;amqp_simple_wait_frame.&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;does&nbsp;not&nbsp;sound&nbsp;right,&nbsp;heartbeats&nbsp;require&nbsp;no&nbsp;response.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;My&nbsp;understanding&nbsp;is&nbsp;that&nbsp;when&nbsp;dealing&nbsp;solely&nbsp;with&nbsp;non-persistent&lt;br&gt;<br>
&amp;gt;&nbsp;messages,&nbsp;Rabbit&nbsp;won&amp;#39;t&nbsp;hit&nbsp;the&nbsp;disk&nbsp;until&nbsp;it&nbsp;runs&nbsp;out&nbsp;of&nbsp;RAM.&nbsp; Is&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;accurate?&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;is&nbsp;accurate,&nbsp;but&nbsp;your&nbsp;understanding&nbsp;of&nbsp;&amp;quot;runs&nbsp;out&nbsp;of&nbsp;RAM&amp;quot;&nbsp;might&nbsp;be&nbsp;misguided:&lt;br&gt;<br>
rabbit&nbsp;will&nbsp;start&nbsp;swapping&nbsp;to&nbsp;disc&nbsp;when&nbsp;the&nbsp;RAM&nbsp;used&nbsp;exceeds&nbsp;`total_ram&nbsp;*&lt;br&gt;<br>
vm_memory_high_watermark&amp;#39;,&nbsp;where&nbsp;`vm_high_watermark&amp;#39;&nbsp;is&nbsp;a&nbsp;configurable&lt;br&gt;<br>
application&nbsp;variable,&nbsp;with&nbsp;0.4&nbsp;as&nbsp;default:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/configure.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/configure.html&lt;/a&gt;&nbsp;.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Any&nbsp;ideas&nbsp;as&nbsp;to&nbsp;what&nbsp;else&nbsp;might&nbsp;cause&nbsp;this&nbsp;sort&nbsp;of&nbsp;delay,&nbsp;or&nbsp;suggestions&nbsp;on&lt;br&gt;<br>
&amp;gt;&nbsp;how&nbsp;to&nbsp;get&nbsp;further&nbsp;useful&nbsp;information?&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;would&nbsp;say&nbsp;that&nbsp;the&nbsp;most&nbsp;likely&nbsp;thing&nbsp;to&nbsp;be&nbsp;happening&nbsp;is&nbsp;for&nbsp;rabbit&nbsp;to&nbsp;start&lt;br&gt;<br>
paging&nbsp;to&nbsp;disc,&nbsp;so&nbsp;please&nbsp;check&nbsp;that&nbsp;first.&nbsp; You&nbsp;can&nbsp;monitor&nbsp;your&nbsp;disc&nbsp;space&lt;br&gt;<br>
usage&nbsp;with&nbsp;the&nbsp;rabbitmq&nbsp;management&nbsp;plugin.&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;might&nbsp;also&nbsp;be&nbsp;hitting&nbsp;flow&nbsp;control,&nbsp;but&nbsp;that&nbsp;is&nbsp;related&nbsp;to&nbsp;running&nbsp;out&nbsp;of&lt;br&gt;<br>
RAM.&nbsp; You&nbsp;can&nbsp;check&nbsp;that&nbsp;as&nbsp;well&nbsp;via&nbsp;the&nbsp;management&nbsp;plugin,&nbsp;the&nbsp;connections&nbsp;will&lt;br&gt;<br>
be&nbsp;marked&nbsp;as&nbsp;&amp;quot;blocked&amp;quot;.&lt;br&gt;<br>
&lt;br&gt;<br>
Another&nbsp;option&nbsp;could&nbsp;be&nbsp;that&nbsp;you&nbsp;are&nbsp;running&nbsp;out&nbsp;of&nbsp;file&nbsp;descriptors&nbsp;(maybe&nbsp;you&lt;br&gt;<br>
have&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;connections&nbsp;open?)&nbsp;and&nbsp;rabbit&nbsp;is&nbsp;blocking&nbsp;until&nbsp;some&nbsp;are&lt;br&gt;<br>
available.&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
Francesco&nbsp;*&nbsp;Often&nbsp;in&nbsp;error,&nbsp;never&nbsp;in&nbsp;doubt&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
