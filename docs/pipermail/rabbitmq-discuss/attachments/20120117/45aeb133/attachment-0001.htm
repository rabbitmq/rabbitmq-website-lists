<tt>
&lt;p&gt;Hi&nbsp;Brian,&nbsp;no&nbsp;you&nbsp;definitely&nbsp;don&amp;#39;t&nbsp;need&nbsp;to&nbsp;create&nbsp;any&nbsp;queues&nbsp;manually&nbsp;for&nbsp;the&nbsp;federation&nbsp;to&nbsp;work.&nbsp;Once&nbsp;you&nbsp;federate&nbsp;an&nbsp;exchange&nbsp;the&nbsp;exchange&nbsp;is&nbsp;created&nbsp;by&nbsp;the&nbsp;plugin&nbsp;on&nbsp;the&nbsp;downstream&nbsp;server&nbsp;(it&nbsp;has&nbsp;to&nbsp;exist&nbsp;on&nbsp;the&nbsp;upstream&nbsp;instead)&nbsp;and&nbsp;when&nbsp;you&nbsp;bind&nbsp;a&nbsp;queue&nbsp;to&nbsp;the&nbsp;federated&nbsp;exchange&nbsp;on&nbsp;the&nbsp;downstream&nbsp;server&nbsp;the&nbsp;bindings&nbsp;are&nbsp;sent&nbsp;to&nbsp;the&nbsp;upstream,&nbsp;which&nbsp;will&nbsp;deliver&nbsp;just&nbsp;the&nbsp;interesting&nbsp;messages&nbsp;published&nbsp;to&nbsp;the&nbsp;exchange&nbsp;on&nbsp;the&nbsp;upstream&nbsp;server&nbsp;to&nbsp;the&nbsp;downstream&nbsp;server.&nbsp;In&nbsp;other&nbsp;words&nbsp;it&nbsp;should&nbsp;work&nbsp;quite&nbsp;intuitively.&lt;/p&gt;<br>
<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Jan&nbsp;17,&nbsp;2012&nbsp;7:51&nbsp;AM,&nbsp;&amp;quot;Brian&nbsp;Jing&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:brian.newsgroup@gmail.com&quot;&gt;brian.newsgroup@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;guys,&lt;br&gt;&lt;br&gt;I&amp;#39;ve&nbsp;played&nbsp;with&nbsp;the&nbsp;federation&nbsp;plugin&nbsp;a&nbsp;little.&nbsp;It&nbsp;seems&nbsp;that&nbsp;in&nbsp;order&nbsp;to&nbsp;send&nbsp;a&nbsp;message&nbsp;to&nbsp;a&nbsp;queue&nbsp;on&nbsp;the&nbsp;downstream&nbsp;server,&nbsp;the&nbsp;same&nbsp;queue&nbsp;has&nbsp;to&nbsp;be&nbsp;declared&nbsp;on&nbsp;the&nbsp;upstream&nbsp;server&nbsp;for&nbsp;federation&nbsp;to&nbsp;work?&lt;br&gt;<br>
<br>
&lt;br&gt;For&nbsp;example:&lt;br&gt;__________________&lt;br&gt;|                             &nbsp;|&lt;br&gt;|&nbsp;Downstream&nbsp;server&nbsp;|  &nbsp;Exchange-D&nbsp;&amp;lt;------ &nbsp;q1&lt;br&gt;|_________________|&lt;br&gt;            &nbsp;^&lt;br&gt;            &nbsp;|&lt;br&gt;            &nbsp;|&lt;br&gt;__________________&lt;br&gt;<br>
<br>
|                             &nbsp;|&lt;br&gt;<br>
|&nbsp;Upstream&nbsp;server    &nbsp;| &nbsp;Exchange-U&nbsp;&amp;lt;------ &nbsp;q1&lt;br&gt;<br>
|_________________|&lt;br&gt;            &nbsp;&lt;br&gt;_______&nbsp;&lt;br&gt;|           &nbsp;|&nbsp;&lt;br&gt;<br>
<br>
|&nbsp;Client&nbsp; &nbsp;|&lt;br&gt;<br>
<br>
|_______|&lt;br&gt;&lt;br&gt;If&nbsp;I&nbsp;want&nbsp;to&nbsp;send&nbsp;messages&nbsp;from&nbsp;client&nbsp;through&nbsp;Upstream&nbsp;server&nbsp;to&nbsp;Downstream&nbsp;server,&nbsp;The&nbsp;messages&nbsp;can&nbsp;only&nbsp;get&nbsp;through&nbsp;when&nbsp;I&nbsp;declare&nbsp;a&nbsp;&amp;quot;q1&amp;quot;&nbsp;on&nbsp;Upstream&nbsp;server,&nbsp;bind&nbsp;that&nbsp;queue&nbsp;to&nbsp;Exchange-U&nbsp;with&nbsp;a&nbsp;routing&nbsp;key,&nbsp;then&nbsp;send&nbsp;the&nbsp;message&nbsp;to&nbsp;Exchange-U&nbsp;using&nbsp;that&nbsp;routing&nbsp;key.&nbsp;Not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is&nbsp;how&nbsp;it&amp;#39;s&nbsp;supposed&nbsp;to&nbsp;work.&nbsp;&lt;br&gt;<br>
<br>
&lt;br&gt;Is&nbsp;it&nbsp;possible&nbsp;not&nbsp;to&nbsp;declare&nbsp;q1&nbsp;on&nbsp;Upstream&nbsp;server&nbsp;and&nbsp;make&nbsp;federation&nbsp;work?&nbsp;My&nbsp;problem&nbsp;is&nbsp;that&nbsp;I&nbsp;have&nbsp;multiple&nbsp;customers&nbsp;listening&nbsp;to&nbsp;their&nbsp;own&nbsp;queues&nbsp;on&nbsp;Downstream&nbsp;server,&nbsp;and&nbsp;customers&nbsp;can&nbsp;be&nbsp;removed&nbsp;or&nbsp;added&nbsp;at&nbsp;any&nbsp;time.&nbsp;Say&nbsp;if&nbsp;X&nbsp;just&nbsp;connected&nbsp;to&nbsp;Downstream&nbsp;server,&nbsp;and&nbsp;I&nbsp;want&nbsp;to&nbsp;send&nbsp;messages&nbsp;to&nbsp;it.&nbsp;How&nbsp;would&nbsp;I&nbsp;be&nbsp;able&nbsp;to&nbsp;send&nbsp;messages&nbsp;to&nbsp;X&nbsp;given&nbsp;that&nbsp;I&nbsp;don&amp;#39;t&nbsp;have&nbsp;a&nbsp;queue&nbsp;on&nbsp;Upstream&nbsp;server&nbsp;that&nbsp;corresponds&nbsp;to&nbsp;it?&nbsp;Though&nbsp;I&nbsp;already&nbsp;know&nbsp;X&nbsp;is&nbsp;in&nbsp;the&nbsp;customer&nbsp;list,&nbsp;when&nbsp;my&nbsp;clients&nbsp;start&nbsp;and&nbsp;initialise,&nbsp;I&nbsp;don&amp;#39;t&nbsp;think&nbsp;it&amp;#39;s&nbsp;a&nbsp;good&nbsp;idea&nbsp;to&nbsp;just&nbsp;create&nbsp;queues&nbsp;for&nbsp;all&nbsp;customers&nbsp;on&nbsp;the&nbsp;list,&nbsp;which&nbsp;I&nbsp;think&nbsp;would&nbsp;consume&nbsp;system&nbsp;resources&nbsp;unnecessarily.&lt;br&gt;<br>
<br>
&lt;br&gt;Hopefully&nbsp;it&nbsp;all&nbsp;makes&nbsp;sense&nbsp;to&nbsp;you&nbsp;guys.&nbsp;Let&nbsp;me&nbsp;know&nbsp;if&nbsp;it&amp;#39;s&nbsp;unclear.&lt;br&gt;&lt;br&gt;The&nbsp;following&nbsp;is&nbsp;my&nbsp;federation&nbsp;config.&lt;br&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;{rabbitmq_federation,&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;  &nbsp;[&nbsp;{exchanges,&nbsp;[[{exchange,    &nbsp;&amp;quot;Exchange-D&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                  &nbsp;{virtual_host,&nbsp;&amp;quot;/&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                  &nbsp;{type,        &nbsp;&amp;quot;topic&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                  &nbsp;{durable,     &nbsp;true},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                  &nbsp;{auto_delete, &nbsp;false},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                  &nbsp;{internal,    &nbsp;false},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                  &nbsp;{upstream_set,&nbsp;&amp;quot;upsteam-servers&amp;quot;}]&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                &nbsp;]},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;    &nbsp;{upstream_sets,&nbsp;[{&amp;quot;upsteam-servers&amp;quot;,&nbsp;[[{connection,&nbsp;&amp;quot;192.168.0.21&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                        &nbsp;{exchange,  &nbsp;&amp;quot;Exchange-U&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                        &nbsp;{max_hops,  &nbsp;2}&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                        &nbsp;]}&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                    &nbsp;]},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;    &nbsp;{connections,&nbsp;[{&amp;quot;Upstream-server&amp;quot;,      &nbsp;[{host,         &nbsp;&amp;quot;upstream&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                        &nbsp;{protocol,       &nbsp;&amp;quot;amqps&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                        &nbsp;{port,           &nbsp;5671},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                        &nbsp;{ssl_options,&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                         &nbsp;[{cacertfile,&nbsp;&amp;quot;/etc/rabbitmq/certs/testca/cacert.pem&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                          &nbsp;{certfile,  &nbsp;&amp;quot;/etc/rabbitmq/certs/client/cert.pem&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                          &nbsp;{keyfile,   &nbsp;&amp;quot;/etc/rabbitmq/certs/client/key.pem&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                          &nbsp;{verify,    &nbsp;verify_peer},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                          &nbsp;{fail_if_no_peer_cert,&nbsp;false}&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                         &nbsp;]}&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                       &nbsp;]}&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;                                    &nbsp;]},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;    &nbsp;{local_username,&nbsp;&amp;quot;guest&amp;quot;},&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;  &nbsp;]&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt;&lt;span&nbsp;style=&quot;color:rgb(0,102,0)&quot;&gt; &nbsp;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;&lt;br&gt;Brian&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
