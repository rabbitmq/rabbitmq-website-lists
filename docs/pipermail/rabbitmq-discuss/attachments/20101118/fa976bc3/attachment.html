<tt>
(inline)&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Nov&nbsp;18,&nbsp;2010&nbsp;at&nbsp;6:49&nbsp;AM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@rabbitmq.com&quot;&gt;matthias@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Manuel,&lt;br&gt;<br>
&lt;br&gt;<br>
Manuel&nbsp;DE&nbsp;FERRAN&nbsp;wrote:&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;Mon,&nbsp;Nov&nbsp;15,&nbsp;2010&nbsp;at&nbsp;12:31&nbsp;PM,&nbsp;Matthew&nbsp;Sackman&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthew@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;matthew@rabbitmq.com&lt;/a&gt;&nbsp;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:matthew@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;matthew@rabbitmq.com&lt;/a&gt;&amp;gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&nbsp; &nbsp; Howdy,&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; On&nbsp;Mon,&nbsp;Nov&nbsp;15,&nbsp;2010&nbsp;at&nbsp;11:56:25AM&nbsp;+0100,&nbsp;Manuel&nbsp;DE&nbsp;FERRAN&nbsp;wrote:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;&amp;gt;&nbsp;recently&nbsp;we&nbsp;upgraded&nbsp;to&nbsp;version&nbsp;2.1.1.&nbsp;We&nbsp;picked&nbsp;up&nbsp;the&nbsp;official&lt;br&gt;<br>
&nbsp; &nbsp; debian&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;&amp;gt;&nbsp;package,&nbsp;and&nbsp;installed&nbsp;it&nbsp;on&nbsp;a&nbsp;debian&nbsp;lenny.&nbsp;And&nbsp;we&nbsp;face&nbsp;problems&lt;br&gt;<br>
&nbsp; &nbsp; of&nbsp;memory&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;&amp;gt;&nbsp;allocation&nbsp;&amp;#39;ll_alloc:&nbsp;Cannot&nbsp;allocate&nbsp;486539264&nbsp;bytes&nbsp;of&nbsp;memory&lt;br&gt;<br>
&nbsp; &nbsp; (of&nbsp;type&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;&amp;gt;&nbsp;&amp;quot;port_tab&amp;quot;)&amp;#39;&nbsp;when&nbsp;invoking&nbsp;rabbitmqctl.&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; How&nbsp;much&nbsp;RAM&nbsp;is&nbsp;installed&nbsp;in&nbsp;the&nbsp;machine?&nbsp;How&nbsp;much&nbsp;is&nbsp;available?&nbsp;Have&lt;br&gt;<br>
&nbsp; &nbsp; you&nbsp;performed&nbsp;any&nbsp;configuration&nbsp;of&nbsp;Rabbit&nbsp;such&nbsp;as&nbsp;altering&nbsp;the&lt;br&gt;<br>
&nbsp; &nbsp; vm_high_memory_watermark&nbsp;value?&nbsp;Is&nbsp;it&nbsp;a&nbsp;32-bit&nbsp;or&nbsp;64-bit&nbsp;installation?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
1.5&nbsp;GB&nbsp;is&nbsp;assigned&nbsp;to&nbsp;this&nbsp;machine&nbsp;(that&amp;#39;s&nbsp;a&nbsp;xen&nbsp;virtual&nbsp;machine).&nbsp;There&nbsp;is&nbsp;more&nbsp;than&nbsp;500MB&nbsp;of&nbsp;available&nbsp;memory.&nbsp;We&nbsp;released&nbsp;up&nbsp;to&nbsp;1GB,&nbsp;and&nbsp;that&nbsp;did&nbsp;not&nbsp;fix&nbsp;the&nbsp;issue.&lt;br&gt;<br>
&lt;br&gt;<br>
We&nbsp;are&nbsp;using&nbsp;the&nbsp;default&nbsp;configuration,&nbsp;means&nbsp;no&nbsp;configuration&nbsp;at&nbsp;all.&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;that&amp;#39;s&nbsp;a&nbsp;64&nbsp;bits&nbsp;installation,&nbsp;we&nbsp;grabbed&nbsp;the&nbsp;debian&nbsp;package&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/releases/rabbitmq-server/v2.1.1/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/releases/rabbitmq-server/v2.1.1/&lt;/a&gt;.&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
So&nbsp;the&nbsp;rabbitmq-server&nbsp;itself&nbsp;is&nbsp;running&nbsp;fine&nbsp;and&nbsp;you&nbsp;only&nbsp;encounter&nbsp;problems&nbsp;with&nbsp;rabbitmqctl?&nbsp;Strange&nbsp;indeed.&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;version&nbsp;of&nbsp;Erlang&nbsp;is&nbsp;running&nbsp;on&nbsp;that&nbsp;machine?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&amp;quot;erl&amp;quot;&nbsp;returns&nbsp;following&nbsp;header&nbsp;:&lt;br&gt;Erlang&nbsp;R13B04&nbsp;(erts-5.7.5)&nbsp;[source]&nbsp;[64-bit]&nbsp;[rq:1]&nbsp;[async-threads:0]&nbsp;[kernel-poll:false]&lt;br&gt;&lt;br&gt;Erlang&nbsp;has&nbsp;been&nbsp;installed&nbsp;from&nbsp;official&nbsp;debian&nbsp;lenny&nbsp;package,&nbsp;the&nbsp;exact&nbsp;version&nbsp;is&nbsp;1:13.b.4-dfsg-5.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
Looking&nbsp;at&nbsp;the&nbsp;Erlang&nbsp;source&nbsp;code,&nbsp;the&nbsp;error&nbsp;would&nbsp;appear&nbsp;to&nbsp;crop&nbsp;up&nbsp;when&nbsp;the&nbsp;operating&nbsp;system&nbsp;is&nbsp;configured&nbsp;with&nbsp;a&nbsp;very&nbsp;high&nbsp;file&nbsp;descriptor&nbsp;limit.&nbsp;What&nbsp;does&nbsp;&amp;#39;ulimit&nbsp;-n&amp;#39;&nbsp;report?&nbsp;(NB:&nbsp;you&nbsp;should&nbsp;run&nbsp;that&nbsp;as&nbsp;the&nbsp;&amp;#39;rabbitmq&amp;#39;&nbsp;user).&nbsp;If&nbsp;the&nbsp;figure&nbsp;is&nbsp;in&nbsp;the&nbsp;many&nbsp;millions,&nbsp;I&nbsp;suggest&nbsp;you&nbsp;set&nbsp;a&nbsp;lower&nbsp;limit&nbsp;in&nbsp;the&nbsp;o/s&nbsp;config.&nbsp;Alternativly,&nbsp;set&nbsp;the&nbsp;ERL_MAX_PORTS&nbsp;environment&nbsp;variable.&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;That&amp;#39;s&nbsp;a&nbsp;good&nbsp;point.&nbsp;The&nbsp;ulimit&nbsp;was&nbsp;returning&nbsp;about&nbsp;600k&nbsp;as&nbsp;open&nbsp;file&nbsp;limit.&nbsp;We&nbsp;lowered&nbsp;it&nbsp;to&nbsp;about&nbsp;32k&nbsp;and&nbsp;so&nbsp;far&nbsp;we&nbsp;can&nbsp;not&nbsp;reproduce&nbsp;the&nbsp;problem.&lt;br&gt;&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
I&nbsp;wonder&nbsp;whether&nbsp;there&nbsp;is&nbsp;some&nbsp;strange&nbsp;hypervisor&nbsp;interaction&nbsp;going&nbsp;on.&nbsp;Could&nbsp;you&nbsp;perhaps&nbsp;try&nbsp;a&nbsp;different&nbsp;kind&nbsp;of&nbsp;VM?&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes&nbsp;probably,&nbsp;we&nbsp;will&nbsp;try&nbsp;it&nbsp;if&nbsp;it&nbsp;fails&nbsp;again.&nbsp;Thanks&nbsp;!&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
