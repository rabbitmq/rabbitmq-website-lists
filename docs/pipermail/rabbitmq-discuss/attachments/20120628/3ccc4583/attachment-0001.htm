<tt>
Hi&nbsp;all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;facing&nbsp;a&nbsp;weird&nbsp;problem&nbsp;of&nbsp;losing&nbsp;messages,&nbsp;even&nbsp;though&nbsp;I&nbsp;am&nbsp;publishing&nbsp;them&nbsp;as&nbsp;persistent&nbsp;messages&nbsp;with&amp;nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;palatino,&nbsp;georgia,&nbsp;verdana,&nbsp;arial,&nbsp;sans-serif;&nbsp;line-height:&nbsp;19px;&nbsp;font-size:&nbsp;small;&nbsp;&quot;&gt;pika.BasicProperties(delivery_mode=2)&lt;/span&gt;&amp;nbsp;.&nbsp;Here&nbsp;is&nbsp;the&nbsp;scenario:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;two&nbsp;RabbitMQ&nbsp;brokers,&nbsp;namely&nbsp;rabbit@vm11&nbsp;and&nbsp;rabbit@vm22;&nbsp;&amp;nbsp;these&nbsp;two&nbsp;are&nbsp;have&nbsp;been&nbsp;setup&nbsp;in&nbsp;a&nbsp;cluster&nbsp;configuration&nbsp;as&nbsp;shown&nbsp;below:&lt;/div&gt;&lt;div&gt;&lt;div&gt;[{nodes,[{disc,[rabbit@vm11,rabbit@vm22]}]},&lt;/div&gt;&lt;div&gt;&amp;nbsp;{running_nodes,[rabbit@vm22,rabbit@vm11]}]&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;two&nbsp;clients&nbsp;(written&nbsp;using&nbsp;pika.BlockingConnection()&nbsp;);&nbsp;lets&nbsp;call&nbsp;these&nbsp;clients&nbsp;C1&nbsp;and&nbsp;N1.&lt;/div&gt;&lt;div&gt;1.)&nbsp;C1&nbsp;creates&nbsp;an&nbsp;unique&nbsp;exchange&nbsp;(exchange&nbsp;name&nbsp;generated&nbsp;using&nbsp;UUID,&nbsp;say&nbsp;3fe546be8aa341b7b174b29a56e63797).&lt;/div&gt;&lt;div&gt;2.)&nbsp;C1&nbsp;then&nbsp;spawns&nbsp;a&nbsp;thread,&nbsp;say&nbsp;C1-T1,&nbsp;which&nbsp;connects&nbsp;to&nbsp;rabbitmq&nbsp;server&nbsp;and&nbsp;waits&nbsp;for&nbsp;a&nbsp;response&nbsp;on&nbsp;this&nbsp;exchange&nbsp;using&nbsp;channel.start_consuming().&amp;nbsp;&lt;/div&gt;&lt;div&gt;3.)&nbsp;C1&nbsp;then&nbsp;sends&nbsp;a&nbsp;message&nbsp;to&nbsp;N1&nbsp;and&nbsp;in&nbsp;the&nbsp;message&nbsp;proviodes&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;exchange&nbsp;(3fe546be8aa341b7b174b29a56e63797)&nbsp;where&nbsp;N1&nbsp;should&nbsp;send&nbsp;the&nbsp;response.&lt;/div&gt;&lt;div&gt;4.)&nbsp;once&nbsp;C1-T1&nbsp;gets&nbsp;the&nbsp;response,&nbsp;it&nbsp;hands&nbsp;over&nbsp;the&nbsp;response&nbsp;to&nbsp;C1&nbsp;and&nbsp;dies.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;my&nbsp;current&nbsp;setup&nbsp;I&nbsp;have&nbsp;100&nbsp;clients&nbsp;process&nbsp;like&nbsp;C1,&nbsp;i.e.&nbsp;C1,&nbsp;C2&nbsp;...&nbsp;C100&nbsp;and&nbsp;one&nbsp;N1.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;setup&nbsp;works&nbsp;perfectly&nbsp;fine&nbsp;when&nbsp;RabbitMQ&nbsp;is&nbsp;in&nbsp;a&nbsp;single&nbsp;node&nbsp;setup&nbsp;but&nbsp;when&nbsp;I&nbsp;put&nbsp;it&nbsp;in&nbsp;a&nbsp;cluster&nbsp;setup,&nbsp;it&nbsp;starts&nbsp;to&nbsp;loose&nbsp;the&nbsp;messages.&nbsp;What&nbsp;I&nbsp;mean&nbsp;is&nbsp;that&nbsp;Thread&nbsp;C1-T1&nbsp;never&nbsp;gets&nbsp;a&nbsp;response&nbsp;and&nbsp;time-outs&nbsp;writing&nbsp;an&nbsp;ERROR&nbsp;in&nbsp;my&nbsp;log&nbsp;file.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;trouble&nbsp;is&nbsp;I&nbsp;am&nbsp;loosing&nbsp;as&nbsp;high&nbsp;mashy&nbsp;as&nbsp;50%&nbsp;of&nbsp;the&nbsp;messages.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;could&nbsp;someone&nbsp;tell&nbsp;me&nbsp;what&nbsp;could&nbsp;be&nbsp;going&nbsp;wrong.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks&nbsp;in&nbsp;advance,&lt;/div&gt;&lt;div&gt;-upendra&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Some&nbsp;more&nbsp;Details&nbsp;of&nbsp;setup:&amp;nbsp;&lt;/div&gt;&lt;div&gt;RabbitMQ&nbsp;Server:&nbsp;2.8.4&lt;/div&gt;&lt;div&gt;Pika&nbsp;Library:&amp;nbsp;0.9.5&lt;/div&gt;&lt;div&gt;OS:&nbsp;Ubuntu&nbsp;12.04&nbsp;(Precise)&lt;/div&gt;&lt;div&gt;VM11&nbsp;and&nbsp;VM22:&nbsp;quad-core&nbsp;machines&nbsp;with&nbsp;8GB&nbsp;RAM&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Q.)&nbsp;How&nbsp;do&nbsp;I&nbsp;know&nbsp;message&nbsp;is&nbsp;lost?&lt;/div&gt;&lt;div&gt;A.)&nbsp;I&nbsp;performed&nbsp;the&nbsp;following&nbsp;steps:&lt;/div&gt;&lt;div&gt;1.)&nbsp;log&nbsp;the&nbsp;message&nbsp;at&nbsp;N1&nbsp;after&nbsp;successfully&nbsp;publishing&nbsp;it&lt;/div&gt;&lt;div&gt;2.)&nbsp;enable&nbsp;trace_on&nbsp;on&nbsp;rabbitMQ&nbsp;server&nbsp;and&nbsp;there&nbsp;too&nbsp;log&nbsp;the&nbsp;messages&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;I&nbsp;found&nbsp;that&nbsp;the&nbsp;message&nbsp;was&nbsp;sent&nbsp;by&nbsp;N1,&nbsp;was&nbsp;received&nbsp;by&nbsp;rabbitMQ&nbsp;server&nbsp;and&nbsp;RabbitMQ&nbsp;server&nbsp;reports&nbsp;it&nbsp;to&nbsp;be&nbsp;published&nbsp;on&nbsp;the&nbsp;Excahnge&amp;nbsp;3fe546be8aa341b7b174b29a56e63797&nbsp;&amp;nbsp;and&nbsp;never&nbsp;reports&nbsp;it&nbsp;to&nbsp;be&nbsp;delivered.&amp;nbsp;&lt;/div&gt;&lt;div&gt;But&nbsp;when&nbsp;I&nbsp;look&nbsp;at&nbsp;the&nbsp;queue&nbsp;it&nbsp;reports&nbsp;&quot;0&quot;&nbsp;messages&nbsp;--&nbsp;I&nbsp;am&nbsp;pasting&nbsp;the&nbsp;output&nbsp;of&nbsp;rabbitmqadmin&nbsp;command&lt;/div&gt;&lt;div&gt;&lt;div&gt;root@vm11:~#&nbsp;rabbitmqadmin&nbsp;list&nbsp;queues&nbsp;name&nbsp;node&nbsp;messages&nbsp;|&nbsp;grep&nbsp;3fe546be8aa341b7b174b29a56e63797&lt;/div&gt;&lt;div&gt;|&nbsp;3fe546be8aa341b7b174b29a56e63797&nbsp;|&nbsp;rabbit@vm22&nbsp;|&nbsp;0&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;|&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;
</tt>
