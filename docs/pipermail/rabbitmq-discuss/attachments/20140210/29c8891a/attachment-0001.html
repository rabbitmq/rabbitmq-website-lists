<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;having&nbsp;trouble&nbsp;understanding&nbsp;how&nbsp;to&nbsp;properly&nbsp;code&nbsp;the&nbsp;&quot;handleCancel&quot;&nbsp;call&nbsp;back&nbsp;service&nbsp;in&nbsp;case&nbsp;of&nbsp;an&nbsp;event&nbsp;of&nbsp;a&nbsp;consumer&nbsp;cancel&nbsp;notification&nbsp;occurs.&nbsp; I&#39;m&nbsp;using&nbsp;Java&nbsp;client.&nbsp; First,&nbsp;I&nbsp;have&nbsp;a&nbsp;service&nbsp;that&nbsp;invokes&nbsp;the&nbsp;structure&nbsp;below.&nbsp; I&nbsp;have&nbsp;several&nbsp;services&nbsp;that&nbsp;invokes&nbsp;the&nbsp;below&nbsp;service&nbsp;based&nbsp;on&nbsp;how&nbsp;many&nbsp;queues&nbsp;I&nbsp;have&nbsp;setup&nbsp;on&nbsp;the&nbsp;broker.&nbsp; In&nbsp;my&nbsp;understanding,&nbsp;the&nbsp;&quot;handleCancel&quot;&nbsp;service&nbsp;will&nbsp;be&nbsp;invoke&nbsp;when&nbsp;the&nbsp;master&nbsp;node&nbsp;fails.&nbsp; I&#39;m&nbsp;trying&nbsp;to&nbsp;understand&nbsp;what&nbsp;I&nbsp;need&nbsp;to&nbsp;code&nbsp;in&nbsp;the&nbsp;&quot;handleCancel&quot;&nbsp;service.&nbsp; In&nbsp;the&nbsp;&quot;handleCancel&quot;&nbsp;service,&nbsp;I&nbsp;only&nbsp;have&nbsp;the&nbsp;&quot;consumerTag&quot;&nbsp;information.&nbsp; How&nbsp;will&nbsp;I&nbsp;know&nbsp;the&nbsp;queue&nbsp;that&nbsp;it&#39;s&nbsp;associated&nbsp;with&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;invoking&nbsp;service&nbsp;that&#39;ll&nbsp;&quot;re-subscribe&quot;&nbsp;to&nbsp;the&nbsp;queue.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;try&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;ConnectionFactory&nbsp;factory&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;factory.setUri(strFactoryURI);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Connection&nbsp;conn&nbsp;=&nbsp;factory.newConnection();&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Channel&nbsp;channel&nbsp;=&nbsp;conn.createChannel();&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-indent:0.5in&quot;&gt;channel.queueDeclare(strQueueName,<br>
true,&nbsp;false,&nbsp;false,&nbsp;null);&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
//Callback&nbsp;to&nbsp;handle&nbsp;unexpected&nbsp;issue&nbsp;with&nbsp;the&nbsp;Broker&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
Consumer&nbsp;consumer&nbsp;=&nbsp;new&nbsp;QueueingConsumer(channel)&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
{&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
   &nbsp;@Override&nbsp;public&nbsp;void&nbsp;handleCancel(String&nbsp;consumerTag)&nbsp;throws<br>
IOException&nbsp;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
    {&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
       &nbsp;//&nbsp;how&nbsp;to&nbsp;handle&nbsp;unexpected<br>
cancellation&nbsp;from&nbsp;broker&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
   &nbsp;}&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
};&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
//&nbsp;Dispatch&nbsp;the&nbsp;message&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;               <br>
channel.basicConsume(strQueueName,&nbsp;false,&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                               <br>
new&nbsp;DefaultConsumer(channel)&nbsp;{&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                                               <br>
@Override&nbsp;public&nbsp;void&nbsp;handleDelivery(String&nbsp;consumerTag,&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                                                                                                               <br>
Envelope&nbsp;envelope,&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                                                                                                               <br>
AMQP.BasicProperties&nbsp;props,&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                                                                                                               <br>
byte[]&nbsp;body)&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                                               <br>
throws&nbsp;IOException&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                                               <br>
{   &nbsp;//&nbsp;execute&nbsp;code&nbsp;to&nbsp;invoke&nbsp;service&nbsp;on&nbsp;1.0&nbsp;to&nbsp;persiste&nbsp;the<br>
message&nbsp;}&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;                               <br>
});&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;}&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;thanks,&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Phil&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
