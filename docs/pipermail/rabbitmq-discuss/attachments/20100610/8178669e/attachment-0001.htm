<tt>
El&nbsp;10&nbsp;de&nbsp;junio&nbsp;de&nbsp;2010&nbsp;08:26,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;escribió:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;09/06/10&nbsp;22:27,&nbsp;Nicolás&nbsp;César&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
(rabbit@sendsorium)1&amp;gt;&nbsp;memory().&lt;br&gt;<br>
[{total,27420688},&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
&amp;lt;snip&amp;gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
but&nbsp;in&nbsp;top&nbsp;I&nbsp;see&nbsp;beam.smp&nbsp;using:&lt;br&gt;<br>
VIRT=141m&nbsp; RES=95m&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
So&nbsp;there&nbsp;is&nbsp;some&nbsp;disparity&nbsp;here&nbsp;but&nbsp;not&nbsp;as&nbsp;much&nbsp;as&nbsp;when&nbsp;you&nbsp;were&nbsp;seeing&nbsp;400M&nbsp;used.&nbsp;I&nbsp;take&nbsp;it&nbsp;this&nbsp;was&nbsp;a&nbsp;different&nbsp;run?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;Yess...&nbsp;the&nbsp;OOM&nbsp;assassin&nbsp;was&nbsp;with&nbsp;his&nbsp;gun&nbsp;killing&nbsp;my&nbsp;processes!&nbsp;Rabbit&nbsp;went&nbsp;down&nbsp;fist!&nbsp;Thanks&nbsp;to&nbsp;you&nbsp;I&nbsp;have&nbsp;the&nbsp;&nbsp;memory().&nbsp;trick&nbsp;for&nbsp;the&nbsp;next&nbsp;time.&nbsp;&lt;br&gt;<br>
<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
  &nbsp;*&nbsp;Are&nbsp;you&nbsp;stopping&nbsp;the&nbsp;queues&nbsp;from&nbsp;hibernating?&nbsp;If&nbsp;you&amp;#39;ve&nbsp;written&lt;br&gt;<br>
&nbsp; &nbsp; something&nbsp;like&nbsp;a&nbsp;shell&nbsp;script&nbsp;to&nbsp;repeatedly&nbsp;invoke&nbsp;rabbitmqctl&lt;br&gt;<br>
&nbsp; &nbsp; list_queues&nbsp;this&nbsp;will&nbsp;keep&nbsp;the&nbsp;queue&nbsp;processes&nbsp;from&nbsp;hibernating&lt;br&gt;<br>
&nbsp; &nbsp; which&nbsp;in&nbsp;turn&nbsp;stops&nbsp;them&nbsp;from&nbsp;GCing&nbsp;on&nbsp;hibernate.&nbsp;If&nbsp;queues&nbsp;are&nbsp;busy&lt;br&gt;<br>
&nbsp; &nbsp; this&nbsp;is&nbsp;not&nbsp;a&nbsp;problem&nbsp;as&nbsp;they&nbsp;also&nbsp;GC&nbsp;every&nbsp;(n)&nbsp;reductions,&nbsp;but&nbsp;if&lt;br&gt;<br>
&nbsp; &nbsp; they&amp;#39;re&nbsp;almost-but-not-quite&nbsp;idle&nbsp;it&nbsp;can&nbsp;be&nbsp;a&nbsp;problem.&nbsp;It&nbsp;doesn&amp;#39;t&lt;br&gt;<br>
&nbsp; &nbsp; have&nbsp;to&nbsp;be&nbsp;a&nbsp;shell&nbsp;script,&nbsp;anything&nbsp;that&nbsp;means&nbsp;the&nbsp;queues&nbsp;never&nbsp;get&lt;br&gt;<br>
&nbsp; &nbsp; 10&nbsp;seconds&nbsp;or&nbsp;so&nbsp;idle.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;really&nbsp;nice&nbsp;data!!&nbsp;Yes.&nbsp;I&nbsp;have&nbsp;scripts&nbsp;but&nbsp;they&amp;#39;re&nbsp;cron&amp;#39;ed&nbsp;every&lt;br&gt;<br>
minute....&nbsp;I&amp;#39;m&nbsp;changing&nbsp;that&nbsp;and&nbsp;testing&nbsp;again.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Every&nbsp;minute&nbsp;*should*&nbsp;be&nbsp;OK,&nbsp;it&amp;#39;s&nbsp;more&nbsp;like&nbsp;every&nbsp;couple&nbsp;of&nbsp;seconds&nbsp;which&nbsp;can&nbsp;prevent&nbsp;the&nbsp;hibernation.&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;I&amp;#39;ve&nbsp;changed&nbsp;it&nbsp;to&nbsp;10&nbsp;minutes&nbsp;and&nbsp;there&nbsp;were&nbsp;no&nbsp;significant&nbsp;behavior&nbsp;changes.&nbsp;&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
One&nbsp;small&nbsp;detail.&nbsp;I&amp;#39;m&nbsp;using:&lt;br&gt;<br>
&lt;br&gt;<br>
-----------------------------------------------------&lt;br&gt;<br>
while&nbsp;True:&lt;br&gt;<br>
&nbsp; &nbsp;msg&nbsp;=&nbsp;self.chan.basic_get(self.config[&amp;#39;queue&amp;#39;])&lt;br&gt;<br>
&nbsp; &nbsp;if&nbsp;msg:&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; ....&lt;br&gt;<br>
&nbsp; &nbsp;time.sleep(2.0)&lt;br&gt;<br>
----------------------------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
because&nbsp;I&nbsp;need&nbsp;a&nbsp;fixed-rate&nbsp;consumer&nbsp;.&nbsp;...&nbsp;could&nbsp;this&nbsp;be&nbsp;a&nbsp;similar&nbsp;case&lt;br&gt;<br>
of&nbsp;the&nbsp;&amp;quot;almost-but-not-quite&nbsp;idle&nbsp;queue&amp;quot;?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Yes,&nbsp;as&nbsp;you&amp;#39;ll&nbsp;still&nbsp;be&nbsp;waking&nbsp;the&nbsp;queue&nbsp;up&nbsp;every&nbsp;2&nbsp;seconds&nbsp;even&nbsp;if&nbsp;it&amp;#39;s&nbsp;empty.&nbsp;I&nbsp;suspect&nbsp;this&nbsp;is&nbsp;your&nbsp;real&nbsp;problem.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Bingo!&nbsp;thanks&nbsp;Simon&nbsp;for&nbsp;your&nbsp;help&nbsp;in&nbsp;this&nbsp;issue!!&nbsp;now&nbsp;it&amp;#39;s&nbsp;on&nbsp;the&nbsp;mail&nbsp;archive,&nbsp;I&nbsp;hope&nbsp;this&nbsp;mail&nbsp;helps&nbsp;next&nbsp;googling&nbsp;rabbiter.&nbsp;:)&lt;br&gt;<br>
<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
is&nbsp;there&nbsp;any&nbsp;way&nbsp;to&nbsp;tell&nbsp;the&nbsp;broker&nbsp;to&nbsp;consume&nbsp;at&nbsp;a&nbsp;fixed&nbsp;rate&nbsp;with&lt;br&gt;<br>
chan.basic_consume(...callback&nbsp;=&nbsp;f)?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Yes,&nbsp;basic.qos.&nbsp;This&nbsp;not-very-well-named&nbsp;method&nbsp;lets&nbsp;you&nbsp;specify&nbsp;how&nbsp;many&nbsp;unacked&nbsp;messages&nbsp;the&nbsp;server&nbsp;will&nbsp;send&nbsp;to&nbsp;you&nbsp;at&nbsp;any&nbsp;time.&nbsp;So&nbsp;set&nbsp;qos&nbsp;to&nbsp;a&nbsp;low&nbsp;value,&nbsp;then&nbsp;use&nbsp;basic_consume&nbsp;with&nbsp;a&nbsp;sleep&nbsp;before&nbsp;acking.&lt;br&gt;&lt;/blockquote&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;Nice&nbsp;to&nbsp;hear&nbsp;a&nbsp;yes&nbsp;here!!&nbsp;I&amp;#39;ll&nbsp;be&nbsp;changing&nbsp;my&nbsp;code&nbsp;to&nbsp;get&nbsp;this&nbsp;working!&nbsp;Thanks! &nbsp;&lt;br&gt;&lt;br&gt;Nico&nbsp;Cesar&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
