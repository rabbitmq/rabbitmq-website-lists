<tt>
&lt;font&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;Yes,&nbsp;I'll&nbsp;take&nbsp;up&nbsp;this&nbsp;issue&nbsp;with&nbsp;the&nbsp;ruby-amqp&nbsp;groups.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;I'm&nbsp;asking&nbsp;questions&nbsp;and&nbsp;carefully&nbsp;reporting&nbsp;the&nbsp;behavior&nbsp;I've&nbsp;observed.&nbsp;I'm&nbsp;new&nbsp;to&nbsp;these&nbsp;tools&nbsp;-&nbsp;RabbitMQ&nbsp;server,&nbsp;and&nbsp;the&nbsp;ruby&nbsp;amqp&nbsp;gem.&nbsp;These&nbsp;tools&nbsp;have&nbsp;been&nbsp;around&nbsp;for&nbsp;a&nbsp;while,&nbsp;and&nbsp;the&nbsp;platforms&nbsp;I'm&nbsp;using&nbsp;-&nbsp;RabbitMQ&nbsp;and&nbsp;Ruby&nbsp;and&nbsp;Ubuntu,&nbsp;RabbitMQ&nbsp;and&nbsp;Ruby&nbsp;and&nbsp;Mac&nbsp;OS&nbsp;-&nbsp;are&nbsp;used&nbsp;by&nbsp;many,&nbsp;many&nbsp;developers.&nbsp;It&nbsp;would&nbsp;be&nbsp;-arrogant-&nbsp;and&nbsp;foolish&nbsp;of&nbsp;me&nbsp;to&nbsp;assume&nbsp;that&nbsp;I've&nbsp;immediately&nbsp;stumbled&nbsp;upon&nbsp;a&nbsp;bug&nbsp;in&nbsp;code&nbsp;that&nbsp;I&nbsp;expect&nbsp;has&nbsp;been&nbsp;well-exercised&nbsp;out&nbsp;there&nbsp;in&nbsp;the&nbsp;world.&nbsp;So&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;determine&nbsp;if&nbsp;I'm&nbsp;traversing&nbsp;less-used&nbsp;code&nbsp;paths,&nbsp;using&nbsp;new&nbsp;features,&nbsp;implementing&nbsp;an&nbsp;unusual&nbsp;use&nbsp;case&nbsp;or&nbsp;pattern,&nbsp;misunderstanding&nbsp;how&nbsp;ACKs&nbsp;are&nbsp;supposed&nbsp;to&nbsp;work,&nbsp;or&nbsp;misunderstanding&nbsp;how&nbsp;client-side&nbsp;state&nbsp;is&nbsp;propagated.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;-larry&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;&amp;nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;-----Original&nbsp;Message-----&lt;br&nbsp;/&gt;From:&nbsp;&quot;Matthias&nbsp;Radestock&quot;&nbsp;&amp;lt;matthias@rabbitmq.com&amp;gt;&lt;br&nbsp;/&gt;Sent:&nbsp;Thursday,&nbsp;November&nbsp;8,&nbsp;2012&nbsp;3:42pm&lt;br&nbsp;/&gt;To:&nbsp;&quot;Discussions&nbsp;about&nbsp;RabbitMQ&quot;&nbsp;&amp;lt;rabbitmq-discuss@lists.rabbitmq.com&amp;gt;&lt;br&nbsp;/&gt;Cc:&nbsp;larry.edelstein@therealreal.com&lt;br&nbsp;/&gt;Subject:&nbsp;Re:&nbsp;[rabbitmq-discuss]&nbsp;redelivery&nbsp;after&nbsp;ACK&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;/p&gt;<br>
&lt;div&nbsp;id=&quot;SafeStyles1352421543&quot;&gt;<br>
&lt;p&nbsp;style=&quot;margin:0;padding:0;&quot;&gt;Larry,&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;On&nbsp;08/11/12&nbsp;22:18,&nbsp;larry.edelstein@therealreal.com&nbsp;wrote:&lt;br&nbsp;/&gt;&amp;gt;&nbsp;When&nbsp;I&nbsp;run&nbsp;a&nbsp;capture&nbsp;with&nbsp;Wireshark&nbsp;and&nbsp;consume/ack&nbsp;a&nbsp;few&nbsp;messages,&nbsp;I&lt;br&nbsp;/&gt;&amp;gt;&nbsp;see&nbsp;the&nbsp;expected&nbsp;traffic,&nbsp;but&nbsp;no&nbsp;acks.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;However:&nbsp;when&nbsp;I&nbsp;set&nbsp;channel.prefetch(1),&nbsp;now&nbsp;I&nbsp;see&nbsp;the&nbsp;acks.&nbsp;If&nbsp;I&nbsp;kill&lt;br&nbsp;/&gt;&amp;gt;&nbsp;and&nbsp;restart&nbsp;the&nbsp;consumer,&nbsp;delivery&nbsp;begins&nbsp;with&nbsp;the&nbsp;first&nbsp;un-ack'd&lt;br&nbsp;/&gt;&amp;gt;&nbsp;message,&nbsp;as&nbsp;I'd&nbsp;expect.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;In&nbsp;fact,&nbsp;if&nbsp;I&nbsp;set&nbsp;channel.prefetch(..)&nbsp;to&nbsp;n,&nbsp;and&nbsp;kill/restart&nbsp;the&lt;br&nbsp;/&gt;&amp;gt;&nbsp;consumer&nbsp;after&nbsp;n+1&nbsp;messages&nbsp;have&nbsp;been&nbsp;received&nbsp;and&nbsp;ack'd,&nbsp;delivery&lt;br&nbsp;/&gt;&amp;gt;&nbsp;resumes&nbsp;with&nbsp;the&nbsp;first&nbsp;un-ack'd&nbsp;message.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;And&nbsp;if&nbsp;I&nbsp;issue&nbsp;a&nbsp;queue.unsubscribe,&nbsp;then&nbsp;kill&nbsp;and&nbsp;restart,&nbsp;delivery&lt;br&nbsp;/&gt;&amp;gt;&nbsp;resumes&nbsp;with&nbsp;un-ack'd&nbsp;messages.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;Have&nbsp;I&nbsp;misunderstood&nbsp;the&nbsp;way&nbsp;RabbitMQ&nbsp;and/or&nbsp;the&nbsp;gem&nbsp;are&nbsp;supposed&nbsp;to&lt;br&nbsp;/&gt;&amp;gt;&nbsp;behave?&nbsp;I&nbsp;really&nbsp;thought&nbsp;an&nbsp;ack&nbsp;was&nbsp;an&nbsp;ack.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;It's&nbsp;not&nbsp;clear&nbsp;what&nbsp;in&nbsp;the&nbsp;above&nbsp;you&nbsp;find&nbsp;surprising,&nbsp;except&nbsp;for&nbsp;the&nbsp;&lt;br&nbsp;/&gt;first&nbsp;observation.&nbsp;If&nbsp;your&nbsp;app&nbsp;is&nbsp;sending&nbsp;an&nbsp;ack&nbsp;but&nbsp;that&nbsp;doesn't&nbsp;show&nbsp;&lt;br&nbsp;/&gt;up&nbsp;on&nbsp;the&nbsp;wire&nbsp;then&nbsp;clearly&nbsp;there&nbsp;is&nbsp;a&nbsp;problem&nbsp;with&nbsp;either&nbsp;the&nbsp;app,&nbsp;or&nbsp;&lt;br&nbsp;/&gt;the&nbsp;client&nbsp;library,&nbsp;or&nbsp;the&nbsp;app's&nbsp;use&nbsp;of&nbsp;the&nbsp;client&nbsp;library.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;I&nbsp;suggest&nbsp;you&nbsp;post&nbsp;on&nbsp;http://groups.google.com/group/ruby-amqp&nbsp;or&nbsp;&lt;br&nbsp;/&gt;perhaps&nbsp;file&nbsp;an&nbsp;issue&nbsp;at&nbsp;https://github.com/ruby-amqp/amqp/issues&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Regards,&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Matthias.&lt;/p&gt;<br>
&lt;/div&gt;&lt;/font&gt;
</tt>
