<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;jrob,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Curious&nbsp;to&nbsp;know&nbsp;whether&nbsp;you&nbsp;pushed&nbsp;this&nbsp;setup&nbsp;in&nbsp;production&nbsp;and&nbsp;how&nbsp;has&nbsp;it&nbsp;been?&nbsp;Any&nbsp;surprises?&nbsp;We&nbsp;are&nbsp;also&nbsp;testing&nbsp;this&nbsp;in&nbsp;perf&nbsp;lab&nbsp;and&nbsp;plan&nbsp;to&nbsp;push&nbsp;to&nbsp;production&nbsp;in&nbsp;couple&nbsp;of&nbsp;weeks.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anup&lt;br&gt;&lt;br&gt;On&nbsp;Wednesday,&nbsp;January&nbsp;18,&nbsp;2012&nbsp;9:16:22&nbsp;AM&nbsp;UTC-8,&nbsp;jrob&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0;margin-left:&nbsp;0.8ex;border-left:&nbsp;1px&nbsp;#ccc&nbsp;solid;padding-left:&nbsp;1ex;&quot;&gt;Yup,&nbsp;that&nbsp;was&nbsp;it&nbsp;exactly.&nbsp;&nbsp;I&nbsp;just&nbsp;had&nbsp;the&nbsp;diff&nbsp;up,&nbsp;so&nbsp;here&nbsp;are&nbsp;the&nbsp;two&nbsp;major&nbsp;changes&nbsp;I&nbsp;had&nbsp;to&nbsp;make:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;-&nbsp;&nbsp;&nbsp;&nbsp;channel.queue(&nbsp;@queue,&nbsp;:durable&nbsp;=&gt;&nbsp;true&nbsp;).subscribe(:ack=&gt;true)&nbsp;do&nbsp;|header,message|&lt;/div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;channel.queue(&nbsp;@queue,&nbsp;:durable&nbsp;=&gt;&nbsp;true,&nbsp;:arguments&nbsp;=&gt;&nbsp;{'x-ha-policy'&nbsp;=&gt;&nbsp;'all'}&nbsp;).subscribe(:ack=&gt;true)&nbsp;do&nbsp;|header,message|&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;def&nbsp;self.get_channel(host)&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;AMQP.connect(&nbsp;:host=&gt;host&nbsp;)&lt;/div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;connection.on_connection_&lt;wbr&gt;interruption&nbsp;do&nbsp;|conn,&nbsp;settings|&lt;/div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.reconnect(false,1)&lt;/div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;end&lt;/div&gt;&lt;div&gt;+&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;AMQP::Channel.new(&nbsp;connection&nbsp;)&lt;/div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;channel.auto_recovery&nbsp;=&nbsp;true&lt;/div&gt;&lt;div&gt;+&lt;/div&gt;&lt;div&gt;+&nbsp;&nbsp;&nbsp;&nbsp;channel&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;end&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;I&nbsp;said,&nbsp;this&nbsp;hasn't&nbsp;gone&nbsp;into&nbsp;production&nbsp;yet,&nbsp;but&nbsp;it&nbsp;seems&nbsp;to&nbsp;be&nbsp;doing&nbsp;well&nbsp;in&nbsp;our&nbsp;staging&nbsp;environment.&nbsp;&nbsp;I&nbsp;don't&nbsp;think&nbsp;our&nbsp;message&nbsp;rate&nbsp;is&nbsp;high&nbsp;enough&nbsp;to&nbsp;really&nbsp;exercise&nbsp;this&nbsp;setup&nbsp;in&nbsp;staging,&nbsp;so&nbsp;I&nbsp;can't&nbsp;really&nbsp;comment&nbsp;on&nbsp;performance&nbsp;yet.&nbsp;&nbsp;(We're&nbsp;holding&nbsp;off&nbsp;moving&nbsp;this&nbsp;into&nbsp;production&nbsp;as&nbsp;we&nbsp;are&nbsp;trying&nbsp;to&nbsp;provide&nbsp;high&nbsp;availability&nbsp;for&nbsp;our&nbsp;applications&nbsp;and&nbsp;services&nbsp;across&nbsp;the&nbsp;board,&nbsp;which&nbsp;in&nbsp;some&nbsp;cases&nbsp;means&nbsp;we&nbsp;will&nbsp;be&nbsp;using&nbsp;one&nbsp;VM&nbsp;for&nbsp;multiple&nbsp;services.&nbsp;&nbsp;Since&nbsp;the&nbsp;other&nbsp;services&nbsp;aren't&nbsp;ready&nbsp;to&nbsp;go&nbsp;yet,&nbsp;we&nbsp;haven't&nbsp;pushed&nbsp;this&nbsp;up.)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;jrob&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;
</tt>
