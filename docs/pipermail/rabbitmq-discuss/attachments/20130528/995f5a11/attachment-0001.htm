<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;Hi&nbsp;Mark,&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;24&nbsp;May&nbsp;2013,&nbsp;at&nbsp;17:02,&nbsp;Mark&nbsp;Snelling&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,&nbsp;sans-serif&quot;&gt;I've&nbsp;managed&nbsp;to&nbsp;successfully&nbsp;implement&nbsp;reading&nbsp;from&nbsp;a&nbsp;mocked&nbsp;call&nbsp;to&nbsp;&lt;/font&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt;IModel.BasicConsume()&lt;/font&gt;&lt;font&nbsp;face=&quot;verdana,&nbsp;sans-serif&quot;&gt;&nbsp;and&nbsp;acknowledging&nbsp;with&amp;nbsp;&lt;/font&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt;IModel.BasicAck()&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;verdana,&nbsp;sans-serif;&quot;&gt;&nbsp;but&nbsp;am&nbsp;stuck&nbsp;on&amp;nbsp;&lt;/span&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt;IModel.BasicPublish()&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;verdana,&nbsp;sans-serif;&quot;&gt;,&nbsp;in&nbsp;particular&nbsp;mocking&nbsp;the&nbsp;ack/nack&nbsp;mechanism&nbsp;with&nbsp;&lt;/span&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt;IModel&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;verdana,&nbsp;sans-serif;&quot;&gt;&amp;nbsp;as&nbsp;I&nbsp;need&nbsp;to&nbsp;test&nbsp;my&nbsp;component&nbsp;in&nbsp;both&nbsp;those&nbsp;scenarios.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;verdana,&nbsp;sans-serif;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;verdana,&nbsp;sans-serif;&quot;&gt;How&nbsp;does&nbsp;the&nbsp;ack/nack&nbsp;mechanism&nbsp;work&nbsp;with&nbsp;&lt;/span&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt;IModel.WaitForConfirms()&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;verdana,&nbsp;sans-serif;&quot;&gt;&amp;nbsp;and&nbsp;how&nbsp;would&nbsp;I&nbsp;go&nbsp;about&nbsp;sending&nbsp;an&nbsp;ack/nack&nbsp;when&nbsp;the&nbsp;publisher&nbsp;calls&amp;nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;'courier&nbsp;new',&nbsp;monospace;&quot;&gt;IModel.BasicPublish()&lt;/span&gt;&lt;font&nbsp;face=&quot;verdana,&nbsp;sans-serif&quot;&gt;?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;verdana,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;really&nbsp;depends&nbsp;on&nbsp;how&nbsp;you've&nbsp;mocked&nbsp;the&nbsp;model&nbsp;reference,&nbsp;but&nbsp;essentially&nbsp;the&nbsp;broker&nbsp;will&nbsp;send&nbsp;either&nbsp;ACK&amp;nbsp;for&nbsp;one&nbsp;(or&nbsp;more,&nbsp;if&nbsp;batching)&nbsp;or&nbsp;NACK&nbsp;for&nbsp;the&nbsp;published&nbsp;messages,&nbsp;depending&nbsp;on&nbsp;whether&nbsp;or&nbsp;not&nbsp;it&nbsp;was&nbsp;willing&nbsp;and&nbsp;able&nbsp;to&nbsp;take&nbsp;responsibility&nbsp;for&nbsp;them.&nbsp;Presumably&nbsp;in&nbsp;your&nbsp;test&nbsp;cases&nbsp;you&nbsp;want&nbsp;to&nbsp;handle&nbsp;the&nbsp;situation&nbsp;where&nbsp;#WaitForConfirms()&nbsp;fails,&nbsp;in&nbsp;which&nbsp;case&nbsp;you&nbsp;should&nbsp;either&nbsp;return&nbsp;false&nbsp;(where&nbsp;you&nbsp;wish&nbsp;to&nbsp;simulate&nbsp;the&nbsp;broker&nbsp;issuing&nbsp;a&nbsp;NACK)&nbsp;or&nbsp;return&nbsp;true&nbsp;but&nbsp;also&nbsp;set&nbsp;the&nbsp;out&nbsp;parameter&nbsp;'timedOut'&nbsp;to&nbsp;true&nbsp;to&nbsp;indicate&nbsp;that&nbsp;a&nbsp;timeout&nbsp;occurred.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hope&nbsp;that&nbsp;makes&nbsp;sense.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;Tim&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
