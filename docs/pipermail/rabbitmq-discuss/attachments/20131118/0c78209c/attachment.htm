<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Nothing&nbsp;obvious&nbsp;stands&nbsp;out. &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;kind&nbsp;of&nbsp;crash&nbsp;are&nbsp;you&nbsp;getting?&nbsp;Run&nbsp;it&nbsp;under&nbsp;a&nbsp;debugger&nbsp;and&nbsp;see&nbsp;where&nbsp;it&nbsp;crashes?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Alan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Nov&nbsp;18,&nbsp;2013&nbsp;at&nbsp;1:50&nbsp;PM,&nbsp;Kiran&nbsp;Kumar&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kirankumar.pnm@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;kirankumar.pnm@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;have&nbsp;a&nbsp;rabbitmq&nbsp;server&nbsp;running&nbsp;on&nbsp;my&nbsp;debian&nbsp;linux&nbsp;machine.&nbsp;I&nbsp;have&nbsp;a&nbsp;BGP&nbsp;process&nbsp;running&nbsp;and&nbsp;it&nbsp;prepared&nbsp;a&nbsp;Route&nbsp;Message&nbsp;using&nbsp;google&nbsp;protocol&nbsp;buffers.&nbsp;The&nbsp;protocol&nbsp;buffer&nbsp;returns&nbsp;a&nbsp;binary&nbsp;data&nbsp;buffer.&lt;br&gt;<br>
&lt;br&gt;Then&nbsp;I&nbsp;have&nbsp;below&nbsp;code&nbsp;to&nbsp;send&nbsp;this&nbsp;data&nbsp;to&nbsp;rabbitmq&nbsp;server.&nbsp;When&nbsp;I&nbsp;execute&nbsp;this,&nbsp;the&nbsp;process&nbsp;crashes&nbsp;on&nbsp;amqp_basic_publish&nbsp;call.&nbsp;&lt;br&gt;&lt;br&gt;Any&nbsp;thoughts&nbsp;on&nbsp;this&nbsp;?&nbsp;Am&nbsp;I&nbsp;missing&nbsp;some&nbsp;thing&nbsp;here&nbsp;?&lt;br&gt;&lt;br&gt;&lt;br&gt;int&nbsp;bgp_mq_send(char&nbsp;const*&nbsp;rt_msg,&nbsp;int&nbsp;size)&lt;br&gt;<br>
{&lt;br&gt;   &nbsp;static&nbsp;int&nbsp;init_done&nbsp;=&nbsp;0;&lt;br&gt;   &nbsp;int&nbsp;status;&lt;br&gt;   &nbsp;amqp_socket_t&nbsp;*socket&nbsp;=&nbsp;NULL;&lt;br&gt;   &nbsp;amqp_connection_state_t&nbsp;conn&nbsp;=&nbsp;NULL;&lt;br&gt;   &nbsp;amqp_rpc_reply_t&nbsp;reply;&lt;br&gt;&lt;br&gt;   &nbsp;if&nbsp;(init_done&nbsp;==&nbsp;0)&nbsp;{&lt;br&gt;       &nbsp;conn&nbsp;=&nbsp;amqp_new_connection();&lt;br&gt;<br>
&lt;br&gt;       &nbsp;socket&nbsp;=&nbsp;amqp_tcp_socket_new(conn);&lt;br&gt;       &nbsp;if&nbsp;(!socket)&nbsp;{&lt;br&gt;           &nbsp;printf(&amp;quot;\n&nbsp;socket&nbsp;creation&nbsp;failed\n&amp;quot;);&lt;br&gt;           &nbsp;return&nbsp;1;&lt;br&gt;       &nbsp;}&lt;br&gt;&lt;br&gt;       &nbsp;status&nbsp;=&nbsp;amqp_socket_open(socket,&nbsp;&amp;quot;localhost&amp;quot;,&nbsp;5672);&lt;br&gt;<br>
       &nbsp;if&nbsp;(status)&nbsp;{&lt;br&gt;           &nbsp;printf(&amp;quot;\n&nbsp;socket&nbsp;open&nbsp;failed\n&amp;quot;);&lt;br&gt;           &nbsp;return&nbsp;1;&lt;br&gt;       &nbsp;}&lt;br&gt;&lt;br&gt;       &nbsp;reply&nbsp;=&nbsp;amqp_login(conn,&nbsp;&amp;quot;/&amp;quot;,&nbsp;0,&nbsp;131072,&nbsp;0,&nbsp;&lt;font&nbsp;size=&quot;1&quot;&gt;AMQP_SASL_METHOD_PLAIN&lt;/font&gt;,&nbsp;&amp;quot;guest&amp;quot;,&nbsp;&amp;quot;guest&amp;quot;);&lt;br&gt;<br>
       &nbsp;if&nbsp;(reply.reply_type)&nbsp;{&lt;br&gt;           &nbsp;printf(&amp;quot;\n&nbsp;Login&nbsp;is&nbsp;failed\n&amp;quot;);&lt;br&gt;       &nbsp;}&lt;br&gt;&lt;br&gt;       &nbsp;amqp_channel_open(conn,&nbsp;1);&lt;br&gt;       &nbsp;reply&nbsp;=&nbsp;amqp_get_rpc_reply(conn);&lt;br&gt;       &nbsp;if&nbsp;(reply.reply_type)&nbsp;{&lt;br&gt;<br>
           &nbsp;printf(&amp;quot;\n&nbsp;get_reply&nbsp;failed\n&amp;quot;);&lt;br&gt;       &nbsp;}&lt;br&gt;       &nbsp;init_done&nbsp;=&nbsp;1;&lt;br&gt;   &nbsp;}&lt;br&gt;&lt;br&gt;&lt;br&gt;   &nbsp;{&lt;br&gt;       &nbsp;amqp_basic_properties_t&nbsp;props;&lt;br&gt;       &nbsp;props._flags&nbsp;=&nbsp;&lt;font&nbsp;size=&quot;1&quot;&gt;AMQP_BASIC_CONTENT_TYPE_FLAG&nbsp;|   &nbsp;AMQP_BASIC_DELIVERY_MODE_FLAG&lt;/font&gt;;&lt;br&gt;<br>
       &nbsp;props.content_type&nbsp;=&nbsp;amqp_cstring_bytes(&amp;quot;gpb&amp;quot;);&lt;br&gt;       &nbsp;props.content_encoding&nbsp;=&nbsp;amqp_cstring_bytes(&amp;quot;binary&amp;quot;);&lt;br&gt;       &nbsp;props.delivery_mode&nbsp;=&nbsp;2;&nbsp;/*&nbsp;persistent&nbsp;delivery&nbsp;mode&nbsp;*/&lt;br&gt;&lt;br&gt;       &nbsp;amqp_bytes_t&nbsp;str2;&lt;br&gt;<br>
       &nbsp;str2.len&nbsp;=&nbsp;size;&lt;br&gt;       &nbsp;str2.bytes&nbsp;=&nbsp;rt_msg;&lt;br&gt;&lt;br&gt;       &nbsp;status&nbsp;=&nbsp;amqp_basic_publish(conn,&nbsp;1,&nbsp;amqp_cstring_bytes(&amp;quot;amq.fanout&amp;quot;),&lt;br&gt;                       &nbsp;amqp_cstring_bytes(&amp;quot;#&amp;quot;),&nbsp;0,&nbsp;0,&lt;br&gt;<br>
                       &nbsp;&amp;amp;props,&nbsp;str2); &nbsp;&lt;b&gt;&amp;lt;&amp;lt;&amp;lt;-----------&nbsp;It&nbsp;crashes&nbsp;right&nbsp;here.&lt;/b&gt;&nbsp; &nbsp;&lt;br&gt;&lt;br&gt;       &nbsp;if&nbsp;(status&nbsp;&amp;lt;&nbsp;0)&nbsp;{&lt;br&gt;           &nbsp;printf(&amp;quot;\n&nbsp;publish&nbsp;failed\n&amp;quot;);&lt;br&gt;       &nbsp;}&lt;br&gt;       &nbsp;printf(&amp;quot;\n&nbsp;Publish&nbsp;success\n&amp;quot;);&lt;br&gt;<br>
   &nbsp;}&lt;br&gt;   &nbsp;reply&nbsp;=&nbsp;amqp_channel_close(conn,&nbsp;1,&nbsp;AMQP_REPLY_SUCCESS);&lt;br&gt;   &nbsp;if&nbsp;(reply.reply_type)&nbsp;{&lt;br&gt;       &nbsp;printf(&amp;quot;\n&nbsp;chan&nbsp;close&nbsp;failed\n&amp;quot;);&lt;br&gt;   &nbsp;}&lt;br&gt;   &nbsp;reply&nbsp;=&nbsp;amqp_connection_close(conn,&nbsp;AMQP_REPLY_SUCCESS);&lt;br&gt;<br>
   &nbsp;if&nbsp;(reply.reply_type)&nbsp;{&lt;br&gt;       &nbsp;printf(&amp;quot;\n&nbsp;conn&nbsp;close&nbsp;failed\n&amp;quot;);&lt;br&gt;   &nbsp;}&lt;br&gt;   &nbsp;status&nbsp;=&nbsp;amqp_destroy_connection(conn);&lt;br&gt;   &nbsp;if&nbsp;(status&nbsp;&amp;lt;&nbsp;0)&nbsp;{&lt;br&gt;       &nbsp;printf(&amp;quot;\n&nbsp;Destroy&nbsp;failed\n&amp;quot;);&lt;br&gt;<br>
   &nbsp;}&lt;br&gt;   &nbsp;printf(&amp;quot;\n&nbsp;All&nbsp;Done\n&amp;quot;);&lt;br&gt;   &nbsp;return&nbsp;0;&lt;br&gt;}&lt;br&gt;&lt;br&gt;any&nbsp;help&nbsp;in&nbsp;moving&nbsp;forward&nbsp;would&nbsp;be&nbsp;great.&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Kiran.&lt;br&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
