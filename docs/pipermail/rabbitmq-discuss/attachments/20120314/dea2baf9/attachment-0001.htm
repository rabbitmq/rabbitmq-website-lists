<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
<br>
&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;using&nbsp;Puka&nbsp;client&nbsp;[1]&nbsp;in&nbsp;order&nbsp;to&nbsp;send&nbsp;messages&nbsp;with&nbsp;guaranteed<br>
delivery&nbsp;using&nbsp;publisher&nbsp;confirms.&lt;br&gt;<br>
&lt;br&gt;<br>
Trying&nbsp;to&nbsp;send&nbsp;200.000&nbsp;messages&nbsp;I&nbsp;see&nbsp;that&nbsp;waiting&nbsp;for&nbsp;the&nbsp;confirms,<br>
takes&nbsp;a&nbsp;lot&nbsp;of&nbsp;time.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;be&nbsp;more&nbsp;specific:&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;promises&nbsp;=&nbsp;[]&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;t0&nbsp;=&nbsp;time.time()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,200000):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;promise&nbsp;=&nbsp;client.basic_publish(exchange='test_exchange',<br>
routing_key='test',&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
body=&quot;Hello&nbsp;world!&quot;)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;promises.append(promise)&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;t1&nbsp;=&nbsp;time.time()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;big&gt;&nbsp;client.wait(promises)&lt;/big&gt;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;t2&nbsp;=&nbsp;time.time()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;promise&nbsp;=&nbsp;client.close()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;client.wait(promise)&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;this&nbsp;example&nbsp;t1-t0&nbsp;is&nbsp;arround&nbsp;9s&nbsp;while&nbsp;t2-t1&nbsp;is&nbsp;more&nbsp;than&nbsp;100<br>
seconds!!&lt;br&gt;<br>
Increasing&nbsp;the&nbsp;number&nbsp;of&nbsp;messages&nbsp;results&nbsp;in&nbsp;even&nbsp;worse&nbsp;performance.&lt;br&gt;<br>
&lt;br&gt;<br>
Can&nbsp;anyone&nbsp;explain&nbsp;this&nbsp;behavior&nbsp;?&nbsp;Is&nbsp;there&nbsp;a&nbsp;more&nbsp;effective&nbsp;way&nbsp;to&nbsp;use<br>
publisher&nbsp;confirms&nbsp;?&lt;br&gt;<br>
&lt;br&gt;<br>
Chris&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
[1]:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;<br>
&nbsp;href=&quot;https://github.com/majek/puka&quot;&gt;https://github.com/majek/puka&lt;/a&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
