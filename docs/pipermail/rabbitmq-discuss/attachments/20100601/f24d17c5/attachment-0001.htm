<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Likewise,&nbsp;I&nbsp;appreciate&nbsp;the&nbsp;feedback.&lt;br&gt;<br>
&lt;br&gt;<br>
Can&nbsp;someone&nbsp;elaborate&nbsp;on&nbsp;the&nbsp;expected&nbsp;bottlenecks&nbsp;when&nbsp;using<br>
transactions?&nbsp;From&nbsp;what&nbsp;I've&nbsp;mocked&nbsp;up&nbsp;so&nbsp;far,&nbsp;it&nbsp;looks&nbsp;like&nbsp;the<br>
majority&nbsp;of&nbsp;the&nbsp;overhead&nbsp;is&nbsp;associated&nbsp;with&nbsp;tx.commit&nbsp;(no&nbsp;surprise<br>
there)&nbsp;and&nbsp;that&nbsp;I&nbsp;can&nbsp;get&nbsp;much&nbsp;better&nbsp;performance&nbsp;by&nbsp;batching&nbsp;messages<br>
within&nbsp;a&nbsp;single&nbsp;transaction.&nbsp;I&nbsp;also&nbsp;looked&nbsp;at&nbsp;running&nbsp;multiple<br>
tx.commit&nbsp;operations&nbsp;concurrently&nbsp;in&nbsp;different&nbsp;channels&nbsp;in&nbsp;different<br>
threads,&nbsp;but&nbsp;there&nbsp;doesn't&nbsp;actually&nbsp;appear&nbsp;to&nbsp;be&nbsp;any&nbsp;performance<br>
benefit&nbsp;to&nbsp;doing&nbsp;so.&nbsp;Am&nbsp;I&nbsp;right&nbsp;to&nbsp;conclude&nbsp;that&nbsp;only&nbsp;a&nbsp;single<br>
transaction&nbsp;is&nbsp;allowed&nbsp;at&nbsp;a&nbsp;time&nbsp;per&nbsp;connection?&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;so,&nbsp;this&nbsp;suggests&nbsp;queuing&nbsp;up&nbsp;messages&nbsp;client&nbsp;side&nbsp;and&nbsp;having&nbsp;a<br>
single&nbsp;worker&nbsp;thread&nbsp;submit&nbsp;messages&nbsp;in&nbsp;batches.&nbsp;Does&nbsp;this&nbsp;sound<br>
reasonable?&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
&lt;br&gt;<br>
Jesse&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;6/1/10&nbsp;4:35&nbsp;AM,&nbsp;Sylvain&nbsp;Hellegouarch&nbsp;wrote:<br>
&lt;blockquote<br>
&nbsp;cite=&quot;mid:AANLkTinJ-qg3BDFHdLFEbaI1Qafb66x1Jkm4ONF6K0Qz@mail.gmail.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;May&nbsp;31,&nbsp;2010&nbsp;at&nbsp;10:30&nbsp;PM,&nbsp;David<br>
Wragg&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;href=&quot;mailto:david@rabbitmq.com&quot;&gt;david@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;<br>
wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;<br>
&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Hi<br>
Sylvain,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
Sylvain&nbsp;Hellegouarch&nbsp;&amp;lt;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;href=&quot;mailto:sh@defuze.org&quot;&gt;sh@defuze.org&lt;/a&gt;&amp;gt;&nbsp;writes:&lt;br&gt;<br>
&amp;gt;&nbsp;I'm&nbsp;curious,&nbsp;in&nbsp;the&nbsp;general&nbsp;case,&nbsp;what's&nbsp;the&nbsp;cost&nbsp;of&nbsp;using&nbsp;a<br>
transaction?&lt;br&gt;<br>
&amp;gt;&nbsp;Does&nbsp;it&nbsp;consume&nbsp;more&nbsp;resources?&nbsp;Roughly,&nbsp;what&nbsp;takes&nbsp;place&nbsp;within&lt;br&gt;<br>
&amp;gt;&nbsp;RabbitMQ?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
There&nbsp;is&nbsp;indeed&nbsp;a&nbsp;cost&nbsp;associated&nbsp;with&nbsp;a&nbsp;transaction.&nbsp;&amp;nbsp;One&nbsp;source&nbsp;of&lt;br&gt;<br>
overhead&nbsp;is&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;AMQP&nbsp;tx.commit&nbsp;method&nbsp;is&nbsp;synchronous,&nbsp;and&lt;br&gt;<br>
so&nbsp;involves&nbsp;a&nbsp;round-trip&nbsp;over&nbsp;the&nbsp;network&nbsp;to&nbsp;the&nbsp;server.&nbsp;&amp;nbsp;Another&nbsp;is&nbsp;the&lt;br&gt;<br>
fact&nbsp;that&nbsp;when&nbsp;the&nbsp;server&nbsp;commits&nbsp;a&nbsp;transaction,&nbsp;it&nbsp;must&nbsp;make&nbsp;sure&nbsp;that&lt;br&gt;<br>
the&nbsp;relevant&nbsp;effects&nbsp;of&nbsp;a&nbsp;transaction&nbsp;have&nbsp;reached&nbsp;stable&nbsp;storage&lt;br&gt;<br>
(e.g.&nbsp;that&nbsp;a&nbsp;persistent&nbsp;message&nbsp;that&nbsp;reaches&nbsp;a&nbsp;queue&nbsp;has&nbsp;been&nbsp;stored&nbsp;on&lt;br&gt;<br>
disk).&nbsp;&amp;nbsp;My&nbsp;colleagues&nbsp;might&nbsp;be&nbsp;able&nbsp;to&nbsp;list&nbsp;other&nbsp;costs.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
It's&nbsp;difficult&nbsp;to&nbsp;quantify&nbsp;these&nbsp;costs&nbsp;in&nbsp;general,&nbsp;but&nbsp;I&nbsp;think&nbsp;its&nbsp;fair&lt;br&gt;<br>
to&nbsp;say&nbsp;that&nbsp;they&nbsp;have&nbsp;a&nbsp;significant&nbsp;impact&nbsp;compared&nbsp;with&lt;br&gt;<br>
non-transactional&nbsp;uses&nbsp;of&nbsp;AMQP.&nbsp;&amp;nbsp;The&nbsp;MulticastMain&nbsp;tool&nbsp;included&nbsp;with&lt;br&gt;<br>
our&nbsp;Java&nbsp;client&nbsp;library&nbsp;has&nbsp;command&nbsp;line&nbsp;options&nbsp;that&nbsp;allow&nbsp;the&nbsp;impact&lt;br&gt;<br>
to&nbsp;be&nbsp;measured&nbsp;in&nbsp;various&nbsp;scenarios.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
David&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
Cheers&nbsp;for&nbsp;that&nbsp;feedback.&nbsp;Much&nbsp;appreciated.&nbsp;I&nbsp;will&nbsp;try&nbsp;to&nbsp;perform&nbsp;some<br>
measurements&nbsp;and&nbsp;see&nbsp;both&nbsp;the&nbsp;server&nbsp;and&nbsp;client&nbsp;behave.&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
--&nbsp;&lt;br&gt;<br>
-&nbsp;Sylvain&lt;br&gt;<br>
&nbsp;&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;http://www.defuze.org&quot;&gt;http://www.defuze.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;http://twitter.com/lawouach&quot;&gt;http://twitter.com/lawouach&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
_______________________________________________<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
