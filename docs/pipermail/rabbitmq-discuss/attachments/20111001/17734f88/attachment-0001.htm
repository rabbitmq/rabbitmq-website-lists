<tt>
&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;helvetica,&nbsp;arial,&nbsp;freesans,&nbsp;clean,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;line-height:&nbsp;13px;&nbsp;&quot;&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
Hi&lt;/p&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;figure&nbsp;out&nbsp;how&nbsp;RabbitMQ/php-amqplib&nbsp;work&nbsp;and&nbsp;have&nbsp;issue&nbsp;with&nbsp;Routing&nbsp;Keys.&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
Two&nbsp;messages&nbsp;are&nbsp;sent&nbsp;to&nbsp;&amp;#39;Queue&amp;#39;&nbsp;queue&nbsp;using&nbsp;Routing&nbsp;Keys:&nbsp;&amp;#39;&lt;a&nbsp;href=&quot;http://server1.info&quot;&gt;server1.info&lt;/a&gt;&amp;#39;&nbsp;and&nbsp;&amp;#39;server1.error&amp;#39;:&lt;/p&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
$server&nbsp;=&nbsp;1;&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;$conn&nbsp;=&nbsp;new&nbsp;AMQPConnection(HOST,&nbsp;PORT,&nbsp;USER,&nbsp;PASS,&nbsp;VHOST);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$channel&nbsp;=&nbsp;$conn-&amp;gt;channel();&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;$channel-&amp;gt;exchange_declare(XCHANGE_NAME,&nbsp;&amp;#39;topic&amp;#39;,&nbsp;false,&nbsp;true,&nbsp;false);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$msg&nbsp;=&nbsp;new&nbsp;AMQPMessage(&amp;#39;Server&nbsp;&amp;#39;.$server.&amp;#39;&nbsp;INFO&amp;#39;&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
,&nbsp;array(&amp;#39;content_type&amp;#39;&nbsp;=&amp;gt;&nbsp;&amp;#39;text/plain&amp;#39;));&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$channel-&amp;gt;basic_publish($msg,&nbsp;XCHANGE_NAME&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;,&nbsp;&amp;#39;server&amp;#39;.$server.&amp;#39;.info&amp;#39;);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$msg&nbsp;=&nbsp;new&nbsp;AMQPMessage(&amp;#39;Server&nbsp;&amp;#39;.$server.&amp;#39;&nbsp;ERROR&amp;#39;&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
,&nbsp;array(&amp;#39;content_type&amp;#39;&nbsp;=&amp;gt;&nbsp;&amp;#39;text/plain&amp;#39;));&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$channel-&amp;gt;basic_publish($msg,&nbsp;XCHANGE_NAME&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;,&nbsp;&amp;#39;server&amp;#39;.$server.&amp;#39;.error&amp;#39;);&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
On&nbsp;the&nbsp;other&nbsp;end,&nbsp;I&nbsp;use&nbsp;&amp;#39;#.error&amp;#39;&nbsp;in&nbsp;consumer-error.php&nbsp;and&nbsp;&amp;#39;#.info&amp;#39;&nbsp;in&nbsp;consumer-info.php,&nbsp;but&nbsp;both&nbsp;messages&nbsp;are&nbsp;appeared&nbsp;if&nbsp;I&nbsp;run&nbsp;any&nbsp;of&nbsp;the&nbsp;consumers:&lt;/p&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
$conn&nbsp;=&nbsp;new&nbsp;AMQPConnection(HOST,&nbsp;PORT,&nbsp;USER,&nbsp;PASS,&nbsp;VHOST);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$channel&nbsp;=&nbsp;$conn-&amp;gt;channel();&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;$channel-&amp;gt;exchange_declare(XCHANGE_NAME,&nbsp;&amp;#39;topic&amp;#39;,&nbsp;false,&nbsp;true,&nbsp;false);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$channel-&amp;gt;queue_declare(QUEUE_NAME,&nbsp;false,&nbsp;true,&nbsp;false,&nbsp;false);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$channel-&amp;gt;queue_bind(QUEUE_NAME,&nbsp;XCHANGE_NAME,&nbsp;&amp;#39;#.info&amp;#39;);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
function&nbsp;process_message($msg)&nbsp;{&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;echo&nbsp;$msg-&amp;gt;body.&amp;quot;\n&amp;quot;;&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
$msg-&amp;gt;delivery_info[&amp;#39;channel&amp;#39;]-&amp;gt;&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;basic_ack($msg-&amp;gt;delivery_info[&amp;#39;delivery_tag&amp;#39;]);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
}&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;$channel-&amp;gt;basic_consume(QUEUE_NAME,&nbsp;&amp;#39;consumer&amp;#39;,&nbsp;false,&nbsp;false,&nbsp;false,&nbsp;false,&nbsp;&amp;#39;process_message&amp;#39;);&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
while(count($channel-&amp;gt;callbacks))&nbsp;{&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;$channel-&amp;gt;wait();&lt;br&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0px;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;&quot;&gt;<br>
}&lt;/p&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
I&amp;#39;m&nbsp;expecting&nbsp;the&nbsp;separation&nbsp;by&nbsp;this&nbsp;key,&nbsp;but&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;happen.&nbsp;What&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong?&lt;/p&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;margin-top:&nbsp;1em&nbsp;!important;&nbsp;margin-right:&nbsp;0px&nbsp;!important;&nbsp;margin-bottom:&nbsp;1em&nbsp;!important;&nbsp;margin-left:&nbsp;0px&nbsp;!important;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;0px;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;0px;&nbsp;line-height:&nbsp;1.5em&nbsp;!important;&nbsp;&quot;&gt;<br>
&lt;br&gt;&lt;/p&gt;&lt;/span&gt;--&nbsp;&lt;br&gt;Regards,&lt;br&gt;Roman&nbsp;B.&lt;br&gt;&lt;br&gt;<br>

</tt>
