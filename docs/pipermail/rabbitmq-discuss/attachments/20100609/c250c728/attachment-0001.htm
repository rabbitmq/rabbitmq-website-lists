<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2010/6/9&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;09/06/10&nbsp;16:12,&nbsp;Nicolás&nbsp;César&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Is&nbsp;there&nbsp;any&nbsp;other&nbsp;way&nbsp;to&nbsp;checkit?&nbsp; Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;get&nbsp;a&nbsp;memory&nbsp;dump&lt;br&gt;<br>
from&nbsp;the&nbsp;vm&nbsp;to&nbsp;see&nbsp;whats&nbsp;going&nbsp;on?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Well,&nbsp;there&amp;#39;s&nbsp;erlang:memory/0.&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&amp;#39;re&nbsp;using&nbsp;the&nbsp;Debian&nbsp;packages,&nbsp;type:&lt;br&gt;<br>
&lt;br&gt;<br>
$&nbsp;sudo&nbsp;-u&nbsp;rabbitmq&nbsp;-H&nbsp;erl&nbsp;-remsh&nbsp;rabbit@`hostname`&nbsp;-sname&nbsp;foo&lt;br&gt;<br>
&lt;br&gt;<br>
to&nbsp;establish&nbsp;a&nbsp;connection&nbsp;to&nbsp;the&nbsp;RabbitMQ&nbsp;Erlang&nbsp;process&nbsp;then&nbsp;at&nbsp;the&nbsp;Erlang&nbsp;prompt:&lt;br&gt;<br>
&lt;br&gt;<br>
memory().&lt;br&gt;<br>
&lt;br&gt;<br>
to&nbsp;give&nbsp;some&nbsp;high&nbsp;level&nbsp;statistics&nbsp;about&nbsp;what&amp;#39;s&nbsp;using&nbsp;memory.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Cool!!&nbsp;&lt;br&gt;&lt;br&gt;(rabbit@sendsorium)1&amp;gt;&nbsp;memory().&lt;br&gt;[{total,27420688},&lt;br&gt; {processes,8840004},&lt;br&gt; {processes_used,8793876},&lt;br&gt;<br>
<br>
 {system,18580684},&lt;br&gt; {atom,683329},&lt;br&gt; {atom_used,650462},&lt;br&gt; {binary,11081456},&lt;br&gt; {code,5263067},&lt;br&gt; {ets,452988}]&lt;br&gt; &lt;br&gt;but&nbsp;in&nbsp;top&nbsp;I&nbsp;see&nbsp;beam.smp&nbsp;using:&lt;br&gt;VIRT=141m &nbsp;RES=95m&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;none&nbsp;of&nbsp;those&nbsp;numbers&nbsp;get&nbsp;close....&nbsp;&lt;br&gt;<br>
<br>
&lt;br&gt;How&nbsp;can&nbsp;I&nbsp;use&nbsp;this&nbsp;information&nbsp;to&nbsp;get&nbsp;better&nbsp;debugging?&nbsp;&lt;br&gt;&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Other&nbsp;things&nbsp;to&nbsp;think&nbsp;about:&lt;br&gt;<br>
&lt;br&gt;<br>
*&nbsp;Are&nbsp;you&nbsp;using&nbsp;the&nbsp;most&nbsp;recent&nbsp;Erlang?&nbsp;(R13B04)&nbsp;GC&nbsp;has&nbsp;improved&nbsp;recently.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&amp;#39;ve&nbsp;been&nbsp;using:&lt;br&gt; Erlang&nbsp;R13B02&nbsp;(erts-5.7.3)&nbsp;[source]&nbsp;[smp:2:2]&nbsp;[rq:2]&nbsp;[async-threads:0]&nbsp;[kernel-poll:false]&lt;br&gt;&lt;br&gt;<br>
<br>
Is&nbsp;that&nbsp;old?&nbsp;I&amp;#39;m&nbsp;trying&nbsp;other&nbsp;resources&nbsp;before&nbsp;changing&nbsp;erlang&nbsp;version&nbsp;(and&nbsp;taking&nbsp;my&nbsp;Debian&nbsp;to&nbsp;&amp;#39;testing&amp;#39;&nbsp;instead&nbsp;of&nbsp;&amp;#39;stable&amp;#39;)&nbsp;.&nbsp;Thanks&nbsp;for&nbsp;the&nbsp;advice.&nbsp;Now&nbsp;I&amp;#39;m&nbsp;aware&nbsp;of&nbsp;that...&nbsp;if&nbsp;everything&nbsp;fails,&nbsp;I&amp;#39;ll&nbsp;do&nbsp;it!&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
*&nbsp;Are&nbsp;you&nbsp;stopping&nbsp;the&nbsp;queues&nbsp;from&nbsp;hibernating?&nbsp;If&nbsp;you&amp;#39;ve&nbsp;written&nbsp;something&nbsp;like&nbsp;a&nbsp;shell&nbsp;script&nbsp;to&nbsp;repeatedly&nbsp;invoke&nbsp;rabbitmqctl&nbsp;list_queues&nbsp;this&nbsp;will&nbsp;keep&nbsp;the&nbsp;queue&nbsp;processes&nbsp;from&nbsp;hibernating&nbsp;which&nbsp;in&nbsp;turn&nbsp;stops&nbsp;them&nbsp;from&nbsp;GCing&nbsp;on&nbsp;hibernate.&nbsp;If&nbsp;queues&nbsp;are&nbsp;busy&nbsp;this&nbsp;is&nbsp;not&nbsp;a&nbsp;problem&nbsp;as&nbsp;they&nbsp;also&nbsp;GC&nbsp;every&nbsp;(n)&nbsp;reductions,&nbsp;but&nbsp;if&nbsp;they&amp;#39;re&nbsp;almost-but-not-quite&nbsp;idle&nbsp;it&nbsp;can&nbsp;be&nbsp;a&nbsp;problem.&nbsp;It&nbsp;doesn&amp;#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;a&nbsp;shell&nbsp;script,&nbsp;anything&nbsp;that&nbsp;means&nbsp;the&nbsp;queues&nbsp;never&nbsp;get&nbsp;10&nbsp;seconds&nbsp;or&nbsp;so&nbsp;idle.&lt;/blockquote&gt;<br>
<br>
&lt;div&gt; &lt;/div&gt;&lt;div&gt;&lt;br&gt;This&nbsp;is&nbsp;really&nbsp;nice&nbsp;data!!&nbsp;Yes.&nbsp;I&nbsp;have&nbsp;scripts&nbsp;but&nbsp;they&amp;#39;re&nbsp;cron&amp;#39;ed&nbsp;every&nbsp;minute....&nbsp;I&amp;#39;m&nbsp;changing&nbsp;that&nbsp;and&nbsp;testing&nbsp;again.&nbsp;&lt;br&gt;&lt;br&gt;One&nbsp;small&nbsp;detail.&nbsp;I&amp;#39;m&nbsp;using:&lt;br&gt;&lt;br&gt;-----------------------------------------------------&lt;br&gt;<br>
<br>
while&nbsp;True:&lt;br&gt; &nbsp;msg&nbsp;=&nbsp;self.chan.basic_get(self.config[&amp;#39;queue&amp;#39;])&lt;br&gt; &nbsp;if&nbsp;msg:&lt;br&gt; &nbsp;  &nbsp;....&lt;br&gt; &nbsp;time.sleep(2.0)&lt;br&gt;----------------------------------------------------&lt;br&gt;&lt;br&gt;because&nbsp;I&nbsp;need&nbsp;a&nbsp;fixed-rate&nbsp;consumer&nbsp;.&nbsp;...&nbsp;could&nbsp;this&nbsp;be&nbsp;a&nbsp;similar&nbsp;case&nbsp;of&nbsp;the&nbsp;&amp;quot;almost-but-not-quite&nbsp;idle&nbsp;queue&amp;quot;?&nbsp;&lt;br&gt;<br>
<br>
is&nbsp;there&nbsp;any&nbsp;way&nbsp;to&nbsp;tell&nbsp;the&nbsp;broker&nbsp;to&nbsp;consume&nbsp;at&nbsp;a&nbsp;fixed&nbsp;rate&nbsp;with&nbsp;chan.basic_consume(...callback&nbsp;=&nbsp;f)?&lt;br&gt;&lt;br&gt;Greetings&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;Nico&nbsp;César&lt;br&gt;&lt;a&nbsp;href=&quot;http://blog.nicocesar.com&quot;&gt;http://blog.nicocesar.com&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
