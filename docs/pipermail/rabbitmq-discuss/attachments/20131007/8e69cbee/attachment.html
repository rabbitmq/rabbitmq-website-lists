<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;have&nbsp;created&nbsp;clustered&nbsp;environment&nbsp;with&nbsp;two&nbsp;nodes&nbsp;and&nbsp;started&nbsp;producer&nbsp;and&nbsp;consumer&nbsp;at&nbsp;the&nbsp;same&nbsp;time.&nbsp;After&nbsp;sometime&nbsp;stopped&nbsp;one&nbsp;node&nbsp;but&nbsp;consumer&nbsp;is&nbsp;not&nbsp;running&nbsp;on&nbsp;other&nbsp;rabbitmq&nbsp;node.&nbsp;After&nbsp;stopping&nbsp;the&nbsp;running&nbsp;node&nbsp;it&nbsp;is&nbsp;giving&nbsp;below&nbsp;warning? &lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;WARN&nbsp; [.listener.SimpleMessageListenerContainer]:&nbsp;Consumer&nbsp;raised&nbsp;exception,&nbsp;processing&nbsp;can&nbsp;restart&nbsp;if&nbsp;the&nbsp;connection&nbsp;factory&nbsp;supports&nbsp;it&lt;/div&gt;&lt;div&gt;com.rabbitmq.client.ShutdownSignalException:&nbsp;connection&nbsp;error;&nbsp;reason:&nbsp;{#method&amp;lt;connection.close&amp;gt;(reply-code=541,&nbsp;reply-text=INTERNAL_ERROR,&nbsp;class-id=0,&nbsp;method-id=0),&nbsp;null,&nbsp;&amp;quot;&amp;quot;}&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection.startShutdown(AMQConnection.java:678)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection.shutdown(AMQConnection.java:668)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection.handleConnectionClose(AMQConnection.java:624)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection.processControlCommand(AMQConnection.java:598)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection$1.processAsync(AMQConnection.java:96)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel.java:144)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:91)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:523)&lt;/div&gt;<br>
&lt;div&gt;INFO&nbsp; [.listener.SimpleMessageListenerContainer]:&nbsp;Restarting&nbsp;Consumer:&nbsp;tag=[amq.ctag-5CJ3YJYfMZDnJOnXsds6_Q],&nbsp;channel=Cached&nbsp;Rabbit&nbsp;Channel:&nbsp;AMQChannel(amqp://&lt;a&nbsp;href=&quot;http://guest@192.168.97.70:5672/,1&quot;&gt;guest@192.168.97.70:5672/,1&lt;/a&gt;),&nbsp;acknowledgeMode=AUTO&nbsp;local&nbsp;queue&nbsp;size=0&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;the&nbsp;configuration&nbsp;is&nbsp;- &lt;/div&gt;&lt;div&gt;&lt;div&gt;CachingConnectionFactory&nbsp;connectionFactory&nbsp;=&nbsp;new&nbsp;CachingConnectionFactory();&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;connectionFactory.setAddresses(&amp;quot;node1:5672,node2:5672&amp;quot;);&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Along&nbsp;with&nbsp;above&nbsp;query,&nbsp;I&nbsp;have&nbsp;below&nbsp;queries&nbsp;in&nbsp;my&nbsp;mind-&lt;/div&gt;&lt;div&gt;1&amp;gt;&nbsp;How&nbsp;to&nbsp;differenciate&nbsp;master&nbsp;and&nbsp;slave&nbsp;in&nbsp;rabbitmq&nbsp;cluster?&lt;/div&gt;&lt;div&gt;2&amp;gt;&nbsp;Is&nbsp;there&nbsp;any&nbsp;load&nbsp;balancer&nbsp;do&nbsp;we&nbsp;need&nbsp;ti&nbsp;maintain&nbsp;?&lt;/div&gt;<br>
&lt;div&gt;3&amp;gt;&nbsp;How&nbsp;to&nbsp;dispatch&nbsp;requests&nbsp;to&nbsp;to&nbsp;particular&nbsp;node&nbsp;like&nbsp;below,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;1-100&nbsp;queues&nbsp;=&amp;gt;&nbsp;Node1&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; 101-200&nbsp;queues&nbsp;=&amp;gt;&nbsp;Node2&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; 201-300&nbsp;queues&nbsp;=&amp;gt;&nbsp;Node3,&nbsp;etc&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;in&nbsp;advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
