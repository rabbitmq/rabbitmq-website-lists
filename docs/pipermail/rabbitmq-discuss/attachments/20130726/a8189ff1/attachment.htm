<tt>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;following&nbsp;on&nbsp;from&nbsp;a&nbsp;tweet&nbsp;I&nbsp;made&nbsp;earlier&nbsp;about&nbsp;wishing&nbsp;that&nbsp;RabbitMQ&nbsp;had&nbsp;the&nbsp;ability&nbsp;to&nbsp;push&nbsp;messages&nbsp;to&nbsp;the&nbsp;back&nbsp;of&nbsp;the&nbsp;queue&nbsp;when&nbsp;NAcked.&amp;nbsp;&lt;/div&gt;&lt;div&gt;Alvaro&nbsp;Videla&nbsp;replied&nbsp;suggesting&nbsp;I&nbsp;ask&nbsp;for&nbsp;the&nbsp;feature&nbsp;here.&amp;nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Scenario:&amp;nbsp;&lt;/div&gt;&lt;div&gt;I'm&nbsp;processing&nbsp;messages&nbsp;from&nbsp;a&nbsp;queue&nbsp;with&nbsp;confirmation&nbsp;required.&amp;nbsp;&lt;/div&gt;&lt;div&gt;The&nbsp;number&nbsp;of&nbsp;messages&nbsp;relative&nbsp;to&nbsp;the&nbsp;consumption&nbsp;rate&nbsp;can&nbsp;be&nbsp;quite&nbsp;high&nbsp;at&nbsp;times.&nbsp;In&nbsp;excess&nbsp;of&nbsp;hundreds&nbsp;of&nbsp;thousands&nbsp;of&nbsp;messages,&nbsp;with&nbsp;consumption&nbsp;rate&nbsp;in&nbsp;the&nbsp;low&nbsp;hundreds&nbsp;per&nbsp;second&nbsp;range.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sometimes&nbsp;we&nbsp;have&nbsp;to&nbsp;abandon&nbsp;processing&nbsp;a&nbsp;message&nbsp;for&nbsp;some&nbsp;transient&nbsp;reason&nbsp;(eg:&nbsp;external&nbsp;resource&nbsp;is&nbsp;locked/unavailable),&nbsp;and&nbsp;so&nbsp;we&nbsp;send&nbsp;a&nbsp;NAck.&nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;At&nbsp;the&nbsp;moment,&nbsp;RabbitMQ&nbsp;will&nbsp;immediately&nbsp;redeliver&nbsp;that&nbsp;message&nbsp;to&nbsp;any&nbsp;of&nbsp;the&nbsp;consumers.&nbsp;If&nbsp;the&nbsp;transient&nbsp;condition&nbsp;is&nbsp;still&nbsp;in&nbsp;place,&nbsp;we&nbsp;can&nbsp;potentially&nbsp;get&nbsp;into&nbsp;a&nbsp;tight&nbsp;loop&nbsp;where&nbsp;we're&nbsp;constantly&nbsp;consuming&nbsp;the&nbsp;same&nbsp;message(s)&nbsp;hundreds&nbsp;of&nbsp;times&nbsp;per&nbsp;second.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;our&nbsp;scenario,&nbsp;we&nbsp;*can*&nbsp;duplicate&nbsp;the&nbsp;message,&nbsp;send&nbsp;it&nbsp;to&nbsp;the&nbsp;exchange/queue,&nbsp;and&nbsp;Ack&nbsp;the&nbsp;original.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Something&nbsp;I&nbsp;thought&nbsp;might&nbsp;be&nbsp;a&nbsp;bit&nbsp;nicer&nbsp;is&nbsp;if&nbsp;we&nbsp;could&nbsp;have&nbsp;an&nbsp;option&nbsp;to&nbsp;have&nbsp;RabbitMQ&nbsp;put&nbsp;the&nbsp;message&nbsp;at&nbsp;the&nbsp;back&nbsp;of&nbsp;the&nbsp;queue.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;queue&nbsp;and&nbsp;our&nbsp;processing&nbsp;rate,&nbsp;this&nbsp;might&nbsp;give&nbsp;us&nbsp;an&nbsp;easier&nbsp;way&nbsp;to&nbsp;try&nbsp;other&nbsp;messages&nbsp;in&nbsp;the&nbsp;queue&nbsp;first.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Another&nbsp;option&nbsp;I&nbsp;was&nbsp;thinking&nbsp;of&nbsp;to&nbsp;enforce&nbsp;more&nbsp;a&nbsp;delay&nbsp;was&nbsp;to&nbsp;see&nbsp;if&nbsp;I&nbsp;could&nbsp;chain&nbsp;together&nbsp;two&nbsp;queues&nbsp;using&nbsp;dead-letter-exchange&nbsp;settings:&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Queue&nbsp;A,&nbsp;no&nbsp;TTL,&nbsp;DLX=Exchange&nbsp;B&nbsp;(with&nbsp;Queue&nbsp;B&nbsp;bound&nbsp;to&nbsp;it).&amp;nbsp;&lt;/div&gt;&lt;div&gt;Queue&nbsp;B,&nbsp;ttl&nbsp;of&nbsp;(x)&nbsp;seconds,&nbsp;DLX=&nbsp;Exchange&nbsp;A&nbsp;(with&nbsp;Queue&nbsp;A&nbsp;bound&nbsp;to&nbsp;it).&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;we&nbsp;NAck&nbsp;the&nbsp;mesage&nbsp;from&nbsp;Queue&nbsp;A,&nbsp;we&nbsp;set&nbsp;requeue=false.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I've&nbsp;not&nbsp;seen&nbsp;much&nbsp;discussion&nbsp;so&nbsp;far&nbsp;on&nbsp;whether&nbsp;it's&nbsp;sane&nbsp;to&nbsp;hook&nbsp;up&nbsp;two&nbsp;queues/exchanges&nbsp;in&nbsp;a&nbsp;loop&nbsp;like&nbsp;this.&amp;nbsp;&lt;/div&gt;&lt;div&gt;Closest&nbsp;I've&nbsp;seen&nbsp;is&nbsp;this:&amp;nbsp;&lt;a&nbsp;href=&quot;http://yuserinterface.com/dev/2013/01/08/how-to-schedule-delay-messages-with-rabbitmq-using-a-dead-letter-exchange/&quot;&gt;http://yuserinterface.com/dev/2013/01/08/how-to-schedule-delay-messages-with-rabbitmq-using-a-dead-letter-exchange/&lt;/a&gt;&amp;nbsp;but&nbsp;that's&nbsp;just&nbsp;using&nbsp;TTL&nbsp;to&nbsp;DLX&nbsp;to&nbsp;delay&nbsp;processing&nbsp;intially,&nbsp;not&nbsp;the&nbsp;whole&nbsp;chain.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Suggestions&nbsp;or&nbsp;comments?&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers&lt;/div&gt;&lt;div&gt;Will&nbsp;Hughes.&amp;nbsp;&lt;br&gt;&lt;/div&gt;
</tt>
