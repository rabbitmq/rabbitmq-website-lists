<tt>
Hello&nbsp;all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;been&nbsp;doing&nbsp;some&nbsp;research&nbsp;over&nbsp;the&nbsp;past&nbsp;weeks&nbsp;unsuccessfully.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Let&nbsp;me&nbsp;explain,&nbsp;now&nbsp;I&nbsp;have&nbsp;an&nbsp;Ubuntu 2.6.32-38-server&nbsp;machine&nbsp;with&nbsp;rabbitmq&nbsp;2.8.1&nbsp;running.&lt;/div&gt;&lt;div&gt;<br>
<br>
As&nbsp;you&nbsp;can&nbsp;see&nbsp;below&nbsp;the&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;just&nbsp;is&nbsp;1024&nbsp;(924&nbsp;at&nbsp;the&nbsp;moment)&nbsp;and&nbsp;the&nbsp;socket&nbsp;limit&nbsp;is&nbsp;829.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;patilla@test:&nbsp;sudo&nbsp;/etc/init.d/rabbitmq-server&nbsp;status&lt;/b&gt;&lt;/div&gt;&lt;div&gt;Status&nbsp;of&nbsp;node&nbsp;rabbit@SmartShaperTest&nbsp;...&lt;/div&gt;<br>
<br>
&lt;div&gt;[{pid,29119},&lt;/div&gt;&lt;div&gt; {running_applications,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; [{rabbitmq_management,&amp;quot;RabbitMQ&nbsp;Management&nbsp;Console&amp;quot;,&amp;quot;2.8.1&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{rabbitmq_management_agent,&amp;quot;RabbitMQ&nbsp;Management&nbsp;Agent&amp;quot;,&amp;quot;2.8.1&amp;quot;},&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;{amqp_client,&amp;quot;RabbitMQ&nbsp;AMQP&nbsp;Client&amp;quot;,&amp;quot;2.8.1&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{rabbit,&amp;quot;RabbitMQ&amp;quot;,&amp;quot;2.8.1&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{os_mon,&amp;quot;CPO&nbsp; CXC&nbsp;138&nbsp;46&amp;quot;,&amp;quot;2.2.4&amp;quot;},&lt;/div&gt;&lt;div&gt;<br>
<br>
 &nbsp; &nbsp; &nbsp;{sasl,&amp;quot;SASL&nbsp; CXC&nbsp;138&nbsp;11&amp;quot;,&amp;quot;2.1.8&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{rabbitmq_mochiweb,&amp;quot;RabbitMQ&nbsp;Mochiweb&nbsp;Embedding&amp;quot;,&amp;quot;2.8.1&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{webmachine,&amp;quot;webmachine&amp;quot;,&amp;quot;1.7.0-rmq2.8.1-hg&amp;quot;},&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;{mochiweb,&amp;quot;MochiMedia&nbsp;Web&nbsp;Server&amp;quot;,&amp;quot;1.3-rmq2.8.1-git&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{inets,&amp;quot;INETS&nbsp; CXC&nbsp;138&nbsp;49&amp;quot;,&amp;quot;5.2&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{mnesia,&amp;quot;MNESIA&nbsp; CXC&nbsp;138&nbsp;12&amp;quot;,&amp;quot;4.4.12&amp;quot;},&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;{stdlib,&amp;quot;ERTS&nbsp; CXC&nbsp;138&nbsp;10&amp;quot;,&amp;quot;1.16.4&amp;quot;},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{kernel,&amp;quot;ERTS&nbsp; CXC&nbsp;138&nbsp;10&amp;quot;,&amp;quot;2.13.4&amp;quot;}]},&lt;/div&gt;&lt;div&gt; {os,{unix,linux}},&lt;/div&gt;&lt;div&gt; {erlang_version,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &amp;quot;Erlang&nbsp;R13B03&nbsp;(erts-5.7.4)&nbsp;[source]&nbsp;[64-bit]&nbsp;[smp:4:4]&nbsp;[rq:4]&nbsp;[async-threa&nbsp; &nbsp; &nbsp; ds:30]&nbsp;[hipe]&nbsp;[kernel-poll:true]\n&amp;quot;},&lt;/div&gt;<br>
<br>
&lt;div&gt; {memory,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; [{total,54392152},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{processes,32356128},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{processes_used,24209504},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{system,22036024},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{atom,1330113},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{atom_used,1302718},&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp;{binary,223152},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{code,15383701},&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp;{ets,2900344}]},&lt;/div&gt;&lt;div&gt; {vm_memory_high_watermark,0.4},&lt;/div&gt;&lt;div&gt; {vm_memory_limit,842620928},&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&nbsp;face=&quot;&amp;#39;arial&nbsp;black&amp;#39;,&nbsp;sans-serif&quot;&gt; {file_descriptors,&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&nbsp;face=&quot;&amp;#39;arial&nbsp;black&amp;#39;,&nbsp;sans-serif&quot;&gt; &nbsp; &nbsp; [{total_limit,924},{total_used,3},{sockets_limit,829},{sockets_used,1}]},&lt;/font&gt;&lt;/div&gt;&lt;div&gt; {processes,[{limit,1048576},{used,178}]},&lt;/div&gt;&lt;div&gt; {run_queue,0},&lt;/div&gt;<br>
<br>
&lt;div&gt; {uptime,2352}]&lt;/div&gt;&lt;div&gt;...done.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Well,&nbsp;I&nbsp;also&nbsp;had&nbsp;rabbitmq&nbsp;running&nbsp;before&nbsp;in&nbsp;another&nbsp;machine&nbsp;(OLD&nbsp;machine&nbsp;from&nbsp;now&nbsp;on),&nbsp;same&nbsp;files,&nbsp;same&nbsp;code,&nbsp;the&nbsp;only&nbsp;difference&nbsp;was&nbsp;rabbit&amp;#39;s&nbsp;version,&nbsp;2.7.1&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;the&nbsp;OLD&nbsp;machine&nbsp;I&nbsp;managed&nbsp;to&nbsp;increase&nbsp;these&nbsp;limits&nbsp;(file&nbsp;and&nbsp;socket)&nbsp;by&nbsp;editting&nbsp;the&nbsp;/etc/security/limits.conf&nbsp;file&nbsp;as&nbsp;shown:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;rabbitmq&nbsp; soft&nbsp; nofile&nbsp;10011&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;b&gt;rabbitmq&nbsp; hard&nbsp; nofile&nbsp;65000&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;adding&nbsp;the&nbsp;following&nbsp;line&nbsp;to &lt;b&gt;/etc/pam.d/common-session{,-noninteractive}&lt;/b&gt; &lt;/div&gt;&lt;div&gt;&lt;b&gt;session&nbsp;required&nbsp;pam_limits.so&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;worked&nbsp;fine,&nbsp;and&nbsp;on&nbsp;the&nbsp;rabbit&nbsp;management&nbsp;plugin&nbsp;I&nbsp;could&nbsp;see&nbsp;these&nbsp;changes:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;img&nbsp;src=&quot;cid:ii_136c0c35e1ad9f2d&quot;&nbsp;alt=&quot;Imágenes&nbsp;integradas&nbsp;1&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;When&nbsp;I&nbsp;tried&nbsp;to&nbsp;do&nbsp;the&nbsp;same&nbsp;on&nbsp;the&nbsp;NEW&nbsp;machine&nbsp;it&nbsp;seems&nbsp;like&nbsp;it&nbsp;is&nbsp;not&nbsp;working&nbsp;fine.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;I&nbsp;execute&nbsp;&lt;b&gt;ulimit&nbsp;-n&lt;/b&gt;&nbsp;with&nbsp;rabbitmq&nbsp;user&nbsp;I&nbsp;get&nbsp;the&nbsp;same&nbsp;value&nbsp;as&lt;b&gt;&nbsp;limits.conf&lt;/b&gt;,&nbsp;but&nbsp;in&nbsp;the&nbsp;management&nbsp;site......&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;rabbit@test:&nbsp;ulimit&nbsp;-n &lt;/b&gt;&lt;/div&gt;&lt;div&gt;10011&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;img&nbsp;src=&quot;cid:ii_136c0c5b5a6da59b&quot;&nbsp;alt=&quot;Imágenes&nbsp;integradas&nbsp;2&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;thoughts?&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;can&amp;#39;t&nbsp;find&nbsp;the&nbsp;error.....&nbsp;Could&nbsp;it&nbsp;be&nbsp;the&nbsp;version?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;response&nbsp;in&nbsp;advance.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;patilla.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
