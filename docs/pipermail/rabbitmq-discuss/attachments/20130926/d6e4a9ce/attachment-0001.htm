<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Simon,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;pages&nbsp;says&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(85,85,85);font-family:Verdana,sans-serif;font-size:13px;line-height:18px&quot;&gt;It&nbsp;is&nbsp;possible&nbsp;to&nbsp;set &lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51);font-family:&amp;#39;Courier&nbsp;New&amp;#39;,Courier,monospace;font-size:13px;white-space:nowrap;line-height:18px&quot;&gt;vm_memory_high_watermark_paging_ratio&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(85,85,85);font-family:Verdana,sans-serif;font-size:13px;line-height:18px&quot;&gt; to&nbsp;a&nbsp;greater&nbsp;value&nbsp;than &lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(51,51,51);font-family:&amp;#39;Courier&nbsp;New&amp;#39;,Courier,monospace;font-size:13px;white-space:nowrap;line-height:18px&quot;&gt;1.0&lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(85,85,85);font-family:Verdana,sans-serif;font-size:13px;line-height:18px&quot;&gt;.&nbsp;In&nbsp;this&nbsp;case&nbsp;queues&nbsp;will&nbsp;not&nbsp;page&nbsp;their&nbsp;contents&nbsp;to&nbsp;disc.&lt;/span&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;would&nbsp;happen&nbsp;then?&nbsp;Will&nbsp;RabbitMQ&nbsp;stop&nbsp;receiving&nbsp;messages?&nbsp;Drop&nbsp;messages?&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Alvaro&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Thu,&nbsp;Sep&nbsp;26,&nbsp;2013&nbsp;at&nbsp;3:39&nbsp;AM,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;26/09/2013&nbsp;4:37AM,&nbsp;Peter&nbsp;Wright&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
i&nbsp;was&nbsp;hoping&nbsp;someone&nbsp;could&nbsp;help&nbsp;explain&nbsp;to&nbsp;me&nbsp;under&nbsp;what&nbsp;circumstances&lt;br&gt;<br>
messages&nbsp;are&nbsp;written&nbsp;to&nbsp;the&nbsp;msg_store_transient&nbsp;directory.&nbsp; i&nbsp;have&nbsp;been&lt;br&gt;<br>
witnessing&nbsp;this&nbsp;directory&nbsp;grow&nbsp;to&nbsp;10&amp;#39;s&nbsp;of&nbsp;GB&nbsp;-&nbsp;infact&nbsp;it&nbsp;spun&nbsp;out&nbsp;of&lt;br&gt;<br>
control&nbsp;at&nbsp;one&nbsp;point&nbsp;consuming&nbsp;almost&nbsp;100G&nbsp;of&nbsp;space.&nbsp; i&nbsp;do&nbsp;have&nbsp;a&nbsp;queue&lt;br&gt;<br>
with&nbsp;quite&nbsp;a&nbsp;few&nbsp;messages&nbsp;ready&nbsp;for&nbsp;consumption,&nbsp;yet&nbsp;when&nbsp;i&nbsp;monitor&lt;br&gt;<br>
memory&nbsp;utilization&nbsp;for&nbsp;this&nbsp;queue&nbsp;it&nbsp;rarely&nbsp;spikes&nbsp;above&nbsp;20MB.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
The&nbsp;memory&nbsp;use&nbsp;reported&nbsp;by&nbsp;the&nbsp;queue&nbsp;does&nbsp;not&nbsp;include&nbsp;message&nbsp;bodies&nbsp;(since&nbsp;these&nbsp;are&nbsp;shared&nbsp;across&nbsp;queues).&nbsp;Also&nbsp;it&nbsp;does&nbsp;not&nbsp;include&nbsp;anything&nbsp;that&amp;#39;s&nbsp;been&nbsp;paged&nbsp;out,&nbsp;so&nbsp;if&nbsp;messages&nbsp;are&nbsp;paging&nbsp;out&nbsp;it&nbsp;can&nbsp;be&nbsp;quite&nbsp;low&nbsp;anyway.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
The&nbsp;decision&nbsp;as&nbsp;to&nbsp;whether&nbsp;to&nbsp;page&nbsp;messages&nbsp;is&nbsp;made&nbsp;globally&nbsp;based&nbsp;on&nbsp;how&nbsp;much&nbsp;memory&nbsp;is&nbsp;in&nbsp;use.&nbsp;All&nbsp;released&nbsp;versions&nbsp;of&nbsp;RabbitMQ&nbsp;(since&nbsp;2.0.0&nbsp;when&nbsp;the&nbsp;persister&nbsp;was&nbsp;rewritten)&nbsp;will&nbsp;start&nbsp;to&nbsp;page&nbsp;out&nbsp;when&nbsp;20%&nbsp;of&nbsp;the&nbsp;way&nbsp;to&nbsp;the&nbsp;high&nbsp;watermark.&nbsp;By&nbsp;default&nbsp;the&nbsp;high&nbsp;watermark&nbsp;is&nbsp;at&nbsp;40%&nbsp;of&nbsp;physical&nbsp;memory,&nbsp;so&nbsp;paging&nbsp;will&nbsp;start&nbsp;at&nbsp;8%&nbsp;memory&nbsp;used.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
That&amp;#39;s&nbsp;probably&nbsp;too&nbsp;cautious,&nbsp;so&nbsp;the&nbsp;next&nbsp;release&nbsp;(3.2.x)&nbsp;will&nbsp;raise&nbsp;the&nbsp;paging&nbsp;ratio&nbsp;from&nbsp;20%&nbsp;to&nbsp;50%&nbsp;(so&nbsp;paging&nbsp;will&nbsp;start&nbsp;at&nbsp;20%&nbsp;memory&nbsp;used&nbsp;by&nbsp;default)&nbsp;and&nbsp;also&nbsp;make&nbsp;it&nbsp;configurable.&nbsp;See&nbsp;&lt;a&nbsp;href=&quot;http://next.rabbitmq.com/memory.html#memsup-paging&quot;&nbsp;target=&quot;_blank&quot;&gt;http://next.rabbitmq.com/&lt;u&gt;&lt;/u&gt;memory.html#memsup-paging&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Having&nbsp;said&nbsp;that,&nbsp;if&nbsp;msg_store_transient&nbsp;grows&nbsp;to&nbsp;100GB&nbsp;of&nbsp;space,&nbsp;I&nbsp;suspect&nbsp;you&nbsp;probably&nbsp;have&nbsp;100GB&nbsp;of&nbsp;messages.&nbsp;If&nbsp;you&nbsp;don&amp;#39;t&nbsp;have&nbsp;100GB&nbsp;of&nbsp;RAM,&nbsp;you&amp;#39;re&nbsp;going&nbsp;to&nbsp;page&nbsp;out...&lt;br&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;this&nbsp;helps.&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
______________________________&lt;u&gt;&lt;/u&gt;_________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.&lt;u&gt;&lt;/u&gt;rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/&lt;u&gt;&lt;/u&gt;cgi-bin/mailman/listinfo/&lt;u&gt;&lt;/u&gt;rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
