<tt>
Hi&nbsp;Alex,&nbsp;thanks&nbsp;for&nbsp;your&nbsp;email.&nbsp;That&nbsp;helped&nbsp;a&nbsp;lot. &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;answer&nbsp;your&nbsp;question&nbsp;about&nbsp;the&nbsp;hang&nbsp;in&nbsp;the&nbsp;&amp;quot;starting&nbsp;exchange,&nbsp;queue&nbsp;and&nbsp;binding&nbsp;recovery..&amp;quot;&nbsp;step&nbsp;on&nbsp;creating&nbsp;100,000&nbsp;durable&nbsp;queues&nbsp;and&nbsp;restarting&nbsp;the&nbsp;broker, &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Is&nbsp;it&nbsp;really&nbsp;hung?&nbsp; Is&nbsp;it&nbsp;using&nbsp;the&nbsp;CPU&nbsp;or&nbsp;disk&nbsp;at&nbsp;all&nbsp;at&nbsp;this&nbsp;time?&nbsp; Is&lt;br&gt;there&nbsp;anything&nbsp;in&nbsp;the&nbsp;logs&nbsp;(both&nbsp;the&nbsp;rabbit&nbsp;and&nbsp;SASL&nbsp;logs)?&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;SASL&nbsp;log&nbsp;doesn&amp;#39;t&nbsp;have&nbsp;anything.&nbsp;But&nbsp;the&nbsp;rabbit&nbsp;log&nbsp;has&nbsp;something. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;attached&nbsp;the&nbsp;.log&nbsp;file&nbsp;for&nbsp;your&nbsp;reference. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;says&nbsp;that&nbsp;it&nbsp;is&nbsp;rebuilding&nbsp;the&nbsp;index&nbsp;from&nbsp;scratch..and&nbsp;that&nbsp;mnesia&nbsp;is&nbsp;overloaded&nbsp;with&nbsp; write_threshold&nbsp;and&nbsp;then&nbsp;time_threshold.&lt;/div&gt;<br>
&lt;div&gt;I&amp;#39;m&nbsp;not&nbsp;very&nbsp;sure&nbsp;I&nbsp;understand&nbsp;what&nbsp;they&nbsp;really&nbsp;mean.&nbsp;:(&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;/etc/rabbitmq/rabbitmq.config&nbsp;file&nbsp;entry&nbsp;is&nbsp;as&nbsp;follows:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;[&nbsp;{mnesia,&nbsp;[{dump_log_write_threshold,&nbsp;50000},&nbsp;{dc_dump_limit,&nbsp;40}]},&lt;/div&gt;<br>
&lt;div&gt;{rabbit,&nbsp;[{vm_memory_high_watermark,&nbsp;0.34}]}].&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;you&nbsp;please&nbsp;tell&nbsp;me&nbsp;if&nbsp;these&nbsp;configs&nbsp;are&nbsp;ok,&nbsp;or&nbsp;am&nbsp;I&nbsp;missing&nbsp;something?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Also,&nbsp;I&nbsp;checked&nbsp;the&nbsp;IO&nbsp;and&nbsp;CPU...when&nbsp;I&nbsp;just&nbsp;start&nbsp;the&nbsp;broker&nbsp;after&nbsp;the&nbsp;100,000&nbsp;queues&nbsp;creation&lt;/div&gt;<br>
&lt;div&gt;both&nbsp;IO&nbsp;and&nbsp;CPU&nbsp;shoots&nbsp;up&nbsp;for&nbsp;the&nbsp;first&nbsp;minute,&nbsp;but&nbsp;then&nbsp;when&nbsp;everything&nbsp;required&nbsp;is&nbsp;fetched&nbsp;to &lt;/div&gt;&lt;div&gt;memory&nbsp;there&nbsp;is&nbsp;no&nbsp;activity&nbsp;in&nbsp;IO.&nbsp;But&nbsp;CPU&nbsp;consistently&nbsp;stays&nbsp;up.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;From&nbsp;top&nbsp; the&nbsp;values&nbsp;are&nbsp;like&nbsp;below&nbsp;~&nbsp;and&nbsp;the&nbsp;CPU&nbsp;almost&nbsp;always&nbsp;stays&nbsp;up&nbsp;and&nbsp;it&nbsp;never&nbsp;goes&nbsp;down.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;PID&nbsp;USER&nbsp; &nbsp; &nbsp; PR&nbsp; NI&nbsp; VIRT&nbsp; RES&nbsp; SHR&nbsp;S&nbsp;%CPU&nbsp;%MEM&nbsp; &nbsp; TIME+&nbsp; COMMAND&nbsp;  &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;13997&nbsp;root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp;3184m&nbsp;2.5g&nbsp; &nbsp;2324&nbsp;S&nbsp; 210&nbsp; &nbsp; &nbsp; 21.2&nbsp; &nbsp; &nbsp; &nbsp;8:17.97&nbsp; &nbsp; &nbsp; beam.smp&nbsp; &nbsp;  &lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;Feel&nbsp;free&nbsp;to&nbsp;let&nbsp;me&nbsp;know&nbsp;if&nbsp;you&nbsp;need&nbsp;more&nbsp;info.&nbsp;I&nbsp;can&nbsp;provide&nbsp;you&nbsp;with&nbsp;memory&nbsp;dumps&nbsp;and&nbsp;stack&nbsp;traces&nbsp;if&nbsp;required.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;a&nbsp;lot&nbsp;for&nbsp;your&nbsp;help.&lt;/div&gt;&lt;div&gt;Praveen&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Sep&nbsp;9,&nbsp;2011&nbsp;at&nbsp;3:12&nbsp;AM,&nbsp;Alexandru&nbsp;Scvorţov&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:alexandru@rabbitmq.com&quot;&gt;alexandru@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hi&nbsp;Praveen,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;However&nbsp;I&nbsp;realized&nbsp;when&nbsp;i&nbsp;wanted&nbsp;to&nbsp;shutdown&nbsp;the&nbsp;broker&nbsp;before&nbsp;starting&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;new&nbsp;test,&nbsp;the&nbsp;stop&nbsp;command&nbsp;(rabbitmqctl&nbsp;stop)&nbsp;took&nbsp;a&nbsp;long&nbsp;time&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;complete.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;We&nbsp;are&nbsp;aware&nbsp;of&nbsp;this&nbsp;problem.&nbsp; The&nbsp;fix&nbsp;is&nbsp;currently&nbsp;going&nbsp;through&nbsp;QA&nbsp;and&lt;br&gt;<br>
will&nbsp;probably&nbsp;be&nbsp;in&nbsp;the&nbsp;next&nbsp;release,&nbsp;which&nbsp;should&nbsp;be&nbsp;around&nbsp;fairly&lt;br&gt;<br>
soon.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Query&nbsp;1)&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;am&nbsp;curious&nbsp;as&nbsp;to&nbsp;what&nbsp;causes&nbsp;the&nbsp;latency&nbsp;to&nbsp;stop&nbsp;the&nbsp;broker&nbsp;when&nbsp;issued&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmqctl&nbsp;stop&nbsp;command.&nbsp;It&nbsp;seems&nbsp;to&nbsp;be&nbsp;something&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;number&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;queues&nbsp;created&nbsp;as&nbsp;the&nbsp;stop&nbsp;time&nbsp;increase&nbsp;proportionally&nbsp;as&nbsp;the&nbsp;number&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;queues&nbsp;increases.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Internally,&nbsp;when&nbsp;we&nbsp;terminate&nbsp;a&nbsp;queue,&nbsp;we&nbsp;do&nbsp;a&nbsp;few&nbsp;file&nbsp;operations.&nbsp; This&lt;br&gt;<br>
is&nbsp;usually&nbsp;not&nbsp;a&nbsp;problem,&nbsp;but&nbsp;when&nbsp;you&nbsp;close&nbsp;a&nbsp;connection&nbsp;with&nbsp;100&nbsp;000s&lt;br&gt;<br>
of&nbsp;queues,&nbsp;the&nbsp;same&nbsp;order&nbsp;of&nbsp;file&nbsp;operations&nbsp;get&nbsp;scheduled.&nbsp; Erlang&amp;#39;s&lt;br&gt;<br>
IO&nbsp;system&nbsp;then&nbsp;does&nbsp;some&nbsp;expensive&nbsp;operations&nbsp;of&nbsp;this&nbsp;long&nbsp;queue&nbsp;and&lt;br&gt;<br>
it&nbsp;ends&nbsp;up&nbsp;processing&nbsp;the&nbsp;operations&nbsp;in&nbsp;quadratic&nbsp;time.&nbsp; The&nbsp;fix&nbsp;going&lt;br&gt;<br>
through&nbsp;QA&nbsp;brings&nbsp;this&nbsp;down&nbsp;to&nbsp;linear&nbsp;time;&nbsp;for&nbsp;instance,&nbsp;I&nbsp;can&nbsp;delete&lt;br&gt;<br>
40k&nbsp;queues&nbsp;in&nbsp;20s&nbsp;(compared&nbsp;to&nbsp;211s&nbsp;on&nbsp;the&nbsp;latest&nbsp;release).&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Query&nbsp;2)&lt;br&gt;<br>
&amp;gt;&nbsp;In&nbsp;the&nbsp;case&nbsp;of&nbsp;durable&nbsp;queues,&nbsp;I&nbsp;measured&nbsp;the&nbsp;time&nbsp;taken&nbsp;to&nbsp;restart&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;broker&nbsp;after&nbsp;stopping&nbsp;it&nbsp;(a&nbsp;clean&nbsp;and&nbsp;unclean&nbsp;stop).&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;found&nbsp;that&nbsp;even&nbsp;after&nbsp;a&nbsp;clean/unclean&nbsp;stop&nbsp;the&nbsp;time&nbsp;to&nbsp;restart&nbsp;the&nbsp;broker&lt;br&gt;<br>
&amp;gt;&nbsp;was&nbsp;just&nbsp;about&nbsp;20&nbsp;seconds&nbsp;on&nbsp;an&nbsp;average.&lt;br&gt;<br>
&amp;gt;&nbsp;However,&nbsp;in&nbsp;the&nbsp;case&nbsp;where&nbsp;i&nbsp;created&nbsp;50000&nbsp;durable&nbsp;queues&nbsp;and&nbsp;did&nbsp;an&nbsp;unclean&lt;br&gt;<br>
&amp;gt;&nbsp;stop(just&nbsp;aborted&nbsp;the&nbsp;broker)&nbsp;and&nbsp;tried&nbsp;to&nbsp;restart&nbsp;the&nbsp;broker&nbsp;it&nbsp;didn&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;start&nbsp;for&nbsp;over&nbsp;to&nbsp;6&nbsp;minutes&nbsp;(when&nbsp;I&nbsp;gave&nbsp;up)...&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;was&nbsp;hung&nbsp;in&nbsp;the&nbsp;step&nbsp;of&nbsp;&amp;quot;starting&nbsp;exchange,queue&nbsp;and&nbsp;binding&nbsp;recovery..&amp;quot;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;will&nbsp;be&nbsp;great&nbsp;if&nbsp;someone&nbsp;could&nbsp;explain&nbsp;why&nbsp;this&nbsp;could&nbsp;be&nbsp;caused.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;can&amp;#39;t&nbsp;reproduce&nbsp;this.&nbsp; Declaring&nbsp;100&nbsp;000&nbsp;durable&nbsp;queues,&nbsp;killing&nbsp;the&nbsp;broker&lt;br&gt;<br>
and&nbsp;re-starting&nbsp;it&nbsp;seems&nbsp;to&nbsp;work&nbsp;fine.&nbsp; It&nbsp;takes&nbsp;about&nbsp;1&nbsp;min&nbsp;on&nbsp;my&lt;br&gt;<br>
machine.&lt;br&gt;<br>
&lt;br&gt;<br>
Is&nbsp;it&nbsp;really&nbsp;hung?&nbsp; Is&nbsp;it&nbsp;using&nbsp;the&nbsp;CPU&nbsp;or&nbsp;disk&nbsp;at&nbsp;all&nbsp;at&nbsp;this&nbsp;time?&nbsp; Is&lt;br&gt;<br>
there&nbsp;anything&nbsp;in&nbsp;the&nbsp;logs&nbsp;(both&nbsp;the&nbsp;rabbit&nbsp;and&nbsp;SASL&nbsp;logs)?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;will&nbsp;be&nbsp;great&nbsp;if&nbsp;someone&nbsp;could&nbsp;answer&nbsp;the&nbsp;above&nbsp;queries&nbsp;or&nbsp;provide&nbsp;me&lt;br&gt;<br>
&amp;gt;&nbsp;with&nbsp;some&nbsp;pointers&nbsp;about&nbsp;the&nbsp;same.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;There&amp;#39;s&nbsp;not&nbsp;much&nbsp;you&nbsp;can&nbsp;do&nbsp;at&nbsp;the&nbsp;moment&nbsp;except&nbsp;avoiding&nbsp;terminating&nbsp;a&lt;br&gt;<br>
large&nbsp;number&nbsp;of&nbsp;queues&nbsp;at&nbsp;the&nbsp;same&nbsp;time.&lt;br&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;this&nbsp;clears&nbsp;things&nbsp;up.&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
Alex&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
On&nbsp;Thu,&nbsp;Sep&nbsp;08,&nbsp;2011&nbsp;at&nbsp;07:38:14PM&nbsp;-0700,&nbsp;Praveen&nbsp;M&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hi,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;a&nbsp;rabbitmq&nbsp;newbie&nbsp;and&nbsp;am&nbsp;trying&nbsp;to&nbsp;run&nbsp;some&nbsp;experiments&nbsp;to&nbsp;figure&nbsp;out&nbsp;if&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmq&nbsp;would&nbsp;serve&nbsp;my&nbsp;use&nbsp;case.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;create&nbsp;queues&nbsp;in&nbsp;the&nbsp;order&nbsp;of&nbsp;100,000s.&nbsp;(one&nbsp;for&nbsp;each&nbsp;of&nbsp;my&lt;br&gt;<br>
&amp;gt;&nbsp;customers).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;ran&nbsp;various&nbsp;tests,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;using&nbsp;the&nbsp;latest&nbsp;2.6.0&nbsp;server&nbsp;and&nbsp;2.6.0&nbsp;client,&nbsp;and&nbsp;the&nbsp;following&nbsp;tests&lt;br&gt;<br>
&amp;gt;&nbsp;in&nbsp;durable&nbsp;queues&nbsp;mode&nbsp;and&nbsp;in&nbsp;non-durable&nbsp;queues&nbsp;mode.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Tests,&lt;br&gt;<br>
&amp;gt;&nbsp;1)&nbsp;to&nbsp;create&nbsp;1000&nbsp;queues&nbsp;,&nbsp;produce,&nbsp;consume&lt;br&gt;<br>
&amp;gt;&nbsp;2)&nbsp;to&nbsp;create&nbsp;10000&nbsp;queues&nbsp;,&nbsp;produce,&nbsp;consume&lt;br&gt;<br>
&amp;gt;&nbsp;3)&nbsp;to&nbsp;create&nbsp;50000&nbsp;queues,&nbsp;produce&nbsp;and&nbsp;consume.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;works&nbsp;like&nbsp;a&nbsp;charm&nbsp;and&nbsp;the&nbsp;memory&nbsp;usage&nbsp;even&nbsp;with&nbsp;50,000&nbsp;queues&nbsp;seem&nbsp;very&lt;br&gt;<br>
&amp;gt;&nbsp;reasonable.&nbsp;(the&nbsp;order&nbsp;of&nbsp;1-1.7G)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;However&nbsp;I&nbsp;realized&nbsp;when&nbsp;i&nbsp;wanted&nbsp;to&nbsp;shutdown&nbsp;the&nbsp;broker&nbsp;before&nbsp;starting&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;new&nbsp;test,&nbsp;the&nbsp;stop&nbsp;command&nbsp;(rabbitmqctl&nbsp;stop)&nbsp;took&nbsp;a&nbsp;long&nbsp;time&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;complete.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;made&nbsp;a&nbsp;small&nbsp;chart&nbsp;of&nbsp;how&nbsp;long&nbsp;the&nbsp;stop&nbsp;command&nbsp;on&nbsp;the&nbsp;broker&nbsp;takes&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;execute&nbsp;after&nbsp;the&nbsp;test&nbsp;creates&nbsp;&amp;#39;N&amp;#39;&nbsp;queues&nbsp;listed&nbsp;below.&lt;br&gt;<br>
&amp;gt;&nbsp;Also,&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;durable&nbsp;queues,&nbsp;i&nbsp;found&nbsp;some&nbsp;weird&nbsp;numbers&nbsp;for&nbsp;the&nbsp;time&lt;br&gt;<br>
&amp;gt;&nbsp;taken&nbsp;to&nbsp;restart&nbsp;the&nbsp;queues&nbsp;after&nbsp;a&nbsp;clean/unclean(aborting&nbsp;broker)&nbsp;stop&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;*NON_DURABLE_QUEUES&nbsp;TEST*&lt;br&gt;<br>
&amp;gt;&nbsp;*No&nbsp;of&nbsp;Queues&nbsp;Stop&nbsp;Time*&lt;br&gt;<br>
&amp;gt;&nbsp;1000&nbsp;10.7&nbsp;seconds&lt;br&gt;<br>
&amp;gt;&nbsp;10000&nbsp;2&nbsp;minutes&lt;br&gt;<br>
&amp;gt;&nbsp;50000&nbsp;11&nbsp;minutes&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;*&lt;br&gt;<br>
&amp;gt;&nbsp;*&lt;br&gt;<br>
&amp;gt;&nbsp;*DURABLE_QUEUES&nbsp;TEST&lt;br&gt;<br>
&amp;gt;&nbsp;*No&nbsp;of&nbsp;Queues&nbsp;Start&nbsp;Time&nbsp;Stop&nbsp;Time*&lt;br&gt;<br>
&amp;gt;&nbsp;1000&nbsp;2&nbsp;seconds&nbsp;10&nbsp;seconds&lt;br&gt;<br>
&amp;gt;&nbsp;10000&nbsp;24&nbsp;seconds&nbsp;2&nbsp;minutes&lt;br&gt;<br>
&amp;gt;&nbsp;10000&nbsp;after&nbsp;crash&nbsp;it&nbsp;recovers&nbsp;in&nbsp;20&nbsp;seconds&nbsp;(on&nbsp;improper&nbsp;shutdown).&lt;br&gt;<br>
&amp;gt;&nbsp;50000&nbsp;even&nbsp;at&nbsp;6&nbsp;minutes&nbsp;the&nbsp;queues&nbsp;doesn&amp;#39;t&nbsp;start&nbsp;on&nbsp;a&nbsp;improper&nbsp;shutdown&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Query&nbsp;1)&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;am&nbsp;curious&nbsp;as&nbsp;to&nbsp;what&nbsp;causes&nbsp;the&nbsp;latency&nbsp;to&nbsp;stop&nbsp;the&nbsp;broker&nbsp;when&nbsp;issued&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmqctl&nbsp;stop&nbsp;command.&nbsp;It&nbsp;seems&nbsp;to&nbsp;be&nbsp;something&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;number&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;queues&nbsp;created&nbsp;as&nbsp;the&nbsp;stop&nbsp;time&nbsp;increase&nbsp;proportionally&nbsp;as&nbsp;the&nbsp;number&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;queues&nbsp;increases.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Query&nbsp;2)&lt;br&gt;<br>
&amp;gt;&nbsp;In&nbsp;the&nbsp;case&nbsp;of&nbsp;durable&nbsp;queues,&nbsp;I&nbsp;measured&nbsp;the&nbsp;time&nbsp;taken&nbsp;to&nbsp;restart&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;broker&nbsp;after&nbsp;stopping&nbsp;it&nbsp;(a&nbsp;clean&nbsp;and&nbsp;unclean&nbsp;stop).&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;found&nbsp;that&nbsp;even&nbsp;after&nbsp;a&nbsp;clean/unclean&nbsp;stop&nbsp;the&nbsp;time&nbsp;to&nbsp;restart&nbsp;the&nbsp;broker&lt;br&gt;<br>
&amp;gt;&nbsp;was&nbsp;just&nbsp;about&nbsp;20&nbsp;seconds&nbsp;on&nbsp;an&nbsp;average.&lt;br&gt;<br>
&amp;gt;&nbsp;However,&nbsp;in&nbsp;the&nbsp;case&nbsp;where&nbsp;i&nbsp;created&nbsp;50000&nbsp;durable&nbsp;queues&nbsp;and&nbsp;did&nbsp;an&nbsp;unclean&lt;br&gt;<br>
&amp;gt;&nbsp;stop(just&nbsp;aborted&nbsp;the&nbsp;broker)&nbsp;and&nbsp;tried&nbsp;to&nbsp;restart&nbsp;the&nbsp;broker&nbsp;it&nbsp;didn&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;start&nbsp;for&nbsp;over&nbsp;to&nbsp;6&nbsp;minutes&nbsp;(when&nbsp;I&nbsp;gave&nbsp;up)...&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;was&nbsp;hung&nbsp;in&nbsp;the&nbsp;step&nbsp;of&nbsp;&amp;quot;starting&nbsp;exchange,queue&nbsp;and&nbsp;binding&nbsp;recovery..&amp;quot;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;will&nbsp;be&nbsp;great&nbsp;if&nbsp;someone&nbsp;could&nbsp;explain&nbsp;why&nbsp;this&nbsp;could&nbsp;be&nbsp;caused.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;will&nbsp;be&nbsp;great&nbsp;if&nbsp;someone&nbsp;could&nbsp;answer&nbsp;the&nbsp;above&nbsp;queries&nbsp;or&nbsp;provide&nbsp;me&lt;br&gt;<br>
&amp;gt;&nbsp;with&nbsp;some&nbsp;pointers&nbsp;about&nbsp;the&nbsp;same.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;help,&lt;br&gt;<br>
&amp;gt;&nbsp;--&lt;br&gt;<br>
&amp;gt;&nbsp;-Praveen&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;-Praveen&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
