<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;I&#39;m&nbsp;using&nbsp;Rabbitmq&nbsp;3.3.3&nbsp;on&nbsp;Windows&nbsp;7.&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;I&nbsp;installed&nbsp;&lt;b&gt;rabbitmq-priority-queue&nbsp;plugin&lt;/b&gt;,&nbsp;enable&nbsp;it,&nbsp;and&nbsp;finally&nbsp;restart&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;Rabbitmq&nbsp;server. &lt;/span&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;When&nbsp;I&nbsp;list&nbsp;rabbitmq&nbsp;plugins&nbsp;I&nbsp;see&nbsp;=&gt;&nbsp;[E]&nbsp;rabbitmq_priority_queue.&lt;/span&gt;&lt;br&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;I&nbsp;tried&nbsp;the&nbsp;example&nbsp;from&nbsp;GitHub&nbsp;and&nbsp;it&nbsp;WORKS.&nbsp;Though,&nbsp;it&nbsp;is&nbsp;a&nbsp;very&nbsp;very&nbsp;simple&nbsp;example.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;But,&nbsp; &nbsp; when&nbsp;I&nbsp;tried&nbsp;some&nbsp;a&nbsp;little&nbsp;bit&nbsp;complex&nbsp;example,&nbsp;the&nbsp;queue&nbsp;seems&nbsp;to&nbsp;behave&nbsp;in&nbsp;a&nbsp;very&nbsp;strange&nbsp;way.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;So,&nbsp;my&nbsp;setup&nbsp;is&nbsp;like&nbsp;this:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;<br>
&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;First,&nbsp;the&nbsp;common&nbsp;configuration&nbsp;of&nbsp;the&nbsp;queue,&nbsp;just&nbsp;like&nbsp;in&nbsp;the&nbsp;example:&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;pre&nbsp;style=&quot;overflow:auto;font-family:Consolas,&#39;Liberation&nbsp;Mono&#39;,Menlo,Courier,monospace;font-size:12px;margin-top:0px;margin-bottom:0px;color:rgb(51,51,51);line-height:18px&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC17&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;private&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;static&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;final&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;String&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;QUEUE&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;my-priority-queue&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC18&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC19&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;    &lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;public&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;static&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(68,85,136);font-weight:bold&quot;&gt;void&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;main&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;String&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;[]&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;argv&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;)&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;throws&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Exception&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;{&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC20&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;ConnectionFactory&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;factory&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;new&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(153,0,0);font-weight:bold&quot;&gt;ConnectionFactory&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;();&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC21&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;Connection&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;conn&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;factory&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;newConnection&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;();&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC22&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;Channel&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;ch&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;conn&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;createChannel&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;();&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC23&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC24&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;Map&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;String&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Object&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;&gt;&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;args&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;new&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;HashMap&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;String&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;Object&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;&gt;();&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC25&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;args&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;put&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;x-max-priority&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,153,153)&quot;&gt;10&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;);&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC26&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;ch&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;queueDeclare&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;QUEUE&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;true&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;false&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;false&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;args&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;);&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC26&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;...&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;I&nbsp;have&nbsp;a&nbsp;Producer&nbsp;thread&nbsp;that&nbsp;sends&nbsp;messages&nbsp;in&nbsp;intervals&nbsp;of&nbsp;couple&nbsp;of&nbsp;seconds.&nbsp;For&nbsp;each&nbsp;message&nbsp;I&nbsp;define&nbsp;priority&nbsp;from&nbsp;0&nbsp;to&nbsp;10&nbsp;just&nbsp;like&nbsp;in&nbsp;the&nbsp;example.&nbsp;For&nbsp;example&nbsp;sends&nbsp;10&nbsp;messages&nbsp;each&nbsp;2&nbsp;seconds:&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;the&nbsp;run()&nbsp;method&nbsp;looks&nbsp;like&nbsp;this:&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;while(true){&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt; &nbsp; for(Message&nbsp;message&nbsp;:&nbsp;MESSAGES){&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;pre&nbsp;style=&quot;overflow:auto;font-family:Consolas,&#39;Liberation&nbsp;Mono&#39;,Menlo,Courier,monospace;font-size:12px;margin-top:0px;margin-bottom:0px;color:rgb(51,51,51);line-height:18px&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC46&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&gt;BasicProperties&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;props&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt; &lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC46&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;MessageProperties&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;PERSISTENT_BASIC&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;builder&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;().&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;priority&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(message.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;priority&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;)&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC46&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;build&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;();&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC48&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;<br>
        &lt;span&nbsp;class=&quot;&quot;&gt;System&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;out&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;println&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;Sent&nbsp;&quot;&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;+&lt;/span&gt;&nbsp;message.b&lt;span&nbsp;class=&quot;&quot;&gt;ody&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;);&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC49&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;        &lt;span&nbsp;class=&quot;&quot;&gt;ch&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;basicPublish&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;QUEUE&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&gt;props&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;,&lt;/span&gt;&nbsp;message.&lt;span&nbsp;class=&quot;&quot;&gt;body&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:teal&quot;&gt;getBytes&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;());&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC49&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&nbsp;id=&quot;LC49&quot;&nbsp;style=&quot;padding-left:10px;height:18px&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;Thread.sleep(2000);&lt;/span&gt;&lt;/div&gt;<br>
&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Also,&nbsp;there&nbsp;is&nbsp;a&nbsp;Consumer&nbsp;thread&nbsp;which&nbsp;waits&nbsp;for&nbsp;incoming&nbsp;messages&nbsp;and&nbsp;prints&nbsp;them&nbsp;on&nbsp;the&nbsp;screen:&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;inside&nbsp;run()&nbsp;method:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;padding:5px&nbsp;15px;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-size:13px;line-height:18px;background-color:rgb(238,238,238)&quot;&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;&lt;pre&nbsp;style=&quot;padding:5px&nbsp;15px;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-size:13px;font-weight:normal&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;QueueingConsumer&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;&nbsp;&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;consumer&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;&nbsp;&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;=&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;&nbsp;&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;new&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;&nbsp;&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;QueueingConsumer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;channel&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;);&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;<br>
&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;channel&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;basicConsume&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;,&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;&nbsp;&lt;/font&gt;&lt;font&nbsp;color=&quot;#008080&quot;&gt;true&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;,&lt;/span&gt;&lt;font&nbsp;color=&quot;#555555&quot;&gt;&nbsp;&lt;/font&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;consumer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(85,85,85);font-weight:bold&quot;&gt;);&lt;/span&gt;&lt;/pre&gt;<br>
&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;padding:5px&nbsp;15px;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;color:rgb(85,85,85);font-size:13px;line-height:18px;background-color:rgb(238,238,238)&quot;&gt;<br>
&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;while&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;true&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;)&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;{&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;QueueingConsumer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;Delivery&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;delivery&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;consumer&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;nextDelivery&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;();&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;String&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;message&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;=&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;new&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;String&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;delivery&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;getBody&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;());&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;System&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;out&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;.&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;println&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;&nbsp;[x]&nbsp;Received&nbsp;&#39;&quot;&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;+&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;message&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;+&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;color:rgb(221,17,68)&quot;&gt;&quot;&#39;&quot;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;);&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-weight:bold&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;nothing&nbsp;special...&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;And&nbsp;the&nbsp;behavior&nbsp;I&nbsp;get&nbsp;is&nbsp;the&nbsp;following: &lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;All&nbsp;the&nbsp;messages&nbsp;that&nbsp;was&nbsp;posted&nbsp;BEFORE&nbsp;the&nbsp;Consumer&nbsp;starts&nbsp;to&nbsp;run&nbsp;are&nbsp;received&nbsp;in&nbsp;prioritized&nbsp;order,&nbsp;BUT&nbsp;all&nbsp;the&nbsp;messages&nbsp;that&nbsp;sent&nbsp;AFTER&nbsp;the&nbsp;Consumer&nbsp;starts,&nbsp;are&nbsp;received&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;they&nbsp;were&nbsp;sent&nbsp;without&nbsp;concerning&nbsp;a&nbsp;priority.&nbsp;Tried&nbsp;to&nbsp;put&nbsp;some&nbsp;Thread.sleep()&nbsp;in&nbsp;different&nbsp;places&nbsp;in&nbsp;code&nbsp;to&nbsp;give&nbsp;the&nbsp;queue&nbsp;some&nbsp;time&nbsp;to&nbsp;reorganize&nbsp;itself,&nbsp;but&nbsp;it&nbsp;didn&#39;t&nbsp;work.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;So,&nbsp;it&nbsp;seems&nbsp;like&nbsp;priority&nbsp;works&nbsp;only&nbsp;on&nbsp;some&nbsp;static&nbsp;queues&nbsp;without&nbsp;constantly&nbsp;working&nbsp;Consumer&nbsp;and&nbsp;Producer.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif;font-size:14px&quot;&gt;Am&nbsp;I&nbsp;right?&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Maybe&nbsp;I&nbsp;am&nbsp;doing&nbsp;something&nbsp;wrong?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Can&nbsp;you&nbsp;please&nbsp;give&nbsp;some&nbsp;complex&nbsp;example&nbsp;for&nbsp;using&nbsp;the&nbsp;priority-queue&nbsp;plugin?&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;In&nbsp;my&nbsp;project,&nbsp;we&#39;ll&nbsp;have&nbsp;a&nbsp;number&nbsp;of&nbsp;Producers&nbsp;and&nbsp;a&nbsp;number&nbsp;of&nbsp;Consumers&nbsp;asynchronously&nbsp;putting&nbsp;and&nbsp;taking&nbsp;items&nbsp;from&nbsp;the&nbsp;queue.&nbsp;Does&nbsp;the&nbsp;plugin&nbsp;support&nbsp;the&nbsp;following&nbsp;scenario?&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,sans-serif&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Thank&nbsp;you,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Nik&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
