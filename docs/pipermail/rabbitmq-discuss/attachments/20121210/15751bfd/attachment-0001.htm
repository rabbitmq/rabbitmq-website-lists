<tt>
I&nbsp;realize&nbsp;this&nbsp;is&nbsp;a&nbsp;somewhat&nbsp;esoteric&nbsp;question&nbsp;and&nbsp;apologize&nbsp;for&nbsp;the&nbsp;complexity.&nbsp;We&amp;#39;re&nbsp;still&nbsp;on&nbsp;2.8.7&nbsp;for&nbsp;a&nbsp;while,&nbsp;although&nbsp;my&nbsp;guess&nbsp;is&nbsp;that&nbsp;federation&nbsp;in&nbsp;3.0&nbsp;won&amp;#39;t&nbsp;drastically&nbsp;change&nbsp;the&nbsp;answer.&lt;br&gt;&lt;br&gt;In&nbsp;our&nbsp;setup,&nbsp;we&nbsp;have&nbsp;bidirectionally&nbsp;federated&nbsp;nodes,&nbsp;i.e. &nbsp;&amp;#39;slave&amp;#39;&nbsp;&amp;lt;-&amp;gt;&nbsp;&amp;#39;master&amp;#39;&nbsp;with&nbsp;an&nbsp;exchange&nbsp;named&nbsp;&amp;#39;skytap&amp;#39;. &nbsp;To&nbsp;this&nbsp;mix&nbsp;I&nbsp;add&nbsp;a&nbsp;set&nbsp;of&nbsp;alternate&nbsp;nodes&nbsp;to&nbsp;enable&nbsp;non-stopping&nbsp;upgrades:&nbsp;&amp;#39;master-alternate&amp;#39;&nbsp;and&nbsp;&amp;#39;slave-alternate&amp;#39;.&nbsp;The&nbsp;primary&nbsp;and&nbsp;alternate&nbsp;nodes&nbsp;are&nbsp;identically&nbsp;configured.&lt;br&gt;<br>
&lt;br&gt;I&amp;#39;m&nbsp;using&nbsp;VIPs&nbsp;(keepalive&nbsp;based)&nbsp;for&nbsp;connections&nbsp;between&nbsp;nodes.&nbsp;There&amp;#39;s&nbsp;a&nbsp;vip-master&nbsp;and&nbsp;a&nbsp;vip-slave.&nbsp;Most&nbsp;of&nbsp;the&nbsp;time&nbsp;vip-master&nbsp;points&nbsp;at&nbsp;the&nbsp;&amp;#39;master&amp;quot;&nbsp;node,&nbsp;but&nbsp;occasionally&nbsp;points&nbsp;at&nbsp;the&nbsp;&amp;#39;master-alternate&amp;quot;&nbsp;node.&nbsp;In&nbsp;the&nbsp;rabbitmq.config,&nbsp;I&nbsp;specify&nbsp;the&nbsp;VIP&nbsp;names&nbsp;everywhere&nbsp;(i.e&nbsp;vip-master,&nbsp;vip-alternate),&nbsp;and&nbsp;never&nbsp;mention&nbsp;the&nbsp;actual&nbsp;node&nbsp;names.&lt;br&gt;<br>
&lt;br&gt;When&nbsp;I&nbsp;first&nbsp;start&nbsp;this&nbsp;up,&nbsp;I&nbsp;see&nbsp;a&nbsp;federation&nbsp;support&nbsp;queue&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;federation:&nbsp;skytap&nbsp;-&amp;gt;&nbsp;rabbit@master&lt;br&gt;&lt;br&gt;This&nbsp;is&nbsp;what&nbsp;I&amp;#39;d&nbsp;expect&nbsp;based&nbsp;on&nbsp;my&nbsp;understanding&nbsp;of&nbsp;federation.&lt;br&gt;&lt;br&gt;However,&nbsp;after&nbsp;doing&nbsp;an&nbsp;upgrade&nbsp;process&nbsp;(i.e.,&nbsp;vip-master&nbsp;goes&nbsp;from&nbsp;&amp;#39;master&amp;#39;&nbsp;to&nbsp;&amp;#39;master-alternate&amp;#39;&nbsp;and&nbsp;back&nbsp;to&nbsp;&amp;#39;master&amp;#39;),&nbsp;I&nbsp;have&nbsp;two&nbsp;queues&nbsp;now:&lt;br&gt;<br>
&lt;br&gt;federation:&nbsp;skytap&nbsp;-&amp;gt;&nbsp;rabbit@slave&lt;br&gt;federation:&nbsp;skytap&nbsp;-&amp;gt;&nbsp;rabbit@slave-alternate&lt;br&gt;&lt;br&gt;This&nbsp;isn&amp;#39;t&nbsp;so&nbsp;good.&nbsp;The&nbsp;vast&nbsp;majority&nbsp;of&nbsp;the&nbsp;time&nbsp;the&nbsp;slave-alternate&nbsp;node&nbsp;isn&amp;#39;t&nbsp;around.&nbsp;Messages&nbsp;sent&nbsp;to&nbsp;the&nbsp;skytap&nbsp;exchange&nbsp;just&nbsp;pile&nbsp;up&nbsp;in&nbsp;the&nbsp;second&nbsp;queue.&nbsp;(The&nbsp;do&nbsp;of&nbsp;course&nbsp;get&nbsp;delivered&nbsp;to&nbsp;the&nbsp;non-alternate&nbsp;slave&nbsp;node.)&lt;br&gt;<br>
&lt;br&gt;&lt;b&gt;Question&nbsp;1:&lt;/b&gt;&lt;br&gt;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;understand&nbsp;this&nbsp;behavior.&nbsp;It&amp;#39;s&nbsp;almost&nbsp;as&nbsp;if&nbsp;the&nbsp;federation&nbsp;logic&nbsp;is&nbsp;burrowing&nbsp;underneath&nbsp;my&nbsp;VIP&nbsp;and&nbsp;discovering&nbsp;the&nbsp;actual&nbsp;node&nbsp;names.&nbsp;In&nbsp;my&nbsp;naive&nbsp;understanding,&nbsp;I&amp;#39;d&nbsp;expect&nbsp;that&nbsp;the&nbsp;use&nbsp;of&nbsp;VIPs&nbsp;would&nbsp;hide&nbsp;away&nbsp;the&nbsp;primary/alternate&nbsp;nodes.&lt;br&gt;<br>
&lt;br&gt;That&nbsp;said,&nbsp;I&nbsp;do&nbsp;notice&nbsp;in&nbsp;the&nbsp;connections&nbsp;list&nbsp;that&nbsp;incoming&nbsp;connections&nbsp;come&nbsp;from&nbsp;the&nbsp;&amp;#39;regular&amp;#39;&nbsp;node&nbsp;IP,&nbsp;not&nbsp;from&nbsp;the&nbsp;VIP&nbsp;that&amp;#39;s&nbsp;assigned&nbsp;to&nbsp;the&nbsp;same&nbsp;node.&nbsp;Not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is&nbsp;relevant&nbsp;or&nbsp;not.&lt;br&gt;&lt;br&gt;&lt;b&gt;Question&nbsp;2:&lt;/b&gt;&lt;br&gt;<br>
In&nbsp;a&nbsp;related&nbsp;vein,&nbsp;looking&nbsp;at&nbsp;the&nbsp;Exchanges&nbsp;I&nbsp;see&nbsp;exchanges&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;federation:&nbsp;skytap&nbsp;-&amp;gt;&nbsp;rabbit@slave&nbsp;A&lt;br&gt;federation:&nbsp;skytap&nbsp;-&amp;gt;&nbsp;rabbit@slave-alternate&nbsp;B&lt;br&gt;&lt;br&gt;What&nbsp;do&nbsp;the&nbsp;A/B&nbsp;signify?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;<br>
&lt;br&gt;Matt&lt;br&gt;&lt;br&gt;<br>

</tt>
