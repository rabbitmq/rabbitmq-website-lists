<tt>
&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;Toby,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;The&nbsp;solution&nbsp;you&nbsp;propose&nbsp;is&nbsp;the&nbsp;easiest&nbsp;and&nbsp;most&nbsp;efficient&nbsp;way&nbsp;of&nbsp;doing&nbsp;it&nbsp;on&nbsp;RabbitMQ&nbsp;STOMP.&nbsp;Using&nbsp;different&nbsp;/queue/&nbsp;destinations&nbsp;removes&nbsp;the&nbsp;need&nbsp;for&nbsp;complex&nbsp;matching&nbsp;during&nbsp;message&nbsp;routing.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;Queues&nbsp;are&nbsp;cheap&nbsp;in&nbsp;RabbitMQ&nbsp;and&nbsp;each&nbsp;/queue&nbsp;corresponds&nbsp;to&nbsp;one&nbsp;queue,&nbsp;so&nbsp;creating&nbsp;a&nbsp;queue&nbsp;per&nbsp;country&nbsp;is&nbsp;not&nbsp;expensive.&nbsp;Also,&nbsp;queues&nbsp;are&nbsp;created&nbsp;lazily&nbsp;so&nbsp;you&nbsp;don't&nbsp;need&nbsp;to&nbsp;worry&nbsp;about&nbsp;ordering&nbsp;consumers/publishers.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;There&nbsp;is&nbsp;another&nbsp;option&nbsp;that&nbsp;you&nbsp;could&nbsp;consider&nbsp;that&nbsp;has&nbsp;_slightly_&nbsp;different&nbsp;semantics:&nbsp;use&nbsp;a&nbsp;destination&nbsp;such&nbsp;as&nbsp;/exchange/amq.direct/country.australia.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;The&nbsp;main&nbsp;difference&nbsp;between&nbsp;/queue&nbsp;and&nbsp;/exchange&nbsp;in&nbsp;this&nbsp;instance&nbsp;is&nbsp;how&nbsp;multiple&nbsp;subscribers&nbsp;are&nbsp;treated.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;With&nbsp;/queue,&nbsp;if&nbsp;you&nbsp;have&nbsp;two&nbsp;subscribers&nbsp;to&nbsp;the&nbsp;same&nbsp;country&nbsp;queue,&nbsp;then&nbsp;messages&nbsp;are&nbsp;sent&nbsp;out&nbsp;to&nbsp;the&nbsp;consumers&nbsp;in&nbsp;a&nbsp;round-robin&nbsp;fashion.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;With&nbsp;/exchange,&nbsp;each&nbsp;subscriber&nbsp;will&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;each&nbsp;message.&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;I'm&nbsp;guessing&nbsp;for&nbsp;your&nbsp;use&nbsp;case&nbsp;that&nbsp;round-robin&nbsp;is&nbsp;probably&nbsp;the&nbsp;most&nbsp;suitable.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;Regards,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;Rob&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;--&amp;nbsp;&lt;br&gt;Rob&nbsp;Harrop&lt;br&gt;RabbitMQ&lt;br&gt;&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style=&quot;color:&nbsp;#a0a0a0;&quot;&gt;On&nbsp;Tuesday,&nbsp;7&nbsp;June&nbsp;2011&nbsp;at&nbsp;05:20,&nbsp;Toby&nbsp;Corkindale&nbsp;wrote:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;margin-left:0px;padding-left:10px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;&lt;div&gt;&lt;div&gt;Hi,&lt;br&gt;I'm&nbsp;afraid&nbsp;I'm&nbsp;something&nbsp;of&nbsp;a&nbsp;beginner&nbsp;when&nbsp;it&nbsp;comes&nbsp;to&nbsp;message&nbsp;queuing&nbsp;&lt;br&gt;systems,&nbsp;although&nbsp;I've&nbsp;submitted&nbsp;several&nbsp;patches&nbsp;to&nbsp;the&nbsp;Perl&nbsp;STOMP&nbsp;&lt;br&gt;modules&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;using&nbsp;them&nbsp;recently,&nbsp;and&nbsp;have&nbsp;picked&nbsp;up&nbsp;what&nbsp;I&nbsp;&lt;br&gt;think&nbsp;is&nbsp;a&nbsp;bit&nbsp;of&nbsp;knowledge.&lt;br&gt;&lt;br&gt;Anyway,&nbsp;I&nbsp;have&nbsp;a&nbsp;query&nbsp;about&nbsp;RabbitMQ's&nbsp;STOMP&nbsp;plugin,&nbsp;and&nbsp;haven't&nbsp;quite&nbsp;&lt;br&gt;been&nbsp;able&nbsp;to&nbsp;understand&nbsp;the&nbsp;docs&nbsp;on&nbsp;the&nbsp;matter.&lt;br&gt;&lt;br&gt;My&nbsp;goal&nbsp;is&nbsp;to&nbsp;have&nbsp;a&nbsp;queue&nbsp;where&nbsp;the&nbsp;consumers&nbsp;of&nbsp;that&nbsp;queue&nbsp;only&nbsp;&lt;br&gt;receive&nbsp;a&nbsp;subset&nbsp;of&nbsp;all&nbsp;messages.&nbsp;I&nbsp;want&nbsp;them&nbsp;to&nbsp;filter&nbsp;based&nbsp;on&nbsp;a&nbsp;&lt;br&gt;header&nbsp;in&nbsp;the&nbsp;messages.&lt;br&gt;&lt;br&gt;Eg.&lt;br&gt;&lt;br&gt;SEND&lt;br&gt;destination:/queue/foo&lt;br&gt;x-country:australia&lt;br&gt;&lt;br&gt;with&nbsp;the&nbsp;receiver&nbsp;somehow&nbsp;doing&nbsp;something&nbsp;like:&lt;br&gt;SUBSCRIBE&lt;br&gt;destination:/queue/foo?x-country=australia&lt;br&gt;&lt;br&gt;&lt;br&gt;Now&nbsp;currently&nbsp;I&nbsp;can&nbsp;achieve&nbsp;this&nbsp;goal&nbsp;by&nbsp;creating&nbsp;lots&nbsp;of&nbsp;queues,&nbsp;one&nbsp;&lt;br&gt;for&nbsp;each&nbsp;possible&nbsp;value,&nbsp;and&nbsp;then&nbsp;the&nbsp;consumers&nbsp;can&nbsp;subscribe&nbsp;to&nbsp;all&nbsp;the&nbsp;&lt;br&gt;queues..&nbsp;but&nbsp;this&nbsp;is&nbsp;a&nbsp;bit&nbsp;messy.&lt;br&gt;&lt;br&gt;Eg.&lt;br&gt;SEND&lt;br&gt;destination:/queue/foo.australia&lt;br&gt;&lt;br&gt;SUBSCRIBE&lt;br&gt;destination:/queue/foo.australia&lt;br&gt;&lt;br&gt;&lt;br&gt;There&nbsp;are&nbsp;some&nbsp;discussions&nbsp;of&nbsp;routing&nbsp;keys&nbsp;in&nbsp;the&nbsp;STOMP&nbsp;plugin's&nbsp;docs,&nbsp;&lt;br&gt;but&nbsp;I&nbsp;don't&nbsp;understand&nbsp;how&nbsp;they&nbsp;relate.&nbsp;Are&nbsp;they&nbsp;what&nbsp;I'm&nbsp;looking&nbsp;for?&lt;br&gt;I&nbsp;only&nbsp;want&nbsp;this&nbsp;to&nbsp;work&nbsp;with&nbsp;simple&nbsp;queues,&nbsp;not,&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;know,&nbsp;&lt;br&gt;exchanges.&nbsp;Maybe&nbsp;I'm&nbsp;barking&nbsp;up&nbsp;the&nbsp;wrong&nbsp;tree&nbsp;though?&lt;br&gt;&lt;br&gt;I&nbsp;note&nbsp;that&nbsp;in&nbsp;ActiveMQ's&nbsp;STOMP&nbsp;plugin,&nbsp;you&nbsp;can&nbsp;apply&nbsp;a&nbsp;selector&nbsp;to&nbsp;the&nbsp;&lt;br&gt;subscription&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;SUBSCRIBE&lt;br&gt;destination:/queue/foo&lt;br&gt;activemq.selector:country=&quot;australia&quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Toby&lt;br&gt;_______________________________________________&lt;br&gt;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;
</tt>
