<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Yes.&nbsp;With&nbsp;only&nbsp;that&nbsp;binding,&nbsp;things&nbsp;are&nbsp;working&nbsp;and&nbsp;I&nbsp;can&nbsp;see&nbsp;the&nbsp;message&nbsp;in&nbsp;test-receive-users&nbsp;queue.&nbsp;The&nbsp;problems&nbsp;start&nbsp;when&nbsp;I&nbsp;start&nbsp;adding&nbsp;bindings&nbsp;and&nbsp;messages.&nbsp;We&nbsp;have&nbsp;had&nbsp;it&nbsp;working&nbsp;with&nbsp;a&nbsp;few&nbsp;bindings&nbsp;(5-10&nbsp;approx)&nbsp;but&nbsp;when&nbsp;we&nbsp;start&nbsp;putting&nbsp;load&nbsp;on&nbsp;it&nbsp;(5000&nbsp;bindings&nbsp;approx)&nbsp;it&nbsp;seems&nbsp;to&nbsp;just&nbsp;die.&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Best&nbsp;regards&lt;br&gt;Patrik&nbsp;Ring&lt;br&gt;&lt;br&gt;Co-founder&nbsp;and&nbsp;CTO&nbsp;of&nbsp;Bloglovin.com&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:patrik.ring@bloglovin.com&quot;&nbsp;target=&quot;_blank&quot;&gt;patrik.ring@bloglovin.com&lt;/a&gt;&lt;br&gt;<br>
<br>
+46&nbsp;730&nbsp;59&nbsp;78&nbsp;14&lt;div&gt;+1&nbsp;347&nbsp;859&nbsp;7999&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Mar&nbsp;5,&nbsp;2014&nbsp;at&nbsp;7:05&nbsp;AM,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
<br>
Hi&nbsp;Patrik,&nbsp;thanks.&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;this&nbsp;looks&nbsp;like&nbsp;federation&nbsp;is&nbsp;configured&nbsp;correctly&nbsp;and&nbsp;should&nbsp;be&nbsp;working&nbsp;normally.&nbsp;The&nbsp;downstream&nbsp;exchange&nbsp;only&nbsp;has&nbsp;a&nbsp;single&nbsp;binding&nbsp;to&nbsp;a&nbsp;single&nbsp;queue,&nbsp;with&nbsp;routing&nbsp;key&nbsp;&quot;user.2&quot;.&nbsp;Are&nbsp;messages&nbsp;being&nbsp;published&nbsp;upstream&nbsp;with&nbsp;that&nbsp;key?&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;04/03/14&nbsp;22:06,&nbsp;Patrik&nbsp;Ring&nbsp;wrote:&lt;br&gt;<br>
&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
Rabbit&nbsp;version&nbsp;in&nbsp;use&nbsp;is:&nbsp;RabbitMQ&nbsp;3.2.1,&nbsp;Erlang&nbsp;R14B04&lt;br&gt;<br>
&lt;br&gt;<br>
rabbitmqctl&nbsp;report&nbsp;on&lt;br&gt;<br>
upstream:&nbsp;&lt;a&nbsp;href=&quot;http://pastebin.com/PNqTziGk&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/PNqTziGk&lt;/a&gt;&lt;br&gt;<br>
&quot;slave&quot;&nbsp;server:&nbsp;&lt;a&nbsp;href=&quot;http://pastebin.com/4L6JFsiW&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/4L6JFsiW&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
*I&nbsp;have&nbsp;this&nbsp;in&nbsp;the&nbsp;exchanges&nbsp;list&nbsp;on&nbsp;the&nbsp;upstream:*&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
federation:&nbsp;users&nbsp;-&gt;&nbsp;rabbit@rabbit3.c.rabbit-magic.&lt;u&gt;&lt;/u&gt;internal&nbsp;B&lt;br&gt;&lt;/div&gt;<br>
&lt;&lt;a&nbsp;href=&quot;http://rabbit1:15672/#/exchanges/%2F/federation%3A%20users%20-%3E%20rabbit%40rabbit3.c.rabbit-magic.internal%20B&quot;&nbsp;target=&quot;_blank&quot;&gt;http://rabbit1:15672/#/&lt;u&gt;&lt;/u&gt;exchanges/%2F/federation%3A%&lt;u&gt;&lt;/u&gt;20users%20-%3E%20rabbit%&lt;u&gt;&lt;/u&gt;40rabbit3.c.rabbit-magic.&lt;u&gt;&lt;/u&gt;internal%20B&lt;/a&gt;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;x-federation-upstream&nbsp; &nbsp;ha-all&nbsp; D&nbsp;AD&nbsp;I&nbsp;Args&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;this&nbsp;i&nbsp;the&nbsp;queues&nbsp;list:&lt;br&gt;<br>
&lt;br&gt;<br>
federation:&nbsp;users&nbsp;-&gt;&nbsp;rabbit@rabbit3.c.rabbit-magic.&lt;u&gt;&lt;/u&gt;internal&lt;br&gt;&lt;/div&gt;<br>
&lt;&lt;a&nbsp;href=&quot;http://rabbit1:15672/#/queues/%2F/federation%3A%20users%20-%3E%20rabbit%40rabbit3.c.rabbit-magic.internal&quot;&nbsp;target=&quot;_blank&quot;&gt;http://rabbit1:15672/#/&lt;u&gt;&lt;/u&gt;queues/%2F/federation%3A%&lt;u&gt;&lt;/u&gt;20users%20-%3E%20rabbit%&lt;u&gt;&lt;/u&gt;40rabbit3.c.rabbit-magic.&lt;u&gt;&lt;/u&gt;internal&lt;/a&gt;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;rabbit@util1&nbsp;+1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Exp&nbsp;D&nbsp;Args&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
*For&nbsp;the&nbsp;slave:*&lt;br&gt;<br>
*&lt;br&gt;<br>
*&lt;br&gt;<br>
*Nothing.*&nbsp;Except&nbsp;on&nbsp;channels,&nbsp;where&nbsp;I&nbsp;find&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;rabbit@rabbit3.3.237.0&gt;&nbsp;(1)&lt;br&gt;<br>
&lt;&lt;a&nbsp;href=&quot;http://162.222.179.163:15672/#/channels/%3Crabbit%40rabbit3.3.237.0%3E%20(1)&quot;&nbsp;target=&quot;_blank&quot;&gt;http://162.222.179.163:15672/&lt;u&gt;&lt;/u&gt;#/channels/%3Crabbit%&lt;u&gt;&lt;/u&gt;40rabbit3.3.237.0%3E%20(1)&lt;/a&gt;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
<br>
<br>
federation&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Feel&nbsp;like&nbsp;we&nbsp;might&nbsp;be&nbsp;on&nbsp;to&nbsp;something?&lt;br&gt;<br>
&lt;br&gt;<br>
How&nbsp;do&nbsp;I&nbsp;set&nbsp;this&nbsp;up?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;a&nbsp;side&nbsp;note:&nbsp;The&nbsp;queues&nbsp;and&nbsp;exchanges&nbsp;on&nbsp;the&nbsp;upstream&nbsp;might&nbsp;still&nbsp;be&lt;br&gt;<br>
there&nbsp;since&nbsp;when&nbsp;we&nbsp;tried&nbsp;making&nbsp;it&nbsp;run&nbsp;both&nbsp;ways,&nbsp;not&nbsp;sure&nbsp;about&nbsp;this.&lt;br&gt;<br>
We&nbsp;do&nbsp;however&nbsp;have&nbsp;the&nbsp;federation&nbsp;status&nbsp;on&nbsp;the&nbsp;SLAVE,&nbsp;and&nbsp;according&nbsp;to&lt;br&gt;<br>
that&nbsp;it&#39;s&nbsp;up&nbsp;and&nbsp;running.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Best&nbsp;regards&lt;br&gt;<br>
Patrik&nbsp;Ring&lt;br&gt;<br>
&lt;br&gt;<br>
Co-founder&nbsp;and&nbsp;CTO&nbsp;of&nbsp;Bloglovin.com&lt;br&gt;<br>
&lt;/div&gt;&lt;a&nbsp;href=&quot;mailto:patrik.ring@bloglovin.com&quot;&nbsp;target=&quot;_blank&quot;&gt;patrik.ring@bloglovin.com&lt;/a&gt;&nbsp;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:patrik.ring@bloglovin.com&quot;&nbsp;target=&quot;_blank&quot;&gt;patrik.ring@bloglovin.&lt;u&gt;&lt;/u&gt;com&lt;/a&gt;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
<br>
<br>
&lt;a&nbsp;href=&quot;tel:%2B46%20730%2059%2078%2014&quot;&nbsp;value=&quot;+46730597814&quot;&nbsp;target=&quot;_blank&quot;&gt;+46&nbsp;730&nbsp;59&nbsp;78&nbsp;14&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;tel:%2B1%20347%20859%207999&quot;&nbsp;value=&quot;+13478597999&quot;&nbsp;target=&quot;_blank&quot;&gt;+1&nbsp;347&nbsp;859&nbsp;7999&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Tue,&nbsp;Mar&nbsp;4,&nbsp;2014&nbsp;at&nbsp;12:56&nbsp;PM,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;mailto:&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Hi&nbsp;Patrik.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;On&nbsp;03/03/14&nbsp;21:41,&nbsp;Patrik&nbsp;Ring&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;Some&nbsp;messages&nbsp;come&nbsp;through&nbsp;(but&nbsp;are&nbsp;heavily&nbsp;delayed,&nbsp;as&nbsp;in&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;hours)&nbsp;but&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;they&nbsp;seem&nbsp;completely&nbsp;random.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;That&#39;s&nbsp;definitely&nbsp;not&nbsp;right!&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;First&nbsp;of&nbsp;all,&nbsp;could&nbsp;you&nbsp;send&nbsp;the&nbsp;output&nbsp;of&nbsp;&quot;rabbitmqctl&nbsp;report&quot;&nbsp;for&lt;br&gt;<br>
 &nbsp; &nbsp;each&nbsp;broker?&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Also,&nbsp;which&nbsp;version&nbsp;of&nbsp;RabbitMQ&nbsp;are&nbsp;you&nbsp;using?&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Secondly,&nbsp;you&nbsp;might&nbsp;want&nbsp;to&nbsp;investigate&nbsp;whether&nbsp;the&nbsp;underlying&lt;br&gt;<br>
 &nbsp; &nbsp;infrastructure&nbsp;used&nbsp;by&nbsp;federation&nbsp;is&nbsp;wired&nbsp;up&nbsp;correctly.&nbsp;There&lt;br&gt;<br>
 &nbsp; &nbsp;should&nbsp;be&nbsp;a&nbsp;queue&nbsp;for&nbsp;each&nbsp;(exchange,&nbsp;downstream)&nbsp;pairing&nbsp;declared&lt;br&gt;<br>
 &nbsp; &nbsp;in&nbsp;the&nbsp;upstream&nbsp;broker&nbsp;(called&nbsp;&quot;federation:&nbsp;[exchange]&nbsp;-&gt;&nbsp;[node]&quot;).&lt;br&gt;<br>
 &nbsp; &nbsp;It&nbsp;should&nbsp;be&nbsp;bound&nbsp;(once)&nbsp;to&nbsp;an&nbsp;internal&nbsp;exchange&nbsp;with&nbsp;a&nbsp;similar&lt;br&gt;<br>
 &nbsp; &nbsp;name.&nbsp;That&nbsp;internal&nbsp;exchange&nbsp;should&nbsp;be&nbsp;bound&nbsp;to&nbsp;the&nbsp;upstream&lt;br&gt;<br>
 &nbsp; &nbsp;exchange&nbsp;with&nbsp;all&nbsp;the&nbsp;bindings&nbsp;that&nbsp;are&nbsp;in&nbsp;use&nbsp;downstream.&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Does&nbsp;it&nbsp;look&nbsp;like&nbsp;that&nbsp;is&nbsp;happening?&nbsp;Is&nbsp;the&nbsp;infrastructure&nbsp;queue&lt;br&gt;<br>
 &nbsp; &nbsp;seeing&nbsp;the&nbsp;message&nbsp;rates&nbsp;you&nbsp;would&nbsp;expect?&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Cheers,&nbsp;Simon&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;--&lt;br&gt;<br>
 &nbsp; &nbsp;Simon&nbsp;MacMullen&lt;br&gt;<br>
 &nbsp; &nbsp;RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
