<tt>
Hello,&lt;div&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;implement&nbsp;a&nbsp;work&nbsp;queue&nbsp;in&nbsp;RabbitMQ.&nbsp; I&nbsp;have&nbsp;several&nbsp;machines&nbsp;that&nbsp;will&nbsp;act&nbsp;as&nbsp;worker&nbsp;pools&nbsp;for&nbsp;consuming&nbsp;my&nbsp;queues.&nbsp; I&nbsp;would&nbsp;like&nbsp;each&nbsp;job&nbsp;to&nbsp;be&nbsp;processed&nbsp;only&nbsp;once.&nbsp; Some&nbsp;jobs&nbsp;have environmental requirements,&nbsp;ie&nbsp;must&nbsp;be&nbsp;executed&nbsp;on&nbsp;a&nbsp;machine&nbsp;with&nbsp;an&nbsp;SSD.&nbsp; Not&nbsp;all&nbsp;worker&nbsp;pools&nbsp;will&nbsp;meet&nbsp;these&nbsp;requirements.&nbsp; A&nbsp;first&nbsp;approach&nbsp;would&nbsp;be&nbsp;to&nbsp;have&nbsp;a&nbsp;queue&nbsp;for&nbsp;every&nbsp;permutation&nbsp;of&nbsp;requirements:&nbsp;&amp;quot;No&nbsp;Requirements&amp;quot;,&nbsp;&amp;quot;Requires&nbsp;SSD&amp;quot;,&nbsp;&amp;quot;Requires&nbsp;Certificate&amp;quot;,&nbsp;etc&nbsp;and&nbsp;have&nbsp;each&nbsp;worker&nbsp;pool&nbsp;subscribe&nbsp;to&nbsp;all&nbsp;queues&nbsp;which&nbsp;it&nbsp;can&nbsp;handle.&nbsp; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A&nbsp;majority&nbsp;of&nbsp;the&nbsp;jobs&nbsp;will&nbsp;have&nbsp;no&nbsp;requirements,&nbsp;so&nbsp;many&nbsp;worker&nbsp;pools&nbsp;will&nbsp;be&nbsp;underutilized.&nbsp; To&nbsp;fight&nbsp;this,&nbsp;I&nbsp;am&nbsp;hoping&nbsp;to&nbsp;distribute&nbsp;jobs&nbsp;in&nbsp;a&nbsp;round-robin&nbsp;fashion&nbsp;to&nbsp;all&nbsp;queues&nbsp;that&nbsp;can&nbsp;handle&nbsp;them.&nbsp; For&nbsp;example,&nbsp;a&nbsp;no-requirements&nbsp;job&nbsp;can&nbsp;be&nbsp;handled&nbsp;by&nbsp;any&nbsp;worker&nbsp;pool,&nbsp;and&nbsp;therefore&nbsp;should&nbsp;be&nbsp;distributed&nbsp;equally&nbsp;to&nbsp;all&nbsp;of&nbsp;them.&nbsp; That&nbsp;is,&nbsp;jobs&nbsp;w/&nbsp;no&nbsp;requirements&nbsp;will&nbsp;be&nbsp;evenly&nbsp;distributed&nbsp;to &amp;quot;No&nbsp;Requirements&amp;quot;,&nbsp;&amp;quot;Requires&nbsp;SSD&amp;quot;,&nbsp;&amp;quot;Requires&nbsp;Certificate&amp;quot;,&nbsp;etc.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;tried&nbsp;this&nbsp;with&nbsp;topic&nbsp;exchanges,&nbsp;but&nbsp;of&nbsp;course&nbsp;they&nbsp;will&nbsp;distribute&nbsp;the&nbsp;job&nbsp;to&nbsp;ALL&nbsp;matching&nbsp;queues,&nbsp;rather&nbsp;than&nbsp;a&nbsp;single&nbsp;arbitrary&nbsp;queue.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Some&nbsp;terrible&nbsp;alternative&nbsp;approaches&nbsp;I&nbsp;have&nbsp;so&nbsp;far:&lt;/div&gt;<br>
&lt;div&gt;1.&nbsp;Have&nbsp;producers&nbsp;submit&nbsp;to&nbsp;a&nbsp;single&nbsp;queue,&nbsp;and&nbsp;have&nbsp;a&nbsp;home-grown&nbsp;&amp;quot;load&nbsp;balancer&amp;quot;&nbsp;consumer&nbsp;on&nbsp;the&nbsp;other&nbsp;end&nbsp;which&nbsp;distributes&nbsp;jobs&nbsp;to&nbsp;appropriate&nbsp;queues.&lt;/div&gt;&lt;div&gt;2.&nbsp;When&nbsp;a&nbsp;worker&nbsp;pool&nbsp;spins&nbsp;up,&nbsp;rather&nbsp;than&nbsp;have&nbsp;each&nbsp;worker&nbsp;consume&nbsp;a&nbsp;dedicate&nbsp;queue,&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;of&nbsp;them&nbsp;hop&nbsp;between&nbsp;queues&nbsp;in&nbsp;an&nbsp;attempt&nbsp;to&nbsp;keep&nbsp;them&nbsp;busy.&lt;/div&gt;<br>
&lt;div&gt;3.&nbsp;Hacks&nbsp;with&nbsp;timestamps/modulo&nbsp;arithmetic&nbsp;in&nbsp;the&nbsp;routing&nbsp;key&nbsp;to&nbsp;trick&nbsp;the&nbsp;exchange&nbsp;into&nbsp;being&nbsp;round&nbsp;robin.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Being&nbsp;new&nbsp;to&nbsp;RabbitMQ,&nbsp;my&nbsp;intuition&nbsp;tells&nbsp;me&nbsp;#1&nbsp;will&nbsp;be&nbsp;a&nbsp;big&nbsp;performance&nbsp;problem,&nbsp;#2&nbsp;will&nbsp;be&nbsp;a&nbsp;performance&nbsp;and&nbsp;maintenance&nbsp;problem,&nbsp;and&nbsp;#3&nbsp;just&nbsp;won&amp;#39;t&nbsp;end&nbsp;up&nbsp;working.&nbsp; I&nbsp;suspect&nbsp;I&amp;#39;m&nbsp;missing&nbsp;something&nbsp;big&nbsp;here&nbsp;:)&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Has&nbsp;anyone&nbsp;successfully&nbsp;load-balanced&nbsp;their&nbsp;workers&nbsp;in&nbsp;a&nbsp;situation&nbsp;like&nbsp;this?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;advice&nbsp;much&nbsp;appreciated.&lt;/div&gt;&lt;div&gt;Adam&lt;/div&gt;<br>

</tt>
