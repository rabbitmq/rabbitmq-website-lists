<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:#000;&nbsp;background-color:#fff;&nbsp;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;&lt;div&gt;&lt;span&gt;Hi&nbsp;Gavin,&nbsp;I&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;trace&nbsp;and&nbsp;this&nbsp;is&nbsp;not&nbsp;an&nbsp;easy&nbsp;issue&nbsp;to&nbsp;trigger&nbsp;but&nbsp;I&nbsp;think&nbsp;I&nbsp;have&nbsp;understood&nbsp;what&nbsp;is&nbsp;going&nbsp;on.&nbsp;This&nbsp;issue&nbsp;happens,&nbsp;in&nbsp;my&nbsp;case,&nbsp;when&nbsp;the&nbsp;connection&nbsp;drops&nbsp;and&nbsp;Pika&nbsp;handles&nbsp;the&nbsp;error.&nbsp;This&nbsp;results&nbsp;in&nbsp;the&nbsp;on_connection_closed&nbsp;callback&nbsp;getting&nbsp;called&nbsp;which&nbsp;I&nbsp;have&nbsp;instructed&nbsp;to&nbsp;stop&nbsp;the&nbsp;connection.ioloop.&nbsp;I&nbsp;think&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;if&nbsp;you&nbsp;have&nbsp;a&nbsp;nested&nbsp;poll()s&nbsp;you&nbsp;end&nbsp;up&nbsp;with&nbsp;nested&nbsp;handlers&nbsp;so&nbsp;even&nbsp;if&nbsp;the&nbsp;poller&nbsp;(i.e.&nbsp;the&nbsp;while&nbsp;loop&nbsp;in&nbsp;poller.start())&nbsp;&lt;/span&gt;&lt;span&gt;is&nbsp;stopped&lt;/span&gt;&lt;span&gt;,&nbsp;when&nbsp;the&nbsp;call&nbsp;stack&nbsp;unwinds&nbsp;you&nbsp;can&nbsp;end&nbsp;up&nbsp;with&nbsp;calls&nbsp;to&nbsp;poll()&nbsp;getting&nbsp;executed&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;a&nbsp;transport.rpc().&nbsp;Does&nbsp;this&nbsp;make&nbsp;any&nbsp;sense?&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,<br>
&nbsp;serif;&nbsp;font-size:&nbsp;12pt;&quot;&gt;&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;hr&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:bold;&quot;&gt;From:&lt;/span&gt;&lt;/b&gt;&nbsp;Gavin&nbsp;M.&nbsp;Roy&nbsp;&amp;lt;gmr@myyearbook.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;To:&lt;/span&gt;&lt;/b&gt;&nbsp;E&nbsp;Hope-Morley&nbsp;&amp;lt;zedhm@yahoo.co.uk&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Cc:&lt;/span&gt;&lt;/b&gt;&nbsp;&quot;rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;&amp;lt;rabbitmq-discuss@lists.rabbitmq.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Sent:&lt;/span&gt;&lt;/b&gt;&nbsp;Thursday,&nbsp;20&nbsp;October&nbsp;2011,&nbsp;14:29&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Subject:&lt;/span&gt;&lt;/b&gt;&nbsp;Re:&nbsp;[rabbitmq-discuss]&nbsp;Pika&nbsp;IOLoop&nbsp;issue&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div&nbsp;id=&quot;yiv1455757913&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is&nbsp;peculiar.&nbsp;What&nbsp;is&nbsp;the&nbsp;duration&nbsp;of&nbsp;time&nbsp;between&nbsp;the&nbsp;stop&nbsp;and&nbsp;pending&nbsp;event?&nbsp;Is&nbsp;an&nbsp;exception&nbsp;being&nbsp;thrown?&nbsp;Do&nbsp;you&nbsp;have&nbsp;a&nbsp;traceback?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gavin&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;yiv1455757913Apple-style-span&quot;&nbsp;style=&quot;color:rgb(160,&nbsp;160,&nbsp;168);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;yiv1455757913Apple-style-span&quot;&nbsp;style=&quot;color:rgb(160,&nbsp;160,&nbsp;168);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;yiv1455757913Apple-style-span&quot;&nbsp;style=&quot;color:rgb(160,&nbsp;160,&nbsp;168);&quot;&gt;On&nbsp;Thursday,&nbsp;October&nbsp;20,&nbsp;2011&nbsp;at&nbsp;12:55&nbsp;PM,&nbsp;E&nbsp;Hope-Morley&nbsp;wrote:&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;margin-left:0px;padding-left:10px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;&lt;div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;color:#000;background-color:#fff;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt;&quot;&gt;&lt;div&gt;Hi,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;I&nbsp;am&nbsp;using&nbsp;Pika&nbsp;on&nbsp;Ubuntu&nbsp;11.04.&nbsp;When&nbsp;I&nbsp;call&nbsp;SelectConnection.ioloop.stop()&nbsp;following&nbsp;a&nbsp;connection&nbsp;drop&nbsp;on&nbsp;my&nbsp;connection,&nbsp;it&nbsp;sometimes&nbsp;fails&nbsp;to&nbsp;actually&nbsp;stop&nbsp;the&nbsp;ioloop&nbsp;i.e.&nbsp;following&nbsp;the&nbsp;call&nbsp;to&nbsp;stop(),&nbsp;a&nbsp;callback&nbsp;may&nbsp;sometimes&nbsp;be&nbsp;called&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;pending&nbsp;event.&nbsp;Any&nbsp;ideas?&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;_______________________________________________&lt;br&gt;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;ymailto=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
