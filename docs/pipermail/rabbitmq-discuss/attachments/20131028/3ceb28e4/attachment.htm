<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;br&gt;&lt;br&gt;I've&nbsp;been&nbsp;trying&nbsp;to&nbsp;get&nbsp;mosquitto_sub&nbsp;to&nbsp;connect&nbsp;to&nbsp;RabbitMQ,&nbsp;when&nbsp;I&nbsp;perform&nbsp;a&nbsp;test&nbsp;using&nbsp;&lt;a&nbsp;href=&quot;http://test.mosquitto.org&quot;&nbsp;target=&quot;_blank&quot;&gt;test.mosquitto.org&lt;/a&gt;<br>
&nbsp;and&nbsp;their&nbsp;certificate&nbsp;it&nbsp;works&nbsp;fine&nbsp;and&nbsp;when&nbsp;I&nbsp;connect&nbsp;to&nbsp;my&nbsp;RabbitMQ&nbsp;<br>
using&nbsp;OpenSSL&nbsp;s_client&nbsp;and&nbsp;I&nbsp;supply&nbsp;the&nbsp;CAfile&nbsp;it&nbsp;performs&nbsp;the&nbsp;handshake<br>
&nbsp;correctly.&nbsp;However&nbsp;this&nbsp;fails&nbsp;when&nbsp;sending&nbsp;the&nbsp;CAfile&nbsp;via&nbsp;mosquitto_sub&lt;br&gt;&lt;br&gt;vagrant@precise32:/opt/data$&nbsp;./mosquitto-1.2.2/client/&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;wbr&gt;mosquitto_sub&nbsp;-h&nbsp;**.***.***.**&nbsp;-p&nbsp;8883&nbsp;-t&nbsp;&quot;#&quot;&nbsp;-d&nbsp;--cafile&nbsp;DigiCertEA.pem&nbsp;--tls-version&nbsp;tlsv1&lt;br&gt;Client&nbsp;mosqsub/3530-precise32&nbsp;sending&nbsp;CONNECT&lt;br&gt;OpenSSL&nbsp;Error:&nbsp;error:14090086:SSL&nbsp;routines:SSL3_GET_SERVER_&lt;wbr&gt;CERTIFICATE:certificate&nbsp;verify&nbsp;failed&lt;br&gt;Error:&nbsp;Protocol&nbsp;error&lt;br&gt;&lt;br&gt;RabbitMQ&nbsp;=&nbsp;3.2.0&lt;br&gt;OpenSSL&nbsp;=&nbsp;1.0.1&lt;br&gt;Erlang&nbsp;=&nbsp;R16B&lt;br&gt;&lt;br&gt;This<br>
&nbsp;is&nbsp;the&nbsp;detail&nbsp;from&nbsp;my&nbsp;log&nbsp;in&nbsp;RabbitMQ.&nbsp;The&nbsp;CAfiles&nbsp;have&nbsp;slightly&nbsp;<br>
different&nbsp;names&nbsp;but&nbsp;using&nbsp;openssl&nbsp;x509&nbsp;-in&nbsp;-text&nbsp;-noout&nbsp;gives&nbsp;the&nbsp;same&nbsp;<br>
serial&nbsp;number&lt;br&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;28-Oct-2013::12:52:02&nbsp;===&lt;br&gt;SSL:&nbsp;certify:&nbsp;tls_connection.erl:2286:Fatal&nbsp;error:&nbsp;certificate&nbsp;unknown&lt;br&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;28-Oct-2013::12:52:07&nbsp;===&lt;br&gt;**&nbsp;Generic&nbsp;server&nbsp;&amp;lt;0.594.0&amp;gt;&nbsp;terminating&nbsp;&lt;br&gt;**&nbsp;Last&nbsp;message&nbsp;in&nbsp;was&nbsp;{inet_async,#Port&amp;lt;0.14157&amp;gt;,&lt;wbr&gt;35762,{ok,#Port&amp;lt;0.15830&amp;gt;}}&lt;br&gt;**&nbsp;When&nbsp;Server&nbsp;state&nbsp;==&nbsp;{state,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{rabbit_mqtt_sup,start_ssl_&lt;wbr&gt;client,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&nbsp;[[{cacertfile,&quot;/etc/ssl/certs/&lt;wbr&gt;DigiCertCA.pem&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{certfile,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&quot;/etc/ssl/certs/star_*****_***&lt;wbr&gt;*_net_chain.pem&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{keyfile,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&quot;/etc/ssl/private/*****.****.&lt;wbr&gt;net.key&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{verify,verify_none},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;wbr&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{fail_if_no_peer_cert,false}]]&lt;wbr&gt;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#Port&amp;lt;0.14157&amp;gt;,35762}&lt;br&gt;**&nbsp;Reason&nbsp;for&nbsp;termination&nbsp;==&nbsp;&lt;br&gt;**&nbsp;{timeout,{gen_server2,call,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[&amp;lt;0.596.0&amp;gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{go,#Port&amp;lt;0.15830&amp;gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#Fun&amp;lt;rabbit_networking.2.&lt;wbr&gt;65720357&amp;gt;}]}}&lt;br&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;28-Oct-2013::12:52:07&nbsp;===&lt;br&gt;**&nbsp;Generic&nbsp;server&nbsp;&amp;lt;0.596.0&amp;gt;&nbsp;terminating&lt;br&gt;**&nbsp;Last&nbsp;message&nbsp;in&nbsp;was&nbsp;{go,#Port&amp;lt;0.15830&amp;gt;,#Fun&amp;lt;&lt;wbr&gt;rabbit_networking.2.65720357&amp;gt;}&lt;br&gt;**&nbsp;When&nbsp;Server&nbsp;state&nbsp;==&nbsp;undefined&lt;br&gt;**&nbsp;Reason&nbsp;for&nbsp;termination&nbsp;==&nbsp;&lt;br&gt;**&nbsp;{{badmatch,{error,{ssl_&lt;wbr&gt;upgrade_error,{tls_alert,&quot;&lt;wbr&gt;certificate&nbsp;unknown&quot;}}}},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[{rabbit_mqtt_reader,handle_&lt;wbr&gt;call,3,[]},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{gen_server2,handle_msg,2,[]},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{proc_lib,init_p_do_apply,3,[{&lt;wbr&gt;file,&quot;proc_lib.erl&quot;},{line,&lt;wbr&gt;239}]}]}&lt;br&gt;&lt;br&gt;Is<br>
&nbsp;this&nbsp;a&nbsp;problem&nbsp;with&nbsp;RabbitMQ&nbsp;or&nbsp;perhaps&nbsp;the&nbsp;mosquitto_sub&nbsp;client?&nbsp;If&nbsp;it<br>
&nbsp;belongs&nbsp;to&nbsp;the&nbsp;latter&nbsp;I&nbsp;guess&nbsp;I&nbsp;should&nbsp;redirect&nbsp;my&nbsp;question&nbsp;:)&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;Dan&lt;/div&gt;&lt;/div&gt;
</tt>
