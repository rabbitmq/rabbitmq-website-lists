<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Aug&nbsp;22,&nbsp;2008&nbsp;at&nbsp;10:49&nbsp;PM,&nbsp;Ben&nbsp;Hood&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:0x6e6562@gmail.com&quot;&gt;0x6e6562@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Torben,&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Fri,&nbsp;Aug&nbsp;22,&nbsp;2008&nbsp;at&nbsp;9:05&nbsp;PM,&nbsp;Torben&nbsp;Hoffmann&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:torben.lehoff@googlemail.com&quot;&gt;torben.lehoff@googlemail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;/div&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&amp;gt;&nbsp;Okay,&nbsp;I&nbsp;did&nbsp;not&nbsp;think&nbsp;of&nbsp;this&nbsp;type&nbsp;of&nbsp;solution,&nbsp;but&nbsp;I&nbsp;think&nbsp;this&nbsp;would&nbsp;work&lt;br&gt;<br>
&amp;gt;&nbsp;just&nbsp;as&nbsp;fine.&nbsp;So&nbsp;either&nbsp;I&nbsp;get&nbsp;a&nbsp;lot&nbsp;of&nbsp;queues&nbsp;or&nbsp;a&nbsp;lot&nbsp;of&nbsp;exchanges&lt;br&gt;<br>
&amp;gt;&nbsp;depending&nbsp;on&nbsp;how&nbsp;I&nbsp;choose&nbsp;to&nbsp;represent&nbsp;the&nbsp;groups.&nbsp;I&nbsp;will&nbsp;let&nbsp;that&nbsp;be&nbsp;up&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;a&nbsp;practical&nbsp;test&nbsp;on&nbsp;a&nbsp;couple&nbsp;of&nbsp;machines.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Usually&nbsp;you&nbsp;would&nbsp;go&nbsp;for&nbsp;a&nbsp;queue&nbsp;per&nbsp;client,&nbsp;but&nbsp;this&nbsp;is&nbsp;not&nbsp;a&nbsp;rule,&lt;br&gt;<br>
since&nbsp;queues&nbsp;can&nbsp;be&nbsp;shared.&nbsp;YMMV.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;will&nbsp;need&nbsp;queues&nbsp;for&nbsp;the&nbsp;individuals&nbsp;themselves&nbsp;plus&nbsp;for&nbsp;all&nbsp;the&nbsp;groups&nbsp;-&nbsp;communication&nbsp;can&nbsp;be&nbsp;both&nbsp;1:1&nbsp;and&nbsp;1:many.&lt;br&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Note&nbsp;that&nbsp;you&nbsp;do&nbsp;not&nbsp;necessarily&nbsp;need&nbsp;an&nbsp;AMQP&nbsp;instance&nbsp;on&nbsp;machine&nbsp;that&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;clients&nbsp;run&nbsp;on.&nbsp;Multiple&nbsp;remote&nbsp;clients&nbsp;can&nbsp;connect&nbsp;to&nbsp;a&nbsp;single&nbsp;broker&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;instance.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Yes,&nbsp;but&nbsp;for&nbsp;the&nbsp;sake&nbsp;of&nbsp;performance&nbsp;I&nbsp;think&nbsp;that&nbsp;the&nbsp;more&nbsp;I&nbsp;can&nbsp;distribute&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;work&nbsp;load&nbsp;the&nbsp;better.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Sure,&nbsp;but&nbsp;wouldn&amp;#39;t&nbsp;you&nbsp;want&nbsp;the&nbsp;main&nbsp;load&nbsp;to&nbsp;be&nbsp;with&nbsp;the&nbsp;consumers,&lt;br&gt;<br>
i.e.&nbsp;where&nbsp;the&nbsp;real&nbsp;work&nbsp;is&nbsp;being&nbsp;done?&nbsp;The&nbsp;broker&nbsp;is&nbsp;just&nbsp;an&lt;br&gt;<br>
intermdiary&nbsp;that&nbsp;routes&nbsp;messages&nbsp;in&nbsp;an&nbsp;efficient&nbsp;fashion.&nbsp;Under&nbsp;normal&lt;br&gt;<br>
circumstances&nbsp;I&nbsp;would&nbsp;want&nbsp;to&nbsp;be&nbsp;allocating&nbsp;a&nbsp;lot&nbsp;more&nbsp;resources&nbsp;to&nbsp;be&lt;br&gt;<br>
doing&nbsp;the&nbsp;real&nbsp;work&nbsp;rather&nbsp;than&nbsp;distributing&nbsp;it.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;wasn&amp;#39;t&nbsp;clear&nbsp;earlier:&nbsp;I&nbsp;want&nbsp;to&nbsp;avoid&nbsp;having&nbsp;a&nbsp;bottleneck&nbsp;in&nbsp;the&nbsp;middle&nbsp;as&nbsp;today.&nbsp;But&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;what&nbsp;the&nbsp;best&nbsp;option&nbsp;is&nbsp;right&nbsp;now,&nbsp;but&nbsp;I&nbsp;will&nbsp;try&nbsp;some&nbsp;scenarios&nbsp;to&nbsp;see&nbsp;what&nbsp;fits&nbsp;the&nbsp;best.&nbsp;&lt;br&gt;<br>
&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
Ideally&nbsp;you&nbsp;should&nbsp;be&nbsp;using&nbsp;a&nbsp;small&nbsp;(relative&nbsp;to&nbsp;the&nbsp;workload)&nbsp;number&lt;br&gt;<br>
of&nbsp;Rabbit&nbsp;instances&nbsp;to&nbsp;farm&nbsp;out&nbsp;work&nbsp;to&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;workers.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;not&nbsp;to&nbsp;say&nbsp;that&nbsp;you&nbsp;can&amp;#39;t&nbsp;have&nbsp;large&nbsp;Rabbit&nbsp;clusters,&nbsp;it&amp;#39;s&lt;br&gt;<br>
just&nbsp;that&nbsp;Rabbit,&nbsp;as&nbsp;a&nbsp;communication&nbsp;fabric,&nbsp;shouldn&amp;#39;t&nbsp;consume&nbsp;the&lt;br&gt;<br>
lion&nbsp;share&nbsp;of&nbsp;your&nbsp;resources.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Having&nbsp;the&nbsp;workers&nbsp;and&nbsp;Rabbit&nbsp;share&nbsp;machines&nbsp;will&nbsp;allow&nbsp;me&nbsp;to&nbsp;make&nbsp;a&nbsp;very&nbsp;elegant&nbsp;architecture&nbsp;that&nbsp;scales&nbsp;very&nbsp;well&nbsp;since&nbsp;adding&nbsp;a&nbsp;new&nbsp;machine&nbsp;does&nbsp;not&nbsp;require&nbsp;more&nbsp;than&nbsp;adding&nbsp;it&nbsp;to&nbsp;the&nbsp;cluster.&nbsp;But&nbsp;you&nbsp;are&nbsp;right&nbsp;that&nbsp;there&nbsp;could&nbsp;be&nbsp;some&nbsp;side&nbsp;effects&nbsp;in&nbsp;play&nbsp;here&nbsp;that&nbsp;I&nbsp;need&nbsp;to&nbsp;iron&nbsp;out&nbsp;before&nbsp;I&nbsp;get&nbsp;a&nbsp;good&nbsp;solution.&lt;br&gt;<br>
&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Indeed!&nbsp;The&nbsp;machines&nbsp;are&nbsp;already&nbsp;there&nbsp;and&nbsp;cannot&nbsp;be&nbsp;removed,&nbsp;but&nbsp;with&nbsp;AMQP&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;think&nbsp;that&nbsp;I&nbsp;can&nbsp;let&nbsp;them&nbsp;do&nbsp;more&nbsp;of&nbsp;the&nbsp;work&nbsp;in&nbsp;my&nbsp;system&nbsp;and&nbsp;remove&nbsp;all&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;machines&nbsp;that&nbsp;connect&nbsp;the&nbsp;machines&nbsp;where&nbsp;the&nbsp;consumer&nbsp;processes&nbsp;run.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;You&nbsp;might&nbsp;be&nbsp;interested&nbsp;in&nbsp;a&nbsp;feature&nbsp;of&nbsp;the&nbsp;AMQP&nbsp;spec&nbsp;called&nbsp;basic.qos&lt;br&gt;<br>
which&nbsp;allows&nbsp;for&nbsp;better&nbsp;load&nbsp;balancing.&nbsp;We&nbsp;have&nbsp;not&nbsp;implemented&nbsp;it&nbsp;yet&lt;br&gt;<br>
in&nbsp;Rabbit&nbsp;because&nbsp;of&nbsp;two&nbsp;reasons:&lt;br&gt;<br>
&lt;br&gt;<br>
1.&nbsp;It&nbsp;is&nbsp;tricky&nbsp;to&nbsp;get&nbsp;right&nbsp;and&nbsp;verify&nbsp;it&amp;#39;s&nbsp;correctness;&lt;br&gt;<br>
2.&nbsp;Few&nbsp;people&nbsp;have&nbsp;asked&nbsp;for&nbsp;it&nbsp;yet.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;we&nbsp;do&nbsp;have&nbsp;a&nbsp;plan&nbsp;of&nbsp;how&nbsp;we&amp;#39;d&nbsp;like&nbsp;to&nbsp;implement&nbsp;it.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;That&nbsp;does&nbsp;sound&nbsp;interesting,&nbsp;but&nbsp;for&nbsp;my&nbsp;application&nbsp;I&nbsp;think&nbsp;that&nbsp;the&nbsp;current&nbsp;Rabbit&nbsp;implementation&nbsp;will&nbsp;be&nbsp;fast&nbsp;enough&nbsp;since&nbsp;the&nbsp;task&nbsp;is&nbsp;to&nbsp;get&nbsp;a&nbsp;control&nbsp;plane&nbsp;in&nbsp;place&nbsp;and&nbsp;let&nbsp;an&nbsp;underlying&nbsp;IP&nbsp;network&nbsp;carry&nbsp;the&nbsp;heavy&nbsp;duty&nbsp;traffic&nbsp;between&nbsp;users.&lt;br&gt;<br>
&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;The&nbsp;size&nbsp;of&nbsp;your&nbsp;broker&nbsp;cluster&nbsp;will&nbsp;depend&nbsp;(amongst&nbsp;other&nbsp;factors)&nbsp;on&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;the&nbsp;amount&nbsp;of&nbsp;messages&nbsp;you&nbsp;need&nbsp;the&nbsp;system&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;A&nbsp;system&nbsp;today&nbsp;consisting&nbsp;of&nbsp;100&nbsp;&amp;quot;consumer&amp;quot;&nbsp;machines&nbsp;plus&nbsp;some&nbsp;inner&lt;br&gt;<br>
&amp;gt;&nbsp;machines&nbsp;handles&nbsp;in&nbsp;the&nbsp;neighbourhood&nbsp;of&nbsp;3,000&nbsp;message&nbsp;per&nbsp;second.&lt;br&gt;<br>
&amp;gt;&nbsp;So&nbsp;when&nbsp;I&nbsp;aim&nbsp;to&nbsp;remove&nbsp;the&nbsp;inner&nbsp;machines&nbsp;that&nbsp;does&nbsp;the&nbsp;most&nbsp;of&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;intelligence&nbsp;regarding&nbsp;routing&nbsp;of&nbsp;the&nbsp;messages&nbsp;I&nbsp;expect&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;inner&nbsp;bottleneck&nbsp;and&nbsp;thus&nbsp;get&nbsp;a&nbsp;higher&nbsp;performance...&nbsp;or&nbsp;at&nbsp;least&nbsp;one&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;is&nbsp;closer&nbsp;to&nbsp;the&nbsp;limits&nbsp;of&nbsp;the&nbsp;&amp;quot;consumer&amp;quot;&nbsp;machines&nbsp;which&nbsp;I&nbsp;think&nbsp;is&nbsp;a&nbsp;better&lt;br&gt;<br>
&amp;gt;&nbsp;constraint.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;You&nbsp;may&nbsp;want&nbsp;to&nbsp;check&nbsp;out&nbsp;the&nbsp;performance&nbsp;metrics&nbsp;of&nbsp;a&nbsp;single&nbsp;broker&lt;br&gt;<br>
with&nbsp;a&nbsp;single&nbsp;producer&nbsp;and&nbsp;a&nbsp;single&nbsp;consumer&nbsp;using&nbsp;the&nbsp;ProducerMain&lt;br&gt;<br>
and&nbsp;ConsumerMain&nbsp;test&nbsp;classes&nbsp;from&nbsp;the&nbsp;RabbitMQ&nbsp;Java&nbsp;library,&nbsp;just&nbsp;to&lt;br&gt;<br>
calibrate&nbsp;your&nbsp;expectations&nbsp;for&nbsp;yourself.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Sorry&nbsp;if&nbsp;I&nbsp;sound&nbsp;a&nbsp;bit&nbsp;vague&nbsp;at&nbsp;times&nbsp;but&nbsp;I&nbsp;have&nbsp;only&nbsp;just&nbsp;read&nbsp;about&nbsp;AMQP&lt;br&gt;<br>
&amp;gt;&nbsp;and&nbsp;are&nbsp;now&nbsp;trying&nbsp;to&nbsp;get&nbsp;the&nbsp;concepts&nbsp;for&nbsp;a&nbsp;new&nbsp;AMQP&nbsp;based&nbsp;architecture&nbsp;in&lt;br&gt;<br>
&amp;gt;&nbsp;place.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Not&nbsp;a&nbsp;problem.&nbsp;There&nbsp;are&nbsp;various&nbsp;sources&nbsp;of&nbsp;information&nbsp;about&nbsp;the&lt;br&gt;<br>
concepts&nbsp;of&nbsp;AMQP,&nbsp;not&nbsp;least&nbsp;to&nbsp;mention&nbsp;the&nbsp;specification&nbsp;:-)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;I&nbsp;like&nbsp;the&nbsp;standard&nbsp;-&nbsp;way&nbsp;easier&nbsp;to&nbsp;read&nbsp;than&nbsp;others&nbsp;I&nbsp;have&nbsp;had&nbsp;to&nbsp;deal&nbsp;with&nbsp;in&nbsp;the&nbsp;past...&lt;br&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;Cheers,&lt;br&gt;Torben&lt;br&gt;&lt;/div&gt;<br>

</tt>
