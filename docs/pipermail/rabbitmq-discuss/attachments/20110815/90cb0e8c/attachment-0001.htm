<tt>
Hi,&lt;br&gt;&lt;br&gt;We&amp;#39;ve&nbsp;recently&nbsp;moved&nbsp;over&nbsp;to&nbsp;using&nbsp;RabbitMQ&nbsp;from&nbsp;MSMQ&nbsp;and&nbsp;have&nbsp;generally&nbsp;had&nbsp;success&nbsp;in&nbsp;running&nbsp;RabbitMQ&nbsp;as&nbsp;a&nbsp;windows&nbsp;service&nbsp;on&nbsp;a&nbsp;number&nbsp;of&nbsp;different&nbsp;OSes&nbsp;(XP,&nbsp;Windows2003,&nbsp;Windows&nbsp;7).&lt;br&gt;&lt;br&gt;However,&nbsp;we&amp;#39;ve&nbsp;come&nbsp;across&nbsp;a&nbsp;strange&nbsp;problem&nbsp;when&nbsp;starting&nbsp;up&nbsp;a&nbsp;rabbitMQ&nbsp;service&nbsp;on&nbsp;Windows&nbsp;2003&nbsp;SP2&nbsp;on&nbsp;a&nbsp;VM,&nbsp;using&nbsp;RabbitMQ&nbsp;2.51&nbsp;and&nbsp;Erlang&nbsp;5.8.4.&nbsp;Not&nbsp;sure&nbsp;if&nbsp;the&nbsp;VM&nbsp;aspect&nbsp;is&nbsp;relevant.&nbsp;&lt;br&gt;<br>
&lt;br&gt;Using&nbsp;the&nbsp;rabbitmq-service.bat&nbsp;to&nbsp;install&nbsp;the&nbsp;service,&nbsp;the&nbsp;service&nbsp;(running&nbsp;under&nbsp;the&nbsp;local&nbsp;system&nbsp;account)&nbsp;starts&nbsp;and&nbsp;stops&nbsp;pretty&nbsp;much&nbsp;straight&nbsp;away.&nbsp;Here&amp;#39;s&nbsp;the&nbsp;output&nbsp;from&nbsp;rabbitMQ.debug&lt;br&gt;--&nbsp;rabbit&nbsp;boot&nbsp;start&lt;br&gt;<br>
starting&nbsp;file&nbsp;handle&nbsp;cache&nbsp;server                                    &nbsp;...done&lt;br&gt;starting&nbsp;worker&nbsp;pool                                                 &nbsp;...done&lt;br&gt;starting&nbsp;database                                                    &nbsp;...done&lt;br&gt;<br>
starting&nbsp;codec&nbsp;correctness&nbsp;check                                     &nbsp;...done&lt;br&gt;--&nbsp;external&nbsp;infrastructure&nbsp;ready&lt;br&gt;starting&nbsp;statistics&nbsp;event&nbsp;manager                                    &nbsp;...done&lt;br&gt;starting&nbsp;logging&nbsp;server                                              &nbsp;...done&lt;br&gt;<br>
starting&nbsp;plugin&nbsp;registry                                             &nbsp;...done&lt;br&gt;starting&nbsp;auth&nbsp;mechanism&nbsp;amqplain                                     &nbsp;...done&lt;br&gt;starting&nbsp;auth&nbsp;mechanism&nbsp;cr-demo                                      &nbsp;...done&lt;br&gt;<br>
starting&nbsp;auth&nbsp;mechanism&nbsp;plain                                        &nbsp;...done&lt;br&gt;starting&nbsp;exchange&nbsp;type&nbsp;direct                                        &nbsp;...done&lt;br&gt;starting&nbsp;exchange&nbsp;type&nbsp;fanout                                        &nbsp;...done&lt;br&gt;<br>
starting&nbsp;exchange&nbsp;type&nbsp;headers                                       &nbsp;...done&lt;br&gt;starting&nbsp;exchange&nbsp;type&nbsp;topic                                         &nbsp;...done&lt;br&gt;--&nbsp;kernel&nbsp;ready&lt;br&gt;starting&nbsp;node&nbsp;monitor                                                &nbsp;...done&lt;br&gt;<br>
starting&nbsp;cluster&nbsp;delegate                                            &nbsp;...done&lt;br&gt;starting&nbsp;guid&nbsp;generator                                              &nbsp;...done&lt;br&gt;starting&nbsp;alarm&nbsp;handler                                               &nbsp;...done&lt;br&gt;<br>
starting&nbsp;memory&nbsp;monitor                                              &nbsp;...done&lt;br&gt;--&nbsp;core&nbsp;initialized&lt;br&gt;starting&nbsp;empty&nbsp;DB&nbsp;check                                              &nbsp;...done&lt;br&gt;starting&nbsp;exchange,&nbsp;queue&nbsp;and&nbsp;binding&nbsp;recovery                        &nbsp;...done&lt;br&gt;<br>
--&nbsp;message&nbsp;delivery&nbsp;logic&nbsp;ready&lt;br&gt;starting&nbsp;error&nbsp;log&nbsp;relay                                             &nbsp;...done&lt;br&gt;starting&nbsp;networking                                                  &nbsp;...BOOT&nbsp;ERROR:&nbsp;FAILED&lt;br&gt;Reason:&nbsp;{badmatch,&lt;br&gt;<br>
           &nbsp;{error,&lt;br&gt;               &nbsp;{shutdown,&lt;br&gt;                   &nbsp;{child,undefined,&amp;#39;rabbit_tcp_listener_sup_0.0.0.0:5672&amp;#39;,&lt;br&gt;                       &nbsp;{tcp_listener_sup,start_link,&lt;br&gt;                           &nbsp;[{0,0,0,0},&lt;br&gt;<br>
                            &nbsp;5672,&lt;br&gt;                            &nbsp;[inet,binary,&lt;br&gt;                             &nbsp;{packet,raw},&lt;br&gt;                             &nbsp;{reuseaddr,true},&lt;br&gt;                             &nbsp;{backlog,128},&lt;br&gt;<br>
                             &nbsp;{nodelay,true},&lt;br&gt;                             &nbsp;{exit_on_close,false}],&lt;br&gt;                            &nbsp;{rabbit_networking,tcp_listener_started,[amqp]},&lt;br&gt;                            &nbsp;{rabbit_networking,tcp_listener_stopped,[amqp]},&lt;br&gt;<br>
                            &nbsp;{rabbit_networking,start_client,[]},&lt;br&gt;                            &nbsp;&amp;quot;TCP&nbsp;Listener&amp;quot;]},&lt;br&gt;                       &nbsp;transient,infinity,supervisor,&lt;br&gt;                       &nbsp;[tcp_listener_sup]}}}}&lt;br&gt;<br>
Stacktrace:&nbsp;[{rabbit_networking,start_listener0,4},&lt;br&gt;            &nbsp;{rabbit_networking,&amp;#39;-start_listener/4-lc$^0/1-0-&amp;#39;,4},&lt;br&gt;            &nbsp;{rabbit_networking,start_listener,4},&lt;br&gt;            &nbsp;{rabbit_networking,&amp;#39;-boot_tcp/0-lc$^0/1-0-&amp;#39;,1},&lt;br&gt;<br>
            &nbsp;{rabbit_networking,boot_tcp,0},&lt;br&gt;            &nbsp;{rabbit_networking,boot,0},&lt;br&gt;            &nbsp;{rabbit,&amp;#39;-run_boot_step/1-lc$^1/1-1-&amp;#39;,1},&lt;br&gt;            &nbsp;{rabbit,run_boot_step,1}]&lt;br&gt;in&nbsp;message_loop&lt;br&gt;win32sysinfo:Erlang&nbsp;has&nbsp;closed.Eshell&nbsp;V5.8.4 &nbsp;(abort&nbsp;with&nbsp;^G)&lt;br&gt;<br>
(rabbit@UKFAST-QOB4QITU)1&amp;gt;&nbsp;{&amp;quot;Kernel&nbsp;pid&nbsp;terminated&amp;quot;,application_controller,&amp;quot;{application_start_failure,rabbit,{bad_return,{{rabbit,start,[normal,[]]},{&amp;#39;EXIT&amp;#39;,{rabbit,failure_during_boot}}}}}&amp;quot;}&lt;br&gt;<br>
&lt;br&gt;The&nbsp;port&nbsp;is&nbsp;definitely&nbsp;not&nbsp;in&nbsp;use.&nbsp;Nor&nbsp;is&nbsp;there&nbsp;a&nbsp;firewall&nbsp;enabled.&lt;br&gt;&lt;br&gt;Having&nbsp;looked&nbsp;though&nbsp;the&nbsp;archives&nbsp;we&amp;#39;ve&nbsp;tried&nbsp;passing&nbsp;in&nbsp;sname&nbsp;and&nbsp;name&nbsp;arguments&nbsp;to&nbsp;erl.exe&nbsp;with&nbsp;no&nbsp;luck.&lt;br&gt;&lt;br&gt;The&nbsp;interesting&nbsp;thing&nbsp;is&nbsp;that&nbsp;we&nbsp;can&nbsp;get&nbsp;RabbitMQ&nbsp;to&nbsp;run&nbsp;as&nbsp;an&nbsp;application&nbsp;on&nbsp;this&nbsp;box,&nbsp;using&nbsp;the&nbsp;standard&nbsp;rabbitmq-server.bat.&nbsp;&lt;br&gt;<br>
&lt;br&gt;After&nbsp;a&nbsp;bit&nbsp;of&nbsp;messing&nbsp;around&nbsp;we&nbsp;also&nbsp;found&nbsp;that&nbsp;if&nbsp;we&nbsp;set &nbsp;&lt;span&nbsp;class=&quot;term&quot;&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Ericsson\Erlang\ErlSrv\1.1\RabbitMQ\Machine&nbsp;to&nbsp;point&nbsp;to&nbsp;D:\Program&nbsp;Files\erl5.8.4\bin\erl.exe&nbsp;rather&nbsp;than&nbsp;D:\Program&nbsp;Files\erl5.8.4\erts-5.8.4\bin\erl.exe&nbsp;then&nbsp;the&nbsp;service&nbsp;also&nbsp;runs.&nbsp;Queues&nbsp;get&nbsp;created&nbsp;and&nbsp;we&nbsp;can&nbsp;successfully&nbsp;publish/subscribe&nbsp;to&nbsp;queues&nbsp;.&lt;br&gt;<br>
&lt;br&gt;Does&nbsp;anyone&nbsp;have&nbsp;any&nbsp;thoughts&nbsp;on&nbsp;why&nbsp;the&nbsp;standard&nbsp;service&nbsp;install&nbsp;would&nbsp;fail&nbsp;but&nbsp;the&nbsp;application&nbsp;and&nbsp;modified&nbsp;install&nbsp;seem&nbsp;to&nbsp;work&nbsp;fine.&lt;br&gt;&lt;br&gt;How&nbsp;safe&nbsp;is&nbsp;it&nbsp;to&nbsp;use&nbsp;erl.exe&nbsp;from&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;term&quot;&gt;erl5.8.4\bin\erl.exe&nbsp;rather&nbsp;than&nbsp;&lt;/span&gt;&lt;span&nbsp;class=&quot;term&quot;&gt;erl5.8.4\erts-5.8.4\bin\erl.exe?&nbsp;i.e&nbsp;is&nbsp;this&nbsp;an&nbsp;acceptable&nbsp;workaround.&lt;br&gt;<br>
&lt;br&gt;Thanks&nbsp;in&nbsp;advance&nbsp;for&nbsp;any&nbsp;help.&lt;br&gt;&lt;br&gt;Regards&lt;br&gt;&lt;br&gt;Richard&lt;br&gt;&lt;br&gt;&lt;/span&gt;
</tt>
