<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7654.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;losing&nbsp;messages&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/rtf&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;COLOR=&quot;#1F497D&quot;&nbsp;FACE=&quot;Calibri&quot;&gt;Perhaps&nbsp;there&nbsp;is&nbsp;something&nbsp;wrong&nbsp;with&nbsp;my&nbsp;consumer&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;COLOR=&quot;#1F497D&quot;&nbsp;FACE=&quot;Calibri&quot;&gt;&amp;#8230;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;COLOR=&quot;#1F497D&quot;&nbsp;FACE=&quot;Calibri&quot;&gt;Here&nbsp;is&nbsp;the&nbsp;python&nbsp;code&nbsp;:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;fr-ca&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;MG&nbsp;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;fr-ca&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;import&nbsp;amqplib.client_0_8&nbsp;as&nbsp;amqp&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;import&nbsp;os,sys,time&lt;/FONT&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;machine&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;sys.argv[1]&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;user&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;&amp;quot;anonymous&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;passwd&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;&amp;quot;anonymous&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;exchange_realm&nbsp;=&nbsp;&amp;quot;/data&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;exchange_name&amp;nbsp;&nbsp;=&nbsp;&amp;quot;cmc&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;exchange_type&amp;nbsp;&nbsp;=&nbsp;&amp;quot;topic&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;being&nbsp;notified&nbsp;for&nbsp;all&nbsp;URLs&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;exchange_key&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;&amp;quot;exp.dd.notify.#&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#exchange_key&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;&amp;quot;exp.dd.notify.radar.PRECIP.GIF.WBI&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;being&nbsp;notified&nbsp;for&nbsp;a&nbsp;reception&nbsp;in&nbsp;&lt;A&nbsp;HREF=&quot;http://weather.gc.ca/radar/CAPPI/GIF/XAM&quot;&gt;http://weather.gc.ca/radar/CAPPI/GIF/XAM&lt;/A&gt;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#exchange_key&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;&amp;quot;exp.dd.notify.radar.CAPPI.GIF.XAM&amp;quot;&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;connection&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;connection&nbsp;=&nbsp;amqp.Connection(&nbsp;machine,userid=user,password=passwd,ssl=False)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;channel&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;connection.channel()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;exchange&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;channel.access_request(exchange_realm,&nbsp;active=True,&nbsp;read=True)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;channel.exchange_declare(exchange_name,&nbsp;exchange_type,&nbsp;auto_delete=True)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;queue&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;_queuename,&nbsp;message_count,&nbsp;consumer_count&nbsp;=&nbsp;channel.queue_declare()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;channel.queue_bind(_queuename,&nbsp;exchange_name,&nbsp;exchange_key)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;amqp&nbsp;callback&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;def&nbsp;amqp_callback(msg):&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;hdr&nbsp;=&nbsp;msg.properties['application_headers']&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;filename&nbsp;=&nbsp;hdr['filename']&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;msg.channel.basic_ack(msg.delivery_tag)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;Cancel&nbsp;this&nbsp;callback&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;msg.body&nbsp;==&nbsp;'quit':&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;msg.channel.basic_cancel(msg.consumer_tag)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.msg&nbsp;=&nbsp;None&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.logger.error('CRITICAL&nbsp;ERROR...')&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.logger.error('Requiered&nbsp;to&nbsp;quit&nbsp;the&nbsp;connection')&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;sys.exit(1)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;send&nbsp;url&nbsp;to&nbsp;user&nbsp;callback&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;user_callback(msg.body)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;###################################&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;user&nbsp;callback&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;###################################&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;def&nbsp;user_callback(url):&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;t&nbsp;=&nbsp;time.strftime(&amp;quot;%Y%m%d&nbsp;%H:%M:%S&amp;quot;,time.gmtime())&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print(&amp;quot;%s&nbsp;%s&amp;quot;&nbsp;%&nbsp;(t,url))&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;amqp&nbsp;callback&nbsp;activation&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;channel.basic_consume(_queuename,&nbsp;callback=amqp_callback)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;Wait&nbsp;for&nbsp;things&nbsp;to&nbsp;arrive&nbsp;on&nbsp;the&nbsp;queue&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;while&nbsp;True:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;try:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.wait()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;except:&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.close()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;connection.close()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;sys.exit(1)&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;close&nbsp;connections&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;channel.close()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;connection.close()&lt;/FONT&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-ca&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;UL&nbsp;DIR=LTR&gt;&lt;UL&nbsp;DIR=LTR&gt;<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-ca&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
&lt;/UL&gt;&lt;/UL&gt;<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;SPAN&nbsp;LANG=&quot;en-ca&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;P&nbsp;DIR=LTR&gt;&lt;SPAN&nbsp;LANG=&quot;en-us&quot;&gt;&lt;/SPAN&gt;&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
