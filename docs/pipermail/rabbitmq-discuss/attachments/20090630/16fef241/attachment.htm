<tt>
Hi&nbsp;all&nbsp;and&nbsp;thank&nbsp;you&nbsp;for&nbsp;the&nbsp;Erlang&nbsp;Factory&nbsp;talks&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;tried&nbsp;to&nbsp;implement&nbsp;a&nbsp;very&nbsp;basic&nbsp;erlang&nbsp;tcp&nbsp;server&nbsp;which&nbsp;accepts&nbsp;requests&nbsp;and&nbsp;forwards&nbsp;everything&nbsp;to&nbsp;rabbitmq&nbsp;exchanges.&nbsp;This&nbsp;is&nbsp;meant&nbsp;to&nbsp;be&nbsp;a&nbsp;workaround&nbsp;the&nbsp;lack&nbsp;of&nbsp;a&nbsp;0.8&nbsp;C&nbsp;client,&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;get&nbsp;Postgresql&nbsp;to&nbsp;send&nbsp;notifications&nbsp;through&nbsp;rabbitmq.&nbsp;Things&nbsp;work&nbsp;as&nbsp;expected&nbsp;up&nbsp;to&nbsp;a&nbsp;point,&nbsp;until&nbsp;I&nbsp;get&nbsp;&lt;br&gt;<br>
&lt;br&gt;{{badmatch,{error,emfile}},[{cinumber_daemon,connect,1}]}&lt;br&gt;&lt;br&gt;followed&nbsp;by&lt;br&gt;&lt;br&gt;Broker&nbsp;forced&nbsp;connection:&nbsp;541&nbsp;-&amp;gt;&nbsp;&amp;lt;&amp;lt;&amp;quot;INTERNAL_ERROR&amp;quot;&amp;gt;&amp;gt;&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;pretty&nbsp;much&nbsp;an&nbsp;Erlang&nbsp;newbie,&nbsp;so&nbsp;please&nbsp;forgive&nbsp;me&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;really&nbsp;a&nbsp;rabbitmq&nbsp;issue.&nbsp;This&nbsp;could&nbsp;be&nbsp;useful&nbsp;to&nbsp;others,&nbsp;too.&lt;br&gt;<br>
&lt;br&gt;cheers,&nbsp;Michael&lt;br&gt;&lt;br&gt;Here&nbsp;is&nbsp;the&nbsp;relevant&nbsp;part&nbsp;of&nbsp;the&nbsp;code&nbsp;(I&nbsp;am&nbsp;certain&nbsp;recv_loop&nbsp;terminates):&lt;br&gt;recv_loop&nbsp;also&nbsp;does&nbsp;all&nbsp;the&nbsp;rabbity&nbsp;stuff&nbsp;(closes&nbsp;channel,&nbsp;closes&nbsp;connection)&lt;br&gt;&lt;br&gt;--------------------------------------------------------------------------------------------------&lt;br&gt;<br>
&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:&nbsp;40px;&quot;&gt;start_server()&nbsp;-&amp;gt;&lt;br&gt;   &nbsp;%&nbsp;start&nbsp;up&nbsp;the&nbsp;service&nbsp;and&nbsp;error&nbsp;out&nbsp;if&nbsp;we&nbsp;cannot&lt;br&gt;   &nbsp;case&nbsp;gen_tcp:listen(?LISTEN_PORT,&nbsp;?TCP_OPTS)&nbsp;of&lt;br&gt;       &nbsp;{ok,&nbsp;Listen}&nbsp;-&amp;gt;&lt;br&gt;           &nbsp;spawn(?MODULE,&nbsp;connect,&nbsp;[Listen]),&lt;br&gt;<br>
           &nbsp;io:format(&amp;quot;~p&nbsp;Server&nbsp;Started.~n&amp;quot;,&nbsp;[erlang:localtime()]),&lt;br&gt;<br>
           &nbsp;sleep(infinity);&lt;br&gt;       &nbsp;Error&nbsp;-&amp;gt;&lt;br&gt;           &nbsp;io:format(&amp;quot;Error:&nbsp;~p~n&amp;quot;,&nbsp;[Error])&lt;br&gt;   &nbsp;end.&lt;br&gt;&lt;br&gt;connect(Listen)&nbsp;-&amp;gt;&lt;br&gt;   &nbsp;{ok,&nbsp;Socket}&nbsp;=&nbsp;gen_tcp:accept(Listen),&lt;br&gt;   &nbsp;inet:setopts(Socket,&nbsp;?TCP_OPTS),&lt;br&gt;<br>
<br>
   &nbsp;%&nbsp;kick&nbsp;off&nbsp;another&nbsp;process&nbsp;to&nbsp;handle&nbsp;connections&nbsp;concurrently&lt;br&gt;   &nbsp;spawn(fun()&nbsp;-&amp;gt;&nbsp;connect(Listen)&nbsp;end),&lt;br&gt;   &nbsp;recv_loop(Socket),&lt;br&gt;   &nbsp;gen_tcp:close(Socket),&lt;br&gt;   &nbsp;exit(normal).&lt;br&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
