<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hello,&nbsp;Matthias!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;07/30/2012&nbsp;11:52&nbsp;AM,&nbsp;Matthias&nbsp;Radestock&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:50165947.4070609@rabbitmq.com&quot;&nbsp;type=&quot;cite&quot;&gt;Anton,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;29/07/12&nbsp;21:59,&nbsp;anton&nbsp;prokofiev&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;On&nbsp;Sunday,&nbsp;29&nbsp;July&nbsp;2012&nbsp;21:21:06&nbsp;UTC+2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;anton&nbsp;prokofiev&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;I&nbsp;tried&nbsp;to&nbsp;create&amp;nbsp;&nbsp;a&nbsp;consumer&nbsp;in&nbsp;Erlang&nbsp;for&nbsp;RabbitMQ&nbsp;and&nbsp;get<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;big&nbsp;troubles.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Looks&nbsp;like&nbsp;examples&nbsp;that&nbsp;are&nbsp;available&nbsp;in&nbsp;RabbitMQ&nbsp;website<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;did&nbsp;not&nbsp;work.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*Which*&nbsp;example&nbsp;didn't&nbsp;work?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;seams&nbsp;to&nbsp;me&nbsp;that&amp;nbsp;&nbsp;this&nbsp;one&nbsp;did&nbsp;not&nbsp;work:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;sourcecode&quot;&gt;Sub&nbsp;=&nbsp;#'basic.consume'{queue&nbsp;=&nbsp;Q},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#'basic.consume_ok'{consumer_tag&nbsp;=&nbsp;Tag}&nbsp;=&nbsp;amqp_channel:call(Channel,&nbsp;Sub)&nbsp;%%&nbsp;the&nbsp;caller&nbsp;is&nbsp;the&nbsp;subscriber<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;font&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman,&nbsp;Times,&nbsp;serif&quot;&gt;At&nbsp;&lt;/font&gt;least&nbsp;I&nbsp;do&nbsp;not<br>
&nbsp;&nbsp;&nbsp;&nbsp;managed&nbsp;to&nbsp;force&nbsp;it&nbsp;to&nbsp;work.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;another&nbsp;one,&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;sourcecode&quot;&gt;Sub&nbsp;=&nbsp;#'basic.consume'{queue&nbsp;=&nbsp;Q},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#'basic.consume_ok'{consumer_tag&nbsp;=&nbsp;Tag}&nbsp;=&nbsp;amqp_channel:subscribe(Channel,&nbsp;Sub,&nbsp;Consumer)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;was&nbsp;not&nbsp;clear&nbsp;to&nbsp;me&nbsp;what&nbsp;should&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;consumer,&nbsp;as&nbsp;final<br>
&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;contains&nbsp;only&nbsp;case&nbsp;when&nbsp;we&nbsp;use&nbsp;*#'basic.get'*&nbsp;command.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;I&nbsp;understood&nbsp;it&nbsp;correctly,&nbsp;I&nbsp;should&nbsp;pass&nbsp;a&nbsp;PID&nbsp;of&nbsp;the&nbsp;consumer<br>
&nbsp;&nbsp;&nbsp;&nbsp;process,&nbsp;when&nbsp;I&amp;nbsp;&nbsp;open&nbsp;channel:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tt&gt;amqp_connection:open_channel(Connection,none,*{amqp_direct_consumer,[Pid]}*),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tt&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Unfortunately&nbsp;I&nbsp;can&nbsp;not&nbsp;found&nbsp;this&nbsp;in&nbsp;the&nbsp;documentation,&nbsp;or&nbsp;may&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;was&nbsp;not&nbsp;clearly&nbsp;enough&nbsp;pointed&nbsp;out.&nbsp;:(&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;should&nbsp;say&nbsp;that&nbsp;I&amp;nbsp;&nbsp;have&nbsp;not&nbsp;too&nbsp;much&nbsp;experience&nbsp;with&nbsp;erlang,&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;just&nbsp;started&nbsp;to&nbsp;work&nbsp;with&nbsp;rabbitMQ.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Another&nbsp;problem&nbsp;is&nbsp;that&nbsp;RabbitMQ&nbsp;broker&nbsp;I&nbsp;work&nbsp;with&nbsp;is&nbsp;out&nbsp;of&nbsp;my<br>
&nbsp;&nbsp;&nbsp;&nbsp;control&nbsp;and&nbsp;documentation&nbsp;that&nbsp;I&nbsp;have&nbsp;really&nbsp;misleading.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;a&nbsp;result&nbsp;I&nbsp;have&nbsp;to&nbsp;use&nbsp;try-and-error&nbsp;approach&nbsp;to&nbsp;develop&nbsp;my<br>
&nbsp;&nbsp;&nbsp;&nbsp;application.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:50165947.4070609@rabbitmq.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Looks&nbsp;like&nbsp;I&nbsp;have&nbsp;found&nbsp;a&nbsp;correct<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solution:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;I&nbsp;have&nbsp;implemented&nbsp;simple&nbsp;gen_server,&nbsp;that&nbsp;just&nbsp;print&nbsp;all<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;stdout.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;And&amp;nbsp;&nbsp;to&nbsp;like&nbsp;this:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{ok,Connection}&nbsp;=&nbsp;amqp_connection:start(ConnectionParams),&nbsp;%<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;with&nbsp;predefined&nbsp;params.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{ok,Pid}&nbsp;=&amp;nbsp;&nbsp;test_srv:start_link(),&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;%&nbsp;Start&nbsp;our&nbsp;own<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consumer.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ok,Channel}&amp;nbsp;&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
amqp_connection:open_channel(Connection,none,*{amqp_direct_consumer,[Pid]}*),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;above&nbsp;creates&nbsp;a&nbsp;channel&nbsp;with&nbsp;a&nbsp;default&nbsp;consumer.&nbsp;More<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typically&nbsp;you'd&nbsp;associate&nbsp;consumers&nbsp;with&nbsp;particular&nbsp;subscriptions,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;shown&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.rabbitmq.com/erlang-client-user-guide.html#subscribing&quot;&gt;http://www.rabbitmq.com/erlang-client-user-guide.html#subscribing&lt;/a&gt;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Would&nbsp;it&nbsp;be&nbsp;better&nbsp;to&nbsp;create&nbsp;my&nbsp;own<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implementation&nbsp;of&nbsp;consume&nbsp;behavior,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;handle&nbsp;them&nbsp;thought&nbsp;the&nbsp;message_info&nbsp;as&nbsp;it&nbsp;is&nbsp;now?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Any&nbsp;recommendations?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementing&nbsp;your&nbsp;own&nbsp;instance&nbsp;of&nbsp;the&nbsp;amqp_gen_consumer&nbsp;behaviour<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;probably&nbsp;the&nbsp;more&nbsp;&quot;correct&quot;&nbsp;approach,&nbsp;but&nbsp;it's&nbsp;a&nbsp;bit&nbsp;more&nbsp;work<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;if&nbsp;the&nbsp;behaviour&nbsp;of&nbsp;the&nbsp;amqp_direct_consumer&nbsp;fits&nbsp;in&nbsp;well&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;rest&nbsp;of&nbsp;your&nbsp;system&nbsp;design&nbsp;then&nbsp;just&nbsp;use&nbsp;that.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Regards,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matthias.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
