<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;You&amp;#39;re&nbsp;aware&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;eager&nbsp;synchronisation&nbsp;of&nbsp;HA&nbsp;queues,&nbsp;yes?&lt;/div&gt;<br>
<br>
So&nbsp;it&amp;#39;s&nbsp;only&nbsp;by&nbsp;the&nbsp;unsynchronised&nbsp;head&nbsp;of&nbsp;each&nbsp;queue&nbsp;being&nbsp;consumed&lt;br&gt;<br>
that&nbsp;synchronisation&nbsp;occurs.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yes,&nbsp;I&nbsp;allow&nbsp;this&nbsp;to&nbsp;happen.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
Did&nbsp;the&nbsp;previously&nbsp;downed&nbsp;node&nbsp;really&nbsp;come&nbsp;back&nbsp;up&nbsp;and&nbsp;join&nbsp;the&nbsp;cluster&lt;/div&gt;<br>
correctly?&nbsp;Does&nbsp;the&nbsp;output&nbsp;of&nbsp;rabbitmqctl&nbsp;cluster_status&nbsp;on&nbsp;each&nbsp;of&nbsp;the&lt;br&gt;<br>
3&nbsp;nodes&nbsp;report&nbsp;all&nbsp;3&nbsp;nodes&nbsp;are&nbsp;running?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;couldn&amp;#39;t&nbsp;tell&nbsp;you&nbsp;that&nbsp;without&nbsp;starting&nbsp;the&nbsp;tests&nbsp;again,&nbsp;but&nbsp;the&nbsp;management&nbsp;plugin&nbsp;reports&nbsp;they&nbsp;are&nbsp;all&nbsp;up,&nbsp;and&nbsp;producers&nbsp;+&nbsp;consumers&nbsp;reconnect&nbsp;to&nbsp;the&nbsp;downed&nbsp;node&nbsp;once&nbsp;it&nbsp;has&nbsp;come&nbsp;back&nbsp;up&nbsp;without&nbsp;problems.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&amp;gt;&nbsp;I&amp;#39;ve&nbsp;also&nbsp;found&nbsp;that&nbsp;sometimes&nbsp;queues&nbsp;stop&nbsp;delivering&nbsp;messages&nbsp;when&nbsp;certain&lt;br&gt;<br>
&amp;gt;&nbsp;nodes&nbsp;go&nbsp;down&nbsp;(even&nbsp;after&nbsp;being&nbsp;left&nbsp;for&nbsp;minutes),&nbsp;despite&nbsp;being&nbsp;in&nbsp;HA&nbsp;mode&lt;br&gt;<br>
&amp;gt;&nbsp;(haven&amp;#39;t&nbsp;been&nbsp;able&nbsp;to&nbsp;dig&nbsp;into&nbsp;this&nbsp;more&nbsp;yet).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;When&nbsp;this&nbsp;happens,&nbsp;could&nbsp;you&nbsp;check&nbsp;the&nbsp;logs&nbsp;please&nbsp;on&nbsp;all&nbsp;nodes&nbsp;for&nbsp;any&lt;br&gt;<br>
entries&nbsp;regarding&nbsp;the&nbsp;queues.&nbsp;If&nbsp;a&nbsp;node&nbsp;with&nbsp;a&nbsp;queue&nbsp;master&nbsp;goes&nbsp;down&lt;br&gt;<br>
then&nbsp;there&nbsp;should&nbsp;be&nbsp;entries&nbsp;about&nbsp;some&nbsp;slave&nbsp;on&nbsp;another&nbsp;node&nbsp;being&lt;br&gt;<br>
promoted,&nbsp;but&nbsp;even&nbsp;if&nbsp;it&amp;#39;s&nbsp;just&nbsp;a&nbsp;slave&nbsp;that&nbsp;dies,&nbsp;there&nbsp;should&nbsp;be&lt;br&gt;<br>
entries&nbsp;in&nbsp;the&nbsp;logs&nbsp;that&nbsp;show&nbsp;others&nbsp;have&nbsp;noticed&nbsp;that.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yes,&nbsp;will&nbsp;look&nbsp;for&nbsp;that.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&amp;gt;&nbsp;Sometimes&nbsp;connections&nbsp;to&nbsp;nodes&nbsp;which&nbsp;have&nbsp;gone&nbsp;down&nbsp;are&nbsp;still&nbsp;shown&lt;br&gt;<br>
&amp;gt;&nbsp;and&nbsp;get&nbsp;stuck. &lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Interesting.&nbsp;That&nbsp;might&nbsp;be&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;mgmt&nbsp;plugin.&nbsp;Does&nbsp;rabbitmqctl&lt;br&gt;<br>
list_connections&nbsp;also&nbsp;show&nbsp;such&nbsp;phantom&nbsp;connections?&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Will&nbsp;check&nbsp;next&nbsp;time&nbsp;I&nbsp;see&nbsp;it&nbsp;-&nbsp;running&nbsp;some&nbsp;more&nbsp;tests&nbsp;this&nbsp;PM.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&amp;gt;&nbsp;Today,&nbsp;while&nbsp;bringing&nbsp;up&nbsp;the&nbsp;cluster&nbsp;from&nbsp;scratch&nbsp;(shutdown&nbsp;all&nbsp;instances,&lt;/div&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&amp;gt;&nbsp;wipe&nbsp;mnesia,&nbsp;restart)&nbsp;I&amp;#39;ve&nbsp;got&nbsp;3&nbsp;nodes&nbsp;running,&nbsp;but&nbsp;an&nbsp;HA&nbsp;queue&nbsp;with&nbsp;1&lt;br&gt;<br>
&amp;gt;&nbsp;master,&nbsp;2&nbsp;synced&nbsp;slaves&nbsp;and&nbsp;1&nbsp;unsynced&nbsp;slave.&nbsp;Other&nbsp;queues&nbsp;are&nbsp;showing&nbsp;1&lt;br&gt;<br>
&amp;gt;&nbsp;master&nbsp;and&nbsp;2&nbsp;synced&nbsp;slaves&nbsp;as&nbsp;expected.&nbsp;(see&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.evernote.com/shard/s53/sh/b6345885-88d1-4d21-9614-24abda75a1cb/c2a0dd265b39d21f3e8c336c67ced979&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.evernote.com/shard/s53/sh/b6345885-88d1-4d21-9614-24abda75a1cb/c2a0dd265b39d21f3e8c336c67ced979&lt;/a&gt;&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Well,&nbsp;drain&nbsp;the&nbsp;&amp;quot;unsynced&amp;quot;&nbsp;queue&nbsp;and&nbsp;it&amp;#39;ll&nbsp;become&nbsp;synced. &lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;My&nbsp;issue&nbsp;here&nbsp;is&nbsp;that&nbsp;for&nbsp;this&nbsp;one&nbsp;queue,&nbsp;it&nbsp;claims&nbsp;to&nbsp;have&nbsp;more&nbsp;copies&nbsp;of&nbsp;the&nbsp;queue&nbsp;than&nbsp;nodes&nbsp;in&nbsp;the&nbsp;cluster.&nbsp;Trying&nbsp;to&nbsp;check&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;plugin&nbsp;bug&nbsp;with&nbsp;list_queues&nbsp;(list_queues&nbsp;name&nbsp;slave_pids&nbsp;synchronised_slave_pids),&nbsp;I&nbsp;can&amp;#39;t&nbsp;get&nbsp;the&nbsp;cluster&nbsp;to&nbsp;list&nbsp;them&nbsp;at&nbsp;all,&nbsp;it&nbsp;just&nbsp;sits&nbsp;there&nbsp;(for&nbsp;the&nbsp;last&nbsp;15&nbsp;minutes).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A&lt;/div&gt;<br>

</tt>
