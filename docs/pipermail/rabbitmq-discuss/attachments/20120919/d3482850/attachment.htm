<tt>
Hi&nbsp;all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;wonder&nbsp;if&nbsp;anyone&nbsp;can&nbsp;help&nbsp;diagnose&nbsp;problems&nbsp;we've&nbsp;been&nbsp;having&nbsp;with&nbsp;our&nbsp;2-node&nbsp;clustered&nbsp;rabbit&nbsp;which&nbsp;sporadically&nbsp;seizes&nbsp;up&nbsp;completely.&nbsp;None&nbsp;of&nbsp;the&nbsp;applications&nbsp;can&nbsp;get&nbsp;through&nbsp;to&nbsp;Rabbit&nbsp;though&nbsp;it&nbsp;is&nbsp;still&nbsp;up&nbsp;and&nbsp;running.&nbsp;CPU&nbsp;and&nbsp;RAM&nbsp;spike&nbsp;up&nbsp;to&nbsp;100%.&nbsp;The&nbsp;Management&nbsp;UI&nbsp;cannot&nbsp;be&nbsp;reached&nbsp;and&nbsp;we&nbsp;end&nbsp;up&nbsp;having&nbsp;to&nbsp;restart&nbsp;the&nbsp;nodes&nbsp;to&nbsp;get&nbsp;service&nbsp;back.&nbsp;Sometimes&nbsp;it&nbsp;does&nbsp;not&nbsp;come&nbsp;back&nbsp;gracefully&nbsp;requiring&nbsp;reboot.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Some&nbsp;stats:&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;Both&nbsp;nodes&nbsp;are&nbsp;4&nbsp;Core&nbsp;8GB&nbsp;RAM&nbsp;CentOS&nbsp;6.2&nbsp;virtual&nbsp;machines,&nbsp;running&nbsp;on&nbsp;VMWare&nbsp;ESXi&nbsp;4.1&nbsp;host.&nbsp;We&nbsp;are&nbsp;running&nbsp;RabbitMQ&nbsp;version&nbsp;2.7.1&nbsp;on&nbsp;Erlang&nbsp;R14B04.&lt;/li&gt;&lt;li&gt;Looking&nbsp;at&nbsp;our&nbsp;metrics&nbsp;right&nbsp;now&nbsp;I&nbsp;see&nbsp;around:&lt;/li&gt;&lt;ul&gt;&lt;li&gt;1000&nbsp;queues&lt;/li&gt;&lt;li&gt;4000&nbsp;channels&lt;/li&gt;&lt;li&gt;8000&nbsp;bindings&lt;/li&gt;&lt;li&gt;16&nbsp;exchanges&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Memory&nbsp;usage,&nbsp;erlang&nbsp;processes,&nbsp;file&nbsp;descriptors,&nbsp;socket&nbsp;descriptors&nbsp;are&nbsp;generally&nbsp;low&nbsp;and&nbsp;healthy&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;17px;&nbsp;&quot;&gt;Analysing&nbsp;errors&nbsp;in&nbsp;the&nbsp;rabbit&nbsp;logs&nbsp;from&nbsp;a&nbsp;recent&nbsp;failure&nbsp;reveals:&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;Before&nbsp;the&nbsp;failure&nbsp;we&nbsp;have&nbsp;a&nbsp;bunch&nbsp;of&nbsp;background&nbsp;errors&nbsp;which&nbsp;may&nbsp;be&nbsp;the&nbsp;fault&nbsp;of&nbsp;our&nbsp;applications&nbsp;like&nbsp;&quot;no&nbsp;binding&nbsp;X&nbsp;between&nbsp;exchange&nbsp;Y&nbsp;in&nbsp;vhost&nbsp;'/'&nbsp;and&nbsp;queue&nbsp;Z&nbsp;in&nbsp;vhost&nbsp;'/'&quot;&lt;/li&gt;&lt;li&gt;As&nbsp;we&nbsp;ramp&nbsp;up&nbsp;to&nbsp;the&nbsp;failure&nbsp;we&nbsp;see&lt;/li&gt;&lt;ul&gt;&lt;li&gt;Two&nbsp;errors&nbsp;like&nbsp;this:&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;span&nbsp;lang=&quot;EN-US&quot;&nbsp;style=&quot;font-size:11.0pt;font-family:<br>
&amp;quot;Calibri&amp;quot;,&amp;quot;sans-serif&amp;quot;;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:<br>
Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;<br>
mso-bidi-font-family:&amp;quot;Times&nbsp;New&nbsp;Roman&amp;quot;;mso-bidi-theme-font:minor-bidi;<br>
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA&quot;&gt;“**<br>
Generic&nbsp;server&nbsp;&amp;lt;0.16813.1677&amp;gt;&nbsp;terminating&amp;nbsp;<br>
**&nbsp;Last&nbsp;message&nbsp;in&nbsp;was&nbsp;{'$gen_cast',&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
{run_backing_queue,rabbit_mirror_queue_master,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
#Fun&amp;lt;rabbit_mirror_queue_master.4.85178772&amp;gt;}}&amp;nbsp;&nbsp;**&nbsp;When&nbsp;Server&nbsp;state&nbsp;==<br>
{lim,0,undefined,false,[],0}&amp;nbsp;&nbsp;**&nbsp;Reason<br>
for&nbsp;termination&nbsp;==&amp;nbsp;&amp;nbsp;&nbsp;**&nbsp;{function_clause,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[{rabbit_limiter,handle_cast,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
[{run_backing_queue,rabbit_mirror_queue_master,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#Fun&amp;lt;rabbit_mirror_queue_master.4.85178772&amp;gt;},&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
{lim,0,undefined,false,[],0}]},&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
{gen_server2,handle_msg,2},&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
{proc_lib,init_p_do_apply,3}]}&amp;nbsp;&nbsp;“&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;15px;&quot;&gt;A&nbsp;handful&nbsp;like&nbsp;this:&lt;/span&gt;&lt;/font&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;15px;&quot;&gt;&lt;span&nbsp;lang=&quot;EN-US&quot;&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;&quot;&gt;“connection<br>
&amp;lt;0.14270.7735&amp;gt;,&nbsp;channel&nbsp;38&nbsp;-&nbsp;error:&amp;nbsp;<br>
{amqp_error,command_invalid,&quot;second&nbsp;'channel.open'<br>
seen&quot;,'channel.open'}&amp;nbsp;&nbsp;“&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;15px;&quot;&gt;A&nbsp;couple&nbsp;of&nbsp;these:&lt;/span&gt;&lt;/font&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;15px;&quot;&gt;&lt;span&nbsp;lang=&quot;EN-US&quot;&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;&quot;&gt;“connection<br>
&amp;lt;0.158.6322&amp;gt;,&nbsp;channel&nbsp;135&nbsp;-&nbsp;error:&amp;nbsp;<br>
{amqp_error,not_found,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
&quot;no&nbsp;queue&nbsp;'InRunning.WebClient.SessionId[l0mpn3egx5n0yj0lbs1hcehj]'<br>
in&nbsp;vhost&nbsp;'/'&quot;,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;<br>
'basic.get'}&amp;nbsp;&nbsp;“&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;font&nbsp;face=&quot;Calibri,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;15px;&quot;&gt;And&nbsp;then&nbsp;all&nbsp;these:&lt;/span&gt;&lt;/font&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.14270.7735&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:59106&nbsp;&amp;nbsp;{inet_error,enotconn}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.14577.1677&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:53163&nbsp;&amp;nbsp;{inet_error,enotconn}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.1520.5487&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:53435&nbsp;&amp;nbsp;{timeout,running}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.158.6322&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:63187&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.17097.1918&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:55161&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.18340.7733&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:52868&nbsp;&amp;nbsp;{inet_error,enotconn}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24514.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:64362&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24518.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:61252&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24524.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:55845&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24528.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:53434&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24532.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:54398&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24536.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:58878&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.24552.6782&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:63155&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.2577.2793&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:52752&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.26105.2580&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:50364&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.27505.6740&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:56170&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.27741.2921&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:54600&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.28602.6323&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:56863&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.30059.3135&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:57078&nbsp;&amp;nbsp;{writer,send_failed,{error,closed}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.5634.2393&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:53807&nbsp;&amp;nbsp;{writer,send_failed,{error,enotconn}}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;li&gt;exception&nbsp;on&nbsp;TCP&nbsp;connection&nbsp;&amp;lt;0.6691.6783&amp;gt;&nbsp;from&nbsp;WWW.XXX.YYY.ZZZ:64363&nbsp;&amp;nbsp;{timeout,blocking}&nbsp;&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;div&gt;Can&nbsp;anyone&nbsp;help?&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ian&lt;/div&gt;
</tt>
