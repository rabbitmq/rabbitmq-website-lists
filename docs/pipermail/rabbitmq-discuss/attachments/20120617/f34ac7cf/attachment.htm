<tt>
I&nbsp;am&nbsp;using&nbsp;the&nbsp;AMQP&nbsp;pecl&nbsp;extension&nbsp;(http://pecl.php.net/package/amqp)&nbsp;for&nbsp;connecting&nbsp;to&nbsp;rabbitMQ&nbsp;from&nbsp;my&nbsp;PHP&nbsp;app.&nbsp;I&nbsp;have&nbsp;the&nbsp;following&nbsp;scripts:&lt;br&gt;&lt;br&gt;producer.php:&lt;br&gt;&lt;br&gt;$cnn&nbsp;=&nbsp;new&nbsp;AMQPConnection();&lt;br&gt;$cnn-&amp;gt;connect();&lt;br&gt;&lt;br&gt;$ch&nbsp;=&nbsp;new&nbsp;AMQPChannel($cnn);&lt;br&gt;&lt;br&gt;$ex&nbsp;=&nbsp;new&nbsp;AMQPExchange($ch);&lt;br&gt;$ex-&amp;gt;setName('ex2');&lt;br&gt;$ex-&amp;gt;setType(AMQP_EX_TYPE_FANOUT);&lt;br&gt;$ex-&amp;gt;declare();&lt;br&gt;&lt;br&gt;$q&nbsp;=&nbsp;new&nbsp;AMQPQueue($ch);&lt;br&gt;$q-&amp;gt;setName('test1243');&lt;br&gt;$q-&amp;gt;setFlags(AMQP_DURABLE);&lt;br&gt;$q-&amp;gt;declare();&lt;br&gt;$q-&amp;gt;bind('ex2',&nbsp;'routing.key');&lt;br&gt;&lt;br&gt;for&nbsp;($i&nbsp;=&nbsp;0;&nbsp;$i&nbsp;&amp;lt;&nbsp;100;&nbsp;$i++)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;$ex-&amp;gt;publish('msg&nbsp;'&nbsp;.&nbsp;($i&nbsp;+1),&nbsp;'routing.key');&lt;br&gt;}&lt;br&gt;&lt;br&gt;The&nbsp;producer&nbsp;publishes&nbsp;100&nbsp;messages.&nbsp;&lt;br&gt;&lt;br&gt;Then&nbsp;I&nbsp;have&nbsp;a&nbsp;consumer.php:&lt;br&gt;&lt;br&gt;$cnn&nbsp;=&nbsp;new&nbsp;AMQPConnection();&lt;br&gt;$cnn-&amp;gt;connect();&lt;br&gt;&lt;br&gt;//&nbsp;Create&nbsp;a&nbsp;channel&lt;br&gt;$ch&nbsp;=&nbsp;new&nbsp;AMQPChannel($cnn);&lt;br&gt;&lt;br&gt;$q&nbsp;=&nbsp;new&nbsp;AMQPQueue($ch);&lt;br&gt;$q-&amp;gt;setName('test1243');&lt;br&gt;$q-&amp;gt;setFlags(AMQP_DURABLE);&lt;br&gt;$q-&amp;gt;declare();&lt;br&gt;$q-&amp;gt;bind('ex2',&nbsp;'routing.key');&lt;br&gt;&lt;br&gt;$ex&nbsp;=&nbsp;new&nbsp;AMQPExchange($ch);&lt;br&gt;$ex-&amp;gt;setName('ex2');&lt;br&gt;$ex-&amp;gt;setType(AMQP_EX_TYPE_FANOUT);&lt;br&gt;$ex-&amp;gt;declare();&lt;br&gt;&lt;br&gt;function&nbsp;processMessage($envelope,&nbsp;$queue)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;echo&nbsp;&quot;Message&nbsp;$i:&nbsp;&quot;&nbsp;.&nbsp;$envelope-&amp;gt;getBody()&nbsp;.&nbsp;&quot;\n&quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;$queue-&amp;gt;ack($envelope-&amp;gt;getDeliveryTag());&lt;br&gt;}&lt;br&gt;&lt;br&gt;$q-&amp;gt;consume(&quot;processMessage&quot;);&lt;br&gt;&lt;br&gt;The&nbsp;consumer&nbsp;just&nbsp;writes&nbsp;the&nbsp;messages&nbsp;to&nbsp;stdout&nbsp;and&nbsp;ackÂ´s&nbsp;them.&nbsp;&lt;br&gt;&lt;br&gt;I&nbsp;used&nbsp;the&nbsp;exchange&nbsp;type&nbsp;fanout,&nbsp;because&nbsp;I&nbsp;want&nbsp;each&nbsp;message&nbsp;from&nbsp;the&nbsp;producer&nbsp;delivered&nbsp;to&nbsp;each&nbsp;consumer.&nbsp;&lt;br&gt;&lt;br&gt;But&nbsp;if&nbsp;I&nbsp;start&nbsp;2&nbsp;consumers&nbsp;the&nbsp;output&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;output&nbsp;consumer1:&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;1&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;3&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;5&lt;br&gt;...&lt;br&gt;&lt;br&gt;output&nbsp;consumer2:&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;2&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;4&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;6&lt;br&gt;Message&nbsp;:&nbsp;msg&nbsp;8&lt;br&gt;...&lt;br&gt;&lt;br&gt;It&nbsp;looks&nbsp;like&nbsp;the&nbsp;messages&nbsp;are&nbsp;distributed&nbsp;using&nbsp;round&nbsp;robin&nbsp;or&nbsp;the&nbsp;like,&nbsp;consumer&nbsp;1&nbsp;gets&nbsp;message&nbsp;1,&nbsp;consumer&nbsp;2&nbsp;gets&nbsp;message&nbsp;2&nbsp;etc.&nbsp;&lt;br&gt;&lt;br&gt;Is&nbsp;fanout&nbsp;the&nbsp;wrong&nbsp;exchange&nbsp;for&nbsp;this?&nbsp;Or&nbsp;is&nbsp;something&nbsp;wrong&nbsp;in&nbsp;my&nbsp;setup&nbsp;code?&lt;br&gt;Defining&nbsp;the&nbsp;routing&nbsp;key&nbsp;is&nbsp;probably&nbsp;usesless&nbsp;as&nbsp;this&nbsp;is&nbsp;ignored&nbsp;in&nbsp;fanout&nbsp;anway,&nbsp;right?&lt;br&gt;&lt;br&gt;
</tt>
