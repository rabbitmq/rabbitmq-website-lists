<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Queues&nbsp;exist&nbsp;(definition&nbsp;wise)&nbsp;on&nbsp;all&nbsp;nodes&nbsp;in&nbsp;a&nbsp;cluster.&nbsp; Messages&nbsp;only&nbsp;existing&nbsp;unless&nbsp;the&nbsp;queue&nbsp;is&nbsp;mirrored&nbsp;on&nbsp;a&nbsp;single&nbsp;node.&nbsp; You&nbsp;can&nbsp;mirror&nbsp;a&nbsp;queue&amp;#39;s&nbsp;messages&nbsp;to&nbsp;N&nbsp;number&nbsp;of&nbsp;cluster&nbsp;nodes.&nbsp; Admin&nbsp;console&nbsp;is&nbsp;an&nbsp;overall&nbsp;view&nbsp;of&nbsp;the&nbsp;cluster,&nbsp;so&nbsp;you&amp;#39;ll&nbsp;see&nbsp;all&nbsp;the&nbsp;available&nbsp;nodes/queues/exchanges/etc.&nbsp; &lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;reason&nbsp;you&amp;#39;d&nbsp;NOT&nbsp;have&nbsp;queues&nbsp;have&nbsp;their&nbsp;messages&nbsp;automatically&nbsp;replicated&nbsp;to&nbsp;other&nbsp;nodes&nbsp;is&nbsp;scaling.&nbsp; If&nbsp;you&nbsp;had&nbsp;a&nbsp;cluster&nbsp;of&nbsp;10&nbsp;machines,&nbsp;and&nbsp;all&nbsp;the&nbsp;machines&nbsp;mirrored,&nbsp;then&nbsp;your&nbsp;message&nbsp;would&nbsp;have&nbsp;to&nbsp;hit&nbsp;all&nbsp;10&nbsp;nodes&nbsp;before&nbsp;being&nbsp;acknowledged&nbsp;(publish&nbsp;confirm&nbsp;situation&nbsp;as&nbsp;I&nbsp;recall).&nbsp; You&nbsp;CAN&nbsp;instead&nbsp;say&nbsp;a&nbsp;queue&nbsp;must&nbsp;be&nbsp;mirrored&nbsp;on&nbsp;N&nbsp;number&nbsp;of&nbsp;nodes,&nbsp;allowing&nbsp;a&nbsp;failover&nbsp;capacity&nbsp;of&nbsp;N. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Rabbit&nbsp;is&nbsp;also&nbsp;a&nbsp;Master-slave&nbsp;write&nbsp;system.&nbsp;Only&nbsp;ONE&nbsp;node&nbsp;in&nbsp;a&nbsp;cluster&nbsp;is&nbsp;the&nbsp;&amp;quot;master&amp;quot;.&nbsp; Other&nbsp;nodes&nbsp;would&nbsp;be&nbsp;there&nbsp;for&nbsp;failover/scaling&nbsp;support.&nbsp; i.e.&nbsp;queues&nbsp;could&nbsp;be&nbsp;created&nbsp;on&nbsp;any&nbsp;one&nbsp;of&nbsp;the&nbsp;nodes&nbsp;in&nbsp;a&nbsp;cluster&nbsp;to&nbsp;distribute&nbsp;load.&nbsp; In&nbsp;the&nbsp;event&nbsp;of&nbsp;a&nbsp;failure&nbsp;on&nbsp;the&nbsp;master,&nbsp;a&nbsp;slave&nbsp;node&nbsp;would&nbsp;take&nbsp;over&nbsp;the&nbsp;masters&nbsp;position.&nbsp; When&nbsp;the&nbsp;old&nbsp;master&nbsp;comes&nbsp;on&nbsp;line,&nbsp;it&nbsp;becomes&nbsp;a&nbsp;slave,&nbsp;but&nbsp;unless&nbsp;you&nbsp;have&nbsp;3.1&nbsp;and&nbsp;auto&nbsp;healing&nbsp;type&nbsp;stuff,&nbsp;it&nbsp;would&nbsp;only&nbsp;get&nbsp;messages&nbsp;as&nbsp;of&nbsp;the&nbsp;time&nbsp;it&nbsp;has&nbsp;recovered,&nbsp;leaving&nbsp;an&nbsp;indeterminate&nbsp;amount&nbsp;of&nbsp;time&nbsp;before&nbsp;it&nbsp;goes&nbsp;back&nbsp;into&nbsp;sync.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Further,&nbsp;if&nbsp;clients&nbsp;do&nbsp;auto&nbsp;queue&nbsp;creation,&nbsp;it&nbsp;can&nbsp;get&nbsp;even&nbsp;more&nbsp;complex/diverse.&nbsp; RabbitMQ&nbsp;makes&nbsp;messaging&nbsp;pretty&nbsp;simple&nbsp;but&nbsp;architecting&nbsp;it&nbsp;right&nbsp;and&nbsp;true&nbsp;understanding&nbsp;is&nbsp;a&nbsp;much&nbsp;bigger&nbsp;issue.&nbsp; &lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Jason&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;14,&nbsp;2013&nbsp;at&nbsp;10:37&nbsp;AM,&nbsp;Girish&nbsp;Gangadharan&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:girish@giri.sh&quot;&nbsp;target=&quot;_blank&quot;&gt;girish@giri.sh&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Thanks&nbsp;for&nbsp;your&nbsp;reply.&nbsp;Please&nbsp;see&nbsp;my&nbsp;response&nbsp;in&nbsp;red.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;14,&nbsp;2013&nbsp;at&nbsp;4:03&nbsp;AM,&nbsp;Emile&nbsp;Joubert&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;br&gt;<br>
Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;13/06/13&nbsp;20:41,&nbsp;Girish&nbsp;Gangadharan&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;For&nbsp;example,&nbsp;if&nbsp;a&nbsp;publisher&nbsp;writes&nbsp;a&nbsp;message&nbsp;to&nbsp;an&nbsp;exchange&nbsp;that&nbsp;ends&lt;br&gt;<br>
&amp;gt;&nbsp;up&nbsp;in&nbsp;a&nbsp;specific&nbsp;queue&nbsp;bound&nbsp;to&nbsp;that&nbsp;exchange,&nbsp;it&nbsp;immediately&nbsp;shows&lt;br&gt;<br>
&amp;gt;&nbsp;up&nbsp;in&nbsp;the&nbsp;same&nbsp;queue&nbsp;on&nbsp;the&nbsp;other&nbsp;node.&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;is&nbsp;only&nbsp;one&nbsp;queue&nbsp;on&nbsp;one&nbsp;node&nbsp;in&nbsp;this&nbsp;case.&nbsp;The&nbsp;cluster&nbsp;offers&nbsp;a&lt;br&gt;<br>
consistent&nbsp;view&nbsp;of&nbsp;all&nbsp;resources&nbsp;in&nbsp;the&nbsp;cluster&nbsp;and&nbsp;allows&nbsp;producers&nbsp;and&lt;br&gt;<br>
consumers&nbsp;to&nbsp;connect&nbsp;to&nbsp;any&nbsp;node.&nbsp;Messages&nbsp;are&nbsp;transparently&nbsp;routed&lt;br&gt;<br>
across&nbsp;the&nbsp;cluster.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#cc0000&quot;&gt;Does&nbsp;this&nbsp;mean&nbsp;that&nbsp;the&nbsp;queues&nbsp;actually&nbsp;exist&nbsp;only&nbsp;in&nbsp;one&nbsp;node&nbsp;to&nbsp;whose&nbsp;exchange&nbsp;the&nbsp;message&nbsp;was&nbsp;originally&nbsp;written&nbsp;to?&nbsp;And&nbsp;the&nbsp;fact&nbsp;that&nbsp;I&nbsp;can&nbsp;see&nbsp;them&nbsp;in&nbsp;the&nbsp;admin&nbsp;console&nbsp;of&nbsp;the&nbsp;other&nbsp;node&nbsp;is&nbsp;just&nbsp;to&nbsp;provide&nbsp;a&nbsp;consistent&nbsp;view&nbsp;across&nbsp;the&nbsp;cluster?&nbsp;So&nbsp;any&nbsp;action&nbsp;that&nbsp;I&nbsp;do&nbsp;with&nbsp;the&nbsp;original&nbsp;queue&nbsp;on&nbsp;the&nbsp;other&nbsp;nodes&amp;#39;&nbsp;admin&nbsp;consoles&nbsp;basically&nbsp;makes&nbsp;the&nbsp;changes&nbsp;to&nbsp;the&nbsp;queue&nbsp;on&nbsp;the&nbsp;original&nbsp;node&nbsp;and&nbsp;not&nbsp;to&nbsp;the&nbsp;copy&nbsp;of&nbsp;that&nbsp;queue&nbsp;on&nbsp;the&nbsp;other&nbsp;nodes?&nbsp;In&nbsp;fact,&nbsp;if&nbsp;I&nbsp;understand&nbsp;you&nbsp;correctly,&nbsp;there&nbsp;IS&nbsp;no&nbsp;copy&nbsp;of&nbsp;the&nbsp;queue&nbsp;on&nbsp;the&nbsp;other&nbsp;nodes?&nbsp;Did&nbsp;I&nbsp;get&nbsp;that&nbsp;right?&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#cc0000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#cc0000&quot;&gt;Not&nbsp;sure&nbsp;I&nbsp;understand&nbsp;the&nbsp;consistent&nbsp;view&nbsp;explanation&nbsp;either?&nbsp;What&nbsp;are&nbsp;the&nbsp;main&nbsp;benefits&nbsp;of&nbsp;having&nbsp;multiple&nbsp;nodes&nbsp;in&nbsp;a&nbsp;cluster&nbsp;if&nbsp;they&nbsp;can&amp;#39;t&nbsp;really&nbsp;share&nbsp;anything?&nbsp;I&nbsp;would&nbsp;think&nbsp;Mirrored&nbsp;Queues&nbsp;should&nbsp;be&nbsp;an&nbsp;automatic&nbsp;by-product&nbsp;of&nbsp;clustering,&nbsp;thus&nbsp;offering&nbsp;HA&nbsp;out&nbsp;of&nbsp;the&nbsp;box.&nbsp;Can&nbsp;you&nbsp;explain&nbsp;to&nbsp;me&nbsp;why&nbsp;somebody&nbsp;would&nbsp;create&nbsp;a&nbsp;cluster&nbsp;of&nbsp;nodes&nbsp;and&nbsp;NOT&nbsp;have&nbsp;mirrored&nbsp;queues&nbsp;set&nbsp;up?&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;But&nbsp;then&nbsp;why&nbsp;does&nbsp;the&nbsp;article&nbsp;on&nbsp;Mirrored&nbsp;Queues&nbsp;say&nbsp;that&nbsp;*you&nbsp;have&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;explicitly&nbsp;set&nbsp;up&nbsp;mirrored&nbsp;queues&nbsp;by&nbsp;policy*?&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;a&nbsp;queue&nbsp;exists&nbsp;on&nbsp;only&nbsp;one&nbsp;node&nbsp;and&nbsp;that&nbsp;node&nbsp;crashes&nbsp;then&nbsp;the&nbsp;queue&lt;br&gt;<br>
becomes&nbsp;unavailable.&nbsp;Mirrored&nbsp;queues&nbsp;provides&nbsp;resilience&nbsp;by&nbsp;maintaining&lt;br&gt;<br>
copies&nbsp;of&nbsp;the&nbsp;queue&nbsp;that&nbsp;can&nbsp;take&nbsp;over&nbsp;in&nbsp;case&nbsp;a&nbsp;node&nbsp;crashes.&nbsp;See&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/ha.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/ha.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;So&nbsp;if&nbsp;one&nbsp;node&nbsp;goes&nbsp;down,&nbsp;the&nbsp;load&nbsp;balancer&nbsp;would&nbsp;automatically&lt;br&gt;<br>
&amp;gt;&nbsp;redirect&nbsp;all&nbsp;the&nbsp;traffic&nbsp;just&nbsp;to&nbsp;the&nbsp;node&nbsp;that&nbsp;is&nbsp;up&nbsp;and&nbsp;running.&nbsp;And&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;clients&nbsp;will&nbsp;not&nbsp;be&nbsp;affected.&nbsp;Would&nbsp;that&nbsp;work?&nbsp;Is&nbsp;that&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;recommended&nbsp;approach?&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;is&nbsp;a&nbsp;common&nbsp;approach.&nbsp;Another&nbsp;is&nbsp;to&nbsp;provide&nbsp;clients&nbsp;with&nbsp;reconnect&lt;br&gt;<br>
logic&nbsp;that&nbsp;allows&nbsp;them&nbsp;to&nbsp;select&nbsp;the&nbsp;alternative&nbsp;node&nbsp;when&nbsp;one&nbsp;node&nbsp;crashes.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;was&nbsp;thinking&nbsp;about&nbsp;using&nbsp;Shoveling&nbsp;technique&nbsp;to&nbsp;push&nbsp;messages&nbsp;from&lt;br&gt;<br>
&amp;gt;&nbsp;a&nbsp;logical&nbsp;broker&nbsp;sitting&nbsp;on&nbsp;a&nbsp;cluster&nbsp;in&nbsp;our&nbsp;local&nbsp;HA&nbsp;servers&nbsp;to&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;different&nbsp;logical&nbsp;broker&nbsp;to&nbsp;the&nbsp;DR&nbsp;server.&nbsp;In&nbsp;this&nbsp;case,&nbsp;a&nbsp;copy&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;messages&nbsp;will&nbsp;keep&nbsp;getting&nbsp;pumped&nbsp;into&nbsp;the&nbsp;DR&nbsp;with&nbsp;no&nbsp;clients&lt;br&gt;<br>
&amp;gt;&nbsp;processing&nbsp;it.&nbsp;What&nbsp;will&nbsp;happen&nbsp;to&nbsp;those&nbsp;messages?&lt;br&gt;<br>
&lt;br&gt;<br>
Nothing&nbsp;will&nbsp;happen&nbsp;to&nbsp;them.&nbsp;They&nbsp;will&nbsp;accumulate&nbsp;in&nbsp;the&nbsp;DR&nbsp;server&lt;br&gt;<br>
unless&nbsp;you&nbsp;take&nbsp;action&nbsp;to&nbsp;remove&nbsp;them,&nbsp;or&nbsp;unless&nbsp;they&nbsp;expire.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Should&nbsp;I&nbsp;have&nbsp;a&nbsp;workflow&nbsp;to&nbsp;go&nbsp;purge&nbsp;them&nbsp;every&nbsp;day&nbsp;manually&nbsp;or&nbsp;via&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;script&nbsp;(after&nbsp;I&nbsp;make&nbsp;sure&nbsp;those&nbsp;messages&nbsp;aren&amp;#39;t&nbsp;needed&nbsp;anymore&nbsp;since&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;clients&nbsp;have&nbsp;already&nbsp;process&nbsp;them&nbsp;from&nbsp;the&nbsp;main&nbsp;HA&nbsp;cluster).&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;depends&nbsp;on&nbsp;the&nbsp;specifics&nbsp;of&nbsp;your&nbsp;disaster&nbsp;scenario,&nbsp;your&nbsp;messaging&lt;br&gt;<br>
pattern&nbsp;and&nbsp;how&nbsp;you&nbsp;plan&nbsp;to&nbsp;switch&nbsp;over&nbsp;to&nbsp;your&nbsp;DR&nbsp;environment.&nbsp;Purging&lt;br&gt;<br>
queues&nbsp;after&nbsp;a&nbsp;day&nbsp;sounds&nbsp;reasonable.&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;the&nbsp;main&nbsp;HA&nbsp;cluster&nbsp;goes&nbsp;down&nbsp;and&nbsp;I&nbsp;have&nbsp;to&nbsp;bring&nbsp;the&nbsp;DR&nbsp;server&nbsp;into&lt;br&gt;<br>
&amp;gt;&nbsp;action,&nbsp;what&nbsp;happens&nbsp;to&nbsp;the&nbsp;messages&nbsp;that&nbsp;did&nbsp;get&nbsp;processed&nbsp;already&nbsp;by&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;clients?&nbsp;Should&nbsp;the&nbsp;clients&nbsp;have&nbsp;logic&nbsp;built&nbsp;in&nbsp;to&nbsp;ignore&nbsp;duplicates&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;handle&nbsp;this&nbsp;specific&nbsp;scenario?&lt;br&gt;<br>
&lt;br&gt;<br>
Performing&nbsp;deduplication&nbsp;in&nbsp;clients&nbsp;is&nbsp;probably&nbsp;the&nbsp;simplest&nbsp;solution,&lt;br&gt;<br>
or&nbsp;you&nbsp;could&nbsp;mirror&nbsp;the&nbsp;effects&nbsp;of&nbsp;consumers&nbsp;removing&nbsp;messages&nbsp;from&lt;br&gt;<br>
queues&nbsp;in&nbsp;your&nbsp;DR&nbsp;environment.&lt;br&gt;<br>
&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-Emile&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;Jason&nbsp;McIntosh&lt;br&gt;&lt;a&nbsp;href=&quot;http://mcintosh.poetshome.com/blog/&quot;&gt;http://mcintosh.poetshome.com/blog/&lt;/a&gt;&lt;br&gt;573-424-7612<br>
&lt;/div&gt;<br>

</tt>
