<tt>
Thank&nbsp;you!,&nbsp;the&nbsp;key&nbsp;combo&nbsp;is&nbsp;ctrl+\&nbsp;and&nbsp;this&nbsp;is&nbsp;what&nbsp;I&nbsp;get.&nbsp;I&nbsp;do&nbsp;not&nbsp;really&nbsp;understand&nbsp;this,&nbsp;so&nbsp;I&nbsp;am&nbsp;very&nbsp;thankful&nbsp;for&nbsp;anything&nbsp;that&nbsp;makes&nbsp;me&nbsp;understand&nbsp;it&nbsp;a&nbsp;little&nbsp;further.&nbsp;I&nbsp;few&nbsp;other&nbsp;threads&nbsp;are&nbsp;running&nbsp;in&nbsp;the&nbsp;application,&nbsp;but&nbsp;they&nbsp;have&nbsp;no&nbsp;interaction&nbsp;with&nbsp;rabbitmq&nbsp;so&nbsp;I&nbsp;wont&nbsp;paste&nbsp;them&nbsp;here,&nbsp;unless&nbsp;they&nbsp;are&nbsp;needed.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;br&gt;This&nbsp;is&nbsp;when&nbsp;execution&nbsp;stops&nbsp;at&nbsp;basicCancel:&lt;br&gt;&lt;br&gt;&amp;quot;Thread-1&amp;quot;&nbsp;prio=10&nbsp;tid=0x00002aaad8001c00&nbsp;nid=0x7e62&nbsp;in&nbsp;Object.wait()&nbsp;[0x0000000041017000..0x0000000041017a90]&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;java.lang.Thread.State:&nbsp;WAITING&nbsp;(on&nbsp;object&nbsp;monitor)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.lang.Object.wait(Native&nbsp;Method)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;waiting&nbsp;on&nbsp;&amp;lt;0x00002aaac931de50&amp;gt;&nbsp;(a&nbsp;com.rabbitmq.utility.BlockingValueOrException)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.lang.Object.wait(Object.java:485)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.utility.BlockingCell.get(BlockingCell.java:58)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;locked&nbsp;&amp;lt;0x00002aaac931de50&amp;gt;&nbsp;(a&nbsp;com.rabbitmq.utility.BlockingValueOrException)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.utility.BlockingCell.uninterruptibleGet(BlockingCell.java:95)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;locked&nbsp;&amp;lt;0x00002aaac931de50&amp;gt;&nbsp;(a&nbsp;com.rabbitmq.utility.BlockingValueOrException)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:41)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:274)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.basicCancel(ChannelN.java:697)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.heysan.analyticsproxy_mq.Consumer.disconnect(Consumer.java:81)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.heysan.analyticsproxy_mq.Controller.exit(Controller.java:109)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.heysan.analyticsproxy_mq.Controller.update(Controller.java:57)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.util.Observable.notifyObservers(Observable.java:142)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.util.Observable.notifyObservers(Observable.java:98)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.heysan.analyticsproxy_mq.Consumer.setExitFlag(Consumer.java:101)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.heysan.analyticsproxy_mq.Consumer.access$200(Consumer.java:18)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.heysan.analyticsproxy_mq.Consumer$2.handleDelivery(Consumer.java:137)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.processAsync(ChannelN.java:188)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel.java:143)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:94)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:445)&lt;br&gt;&lt;br&gt;This&nbsp;is&nbsp;when&nbsp;execution&nbsp;stops&nbsp;at&nbsp;addShutdownListener:&lt;br&gt;<br>
<br>
&lt;br&gt;&amp;quot;Thread-4&amp;quot;&nbsp;prio=10&nbsp;tid=0x000000005cbdf000&nbsp;nid=0x7f36&nbsp;runnable&nbsp;[0x0000000040f16000..0x0000000040f16d10]&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;java.lang.Thread.State:&nbsp;RUNNABLE&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.net.SocketInputStream.socketRead0(Native&nbsp;Method)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.io.BufferedInputStream.fill(BufferedInputStream.java:218)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.io.BufferedInputStream.read(BufferedInputStream.java:237)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;locked&nbsp;&amp;lt;0x00002aaac93076a8&amp;gt;&nbsp;(a&nbsp;java.io.BufferedInputStream)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;java.io.DataInputStream.readUnsignedByte(DataInputStream.java:271)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.Frame.readFrom(Frame.java:111)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.SocketFrameHandler.readFrame(SocketFrameHandler.java:143)&lt;br&gt;<br>
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;locked&nbsp;&amp;lt;0x00002aaac9307670&amp;gt;&nbsp;(a&nbsp;java.io.DataInputStream)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.AMQConnection.readFrame(AMQConnection.java:284)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;at&nbsp;com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:427)&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;11,&nbsp;2008&nbsp;at&nbsp;10:06&nbsp;AM,&nbsp;Holger&nbsp;Hoffstätte&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:holger@wizards.de&quot;&nbsp;target=&quot;_blank&quot;&gt;holger@wizards.de&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&gt;Jonatan&nbsp;Kallus&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;write&nbsp;a&nbsp;java&nbsp;application&nbsp;that&nbsp;can&nbsp;handle&nbsp;the&nbsp;rabbitmq&lt;br&gt;<br>
&amp;gt;&nbsp;server&nbsp;going&nbsp;down&nbsp;and&nbsp;coming&nbsp;back&nbsp;up&nbsp;(or&nbsp;losing&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;server&nbsp;and&nbsp;getting&nbsp;it&nbsp;back).&lt;br&gt;<br>
&lt;/div&gt;[..]&lt;br&gt;<br>
&lt;div&gt;&amp;gt;&nbsp;ConnectionFactory&nbsp;factory&nbsp;=&nbsp;new&nbsp;ConnectionFactory(params);&lt;br&gt;<br>
&amp;gt;&nbsp;connection&nbsp;=&nbsp;factory.newConnection(host,&nbsp;AMQP.PROTOCOL.PORT);&lt;br&gt;<br>
&amp;gt;&nbsp;channel&nbsp;=&nbsp;connection.createChannel();&lt;br&gt;<br>
&amp;gt;&nbsp;channel.accessRequest(this.realm);&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Code&nbsp;above&nbsp;gets&nbsp;run&nbsp;through&nbsp;without&nbsp;any&nbsp;exceptions.&nbsp;But,&nbsp;when&lt;br&gt;<br>
&amp;gt;&nbsp;reconnecting,&nbsp;the&nbsp;execution&nbsp;stops&nbsp;at&nbsp;this&nbsp;line,&nbsp;the&nbsp;method&nbsp;seems&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;never&nbsp;return:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;connection.addShutdownListener(shutdownListener);&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Try&nbsp;to&nbsp;dump&nbsp;a&nbsp;stack&nbsp;trace&nbsp;so&nbsp;we&nbsp;can&nbsp;see&nbsp;who&amp;#39;s&nbsp;calling&nbsp;what.&lt;br&gt;<br>
Easiest&nbsp;to&nbsp;do&nbsp;with&nbsp;jconsole&nbsp;or&nbsp;visualvm,&nbsp;or&nbsp;with&nbsp;the&nbsp;magic&nbsp;key&nbsp;combo&nbsp;that&lt;br&gt;<br>
I&nbsp;cannot&nbsp;remember&nbsp;right&nbsp;now..&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;have&nbsp;once&nbsp;seen&nbsp;addShutdownListener&nbsp;throw&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;ConcurrentModificationException,&nbsp;but&nbsp;the&nbsp;rabbitmq&nbsp;connection&nbsp;is&nbsp;not&lt;br&gt;<br>
&amp;gt;&nbsp;running&nbsp;in&nbsp;a&nbsp;multithreaded&nbsp;environment.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;CME&nbsp;has&nbsp;nothing&nbsp;to&nbsp;do&nbsp;with&nbsp;threading&nbsp;and&nbsp;can&nbsp;also&nbsp;occur&nbsp;e.g.&nbsp;in&nbsp;recursive&lt;br&gt;<br>
code&nbsp;that&nbsp;improperly&nbsp;modifies&nbsp;the&nbsp;iterated&nbsp;collection.&lt;br&gt;<br>
&lt;br&gt;<br>
-h&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
