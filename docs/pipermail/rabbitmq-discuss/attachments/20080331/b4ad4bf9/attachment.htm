<tt>
&lt;div&gt;Matthias,&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;response.&amp;nbsp;&nbsp;I&nbsp;cleared&nbsp;everything&nbsp;in&nbsp;my&nbsp;Mnesia&nbsp;and&nbsp;Log&nbsp;files&nbsp;and&nbsp;restarted&nbsp;the&nbsp;broker.&amp;nbsp;&nbsp;I&nbsp;also&nbsp;changed&nbsp;my&nbsp;props.DeliveryMode&nbsp;=&nbsp;1&nbsp;to&nbsp;make&nbsp;non&nbsp;persistent&nbsp;messages&nbsp;on&nbsp;basicpublish.&amp;nbsp;&amp;nbsp;&amp;nbsp;I&nbsp;also&nbsp;ensured&nbsp;that&nbsp;my&nbsp;basicpublisher&nbsp;closes&nbsp;both&nbsp;the&nbsp;channel&nbsp;and&nbsp;connections&nbsp;properly&nbsp;in&nbsp;the&nbsp;basicpublisher&nbsp;code.&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;I&nbsp;tried&nbsp;running&nbsp;this&nbsp;code&nbsp;on&nbsp;multiple&nbsp;computers&nbsp;and&nbsp;still&nbsp;get&nbsp;the&nbsp;same&nbsp;problem.&amp;nbsp;&nbsp;I&nbsp;also&nbsp;ran&nbsp;it&nbsp;against&nbsp;your&nbsp;dev&nbsp;environment&nbsp;hoping&nbsp;that&nbsp;maybe&nbsp;it&nbsp;was&nbsp;a&nbsp;problem&nbsp;with&nbsp;my&nbsp;installed&nbsp;broker&nbsp;but&nbsp;it&nbsp;still&nbsp;did&nbsp;not&nbsp;work.&amp;nbsp;&nbsp;Earlier&nbsp;today&nbsp;I&nbsp;also&nbsp;took&nbsp;the&nbsp;SimpleSubscriber&nbsp;Java&nbsp;solution&nbsp;and&nbsp;build&nbsp;that&nbsp;sample.&amp;nbsp;&nbsp;And&nbsp;the&nbsp;Java&nbsp;one&nbsp;just&nbsp;works&nbsp;perfectly&nbsp;without&nbsp;any&nbsp;problems.&amp;nbsp;&nbsp;I&nbsp;used&nbsp;the&nbsp;same&nbsp;simple&nbsp;publisher&nbsp;and&nbsp;the&nbsp;java&nbsp;simplesubscriber&nbsp;just&nbsp;blocked&nbsp;and&nbsp;received&nbsp;msgs&nbsp;whenever&nbsp;I&nbsp;sent&nbsp;them&nbsp;via&nbsp;the&nbsp;simplepublisher.&amp;nbsp;&nbsp;So&nbsp;I&nbsp;am&nbsp;thinking&nbsp;probably&nbsp;the&nbsp;one&nbsp;thing&nbsp;left&nbsp;to<br>
&nbsp;verify&nbsp;is&nbsp;whether&nbsp;or&nbsp;not&nbsp;we&nbsp;are&nbsp;running&nbsp;the&nbsp;same&nbsp;RabbitMQ.Client&nbsp;DLL&nbsp;file.&nbsp;I&nbsp;sent&nbsp;you&nbsp;the&nbsp;version&nbsp;that&nbsp;I&nbsp;am&nbsp;running,&nbsp;please&nbsp;let&nbsp;me&nbsp;know&nbsp;if&nbsp;we&nbsp;are&nbsp;running&nbsp;the&nbsp;same&nbsp;one.&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;sequence&nbsp;of&nbsp;events&nbsp;to&nbsp;explain&nbsp;the&nbsp;attached&nbsp;log&nbsp;file:&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;1)&amp;nbsp;&nbsp;Start&nbsp;broker&nbsp;and&nbsp;broker&nbsp;rebuilds&nbsp;fresh&nbsp;cope&nbsp;of&nbsp;both&nbsp;db&nbsp;and&nbsp;log&nbsp;directories&nbsp;after&nbsp;I&nbsp;had&nbsp;deleted&nbsp;the&nbsp;old&nbsp;ones&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;2)&nbsp;Run&nbsp;my&nbsp;basicpublisher&nbsp;program&nbsp;twice&nbsp;to&nbsp;publish&nbsp;two&nbsp;simple&nbsp;&quot;hello&quot;&nbsp;msgs&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;3)&nbsp;Rum&nbsp;my&nbsp;basicsubscriber&nbsp;program&nbsp;which&nbsp;dequeues&nbsp;the&nbsp;two&nbsp;msgs&nbsp;and&nbsp;immediately&nbsp;throws&nbsp;the&nbsp;EndOfStream&nbsp;Exception&nbsp;and&nbsp;I&nbsp;think&nbsp;in&nbsp;the&nbsp;log&nbsp;results&nbsp;in&nbsp;the&nbsp;&quot;abrupt&nbsp;socket&nbsp;closure&quot;.&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;4)&amp;nbsp;&nbsp;I&nbsp;again&nbsp;run&nbsp;my&nbsp;basicsubscriber&nbsp;program&nbsp;and&nbsp;this&nbsp;time&nbsp;there&nbsp;is&nbsp;no&nbsp;msg&nbsp;in&nbsp;the&nbsp;queue&nbsp;so&nbsp;when&nbsp;it&nbsp;tries&nbsp;to&nbsp;deque&nbsp;..&nbsp;there&nbsp;is&nbsp;nothing&nbsp;...&nbsp;and&nbsp;it&nbsp;immediately&nbsp;causes&nbsp;another&nbsp;&quot;abrupt&nbsp;socket&nbsp;closure&quot;&nbsp;in&nbsp;log.&amp;nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;log:&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&lt;BR&gt;=INFO&nbsp;REPORT====<br>
&nbsp;31-Mar-2008::03:29:00&nbsp;===&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;application:&nbsp;mnesia&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;exited:&nbsp;stopped&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;type:&nbsp;temporary&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:29:00&nbsp;===&lt;BR&gt;Added&nbsp;vhost&nbsp;&amp;lt;&amp;lt;&quot;/&quot;&amp;gt;&amp;gt;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:29:00&nbsp;===&lt;BR&gt;Created&nbsp;user&nbsp;&amp;lt;&amp;lt;&quot;guest&quot;&amp;gt;&amp;gt;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:29:00&nbsp;===&lt;BR&gt;Rolling&nbsp;persister&nbsp;log&nbsp;to&nbsp;&quot;c:/Documents&nbsp;and&nbsp;Settings/Development/rabbitmq/db/rabbit-mnesia/rabbit_persister.LOG.previous&quot;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:29:00&nbsp;===&lt;BR&gt;started&nbsp;TCP&nbsp;listener&nbsp;on&nbsp;0.0.0.0:5672&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:30:50&nbsp;===&lt;BR&gt;accepted&nbsp;TCP&nbsp;connection&nbsp;on&nbsp;0.0.0.0:5672&nbsp;from&nbsp;10.10.10.25:2581&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:30:50&nbsp;===&lt;BR&gt;closing&nbsp;TCP&nbsp;connection&nbsp;from&nbsp;10.10.10.25:2581&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:30:53&nbsp;===&lt;BR&gt;accepted&nbsp;TCP&nbsp;connection&nbsp;on&nbsp;0.0.0.0:5672&nbsp;from&nbsp;10.10.10.25:2582&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====<br>
&nbsp;31-Mar-2008::03:30:53&nbsp;===&lt;BR&gt;closing&nbsp;TCP&nbsp;connection&nbsp;from&nbsp;10.10.10.25:2582&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:31:13&nbsp;===&lt;BR&gt;accepted&nbsp;TCP&nbsp;connection&nbsp;on&nbsp;0.0.0.0:5672&nbsp;from&nbsp;10.10.10.25:2583&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:31:14&nbsp;===&lt;BR&gt;Connection&nbsp;closed&nbsp;abruptly.&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:31:14&nbsp;===&lt;BR&gt;closing&nbsp;TCP&nbsp;connection&nbsp;from&nbsp;10.10.10.25:2583&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:34:45&nbsp;===&lt;BR&gt;accepted&nbsp;TCP&nbsp;connection&nbsp;on&nbsp;0.0.0.0:5672&nbsp;from&nbsp;10.10.10.25:2584&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:34:46&nbsp;===&lt;BR&gt;Connection&nbsp;closed&nbsp;abruptly.&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;31-Mar-2008::03:34:46&nbsp;===&lt;BR&gt;closing&nbsp;TCP&nbsp;connection&nbsp;from&nbsp;10.10.10.25:2584&lt;BR&gt;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;div&gt;&lt;BR&gt;&lt;BR&gt;&lt;B&gt;&lt;I&gt;Matthias&nbsp;Radestock&nbsp;&amp;lt;matthias@lshift.net&amp;gt;&lt;/I&gt;&lt;/B&gt;&nbsp;wrote:&lt;/div&gt;&nbsp;&nbsp;&lt;BLOCKQUOTE&nbsp;class=replbq&nbsp;style=&quot;PADDING-LEFT:&nbsp;5px;&nbsp;MARGIN-LEFT:&nbsp;5px;&nbsp;BORDER-LEFT:&nbsp;#1010ff&nbsp;2px&nbsp;solid&quot;&gt;Bill,,&lt;BR&gt;&lt;BR&gt;BillC&nbsp;wrote:&lt;BR&gt;&amp;gt;&nbsp;Here&nbsp;is&nbsp;the&nbsp;log&nbsp;on&nbsp;RabbitMQ:&lt;BR&gt;&amp;gt;<br>
&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Thanks&nbsp;for&nbsp;your&nbsp;help.&nbsp;I&nbsp;just&nbsp;cleaned&nbsp;up&nbsp;the&nbsp;old&nbsp;log.&nbsp;Ran&nbsp;the&nbsp;publish&nbsp;&lt;BR&gt;&amp;gt;&nbsp;program&nbsp;twice&nbsp;to&nbsp;enque&nbsp;two&nbsp;messages.&nbsp;Then&nbsp;I&nbsp;ran&nbsp;the&nbsp;subscriber&nbsp;program&nbsp;&lt;BR&gt;&amp;gt;&nbsp;to&nbsp;deque&nbsp;twice.&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;I&nbsp;see&nbsp;a&nbsp;lot&nbsp;of&nbsp;abrupt&nbsp;connection&nbsp;closures&nbsp;but&nbsp;no&nbsp;real&nbsp;explanations&nbsp;as&nbsp;to&nbsp;&lt;BR&gt;&amp;gt;&nbsp;the&nbsp;reason.&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;=INFO&nbsp;REPORT====&nbsp;30-Mar-2008::16:25:40&nbsp;===&lt;BR&gt;&amp;gt;&nbsp;disk_log:&nbsp;repairing&nbsp;&quot;c:/Documents&nbsp;and&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Settings/Development/rabbitmq/db/rabbit-mnesia/rabbit_persister.LOG&quot;&nbsp;...&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;=INFO&nbsp;REPORT====&nbsp;30-Mar-2008::16:25:40&nbsp;===&lt;BR&gt;&amp;gt;&nbsp;Repaired&nbsp;persister&nbsp;log&nbsp;-&nbsp;22&nbsp;recovered,&nbsp;0&nbsp;bad&lt;BR&gt;&lt;BR&gt;That&nbsp;is&nbsp;an&nbsp;odd&nbsp;error.&nbsp;Do&nbsp;you&nbsp;get&nbsp;it&nbsp;every&nbsp;time&nbsp;you&nbsp;start&nbsp;the&nbsp;broker?&nbsp;How&nbsp;&lt;BR&gt;are&nbsp;you&nbsp;stopping&nbsp;the&nbsp;broker?&lt;BR&gt;&lt;BR&gt;That&nbsp;plus&nbsp;the&nbsp;tracer&nbsp;log&nbsp;you&nbsp;sent&nbsp;previously&nbsp;indicate&nbsp;that&nbsp;your&nbsp;test&nbsp;&lt;BR&gt;uses&nbsp;persistent&nbsp;messages.&nbsp;There&nbsp;is&nbsp;nothing&nbsp;wrong&nbsp;with&nbsp;that&nbsp;but&nbsp;it&nbsp;may&nbsp;&lt;BR&gt;explain&nbsp;why&nbsp;you&nbsp;are&nbsp;seeing&nbsp;errors&nbsp;when&nbsp;we&nbsp;don't.&nbsp;Try&nbsp;running&nbsp;your&nbsp;tests&nbsp;&lt;BR&gt;with&nbsp;transient&nbsp;messages,&nbsp;after&nbsp;clearing<br>
&nbsp;out&nbsp;the&nbsp;previously&nbsp;persisted&nbsp;&lt;BR&gt;messages&nbsp;(stop&nbsp;the&nbsp;broker,&nbsp;remove&nbsp;the&nbsp;persister&nbsp;log&nbsp;file&nbsp;mentioned&nbsp;above&nbsp;&lt;BR&gt;and&nbsp;then&nbsp;restart&nbsp;the&nbsp;broker).&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Matthias.&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;BR&gt;
</tt>
