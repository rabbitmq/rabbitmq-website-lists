<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;div&gt;Our&nbsp;clusters&nbsp;support&nbsp;apps&nbsp;that&nbsp;do&nbsp;work&nbsp;periodically,&nbsp;e.g.&nbsp;Every&nbsp;few&nbsp;seconds&nbsp;or&nbsp;minutes,&nbsp;typically&nbsp;analyzing/reporting&nbsp;the&nbsp;state&nbsp;of&nbsp;other&nbsp;apps.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;run&nbsp;an&nbsp;identical&nbsp;instance&nbsp;of&nbsp;each&nbsp;app&nbsp;connected&nbsp;to&nbsp;each&nbsp;node&nbsp;of&nbsp;the&nbsp;cluster.&nbsp;The&nbsp;apps&nbsp;each&nbsp;subscribe&nbsp;to&nbsp;a&nbsp;'token'&nbsp;mirrored&nbsp;queue&nbsp;which&nbsp;is&nbsp;seeded&nbsp;with&nbsp;a&nbsp;single&nbsp;message.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;app&nbsp;gets&nbsp;the&nbsp;message,&nbsp;does&nbsp;its&nbsp;work,&nbsp;waits&nbsp;for&nbsp;the&nbsp;appropriate&nbsp;interval,&nbsp;and&nbsp;then&nbsp;republishes&nbsp;the&nbsp;token&nbsp;message&nbsp;to&nbsp;the&nbsp;queue.&nbsp;The&nbsp;next&nbsp;app&nbsp;gets&nbsp;the&nbsp;message&nbsp;-&nbsp;they&nbsp;proceed&nbsp;in&nbsp;a&nbsp;round&nbsp;robin&nbsp;fashion.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Today&nbsp;I&nbsp;am&nbsp;reviewing&nbsp;and&nbsp;refactoring&nbsp;this&nbsp;logic,&nbsp;and&nbsp;I&nbsp;wonder&nbsp;if&nbsp;it&nbsp;would&nbsp;be&nbsp;better&nbsp;to&nbsp;keep&nbsp;a&nbsp;single&nbsp;token&nbsp;message&nbsp;and&nbsp;just&nbsp;nack&nbsp;it&nbsp;instead&nbsp;of&nbsp;rewriting.&nbsp;Nacking&nbsp;is&nbsp;a&nbsp;little&nbsp;simpler.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However,&nbsp;I&nbsp;see&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;BasicReject&nbsp;that&nbsp;the&nbsp;broker&nbsp;may&nbsp;not&nbsp;want&nbsp;to&nbsp;deliver&nbsp;the&nbsp;same&nbsp;message&nbsp;within&nbsp;the&nbsp;same&nbsp;channel&nbsp;context;&nbsp;does&nbsp;this&nbsp;hold&nbsp;for&nbsp;BasicNack&nbsp;as&nbsp;well?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;a&nbsp;cluster&nbsp;with&nbsp;one&nbsp;node,&nbsp;the&nbsp;above&nbsp;pattern&nbsp;using&nbsp;rewrite&nbsp;works&nbsp;fine.&nbsp;Would&nbsp;it&nbsp;still&nbsp;work&nbsp;using&nbsp;nack&nbsp;or&nbsp;would&nbsp;the&nbsp;app&nbsp;have&nbsp;to&nbsp;close&nbsp;the&nbsp;channel&nbsp;and&nbsp;resubscribe&nbsp;using&nbsp;a&nbsp;new&nbsp;one&nbsp;(probably&nbsp;too&nbsp;expensive/messy)?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;Michael&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>

</tt>
