<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;Matthias,&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&quot;&gt;&amp;gt;&nbsp;Delivered&nbsp;but&nbsp;unacknowledged&nbsp;messages&nbsp;are&nbsp;held&nbsp;in&nbsp;RAM.&nbsp;This&nbsp;is&nbsp;something&lt;br&gt;we&nbsp;are&nbsp;going&nbsp;to&nbsp;change&nbsp;in&nbsp;a&nbsp;future&nbsp;release.&nbsp;Meanwhile,&nbsp;are&nbsp;you&nbsp;setting&nbsp;a&nbsp;prefetch&nbsp;count?&nbsp;That&nbsp;will&nbsp;bound&nbsp;the&nbsp;number&nbsp;of&nbsp;unacked&nbsp;messages&nbsp;and&nbsp;thus&nbsp;the&nbsp;memory&nbsp;taken&nbsp;up&nbsp;by&nbsp;them.&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;setting&nbsp;prefetch&nbsp;count&nbsp;to&nbsp;50.&amp;nbsp;&nbsp;each&nbsp;message&nbsp;is&nbsp;20&nbsp;KB.&amp;nbsp;&nbsp;so&nbsp;total&nbsp;usage&nbsp;should&nbsp;be&lt;br&gt;1000&nbsp;queue&nbsp;*&nbsp;20&nbsp;KB&nbsp;*&nbsp;50&nbsp;which&nbsp;is&nbsp;about&nbsp;1GB.&amp;nbsp;&amp;nbsp;&nbsp;After&nbsp;all&nbsp;the&nbsp;messages&nbsp;were&nbsp;consumed,&nbsp;the&nbsp;broker's&nbsp;memory&nbsp;still&nbsp;remained&nbsp;at&nbsp;4GB.&amp;nbsp;&nbsp;Is&nbsp;this&nbsp;expected&nbsp;or&nbsp;a&nbsp;problem&nbsp;with&nbsp;memory&nbsp;leak?&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&lt;br&gt;Another&nbsp;observation&nbsp;with&nbsp;2.1.1&nbsp;is&nbsp;that&nbsp;the&nbsp;most&nbsp;rdq&nbsp;files&nbsp;in&nbsp;msg_store_persistent&nbsp;were&nbsp;not&nbsp;deleted&nbsp;until&nbsp;all&nbsp;the&nbsp;messages&nbsp;were<br>
&nbsp;consumed.&amp;nbsp;&nbsp;because&nbsp;the&nbsp;broker&nbsp;was&nbsp;so&nbsp;busy&nbsp;&quot;rabbitmqctl&nbsp;list_queues&quot;&nbsp;could&nbsp;not&nbsp;return&nbsp;the&nbsp;queue&nbsp;length,&nbsp;so&nbsp;i&nbsp;am&nbsp;not&nbsp;sure&nbsp;if&nbsp;the&nbsp;delay&nbsp;in&nbsp;deleting&nbsp;rdq&nbsp;files&nbsp;was&nbsp;caused&nbsp;by&nbsp;some&nbsp;consumers&nbsp;were&nbsp;lagging&nbsp;behind.&amp;nbsp;&nbsp;When&nbsp;i&nbsp;used&nbsp;release&nbsp;2.0.0,&nbsp;the&nbsp;rdq&nbsp;files&nbsp;were&nbsp;deleted&nbsp;while&nbsp;the&nbsp;consumers&nbsp;were&nbsp;running.&amp;nbsp;&nbsp;Not&nbsp;sure&nbsp;if&nbsp;this&nbsp;contributed&nbsp;to&nbsp;the&nbsp;memory&nbsp;growth&nbsp;or&nbsp;not.&lt;br&gt;&lt;br&gt;thank&nbsp;for&nbsp;looking&nbsp;into&nbsp;these&nbsp;problems!&amp;nbsp;&nbsp;it&nbsp;is&nbsp;greatly&nbsp;appreciated.&lt;br&gt;&lt;br&gt;-alex&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;&lt;/html&gt;
</tt>
