<tt>
Matthias, Alvaro &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;quick&nbsp;reply.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;Rabbit&nbsp;version:&nbsp;2.8.4&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;Erlang&nbsp;version: R14B04&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2)&nbsp;The&nbsp;other&nbsp;queues&nbsp;are&nbsp;some&nbsp;idle&nbsp;some&nbsp;working&nbsp;(not&nbsp;very&nbsp;hard&nbsp;-&nbsp;up&nbsp;to&nbsp;30-40&nbsp;message&nbsp;per&nbsp;second).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3)&nbsp;Meaning:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;a)&nbsp;Declaring&nbsp;durable&nbsp;named&nbsp;queue:&nbsp;channel.queueDeclare(queue_name,&nbsp;true,&nbsp;....&nbsp;).&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;b)&nbsp;Binding&nbsp;queue: channel.queueBind(queue_name,&nbsp;exchange_name,&nbsp;routing_key).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;4)&nbsp;I&nbsp;will&nbsp;take&nbsp;a&nbsp;closer&nbsp;look&nbsp;at&nbsp;basic.qos&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;5)&nbsp;We&nbsp;are&nbsp;declaring&nbsp;queue&nbsp;only&nbsp;once&nbsp;on&nbsp;initialization&nbsp;(we&nbsp;are&nbsp;using&nbsp;JAVA&nbsp;client).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks, &lt;/div&gt;&lt;div&gt; &nbsp; Pavel&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Jan&nbsp;14,&nbsp;2013&nbsp;at&nbsp;5:44&nbsp;PM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;matthias@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Pavel,&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;14/01/13&nbsp;21:21,&nbsp;Pavel&nbsp;Kogan&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;have&nbsp;a&nbsp;rabbit&nbsp;server&nbsp;on&nbsp;single&nbsp;dedicated&nbsp;CentOS&nbsp;machine&nbsp;(Quad&nbsp;Core&lt;br&gt;<br>
with&nbsp;16Gb&nbsp;RAM)&nbsp;connected&nbsp;to&nbsp;1Gbit&nbsp;LAN.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
What&nbsp;version&nbsp;of&nbsp;Erlang&nbsp;and&nbsp;Rabbit&nbsp;are&nbsp;you&nbsp;running?&nbsp;If&nbsp;it&amp;#39;s&nbsp;not&nbsp;the&nbsp;latest&nbsp;of&nbsp;both&nbsp;then&nbsp;please&nbsp;upgrade.&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;have&nbsp;many&nbsp;queues&nbsp;running,&nbsp;but&nbsp;total&nbsp;number&nbsp;of&nbsp;messages&nbsp;is&nbsp;not&nbsp;very&lt;br&gt;<br>
high&nbsp;for&nbsp;such&nbsp;a&nbsp;machine.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
What&nbsp;are&nbsp;all&nbsp;those&nbsp;queues&nbsp;doing?&nbsp;Are&nbsp;the&nbsp;completely&nbsp;idle&nbsp;or&nbsp;is&nbsp;there&nbsp;a&nbsp;trickle&nbsp;of&nbsp;messages&nbsp;flowing&nbsp;in/out/through&nbsp;them?&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
The&nbsp;problem&nbsp;is&nbsp;following:&lt;br&gt;<br>
1)&nbsp;I&nbsp;connect&nbsp;client&nbsp;A&nbsp;to&nbsp;some&nbsp;queue&nbsp;(with&nbsp;many&nbsp;many&nbsp;messages&nbsp;ready)&nbsp;with&lt;br&gt;<br>
some&nbsp;routing&nbsp;key&nbsp;-&nbsp;it&nbsp;processes&nbsp;150&nbsp;messages&nbsp;per&nbsp;sec&nbsp;(its&nbsp;limit).&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
What&nbsp;do&nbsp;you&nbsp;mean&nbsp;by&nbsp;&amp;quot;connect...&nbsp;to&nbsp;some&nbsp;queue...&nbsp;with&nbsp;some&nbsp;routing&nbsp;key&amp;quot;?&nbsp;Consuming&nbsp;from&nbsp;a&nbsp;queue&nbsp;does&nbsp;not&nbsp;involve&nbsp;a&nbsp;routing&nbsp;key.&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
2)&nbsp;I&nbsp;connect&nbsp;another&nbsp;client&nbsp;A&nbsp;in&nbsp;parallel&nbsp;on&nbsp;identical&nbsp;server&nbsp;to&nbsp;same&lt;br&gt;<br>
queue&nbsp;with&nbsp;same&nbsp;routing&nbsp;key.&nbsp;Now&nbsp;I&nbsp;have&nbsp;2&nbsp;identical&nbsp;consumers&nbsp;on&nbsp;same&lt;br&gt;<br>
queue&nbsp;and&nbsp;messages&nbsp;are&nbsp;distributed&nbsp;on&nbsp;round&nbsp;robin&lt;br&gt;<br>
 &nbsp; &nbsp; manner,&nbsp;but&nbsp;somehow&nbsp;second&nbsp;unit&nbsp;receives&nbsp;only&nbsp;50&nbsp;messages&nbsp;per&nbsp;sec.&lt;br&gt;<br>
3)&nbsp;If&nbsp;I&nbsp;disconnect&nbsp;A1,&nbsp;A2&nbsp;starts&nbsp;working&nbsp;normally.&nbsp;If&nbsp;I&nbsp;connect&nbsp;A1&nbsp;back&lt;br&gt;<br>
it&nbsp;becomes&nbsp;a&nbsp;slow&nbsp;node.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
As&nbsp;Alvaro&nbsp;said,&nbsp;check&nbsp;your&nbsp;basic.qos&nbsp;settings;&nbsp;if&nbsp;they&nbsp;are&nbsp;too&nbsp;low&nbsp;then&nbsp;throughput&nbsp;becomes&nbsp;bounded&nbsp;by&nbsp;network&nbsp;latency.&lt;br&gt;<br>
&lt;br&gt;<br>
Also,&nbsp;check&nbsp;that&nbsp;there&nbsp;aren&amp;#39;t&nbsp;any&nbsp;extraneous&nbsp;AMQP&nbsp;commands&nbsp;being&nbsp;issued&nbsp;by&nbsp;your&nbsp;client.&nbsp;e.g.&nbsp;it&nbsp;would&nbsp;be&nbsp;bad&nbsp;if,&nbsp;say,&nbsp;it&nbsp;(re)declared&nbsp;the&nbsp;queue&nbsp;every&nbsp;time&nbsp;it&nbsp;receives&nbsp;a&nbsp;message.&nbsp;You&nbsp;may&nbsp;want&nbsp;to&nbsp;connect&nbsp;through&nbsp;the&nbsp;tracer&nbsp;(&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/api-guide.html#tracer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/api-&lt;u&gt;&lt;/u&gt;guide.html#tracer&lt;/a&gt;)&nbsp;and&nbsp;examine&nbsp;the&nbsp;command&nbsp;stream.&lt;br&gt;<br>
<br>
<br>
<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
