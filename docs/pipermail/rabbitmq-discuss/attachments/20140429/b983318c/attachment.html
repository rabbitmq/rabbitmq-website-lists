<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;I&nbsp;keep&nbsp;getting:`&lt;b&gt;ERROR/MainProcess]&nbsp;consumer:&nbsp;Cannot&nbsp;connect&nbsp;to&nbsp;amqp://ec2celeryuser&lt;/b&gt;`&nbsp;when&nbsp;I&nbsp;run&nbsp;`celery&nbsp;-A&nbsp;tasks&nbsp;worker`&nbsp;on&nbsp;terminal.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Basically&nbsp;what&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;do&nbsp;is&nbsp;get&nbsp;celery/rabbitmq&nbsp;working&nbsp;properly&nbsp;across&nbsp;(2)&nbsp;ec2&nbsp;instances.&nbsp;To&nbsp;pass&nbsp;a&nbsp;silly&nbsp;task&nbsp;in&nbsp;`tasks.py`&nbsp;for&nbsp;processing&nbsp;to&nbsp;rabbitmq.&lt;br&gt;&lt;br&gt;&lt;b&gt;&nbsp;1.&nbsp;Instance&nbsp;1&lt;/b&gt;&nbsp;-&nbsp;Houses&nbsp;rabbitMQ&lt;br&gt;&lt;br&gt;This&nbsp;currently&nbsp;runs&nbsp;RabbitMQ&nbsp;fine.&nbsp;If&nbsp;I&nbsp;run&nbsp;`sudo&nbsp;rabbitmqctl&nbsp;status`&nbsp;it&nbsp;outputs:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;of&nbsp;node&nbsp;'rabbit@ip-xx-xxx-xxx-xx'&nbsp;...&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;[{pid,786},&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;b&gt;2.&nbsp;Instance&nbsp;2&lt;/b&gt;&nbsp;-&nbsp;Houses&nbsp;Celery&lt;br&gt;&lt;br&gt;I'm&nbsp;trying&nbsp;to&nbsp;run&nbsp;celery&nbsp;on&nbsp;`instance&nbsp;2`&nbsp;against&nbsp;Instance&nbsp;1&nbsp;using&nbsp;the&nbsp;following&nbsp;in&nbsp;terminal:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;celery&nbsp;-A&nbsp;tasks&nbsp;worker&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I&nbsp;have&nbsp;a&nbsp;file&nbsp;`&lt;b&gt;celeryconfig.py&lt;/b&gt;`:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;BROKER_URL&nbsp;=&nbsp;'amqp://ec2celeryuser:mypasshere@xx.xxx.xx.xx:5672/celeryserver1/'&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;#CELERY&nbsp;SETTINGS&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;CELERY_IMPORTS&nbsp;=&nbsp;(&quot;tasks&quot;,)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;CELERY_RESULT_BACKEND&nbsp;=&nbsp;&quot;amqp&quot;&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I&nbsp;have&nbsp;a&nbsp;file&nbsp;`&lt;b&gt;client.py&lt;/b&gt;`:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;tasks&nbsp;import&nbsp;add&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;add.delay(4,&nbsp;4)&nbsp;#&nbsp;call&nbsp;task&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;result_sum&nbsp;=&nbsp;result.get(timeout=5)&nbsp;#&nbsp;wait&nbsp;to&nbsp;get&nbsp;result&nbsp;for&nbsp;a&nbsp;maximum&nbsp;of&nbsp;5&nbsp;seconds&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I&nbsp;have&nbsp;a&nbsp;file&nbsp;`&lt;b&gt;tasks.py&lt;/b&gt;`:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;celery&nbsp;import&nbsp;Celery&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;app&nbsp;=&nbsp;Celery('tasks',&nbsp;broker='amqp://ec2celeryuser:mypasshere@xx.xxx.xx.xx:5672/celeryserver1/')&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;@app.task&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;add(x,&nbsp;y):&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;x&nbsp;+&nbsp;y&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I've&nbsp;properly&nbsp;setup&nbsp;a&nbsp;`vhost`,&nbsp;a&nbsp;user&nbsp;`ec2celeryuser`,&nbsp;and&nbsp;gave&nbsp;this&nbsp;user&nbsp;permissions&nbsp;of:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;sudo&nbsp;rabbitmqctl&nbsp;set_permissions&nbsp;-p&nbsp;/celeryserver1&nbsp;ec2celeryuser&nbsp;&quot;.*&quot;&nbsp;&quot;.*&quot;&nbsp;&quot;.*&quot;&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;if&nbsp;I&nbsp;do:&nbsp;`sudo&nbsp;rabbitmqctl&nbsp;list_users`&nbsp;on&nbsp;RabbitMQ&nbsp;(instance&nbsp;1)&nbsp;it&nbsp;shows:&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;ec2celeryuser&nbsp;&nbsp;&nbsp;&nbsp;[]&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;guest&nbsp;&nbsp;&nbsp;&nbsp;[administrator&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;I've&nbsp;tried&nbsp;&lt;i&gt;both&nbsp;usernames&lt;/i&gt;&nbsp;with&nbsp;their&nbsp;passwords,&nbsp;but&nbsp;no&nbsp;change.&lt;br&gt;&lt;br&gt;What&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong&nbsp;here?&nbsp;Clearly&nbsp;there&nbsp;is&nbsp;a&nbsp;connection&nbsp;issue,&nbsp;but&nbsp;what&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong?&lt;br&gt;&lt;br&gt;&lt;b&gt;I've&nbsp;been&nbsp;following&nbsp;these&nbsp;without&nbsp;much&nbsp;luck.&lt;br&gt;&lt;/b&gt;&nbsp;http://celery.readthedocs.org/en/latest/getting-started/first-steps-with-celery.html&lt;br&gt;http://www.sammyliu.com/2011/06/23/celery-simple-distributed-tasks-with-celery-and-rabbitmq&lt;br&gt;&lt;br&gt;&lt;br&gt;Thank&nbsp;you!&lt;br&gt;&lt;/div&gt;
</tt>
