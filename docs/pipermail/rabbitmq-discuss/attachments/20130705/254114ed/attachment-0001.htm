<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Thank&nbsp;you&nbsp;for&nbsp;reply.&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;I&nbsp;made&nbsp;sure&nbsp;we&nbsp;shut&nbsp;down&nbsp;the&nbsp;server&nbsp;using&nbsp;&amp;#39;rabbitmqctl&nbsp;stop&amp;#39;.&lt;/div&gt;&lt;div&gt;And&nbsp;our&nbsp;app&nbsp;disconnect&nbsp;the&nbsp;server&nbsp;when&nbsp;we&nbsp;shut&nbsp;down,&lt;/div&gt;&lt;div&gt;so&amp;nbsp;any&nbsp;loads&nbsp;didn&amp;#39;t&nbsp;depend&nbsp;on&nbsp;it.&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;Well,&amp;nbsp;in&nbsp;case&amp;nbsp;that&nbsp;message&amp;nbsp;is&nbsp;output&amp;nbsp;the&nbsp;server&nbsp;log,&nbsp;&lt;/div&gt;&lt;div&gt;does&nbsp;our&nbsp;app&amp;nbsp;&amp;nbsp;have&nbsp;risks&nbsp;to&nbsp;be&nbsp;affected&nbsp;by&nbsp;using&nbsp;it&nbsp;?&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
2013/7/3&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
This&nbsp;is&nbsp;nothing&nbsp;to&nbsp;do&nbsp;with&nbsp;master&nbsp;vs&nbsp;slave&nbsp;(which&nbsp;is&nbsp;a&nbsp;term&nbsp;applied&nbsp;to&nbsp;individual&nbsp;queue-node&nbsp;combinations&nbsp;by&nbsp;the&nbsp;way,&nbsp;not&nbsp;to&nbsp;entire&nbsp;nodes).&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;message&nbsp;means&nbsp;the&nbsp;broker&nbsp;was&nbsp;shut&nbsp;down&nbsp;unexpectedly,&nbsp;and&nbsp;it&nbsp;was&nbsp;not&nbsp;able&nbsp;to&nbsp;trust&nbsp;its&nbsp;indices&nbsp;as&nbsp;a&nbsp;consequence.&nbsp;This&nbsp;can&nbsp;take&nbsp;quite&nbsp;some&nbsp;time&nbsp;-&nbsp;so&nbsp;make&nbsp;sure&nbsp;you&nbsp;shut&nbsp;down&nbsp;the&nbsp;server&nbsp;properly&nbsp;(with&nbsp;e.g.&nbsp;rabbitmqctl&nbsp;stop,&nbsp;or&nbsp;/etc/init.d/rabbitmq-server&nbsp;stop,&nbsp;or&nbsp;stopping&nbsp;the&nbsp;Windows&nbsp;service).&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;02/07/13&nbsp;19:32,&nbsp;t.otoda&nbsp;wrote:&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;padding-left:1ex;border-left-color:rgb(204,204,204);border-left-width:1px;border-left-style:solid&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
I&nbsp;use&nbsp;RabbitMQ&nbsp;3.0.1&nbsp;and&nbsp;have&nbsp;a&nbsp;cluster&nbsp;with&nbsp;2&nbsp;disk&nbsp;nodes.&lt;br&gt;<br>
When&nbsp;I&nbsp;stoped&nbsp;and&nbsp;restarted&nbsp;both,&nbsp;the&nbsp;master&nbsp;node&nbsp;output&nbsp;log&nbsp;below.&lt;br&gt;<br>
&amp;nbsp;&nbsp;=WARNING&nbsp;REPORT====&nbsp;19-Jun-2013::23:56:59&nbsp;===&lt;br&gt;<br>
msg_store_persistent:&nbsp;recovery&nbsp;terms&nbsp;differ&nbsp;from&nbsp;present&lt;br&gt;<br>
rebuilding&nbsp;indices&nbsp;from&nbsp;scratch&lt;br&gt;<br>
Please&nbsp;tell&nbsp;me&nbsp;why&nbsp;this&nbsp;log&nbsp;is&nbsp;output&lt;br&gt;<br>
and&nbsp;what&nbsp;is&nbsp;occuered&nbsp;within&nbsp;RabbitMQ&nbsp;nodes.&lt;br&gt;<br>
I&nbsp;expect&nbsp;that&lt;br&gt;<br>
when&nbsp;a&nbsp;slave&nbsp;disk&nbsp;node&nbsp;is&nbsp;started,&lt;br&gt;<br>
the&nbsp;master&nbsp;node&nbsp;compares&nbsp;the&nbsp;indices&nbsp;it&nbsp;owns&nbsp;and&nbsp;the&nbsp;indices&nbsp;started&lt;br&gt;<br>
slave&nbsp;owns.&lt;br&gt;<br>
And&nbsp;then,&lt;br&gt;<br>
since&nbsp;the&nbsp;slave&nbsp;node&nbsp;was&nbsp;stopped&nbsp;by&nbsp;the&nbsp;abnormal&nbsp;way($B&quot;((B),&lt;br&gt;<br>
the&nbsp;indices&nbsp;differed&nbsp;from&nbsp;the&nbsp;other,&nbsp;and&nbsp;the&nbsp;master&nbsp;node&nbsp;output&nbsp;log.&lt;br&gt;<br>
Is&nbsp;this&nbsp;correct?&lt;br&gt;<br>
&amp;nbsp;&nbsp;($B&quot;((B)For&nbsp;example,&nbsp;I&nbsp;stoped&nbsp;the&nbsp;node&lt;br&gt;<br>
&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;beore&nbsp;it&nbsp;becomes&nbsp;the&nbsp;new&nbsp;master&nbsp;node&nbsp;instead&nbsp;of&nbsp;the&nbsp;stopped&lt;br&gt;<br>
master&nbsp;node.&lt;br&gt;<br>
Thank&nbsp;you.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
______________________________&lt;u&gt;&lt;/u&gt;_________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.&lt;u&gt;&lt;/u&gt;rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/&lt;u&gt;&lt;/u&gt;cgi-bin/mailman/listinfo/&lt;u&gt;&lt;/u&gt;rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;
</tt>
