<tt>
Alexis,&nbsp;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Can&nbsp;you&nbsp;clarify&nbsp;what&nbsp;you&nbsp;mean&nbsp;by&nbsp;&amp;quot;failover&nbsp;of&nbsp;session&nbsp;state&amp;quot;&nbsp;please?&lt;br&gt;<br>
I&nbsp;am&nbsp;assuming&nbsp;you&nbsp;mean&nbsp;that&nbsp;when&nbsp;a&nbsp;node&nbsp;dies,&nbsp;then&nbsp;another&nbsp;node&nbsp;can&lt;br&gt;<br>
&amp;#39;take&nbsp;over&amp;#39;&nbsp;from&nbsp;it,&nbsp;without&nbsp;loss&nbsp;of&nbsp;any&nbsp;state&nbsp;that&nbsp;the&nbsp;first&nbsp;node&nbsp;has&lt;br&gt;<br>
committed&nbsp;(to&nbsp;some&nbsp;other&nbsp;node&nbsp;and/or&nbsp;persistent&nbsp;store),&nbsp;and&nbsp;that&nbsp;the&lt;br&gt;<br>
second&nbsp;node&nbsp;can&nbsp;&amp;#39;take&nbsp;over&amp;#39;&nbsp;in&nbsp;some&nbsp;sense&nbsp;&amp;#39;faster&amp;#39;&nbsp;than&nbsp;recovery&nbsp;by&lt;br&gt;<br>
restarting&nbsp;the&nbsp;first&nbsp;node&nbsp;from&nbsp;disk&nbsp;would.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;More&nbsp;or&nbsp;less. &nbsp;I&amp;#39;m&nbsp;personally&nbsp;not&nbsp;that&nbsp;concerned&nbsp;with&nbsp;the&nbsp;timeliness&nbsp;of&nbsp;recovery&nbsp;for&nbsp;committed&nbsp;messages. &nbsp;I&amp;#39;m&nbsp;mostly&nbsp;concerned&nbsp;with&nbsp;any&nbsp;messages&nbsp;being&nbsp;dropped&nbsp;by&nbsp;the&nbsp;system&nbsp;because&nbsp;no&nbsp;bindings&nbsp;matching&nbsp;a&nbsp;particular&nbsp;message&amp;#39;s&nbsp;routing&nbsp;key&nbsp;existed&nbsp;in&nbsp;the&nbsp;exchange&nbsp;at&nbsp;the&nbsp;time&nbsp;of&nbsp;the&nbsp;enqueue&nbsp;command&nbsp;(because&nbsp;the&nbsp;one&nbsp;node&nbsp;which&nbsp;contained&nbsp;the&nbsp;queue&nbsp;which&nbsp;matched&nbsp;that&nbsp;routing&nbsp;key&nbsp;has&nbsp;suffered&nbsp;a&nbsp;disaster). &nbsp;To&nbsp;go&nbsp;further&nbsp;I&nbsp;really&nbsp;want&nbsp;the&nbsp;ability&nbsp;to&nbsp;define&nbsp;something&nbsp;like&nbsp;&amp;quot;failover&nbsp;bindings&amp;quot;&nbsp;(e.g.&nbsp;create&nbsp;queue&nbsp;Q&nbsp;on&nbsp;node&nbsp;A&nbsp;as&nbsp;master&nbsp;and&nbsp;node&nbsp;B&nbsp;for&nbsp;failover) &nbsp;in&nbsp;the&nbsp;exchange&nbsp;such&nbsp;that&nbsp;if&nbsp;delivery&nbsp;to&nbsp;to&nbsp;a&nbsp;queue&nbsp;&amp;quot;Q&amp;quot;&nbsp;on&nbsp;node&nbsp;&amp;quot;A&amp;quot;&nbsp;fails&nbsp;then&nbsp;the&nbsp;exchange&nbsp;will&nbsp;declare&nbsp;that&nbsp;node&nbsp;&amp;quot;B&amp;quot;&nbsp;is&nbsp;the&nbsp;new&nbsp;master&nbsp;for&nbsp;queue&nbsp;&amp;quot;Q&amp;quot;&nbsp;and&nbsp;all&nbsp;subsequent&nbsp;routing&nbsp;will&nbsp;be&nbsp;adjusted. &nbsp;It&nbsp;seems&nbsp;that&nbsp;if&nbsp;the&nbsp;persister&nbsp;were&nbsp;using&nbsp;mnesia&nbsp;to&nbsp;record&nbsp;session&nbsp;state&nbsp;(queue&nbsp;data)&nbsp;and&nbsp;one&nbsp;could&nbsp;define&nbsp;&amp;quot;failover&nbsp;bindings&amp;quot;&nbsp;like&nbsp;I&nbsp;mentioned&nbsp;above&nbsp;then&nbsp;the&nbsp;exchange&nbsp;could&nbsp;failover&nbsp;a&nbsp;queue&nbsp;to&nbsp;a&nbsp;secondary&nbsp;node&nbsp;transparently&nbsp;to&nbsp;all&nbsp;producers&nbsp;and&nbsp;consumers&nbsp;in&nbsp;the&nbsp;system,&nbsp;save&nbsp;for&nbsp;the&nbsp;ones&nbsp;that&nbsp;were&nbsp;directly&nbsp;connected&nbsp;to&nbsp;the&nbsp;node&nbsp;which&nbsp;suffered&nbsp;the&nbsp;disaster.&lt;br&gt;<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&nbsp; I&nbsp;ask&nbsp;because&nbsp;this&nbsp;case&nbsp;is&lt;br&gt;<br>
not&nbsp;quite&nbsp;the&nbsp;same&nbsp;as&nbsp;&amp;#39;exactly&nbsp;once&amp;#39;&nbsp;delivery.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes,&nbsp;I&nbsp;was&nbsp;just&nbsp;referring&nbsp;to&nbsp;my&nbsp;belief&nbsp;that&nbsp;if&nbsp;I&nbsp;want&nbsp;to&nbsp;eliminate&nbsp;this&nbsp;single&nbsp;point&nbsp;of&nbsp;failure&nbsp;I&nbsp;would&nbsp;need&nbsp;to&nbsp;create&nbsp;redundant&nbsp;queues&nbsp;on&nbsp;separate&nbsp;nodes&nbsp;and&nbsp;have&nbsp;some&nbsp;kind&nbsp;of&nbsp;out-of-band&nbsp;mechanism&nbsp;to&nbsp;guard&nbsp;against&nbsp;duplicate&nbsp;processing&nbsp;(or&nbsp;that&nbsp;I&nbsp;would&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;all&nbsp;downstream&nbsp;operations&nbsp;were&nbsp;idempotent).&lt;br&gt;<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
&lt;br&gt;<br>
alexis&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Sun,&nbsp;Jul&nbsp;26,&nbsp;2009&nbsp;at&nbsp;6:45&nbsp;PM,&nbsp;charles&lt;br&gt;<br>
woerner&amp;lt;&lt;a&nbsp;href=&quot;mailto:charleswoerner.lists@gmail.com&quot;&gt;charleswoerner.lists@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks&nbsp;Arvind. &nbsp;That&nbsp;seems&nbsp;to&nbsp;confirm&nbsp;our&nbsp;belief&nbsp;that&nbsp;rabbitmq&nbsp;doesn&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;handle&nbsp;failover&nbsp;of&nbsp;session&nbsp;state&nbsp;at&nbsp;the&nbsp;moment. &nbsp;So&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;competing&lt;br&gt;<br>
&amp;gt;&nbsp;consumers&nbsp;taking&nbsp;messages&nbsp;from&nbsp;a&nbsp;rabbitmq&nbsp;broker&nbsp;cluster&nbsp;it&nbsp;sounds&nbsp;like&lt;br&gt;<br>
&amp;gt;&nbsp;once-and-only-once&nbsp;delivery&nbsp;is&nbsp;somewhat&nbsp;up&nbsp;to&nbsp;the&nbsp;application&nbsp;to&nbsp;implement&lt;br&gt;<br>
&amp;gt;&nbsp;by&nbsp;arranging&nbsp;for&nbsp;each&nbsp;message&nbsp;to&nbsp;be&nbsp;delivered&nbsp;to&nbsp;redundant&nbsp;queues&nbsp;(ie.&nbsp;2&lt;br&gt;<br>
&amp;gt;&nbsp;separate&nbsp;queues&nbsp;with&nbsp;similar&nbsp;bindings&nbsp;residing&nbsp;on&nbsp;different&nbsp;hosts),&nbsp;then&lt;br&gt;<br>
&amp;gt;&nbsp;coordinate&nbsp;among&nbsp;your&nbsp;consumers&nbsp;to&nbsp;ensure&nbsp;once-and-only-once&nbsp;delivery&nbsp;using&lt;br&gt;<br>
&amp;gt;&nbsp;a&nbsp;database&nbsp;or&nbsp;simply&nbsp;to&nbsp;make&nbsp;your&nbsp;workflow&nbsp;idempotent&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;duplicate&nbsp;messages.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Ideally,&nbsp;I&amp;#39;d&nbsp;like&nbsp;my&nbsp;broker&nbsp;cluster&nbsp;to&nbsp;handle&nbsp;this. &nbsp;I&amp;#39;m&nbsp;looking&nbsp;into&nbsp;apache&lt;br&gt;<br>
&amp;gt;&nbsp;qpid&nbsp;as&nbsp;it&nbsp;seems&nbsp;to&nbsp;be&nbsp;more&nbsp;mature&nbsp;with&nbsp;respect&nbsp;to&nbsp;availability. &nbsp;The&nbsp;main&lt;br&gt;<br>
&amp;gt;&nbsp;downside&nbsp;with&nbsp;rabbitmq&nbsp;for&nbsp;me&nbsp;right&nbsp;now&nbsp;is&nbsp;the&nbsp;lack&nbsp;of&nbsp;at&nbsp;least&nbsp;an&nbsp;option&lt;br&gt;<br>
&amp;gt;&nbsp;for&nbsp;session&nbsp;state&nbsp;replication. &nbsp;It&nbsp;sounds&nbsp;like&nbsp;a&nbsp;future&nbsp;release&nbsp;of&nbsp;rabbitmq&lt;br&gt;<br>
&amp;gt;&nbsp;with&nbsp;pluggable&nbsp;persisters&nbsp;will&nbsp;make&nbsp;distributed&nbsp;session&nbsp;state&nbsp;possible&nbsp;via&lt;br&gt;<br>
&amp;gt;&nbsp;mnesia.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
