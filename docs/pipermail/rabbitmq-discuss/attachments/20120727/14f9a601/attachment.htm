<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;I&nbsp;didn't&nbsp;use&nbsp;spring&nbsp;amqp&nbsp;api,&nbsp;so&nbsp;I&nbsp;can<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;provide&nbsp;you&nbsp;working&nbsp;example.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;use&nbsp;consuming&nbsp;with&nbsp;small&nbsp;timeout&nbsp;(and&nbsp;there&nbsp;is&nbsp;a&nbsp;cost&nbsp;of&nbsp;time&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;small&nbsp;delay,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; not&nbsp;an&nbsp;issue&nbsp;in&nbsp;my&nbsp;case,&nbsp;cpu&nbsp;usage&nbsp;and&nbsp;network&nbsp;fingerprints&nbsp;stays<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;very&nbsp;small).&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;was&nbsp;also&nbsp;taking&nbsp;advantage&nbsp;of&nbsp;rabbit's&nbsp;java&nbsp;client&nbsp;prefetching&nbsp;(I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;am&nbsp;not&nbsp;sure&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;spring&nbsp;implements&nbsp;that).&nbsp;These&nbsp;two&nbsp;combined&nbsp;gave&nbsp;me&nbsp;acceptable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;approximation&nbsp;of&nbsp;priorities.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;could&nbsp;also&nbsp;add&nbsp;to&nbsp;messages&nbsp;own&nbsp;argument&nbsp;(for&nbsp;example<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPriority)&nbsp;and&nbsp;consume&nbsp;all&nbsp;messages&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;they&nbsp;are&nbsp;available&nbsp;(or&nbsp;let's&nbsp;say&nbsp;up&nbsp;to&nbsp;200&nbsp;messages&nbsp;or&nbsp;sth),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;put&nbsp;them&nbsp;in&nbsp;a&nbsp;priority&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue&nbsp;on&nbsp;your&nbsp;application&nbsp;side.&nbsp;And&nbsp;then&nbsp;process&nbsp;them&nbsp;from&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head&nbsp;of&nbsp;this&nbsp;container&nbsp;(using&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dedicated&nbsp;thread).&nbsp;That&nbsp;also&nbsp;may&nbsp;give&nbsp;you&nbsp;acceptable&nbsp;results.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;the&nbsp;state&nbsp;of&nbsp;art&nbsp;is&nbsp;as&nbsp;follows:&nbsp;RabbitMQ&nbsp;is&nbsp;a&nbsp;FIFO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue,&nbsp;and&nbsp;does&nbsp;not&nbsp;make&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;of&nbsp;message&nbsp;priorities&nbsp;today.&nbsp;It&nbsp;could&nbsp;be&nbsp;changed&nbsp;in&nbsp;one&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;releases,&nbsp;I&nbsp;don't&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;know&nbsp;when&nbsp;it&nbsp;may&nbsp;be.&nbsp;As&nbsp;consequence&nbsp;of&nbsp;that&nbsp;you&nbsp;should&nbsp;apply&nbsp;some<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasonable&nbsp;workaround&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;will&nbsp;be&nbsp;acceptable&nbsp;for&nbsp;you&nbsp;or&nbsp;reconsider&nbsp;your&nbsp;needs&nbsp;(maybe<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;you&nbsp;don't&nbsp;really&nbsp;need&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priorities?)&nbsp;or&nbsp;use&nbsp;something&nbsp;else&nbsp;than&nbsp;RabbitMQ&nbsp;or&nbsp;implement&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;yourself.&nbsp;By&nbsp;the&nbsp;way&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMQP&nbsp;itself&nbsp;says&nbsp;that&nbsp;&quot;Messages&nbsp;with&nbsp;higher&nbsp;priorities&nbsp;MAY&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delivered&nbsp;before&nbsp;those&nbsp;with&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lower&nbsp;priorities&quot;.&nbsp;Following&nbsp;that&nbsp;messages&nbsp;priority&nbsp;in&nbsp;any<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implementation&nbsp;of&nbsp;AMQP&nbsp;may&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;not&nbsp;consistent.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Best&nbsp;regards,&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ernest&nbsp;Staszuk&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;dniu&nbsp;2012-07-27&nbsp;10:50,&nbsp;andy&nbsp;pisze:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:033c01cd6bd4$e76f6b10$b64e4130$@gmail.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;&nbsp;lang=&quot;EN-US&quot;&gt;at&nbsp;as&nbsp;you&nbsp;say<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,if&nbsp;we&nbsp;are&nbsp;processing&nbsp;2st&nbsp;queue&nbsp;message&nbsp;as&nbsp;soon&nbsp;as&nbsp;the&nbsp;1&lt;sup&gt;st&lt;/sup&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue&nbsp;gets&nbsp;a&nbsp;new&nbsp;message&nbsp;needed&nbsp;to&nbsp;process,how&nbsp;can&nbsp;we&nbsp;switch&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;process&nbsp;1&lt;/span&gt;&lt;sup&gt;&lt;span&nbsp;style=&quot;font-family:宋体;color:#1F497D&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lang=&quot;EN-US&quot;&gt;st&lt;/span&gt;&lt;/sup&gt;&lt;span&nbsp;style=&quot;color:#1F497D&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lang=&quot;EN-US&quot;&gt;?&nbsp;It&nbsp;also&nbsp;means&nbsp;that&nbsp;we&nbsp;should&nbsp;check&nbsp;the&nbsp;amount&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messages&nbsp;in&nbsp;the&nbsp;queue&nbsp; in&nbsp;order&nbsp;,I&nbsp;think&nbsp;it&nbsp;will&nbsp;cost&nbsp;much&nbsp;time<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;machine&nbsp;resource.and&nbsp;could&nbsp;you&nbsp;tell&nbsp;me &nbsp;how&nbsp;I&nbsp;could&nbsp; use<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spring&nbsp;amqp&nbsp;a&lt;/span&gt;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
