<tt>
&lt;p&gt;I&amp;#39;d&nbsp;say&nbsp;that&nbsp;if&nbsp;you&nbsp;need&nbsp;strict&nbsp;ordering&nbsp;then&nbsp;the&nbsp;subscriber&nbsp;will&nbsp;have&nbsp;to&nbsp;handle&nbsp;that,&nbsp;perhaps&nbsp;by&nbsp;caching&nbsp;incoming&nbsp;messages&nbsp;as&nbsp;soon&nbsp;as&nbsp;it&nbsp;detects&nbsp;a&nbsp;hole&nbsp;in&nbsp;the&nbsp;sequence&nbsp;flow&nbsp;and&nbsp;starting&nbsp;to&nbsp;process&nbsp;once&nbsp;again&nbsp;once&nbsp;the&nbsp;missing&nbsp;message&nbsp;has&nbsp;been&nbsp;processed.&nbsp;This&nbsp;gets&nbsp;messy&nbsp;soon,&nbsp;however,&nbsp;if&nbsp;you&nbsp;happen&nbsp;to&nbsp;lose&nbsp;another&nbsp;message&nbsp;while&nbsp;you&nbsp;are&nbsp;already&nbsp;waiting&nbsp;for&nbsp;the&nbsp;first&nbsp;one.&nbsp;And&nbsp;so&nbsp;on,&nbsp;recursively.&lt;/p&gt;<br>
<br>
&lt;p&gt;Are&nbsp;there&nbsp;any&nbsp;other&nbsp;approaches&nbsp;to&nbsp;achieve&nbsp;ordering&nbsp;guarantees?&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Jun&nbsp;15,&nbsp;2011&nbsp;6:14&nbsp;PM,&nbsp;&amp;quot;Emile&nbsp;Joubert&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Rabbit&nbsp;preserves&nbsp;order&nbsp;of&nbsp;messages&nbsp;under&nbsp;strict&nbsp;conditions,&nbsp;as&lt;br&gt;<br>
&amp;gt;&nbsp;discussed.&nbsp;Your&nbsp;case&nbsp;does&nbsp;not&nbsp;meet&nbsp;those&nbsp;conditions,&nbsp;so&nbsp;the&nbsp;ordering&lt;br&gt;&amp;gt;&nbsp;guarantees&nbsp;do&nbsp;not&nbsp;apply.&nbsp;The&nbsp;current&nbsp;version&nbsp;of&nbsp;rabbit&nbsp;(2.5.0&nbsp;at&nbsp;the&lt;br&gt;&amp;gt;&nbsp;time&nbsp;of&nbsp;writing)&nbsp;will&nbsp;therefore&nbsp;not&nbsp;deliver&nbsp;those&nbsp;messages&nbsp;in&nbsp;order&lt;br&gt;<br>
&amp;gt;&nbsp;(unless&nbsp;the&nbsp;queue&nbsp;happens&nbsp;to&nbsp;be&nbsp;empty&nbsp;when&nbsp;requeues&nbsp;take&nbsp;place).&lt;br&gt;&amp;gt;&nbsp;Unfortunately&nbsp;stopping&nbsp;the&nbsp;producer&nbsp;will&nbsp;not&nbsp;change&nbsp;that.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;You&nbsp;could&nbsp;try&nbsp;to&nbsp;meet&nbsp;the&nbsp;conditions&nbsp;under&nbsp;which&nbsp;the&nbsp;broker&nbsp;preserves&lt;br&gt;<br>
&amp;gt;&nbsp;message&nbsp;order&nbsp;or&nbsp;you&nbsp;could&nbsp;detect&nbsp;the&nbsp;problem&nbsp;and&nbsp;attempt&nbsp;to&nbsp;deal&nbsp;with&lt;br&gt;&amp;gt;&nbsp;it&nbsp;downstream.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;-Emile&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;On&nbsp;15/06/11&nbsp;16:31,&nbsp;T-zex&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&nbsp;Tanks&nbsp;again!&lt;br&gt;&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;So,&nbsp;in&nbsp;case&nbsp;we&nbsp;detect&nbsp;that&nbsp;current&nbsp;message&nbsp;sequence&nbsp;number&nbsp;is&nbsp;bigger&lt;br&gt;&amp;gt;&amp;gt;&nbsp;than&nbsp;expected&nbsp;do&nbsp;we&nbsp;need&nbsp;to&nbsp;loop&nbsp;through&nbsp;the&nbsp;queue&nbsp;untill&nbsp;the&nbsp;required&lt;br&gt;&amp;gt;&amp;gt;&nbsp;message&nbsp;is&nbsp;found?&nbsp;Does&nbsp;this&nbsp;mean&nbsp;that&nbsp;producer&nbsp;must&nbsp;be&nbsp;stopped,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;because&nbsp;all&nbsp;other&nbsp;messages&nbsp;in&nbsp;front&nbsp;of&nbsp;the&nbsp;queue&nbsp;will&nbsp;become&nbsp;unacked&lt;br&gt;&amp;gt;&amp;gt;&nbsp;and&nbsp;will&nbsp;go&nbsp;back&nbsp;to&nbsp;the&nbsp;queue&nbsp;and&nbsp;new&nbsp;ones&nbsp;will&nbsp;appear&nbsp;at&nbsp;the&nbsp;front&nbsp;-&lt;br&gt;&amp;gt;&amp;gt;&nbsp;basically&nbsp;to&nbsp;avoid&nbsp;shuffling.&lt;br&gt;&amp;gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;Wed,&nbsp;Jun&nbsp;15,&nbsp;2011&nbsp;at&nbsp;4:03&nbsp;PM,&nbsp;Emile&nbsp;Joubert&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Message&nbsp;order&nbsp;guarantees&nbsp;only&nbsp;apply&nbsp;along&nbsp;the&nbsp;same&nbsp;path&nbsp;between&nbsp;a&nbsp;single&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;producer&nbsp;and&nbsp;consumer.&nbsp;The&nbsp;guarantees&nbsp;do&nbsp;not&nbsp;hold&nbsp;if&nbsp;messages&nbsp;get&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;requeued.&nbsp;Rabbit&nbsp;will&nbsp;requeue&nbsp;messages&nbsp;at&nbsp;the&nbsp;back&nbsp;of&nbsp;the&nbsp;queue,&nbsp;i.e.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;treat&nbsp;it&nbsp;as&nbsp;a&nbsp;new&nbsp;message.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;Your&nbsp;producer&nbsp;may&nbsp;add&nbsp;a&nbsp;sequence&nbsp;number&nbsp;to&nbsp;messages&nbsp;so&nbsp;that&nbsp;consumers&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;can&nbsp;detect&nbsp;this.&nbsp;Consumers&nbsp;may&nbsp;also&nbsp;inspect&nbsp;the&nbsp;&amp;quot;redelivered&amp;quot;&nbsp;flag&nbsp;to&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;check&nbsp;whether&nbsp;a&nbsp;message&nbsp;has&nbsp;been&nbsp;delivered&nbsp;before.&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;-Emile&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;15/06/11&nbsp;15:34,&nbsp;T-zex&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Thank&nbsp;you&nbsp;Emile.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;The&nbsp;thing&nbsp;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;solve&nbsp;is&nbsp;have&nbsp;a&nbsp;guaranteed&nbsp;order&nbsp;of&nbsp;messages:&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;if&nbsp;I&nbsp;fail&nbsp;to&nbsp;ack&nbsp;after&nbsp;BasicGet()&nbsp;the&nbsp;message&nbsp;anyway&nbsp;will&nbsp;go&nbsp;to&nbsp;the&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;end&nbsp;of&nbsp;the&nbsp;queue.&nbsp;In&nbsp;case&nbsp;noAck&nbsp;=&nbsp;true,&nbsp;there&nbsp;is&nbsp;a&nbsp;risk&nbsp;to&nbsp;lose&nbsp;a&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;message&nbsp;when&nbsp;a&nbsp;process&nbsp;fails.&nbsp;I&nbsp;can&amp;#39;t&nbsp;find&nbsp;a&nbsp;way&nbsp;to&nbsp;make&nbsp;RabbitMQ&nbsp;work&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;as&nbsp;a&nbsp;queue&nbsp;in&nbsp;a&nbsp;simple&nbsp;single&nbsp;reader&nbsp;scenario...&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;Wed,&nbsp;Jun&nbsp;15,&nbsp;2011&nbsp;at&nbsp;1:42&nbsp;PM,&nbsp;Emile&nbsp;Joubert&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Yes,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;retrieve&nbsp;a&nbsp;single&nbsp;message&nbsp;synchronously&nbsp;then&nbsp;use&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;IModel.BasicGet()&nbsp;.&nbsp;BasicConsume()&nbsp;is&nbsp;for&nbsp;asynchronous&nbsp;delivery&nbsp;of&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;messages,&nbsp;which&nbsp;is&nbsp;faster&nbsp;than&nbsp;BasicGet()&nbsp;and&nbsp;often&nbsp;leads&nbsp;to&nbsp;simpler&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;client&nbsp;code.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;15/06/11&nbsp;13:35,&nbsp;T-zex&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;In&nbsp;my&nbsp;case&nbsp;it&nbsp;doesn&amp;#39;t&nbsp;matter&nbsp;if&nbsp;it&nbsp;is&nbsp;IModel.Close()&nbsp;or&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;IModel.ChannelFlow(false)&nbsp;couse&nbsp;the&nbsp;process&nbsp;must&nbsp;be&nbsp;terminated&nbsp;anyway.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;We&nbsp;need&nbsp;an&nbsp;atomic&nbsp;operation&nbsp;which&nbsp;would&nbsp;ack&nbsp;the&nbsp;message&nbsp;and&nbsp;would&nbsp;not&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;fetch&nbsp;the&nbsp;other&nbsp;one.&nbsp;It&nbsp;seems&nbsp;that&nbsp;BasicConsume&nbsp;is&nbsp;unable&nbsp;to&nbsp;gurantee&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;that,&nbsp;so&nbsp;maybe&nbsp;BasicGet&nbsp;is&nbsp;a&nbsp;better&nbsp;option?&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;Wed,&nbsp;Jun&nbsp;15,&nbsp;2011&nbsp;at&nbsp;12:03&nbsp;PM,&nbsp;Emile&nbsp;Joubert&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Prefetch&nbsp;count&nbsp;limits&nbsp;the&nbsp;number&nbsp;of&nbsp;unacknowledged&nbsp;messages,&nbsp;so&nbsp;you&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;would&nbsp;need&nbsp;to&nbsp;acknowledge&nbsp;the&nbsp;last&nbsp;message&nbsp;to&nbsp;get&nbsp;the&nbsp;next&nbsp;one&nbsp;if&nbsp;the&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;prefetch&nbsp;count&nbsp;was&nbsp;set&nbsp;to&nbsp;1.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;You&nbsp;should&nbsp;never&nbsp;need&nbsp;to&nbsp;close&nbsp;the&nbsp;channel&nbsp;for&nbsp;flow&nbsp;control.&nbsp;You&nbsp;can&nbsp;use&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;IModel.ChannelFlow()&nbsp;if&nbsp;you&nbsp;need&nbsp;to&nbsp;temporarily&nbsp;stop&nbsp;the&nbsp;broker&nbsp;from&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;delivering&nbsp;messages.&nbsp;This&nbsp;works&nbsp;independently&nbsp;from&nbsp;the&nbsp;prefetch&nbsp;count.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;-Emile&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;15/06/11&nbsp;10:55,&nbsp;T-zex&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Thank&nbsp;you!&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;When&nbsp;prefetch&nbsp;count&nbsp;is&nbsp;set&nbsp;to&nbsp;1&nbsp;channel&nbsp;will&nbsp;try&nbsp;to&nbsp;fetch&nbsp;the&nbsp;next&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;message&nbsp;as&nbsp;soon&nbsp;as&nbsp;HandleBasicDeliver&nbsp;returns?&nbsp;Should&nbsp;I&nbsp;invoke&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Channel.Close()&nbsp;on&nbsp;a&nbsp;different&nbsp;thread&nbsp;(to&nbsp;avoid&nbsp;blocking)&nbsp;and&nbsp;then&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;return?&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;Wed,&nbsp;Jun&nbsp;15,&nbsp;2011&nbsp;at&nbsp;10:33&nbsp;AM,&nbsp;Emile&nbsp;Joubert&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;15/06/11&nbsp;10:08,&nbsp;T-zex&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;We&nbsp;are&nbsp;overriding&nbsp;DefaultBasicConsumer.HandleBasicDeliver&nbsp;method&nbsp;and&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;use&nbsp;IModel.BasicConsume&nbsp;to&nbsp;subscribe&nbsp;to&nbsp;incoming&nbsp;messages:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;model.BasicConsume(queue,&nbsp;false,&nbsp;instanceOfDerivedConsumer);&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;When&nbsp;application&nbsp;fails&nbsp;to&nbsp;ack&nbsp;a&nbsp;message&nbsp;that&nbsp;message&nbsp;is&nbsp;requeued.&nbsp;How&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;can&nbsp;I&nbsp;guarantee&nbsp;that&nbsp;BasicConsume&nbsp;is&nbsp;receiving&nbsp;one&nbsp;message&nbsp;at&nbsp;a&nbsp;time?&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;How&nbsp;to&nbsp;deterministically&nbsp;stop&nbsp;consuming&nbsp;when&nbsp;application&nbsp;detects&nbsp;that&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;it&nbsp;is&nbsp;unable&nbsp;to&nbsp;process&nbsp;a&nbsp;message&nbsp;and&nbsp;prevent&nbsp;the&nbsp;second&nbsp;message&nbsp;from&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;arriving?&nbsp;How&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;there&nbsp;is&nbsp;one&nbsp;and&nbsp;only&nbsp;one&nbsp;unacked&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;message&nbsp;and&nbsp;that&nbsp;message&nbsp;is&nbsp;at&nbsp;the&nbsp;peak&nbsp;of&nbsp;broker&nbsp;queue.&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;The&nbsp;solution&nbsp;is&nbsp;to&nbsp;set&nbsp;the&nbsp;prefetch&nbsp;count&nbsp;of&nbsp;the&nbsp;channel&nbsp;to&nbsp;1&nbsp;using&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;IModel.BasicQos().&nbsp;Also&nbsp;see&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/amqp-0-9-1-quickref.html#basic.qos&quot;&gt;http://www.rabbitmq.com/amqp-0-9-1-quickref.html#basic.qos&lt;/a&gt;&nbsp;.&lt;br&gt;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Note&nbsp;that&nbsp;rabbit&nbsp;does&nbsp;not&nbsp;implement&nbsp;the&nbsp;prefetch&nbsp;size&nbsp;or&nbsp;global&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;parameters&nbsp;to&nbsp;the&nbsp;same&nbsp;method.&lt;br&gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
