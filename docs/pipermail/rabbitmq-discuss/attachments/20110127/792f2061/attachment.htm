<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7654.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;Slow&nbsp;consumer&nbsp;disconnect&nbsp;availability&nbsp;on&nbsp;RAbbitMQ&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hi&nbsp;Jerry,&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thanks&nbsp;for&nbsp;getting&nbsp;back.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Actually&nbsp;we&nbsp;do&nbsp;have&nbsp;a&nbsp;requirement&nbsp;where&nbsp;I&nbsp;want&nbsp;consumer&nbsp;to&nbsp;stop&nbsp;getting&nbsp;message&nbsp;once&nbsp;I&nbsp;know&nbsp;that&nbsp;its&nbsp;slow(&nbsp;my&nbsp;consumption&nbsp;logic&nbsp;connects&nbsp;to&nbsp;remote&nbsp;server&nbsp;and&nbsp;if&nbsp;server&nbsp;is&nbsp;not&nbsp;responding&nbsp;or&nbsp;is&nbsp;slow&nbsp;for&nbsp;any&nbsp;reason&nbsp;I&nbsp;dont&nbsp;want&nbsp;my&nbsp;queue&nbsp;to&nbsp;get&nbsp;clogged),&nbsp;I&nbsp;would&nbsp;want&nbsp;to&nbsp;stop&nbsp;queue&nbsp;from&nbsp;populating.&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;catch&nbsp;here&nbsp;is&nbsp;,&nbsp;I&nbsp;too&nbsp;dont&nbsp;want&nbsp;to&nbsp;purge&nbsp;all&nbsp;the&nbsp;messages&nbsp;or&nbsp;drop&nbsp;it&nbsp;.&nbsp;I&nbsp;too&nbsp;tried&nbsp;to&nbsp;use&nbsp;TTL&nbsp;and&nbsp;queue&nbsp;lease&nbsp;,&nbsp;but&nbsp;am&nbsp;not&nbsp;sure&nbsp;about&nbsp;messages&nbsp;resisding&nbsp;in&nbsp;the&nbsp;queue&nbsp;i.e&nbsp;whether&nbsp;they&nbsp;are&nbsp;requed&nbsp;or&nbsp;silently&nbsp;dropped(&nbsp;in&nbsp;my&nbsp;case&nbsp;I&nbsp;want&nbsp;them&nbsp;to&nbsp;by&nbsp;returned&nbsp;back&nbsp;to&nbsp;exchange&nbsp;and&nbsp;make&nbsp;the&nbsp;queue&nbsp;alive&nbsp;after&nbsp;some&nbsp;duration)&lt;BR&gt;<br>
&lt;BR&gt;<br>
N.B:&nbsp;I&nbsp;guess&nbsp;suspending&nbsp;the&nbsp;queue&nbsp;can&nbsp;be&nbsp;little&nbsp;tricky&nbsp;,&nbsp;let&nbsp;me&nbsp;know&nbsp;yout&nbsp;thoughts&lt;BR&gt;<br>
&lt;BR&gt;<br>
Regds&lt;BR&gt;<br>
Prashant&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
-----Original&nbsp;Message-----&lt;BR&gt;<br>
From:&nbsp;Jerry&nbsp;Kuch&nbsp;[&lt;A&nbsp;HREF=&quot;mailto:jerryk@vmware.com&quot;&gt;mailto:jerryk@vmware.com&lt;/A&gt;]&lt;BR&gt;<br>
Sent:&nbsp;Wed&nbsp;1/26/2011&nbsp;11:45&nbsp;PM&lt;BR&gt;<br>
To:&nbsp;Prashant&nbsp;Yadav;&nbsp;rabbitmq-discuss@lists.rabbitmq.com&lt;BR&gt;<br>
Subject:&nbsp;RE:&nbsp;Slow&nbsp;consumer&nbsp;disconnect&nbsp;availability&nbsp;on&nbsp;RAbbitMQ&lt;BR&gt;<br>
&lt;BR&gt;<br>
Hi,&nbsp;Prashant...&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;gt;&nbsp;Do&nbsp;we&nbsp;have&nbsp;slow&nbsp;consumer&nbsp;detection&nbsp;available&nbsp;in&nbsp;RabbitMQ&nbsp;like&nbsp;we&nbsp;have&lt;BR&gt;<br>
&amp;gt;&nbsp;in&nbsp;Apache&nbsp;qpid&nbsp;(&nbsp;Slow&nbsp;Consumer&nbsp;Disconnect&nbsp;(SCD)&nbsp;is&nbsp;a&nbsp;new&nbsp;feature&nbsp;in&lt;BR&gt;<br>
&amp;gt;&nbsp;Qpid&nbsp;that&nbsp;provides&nbsp;a&nbsp;configurable&nbsp;mechanism&nbsp;to&nbsp;prevent&nbsp;a&nbsp;single&nbsp;slow&lt;BR&gt;<br>
&amp;gt;&nbsp;consumer&nbsp;from&nbsp;causing&nbsp;a&nbsp;back&nbsp;up&nbsp;of&nbsp;unconsumed&nbsp;messages&nbsp;on&nbsp;the&nbsp;broker&nbsp;)&lt;BR&gt;<br>
&lt;BR&gt;<br>
Possibly,&nbsp;but&nbsp;can&nbsp;I&nbsp;ask&nbsp;a&nbsp;couple&nbsp;of&nbsp;questions&nbsp;about&nbsp;your&nbsp;actual&nbsp;use&lt;BR&gt;<br>
case?&amp;nbsp;&nbsp;First,&nbsp;are&nbsp;you&nbsp;actually&nbsp;seeing&nbsp;cases&nbsp;where&nbsp;your&nbsp;consumers&nbsp;are&lt;BR&gt;<br>
so&nbsp;slow&nbsp;that&nbsp;the&nbsp;broker's&nbsp;own&nbsp;self&nbsp;defense&nbsp;mechanisms&nbsp;like&nbsp;paging&lt;BR&gt;<br>
messages&nbsp;to&nbsp;disk&nbsp;and&nbsp;memory-based&nbsp;producer&nbsp;flow&nbsp;control&nbsp;either&nbsp;aren't&lt;BR&gt;<br>
engaging,&nbsp;or&nbsp;are&nbsp;being&nbsp;overwhelmed&nbsp;in&nbsp;some&nbsp;way?&amp;nbsp;&nbsp;Second,&nbsp;are&nbsp;you&nbsp;sure&lt;BR&gt;<br>
you&nbsp;actually&nbsp;want&nbsp;to&nbsp;disconnect&nbsp;clients&nbsp;that&nbsp;are&nbsp;consuming&nbsp;slowly,&nbsp;but&lt;BR&gt;<br>
whose&nbsp;connections&nbsp;are&nbsp;otherwise&nbsp;alive&nbsp;and&nbsp;healthy?&lt;BR&gt;<br>
&lt;BR&gt;<br>
&amp;gt;&nbsp;This&nbsp;is&nbsp;a&nbsp;very&nbsp;nice&nbsp;feature&nbsp;wherein&nbsp;we&nbsp;could&nbsp;identify&nbsp;and&nbsp;take&lt;BR&gt;<br>
&amp;gt;&nbsp;corrective&nbsp;actions&nbsp;against&nbsp;the&nbsp;consumer.&nbsp;Please&nbsp;suggest&nbsp;any&lt;BR&gt;<br>
&amp;gt;&nbsp;alternative&nbsp;method&nbsp;to&nbsp;achieve&nbsp;this&nbsp;behavior.&nbsp;Also&nbsp;when&nbsp;we&nbsp;identify&nbsp;SCD&lt;BR&gt;<br>
&amp;gt;&nbsp;can&nbsp;we&nbsp;defer&nbsp;the&nbsp;queue&nbsp;for&nbsp;some&nbsp;time(&nbsp;timed&nbsp;defer)&nbsp;before&nbsp;it&nbsp;comes&lt;BR&gt;<br>
&amp;gt;&nbsp;back&nbsp;to&nbsp;service&nbsp;something&nbsp;like&nbsp;suspend&nbsp;Queue&nbsp;for&nbsp;5&nbsp;mins&nbsp;and&nbsp;try&lt;BR&gt;<br>
&amp;gt;&nbsp;again.&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;presume&nbsp;that&nbsp;one&nbsp;of&nbsp;the&nbsp;requirements&nbsp;of&nbsp;the&nbsp;behavior&nbsp;you&nbsp;desire&lt;BR&gt;<br>
would&nbsp;be&nbsp;that&nbsp;you&nbsp;discard&nbsp;messages&nbsp;from&nbsp;a&nbsp;queue&nbsp;whose&nbsp;consumers&nbsp;aren't&lt;BR&gt;<br>
keeping&nbsp;up&nbsp;to&nbsp;its&nbsp;load&nbsp;since&nbsp;simply&nbsp;disconnecting&nbsp;a&nbsp;slow&nbsp;consumer&lt;BR&gt;<br>
without&nbsp;some&nbsp;ability&nbsp;to&nbsp;replace&nbsp;it&nbsp;by&nbsp;one&nbsp;or&nbsp;more&nbsp;less&nbsp;slow&nbsp;ones&nbsp;isn't&lt;BR&gt;<br>
going&nbsp;to&nbsp;help.&amp;nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;you&nbsp;could&nbsp;try&nbsp;the&nbsp;per-queue&nbsp;message&nbsp;TTL&lt;BR&gt;<br>
extension&nbsp;that&nbsp;Rabbit&nbsp;supports.&amp;nbsp;&nbsp;It's&nbsp;documented&nbsp;here:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;A&nbsp;HREF=&quot;http://www.rabbitmq.com/extensions.html#queue-ttl&quot;&gt;http://www.rabbitmq.com/extensions.html#queue-ttl&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
This&nbsp;lets&nbsp;you&nbsp;declare&nbsp;queues&nbsp;with&nbsp;a&nbsp;limit&nbsp;on&nbsp;how&nbsp;long&nbsp;a&nbsp;message&lt;BR&gt;<br>
published&nbsp;to&nbsp;a&nbsp;queue&nbsp;can&nbsp;remain&nbsp;there&nbsp;before&nbsp;it&nbsp;is&nbsp;discarded.&amp;nbsp;&nbsp;This&lt;BR&gt;<br>
would&nbsp;let&nbsp;you&nbsp;escape&nbsp;the&nbsp;back&nbsp;up&nbsp;of&nbsp;unconsumed&nbsp;messages&nbsp;that&nbsp;you're&lt;BR&gt;<br>
concerned&nbsp;about&nbsp;and,&nbsp;for&nbsp;many&nbsp;types&nbsp;of&nbsp;message&nbsp;flows,&nbsp;is&nbsp;a&nbsp;sensible&lt;BR&gt;<br>
behavior&nbsp;in&nbsp;any&nbsp;event&nbsp;since&nbsp;the&nbsp;relevance&nbsp;of&nbsp;ancient&nbsp;messages&nbsp;that&lt;BR&gt;<br>
have&nbsp;been&nbsp;languishing&nbsp;unconsumed&nbsp;in&nbsp;queues&nbsp;probably&nbsp;degrades&nbsp;with&nbsp;time&lt;BR&gt;<br>
anyway.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Best&nbsp;regards,&lt;BR&gt;<br>
Jerry&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
