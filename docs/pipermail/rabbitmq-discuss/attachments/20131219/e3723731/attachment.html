<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;Simon,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; I&nbsp;tried&nbsp;restarting&nbsp;rabbitmq&nbsp;management&nbsp;and&nbsp;I&nbsp;got&nbsp;the&nbsp;following&nbsp;error.&nbsp;I&nbsp;am&nbsp;not&nbsp;able&nbsp;to&nbsp;use&nbsp;port&nbsp;15672&nbsp;at&nbsp;all.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;i&gt;sudo&nbsp;rabbitmqctl&nbsp;-n&nbsp;rabbit&nbsp;eval&nbsp;&#39;application:stop(rabbitmq_management),application:start(rabbitmq_management).&#39;&lt;/i&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;i&gt;{error,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp;{bad_return,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp;{{rabbit_mgmt_app,start,[normal,[]]},&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; {&#39;EXIT&#39;,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {{{case_clause,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {error,&lt;/i&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {no_record_for_listener,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [{port,55672},{ignore_in_use,true}]}}},&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [{rabbit_mochiweb_registry,handle_call,3},&lt;/i&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{gen_server,handle_msg,5},&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{proc_lib,init_p_do_apply,3}]},&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{gen_server,call,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[rabbit_mochiweb_registry,&lt;/i&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {add,rabbit_mgmt_redirect,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [{port,55672},{ignore_in_use,true}],&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #Fun&lt;rabbit_mochiweb.1.105980535&gt;,&lt;/i&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #Fun&lt;rabbit_mochiweb.0.34137573&gt;,&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {[],&quot;Redirect&nbsp;to&nbsp;port&nbsp;15672&quot;}},&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; infinity]}}}}}}&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt;...done.&lt;/i&gt;&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;i&gt;&lt;br&gt;&lt;/i&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;Is&nbsp;there&nbsp;anyway&nbsp;bring&nbsp;it&nbsp;back&nbsp;up&nbsp;without&nbsp;restarting&nbsp;the&nbsp;app?&lt;br&gt;&lt;br&gt;Shri&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;19,&nbsp;2013&nbsp;at&nbsp;9:27&nbsp;AM,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;19/12/13&nbsp;16:35,&nbsp;shridharan&nbsp;muthu&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;You&nbsp;are&nbsp;spot&nbsp;on&nbsp;Simon.&nbsp;We&nbsp;are&nbsp;using&nbsp;3.0.2&nbsp;version&nbsp;in&nbsp;our&lt;br&gt;<br>
cluster.&nbsp;In&nbsp;this&nbsp;case,&nbsp;restarting&nbsp;node&nbsp;will&nbsp;not&nbsp;help&nbsp;I&nbsp;guess.&nbsp;Can&nbsp;I&lt;br&gt;<br>
delete&nbsp;these&nbsp;blocked/blocking&nbsp;connections&nbsp;from&nbsp;Management&nbsp;UI?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
The&nbsp;only&nbsp;way&nbsp;to&nbsp;do&nbsp;that&nbsp;is&nbsp;to&nbsp;restart&nbsp;the&nbsp;management&nbsp;stats&nbsp;database:&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;rabbitmqctl&nbsp;-n&nbsp;&lt;node&nbsp;with&nbsp;the&nbsp;stats&nbsp;db&gt;&nbsp;eval&nbsp;&#39;application:stop(rabbitmq_&lt;u&gt;&lt;/u&gt;management),application:start(&lt;u&gt;&lt;/u&gt;rabbitmq_management).&#39;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
 &nbsp; &nbsp; &nbsp;Could&nbsp;it&nbsp;be&nbsp;cause&nbsp;of&nbsp;the&nbsp;blocked&nbsp;connections?&nbsp;I&nbsp;will&nbsp;check&nbsp;the&lt;br&gt;<br>
memory&nbsp;usage&nbsp;after&nbsp;cleaning&nbsp;up&nbsp;the&nbsp;connections.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
I&nbsp;doubt&nbsp;it,&nbsp;those&nbsp;connections&nbsp;don&#39;t&nbsp;really&nbsp;exist&nbsp;except&nbsp;as&nbsp;rows&nbsp;in&nbsp;the&nbsp;management&nbsp;stats&nbsp;db.&nbsp;But&nbsp;note&nbsp;that&nbsp;we&nbsp;have&nbsp;fixed&nbsp;a&nbsp;few&nbsp;memory&nbsp;leaks&nbsp;since&nbsp;3.0.2.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
 &nbsp; &nbsp;/You&nbsp;could&nbsp;use&nbsp;a&nbsp;higher&nbsp;priority&nbsp;&quot;nodes&quot;&nbsp;policy&nbsp;to&nbsp;move&nbsp;the&nbsp;master&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;to&nbsp;node&nbsp;2,&nbsp;then&nbsp;delete&nbsp;it&nbsp;again&nbsp;(albeit&nbsp;the&nbsp;queue&nbsp;would&nbsp;be&lt;br&gt;<br>
 &nbsp; &nbsp;unmirrored&nbsp;while&nbsp;this&nbsp;was&nbsp;taking&nbsp;place).&nbsp;Oh,&nbsp;but&nbsp;you&nbsp;need&nbsp;to&nbsp;be&nbsp;on&lt;br&gt;<br>
 &nbsp; &nbsp;at&nbsp;least&nbsp;RabbitMQ&nbsp;3.1.x&nbsp;for&nbsp;that&nbsp;to&nbsp;work,&nbsp;3.0.x&nbsp;does&nbsp;not&nbsp;let&nbsp;a&lt;br&gt;&lt;/div&gt;<br>
 &nbsp; &nbsp;mirroring&nbsp;policy&nbsp;move&nbsp;the&nbsp;master./&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;Ah!&nbsp;But&nbsp;that&nbsp;would&nbsp;leave&nbsp;with&nbsp;tightly&nbsp;coupling&nbsp;queues&nbsp;to&nbsp;nodes.&lt;br&gt;<br>
&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Only&nbsp;until&nbsp;you&nbsp;delete&nbsp;the&nbsp;&quot;nodes&quot;&nbsp;policy&nbsp;-&nbsp;you&nbsp;can&nbsp;use&nbsp;that&nbsp;to&nbsp;move&nbsp;the&nbsp;master,&nbsp;but&nbsp;then&nbsp;revert&nbsp;to&nbsp;an&nbsp;&quot;all&quot;&nbsp;policy;&nbsp;at&nbsp;which&nbsp;point&nbsp;the&nbsp;master&nbsp;will&nbsp;stay&nbsp;where&nbsp;it&nbsp;is.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
 &nbsp; &nbsp;/OTOH&nbsp;if&nbsp;the&nbsp;queues&nbsp;are&nbsp;mirrored&nbsp;to&nbsp;all&nbsp;nodes&nbsp;anyway,&nbsp;why&nbsp;worry?&nbsp;A&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp;slave&nbsp;takes&nbsp;about&nbsp;as&nbsp;many&nbsp;resources&nbsp;as&nbsp;a&nbsp;master&nbsp;anyway,&nbsp;so&nbsp;all&nbsp;your&lt;br&gt;<br>
 &nbsp; &nbsp;masters&nbsp;being&nbsp;on&nbsp;one&nbsp;node&nbsp;and&nbsp;all&nbsp;the&nbsp;slaves&nbsp;on&nbsp;the&nbsp;other&nbsp;should&nbsp;be&lt;br&gt;<br>
 &nbsp; &nbsp;no&nbsp;big&nbsp;deal.&lt;br&gt;&lt;/div&gt;<br>
 &nbsp; &nbsp;/&lt;br&gt;<br>
&lt;br&gt;<br>
//&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
 &nbsp; &nbsp; My&nbsp;understanding&nbsp;is&nbsp;that&nbsp;all&nbsp;operations&nbsp;(publish,&nbsp;consume)&nbsp;on&nbsp;a&lt;br&gt;<br>
queue&nbsp;will&nbsp;be&nbsp;forwarded&nbsp;from&nbsp;slaves&nbsp;to&nbsp;the&nbsp;master&nbsp;(where&nbsp;it&nbsp;will&nbsp;be&lt;br&gt;<br>
executed&nbsp;and&nbsp;broadcasted&nbsp;to&nbsp;all&nbsp;mirrors)&nbsp;and&nbsp;all&nbsp;the&nbsp;messages&nbsp;in&nbsp;the&lt;br&gt;<br>
mirror&nbsp;will&nbsp;be&nbsp;used&nbsp;only&nbsp;when&nbsp;the&nbsp;master&nbsp;goes&nbsp;down.&lt;br&gt;<br>
&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Yes.&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
This&nbsp;sounds&nbsp;like&lt;br&gt;<br>
slaves&nbsp;are&nbsp;just&nbsp;forwarding&nbsp;messages&nbsp;all&nbsp;the&nbsp;time&nbsp;(1&nbsp;hop&nbsp;penalty)&nbsp;and&lt;br&gt;<br>
generates&nbsp;more&nbsp;traffic&nbsp;between&nbsp;slaves&nbsp;&amp;&nbsp;the&nbsp;master.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Sure,&nbsp;but&nbsp;how&nbsp;will&nbsp;distributing&nbsp;the&nbsp;masters&nbsp;around&nbsp;the&nbsp;cluster&nbsp;help&nbsp;that?&nbsp;Or&nbsp;are&nbsp;you&nbsp;saying&nbsp;your&nbsp;clients&nbsp;know&nbsp;that&nbsp;some&nbsp;queues&nbsp;are&nbsp;on&nbsp;node&nbsp;2,&nbsp;and&nbsp;expect&nbsp;to&nbsp;connect&nbsp;to&nbsp;that&nbsp;node&nbsp;to&nbsp;use&nbsp;that&nbsp;queue?&nbsp;If&nbsp;so&nbsp;that&nbsp;makes&nbsp;sense...&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
