<tt>
I'm&nbsp;using&nbsp;6&nbsp;servers&nbsp;to&nbsp;make&nbsp;a&nbsp;cluster&nbsp;and&nbsp;they&nbsp;are&nbsp;all&nbsp;disk&nbsp;nodes.&nbsp;I&nbsp;use&nbsp;rabbitmq&nbsp;for&nbsp;collecting&nbsp;log&nbsp;file&nbsp;for&nbsp;our&nbsp;website.&nbsp;Now&nbsp;at&nbsp;the&nbsp;peak&nbsp;hour,&nbsp;the&nbsp;publish&nbsp;rate&nbsp;is&nbsp;about&nbsp;30k&nbsp;message&nbsp;per&nbsp;second.&nbsp;There&nbsp;are&nbsp;2&nbsp;main&nbsp;consumers(hdfs&nbsp;and&nbsp;elasticsearch)&nbsp;and&nbsp;each&nbsp;one&nbsp;need&nbsp;to&nbsp;handle&nbsp;all&nbsp;message,&nbsp;so&nbsp;the&nbsp;delivery&nbsp;rate&nbsp;hit&nbsp;about&nbsp;60k&nbsp;per&nbsp;second.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;my&nbsp;scenario,&nbsp;a&nbsp;single&nbsp;server&nbsp;can&nbsp;hold&nbsp;10k&nbsp;delivery&nbsp;rate&nbsp;and&nbsp;I&nbsp;use&nbsp;6&nbsp;node&nbsp;to&nbsp;load&nbsp;balance&nbsp;the&nbsp;pressure.&nbsp;My&nbsp;solution&nbsp;is&nbsp;that&nbsp;I&nbsp;created&nbsp;2&nbsp;queues&nbsp;on&nbsp;each&nbsp;node.&nbsp;Each&nbsp;message&nbsp;is&nbsp;with&nbsp;a&nbsp;random&nbsp;routing-key(something&nbsp;like&nbsp;message.0,&nbsp;message.1,&nbsp;etc)&nbsp;to&nbsp;distribute&nbsp;the&nbsp;pressure&nbsp;to&nbsp;every&nbsp;node.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;confused&nbsp;me&nbsp;is:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;All&nbsp;message&nbsp;send&nbsp;to&nbsp;one&nbsp;node.&nbsp;Should&nbsp;I&nbsp;use&nbsp;a&nbsp;HA&nbsp;Proxy&nbsp;to&nbsp;load&nbsp;balance&nbsp;this&nbsp;publish&nbsp;pressure?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;Is&nbsp;there&nbsp;any&nbsp;performance&nbsp;difference&nbsp;between&nbsp;Durable&nbsp;Queues&nbsp;and&nbsp;Transient&nbsp;Queues?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&nbsp;style=&quot;line-height:&nbsp;normal;&quot;&gt;Is&nbsp;there&nbsp;any&nbsp;performance&nbsp;difference&nbsp;between&nbsp;Memory&nbsp;Node&nbsp;and&nbsp;Disk&nbsp;Node?&nbsp;What&nbsp;I&nbsp;know&nbsp;is&nbsp;the&nbsp;difference&nbsp;between&nbsp;memory&nbsp;node&nbsp;and&nbsp;disk&nbsp;node&nbsp;is&nbsp;only&nbsp;about&nbsp;the&nbsp;meta&nbsp;data&nbsp;such&nbsp;as&nbsp;queue&nbsp;configuration.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;How&nbsp;can&nbsp;I&nbsp;import&nbsp;the&nbsp;performance&nbsp;in&nbsp;publish&nbsp;and&nbsp;delivery&nbsp;codes?&nbsp;I've&nbsp;researched&nbsp;and&nbsp;I&nbsp;know&nbsp;several&nbsp;methods:&lt;/li&gt;&lt;ul&gt;&lt;li&gt;disable&nbsp;the&nbsp;confirm&nbsp;mechanism(in&nbsp;publish&nbsp;codes?)&lt;/li&gt;&lt;li&gt;enable&nbsp;HiPE(I've&nbsp;done&nbsp;that&nbsp;and&nbsp;it&nbsp;helped&nbsp;a&nbsp;lot)&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;For&nbsp;example,&nbsp;input&nbsp;is&nbsp;1w&nbsp;mps(message&nbsp;per&nbsp;second),&nbsp;there&nbsp;are&nbsp;two&nbsp;consumers&nbsp;to&nbsp;consume&nbsp;all&nbsp;message.&nbsp;Then&nbsp;the&nbsp;output&nbsp;is&nbsp;2w&nbsp;mps.&nbsp;If&nbsp;my&nbsp;server&nbsp;can&nbsp;handle&nbsp;1w&nbsp;mps,&nbsp;I&nbsp;need&nbsp;two&nbsp;server&nbsp;to&nbsp;handle&nbsp;the&nbsp;2w-mps-pressure.&nbsp;Now&nbsp;a&nbsp;new&nbsp;consumer&nbsp;need&nbsp;to&nbsp;consume&nbsp;all&nbsp;message,&nbsp;too.&nbsp;As&nbsp;a&nbsp;result,&nbsp;output&nbsp;hits&nbsp;3w&nbsp;mps,&nbsp;so&nbsp;I&nbsp;need&nbsp;another&nbsp;one&nbsp;more&nbsp;server.&nbsp;For&nbsp;a&nbsp;conclusion,&nbsp;one&nbsp;more&nbsp;consumer&nbsp;for&nbsp;all&nbsp;message,&nbsp;one&nbsp;more&nbsp;server?&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;
</tt>
