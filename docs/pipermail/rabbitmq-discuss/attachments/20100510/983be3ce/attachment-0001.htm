<tt>
Thanks&nbsp;guys.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;May&nbsp;10,&nbsp;2010&nbsp;at&nbsp;6:30&nbsp;AM,&nbsp;Matthew&nbsp;Sackman&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthew@lshift.net&quot;&gt;matthew@lshift.net&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Mon,&nbsp;May&nbsp;10,&nbsp;2010&nbsp;at&nbsp;09:35:24AM&nbsp;+0200,&nbsp;Martin&nbsp;Sustrik&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Gustavo,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;If&nbsp;RabbitMQ&nbsp;are&nbsp;receiving&nbsp;20&nbsp;messages&nbsp;per&nbsp;millisecond&nbsp;from&nbsp;publisher&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;each&nbsp;message&nbsp;have&nbsp;213&nbsp;bytes,&nbsp;what&nbsp;the&nbsp;size&nbsp;of&nbsp;packages&nbsp;over&nbsp;network&nbsp;to&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;consumer&nbsp;or&nbsp;other&nbsp;broker?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;20&nbsp;msgs/ms&nbsp;=&nbsp;1&nbsp;message&nbsp;each&nbsp;50&nbsp;us&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;This&nbsp;means&nbsp;(under&nbsp;Linux&nbsp;at&nbsp;least)&nbsp;that&nbsp;each&nbsp;message&nbsp;is&nbsp;sent&nbsp;as&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;separate&nbsp;packet.&nbsp;Or&nbsp;maybe&nbsp;three&nbsp;packets&nbsp;per&nbsp;message.&nbsp;It&nbsp;depends&nbsp;on&lt;br&gt;<br>
&amp;gt;&nbsp;whether&nbsp;RabbitMQ&nbsp;sends&nbsp;message&nbsp;using&nbsp;single&nbsp;OS&nbsp;call&nbsp;or&nbsp;whether&nbsp;is&nbsp;sends&lt;br&gt;<br>
&amp;gt;&nbsp;each&nbsp;frame&nbsp;separately.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;We&nbsp;make&nbsp;one&nbsp;call&nbsp;to&nbsp;write&nbsp;the&nbsp;entire&nbsp;message.&nbsp;Whilst&nbsp;this,&nbsp;at&nbsp;least&nbsp;in&lt;br&gt;<br>
Erlang&nbsp;land,&nbsp;consists&nbsp;of&nbsp;writing&nbsp;an&nbsp;io_list&nbsp;(which&nbsp;is&nbsp;a&nbsp;(potentially&lt;br&gt;<br>
deep)&nbsp;list&nbsp;of&nbsp;binaries),&nbsp;last&nbsp;I&nbsp;checked,&nbsp;this&nbsp;is&nbsp;very&nbsp;performant&nbsp;as&lt;br&gt;<br>
Erlang&nbsp;maps&nbsp;this&nbsp;to&nbsp;a&nbsp;writev,&nbsp;thus&nbsp;does&nbsp;not&nbsp;have&nbsp;overheads&nbsp;of&nbsp;copying&lt;br&gt;<br>
data&nbsp;into&nbsp;one&nbsp;contiguous&nbsp;block&nbsp;before&nbsp;writing.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Matthew&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
