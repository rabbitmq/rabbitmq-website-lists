<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;10pt;<br>
font-family:Tahoma<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;<br>
Hello,&lt;br&gt;&lt;br&gt;For&nbsp;some&nbsp;reason,&nbsp;I'm&nbsp;unable&nbsp;to&nbsp;publish&nbsp;messages&nbsp;to&nbsp;any&nbsp;exchange/queue&nbsp;on&nbsp;one&nbsp;of&nbsp;the&nbsp;VMs&nbsp;I'm&nbsp;using&nbsp;for&nbsp;testing&nbsp;RabbitMQ&nbsp;federations.&nbsp;My&nbsp;setup&nbsp;is&nbsp;as&nbsp;follows:&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;two&nbsp;VMs&nbsp;named&nbsp;rabbit1&nbsp;and&nbsp;rabbit2,&nbsp;both&nbsp;with&nbsp;the&nbsp;federation&nbsp;plugin&nbsp;enabled.&nbsp;&lt;br&gt;Rabbit1&nbsp;is&nbsp;configured&nbsp;[1]&nbsp;with&nbsp;a&nbsp;federated&nbsp;exchange&nbsp;with&nbsp;a&nbsp;connection&nbsp;to&nbsp;rabbit2.&lt;br&gt;&lt;br&gt;When&nbsp;I&nbsp;look&nbsp;at&nbsp;the&nbsp;federation&nbsp;status,&nbsp;I&nbsp;see&nbsp;that&nbsp;the&nbsp;connection&nbsp;is&nbsp;successfully&nbsp;established.&nbsp;The&nbsp;appropriate&nbsp;upstream&nbsp;exchange&nbsp;and&nbsp;queue&nbsp;are&nbsp;also&nbsp;automatically&nbsp;created&nbsp;on&nbsp;rabbit2.&nbsp;However,&nbsp;if&nbsp;I&nbsp;try&nbsp;to&nbsp;publish&nbsp;to&nbsp;an&nbsp;exchange&nbsp;from&nbsp;rabbit2,&nbsp;the&nbsp;code&nbsp;appears&nbsp;to&nbsp;hang&nbsp;and&nbsp;the&nbsp;message&nbsp;is&nbsp;never&nbsp;delivered.&nbsp;This&nbsp;happens&nbsp;whether&nbsp;I'm&nbsp;publishing&nbsp;to&nbsp;the&nbsp;upstream&nbsp;federated&nbsp;exchange,&nbsp;or&nbsp;just&nbsp;to&nbsp;a&nbsp;local&nbsp;exchange&nbsp;and&nbsp;queue.&nbsp;An&nbsp;example&nbsp;Test.java&nbsp;[2]&nbsp;runs&nbsp;correctly&nbsp;on&nbsp;rabbit1&nbsp;or&nbsp;my&nbsp;local&nbsp;machine,&nbsp;but&nbsp;doesn't&nbsp;complete&nbsp;on&nbsp;rabbit2.&nbsp;It&nbsp;might&nbsp;be&nbsp;worth&nbsp;noting&nbsp;that&nbsp;the&nbsp;print&nbsp;statement&nbsp;_does_&nbsp;execute&nbsp;after&nbsp;channel.basicPublish(...),&nbsp;but&nbsp;prints&nbsp;put&nbsp;after&nbsp;channel.close()&nbsp;or&nbsp;connection.close()&nbsp;don't&nbsp;occur.&lt;br&gt;&lt;br&gt;I'm&nbsp;not&nbsp;sure&nbsp;what&nbsp;the&nbsp;next&nbsp;step&nbsp;is&nbsp;in&nbsp;troubleshooting&nbsp;this.&nbsp;Any&nbsp;help&nbsp;would&nbsp;be&nbsp;appreciated.&lt;br&gt;&lt;br&gt;Thanks&nbsp;for&nbsp;taking&nbsp;a&nbsp;look.&lt;br&gt;&lt;br&gt;&lt;br&gt;[1]&nbsp;Rabbit1's&nbsp;rabbitmq.config&lt;br&gt;&lt;br&gt;[{rabbitmq_federation,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{exchanges,&nbsp;[[{exchange,&nbsp;&quot;high&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{type,&nbsp;&quot;topic&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{upstream_set,&nbsp;&quot;tomcats&quot;}]]},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{upstream_sets,&nbsp;[{&quot;tomcats&quot;,&nbsp;[[{connection,&nbsp;&quot;tomcat1&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{exchange,&nbsp;&quot;highw1&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{max_hops,&nbsp;1}]&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;]}]},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{connections,&nbsp;[{&quot;tomcat1&quot;,&nbsp;[{host,&nbsp;&quot;out&quot;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{port,&nbsp;5672}]}]}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;]&lt;br&gt;}].&lt;br&gt;&lt;br&gt;&lt;br&gt;[2]&nbsp;The&nbsp;code&nbsp;in&nbsp;Test.java&lt;br&gt;&lt;br&gt;import&nbsp;com.rabbitmq.client.ConnectionFactory;&lt;br&gt;import&nbsp;com.rabbitmq.client.Connection;&lt;br&gt;import&nbsp;com.rabbitmq.client.Channel;&lt;br&gt;&lt;br&gt;public&nbsp;class&nbsp;Test&nbsp;{&lt;br&gt;&lt;br&gt;&amp;nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;argv)&nbsp;throws&nbsp;Exception&nbsp;{&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ConnectionFactory&nbsp;factory&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;factory.setHost(&quot;localhost&quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Connection&nbsp;connection&nbsp;=&nbsp;factory.newConnection();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Channel&nbsp;channel&nbsp;=&nbsp;connection.createChannel();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.exchangeDeclare(&quot;testexchange&quot;,&nbsp;&quot;topic&quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.queueDeclare(&quot;testqueue&quot;,&nbsp;true,&nbsp;false,&nbsp;false,&nbsp;null);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.queueBind(&quot;testqueue&quot;,&nbsp;&quot;testexchange&quot;,&nbsp;&quot;photo&quot;);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;String&nbsp;message&nbsp;=&nbsp;&quot;Hello&nbsp;World!&quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.basicPublish(&quot;testexchange&quot;,&nbsp;&quot;photo&quot;,&nbsp;null,&nbsp;message.getBytes());&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;System.out.println(&quot;&nbsp;[x]&nbsp;Sent&nbsp;'&quot;&nbsp;+&nbsp;message&nbsp;+&nbsp;&quot;'&quot;);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.close();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;connection.close();&lt;br&gt;&amp;nbsp;&nbsp;}&lt;br&gt;}&lt;br&gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
