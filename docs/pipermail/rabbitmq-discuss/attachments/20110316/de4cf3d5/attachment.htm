<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--&nbsp;DIV&nbsp;{margin:0px;}&nbsp;--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;font-size:10pt&quot;&gt;&lt;div&gt;John,&lt;br&gt;&lt;br&gt;I&nbsp;tried&nbsp;building&nbsp;my&nbsp;previous&nbsp;patched&nbsp;amqp_consumer&nbsp;with&nbsp;latest&nbsp;rabbitmq-c,&nbsp;however,&nbsp;the&nbsp;build&nbsp;breaks&nbsp;because&nbsp;the&nbsp;current&nbsp;amqp.h&nbsp;does&nbsp;not&nbsp;support&nbsp;AMQP_SIMPLE_RPC&nbsp;anymore.&amp;nbsp;&nbsp;Ideally&nbsp;amqp.h&nbsp;should&nbsp;support&nbsp;the&nbsp;following&nbsp;function,&nbsp;as&nbsp;commented&nbsp;in&nbsp;my&nbsp;patch:&lt;br&gt;&lt;br&gt;/*&nbsp;amqp.h&nbsp;should&nbsp;support&nbsp;this&nbsp;*/&lt;br&gt;int&nbsp;amqp_basic_qos(amqp_connection_state_t&nbsp;state,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;amqp_channel_t&nbsp;channel,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;uint32_t<br>
&nbsp;prefetch_size,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;uint16_t&nbsp;prefetch_count,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;amqp_boolean_t&nbsp;global)&lt;br&gt;&lt;br&gt;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;if&nbsp;rabbitmq-c&nbsp;maintainer&nbsp;could&nbsp;add&nbsp;this&nbsp;api.&amp;nbsp;&nbsp;otherwise,&nbsp;i&nbsp;have&nbsp;to&nbsp;take&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;src&nbsp;code&nbsp;and&nbsp;see&nbsp;if&nbsp;it&nbsp;can&nbsp;be&nbsp;implemented.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;font-size:&nbsp;10pt;&quot;&gt;thanks.&lt;br&gt;&lt;br&gt;-alex&lt;br&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&lt;font&nbsp;face=&quot;Tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;hr&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;From:&lt;/span&gt;&lt;/b&gt;&nbsp;John&nbsp;DeTreville&nbsp;&amp;lt;john@detreville.org&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;To:&lt;/span&gt;&lt;/b&gt;&nbsp;alex&nbsp;chen<br>
&nbsp;&amp;lt;chen650@yahoo.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Cc:&lt;/span&gt;&lt;/b&gt;&nbsp;rabbitmq&nbsp;&amp;lt;rabbitmq-discuss@lists.rabbitmq.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Sent:&lt;/span&gt;&lt;/b&gt;&nbsp;Wed,&nbsp;March&nbsp;16,&nbsp;2011&nbsp;7:04:08&nbsp;PM&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Subject:&lt;/span&gt;&lt;/b&gt;&nbsp;Re:&nbsp;[rabbitmq-discuss]&nbsp;server&nbsp;crashes&nbsp;with&nbsp;very&nbsp;fast&nbsp;consumers&lt;br&gt;&lt;/font&gt;&lt;br&gt;<br>
Alex,&lt;br&gt;&lt;br&gt;I'm&nbsp;trying&nbsp;to&nbsp;reproduce&nbsp;your&nbsp;problems&nbsp;and&nbsp;I'm&nbsp;having&nbsp;a&nbsp;very&nbsp;hard&nbsp;time&nbsp;doing&nbsp;so.&lt;br&gt;&lt;br&gt;Your&nbsp;example&nbsp;code&nbsp;is&nbsp;based&nbsp;on&nbsp;your&nbsp;own&nbsp;modifications&nbsp;to&nbsp;the&nbsp;sources&nbsp;in&nbsp;the&nbsp;rabbitmq-c/examples&nbsp;directory&nbsp;in&nbsp;some&nbsp;revision&nbsp;from&nbsp;last&nbsp;summer,&nbsp;which&nbsp;itself&nbsp;depends&nbsp;on&nbsp;some&nbsp;revision&nbsp;of&nbsp;rabbitmq-codegen&nbsp;from&nbsp;last&nbsp;summer.&nbsp;I'm&nbsp;having&nbsp;a&nbsp;hard&nbsp;time&nbsp;building&nbsp;it.&lt;br&gt;&lt;br&gt;I'm&nbsp;guessing&nbsp;you've&nbsp;run&nbsp;all&nbsp;of&nbsp;this&nbsp;much&nbsp;more&nbsp;recently.&nbsp;Could&nbsp;you&nbsp;please&nbsp;mail&nbsp;us&nbsp;a&nbsp;&lt;a&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://bind.sh&quot;&gt;bind.sh&lt;/a&gt;,&nbsp;&lt;a&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://producer.sh&quot;&gt;producer.sh&lt;/a&gt;,&nbsp;and&nbsp;&lt;a&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://consumer.sh&quot;&gt;consumer.sh&lt;/a&gt;&nbsp;that&nbsp;work&nbsp;with&nbsp;the&nbsp;current&nbsp;rabbitmq-c/examples&nbsp;directory?&nbsp;Could&nbsp;you&nbsp;also&nbsp;add&nbsp;your&nbsp;modifications&nbsp;to&nbsp;the&nbsp;source&nbsp;code&nbsp;in&nbsp;the&nbsp;current&nbsp;rabbitmq-c/examples&nbsp;directory?&nbsp;This&nbsp;would&nbsp;help&nbsp;a&nbsp;great&nbsp;deal.&lt;br&gt;&lt;br&gt;Even&nbsp;so,&nbsp;I've&nbsp;been&nbsp;able&nbsp;to&nbsp;reproduce&nbsp;some&nbsp;crashes,&nbsp;but&nbsp;I&nbsp;very&nbsp;much&nbsp;doubt&nbsp;they're&nbsp;the&nbsp;same&nbsp;crashes&nbsp;that&nbsp;you're&nbsp;seeing.&nbsp;Again,&nbsp;please&nbsp;tell&nbsp;me&nbsp;exactly<br>
&nbsp;what&nbsp;to&nbsp;do&nbsp;to&nbsp;reproduce&nbsp;your&nbsp;problem,&nbsp;starting&nbsp;with&nbsp;the&nbsp;current&nbsp;version&nbsp;of&nbsp;rabbitmq-c.&nbsp;Thank&nbsp;you.&lt;br&gt;&lt;br&gt;Cheers,&lt;br&gt;John&lt;br&gt;&lt;br&gt;On&nbsp;Mar&nbsp;14,&nbsp;2011,&nbsp;at&nbsp;4:29&nbsp;PM,&nbsp;Matthias&nbsp;Radestock&nbsp;wrote:&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;Alex,&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;alex&nbsp;chen&nbsp;wrote:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Any&nbsp;chance&nbsp;you&nbsp;could&nbsp;script&nbsp;the&nbsp;above&nbsp;to&nbsp;the&nbsp;point&nbsp;where&nbsp;all&nbsp;one&nbsp;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;needs&nbsp;to&nbsp;do&nbsp;is:&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;1)&nbsp;start&nbsp;clean&nbsp;rabbit&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;2)&nbsp;run&nbsp;test&nbsp;script&lt;br&gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;3)&nbsp;wait&nbsp;for&nbsp;broker&nbsp;to&nbsp;die&lt;br&gt;&amp;gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&amp;gt;&nbsp;The&nbsp;test&nbsp;scripts&nbsp;are&nbsp;exactly&nbsp;the&nbsp;same&nbsp;as&nbsp;before:&lt;br&gt;&lt;span&gt;&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008570.html&quot;&gt;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2010-August/008570.html&lt;/a&gt;&lt;/span&gt;&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;It&nbsp;would&nbsp;really&nbsp;help&nbsp;if&nbsp;you&nbsp;consolidated&nbsp;all&nbsp;that&nbsp;into&nbsp;a&nbsp;simple&nbsp;set&nbsp;up&nbsp;&lt;br&gt;&amp;gt;&nbsp;as&nbsp;I&nbsp;mention&nbsp;above.&nbsp;As&nbsp;it&nbsp;stands&nbsp;we&nbsp;have&nbsp;to&nbsp;piece&nbsp;together&nbsp;the&nbsp;test&nbsp;code&nbsp;&lt;br&gt;&amp;gt;&nbsp;and&nbsp;scripts&nbsp;from&nbsp;various&nbsp;emails.&nbsp;That&nbsp;a)<br>
&nbsp;takes&nbsp;time,&nbsp;and&nbsp;b)&nbsp;increases&nbsp;&lt;br&gt;&amp;gt;&nbsp;the&nbsp;chances&nbsp;that&nbsp;we&nbsp;will&nbsp;be&nbsp;doing&nbsp;something&nbsp;slightly&nbsp;different&nbsp;and&nbsp;thus&nbsp;&lt;br&gt;&amp;gt;&nbsp;not&nbsp;be&nbsp;able&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;problem.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Regards,&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Matthias.&lt;br&gt;&amp;gt;&nbsp;PS:&nbsp;please&nbsp;keep&nbsp;rabbitmq-discuss&nbsp;on&nbsp;the&nbsp;cc.&lt;br&gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;ymailto=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;&lt;/html&gt;
</tt>
