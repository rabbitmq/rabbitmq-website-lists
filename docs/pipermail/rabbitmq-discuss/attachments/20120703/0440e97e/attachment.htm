<tt>
We&amp;#39;ve&nbsp;recently&nbsp;started&nbsp;using&nbsp;the&nbsp;heartbeat&nbsp;connection&nbsp;option,&nbsp;and&nbsp;I&nbsp;need&nbsp;to&nbsp;understand&nbsp;them&nbsp;precisely.&nbsp;I&nbsp;understand&nbsp;that&nbsp;both&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;can&nbsp;send&nbsp;heartbeat&nbsp;frames,&nbsp;that&nbsp;other&nbsp;activity&nbsp;can&nbsp;substitute&nbsp;for&nbsp;a&nbsp;heartbeat&nbsp;frame,&nbsp;and&nbsp;that&nbsp;the&nbsp;intervals&nbsp;are&nbsp;negotiated&nbsp;during&nbsp;tuning.&lt;br&gt;<br>
&lt;br&gt;What&amp;#39;s&nbsp;confusing&nbsp;me&nbsp;is&nbsp;this:&nbsp; Some&nbsp;threads&nbsp;such&nbsp;at&nbsp;this&nbsp;one&nbsp;imply&nbsp;that&nbsp;the&nbsp;server&nbsp;&amp;quot;periodically&nbsp;sends&nbsp;heartbeat&nbsp;frames&nbsp;to&nbsp;the&nbsp;client&nbsp;and&nbsp;waits&nbsp;for&nbsp;its&nbsp;response.&amp;quot;&lt;br&gt;&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-August/014491.html&quot;&gt;http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-August/014491.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;What&nbsp;exactly&nbsp;is&nbsp;the&nbsp;proper&nbsp;response&nbsp;from&nbsp;the&nbsp;client?&nbsp;I&amp;#39;ve&nbsp;searched&nbsp;for&nbsp;hours&nbsp;looking&nbsp;for&nbsp;the&nbsp;format&nbsp;of&nbsp;the&nbsp;response&nbsp;and&nbsp;not&nbsp;found&nbsp;it.&lt;br&gt;&lt;br&gt;Confounding&nbsp;matters,&nbsp;at&nbsp;least&nbsp;three&nbsp;client&nbsp;libraries&nbsp;I&amp;#39;ve&nbsp;looked&nbsp;at&nbsp;(including&nbsp;Pika&nbsp;and&nbsp;.NET)&nbsp;explicitly&nbsp;check&nbsp;for&nbsp;heartbeat&nbsp;frame&nbsp;(i.e.,&nbsp;8)&nbsp;and&nbsp;then&nbsp;do&nbsp;nothing&nbsp;with&nbsp;them.&nbsp;For&nbsp;instance&nbsp;in&nbsp;the&nbsp;Pika&nbsp;_on_data_available&nbsp;method():&lt;br&gt;<br>
&lt;br&gt;&nbsp;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt; &nbsp; &nbsp; &nbsp; while&nbsp;self._frame_buffer:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;Try&nbsp;and&nbsp;build&nbsp;a&nbsp;frame&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; consumed_count,&nbsp;frame&nbsp;=&nbsp;pika.frame.decode_frame(self._frame_buffer)&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;We&nbsp;don&amp;#39;t&nbsp;check&nbsp;for&nbsp;heartbeat&nbsp;frames&nbsp;because&nbsp;we&nbsp;can&nbsp;not&nbsp;count&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;atomic&nbsp;frames&nbsp;reliably&nbsp;due&nbsp;to&nbsp;different&nbsp;message&nbsp;behaviors&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;such&nbsp;as&nbsp;large&nbsp;content&nbsp;frames&nbsp;being&nbsp;transferred&nbsp;slowly&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elif&nbsp;isinstance(frame,&nbsp;pika.frame.Heartbeat):&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;Is&nbsp;this&nbsp;correct&nbsp;behavior&nbsp;or&nbsp;am&nbsp;I&nbsp;simply&nbsp;not&nbsp;understanding&nbsp;how&nbsp;the&nbsp;heartbeat&nbsp;mechanism&nbsp;is&nbsp;supposed&nbsp;to&nbsp;work.&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
