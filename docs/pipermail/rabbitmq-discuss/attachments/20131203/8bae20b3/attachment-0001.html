<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;14&nbsp;(filtered&nbsp;medium)&quot;&gt;&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:blue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:purple;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-compose;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;lang=&quot;EN-US&quot;&nbsp;link=&quot;blue&quot;&nbsp;vlink=&quot;purple&quot;&gt;&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Hi,&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;I&nbsp;am&nbsp;testing&nbsp;a&nbsp;Mosquitto&nbsp;client&nbsp;publishing&nbsp;100s&nbsp;of&nbsp;messages&nbsp;to&nbsp;RabbitMQ&nbsp;exchange&nbsp;via&nbsp;the&nbsp;MQTT&nbsp;plugin&nbsp;with&nbsp;different&nbsp;QoS&nbsp;levels&nbsp;and&nbsp;I&nbsp;am&nbsp;seeing&nbsp;issues&nbsp;with&nbsp;messages&nbsp;being&nbsp;received&nbsp;out&nbsp;of&nbsp;order&nbsp;and&nbsp;also&nbsp;what&nbsp;appears&nbsp;to&nbsp;be&nbsp;the&nbsp;TCP&nbsp;socket&nbsp;going&nbsp;down&nbsp;(seeing&nbsp;TCP&nbsp;FINs&nbsp;in&nbsp;tshark). &nbsp;This&nbsp;is&nbsp;all&nbsp;done&nbsp;on&nbsp;localhost&nbsp;inside&nbsp;an&nbsp;Ubuntu&nbsp;VM&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;This&nbsp;happens&nbsp;when&nbsp;the&nbsp;inter-message&nbsp;delay&nbsp;is&nbsp;reduced&nbsp;to&nbsp;&lt;&nbsp;0.07s&nbsp;with&nbsp;QoS&nbsp;=&nbsp;0&nbsp;and&nbsp;&lt;&nbsp;0.5s&nbsp;with&nbsp;QoS&nbsp;=&nbsp;1. &nbsp;(&lt;/span&gt;RabbitMQ&nbsp;3.2.1,&nbsp;&lt;acronym&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;&quot;&gt;Erlang&nbsp;R14B04)&lt;/span&gt;&lt;/acronym&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;(Pika&nbsp;0.9.13)&nbsp;(mosquito&nbsp;1.2.2)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;The&nbsp;client&nbsp;consumer&nbsp;simply&nbsp;expects&nbsp;to&nbsp;see&nbsp;msgs&nbsp;received&nbsp;in&nbsp;order&nbsp;and&nbsp;prints&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;msg&nbsp;id&nbsp;#&nbsp;is&nbsp;not&nbsp;+1&nbsp;from&nbsp;the&nbsp;previous. &nbsp;If&nbsp;I&nbsp;send&nbsp;in&nbsp;a&nbsp;similar&nbsp;manner&nbsp;via&nbsp;AMQP&nbsp;using&nbsp;pika&nbsp;client,&nbsp;there&nbsp;is&nbsp;no&nbsp;issue&nbsp;with&nbsp;messages&nbsp;being&nbsp;received&nbsp;out&nbsp;of&nbsp;order&nbsp;or&nbsp;seeing&nbsp;any&nbsp;socket&nbsp;disconnects&nbsp;(FINs)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;The&nbsp;problem&nbsp;gets&nbsp;worse&nbsp;with&nbsp;QoS=1&nbsp;seeing&nbsp;the&nbsp;connection&nbsp;failing&nbsp;and&nbsp;the&nbsp;publisher&nbsp;stops&nbsp;receiving&nbsp;confirmations.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;In&nbsp;the&nbsp;example&nbsp;below&nbsp;200&nbsp;message&nbsp;are&nbsp;published&nbsp;with&nbsp;0s&nbsp;delay&nbsp;between&nbsp;them&nbsp;at&nbsp;QoS=0. &nbsp;All&nbsp;the&nbsp;messages&nbsp;are&nbsp;received&nbsp;up&nbsp;to&nbsp;51,&nbsp;then&nbsp;52&nbsp;is&nbsp;missed,&nbsp;then&nbsp;every&nbsp;10&nbsp;messages&nbsp;are&nbsp;received&nbsp;and&nbsp;one&nbsp;skipped. &nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;log,&nbsp;it&nbsp;shows&nbsp;receiving&nbsp;the&nbsp;skipped&nbsp;messages&nbsp;being&nbsp;output&nbsp;in&nbsp;reversed&nbsp;order… &nbsp;received&nbsp;112,&nbsp;102,&nbsp;92,&nbsp;82…all&nbsp;the&nbsp;way&nbsp;to&nbsp;52…&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;I’ve&nbsp;set&nbsp;the&nbsp;client.max_inflight_messages_set(0)&nbsp;in&nbsp;the&nbsp;mosquito&nbsp;client&nbsp;and&nbsp;the&nbsp;mqtt&nbsp;rabbitmq&nbsp;plugin&nbsp;config&nbsp;is&nbsp;set&nbsp;with&nbsp;prefetch=0&nbsp;for&nbsp;infinite&nbsp;messaging&nbsp;which&nbsp;I&nbsp;think&nbsp;only&nbsp;applies&nbsp;for&nbsp;QoS=1. &nbsp;Also&nbsp;in&nbsp;the&nbsp;mosquito&nbsp;client,&nbsp;I’ve&nbsp;trigger&nbsp;the&nbsp;mosquito&nbsp;client&nbsp;thread&nbsp;to&nbsp;run&nbsp;to&nbsp;process&nbsp;the&nbsp;publish&nbsp;cfm&nbsp;from&nbsp;the&nbsp;broker&nbsp;plugin.&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Any&nbsp;insights&nbsp;would&nbsp;be&nbsp;appreciated. &nbsp;Seems&nbsp;like&nbsp;an&nbsp;issue&nbsp;with&nbsp;mqtt&nbsp;plugin&nbsp;as&nbsp;when&nbsp;I&nbsp;look&nbsp;at&nbsp;tcpdumps&nbsp;of&nbsp;the&nbsp;traces&nbsp;the&nbsp;mqtt&nbsp;messages&nbsp;are&nbsp;aggregated&nbsp;together&nbsp;into&nbsp;tcp&nbsp;messages&nbsp;with&nbsp;the&nbsp;low&nbsp;delays&nbsp;and&nbsp;with&nbsp;higher&nbsp;delays&nbsp;they&nbsp;are&nbsp;separated&nbsp;into&nbsp;individual&nbsp;tcp&nbsp;messages.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;I’ve&nbsp;included&nbsp;the&nbsp;example&nbsp;invocation,&nbsp;output&nbsp;and&nbsp;code&nbsp;below.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Adrian&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;u&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Mosquitto&nbsp;MQTT&nbsp;Publisher:&lt;/span&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Example…send&nbsp;200&nbsp;messages&nbsp;with&nbsp;0&nbsp;delay&nbsp;at&nbsp;QoS=0&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;i&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;%&nbsp;python&nbsp;mqtt_publisher_json.py&nbsp;200&nbsp;&lt;b&gt;0&lt;/b&gt;&nbsp;&lt;b&gt;0&lt;/b&gt;&lt;/span&gt;&lt;/i&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Sending&nbsp;JSON&nbsp;msg&nbsp;1&nbsp;via&nbsp;MQTT&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;…&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Sending&nbsp;JSON&nbsp;msg&nbsp;198&nbsp;via&nbsp;MQTT&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Sending&nbsp;JSON&nbsp;msg&nbsp;199&nbsp;via&nbsp;MQTT&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Sending&nbsp;JSON&nbsp;msg&nbsp;200&nbsp;via&nbsp;MQTT&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;b&gt;&lt;u&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;AMQP&nbsp;Consumer&nbsp;using&nbsp;PIKA&lt;/span&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;u&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&lt;span&nbsp;style=&quot;text-decoration:none&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Receive&nbsp;messages&nbsp;published&nbsp;on&nbsp;the&nbsp;mqtt&nbsp;topic&nbsp;exchange&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;%&nbsp;python&nbsp;amqp_receive_mqtt_json.py&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;1}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;2}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;3}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;…all&nbsp;messages&nbsp;received&nbsp;here&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;50}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;51}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;53} &nbsp;&lt;-&nbsp;Got&nbsp;53&nbsp;instead&nbsp;of&nbsp;52&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;52&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;54} &nbsp;&lt;-&nbsp;now&nbsp;receive&nbsp;54…61&nbsp;in&nbsp;order&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;55}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;56}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;57}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;58}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;59}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;60}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;61}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;63} &nbsp;&lt;-&nbsp;Got&nbsp;63&nbsp;instead&nbsp;of&nbsp;62&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;62&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;64}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;65}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;66}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;67}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;68}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;69}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;70}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;71}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;73} &nbsp;&lt;-&nbsp;etc…&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;72&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;74}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;75}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;76}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;77}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;78}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;79}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;80}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;81}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;83}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;82&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;84}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;85}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;86}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;87}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;88}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;89}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;90}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;91}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;93}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;92&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;94}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;95}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;96}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;97}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;98}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;99}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;100}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;101}    &nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; [x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;103} &nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;102&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;104}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;105}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;106}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;107}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;108}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;109}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;110}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;111}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;113}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;112&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;114}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;115}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;…all&nbsp;messages&nbsp;received&nbsp;in&nbsp;order&nbsp;here…&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;199}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;200}  &nbsp;&lt;b&gt;&lt;-&nbsp;last&nbsp;message&nbsp;sent&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;112}  &nbsp;&lt;-&nbsp;Now&nbsp;here&nbsp;come&nbsp;all&nbsp;the&nbsp;skipped&nbsp;messages&nbsp;in&nbsp;reverse&nbsp;order.&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;201&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;102}&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;113&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;92}&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;103&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;82}&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;93&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;72}&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;83&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;62}&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;73&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;&nbsp;[x]&nbsp;&#39;mqtt_json_routing_key&#39;:{u&#39;id&#39;:&nbsp;52}&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;Missing&nbsp;63&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;b&gt;&lt;u&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;mqtt_publisher_json.py:&lt;/span&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Example&nbsp;of&nbsp;mosquitto&nbsp;json&nbsp;publisher&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;import&nbsp;mosquitto&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;import&nbsp;sys&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;import&nbsp;time&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;import&nbsp;random&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;import&nbsp;json&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;def&nbsp;on_connect(mosq,&nbsp;obj,&nbsp;rc):&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;if&nbsp;rc&nbsp;==&nbsp;0:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;print(&quot;on_connect&nbsp;ok...&quot;)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;else:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;print(&quot;on_connect&nbsp;failed&nbsp;rc=&quot;,rc)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;def&nbsp;on_publish(mosq,obj,mid):&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;print(&quot;Message&nbsp;published:&nbsp;&quot;,&nbsp;mid)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;def&nbsp;on_disconnect(mosq,&nbsp;obj,&nbsp;rc):&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;print(&quot;Disconnected...&quot;)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;def&nbsp;on_log(mosq,userdata,level,buf):&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;print(&quot;on_log:&quot;,userdata,level,buf)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;if&nbsp;len(sys.argv)&nbsp;!=&nbsp;4:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;print&nbsp;&quot;Usage:&nbsp;cnt&nbsp;sleep_s&nbsp;qos&quot;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;exit(-1)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;cnt&nbsp;=&nbsp;int(sys.argv[1])&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;sleep_s&nbsp;=&nbsp;float(sys.argv[2])&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;qos&nbsp;=&nbsp;int(sys.argv[3])&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client&nbsp;=&nbsp;mosquitto.Mosquitto(&quot;test-client%d&quot;&nbsp;%&nbsp;random.randint(1,100))&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;print&nbsp;client._client_id&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client.on_connect&nbsp;=&nbsp;on_connect&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client.on_disconnect&nbsp;=&nbsp;on_disconnect&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#client.on_log&nbsp;=&nbsp;on_log&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#client.on_publish&nbsp;=&nbsp;on_publish&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client.max_inflight_messages_set(0)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client.connect(&quot;localhost&quot;,port=1884)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Start&nbsp;mosquitto&nbsp;thread&nbsp;to&nbsp;deal&nbsp;with&nbsp;inflight&nbsp;acks&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client.loop_start()&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Transmit&nbsp;a&nbsp;bunch&nbsp;of&nbsp;messages&nbsp;space&nbsp;sleep_s&nbsp;apart&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;i&nbsp;=&nbsp;1&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;while&nbsp;i&nbsp;&lt;= &nbsp;cnt:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;print&nbsp;&quot;Sending&nbsp;JSON&nbsp;msg&nbsp;%d&nbsp;via&nbsp;MQTT&quot;&nbsp;%&nbsp;i&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;msg&nbsp;=&nbsp;{}&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;#msg[&quot;msg&quot;]&nbsp;=&nbsp;&quot;JSON&nbsp;msg#%d&nbsp;via&nbsp;MQTT&quot;&nbsp;%&nbsp;i&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;msg[&quot;id&quot;]&nbsp;=&nbsp;i&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;try&nbsp;:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;rc&nbsp;=&nbsp;client.publish(&quot;mqtt_json_routing_key&quot;,json.dumps(msg),qos=qos)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;except&nbsp;:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;print&nbsp;&quot;Unexpected&nbsp;publish&nbsp;error:&nbsp;&quot;,sys.exc_info()[0]&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;i&nbsp;=&nbsp;i&nbsp;+&nbsp;1&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;time.sleep(sleep_s)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Some&nbsp;delay&nbsp;for&nbsp;last&nbsp;message&nbsp;to&nbsp;go&nbsp;out&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;wait_s&nbsp;=&nbsp;2&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;print&nbsp;&quot;Waiting&nbsp;%d&nbsp;seconds&nbsp;for&nbsp;last&nbsp;message&nbsp;out...&quot;&nbsp;%&nbsp;wait_s&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;time.sleep(wait_s)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Stop&nbsp;the&nbsp;threaded&nbsp;Mosquitto&nbsp;client&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;client.loop_stop()&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Now&nbsp;disconnect&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;try:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;client.disconnect()&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;except:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;print&nbsp;&quot;Unexpected&nbsp;disconnect&nbsp;error:&nbsp;&quot;,sys.exc_info()[0]&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;u&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;amqp_receive_mqtt_json.py&lt;/span&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&nbsp;Usage:&nbsp;python&nbsp;amqp_receive_mqtt_json&nbsp;[debug]&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;# &nbsp;[0/1&nbsp;-&nbsp;debug&nbsp;enable/disable&nbsp;-&nbsp;default&nbsp;enable]&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;# &nbsp;Consumer&nbsp;to&nbsp;receive&nbsp;AMQP&nbsp;messages&nbsp;from&nbsp;mqtt-json-queue&nbsp;from&nbsp;mqtt.topic&nbsp;exchange&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;# &nbsp;code&nbsp;expectes&nbsp;a&nbsp;json&nbsp;&#39;id&#39;&nbsp;field&nbsp;in&nbsp;the&nbsp;message&nbsp;body&nbsp;and&nbsp;will&nbsp;report&nbsp;if&nbsp;the&nbsp;&#39;id&#39;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;# &nbsp;is&nbsp;not&nbsp;+1&nbsp;from&nbsp;previous&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;#&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;prev_id&nbsp;=&nbsp;0&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;debug&nbsp;=&nbsp;1&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;def&nbsp;callback(ch,&nbsp;method,&nbsp;properties,&nbsp;body):&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;global&nbsp;prev_id,&nbsp;debug&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;ch.basic_ack(delivery_tag=method.delivery_tag)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;msgBody&nbsp;=&nbsp;json.loads(body)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;if&nbsp;debug&nbsp;!=&nbsp;0:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;print&nbsp;&quot;&nbsp;[x]&nbsp;%r:%r&quot;&nbsp;%&nbsp;(method.routing_key,msgBody,)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;if&nbsp;prev_id&nbsp;+&nbsp;1&nbsp;!=&nbsp;int(msgBody[&#39;id&#39;]):&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;print&nbsp;&quot;Missing&nbsp;%d&quot;&nbsp;%&nbsp;(prev_id&nbsp;+&nbsp;1)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;prev_id&nbsp;=&nbsp;msgBody[&#39;id&#39;]&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;return&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;if&nbsp;len(sys.argv)&nbsp;&gt;&nbsp;1:&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;debug&nbsp;=&nbsp;int(sys.argv[1])&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;while&nbsp;True:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;try:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;connection&nbsp;=&nbsp;pika.BlockingConnection(pika.ConnectionParameters(&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;               &nbsp;host=&#39;localhost&#39;))&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;channel&nbsp;=&nbsp;connection.channel()&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;channel.exchange_declare(exchange=&#39;mqtt.topic&#39;,&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;                                &nbsp;type=&#39;topic&#39;)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;result&nbsp;=&nbsp;channel.queue_declare(&quot;mqtt-json-queue&quot;)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;queue_name&nbsp;=&nbsp;result.method.queue&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;#&nbsp;topic&nbsp;here&nbsp;is&nbsp;what&nbsp;the&nbsp;mqtt&nbsp;plugin&nbsp;posts&nbsp;to&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;channel.queue_bind(exchange=&#39;mqtt.topic&#39;,&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;                          &nbsp;queue=queue_name,&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;                          &nbsp;routing_key=&quot;mqtt_json_routing_key&quot;)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;print&nbsp;&#39;&nbsp;[*]&nbsp;Waiting&nbsp;for&nbsp;logs.&nbsp;To&nbsp;exit&nbsp;press&nbsp;CTRL+C&#39;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;channel.basic_consume(callback,&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;                             &nbsp;queue=queue_name&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;                             &nbsp;)&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;channel.start_consuming()&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;   &nbsp;except&nbsp;Exception,&nbsp;e:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt;       &nbsp;traceback.print_exc()&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&quot;Courier&nbsp;New&quot;,&quot;serif&quot;&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt; &lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>

</tt>
