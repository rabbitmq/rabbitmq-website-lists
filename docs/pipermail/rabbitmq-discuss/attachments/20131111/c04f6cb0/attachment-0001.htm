<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Yes&nbsp;-&nbsp;that&amp;#39;s&nbsp;actually&nbsp;what&nbsp;we&nbsp;do&nbsp;currently,&nbsp;using&nbsp;Cassandra,&nbsp;and&nbsp;it&nbsp;scales&nbsp;well.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;we&nbsp;also&nbsp;do&nbsp;it&nbsp;in&nbsp;memory,&nbsp;at&nbsp;the&nbsp;retail&nbsp;level,&nbsp;and&nbsp;it&nbsp;is&nbsp;very&nbsp;fast&nbsp;as&nbsp;well.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
I&nbsp;am&nbsp;just&nbsp;trying&nbsp;to&nbsp;shave&nbsp;a&nbsp;millisecond&nbsp;off&nbsp;at&nbsp;the&nbsp;retail&nbsp;level.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Michael&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Nov&nbsp;11,&nbsp;2013&nbsp;at&nbsp;2:22&nbsp;PM,&nbsp;Matthias&nbsp;Reik&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:maze@reik.se&quot;&nbsp;target=&quot;_blank&quot;&gt;maze@reik.se&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;&lt;div&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Even&nbsp;though&nbsp;it&nbsp;sounds&nbsp;like&nbsp;a&nbsp;nice&nbsp;feature,&nbsp;it&nbsp;is&nbsp;probably&nbsp;difficult<br>
&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;really&nbsp;implement,&nbsp;if&nbsp;not&nbsp;done&nbsp;on&nbsp;the&nbsp;client&nbsp;side.&nbsp;The&nbsp;duplicates<br>
&nbsp;&nbsp;&nbsp;&nbsp;might&nbsp;happen&nbsp;when&nbsp;delivering&nbsp;to&nbsp;the&nbsp;client&nbsp;side.&nbsp;but&nbsp;on&nbsp;the&nbsp;client<br>
&nbsp;&nbsp;&nbsp;&nbsp;side&nbsp;it&nbsp;should&nbsp;be&nbsp;quite&nbsp;easy&nbsp;to&nbsp;do&nbsp;the&nbsp;filtering:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;get&nbsp;a&nbsp;message&nbsp;from&nbsp;the&nbsp;queue,&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;check&nbsp;against&nbsp;memcached&nbsp;(couchbase,&nbsp;or&nbsp;some&nbsp;other&nbsp;cache<br>
&nbsp;&nbsp;&nbsp;&nbsp;technology)&nbsp;whether&nbsp;the&nbsp;messageID&nbsp;exists.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Add&nbsp;the&nbsp;new&nbsp;message&nbsp;to&nbsp;memcached&nbsp;(can&nbsp;be&nbsp;done&nbsp;with&nbsp;the&nbsp;previous<br>
&nbsp;&nbsp;&nbsp;&nbsp;step)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Set&nbsp;the&nbsp;timeout&nbsp;in&nbsp;memcached&nbsp;to&nbsp;your&nbsp;window&nbsp;size.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;should&nbsp;be&nbsp;straight&nbsp;forward,&nbsp;would&nbsp;scale&nbsp;up&nbsp;to&nbsp;quite&nbsp;a&nbsp;lot&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;messages)&nbsp;and&nbsp;should&nbsp;remove&nbsp;(depending&nbsp;on&nbsp;your&nbsp;window&nbsp;size)&nbsp;all<br>
&nbsp;&nbsp;&nbsp;&nbsp;duplicates.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Is&nbsp;there&nbsp;a&nbsp;good&nbsp;reason&nbsp;why&nbsp;you&nbsp;wouldn&amp;#39;t&nbsp;want&nbsp;to&nbsp;do&nbsp;this&nbsp;on&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;side&nbsp;as&nbsp;described?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Cheers&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Matthias&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;PS:&nbsp;as&nbsp;a&nbsp;caching&nbsp;technology&nbsp;you&nbsp;could&nbsp;of&nbsp;course&nbsp;do&nbsp;your&nbsp;own<br>
&nbsp;&nbsp;&nbsp;&nbsp;in-memory-solution&nbsp;but&nbsp;that&amp;#39;s&nbsp;probably&nbsp;more&nbsp;work&nbsp;than&nbsp;to&nbsp;use&nbsp;an<br>
&nbsp;&nbsp;&nbsp;&nbsp;out-of-the-box&nbsp;solution.&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;On&nbsp;2013-11-11&nbsp;12:35&nbsp;,&nbsp;Laing,&nbsp;Michael<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;In&nbsp;our&nbsp;scenarios,&nbsp;messages&nbsp;are&nbsp;ultimately&nbsp;delivered<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;a&nbsp;&amp;#39;retail&amp;#39;&nbsp;rabbitmq&nbsp;instance&nbsp;to&nbsp;be&nbsp;delivered&nbsp;to&nbsp;a&nbsp;client.&nbsp;The<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipelines&nbsp;that&nbsp;process&nbsp;and&nbsp;deliver&nbsp;messages&nbsp;are&nbsp;purposefully<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redundant,&nbsp;hence&nbsp;there&nbsp;may&nbsp;be&nbsp;multiple&nbsp;replicas&nbsp;of&nbsp;each&nbsp;message<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#39;racing&amp;#39;&nbsp;to&nbsp;the&nbsp;endpoint.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;Usually,&nbsp;the&nbsp;replicas&nbsp;are&nbsp;resolved&nbsp;before&nbsp;getting&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retail&nbsp;rabbit.&nbsp;When&nbsp;components&nbsp;fail,&nbsp;however,&nbsp;duplicates&nbsp;can<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leak&nbsp;through&nbsp;during&nbsp;a&nbsp;small&nbsp;window&nbsp;of&nbsp;time.&nbsp;We&nbsp;eliminate&nbsp;those<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duplicates&nbsp;at&nbsp;the&nbsp;retail&nbsp;layer&nbsp;by&nbsp;looking&nbsp;at&nbsp;each&nbsp;message_id.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ultimately,&nbsp;our&nbsp;client&nbsp;contract&nbsp;allows&nbsp;duplicates&nbsp;as&nbsp;well&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;one&nbsp;slips&nbsp;by.&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;It&nbsp;seems&nbsp;to&nbsp;me&nbsp;that&nbsp;this&nbsp;is&nbsp;a&nbsp;generic&nbsp;issue.&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;What&nbsp;would&nbsp;be&nbsp;useful&nbsp;in&nbsp;our&nbsp;case,&nbsp;and&nbsp;hopefully&nbsp;for&nbsp;many<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others,&nbsp;would&nbsp;be&nbsp;a&nbsp;&amp;#39;Duplicate&nbsp;Message&nbsp;ID&nbsp;Window&amp;#39;&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;milliseconds,&nbsp;as&nbsp;an&nbsp;exchange&nbsp;attribute.&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;If&nbsp;non-zero,&nbsp;the&nbsp;exchange&nbsp;would&nbsp;drop&nbsp;any&nbsp;message&nbsp;with&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duplicate&nbsp;message_id&nbsp;that&nbsp;appeared&nbsp;within&nbsp;the&nbsp;specified&nbsp;window<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;time,&nbsp;possibly&nbsp;routing&nbsp;it&nbsp;to&nbsp;the&nbsp;alternate&nbsp;exchange,&nbsp;if<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;In&nbsp;our&nbsp;case,&nbsp;a&nbsp;window&nbsp;of&nbsp;a&nbsp;few&nbsp;seconds,&nbsp;perhaps&nbsp;up&nbsp;to&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute&nbsp;would&nbsp;suffice.&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;Thanks,&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;Michael&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fieldset&gt;&lt;/fieldset&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;pre&gt;_______________________________________________<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
