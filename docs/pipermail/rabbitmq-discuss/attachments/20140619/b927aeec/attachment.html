<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello&nbsp;Michael,&nbsp;per&nbsp;your&nbsp;suggestion&nbsp;I&nbsp;put&nbsp;the&nbsp;open&nbsp;connection&nbsp;logic&nbsp;in&nbsp;the&nbsp;class&nbsp;initializer&nbsp;(it&nbsp;only&nbsp;happens&nbsp;once&nbsp;right&nbsp;after&nbsp;construction).&nbsp; Getting&nbsp;the&nbsp;connection&nbsp;works&nbsp;fine.&nbsp; However&nbsp;basic&nbsp;publish&nbsp;still&nbsp;encounters&nbsp;an&nbsp;error.&nbsp; However,&nbsp;the&nbsp;error&nbsp;is&nbsp;slightly&nbsp;different&nbsp;this&nbsp;time&nbsp;around.&nbsp; I&nbsp;invoked&nbsp;the&nbsp;java&nbsp;tracing&nbsp;proxy&nbsp;so&nbsp;you&nbsp;can&nbsp;see&nbsp;the&nbsp;wire&nbsp;data.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Client&nbsp;side&nbsp;error&nbsp;when&nbsp;invoking&nbsp;basic&nbsp;publish:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;System.ArgumentNullException:&nbsp;String&nbsp;reference&nbsp;not&nbsp;set&nbsp;to&nbsp;an&nbsp;instance&nbsp;of&nbsp;a&nbsp;String.&lt;/div&gt;&lt;div&gt;Parameter&nbsp;name:&nbsp;s&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;System.Text.Encoding.GetBytes(String&nbsp;s)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.WireFormatting.WriteShortstr(NetworkBinaryWriter&nbsp;writer,&nbsp;String&nbsp;val)&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.ContentHeaderPropertyWriter.WriteShortstr(String&nbsp;val)&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Framing.v0_9_1.BasicProperties.WritePropertiesTo(ContentHeaderPropertyWriter&nbsp;writer)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.ContentHeaderBase.WriteTo(NetworkBinaryWriter&nbsp;writer,&nbsp;UInt64&nbsp;bodySize)&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.Command.Transmit(Int32&nbsp;channelNumber,&nbsp;ConnectionBase&nbsp;connection)&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.SessionBase.Transmit(Command&nbsp;cmd)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.ModelBase.ModelSend(MethodBase&nbsp;method,&nbsp;ContentHeaderBase&nbsp;header,&nbsp;Byte[]&nbsp;body)&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Framing.Impl.v0_9_1.Model._Private_BasicPublish(String&nbsp;exchange,&nbsp;String&nbsp;routingKey,&nbsp;Boolean&nbsp;mandatory,&nbsp;Boolean&nbsp;immediate,&nbsp;IBasicProperties&nbsp;basicProperties,&nbsp;Byte[]&nbsp;body)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.ModelBase.BasicPublish(String&nbsp;exchange,&nbsp;String&nbsp;routingKey,&nbsp;Boolean&nbsp;mandatory,&nbsp;Boolean&nbsp;immediate,&nbsp;IBasicProperties&nbsp;basicProperties,&nbsp;Byte[]&nbsp;body)&lt;/div&gt;&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.ModelBase.BasicPublish(String&nbsp;exchange,&nbsp;String&nbsp;routingKey,&nbsp;Boolean&nbsp;mandatory,&nbsp;IBasicProperties&nbsp;basicProperties,&nbsp;Byte[]&nbsp;body)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; at&nbsp;RabbitMQ.Client.Impl.ModelBase.BasicPublish(String&nbsp;exchange,&nbsp;String&nbsp;routingKey,&nbsp;IBasicProperties&nbsp;basicProperties,&nbsp;Byte[]&nbsp;body)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Tracer&nbsp;output:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
&lt;div&gt;Usage:&nbsp;Tracer&nbsp;[&lt;listenport&gt;&nbsp;[&lt;connecthost&gt;&nbsp;[&lt;connectport&gt;]]]&lt;/div&gt;&lt;div&gt; &nbsp; Serially&nbsp;traces&nbsp;connections&nbsp;on&nbsp;the&nbsp;&lt;listenport&gt;,&nbsp;logging&lt;/div&gt;&lt;div&gt; &nbsp; frames&nbsp;received&nbsp;and&nbsp;passing&nbsp;them&nbsp;to&nbsp;the&nbsp;connect&nbsp;host&nbsp;and&nbsp;port.&lt;/div&gt;<br>
&lt;div&gt;Invoked&nbsp;as:&nbsp;Tracer&nbsp;5672&nbsp;devtest01&nbsp;5672&lt;/div&gt;&lt;div&gt;com.rabbitmq.tools.Tracer.WITHHOLD_INBOUND_HEARTBEATS&nbsp;=&nbsp;false&lt;/div&gt;&lt;div&gt;com.rabbitmq.tools.Tracer.WITHHOLD_OUTBOUND_HEARTBEATS&nbsp;=&nbsp;false&lt;/div&gt;&lt;div&gt;com.rabbitmq.tools.Tracer.NO_ASSEMBLE_FRAMES&nbsp;=&nbsp;false&lt;/div&gt;<br>
&lt;div&gt;com.rabbitmq.tools.Tracer.NO_DECODE_FRAMES&nbsp;=&nbsp;false&lt;/div&gt;&lt;div&gt;com.rabbitmq.tools.Tracer.SUPPRESS_COMMAND_BODIES&nbsp;=&nbsp;false&lt;/div&gt;&lt;div&gt;1403231368956:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#0&nbsp;&lt;-&nbsp;{#method&lt;connection.start&gt;(version-major=0,&nbsp;v&lt;/div&gt;<br>
&lt;div&gt;rsion-minor=9,&nbsp;server-properties={product=RabbitMQ,&nbsp;cluster_name=rabbit@DEVTEST&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://1.criticaltech.com&quot;&gt;1.criticaltech.com&lt;/a&gt;,&nbsp;information=Licensed&nbsp;under&nbsp;the&nbsp;MPL.&nbsp; See&nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitm&quot;&gt;http://www.rabbitm&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;.com/,&nbsp;platform=Erlang/OTP,&nbsp;capabilities={exchange_exchange_bindings=true,&nbsp;auth&lt;/div&gt;&lt;div&gt;ntication_failure_close=true,&nbsp;consumer_priorities=true,&nbsp;consumer_cancel_notify=&lt;/div&gt;&lt;div&gt;rue,&nbsp;basic.nack=true,&nbsp;publisher_confirms=true,&nbsp;connection.blocked=true},&nbsp;copyri&lt;/div&gt;<br>
&lt;div&gt;ht=Copyright&nbsp;(C)&nbsp;2007-2013&nbsp;GoPivotal,&nbsp;Inc.,&nbsp;version=3.3.0},&nbsp;mechanisms=AMQPLAIN&lt;/div&gt;&lt;div&gt;PLAIN,&nbsp;locales=en_US),&nbsp;null,&nbsp;&quot;&quot;}&lt;/div&gt;&lt;div&gt;1403231368956:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#0&nbsp;-&gt;&nbsp;{#method&lt;connection.start-ok&gt;(client-properti&lt;/div&gt;<br>
&lt;div&gt;s={product=RabbitMQ,&nbsp;platform=.NET,&nbsp;information=Licensed&nbsp;under&nbsp;the&nbsp;MPL.&nbsp; See&nbsp;ht&lt;/div&gt;&lt;div&gt;p://&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/&quot;&gt;www.rabbitmq.com/&lt;/a&gt;,&nbsp;copyright=Copyright&nbsp;(C)&nbsp;2007-2013&nbsp;GoPivotal,&nbsp;Inc.,&nbsp;capab&lt;/div&gt;&lt;div&gt;<br>
lities={exchange_exchange_bindings=true,&nbsp;authentication_failure_close=true,&nbsp;con&lt;/div&gt;&lt;div&gt;umer_cancel_notify=true,&nbsp;basic.nack=true,&nbsp;publisher_confirms=true,&nbsp;connection.b&lt;/div&gt;&lt;div&gt;ocked=true},&nbsp;version=3.3.0.0},&nbsp;mechanism=PLAIN,&nbsp;response=&nbsp;logmanager&nbsp;rfc1945,&nbsp;l&lt;/div&gt;<br>
&lt;div&gt;cale=en_US),&nbsp;null,&nbsp;&quot;&quot;}&lt;/div&gt;&lt;div&gt;1403231369155:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#0&nbsp;&lt;-&nbsp;{#method&lt;connection.tune&gt;(channel-max=0,&nbsp;fram&lt;/div&gt;&lt;div&gt;-max=131072,&nbsp;heartbeat=580),&nbsp;null,&nbsp;&quot;&quot;}&lt;/div&gt;&lt;div&gt;1403231369159:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#0&nbsp;-&gt;&nbsp;{#method&lt;connection.tune-ok&gt;(channel-max=0,&nbsp;f&lt;/div&gt;<br>
&lt;div&gt;ame-max=131072,&nbsp;heartbeat=580),&nbsp;null,&nbsp;&quot;&quot;}&lt;/div&gt;&lt;div&gt;1403231369161:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#0&nbsp;-&gt;&nbsp;{#method&lt;connection.open&gt;(virtual-host=/,&nbsp;cap&lt;/div&gt;&lt;div&gt;bilities=,&nbsp;insist=false),&nbsp;null,&nbsp;&quot;&quot;}&lt;/div&gt;<br>
&lt;div&gt;1403231369374:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#0&nbsp;&lt;-&nbsp;{#method&lt;connection.open-ok&gt;(known-hosts=),&nbsp;n&lt;/div&gt;&lt;div&gt;ll,&nbsp;&quot;&quot;}&lt;/div&gt;&lt;div&gt;1403231383444:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#1&nbsp;-&gt;&nbsp;{#method&lt;channel.open&gt;(out-of-band=),&nbsp;null,&nbsp;&quot;&lt;/div&gt;<br>
&lt;div&gt;}&lt;/div&gt;&lt;div&gt;1403231383668:&nbsp;&lt;Tracer-0&gt;&nbsp;ch#1&nbsp;&lt;-&nbsp;{#method&lt;channel.open-ok&gt;(channel-id=),&nbsp;null,&lt;/div&gt;&lt;div&gt;&quot;&quot;}&lt;/div&gt;&lt;div&gt;Exception&nbsp;in&nbsp;thread&nbsp;&quot;Thread-2&quot;&nbsp;com.rabbitmq.client.UnexpectedFrameError:&nbsp;Receiv&lt;/div&gt;<br>
&lt;div&gt;d&nbsp;frame:&nbsp;Frame(type=1,&nbsp;channel=1,&nbsp;18&nbsp;bytes&nbsp;of&nbsp;payload),&nbsp;expected&nbsp;type&nbsp;2Stopped.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;com.rabbitmq.client.impl.CommandAssembler.consumeHeaderFrame(Command&lt;/div&gt;&lt;div&gt;ssembler.java:106)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;com.rabbitmq.client.impl.CommandAssembler.handleFrame(CommandAssembl&lt;/div&gt;&lt;div&gt;r.java:159)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQCommand.handleFrame(AMQCommand.java:87)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;com.rabbitmq.tools.Tracer$DirectionHandler.doFrame(Tracer.java:331)&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;com.rabbitmq.tools.Tracer$DirectionHandler.run(Tracer.java:343)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;at&nbsp;java.lang.Thread.run(Unknown&nbsp;Source)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Server&nbsp;output&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;19-Jun-2014::21:29:29&nbsp;===&lt;/div&gt;&lt;div&gt;accepting&nbsp;AMQP&nbsp;connection&nbsp;&lt;0.646.0&gt;&nbsp;(&lt;a&nbsp;href=&quot;http://172.17.9.14:57049&quot;&gt;172.17.9.14:57049&lt;/a&gt;&nbsp;-&gt;&nbsp;&lt;a&nbsp;href=&quot;http://172.17.9.24:5672&quot;&gt;172.17.9.24:5672&lt;/a&gt;)&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=ERROR&nbsp;REPORT====&nbsp;19-Jun-2014::21:29:47&nbsp;===&lt;/div&gt;&lt;div&gt;AMQP&nbsp;connection&nbsp;&lt;0.646.0&gt;&nbsp;(running),&nbsp;channel&nbsp;1&nbsp;-&nbsp;error:&lt;/div&gt;&lt;div&gt;{amqp_error,unexpected_frame,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;expected&nbsp;content&nbsp;header&nbsp;for&nbsp;class&nbsp;60,&nbsp;got&nbsp;non&nbsp;content&nbsp;header&nbsp;frame&nbsp;instead&quot;,&lt;/div&gt;<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;basic.publish&#39;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;19-Jun-2014::21:29:47&nbsp;===&lt;/div&gt;&lt;div&gt;closing&nbsp;AMQP&nbsp;connection&nbsp;&lt;0.646.0&gt;&nbsp;(&lt;a&nbsp;href=&quot;http://172.17.9.14:57049&quot;&gt;172.17.9.14:57049&lt;/a&gt;&nbsp;-&gt;&nbsp;&lt;a&nbsp;href=&quot;http://172.17.9.24:5672&quot;&gt;172.17.9.24:5672&lt;/a&gt;)&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;client&nbsp;code&nbsp;use&nbsp;to&nbsp;work&nbsp;before&nbsp;we&nbsp;had&nbsp;to&nbsp;restore&nbsp;an&nbsp;old&nbsp;VM&nbsp;snapshot&nbsp;of&nbsp;the&nbsp;RabitMQ&nbsp;server.&nbsp; We&nbsp;had&nbsp;to&nbsp;re-install&nbsp;/&nbsp;re-configure&nbsp;our&nbsp;RabbitMQ&nbsp;on&nbsp;the&nbsp;vm&nbsp;image.&nbsp; Not&nbsp;sure&nbsp;what&nbsp;I&nbsp;have&nbsp;done&nbsp;to&nbsp;foul&nbsp;it&nbsp;up.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Please&nbsp;advise.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Scott&nbsp;McFadden&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Wed,&nbsp;Jun&nbsp;18,&nbsp;2014&nbsp;at&nbsp;10:05&nbsp;PM,&nbsp;Michael&nbsp;Klishin&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:mklishin@gopivotal.com&quot;&nbsp;target=&quot;_blank&quot;&gt;mklishin@gopivotal.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&gt; On&nbsp;19&nbsp;June&nbsp;2014&nbsp;at&nbsp;07:02:17,&nbsp;Scott&nbsp;McFadden&nbsp;(&lt;a&nbsp;href=&quot;mailto:scott.kendall.mcfadden@gmail.com&quot;&gt;scott.kendall.mcfadden@gmail.com&lt;/a&gt;)&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;It&nbsp;makes&nbsp;me&nbsp;think&nbsp;I&nbsp;screwed&nbsp;up&nbsp;the&nbsp;server&nbsp;side&nbsp;configuration&lt;br&gt;<br>
&gt;&nbsp;when&nbsp;reinstalling.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;There&nbsp;is&nbsp;no&nbsp;configuration&nbsp;that&nbsp;can&nbsp;affect&nbsp;framing/frame&nbsp;interleaving&nbsp;in&nbsp;the&nbsp;client.&lt;br&gt;<br>
This&nbsp;is&nbsp;also&nbsp;the&nbsp;kind&nbsp;of&nbsp;issues&nbsp;that&nbsp;we&#39;d&nbsp;see&nbsp;reported&nbsp;constantly&nbsp;if&nbsp;it&nbsp;was&nbsp;a&nbsp;client&lt;br&gt;<br>
issue.&nbsp;Finally,&nbsp;it&nbsp;happens&nbsp;on&nbsp;a&nbsp;brand&nbsp;new&nbsp;connection.&lt;br&gt;<br>
&lt;br&gt;<br>
I&#39;d&nbsp;recommend&nbsp;doing&nbsp;two&nbsp;things:&lt;br&gt;<br>
&lt;br&gt;<br>
 *&nbsp;Running&nbsp;a&nbsp;tracer&nbsp;proxy&nbsp;in&nbsp;front&nbsp;of&nbsp;RabbitMQ&nbsp;[1]&nbsp;to&nbsp;see&nbsp;what&#39;s&nbsp;being&nbsp;sent&nbsp;on&nbsp;the&nbsp;wire&lt;br&gt;<br>
 *&nbsp;Open&nbsp;a&nbsp;connection&nbsp;on&nbsp;app&nbsp;start&nbsp;if&nbsp;you&nbsp;can&nbsp;instead&nbsp;of&nbsp;opening&nbsp;a&nbsp;new&nbsp;one&nbsp;per&nbsp;channel&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;the&nbsp;latter&nbsp;does&nbsp;not&nbsp;change&nbsp;anything,&nbsp;please&nbsp;post&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;tracer.&lt;br&gt;<br>
&lt;br&gt;<br>
1. &lt;a&nbsp;href=&quot;http://www.rabbitmq.com/java-tools.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/java-tools.html&lt;/a&gt;,&nbsp;see&nbsp;Tracer&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;--&lt;br&gt;<br>
MK&lt;br&gt;<br>
&lt;br&gt;<br>
Software&nbsp;Engineer,&nbsp;Pivotal/RabbitMQ&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
