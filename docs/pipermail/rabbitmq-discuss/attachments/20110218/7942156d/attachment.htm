<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;Simon,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&nbsp;It&nbsp;helps&nbsp;to&nbsp;know&nbsp;what's&nbsp;expensive&nbsp;and&nbsp;what's&nbsp;not&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;AMQP&nbsp;reference&nbsp;says&nbsp;about&nbsp;active&nbsp;declare:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt;If&nbsp;[passive]&nbsp;not&nbsp;set&nbsp;and&nbsp;the&nbsp;queue&nbsp;exists,&nbsp;the&nbsp;server&nbsp;MUST&nbsp;check&nbsp;that&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;existing&nbsp;queue&nbsp;has&nbsp;the&nbsp;same&nbsp;values&nbsp;for&nbsp;durable,&nbsp;exclusive,&nbsp;auto-delete,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;arguments&nbsp;fields.&nbsp;&nbsp;The&nbsp;server&nbsp;MUST&nbsp;respond&nbsp;with&nbsp;Declare-Ok&nbsp;if&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requested&nbsp;queue&nbsp;matches&nbsp;these&nbsp;fields,&nbsp;and&nbsp;MUST&nbsp;raise&nbsp;a&nbsp;channel&nbsp;exception<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not.&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;that&nbsp;reason,&nbsp;I&nbsp;want&nbsp;to&nbsp;leave&nbsp;the&nbsp;active&nbsp;declare&nbsp;to&nbsp;producers&nbsp;so&nbsp;the&nbsp;consumers&nbsp;don't&nbsp;have&nbsp;to&nbsp;care&nbsp;whether&nbsp;the&nbsp;queue&nbsp;is&nbsp;durable,&nbsp;auto-delete&nbsp;and&nbsp;what&nbsp;not.&nbsp;A&nbsp;little&nbsp;bit&nbsp;less&nbsp;coupling.&nbsp;But&nbsp;I&nbsp;got&nbsp;what&nbsp;you&nbsp;said.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;on&nbsp;the&nbsp;producer&nbsp;side,&nbsp;a&nbsp;dumb&nbsp;but&nbsp;easy&nbsp;way&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;queue&nbsp;gets&nbsp;recreated&nbsp;if&nbsp;missing&nbsp;is&nbsp;to&nbsp;always&nbsp;declare&nbsp;the&nbsp;queue&nbsp;and&nbsp;binding&nbsp;before&nbsp;every&nbsp;publish.&nbsp;It&nbsp;works&nbsp;but&nbsp;I'd&nbsp;imagine&nbsp;it&nbsp;is&nbsp;very&nbsp;inefficient,&nbsp;yeah?&nbsp;The&nbsp;consumer&nbsp;code&nbsp;is&nbsp;a&nbsp;bit&nbsp;more&nbsp;complicated&nbsp;with&nbsp;the&nbsp;use&nbsp;of&nbsp;QueueConsumer&nbsp;and&nbsp;Channel.basicConsumer.&nbsp;For&nbsp;a&nbsp;running&nbsp;consumer&nbsp;to&nbsp;use&nbsp;a&nbsp;recreated&nbsp;queue,&nbsp;do&nbsp;I&nbsp;have&nbsp;to&nbsp;instantiate&nbsp;a&nbsp;new&nbsp;QueueConsumer,&nbsp;and&nbsp;call&nbsp;Channel.basicConsumer&nbsp;again?&nbsp;I'm&nbsp;new&nbsp;to&nbsp;RabbitMQ&nbsp;and&nbsp;there&nbsp;seems&nbsp;to&nbsp;be&nbsp;a&nbsp;lot&nbsp;of&nbsp;options&nbsp;to&nbsp;go&nbsp;about&nbsp;this.&nbsp;Any&nbsp;pointers&nbsp;are&nbsp;much&nbsp;appreciated.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yuesong&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Feb&nbsp;18,&nbsp;2011,&nbsp;at&nbsp;11:40&nbsp;AM,&nbsp;Simon&nbsp;MacMullen&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Hi&nbsp;Yuesong.&lt;br&gt;&lt;br&gt;On&nbsp;18/02/11&nbsp;16:31,&nbsp;Yuesong&nbsp;Wang&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;What&nbsp;I&nbsp;really&nbsp;want&nbsp;to&nbsp;do&nbsp;is&nbsp;for&nbsp;both&nbsp;the&nbsp;producers&nbsp;and&nbsp;consumers&nbsp;to&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;automatically&nbsp;recover&nbsp;from&nbsp;a&nbsp;queue&nbsp;gone&nbsp;missing&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;In&nbsp;that&nbsp;case&nbsp;both&nbsp;producers&nbsp;and&nbsp;consumers&nbsp;should&nbsp;declare&nbsp;the&nbsp;queue&nbsp;actively.&nbsp;Declaring&nbsp;a&nbsp;queue&nbsp;that&nbsp;already&nbsp;exists&nbsp;is&nbsp;not&nbsp;a&nbsp;problem,&nbsp;and&nbsp;the&nbsp;costs&nbsp;associated&nbsp;with&nbsp;doing&nbsp;so&nbsp;are&nbsp;low.&lt;br&gt;&lt;br&gt;Cheers,&nbsp;Simon&lt;br&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Simon&nbsp;MacMullen&lt;br&gt;Staff&nbsp;Engineer,&nbsp;RabbitMQ&lt;br&gt;SpringSource,&nbsp;a&nbsp;division&nbsp;of&nbsp;VMware&lt;br&gt;&lt;br&gt;_______________________________________________&lt;br&gt;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
