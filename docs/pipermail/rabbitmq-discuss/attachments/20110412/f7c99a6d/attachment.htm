<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Kamal,&lt;br&gt;&lt;br&gt;First&nbsp;off,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;asynchronous&nbsp;model&nbsp;then&nbsp;you&nbsp;don&amp;#39;t&nbsp;need&nbsp;to&nbsp;use&nbsp;basicConsume&nbsp;with&nbsp;each&nbsp;message&nbsp;fetch.&nbsp;This&nbsp;is&nbsp;something&nbsp;that&nbsp;you&nbsp;do&nbsp;at&nbsp;the&nbsp;initialization&nbsp;of&nbsp;application/class,&nbsp;then&nbsp;you&nbsp;just&nbsp;use&nbsp;nextDelivery&nbsp;for&nbsp;fetching&nbsp;messages.&lt;br&gt;<br>
<br>
&lt;br&gt;It&nbsp;appears&nbsp;to&nbsp;me&nbsp;that&nbsp;you&nbsp;should&nbsp;also&nbsp;use&nbsp;3&nbsp;consumers,&nbsp;one&nbsp;for&nbsp;each&nbsp;queue.&nbsp;Assuming&nbsp;they&nbsp;are&nbsp;called&nbsp;&amp;quot;highConsumer&amp;quot;,&nbsp;&amp;quot;mediumConsumer&amp;quot;&nbsp;and&nbsp;&amp;quot;lowConsumer&amp;quot;.&nbsp;Then&nbsp;to&nbsp;fetch&nbsp;the&nbsp;next&nbsp;available&nbsp;message&nbsp;from&nbsp;the&nbsp;&amp;quot;high&amp;quot;&nbsp;queue&nbsp;you&nbsp;should&nbsp;call:&nbsp;this.highConsumer.nextDelivery(),&nbsp;and&nbsp;so&nbsp;on.&lt;br&gt;<br>
<br>
&lt;br&gt;I&nbsp;hope&nbsp;that&nbsp;gives&nbsp;you&nbsp;a&nbsp;better&nbsp;idea&nbsp;of&nbsp;what&amp;#39;s&nbsp;wrong&nbsp;in&nbsp;your&nbsp;code.&lt;br&gt;&lt;br&gt;Finally,&nbsp;there&nbsp;may&nbsp;be&nbsp;a&nbsp;way&nbsp;for&nbsp;you&nbsp;to&nbsp;&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Apr&nbsp;12,&nbsp;2011&nbsp;at&nbsp;8:48&nbsp;AM,&nbsp;Kamal&nbsp;&nbsp;Nandan&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kamal.nandan@impetus.co.in&quot;&gt;kamal.nandan@impetus.co.in&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
<br>
&lt;div&nbsp;link=&quot;blue&quot;&nbsp;vlink=&quot;purple&quot;&nbsp;lang=&quot;EN-US&quot;&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt;Hi&nbsp;Mustafa,&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt;Thanks&nbsp;for&nbsp;your&nbsp;help…&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt;Infact,&nbsp;I&nbsp;need&nbsp;an&nbsp;asynchronous&nbsp;version&nbsp;only&nbsp;so&nbsp;that&nbsp;my&nbsp;code&nbsp;doesn’t&nbsp;keep&nbsp;on&nbsp;polling&nbsp;the&nbsp;server&nbsp;for&nbsp;new&nbsp;messages..&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;div&nbsp;style=&quot;border-width:&nbsp;medium&nbsp;medium&nbsp;1pt;&nbsp;border-style:&nbsp;none&nbsp;none&nbsp;solid;&nbsp;border-color:&nbsp;-moz-use-text-color&nbsp;-moz-use-text-color&nbsp;windowtext;&nbsp;padding:&nbsp;0in&nbsp;0in&nbsp;1pt;&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;border:&nbsp;medium&nbsp;none;&nbsp;padding:&nbsp;0in;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt;My&nbsp;query&nbsp;is,&nbsp;if&nbsp;we&nbsp;have&nbsp;done&nbsp;something&nbsp;like&nbsp;this:&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;border:&nbsp;medium&nbsp;none;&nbsp;padding:&nbsp;0in;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-left:&nbsp;0.5in;&nbsp;text-indent:&nbsp;0.5in;&quot;&gt;<br>
&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;boolean&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;&nbsp;autoAck&nbsp;=<br>
&lt;b&gt;false&lt;/b&gt;;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           <br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;System.&lt;i&gt;out&lt;/i&gt;.println(&amp;quot;fetching&nbsp;message&nbsp;from&nbsp;the&nbsp;Q:&nbsp;&amp;quot;&nbsp;+&nbsp;queueName&nbsp;+&nbsp;&amp;quot;\n&amp;quot;);<br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           <br>
&lt;b&gt;this&lt;/b&gt;.channel.basicConsume(queueName,&nbsp;autoAck,&nbsp;&lt;b&gt;this&lt;/b&gt;.queueingConsumer);  <br>
&lt;span&nbsp;style=&quot;color:&nbsp;red;&quot;&gt;//&nbsp;We&nbsp;are&nbsp;trying&nbsp;to&nbsp;fetch&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;specified&nbsp;queue&nbsp;name<br>
&lt;b&gt;only&lt;/b&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;red;&quot;&gt;           <br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;QueueingConsumer.Delivery&nbsp;delivery;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;   <br>
&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           <br>
&lt;b&gt;try&lt;/b&gt;&nbsp;{&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;                 &nbsp;delivery&nbsp;=<br>
&lt;b&gt;this&lt;/b&gt;.queueingConsumer.nextDelivery(timeout);    &nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;red;&quot;&gt;//Shouldn’t&nbsp;this&nbsp;fetch&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;specified&nbsp;queue&nbsp;only&nbsp;and&nbsp;not&nbsp;some&nbsp;other&nbsp;queue(s);&nbsp;FYI,&nbsp;the&nbsp;same&nbsp;channel&nbsp;has&nbsp;been&nbsp;bound&nbsp;to&nbsp;a&nbsp;no.&nbsp;of&nbsp;queues;&nbsp;I&nbsp;hope&nbsp;this&nbsp;is&nbsp;not&nbsp;the&nbsp;culprit???&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;red;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;}<br>
&lt;b&gt;catch&lt;/b&gt;&nbsp;(InterruptedException&nbsp;ie)&nbsp;{&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;                 <br>
&lt;b&gt;return&lt;/b&gt;&nbsp;&lt;b&gt;null&lt;/b&gt;;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           <br>
&lt;b&gt;if&lt;/b&gt;(delivery&nbsp;!=&nbsp;&lt;b&gt;null&lt;/b&gt;)&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;{&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;                 &nbsp;channel.basicAck(delivery.getEnvelope().getDeliveryTag(),<br>
&lt;b&gt;false&lt;/b&gt;);&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;                 <br>
&lt;b&gt;byte&lt;/b&gt;[]&nbsp;body&nbsp;=&nbsp;delivery.getBody();&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;                 <br>
&lt;b&gt;return&lt;/b&gt;&nbsp;body;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;}&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           <br>
&lt;b&gt;else&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;{&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;                 <br>
&lt;b&gt;return&lt;/b&gt;&nbsp;&lt;b&gt;null&lt;/b&gt;;&lt;/span&gt;&lt;/p&gt;<br>
&lt;div&nbsp;style=&quot;border-width:&nbsp;medium&nbsp;medium&nbsp;1pt;&nbsp;border-style:&nbsp;none&nbsp;none&nbsp;solid;&nbsp;border-color:&nbsp;-moz-use-text-color&nbsp;-moz-use-text-color&nbsp;windowtext;&nbsp;padding:&nbsp;0in&nbsp;0in&nbsp;1pt;&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;border:&nbsp;medium&nbsp;none;&nbsp;padding:&nbsp;0in;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;           &nbsp;}&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;black;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;black;&quot;&gt;Since,&nbsp;in&nbsp;“channel.basicConsume”,&nbsp;I&nbsp;have&nbsp;passed&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;queue&nbsp;from&nbsp;which&nbsp;data&nbsp;has&nbsp;to&nbsp;be&nbsp;fetched&nbsp;(and&nbsp;not&nbsp;other&nbsp;queues&nbsp;too&nbsp;to&nbsp;which&nbsp;the&nbsp;channel&nbsp;is&nbsp;bound&nbsp;to),<br>
&nbsp;the&nbsp;why&nbsp;do&nbsp;we&nbsp;get&nbsp;data&nbsp;from&nbsp;other&nbsp;queues&nbsp;too&nbsp;when&nbsp;we&nbsp;do&nbsp;“&lt;/span&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;this&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;.queueingConsumer.nextDelivery(timeout);&lt;span&nbsp;style=&quot;color:&nbsp;black;&quot;&gt;”.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;<br>
<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;black;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;black;&quot;&gt;Initially,&nbsp;I&nbsp;had&nbsp;used&nbsp;“basicGet”,&nbsp;but&nbsp;that&nbsp;will&nbsp;be&nbsp;synchronous&nbsp;and&nbsp;that’s&nbsp;the&nbsp;reason&nbsp;why&nbsp;I&nbsp;decided&nbsp;to&nbsp;use&nbsp;“basicConsume”.&lt;/span&gt;&lt;/p&gt;<br>
<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;black;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;black;&quot;&gt;Please&nbsp;also&nbsp;see&nbsp;my&nbsp;comments&nbsp;in<br>
&lt;/span&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;red;&quot;&gt;“RED”.&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;red;&quot;&gt; &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt;Also,&nbsp;you&nbsp;can&nbsp;see&nbsp;a&nbsp;trimmed&nbsp;down&nbsp;version&nbsp;of&nbsp;my&nbsp;code&nbsp;here:&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;a&nbsp;href=&quot;http://pastebin.com/zLJpUFHA&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/zLJpUFHA&lt;/a&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&nbsp;font-family:&nbsp;&amp;quot;Courier&nbsp;New&amp;quot;;&nbsp;color:&nbsp;red;&quot;&gt; &lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt;Thanks&nbsp;&amp;amp;&nbsp;Regards,&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt;Kamal&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&quot;&gt; &lt;/span&gt;&lt;/p&gt;<br>
&lt;div&nbsp;style=&quot;border-width:&nbsp;1pt&nbsp;medium&nbsp;medium;&nbsp;border-style:&nbsp;solid&nbsp;none&nbsp;none;&nbsp;border-color:&nbsp;rgb(181,&nbsp;196,&nbsp;223)&nbsp;-moz-use-text-color&nbsp;-moz-use-text-color;&nbsp;padding:&nbsp;3pt&nbsp;0in&nbsp;0in;&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&quot;&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10pt;&quot;&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss-bounces@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss-bounces@lists.rabbitmq.com&lt;/a&gt;&nbsp;[mailto:&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss-bounces@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss-bounces@lists.rabbitmq.com&lt;/a&gt;]<br>
&lt;b&gt;On&nbsp;Behalf&nbsp;Of&nbsp;&lt;/b&gt;Amr&nbsp;Mostafa&lt;br&gt;<br>
&lt;b&gt;Sent:&lt;/b&gt;&nbsp;Monday,&nbsp;April&nbsp;11,&nbsp;2011&nbsp;7:32&nbsp;PM&lt;br&gt;<br>
&lt;b&gt;To:&lt;/b&gt;&nbsp;Kamal&lt;br&gt;<br>
&lt;b&gt;Cc:&lt;/b&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;b&gt;Subject:&lt;/b&gt;&nbsp;Re:&nbsp;[rabbitmq-discuss]&nbsp;data&nbsp;being&nbsp;fetched&nbsp;from&nbsp;other&nbsp;queues&nbsp;too(that&nbsp;are&nbsp;not&nbsp;named&nbsp;in&nbsp;basicConsume)&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt; &lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin-bottom:&nbsp;12pt;&quot;&gt;Hi&nbsp;Kamal,&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;looks&nbsp;like&nbsp;you&nbsp;are&nbsp;mistaking&nbsp;Channel.basicConsume&nbsp;for&nbsp;Channel.basicGet.&nbsp;The&nbsp;first&nbsp;(which&nbsp;you&nbsp;are&nbsp;using)&nbsp;is&nbsp;asynchronous&nbsp;and&nbsp;what&nbsp;it&nbsp;does&nbsp;is&nbsp;subscribe&nbsp;a&nbsp;consumer&nbsp;with&nbsp;the&nbsp;messaging&nbsp;server&nbsp;on&nbsp;a&nbsp;given&nbsp;queue.&nbsp;All&nbsp;incoming&nbsp;messages&nbsp;to&nbsp;do&nbsp;that&nbsp;queue&nbsp;will&nbsp;be&nbsp;directly<br>
&nbsp;sent&nbsp;by&nbsp;the&nbsp;messaging&nbsp;server&nbsp;to&nbsp;that&nbsp;subscribed&nbsp;consumer.&nbsp;In&nbsp;the&nbsp;QueuingConsumer&nbsp;implementation,&nbsp;those&nbsp;received&nbsp;messages&nbsp;are&nbsp;held&nbsp;in&nbsp;an&nbsp;internal&nbsp;queue&nbsp;and&nbsp;you&nbsp;fetch&nbsp;them&nbsp;using&nbsp;nextDelivery.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;model&nbsp;is&nbsp;called&nbsp;subscription-based,&nbsp;another&nbsp;simpler&nbsp;approach&nbsp;is&nbsp;using&nbsp;Channel.basicGet.&nbsp;I&nbsp;advise&nbsp;you&nbsp;to&nbsp;check&nbsp;this&nbsp;for&nbsp;details:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/api-guide.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/api-guide.html&lt;/a&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;On&nbsp;Mon,&nbsp;Apr&nbsp;11,&nbsp;2011&nbsp;at&nbsp;3:19&nbsp;PM,&nbsp;Kamal&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kamal.nandan@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;kamal.nandan@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;facing&nbsp;a&nbsp;strange&nbsp;problem&nbsp;while&nbsp;using&nbsp;RabbitMq.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;a&nbsp;consumer&nbsp;that&nbsp;creates&nbsp;3&nbsp;queues(just&nbsp;for&nbsp;name&nbsp;sake&nbsp;HIGH/MEDIUM/&lt;br&gt;<br>
LOW&nbsp;priority&nbsp;queues)&nbsp;on&nbsp;the&nbsp;RabbitMQ&nbsp;server&nbsp;and&nbsp;consumes&nbsp;data&nbsp;from&nbsp;the&lt;br&gt;<br>
3&nbsp;queues&nbsp;in&nbsp;this&nbsp;order:&lt;br&gt;<br>
5&nbsp;messages&nbsp;from&nbsp;HIGH&lt;br&gt;<br>
3&nbsp;messages&nbsp;from&nbsp;MEDIUM&lt;br&gt;<br>
2&nbsp;messages&nbsp;from&nbsp;LOW.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;keeps&nbsp;on&nbsp;happening&nbsp;in&nbsp;round-robin&nbsp;fashion.&lt;br&gt;<br>
If&nbsp;there&nbsp;is&nbsp;no&nbsp;data&nbsp;available&nbsp;on&nbsp;the&nbsp;respective&nbsp;queue,&nbsp;the&nbsp;data&nbsp;from&lt;br&gt;<br>
the&nbsp;next&nbsp;queue&nbsp;is&nbsp;fetched.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;using&nbsp;&amp;quot;Channel.basicConsume(queueName,&nbsp;ACK,&nbsp;QueueingConsumer)&amp;quot;&lt;br&gt;<br>
and&nbsp;&amp;quot;QueueingConsumer.nextDelivery(timeout)&amp;quot;&nbsp;to&nbsp;fetch&nbsp;the&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;I&nbsp;see&nbsp;here&nbsp;is:&nbsp;I&nbsp;see&nbsp;that&nbsp;the&nbsp;data&nbsp;is&nbsp;fetched&nbsp;from&nbsp;the&nbsp;other&lt;br&gt;<br>
queues&nbsp;too.&nbsp;i.e.&nbsp;Even&nbsp;though&nbsp;I&nbsp;have&nbsp;passed&nbsp;the&nbsp;queuename&nbsp;as&nbsp;&amp;quot;HIGH&amp;quot;,&lt;br&gt;<br>
then&nbsp;too&nbsp;i&nbsp;see&nbsp;that&nbsp;the&nbsp;data&nbsp;is&nbsp;being&nbsp;fetched&nbsp;from&nbsp;the&nbsp;queue&nbsp;&amp;quot;LOW&amp;quot;&nbsp;or&lt;br&gt;<br>
&amp;quot;MEDIUM&amp;quot;&nbsp;and&nbsp;vice&nbsp;versa.&nbsp;I&nbsp;am&nbsp;finding&nbsp;this&nbsp;behaviour&nbsp;quite&nbsp;strange.&lt;br&gt;<br>
Can&nbsp;someone&nbsp;plz&nbsp;help&nbsp;me&nbsp;out&nbsp;with&nbsp;this.&lt;br&gt;<br>
&lt;br&gt;<br>
Following&nbsp;is&nbsp;a&nbsp;snippet&nbsp;of&nbsp;my&nbsp;code.:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://pastebin.com/s03dP91z&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/s03dP91z&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;in&nbsp;advance..&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(136,&nbsp;136,&nbsp;136);&quot;&gt;Kamal&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt; &lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Amr&nbsp;Mostafa&lt;br&gt;<br>
Egypt&nbsp;Development&nbsp;Center&lt;br&gt;<br>
Member&nbsp;of&nbsp;NTG&lt;br&gt;<br>
Mobile:&nbsp;+(2012)1700502&lt;br&gt;<br>
Office:&nbsp;+(202)24052355/6&nbsp;-&nbsp;Ext.:&nbsp;2005&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;color=&quot;Gray&quot;&nbsp;face=&quot;Verdana&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;<br>
Are&nbsp;you&nbsp;exploring&nbsp;a&nbsp;Big&nbsp;Data&nbsp;Strategy&nbsp;?&nbsp;Listen&nbsp;to&nbsp;this&nbsp;recorded&nbsp;webinar&nbsp;on&nbsp;Planning&nbsp;your&nbsp;Hadoop/&nbsp;NoSQL&nbsp;projects&nbsp;for&nbsp;2011&nbsp;at&nbsp;&lt;a&nbsp;href=&quot;http://www.impetus.com/featured_webinar?eventid=37&quot;&nbsp;target=&quot;_blank&quot;&gt;www.impetus.com/featured_webinar?eventid=37&lt;/a&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Follow&nbsp;us&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;http://www.twitter.com/impetuscalling&quot;&nbsp;target=&quot;_blank&quot;&gt;www.twitter.com/impetuscalling&lt;/a&gt;&nbsp;or&nbsp;visit&nbsp;&lt;a&nbsp;href=&quot;http://www.impetus.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.impetus.com&lt;/a&gt;&nbsp;to&nbsp;know&nbsp;more.<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
NOTE:&nbsp;This&nbsp;message&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;confidential,&nbsp;proprietary,&nbsp;privileged&nbsp;or&nbsp;otherwise&nbsp;protected&nbsp;by&nbsp;law.&nbsp;The&nbsp;message&nbsp;is&nbsp;intended&nbsp;solely&nbsp;for&nbsp;the&nbsp;named&nbsp;addressee.&nbsp;If&nbsp;received&nbsp;in&nbsp;error,&nbsp;please&nbsp;destroy&nbsp;and&nbsp;notify&nbsp;the&nbsp;sender.&nbsp;Any&nbsp;use&nbsp;of&nbsp;this&nbsp;email<br>
&nbsp;is&nbsp;prohibited&nbsp;when&nbsp;received&nbsp;in&nbsp;error.&nbsp;Impetus&nbsp;does&nbsp;not&nbsp;represent,&nbsp;warrant&nbsp;and/or&nbsp;guarantee,&nbsp;that&nbsp;the&nbsp;integrity&nbsp;of&nbsp;this&nbsp;communication&nbsp;has&nbsp;been&nbsp;maintained&nbsp;nor&nbsp;that&nbsp;the&nbsp;communication&nbsp;is&nbsp;free&nbsp;of&nbsp;errors,&nbsp;virus,&nbsp;interception&nbsp;or&nbsp;interference.&lt;br&gt;<br>
<br>
<br>
&lt;/font&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Amr&nbsp;Mostafa&lt;br&gt;Egypt&nbsp;Development&nbsp;Center&lt;br&gt;Member&nbsp;of&nbsp;NTG&lt;br&gt;Mobile:&nbsp;+(2012)1700502&lt;br&gt;Office:&nbsp;+(202)24052355/6&nbsp;-&nbsp;Ext.:&nbsp;2005&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
