<tt>
This&nbsp;is&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;same&nbsp;command&nbsp;line&nbsp;on&nbsp;the&nbsp;broker&nbsp;with&nbsp;high&nbsp;i/o:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rrqm/s&nbsp; &nbsp;wrqm/s&nbsp; &nbsp; &nbsp;r/s&nbsp; &nbsp; &nbsp;w/s&nbsp; &nbsp;rsec/s&nbsp; &nbsp;wsec/s&nbsp;avgrq-sz&nbsp;avgqu-sz&nbsp; &nbsp;await&nbsp; svctm&nbsp; %util&lt;/div&gt;&lt;div&gt;dm-0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00&nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; 0.00&nbsp; &nbsp;83.62&nbsp; &nbsp; &nbsp;0.00&nbsp; 6217.08&nbsp; &nbsp; 74.35&nbsp; &nbsp; &nbsp;0.06&nbsp; &nbsp; 0.78&nbsp; &nbsp;0.50&nbsp; &nbsp;4.20&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;you&amp;#39;re&nbsp;right&nbsp;I&nbsp;was&nbsp;looking&nbsp;at&nbsp;blocks&nbsp;written&nbsp;per&nbsp;second.&nbsp;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;easily&nbsp;retrieve&nbsp;the&nbsp;average&nbsp;ingress&nbsp;rate&nbsp;across&nbsp;all&nbsp;queues&nbsp;for&nbsp;a&nbsp;broker?&nbsp;Maybe&nbsp;what&amp;#39;s&nbsp;happening&nbsp;is&nbsp;a&nbsp;rogue&nbsp;client&nbsp;is&nbsp;spamming&nbsp;that&nbsp;specific&nbsp;server.&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;see&nbsp;the&nbsp;average&nbsp;ingress&nbsp;rate&nbsp;across&nbsp;all&nbsp;our&nbsp;brokers&nbsp;to&nbsp;validate&nbsp;that&nbsp;theory.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;help&nbsp;troubleshooting!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt;Raphael.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Oct&nbsp;26,&nbsp;2011&nbsp;at&nbsp;6:29&nbsp;PM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@rabbitmq.com&quot;&gt;matthias@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Raphael,&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;27/10/11&nbsp;01:47,&nbsp;Matthias&nbsp;Radestock&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Can&nbsp;you&nbsp;find&nbsp;out&nbsp;what&nbsp;files&nbsp;the&nbsp;6k/s&nbsp;writes&nbsp;are&nbsp;going&nbsp;to?&nbsp;It&nbsp;can&amp;#39;t&nbsp;be&lt;br&gt;<br>
just&nbsp;the&nbsp;persistent&nbsp;message&nbsp;store&nbsp;since,&nbsp;as&nbsp;you&nbsp;observed,&nbsp;that&amp;#39;s&nbsp;only&lt;br&gt;<br>
writing&nbsp;16M&nbsp;about&nbsp;every&nbsp;couple&nbsp;of&nbsp;minutes.&nbsp;And&nbsp;while&nbsp;I&nbsp;would&nbsp;expect&nbsp;to&lt;br&gt;<br>
see&nbsp;some&nbsp;writes&nbsp;to&nbsp;the&nbsp;queue&nbsp;index&nbsp;journal&nbsp;files,&nbsp;these&nbsp;shouldn&amp;#39;t&nbsp;add&nbsp;up&lt;br&gt;<br>
to&nbsp;anywhere&nbsp;near&nbsp;6k/s&nbsp;with&nbsp;the&nbsp;traffic&nbsp;levels&nbsp;you&nbsp;are&nbsp;reporting.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Btw,&nbsp;are&nbsp;you&nbsp;definitely&nbsp;looking&nbsp;at&nbsp;the&nbsp;correct&nbsp;column&nbsp;in&nbsp;the&nbsp;iostat&nbsp;output?&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;a&nbsp;test&nbsp;I&nbsp;ran&nbsp;&amp;#39;MulticastMain&nbsp;-f&nbsp;persistent&nbsp;-q&nbsp;1&nbsp;-r&nbsp;17&nbsp;-s&nbsp;50000&amp;#39;&nbsp;(i.e.&nbsp;17msg/s,&nbsp;persistent,&nbsp;qos=1,&nbsp;50k&nbsp;message&nbsp;size),&nbsp;and&nbsp;the&nbsp;same&nbsp;with&nbsp;&amp;quot;-r&nbsp;8&amp;quot;&nbsp;-&nbsp;which&nbsp;roughly&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;rates&nbsp;I&nbsp;saw&nbsp;reported&nbsp;on&nbsp;the&nbsp;two&nbsp;queues&nbsp;in&nbsp;the&nbsp;system&nbsp;with&nbsp;non-negligible&nbsp;traffic.&nbsp;I&nbsp;adjusted&nbsp;rabbit&amp;#39;s&nbsp;memory&nbsp;thresholds&nbsp;s.t.&nbsp;the&nbsp;target_ram_count&nbsp;of&nbsp;the&nbsp;queues&nbsp;dropped&nbsp;to&nbsp;zero&nbsp;but&nbsp;w/o&nbsp;raising&nbsp;the&nbsp;memory&nbsp;alarm.&nbsp;&amp;#39;iostat&nbsp;-d&nbsp;-x&nbsp;10&amp;#39;&nbsp;shows:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rrqm/s&nbsp; &nbsp;wrqm/s&nbsp; &nbsp; &nbsp;r/s&nbsp; &nbsp; &nbsp;w/s&nbsp; &nbsp;rsec/s&nbsp; &nbsp;wsec/s&nbsp;avgrq-sz&nbsp;avgqu-sz&nbsp; &nbsp;await&nbsp; svctm&nbsp; %util&lt;br&gt;<br>
sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp;219.70&nbsp; &nbsp; 0.00&nbsp; &nbsp;57.70&nbsp; &nbsp; &nbsp;0.00&nbsp; 2219.20&nbsp;38.46&nbsp; &nbsp; &nbsp;0.61&nbsp; &nbsp;10.57&nbsp; 10.55&nbsp; 60.90&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;that&amp;#39;s&nbsp;just&nbsp;57.70&nbsp;writes/s.&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
