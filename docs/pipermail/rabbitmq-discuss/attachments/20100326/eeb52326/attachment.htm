<tt>
Another&nbsp;technique&nbsp;we&nbsp;use:&lt;br&gt;&lt;br&gt;Start&nbsp;one&nbsp;consumer.&lt;br&gt;&lt;br&gt;Start&nbsp;your&nbsp;other&nbsp;consumers.&lt;br&gt;&lt;br&gt;Restart&nbsp;the&nbsp;first&nbsp;consumer.&lt;br&gt;&lt;br&gt;This&nbsp;let&amp;#39;s&nbsp;you&nbsp;keep&nbsp;the&nbsp;high&nbsp;prefetch&nbsp;settings&nbsp;while&nbsp;still&nbsp;getting&nbsp;the&nbsp;messages&nbsp;to&nbsp;distribute&nbsp;more&nbsp;evenly.&lt;br&gt;<br>
&lt;br&gt;Bryan&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Mar&nbsp;26,&nbsp;2010&nbsp;at&nbsp;6:08&nbsp;AM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@lshift.net&quot;&gt;matthias@lshift.net&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Gustavo,&lt;br&gt;<br>
&lt;br&gt;<br>
Gustavo&nbsp;Aquino&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;1-&nbsp;Start&nbsp;RabbitMQ&lt;br&gt;<br>
&amp;gt;&nbsp;2-&nbsp;Start&nbsp;8&nbsp;consumers&nbsp;in&nbsp;concurrent&nbsp;mode&nbsp;(8&nbsp;consumers&nbsp;at&nbsp;same&nbsp;time).&lt;br&gt;<br>
&amp;gt;&nbsp;3-&nbsp;Start&nbsp;producer&lt;br&gt;<br>
&amp;gt;&nbsp;4-&nbsp;Fating&nbsp;queue&nbsp;with&nbsp;~3000&nbsp;messages&nbsp;per&nbsp;second&nbsp;having&nbsp;~400bytes&lt;br&gt;<br>
&amp;gt;&nbsp;5-&nbsp;When&nbsp;queue&nbsp;have&nbsp;~170.000&nbsp;stop&nbsp;consumers&nbsp;and&nbsp;producer&lt;br&gt;<br>
&amp;gt;&nbsp;6-&nbsp;Start&nbsp;consumers&nbsp;in&nbsp;concurrent&nbsp;mode(8&nbsp;consumers&nbsp;at&nbsp;same&nbsp;time)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;After&nbsp;that,&nbsp;consumers&nbsp;are&nbsp;connected&nbsp;to&nbsp;Rabbit,&nbsp;but&nbsp;if&nbsp;you&nbsp;take&nbsp;a&nbsp;look&lt;br&gt;<br>
&amp;gt;&nbsp;about&nbsp;queue&nbsp;consumers,&nbsp;we&nbsp;have&nbsp;only&nbsp;3&nbsp;or&nbsp;4&nbsp;consumers...&nbsp;all&nbsp;others&nbsp;are&lt;br&gt;<br>
&amp;gt;&nbsp;waiting&nbsp;something&nbsp;but&nbsp;don&amp;#39;t&nbsp;consume&nbsp;nothing.&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;need&nbsp;to&nbsp;set&nbsp;a&nbsp;basic.qos&nbsp;prefetch&nbsp;limit,&nbsp;e.g.&nbsp;using&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/releases/rabbitmq-java-client/v1.7.2/rabbitmq-java-client-javadoc-1.7.2/com/rabbitmq/client/Channel.html#basicQos%28int,%20int,%20boolean%29&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/releases/rabbitmq-java-client/v1.7.2/rabbitmq-java-client-javadoc-1.7.2/com/rabbitmq/client/Channel.html#basicQos(int,%20int,%20boolean)&lt;/a&gt;.&lt;br&gt;<br>
<br>
to&nbsp;place&nbsp;a&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;messages&nbsp;the&nbsp;server&nbsp;will&nbsp;send&nbsp;to&nbsp;a&lt;br&gt;<br>
client&nbsp;w/o&nbsp;waiting&nbsp;for&nbsp;acknowledgement.&nbsp;Otherwise,&nbsp;when&nbsp;the&nbsp;first&lt;br&gt;<br>
consumer&nbsp;starts&nbsp;consuming&nbsp;from&nbsp;a&nbsp;queue&nbsp;it&nbsp;will&nbsp;get&nbsp;sent&nbsp;all&nbsp;the&nbsp;queue&amp;#39;s&lt;br&gt;<br>
messages&nbsp;(network&nbsp;capacity&nbsp;permitting).&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
