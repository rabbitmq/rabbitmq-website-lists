<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;br&gt;On&nbsp;Thursday,&nbsp;January&nbsp;30,&nbsp;2014&nbsp;1:22:24&nbsp;PM&nbsp;UTC+5:30,&nbsp;akhil....@gslab.com&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0;margin-left:&nbsp;0.8ex;border-left:&nbsp;1px&nbsp;#ccc&nbsp;solid;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&nbsp;All,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;I&nbsp;am&nbsp;working&nbsp;on&nbsp;RabbitMQ&nbsp;HA&nbsp;cluster&nbsp;.&nbsp;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;&nbsp;I&nbsp;want&nbsp;my&nbsp;client&nbsp;to&nbsp;connect&nbsp;to&nbsp;slave&nbsp;node&nbsp;when&nbsp;the&nbsp;master&nbsp;node&nbsp;goes&nbsp;down.&nbsp;&lt;/span&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;achieve&nbsp;this&nbsp;using&nbsp;consumer&nbsp;cancel&nbsp;notification.&lt;/span&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;I&nbsp;am&nbsp;using&nbsp;python&nbsp;amqp&nbsp;1.4.2&nbsp;library&nbsp;.&nbsp;I&nbsp;have&nbsp;set&nbsp;the&nbsp;capability&nbsp;'consumer_cancel_notify'&nbsp;as&nbsp;True&nbsp;in&nbsp;client_properties.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;In&nbsp;basic_consume()&nbsp;I&nbsp;have&nbsp;passed&nbsp;a&nbsp;callback&nbsp;function&nbsp;to&nbsp;on_cancel&nbsp;parameter.&nbsp;But&nbsp;this&nbsp;callback&nbsp;is&nbsp;not&nbsp;called&nbsp;when&nbsp;master&nbsp;goes&nbsp;down.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;Can&nbsp;someone&nbsp;tell&nbsp;where&nbsp;I&nbsp;am&nbsp;going&nbsp;wrong.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;Following&nbsp;is&nbsp;my&nbsp;code&nbsp;:&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:14px;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;import&nbsp;amqp&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;#&nbsp;this&nbsp;is&nbsp;the&nbsp;callback&nbsp;function&nbsp;to&nbsp;receive&nbsp;the&nbsp;messages&nbsp;published&nbsp;to&nbsp;the&nbsp;queue&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;def&nbsp;myCallback(message):&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;messsage&nbsp;received&quot;,message.body&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;#&nbsp;this&nbsp;is&nbsp;the&nbsp;&nbsp;callback&nbsp;Function&nbsp;for&nbsp;consumer&nbsp;cancel&nbsp;notification&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;def&nbsp;cancelCallback():&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;cancelCallback&nbsp;called&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;cpDict&nbsp;=&nbsp;{&quot;capabilities&quot;:{&quot;consumer_&lt;wbr&gt;cancel_notify&quot;:&nbsp;True,&nbsp;},}&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:small&quot;&gt;con&nbsp;=&nbsp;amqp.Connection(host&nbsp;=&quot;localhost:5672&quot;,userid&nbsp;=&quot;guest&quot;,password=&quot;guest&quot;,&lt;/span&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px;color:rgb(0,0,0);font-family:Arial,'Liberation&nbsp;Sans','DejaVu&nbsp;Sans',sans-serif;font-size:small&quot;&gt;clie&lt;wbr&gt;nt_properties=cpDict)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;channel&nbsp;=&nbsp;con.channel()&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;channel.exchange_declare(&lt;wbr&gt;exchange=&quot;exchange1&quot;,type='&lt;wbr&gt;direct',&nbsp;durable=True,&nbsp;auto_delete=False)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;channel.queue_declare(queue=&quot;&lt;wbr&gt;bm2_execQ&quot;,&nbsp;durable=True,exclusive=True,&nbsp;auto_delete=False)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;channel.queue_bind(queue=&quot;bm2_&lt;wbr&gt;execQ&quot;,exchange=&quot;exchange1&quot;,&nbsp;routing_key=&quot;bm2_execQ&quot;)&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;channel.basic_consume(queue=&quot;&lt;wbr&gt;bm2_execQ&quot;,callback=&lt;wbr&gt;myCallback,&nbsp;consumer_tag=&quot;bm2_tag&quot;,on_&lt;wbr&gt;cancel=cancelCallback)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;msg&nbsp;=&nbsp;amqp.Message(&quot;hi&quot;)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;msg.properties[&quot;content_type&quot;]&nbsp;=&nbsp;&quot;text/plain&quot;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;msg.properties[&quot;delivery_mode&quot;&lt;wbr&gt;]&nbsp;=&nbsp;2&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;channel.basic_publish(msg,&quot;&lt;wbr&gt;exchange1&quot;,&quot;bm2_execQ&quot;)&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;while&nbsp;True&nbsp;:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;Arial,&nbsp;Liberation&nbsp;Sans,&nbsp;DejaVu&nbsp;Sans,&nbsp;sans-serif&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;style=&quot;line-height:17.804800033569336px&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;channel.wait()&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Can&nbsp;somebody&nbsp;please&nbsp;help&nbsp;me&nbsp;on&nbsp;this?&nbsp;&lt;/div&gt;&lt;/div&gt;
</tt>
