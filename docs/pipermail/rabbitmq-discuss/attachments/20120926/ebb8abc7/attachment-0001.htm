<tt>
&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Hi &nbsp;Matthias,&lt;/span&gt;&lt;div&nbsp;class=&quot;im&quot;&nbsp;style=&quot;color:rgb(80,0,80);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#3366ff&quot;&gt;What&amp;#39;s&nbsp;the&nbsp;general&nbsp;health&nbsp;of&nbsp;your&nbsp;rabbit&nbsp;when&nbsp;this&nbsp;happens?&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
The&nbsp;RabbitMQ&nbsp;nodes&nbsp;seems&nbsp;fine&nbsp;during&nbsp;the&nbsp;incident&nbsp;happened:&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;b&gt;&lt;u&gt;Master&nbsp;Node&nbsp;Usage&lt;/u&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Memory&nbsp;:&nbsp;300M&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
CPU&nbsp;%&nbsp; :&nbsp;Average&nbsp;30%&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;u&gt;&lt;b&gt;Slave&nbsp;Node&nbsp;Usage&lt;/b&gt;&lt;/u&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Memory&nbsp;:&nbsp;130M&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
CPU&nbsp;%&nbsp; : Average&nbsp;30%&lt;/div&gt;&lt;div&nbsp;class=&quot;im&quot;&nbsp;style=&quot;color:rgb(80,0,80);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#3366ff&quot;&gt;Plenty&nbsp;of&nbsp;free&nbsp;memory&nbsp;and&nbsp;disk?&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Yes,&nbsp;there&nbsp;are&nbsp;plenty&nbsp;of&nbsp;free&nbsp;memory&nbsp;and&nbsp;disk&nbsp;space&nbsp;in&nbsp;both&nbsp;servers.&lt;/div&gt;&lt;div&nbsp;class=&quot;im&quot;&nbsp;style=&quot;color:rgb(80,0,80);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#3366ff&quot;&gt;Are&nbsp;you&nbsp;using&nbsp;mirrored/HA&nbsp;queues&nbsp;at&nbsp;all?&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Yes,&nbsp;I&amp;#39;m&nbsp;using&nbsp;HA&nbsp;in&nbsp;all&nbsp;queues.&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&nbsp;style=&quot;color:rgb(80,0,80);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#3366ff&quot;&gt;Could&nbsp;there&nbsp;possibly&nbsp;be&nbsp;a&nbsp;spike,&nbsp;i.e.&nbsp;lots&nbsp;of&nbsp;messages&nbsp;getting&nbsp;published&nbsp;in&nbsp;a&nbsp;short&nbsp;space&nbsp;of&nbsp;time?&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;No,&nbsp;I&nbsp;checked&nbsp;there&nbsp;are&nbsp;only&nbsp;few&nbsp;messages&nbsp;during&nbsp;that&nbsp;time,&nbsp;e.g.&nbsp;2012-09-26&nbsp;03:28:32&nbsp;=&amp;gt;&nbsp;4&nbsp;messages&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&nbsp;style=&quot;color:rgb(80,0,80);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#3366ff&quot;&gt;No&nbsp;strange&nbsp;errors&nbsp;in&nbsp;the&nbsp;logs? &lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
After&nbsp;the&nbsp;incident&nbsp;happened&nbsp;RabbitMQ&nbsp;did&nbsp;logged&nbsp;warning,&nbsp;e.g.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;b&gt;&lt;u&gt;RabbitMQ&nbsp;Log&lt;/u&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;b&gt;&lt;u&gt;&lt;br&gt;&lt;/u&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;div&gt;=WARNING&nbsp;REPORT====&nbsp;26-Sep-2012::03:29:25&nbsp;===&lt;/div&gt;&lt;div&gt;closing&nbsp;AMQP&nbsp;connection&nbsp;&amp;lt;0.8661.18&amp;gt;&nbsp;(&lt;a&nbsp;href=&quot;http://192.168.0.100:46151/&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:rgb(17,85,204)&quot;&gt;192.168.0.100:46151&lt;/a&gt; -&amp;gt; &lt;a&nbsp;href=&quot;http://192.168.0.100:5672/&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:rgb(17,85,204)&quot;&gt;192.168.0.100:5672&lt;/a&gt;):&lt;/div&gt;<br>
&lt;div&gt;connection_closed_abruptly&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;26-Sep-2012::03:29:37&nbsp;===&lt;/div&gt;&lt;div&gt;accepting&nbsp;AMQP&nbsp;connection&nbsp;&amp;lt;0.8897.18&amp;gt;&nbsp;(&lt;a&nbsp;href=&quot;http://192.168.0.100:43836/&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:rgb(17,85,204)&quot;&gt;192.168.0.100:43836&lt;/a&gt; -&amp;gt; &lt;a&nbsp;href=&quot;http://192.168.0.100:5672/&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:rgb(17,85,204)&quot;&gt;192.168.0.100:5672&lt;/a&gt;)&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Regards,&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;<br>
Wong&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;25,&nbsp;2012&nbsp;at&nbsp;2:32&nbsp;PM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;matthias@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Wong,&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;25/09/12&nbsp;03:46,&nbsp;Wong&nbsp;Kam&nbsp;Hoong&nbsp;wrote:&lt;br&gt;<br>
&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
com.rabbitmq.client.&lt;u&gt;&lt;/u&gt;ShutdownSignalException:&nbsp;clean&nbsp;channel&nbsp;shutdown;&lt;br&gt;<br>
reason:&nbsp;#method&amp;lt;channel.close&amp;gt;(reply-&lt;u&gt;&lt;/u&gt;code=406,&nbsp;reply-text=TIMEOUT&lt;br&gt;<br>
WAITING&nbsp;FOR&nbsp;ACK,&nbsp;class-id=0,&nbsp;method-id=0)&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; at&lt;br&gt;<br>
com.rabbitmq.client.impl.&lt;u&gt;&lt;/u&gt;ChannelN.waitForConfirms(&lt;u&gt;&lt;/u&gt;ChannelN.java:182)&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Based&nbsp;on&nbsp;the&nbsp;log,&nbsp;the&nbsp;problem&nbsp;seems&nbsp;like&nbsp;related&nbsp;to&nbsp;&amp;quot;*NACKS&nbsp;Received*&amp;quot;&lt;br&gt;<br>
and&nbsp;&amp;quot;*ChannelN*&amp;quot;&nbsp;code&nbsp;throw&nbsp;the&nbsp;TimeoutException&nbsp;with&nbsp;reply-code&nbsp;*406&lt;br&gt;<br>
*(PRECONDITION_FAILED).&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
I&nbsp;don&amp;#39;t&nbsp;think&nbsp;it&nbsp;has&nbsp;anything&nbsp;to&nbsp;do&nbsp;with&nbsp;nacks&nbsp;-&nbsp;unless&nbsp;you&nbsp;are&nbsp;actually&nbsp;seeing&nbsp;some&nbsp;exception&nbsp;mentioning&nbsp;nacks.&lt;br&gt;<br>
&lt;br&gt;<br>
Looks&nbsp;like&nbsp;a&nbsp;straightforward&nbsp;timeout.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
I&nbsp;check&nbsp;all&nbsp;RabbitMQ&nbsp;servers&nbsp;are&nbsp;still&nbsp;working&nbsp;fine&nbsp;and&nbsp;I&nbsp;believe&nbsp;the&lt;br&gt;&lt;/div&gt;<br>
time&nbsp;I&nbsp;set&nbsp;for&nbsp;*waitForConfirmsOrDie&nbsp;*(10000)&nbsp;should&nbsp;be&nbsp;sufficient&nbsp;enough.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
10s&nbsp;should&nbsp;indeed&nbsp;generally&nbsp;be&nbsp;long&nbsp;enough.&nbsp;But&nbsp;one&nbsp;can&nbsp;certainly&nbsp;envision&nbsp;scenarios&nbsp;where&nbsp;it&nbsp;won&amp;#39;t&nbsp;be.&nbsp;What&amp;#39;s&nbsp;the&nbsp;general&nbsp;health&nbsp;of&nbsp;your&nbsp;rabbit&nbsp;when&nbsp;this&nbsp;happens?&nbsp;Plenty&nbsp;of&nbsp;free&nbsp;memory&nbsp;and&nbsp;disk?&nbsp;No&nbsp;strange&nbsp;errors&nbsp;in&nbsp;the&nbsp;logs?&nbsp;Are&nbsp;you&nbsp;using&nbsp;mirrored/HA&nbsp;queues&nbsp;at&nbsp;all?&nbsp;Could&nbsp;there&nbsp;possibly&nbsp;be&nbsp;a&nbsp;spike,&nbsp;i.e.&nbsp;lots&nbsp;of&nbsp;messages&nbsp;getting&nbsp;published&nbsp;in&nbsp;a&nbsp;short&nbsp;space&nbsp;of&nbsp;time?&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
