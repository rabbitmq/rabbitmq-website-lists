<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type='text/css'&gt;p&nbsp;{&nbsp;margin:&nbsp;0;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style='font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;12pt;&nbsp;color:&nbsp;#000000'&gt;Hello&lt;br&gt;i'm&nbsp;new&nbsp;in&nbsp;rabbitmq.&nbsp;can&nbsp;i&amp;nbsp;&nbsp;to&nbsp;send&amp;nbsp;&nbsp;messages&nbsp;with&nbsp;a&nbsp;specific&amp;nbsp;&nbsp;priority&nbsp;of&nbsp;the&nbsp;producer&nbsp;for&nbsp;the&nbsp;consumer?&nbsp;&lt;br&gt;&lt;br&gt;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;queue&nbsp;has&nbsp;more&nbsp;than&nbsp;one&nbsp;message,&nbsp;the&nbsp;consumer&nbsp;must&nbsp;first&nbsp;receive&nbsp;the&nbsp;message&nbsp;that&nbsp;has&nbsp;the&nbsp;highest&nbsp;priority&lt;br&gt;&lt;br&gt;we&nbsp;tested&nbsp;the&nbsp;property&nbsp;of&nbsp;the&nbsp;message&nbsp;&quot;priority&quot;&nbsp;but&amp;nbsp;&nbsp;i&nbsp;not&nbsp;obtained&nbsp;a&nbsp;good&nbsp;result.&nbsp;i&nbsp;send&nbsp;my&nbsp;code.&nbsp;&lt;br&gt;&lt;br&gt;Producer.java&lt;br&gt;public&nbsp;class&nbsp;Producer&nbsp;{&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;TASK_QUEUE_NAME&nbsp;=&nbsp;&quot;task_queue&quot;;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;argv)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throws&nbsp;java.io.IOException&nbsp;{&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ConnectionFactory&nbsp;factory&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;factory.setHost(&quot;localhost&quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Connection&nbsp;connection&nbsp;=&nbsp;factory.newConnection();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Channel&nbsp;channel&nbsp;=&nbsp;connection.createChannel();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;boolean&nbsp;durable&nbsp;=&nbsp;true;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.queueDeclare(TASK_QUEUE_NAME,&nbsp;durable,&nbsp;false,&nbsp;false,&nbsp;null);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;BasicProperties&nbsp;props&nbsp;=&nbsp;new&nbsp;BasicProperties.Builder().priority(0).build();&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;String&nbsp;message;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;3;&nbsp;i++)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;message&nbsp;=&nbsp;&quot;cerooo&quot;;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.basicPublish(&quot;&quot;,&nbsp;TASK_QUEUE_NAME,&nbsp;props,&nbsp;message.getBytes());&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;System.out.println(&quot;&nbsp;[x]&nbsp;Sent&nbsp;'&quot;&nbsp;+&nbsp;message&nbsp;+&nbsp;&quot;'&quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.close();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;connection.close();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;}&lt;br&gt;&lt;br&gt;Consumer.java&lt;br&gt;public&nbsp;class&nbsp;Consumer&nbsp;{&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;TASK_QUEUE_NAME&nbsp;=&nbsp;&quot;task_queue&quot;;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;argv)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;throws&nbsp;java.io.IOException,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;java.lang.InterruptedException&nbsp;{&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ConnectionFactory&nbsp;factory&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;factory.setHost(&quot;localhost&quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Connection&nbsp;connection&nbsp;=&nbsp;factory.newConnection();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Channel&nbsp;channel&nbsp;=&nbsp;connection.createChannel();&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.queueDeclare(TASK_QUEUE_NAME,&nbsp;true,&nbsp;false,&nbsp;false,&nbsp;null);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;System.out.println(&quot;&nbsp;[*]&nbsp;Waiting&nbsp;for&nbsp;messages.&nbsp;To&nbsp;exit&nbsp;press&nbsp;CTRL+C&quot;);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.basicQos(1);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;QueueingConsumer&nbsp;consumer&nbsp;=&nbsp;new&nbsp;QueueingConsumer(channel);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.basicConsume(TASK_QUEUE_NAME,&nbsp;false,&nbsp;consumer);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;while&nbsp;(true)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;QueueingConsumer.Delivery&nbsp;delivery&nbsp;=&nbsp;consumer.nextDelivery();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;String&nbsp;message&nbsp;=&nbsp;new&nbsp;String(delivery.getBody());&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;System.out.println(&quot;&nbsp;[x]&nbsp;Received&nbsp;'&quot;&nbsp;+&nbsp;message&nbsp;+&nbsp;&quot;'&quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Thread.sleep(2000);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;System.out.println(&quot;&nbsp;[x]&nbsp;Done&quot;);&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;channel.basicAck(delivery.getEnvelope().getDeliveryTag(),&nbsp;false);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;}&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;br&gt;Any&nbsp;ideas&nbsp;how&nbsp;I&nbsp;can&nbsp;do&nbsp;this?&lt;br&gt;&lt;br&gt;thanks&nbsp;in&nbsp;advance.&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;name=&quot;x&quot;&gt;&lt;/span&gt;&lt;div&gt;Saludos,&lt;br&gt;Yuri.&lt;br&gt;&lt;br&gt;&lt;img&nbsp;src=&quot;/home/yuri/Escritorio/aa0qm2.gif&quot;&gt;&lt;/div&gt;&lt;span&nbsp;name=&quot;x&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;html&gt;<br>
&lt;body&gt;<br>
&lt;a&nbsp;href=&quot;http://www.antiterroristas.cu/&quot;&gt;<br>
&lt;img&nbsp;src=&quot;http://cincoheroes.uci.cu/cinco.gif&quot;&nbsp;alft=&quot;Para&nbsp;mas&nbsp;informacion&nbsp;consultar&nbsp;\n&nbsp;<br>
http://wwww.antiterroristas.cu&nbsp;y&nbsp;http://justiciaparaloscinco.wordpress.com&quot;&nbsp;width=&quot;792&quot;&nbsp;height=&quot;52&quot;&nbsp;/&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>
<br>
&lt;br&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
