<tt>
Hi&nbsp;there,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm&nbsp;working&nbsp;on&nbsp;an&nbsp;application&nbsp;where&nbsp;untrusted&nbsp;clients&nbsp;connect&nbsp;to&nbsp;RabbitMQ&nbsp;as&nbsp;consumers&nbsp;in&nbsp;a&nbsp;pub/sub&nbsp;scheme.&nbsp;Clients&nbsp;can&nbsp;connect&nbsp;either&nbsp;as&nbsp;anonymous&nbsp;guests&nbsp;or&nbsp;as&nbsp;registered&nbsp;users&nbsp;via&nbsp;username/password.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;backend&nbsp;that&nbsp;acts&nbsp;as&nbsp;a&nbsp;producer.&nbsp;The&nbsp;producer&nbsp;publishes&nbsp;two&nbsp;types&nbsp;of&nbsp;messages:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;Public&nbsp;messages&nbsp;with&nbsp;information&nbsp;that&nbsp;every&nbsp;client&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;consume&nbsp;by&nbsp;binding&nbsp;their&nbsp;queues&nbsp;to&nbsp;the&nbsp;relevant&nbsp;topic&nbsp;exchange&nbsp;and&nbsp;routing&nbsp;key.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2)&nbsp;Private&nbsp;messages&nbsp;that&nbsp;are&nbsp;targeted&nbsp;at&nbsp;specific&nbsp;users&nbsp;(each&nbsp;message&nbsp;is&nbsp;targeted&nbsp;at&nbsp;one&nbsp;particular&nbsp;user).&nbsp;Clients&nbsp;should&nbsp;only&nbsp;be&nbsp;able&nbsp;to&nbsp;consume&nbsp;messages&nbsp;targeted&nbsp;at&nbsp;the&nbsp;user&nbsp;with&nbsp;which&nbsp;they&nbsp;connected.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;question&nbsp;now&nbsp;is,&nbsp;how&nbsp;to&nbsp;best&nbsp;enforce&nbsp;this&nbsp;authorization&nbsp;scheme.&nbsp;It&nbsp;doesn't&nbsp;seem&nbsp;like&nbsp;RabbitMQ&nbsp;supports&nbsp;authorization&nbsp;based&nbsp;on&nbsp;routing&nbsp;keys&nbsp;but&nbsp;only&nbsp;on&nbsp;vhosts,&nbsp;exchanges&nbsp;and&nbsp;queues.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;They&nbsp;way&nbsp;I&nbsp;would&nbsp;solve&nbsp;this&nbsp;is&nbsp;by&nbsp;having&nbsp;the&nbsp;producer&nbsp;create&nbsp;a&nbsp;topic&nbsp;exchange&nbsp;per&nbsp;user&nbsp;and&nbsp;only&nbsp;give&nbsp;that&nbsp;particular&nbsp;user&nbsp;the&nbsp;right&nbsp;to&nbsp;bind&nbsp;its&nbsp;queues&nbsp;against&nbsp;it.&nbsp;Private&nbsp;messages&nbsp;would&nbsp;be&nbsp;published&nbsp;to&nbsp;the&nbsp;target&nbsp;user's&nbsp;topic&nbsp;exchange&nbsp;while&nbsp;public&nbsp;messages&nbsp;would&nbsp;be&nbsp;published&nbsp;to&nbsp;amq.topic.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;this&nbsp;secure&nbsp;or&nbsp;am&nbsp;I&nbsp;missing&nbsp;something?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;How&nbsp;light-weight&nbsp;are&nbsp;exchanges&nbsp;in&nbsp;RabbitMQ?&nbsp;What&nbsp;dose&nbsp;the&nbsp;memory&nbsp;and&nbsp;computational&nbsp;complexity&nbsp;look&nbsp;like&nbsp;if&nbsp;there&nbsp;are&nbsp;N&nbsp;exchanges?&nbsp;O(1)&nbsp;or&nbsp;worse?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;are&nbsp;not&nbsp;talking&nbsp;about&nbsp;a&nbsp;few&nbsp;hundred&nbsp;users&nbsp;but&nbsp;hundreds&nbsp;of&nbsp;thousands,&nbsp;if&nbsp;not&nbsp;millions,&nbsp;of&nbsp;users&nbsp;-&nbsp;and&nbsp;hence&nbsp;millions&nbsp;of&nbsp;exchanges.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Jonas&lt;/div&gt;
</tt>
