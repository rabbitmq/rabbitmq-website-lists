<tt>
Ah,&nbsp;if&nbsp;I&nbsp;do&nbsp;both&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  &nbsp; ch.exchange_declare(my_exchange,&nbsp;&amp;#39;fanout&amp;#39;,&nbsp;durable=False,&nbsp;auto_delete=False)&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; qname,&nbsp;n_msgs,&nbsp;n_consumers&nbsp;=&nbsp;ch.queue_declare(queue_name,&nbsp;durable=False,&nbsp;exclusive=False,&nbsp;auto_delete=True)&lt;/div&gt;&lt;div&gt;and&nbsp;send&nbsp;the&nbsp;message&nbsp;as&nbsp;immediate&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  &nbsp; def&nbsp;message(self,&nbsp;message):&lt;/div&gt;<br>
&lt;div&gt;  &nbsp; &nbsp; &nbsp; self.ch.basic_publish(&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; amqp.Message(pickle.dumps(message)),&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; my_exchange,&nbsp;&amp;quot;logger&amp;quot;,&nbsp;immediate=True&lt;/div&gt;&lt;div&gt;  &nbsp; &nbsp; &nbsp; )&lt;/div&gt;&lt;/div&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
Then&nbsp;it&nbsp;works&nbsp;the&nbsp;way&nbsp;I&nbsp;expect. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Jul&nbsp;20,&nbsp;2009&nbsp;at&nbsp;12:36&nbsp;PM,&nbsp;Brian&nbsp;Whitman&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:brian@echonest.com&quot;&gt;brian@echonest.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Hmm...&nbsp;this&nbsp;is&nbsp;not&nbsp;working&nbsp;the&nbsp;way&nbsp;I&nbsp;expect. &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;do&nbsp;either&nbsp;Holger&nbsp;or&nbsp;Matthias&amp;#39;s&nbsp;solution&nbsp;the&nbsp;write-only&nbsp;&amp;quot;logger&amp;quot;&nbsp;queue&nbsp;continues&nbsp;to&nbsp;grow&nbsp;but&nbsp;the&nbsp;listener&nbsp;queues&nbsp;do&nbsp;stay&nbsp;at&nbsp;0:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;div&gt;~/rabbitmq-server/scripts#&nbsp;./rabbitmqctl&nbsp;list_queues&nbsp;name&nbsp;mode&nbsp;messages&nbsp;messages_ready&nbsp;messages_unacknowledged&nbsp;durable&lt;/div&gt;&lt;div&gt;Listing&nbsp;queues&nbsp;...&lt;/div&gt;&lt;/div&gt;&lt;div&gt;logger_2b02ca30-754b-11de-99c0-0023dfde57d8&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;mixed&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;0&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;0&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;0&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;false&lt;/div&gt;<br>
<br>
&lt;div&gt;logger&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;mixed&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;110&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;110&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;0&lt;span&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;false&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;see&nbsp;here&nbsp;is&nbsp;that&nbsp;logger&nbsp;is&nbsp;always&nbsp;0&nbsp;messages.&nbsp;If&nbsp;there&nbsp;are&nbsp;listeners&nbsp;or&nbsp;not,&nbsp;I&nbsp;don&amp;#39;t&nbsp;want&nbsp;the&nbsp;queue&nbsp;called&nbsp;&amp;quot;logger&amp;quot;&nbsp;to&nbsp;ever&nbsp;retain&nbsp;any&nbsp;messages. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;For&nbsp;both&nbsp;&amp;quot;logger&amp;quot;&nbsp;(write&nbsp;only)&nbsp;and&nbsp;the&nbsp;random&nbsp;queue&nbsp;names&nbsp;(read&nbsp;only)&nbsp;I&nbsp;am&nbsp;doing&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;  &nbsp; ch.exchange_declare(my_exchange,&nbsp;&amp;#39;fanout&amp;#39;,&nbsp;durable=False,&nbsp;auto_delete=False)&lt;/div&gt;<br>
&lt;div&gt;<br>
  &nbsp; qname,&nbsp;n_msgs,&nbsp;n_consumers&nbsp;=&nbsp;ch.queue_declare(queue_name,&nbsp;durable=False,&nbsp;exclusive=False,&nbsp;auto_delete=True)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Mon,&nbsp;Jul&nbsp;20,&nbsp;2009&nbsp;at&nbsp;12:20&nbsp;PM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@lshift.net&quot;&nbsp;target=&quot;_blank&quot;&gt;matthias@lshift.net&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
<br>
Brian,&nbsp;Holger,&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
Holger&nbsp;Hoffstätte&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Brian&nbsp;Whitman&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;I&nbsp;am&nbsp;concerned&nbsp;about&nbsp;this&nbsp;because&nbsp;over&nbsp;the&nbsp;weekend&nbsp;the&nbsp;broker&nbsp;crashed&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;(not&nbsp;sure&nbsp;why&nbsp;yet,&nbsp;but&nbsp;I&nbsp;assume&nbsp;it&nbsp;had&nbsp;something&nbsp;to&nbsp;do&nbsp;with&nbsp;probably&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;~50m&nbsp;messages&nbsp;sitting&nbsp;in&nbsp;the&nbsp;exchange.)&nbsp;How&nbsp;can&nbsp;I&nbsp;have&nbsp;messages&nbsp;be&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;completely&nbsp;transient?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;This&nbsp;is&nbsp;done&nbsp;with&nbsp;the&nbsp;&amp;quot;immediate&amp;quot;&nbsp;flag&nbsp;for&nbsp;a&nbsp;message;&nbsp;if&nbsp;there&nbsp;is&nbsp;no&lt;br&gt;<br>
&amp;gt;&nbsp;recipient,&nbsp;the&nbsp;message&nbsp;will&nbsp;be&nbsp;dropped.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Actually,&nbsp;generally&nbsp;a&nbsp;better&nbsp;solution&nbsp;to&nbsp;the&nbsp;problem&nbsp;is&nbsp;to&nbsp;ensure&nbsp;that&lt;br&gt;<br>
the&nbsp;queues&nbsp;do&nbsp;not&nbsp;outlive&nbsp;the&nbsp;consumers&nbsp;-&nbsp;by&nbsp;either&nbsp;marking&nbsp;them&lt;br&gt;<br>
exclusive&nbsp;(if&nbsp;you&nbsp;only&nbsp;have&nbsp;one&nbsp;consumer&nbsp;per&nbsp;queue)&nbsp;or&nbsp;auto-delete.&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;way&nbsp;messages&nbsp;do&nbsp;really&nbsp;get&nbsp;dropped&nbsp;silently&nbsp;when&nbsp;there&nbsp;are&nbsp;no&lt;br&gt;<br>
consumers.&nbsp;By&nbsp;contrast,&nbsp;when&nbsp;setting&nbsp;&amp;#39;immediate&amp;#39;&nbsp;the&nbsp;server&nbsp;will&nbsp;send&nbsp;a&lt;br&gt;<br>
basic.return&nbsp;to&nbsp;the&nbsp;producer.&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;buffering&nbsp;can&nbsp;still&nbsp;take&nbsp;place&nbsp;to&nbsp;deal&nbsp;with&nbsp;temporarily&lt;br&gt;<br>
backlogged/slow&nbsp;consumers.&nbsp;By&nbsp;contrast,&nbsp;with&nbsp;&amp;#39;immediate&amp;#39;&nbsp;the&nbsp;messages&lt;br&gt;<br>
will&nbsp;get&nbsp;dropped&nbsp;when&nbsp;the&nbsp;consumers&nbsp;are&nbsp;busy&nbsp;(not&nbsp;just&nbsp;when&nbsp;they&nbsp;are&nbsp;not&lt;br&gt;<br>
present).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
