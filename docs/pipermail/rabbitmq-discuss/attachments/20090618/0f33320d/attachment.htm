<tt>
Hey&nbsp;guys,&nbsp;I&amp;#39;m&nbsp;new&nbsp;to&nbsp;RabbitMQ&nbsp;and&nbsp;am&nbsp;having&nbsp;trouble&nbsp;finding&nbsp;the&nbsp;answer&nbsp;to&nbsp;this&nbsp;question&nbsp;on&nbsp;Google,&nbsp;so&nbsp;please&nbsp;forgive&nbsp;me&nbsp;if&nbsp;this&nbsp;is&nbsp;old&nbsp;hat.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;setup&nbsp;a&nbsp;request/response&nbsp;queue&nbsp;with&nbsp;a&nbsp;TTL&nbsp;on&nbsp;the&nbsp;request&nbsp;messages.&nbsp; My&nbsp;client&nbsp;is&nbsp;only&nbsp;going&nbsp;wait&nbsp;500ms&nbsp;for&nbsp;a&nbsp;response.&nbsp; If&nbsp;the&nbsp;client&nbsp;does&nbsp;not&nbsp;get&nbsp;a&nbsp;response&nbsp;in&nbsp;500ms&nbsp;it&amp;#39;s&nbsp;going&nbsp;to&nbsp;bail.&nbsp; Because&nbsp;of&nbsp;this,&nbsp;there&amp;#39;s&nbsp;no&nbsp;reason&nbsp;for&nbsp;the&nbsp;server&nbsp;to&nbsp;handle&nbsp;messages&nbsp;that&nbsp;have&nbsp;been&nbsp;in&nbsp;the&nbsp;queue&nbsp;for&nbsp;longer&nbsp;than&nbsp;500ms.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;ve&nbsp;setup&nbsp;a&nbsp;simple&nbsp;test&nbsp;case&nbsp;using&nbsp;SimpleRpcClient&nbsp;and&nbsp;SimpleRpcServer.&nbsp; Everything&nbsp;works&nbsp;except&nbsp;message&nbsp;expiration.&nbsp; All&nbsp;requests&nbsp;sent&nbsp;to&nbsp;the&nbsp;queue&nbsp;are&nbsp;processed&nbsp;by&nbsp;the&nbsp;server&nbsp;code,&nbsp;regardless&nbsp;of&nbsp;how&nbsp;long&nbsp;they&nbsp;sat&nbsp;in&nbsp;the&nbsp;queue.&nbsp; I&nbsp;could,&nbsp;of&nbsp;course,&nbsp;add&nbsp;a&nbsp;timestamp&nbsp;to&nbsp;my&nbsp;message&nbsp;and&nbsp;handle&nbsp;filter&nbsp;them&nbsp;manually,&nbsp;but&nbsp;I&nbsp;was&nbsp;hoping&nbsp;the&nbsp;RabbitMQ&nbsp;infrastructure&nbsp;could&nbsp;do&nbsp;this&nbsp;for&nbsp;me.&nbsp; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&amp;#39;s&nbsp;the&nbsp;client&nbsp;code&nbsp;(C#):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;var&nbsp;connectionFactory&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;using&nbsp;(var&nbsp;connection&nbsp;=&nbsp;connectionFactory.CreateConnection(&amp;quot;127.0.0.1&amp;quot;))&lt;/div&gt;<br>
&lt;div&gt;using&nbsp;(var&nbsp;model&nbsp;=&nbsp;connection.CreateModel())&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;model.ExchangeDeclare(&amp;quot;TestExchange&amp;quot;,&nbsp;ExchangeType.Direct);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;model.QueueDeclare(&amp;quot;TestQueue&amp;quot;);&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;model.QueueBind(&amp;quot;TestQueue&amp;quot;,&nbsp;&amp;quot;TestExchange&amp;quot;,&nbsp;&amp;quot;TestRoute&amp;quot;,&nbsp;false,&nbsp;null);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;var&nbsp;client&nbsp;=&nbsp;new&nbsp;SimpleRpcClient(model,&nbsp;&amp;quot;TestExchange&amp;quot;,&nbsp;&amp;quot;TestQueue&amp;quot;,&nbsp;&amp;quot;TestRoute&amp;quot;);&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;client.TimeoutMilliseconds&nbsp;=&nbsp;500;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;var&nbsp;request&nbsp;=&nbsp;Guid.NewGuid().ToString(&amp;quot;N&amp;quot;);&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;var&nbsp;requestData&nbsp;=&nbsp;Encoding.UTF32.GetBytes(request);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;var&nbsp;requestProperties&nbsp;=&nbsp;model.CreateBasicProperties();&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;requestProperties.Expiration&nbsp;=&nbsp;&amp;quot;1000&amp;quot;;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;var&nbsp;responseData&nbsp;=&nbsp;client.Call(requestProperties,&nbsp;requestData);&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;if&nbsp;(responseData&nbsp;==&nbsp;null)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;Console.Out.WriteLine(&amp;quot;{0}:&nbsp;Timed&nbsp;Out&amp;quot;,&nbsp;request);&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;else&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;Console.Out.WriteLine(&amp;quot;{0}:&nbsp;{1}&amp;quot;,&nbsp;request,&nbsp;Encoding.UTF32.GetString(responseData.Body));&lt;/div&gt;<br>
&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Bryan&lt;/div&gt;&lt;/div&gt;<br>

</tt>
