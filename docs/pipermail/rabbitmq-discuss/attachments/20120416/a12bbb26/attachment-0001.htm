<tt>
It&amp;#39;s&nbsp;probably&nbsp;the&nbsp;backslashes&nbsp;in&nbsp;the&nbsp;headers&nbsp;that&nbsp;you&amp;#39;re&nbsp;sending.&nbsp;Because&nbsp;STOMP&amp;#39;s&nbsp;syntax&nbsp;forbids&nbsp;linefeeds&nbsp;and&nbsp;colons&nbsp;not&nbsp;only&nbsp;in&nbsp;header&nbsp;names&nbsp;but&nbsp;also&nbsp;in&nbsp;header&nbsp;values&nbsp;(!!),&nbsp;RabbitMQ&amp;#39;s&nbsp;STOMP&nbsp;codec&nbsp;uses&nbsp;backslash&nbsp;escaping&nbsp;(for&nbsp;the&nbsp;values&nbsp;only,&nbsp;I&nbsp;note),&nbsp;which&nbsp;isn&amp;#39;t&nbsp;part&nbsp;of&nbsp;the&nbsp;specification.&lt;br&gt;<br>
&lt;br&gt;Even&nbsp;though&nbsp;you&amp;#39;re&nbsp;not&nbsp;sending&nbsp;colons&nbsp;in&nbsp;header&nbsp;values,&nbsp;you&amp;#39;re&nbsp;being&nbsp;affected&nbsp;by&nbsp;the&nbsp;escaping.&nbsp;STOMP&amp;#39;s&nbsp;syntax&nbsp;plus&nbsp;RabbitMQ&amp;#39;s&nbsp;ad-hoc&nbsp;escaping&nbsp;then&nbsp;are&nbsp;two&nbsp;wrongs&nbsp;that&nbsp;definitely&nbsp;don&amp;#39;t&nbsp;make&nbsp;a&nbsp;right&nbsp;:-(&lt;br&gt;<br>
&lt;br&gt;STOMP&amp;#39;s&nbsp;syntax,&nbsp;terrible&nbsp;though&nbsp;it&nbsp;is,&nbsp;is&nbsp;set&nbsp;in&nbsp;stone,&nbsp;so&nbsp;I&nbsp;guess&nbsp;the&nbsp;only&nbsp;hope&nbsp;left&nbsp;is&nbsp;some&nbsp;tweak&nbsp;to&nbsp;or&nbsp;removal&nbsp;of&nbsp;the&nbsp;backslash&nbsp;escaping&nbsp;mechanism&nbsp;in&nbsp;the&nbsp;RabbitMQ&nbsp;codec.&nbsp;I&amp;#39;m&nbsp;at&nbsp;a&nbsp;loss&nbsp;as&nbsp;to&nbsp;what&nbsp;the&nbsp;right&nbsp;thing&nbsp;to&nbsp;do&nbsp;here&nbsp;is.&nbsp;(Besides&nbsp;fix&nbsp;STOMP,&nbsp;obviously.)&lt;br&gt;<br>
&lt;br&gt;One&nbsp;option&nbsp;would&nbsp;be&nbsp;to&nbsp;do&nbsp;no&nbsp;escaping,&nbsp;but&nbsp;if&nbsp;a&nbsp;header&nbsp;is&nbsp;about&nbsp;to&nbsp;be&nbsp;encoded&nbsp;using&nbsp;some&nbsp;illegal&nbsp;character&nbsp;(i.e.&nbsp;LF&nbsp;or&nbsp;colon),&nbsp;encode&nbsp;it&nbsp;using&nbsp;some&nbsp;totally&nbsp;nonstandard&nbsp;but&nbsp;also&nbsp;totally&nbsp;unambiguous&nbsp;format&nbsp;such&nbsp;as&nbsp;a&nbsp;colon&nbsp;in&nbsp;the&nbsp;first&nbsp;column&nbsp;of&nbsp;the&nbsp;line&nbsp;followed&nbsp;by&nbsp;two&nbsp;netstrings?&nbsp;It&amp;#39;d&nbsp;completely&nbsp;crash&nbsp;any&nbsp;parser&nbsp;that&nbsp;wasn&amp;#39;t&nbsp;looking&nbsp;out&nbsp;for&nbsp;it,&nbsp;because&nbsp;it&amp;#39;s&nbsp;illegal&nbsp;syntax,&nbsp;but&nbsp;then&nbsp;so&nbsp;is&nbsp;including&nbsp;an&nbsp;unescaped&nbsp;colon&nbsp;or&nbsp;LF&nbsp;in&nbsp;the&nbsp;first&nbsp;place,&nbsp;so&nbsp;we&amp;#39;re&nbsp;already&nbsp;into&nbsp;uncharted&nbsp;territory.&lt;br&gt;<br>
&lt;br&gt;:4:what,17:a&nbsp;terrible&nbsp;design,&lt;br&gt;&lt;br&gt;A&nbsp;middle&nbsp;ground&nbsp;would&nbsp;be&nbsp;to&nbsp;forbid&nbsp;sending&nbsp;colons&nbsp;in&nbsp;header&nbsp;*names*&nbsp;but&nbsp;silently&nbsp;pass&nbsp;them&nbsp;on&nbsp;in&nbsp;header&nbsp;*values*&nbsp;(they&amp;#39;re&nbsp;harmless,&nbsp;and&nbsp;it&amp;#39;s&nbsp;a&nbsp;silly&nbsp;restriction),&nbsp;and&nbsp;if&nbsp;a&nbsp;LF&nbsp;were&nbsp;seen,&nbsp;to&nbsp;encode&nbsp;it&nbsp;as&nbsp;LF-colon.&nbsp;A&nbsp;naive&nbsp;parser&nbsp;then&nbsp;would&nbsp;see&nbsp;a&nbsp;pseudo-header&nbsp;with&nbsp;an&nbsp;empty&nbsp;name;&nbsp;parsers&nbsp;expecting&nbsp;this&nbsp;convention&nbsp;would&nbsp;understand&nbsp;it&nbsp;to&nbsp;be&nbsp;a&nbsp;header&nbsp;value&nbsp;continuation&nbsp;from&nbsp;the&nbsp;previous&nbsp;line.&lt;br&gt;<br>
&lt;br&gt;Any&nbsp;way&nbsp;you&nbsp;slice&nbsp;it,&nbsp;though:&nbsp;yuck.&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Â &nbsp;Tony&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;16&nbsp;April&nbsp;2012&nbsp;09:42,&nbsp;Lionel&nbsp;Cons&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:lionel.cons@cern.ch&quot;&gt;lionel.cons@cern.ch&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;It&nbsp;seems&nbsp;I&nbsp;cannot&nbsp;send&nbsp;_some_&nbsp;messages&nbsp;using&nbsp;STOMP.&nbsp;After&nbsp;investigation,&lt;br&gt;<br>
this&nbsp;seems&nbsp;to&nbsp;come&nbsp;from&nbsp;the&nbsp;presence&nbsp;of&nbsp;&amp;quot;exotic&amp;quot;&nbsp;characters&nbsp;in&nbsp;the&nbsp;header.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;managed&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;problem&nbsp;with&nbsp;netcat&nbsp;and&nbsp;the&nbsp;attached&nbsp;file.&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;I&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;file&nbsp;to&nbsp;send&nbsp;the&nbsp;message,&nbsp;I&nbsp;get&nbsp;nothing&nbsp;back:&lt;br&gt;<br>
&lt;br&gt;<br>
$&nbsp;(cat&nbsp;frame;&nbsp;sleep&nbsp;1)&nbsp;|&nbsp;nc&nbsp;broker&nbsp;6123&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;I&nbsp;remove&nbsp;the&nbsp;two&nbsp;header&nbsp;lines&nbsp;starting&nbsp;with&nbsp;rnd-,&nbsp;it&nbsp;does&nbsp;work&nbsp;as&lt;br&gt;<br>
expected:&lt;br&gt;<br>
&lt;br&gt;<br>
$&nbsp;(cat&nbsp;frame.clean;&nbsp;sleep&nbsp;1)&nbsp;|&nbsp;nc&nbsp;broker&nbsp;6123&lt;br&gt;<br>
CONNECTED&lt;br&gt;<br>
session:session-wUaTaF5qzu7nKZ4TmuaWFM&lt;br&gt;<br>
heart-beat:0,0&lt;br&gt;<br>
server:RabbitMQ/2.8.0&lt;br&gt;<br>
version:1.0&lt;br&gt;<br>
&lt;br&gt;<br>
RECEIPT&lt;br&gt;<br>
receipt-id:abc&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;it&nbsp;seems&nbsp;that&nbsp;RabbitMQ&nbsp;does&nbsp;not&nbsp;like&nbsp;these&nbsp;header&nbsp;lines...&nbsp;Any&nbsp;idea&nbsp;on&lt;br&gt;<br>
what&nbsp;is&nbsp;happening?&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
&lt;br&gt;<br>
Lionel&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Tony&nbsp;Garnock-Jones&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:tonygarnockjones@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;tonygarnockjones@gmail.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://homepages.kcbbs.gen.nz/tonyg/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://homepages.kcbbs.gen.nz/tonyg/&lt;/a&gt;&lt;br&gt;<br>
<br>

</tt>
