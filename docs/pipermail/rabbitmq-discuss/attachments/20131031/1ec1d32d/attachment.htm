<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;changed&nbsp;overcommit_memory&nbsp;from&nbsp;2&nbsp;to&nbsp;0,&nbsp;and&nbsp;RabbitMQ&nbsp;stays&nbsp;up&nbsp;for&nbsp;more&nbsp;than&nbsp;15&nbsp;seconds&nbsp;now.&nbsp;That&nbsp;seems&nbsp;to&nbsp;have&nbsp;been&nbsp;my&nbsp;error.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;br&gt;François&lt;br&gt;&lt;br&gt;On&nbsp;Tuesday,&nbsp;October&nbsp;29,&nbsp;2013&nbsp;5:10:13&nbsp;PM&nbsp;UTC-4,&nbsp;François&nbsp;Beausoleil&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0;margin-left:&nbsp;0.8ex;border-left:&nbsp;1px&nbsp;#ccc&nbsp;solid;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;all!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;bare&nbsp;metal&nbsp;server&nbsp;with&nbsp;32&nbsp;GiB&nbsp;of&nbsp;RAM.&nbsp;I&nbsp;installed&nbsp;RabbitMQ&nbsp;3.2.0,&nbsp;Erlang&nbsp;R16B02.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;load&nbsp;increases&nbsp;(publishing&nbsp;over&nbsp;4000&nbsp;msgs/s),&nbsp;RabbitMQ&nbsp;dies&nbsp;with&nbsp;&quot;Could&nbsp;not&nbsp;allocate&nbsp;memory&quot;&nbsp;errors:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Crash&nbsp;dump&nbsp;was&nbsp;written&nbsp;to:&nbsp;erl_crash.dump&lt;/div&gt;&lt;div&gt;eheap_alloc:&nbsp;Cannot&nbsp;allocate&nbsp;529782288&nbsp;bytes&nbsp;of&nbsp;memory&nbsp;(of&nbsp;type&nbsp;&quot;heap&quot;).&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;messages&nbsp;which&nbsp;are&nbsp;published&nbsp;are&nbsp;about&nbsp;4&nbsp;KiB&nbsp;of&nbsp;XML.&nbsp;The&nbsp;persistent&nbsp;option&nbsp;is&nbsp;set&nbsp;to&nbsp;true,&nbsp;to&nbsp;ensure&nbsp;persistence&nbsp;across&nbsp;reboots.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;host&nbsp;has&nbsp;configuration&nbsp;for&nbsp;overcommit:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;cat&nbsp;/proc/sys/vm/overcommit_ratio&lt;/div&gt;&lt;div&gt;50&lt;/div&gt;&lt;div&gt;#&nbsp;cat&nbsp;/proc/sys/vm/overcommit_memory&lt;/div&gt;&lt;div&gt;2&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;start,&nbsp;RabbitMQ&nbsp;correctly&nbsp;identifies&nbsp;the&nbsp;total&nbsp;amount&nbsp;of&nbsp;memory:&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;29-Oct-2013::20:58:03&nbsp;===&lt;/div&gt;&lt;div&gt;node&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;:&nbsp;rabbit@skyler&lt;/div&gt;&lt;div&gt;home&nbsp;dir&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;:&nbsp;/var/lib/rabbitmq&lt;/div&gt;&lt;div&gt;config&nbsp;file(s)&nbsp;:&nbsp;(none)&lt;/div&gt;&lt;div&gt;cookie&nbsp;hash&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;:&nbsp;mV5+4OI0hTEXkDPMtOzVdQ==&lt;/div&gt;&lt;div&gt;log&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;:&nbsp;/var/log/rabbitmq/rabbit@&lt;wbr&gt;skyler.log&lt;/div&gt;&lt;div&gt;sasl&nbsp;log&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;:&nbsp;/var/log/rabbitmq/rabbit@&lt;wbr&gt;skyler-sasl.log&lt;/div&gt;&lt;div&gt;database&nbsp;dir&nbsp;&amp;nbsp;&nbsp;:&nbsp;/var/lib/rabbitmq/mnesia/&lt;wbr&gt;rabbit@skyler&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;29-Oct-2013::20:58:04&nbsp;===&lt;/div&gt;&lt;div&gt;Limiting&nbsp;to&nbsp;approx&nbsp;3996&nbsp;file&nbsp;handles&nbsp;(3594&nbsp;sockets)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;29-Oct-2013::20:58:04&nbsp;===&lt;/div&gt;&lt;div&gt;Memory&nbsp;limit&nbsp;set&nbsp;to&nbsp;12826MB&nbsp;of&nbsp;32066MB&nbsp;total.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;=INFO&nbsp;REPORT====&nbsp;29-Oct-2013::20:58:04&nbsp;===&lt;/div&gt;&lt;div&gt;Disk&nbsp;free&nbsp;limit&nbsp;set&nbsp;to&nbsp;50MB&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;the&nbsp;same&nbsp;host,&nbsp;I'm&nbsp;also&nbsp;running&nbsp;a&nbsp;Java&nbsp;application.&nbsp;The&nbsp;Java&nbsp;application's&nbsp;max&nbsp;heap&nbsp;is&nbsp;set&nbsp;to&nbsp;6&nbsp;GiB,&nbsp;through&nbsp;-Xmx6g.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Google&nbsp;and&nbsp;StackOverflow&nbsp;aren't&nbsp;very&nbsp;helpful:&nbsp;there&nbsp;are&nbsp;a&nbsp;few&nbsp;mentions,&nbsp;but&nbsp;not&nbsp;many&nbsp;apply&nbsp;to&nbsp;RabbitMQ,&nbsp;and&nbsp;the&nbsp;other&nbsp;ones&nbsp;don't&nbsp;seem&nbsp;to&nbsp;apply&nbsp;or&nbsp;are&nbsp;very&nbsp;old.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;What&nbsp;can&nbsp;I&nbsp;do&nbsp;to&nbsp;troubleshoot&nbsp;the&nbsp;problem?&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;br&gt;François&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;
</tt>
