<tt>
Hi,&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;using&nbsp;the&nbsp;rabbitmq-c&nbsp;C&nbsp;libraries&nbsp;to&nbsp;publish&nbsp;messages&nbsp;to&nbsp;a&nbsp;Rabbitmq&nbsp;exchange.&lt;br&gt;&lt;br&gt;Problem&nbsp;I&nbsp;have&nbsp;is&nbsp;that&nbsp;when&nbsp;rabbitmq&nbsp;server&nbsp;stops&nbsp;for&nbsp;some&nbsp;reason&nbsp;(rabbtmqctl&nbsp;stop_app&nbsp;/&nbsp;start_app&nbsp;for&nbsp;instance),&nbsp;the&nbsp;socket&nbsp;between&nbsp;my&nbsp;publisher&nbsp;program&nbsp;and&nbsp;rabbitmq&nbsp;is&nbsp;destroyed&nbsp;but&nbsp;I&nbsp;don&amp;#39;t&nbsp;manage&nbsp;to&nbsp;catch&nbsp;any&nbsp;error&nbsp;code&nbsp;properly&nbsp;so&nbsp;that&nbsp;the&nbsp;program&nbsp;can&nbsp;try&nbsp;to&nbsp;establish&nbsp;a&nbsp;new&nbsp;connection.&lt;br&gt;<br>
&lt;br&gt;When&nbsp;I&nbsp;stop&nbsp;rabbitmq,&nbsp;my&nbsp;publisher&nbsp;program&nbsp;exits&nbsp;with&nbsp;the&nbsp;message:&nbsp;&amp;quot;Broken&nbsp;Pipe&amp;quot;&nbsp;when&nbsp;it&nbsp;tries&nbsp;to&nbsp;send&nbsp;a&nbsp;message.&lt;br&gt;&lt;br&gt;Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;check&nbsp;the&nbsp;socket&nbsp;before&nbsp;sending&nbsp;a&nbsp;message&nbsp;so&nbsp;that&nbsp;I&nbsp;can&nbsp;try&nbsp;to&nbsp;re-establish&nbsp;a&nbsp;connection&nbsp;?&lt;br&gt;<br>
&lt;br&gt;The&nbsp;way&nbsp;I&nbsp;publish&nbsp;is&nbsp;:&lt;br&gt;&lt;br&gt;rc&nbsp;=&nbsp;amqp_basic_publish(amqp_connection,&nbsp;1, &nbsp;amqp_cstring_bytes(&amp;quot;Exchange&amp;quot;),&nbsp;amqp_cstring_bytes(routingkey),&nbsp;0,&nbsp;0,&nbsp;NULL,&nbsp;body);&lt;br&gt;&lt;br&gt;if&nbsp;(rc&nbsp;&amp;lt;&nbsp;0) &nbsp;{&lt;br&gt;   &nbsp;printf(&amp;quot;error&nbsp;during&nbsp;publish&nbsp;:&nbsp;%s\n&amp;quot;,&nbsp;strerror(-rc))&nbsp;;&lt;br&gt;<br>
 }&lt;br&gt;&lt;br&gt;problem&nbsp;is&nbsp;that&nbsp;if&nbsp;rabbitmq&nbsp;is&nbsp;stopped, &nbsp;the&nbsp;line&nbsp;&amp;quot;rc&nbsp;=&nbsp;amqp_basic_publish&nbsp;...make&nbsp;the&nbsp;program&nbsp;exit,&nbsp;I&nbsp;cannot&nbsp;get&nbsp;the&nbsp;rc&nbsp;value).&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;Regards,&lt;br&gt;&lt;br&gt;Fab&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
