<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:#000;&nbsp;background-color:#fff;&nbsp;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;I'm&nbsp;writing&nbsp;RabbitMQ&nbsp;C-client&nbsp;code.&amp;nbsp;After&nbsp;I&amp;nbsp;turn&nbsp;on&nbsp;the&nbsp;heartbeat&nbsp;option&amp;nbsp;with&nbsp;the&nbsp;&quot;heartbeat&quot;&nbsp;parameter&nbsp;in&nbsp;amqp_login()&nbsp;function&amp;nbsp;-&nbsp;i.e.,&nbsp;passing&nbsp;a&nbsp;value&nbsp;10&nbsp;(seconds)&nbsp;instead&nbsp;of&nbsp;0&nbsp;when&nbsp;calling&nbsp;amqp_login()&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;amqp_rpc_reply_t&nbsp;amqp_login&nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;(&nbsp;amqp_connection_state_t&nbsp;state,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;char&nbsp;const&nbsp;*vhost,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;channel_max,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;uint32_t&nbsp;frame_max,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;heartbeat,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;amqp_sasl_method_enum&nbsp;sasl_method,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;...&nbsp;)&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;My&nbsp;C-client&amp;nbsp;can&nbsp;start&nbsp;to&nbsp;receive&nbsp;heartbeat&nbsp;message&nbsp;(the&nbsp;message&nbsp;has&amp;nbsp;frame_type&nbsp;&quot;AMQP_FRAME_HEARTBEAT&quot;).&nbsp;However,&nbsp;after&nbsp;getting&nbsp;the&nbsp;heartbeat&nbsp;messages&nbsp;for&nbsp;two&nbsp;times,&nbsp;the&nbsp;connection&nbsp;and&nbsp;channels&nbsp;opened&nbsp;by&nbsp;my&nbsp;client&nbsp;have&nbsp;been&amp;nbsp;abruptly&nbsp;closed&nbsp;by&nbsp;the&nbsp;server.&nbsp;From&nbsp;what&nbsp;I&nbsp;read&nbsp;in&nbsp;the&nbsp;past&nbsp;articals,&nbsp;if&nbsp;the&nbsp;client&nbsp;sends&nbsp;any&nbsp;kind&nbsp;of&nbsp;message&nbsp;to&nbsp;server&nbsp;before&nbsp;the&nbsp;timeout,&nbsp;the&nbsp;connection&nbsp;shouldn't&nbsp;be&nbsp;closed.&nbsp;However,&nbsp;this&amp;nbsp;is&nbsp;not&nbsp;the&nbsp;case&amp;nbsp;for&nbsp;me&nbsp;-&nbsp;I've&nbsp;tried&nbsp;to&amp;nbsp;respond&nbsp;with&amp;nbsp;either&nbsp;normal&nbsp;messages&nbsp;(via&nbsp;normal&nbsp;channel),&nbsp;or&nbsp;frames&nbsp;with&nbsp;frame&nbsp;type&nbsp;AMQP_&lt;VAR&nbsp;id=yui-ie-cursor&gt;&lt;/VAR&gt;FRAME_HEARTBEAT&amp;nbsp;(via&nbsp;channel&nbsp;0)&amp;nbsp;right&nbsp;after&amp;nbsp;the&nbsp;client&amp;nbsp;received&nbsp;the&nbsp;heartbead&nbsp;message,&nbsp;but&nbsp;the&amp;nbsp;connection&nbsp;is&nbsp;still&amp;nbsp;closed&nbsp;by&nbsp;the&nbsp;server&nbsp;regardless.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;Is&amp;nbsp;it&nbsp;because&nbsp;the&nbsp;heartbeat&amp;nbsp;functionality&nbsp;has&nbsp;not&nbsp;been&amp;nbsp;fully&nbsp;implemented&nbsp;yet?&nbsp;Or&nbsp;is&nbsp;there&nbsp;any&nbsp;special&nbsp;kind&nbsp;of&nbsp;message&nbsp;that&nbsp;should&nbsp;be&nbsp;send&nbsp;as&nbsp;response&nbsp;message&nbsp;to&nbsp;the&nbsp;heartbeat&nbsp;message?&nbsp;If&amp;nbsp;it's&nbsp;the&nbsp;second&nbsp;case,&nbsp;can&nbsp;you&nbsp;provide&nbsp;sample&nbsp;code&amp;nbsp;for&nbsp;reponse&nbsp;message?&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;Thanks&amp;nbsp;a&nbsp;lot,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;RIGHT:&nbsp;auto&quot;&gt;Dawn&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
