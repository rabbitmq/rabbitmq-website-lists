<tt>
For&nbsp;the&nbsp;sake&nbsp;of&nbsp;anyone&nbsp;who&nbsp;tried&nbsp;this&nbsp;script,&nbsp;I&nbsp;realised&nbsp;I&nbsp;fluffed&nbsp;the&nbsp;logic..&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMFREEEQN=&amp;quot;`egrep&nbsp;&amp;quot;^(MemTotal|MemFree|Buffers|Cached):&amp;quot;&nbsp;/proc/meminfo&nbsp;|\&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;awk&nbsp;&amp;#39;{print&nbsp;$1&nbsp;&amp;quot;&nbsp;&amp;quot;&nbsp;$2}&amp;#39;&nbsp;|\&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;sed&nbsp;-r&nbsp;&amp;#39;s/^MemTotal:/+/g&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
<br>
<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;               &nbsp;s/^(MemFree|Buffers|Cached):/-/g&amp;#39;`&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMFREE=&amp;quot;$((&nbsp;${MEMFREEEQN}&nbsp;))&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
<br>
<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMPCFREE=&amp;quot;$((&nbsp;(&nbsp;${MEMFREE}&nbsp;*&nbsp;100&nbsp;)&nbsp;/&nbsp;${MEMTOTAL}&nbsp;))&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;This&nbsp;should&nbsp;do&nbsp;the&nbsp;trick&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;STATE_OK=0&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;STATE_WARNING=1&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;STATE_CRITICAL=2&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;STATE_UNKNOWN=3&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;STATE_DEPENDENT=4&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMTOTAL=&amp;quot;`grep&nbsp;&amp;quot;^MemTotal:&nbsp;&amp;quot;&nbsp;/proc/meminfo&nbsp;|\&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;awk&nbsp;&amp;#39;{print&nbsp;$2}&amp;#39;`&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMUSEDEQN=&amp;quot;`egrep&nbsp;&amp;quot;^(MemTotal|MemFree|Buffers|Cached):&amp;quot;&nbsp;/proc/meminfo&nbsp;|\&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;awk&nbsp;&amp;#39;{print&nbsp;$1&nbsp;&amp;quot;&nbsp;&amp;quot;&nbsp;$2}&amp;#39;&nbsp;|\&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;sed&nbsp;-r&nbsp;&amp;#39;s/^MemTotal:/+/g&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;               &nbsp;s/^(MemFree|Buffers|Cached):/-/g&amp;#39;`&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMUSED=&amp;quot;$((&nbsp;${MEMUSEDEQN}&nbsp;))&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMPCUSED=&amp;quot;$((&nbsp;(&nbsp;${MEMUSED}&nbsp;*&nbsp;100&nbsp;)&nbsp;/&nbsp;${MEMTOTAL}&nbsp;))&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMPCFREE=&amp;quot;$((&nbsp;100&nbsp;-&nbsp;${MEMPCUSED}&nbsp;))&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMPCFREECRIT=5&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;MEMPCFREEWARN=10&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;if&nbsp;[&nbsp;${MEMPCFREE}&nbsp;-gt&nbsp;${MEMPCFREEWARN}&nbsp;];&nbsp;then&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;echo&nbsp;&amp;quot;OK:&nbsp;${MEMUSED}&nbsp;(${MEMPCUSED}%)&nbsp;used,&nbsp;${MEMPCFREE}%&nbsp;free&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;exit&nbsp;$STATE_OK&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;elif&nbsp;[&nbsp;${MEMPCFREE}&nbsp;-gt&nbsp;${MEMPCFREECRIT}&nbsp;];&nbsp;then&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;echo&nbsp;&amp;quot;WARNING:&nbsp;${MEMUSED}&nbsp;(${MEMPCUSED}%)&nbsp;used,&nbsp;${MEMPCFREE}%&nbsp;free&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;exit&nbsp;$STATE_WARNING&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;elif&nbsp;[&nbsp;${MEMPCFREE}&nbsp;-le&nbsp;${MEMPCFREECRIT}&nbsp;];&nbsp;then&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;echo&nbsp;&amp;quot;CRITICAL:&nbsp;${MEMUSED}&nbsp;(${MEMPCUSED}%)&nbsp;used,&nbsp;${MEMPCFREE}%&nbsp;free&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;       &nbsp;exit&nbsp;$STATE_CRITICAL&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;fi&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;echo&nbsp;&amp;quot;UNKNOWN:&nbsp;Something&nbsp;went&nbsp;awry!&amp;quot;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;exit&nbsp;$STATE_UNKNOWN&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/font&gt;&lt;br&gt;<br>

</tt>
