<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;implement&nbsp;a&nbsp;priority&nbsp;queue&nbsp;over&nbsp;Rabbit&nbsp;with&nbsp;python,&nbsp;and&nbsp;this&nbsp;is&nbsp;my&nbsp;idea&lt;/div&gt;&lt;div&gt;each&nbsp;batch&nbsp;of&nbsp;tasks&nbsp;has&nbsp;its&nbsp;own&nbsp;queue,&nbsp;each&nbsp;worker&nbsp;knows&nbsp;about&nbsp;all&nbsp;the&nbsp;batches&nbsp;and&nbsp;their&nbsp;priorities.&lt;/div&gt;<br>
&lt;div&gt;now&nbsp;the&nbsp;part&nbsp;where&nbsp;I&nbsp;don&amp;#39;t&nbsp;understand:&lt;/div&gt;&lt;div&gt;  how&nbsp;does&nbsp;a&nbsp;worker&nbsp;tries&nbsp;a&nbsp;take&nbsp;a&nbsp;task&nbsp;from&nbsp;a&nbsp;batch(queue)&nbsp; but&nbsp;if&nbsp;its&nbsp;empty&nbsp;it&nbsp;passes&nbsp;to&nbsp;the&nbsp;next&nbsp;batch?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;need&nbsp;somthing&nbsp;like:&lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;for&nbsp;q&nbsp;in&nbsp;queuesSortedByPriority:&lt;/div&gt;&lt;div&gt;  t&nbsp;=&nbsp;q.get()&lt;/div&gt;&lt;div&gt;  if&nbsp;t:&nbsp;break&lt;/div&gt;&lt;div&gt;else:&nbsp;raise&nbsp;NoTaskFound()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Many&nbsp;thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Yoav&nbsp;Glazner.&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
