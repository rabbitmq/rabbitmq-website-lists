<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi, &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;my&nbsp;company&nbsp;we&nbsp;are&nbsp;running&nbsp;rabbitmq&nbsp;1.7.0&nbsp;over&nbsp;windows.&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;trying&nbsp;now&nbsp;to&nbsp;upgrade&nbsp;the&nbsp;rabbitmq&nbsp;to&nbsp;the&nbsp;current&nbsp;2.3.1&nbsp;version&nbsp;and&nbsp;encountered&nbsp;a&nbsp;problem.&lt;/div&gt;&lt;div&gt;<br>
Generally,&nbsp;after&nbsp;upgrade&nbsp;and&nbsp;no&nbsp;code&nbsp;change&nbsp;in&nbsp;the&nbsp;application&nbsp;side&nbsp;I&nbsp;am&nbsp;getting&nbsp;the&nbsp;following&nbsp;exception &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;reply-code=406,reply-text=PRECONDITION_FAILED&nbsp;-&nbsp;unknown&nbsp;delivery&nbsp;tag&nbsp;1,class-id=60,method-id=80),null,&amp;quot;&amp;quot;}&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;First,&nbsp;I&nbsp;will&nbsp;Explain&nbsp;how&nbsp;my&nbsp;system&nbsp;works&nbsp;and&nbsp;then&nbsp;my&nbsp;exception.&lt;/div&gt;&lt;div&gt;when&nbsp;App&nbsp;A&nbsp;wants&nbsp;to&nbsp;send&nbsp;an&nbsp;async&nbsp;message&nbsp;to&nbsp;App&nbsp;B&nbsp;and&nbsp;receive&nbsp;an&nbsp;answer,&nbsp;this&nbsp;is&nbsp;the&nbsp;algorythm: &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.&nbsp;App&nbsp;A&nbsp;generate&nbsp;a&nbsp;unique&nbsp;ID&nbsp;and&nbsp;puts&nbsp;it&nbsp;in&nbsp;the&nbsp;message&nbsp;object&lt;/div&gt;<br>
&lt;div&gt;2.&nbsp;Then&nbsp;App&nbsp;A&nbsp;subscribes&nbsp;to&nbsp;a&nbsp;new&nbsp;Queue&nbsp;with&nbsp;both&nbsp;the&nbsp;queue&nbsp;name&nbsp;and&nbsp;routing&nbsp;key&nbsp;equals&nbsp;to&nbsp;the&nbsp;new&nbsp;uuid.&lt;/div&gt;&lt;div&gt;3.&nbsp;App&nbsp;B&nbsp;open&nbsp;the&nbsp;message,&nbsp;do&nbsp;some&nbsp;calculations&nbsp;and&nbsp;return&nbsp;the&nbsp;result&nbsp;to&nbsp;the&nbsp;channel&nbsp;with&nbsp;the&nbsp;routingkey&nbsp;that&nbsp;it received.&lt;/div&gt;<br>
&lt;div&gt;4.&nbsp;App&nbsp;A&nbsp;gets&nbsp;the&nbsp;answer&nbsp;and&nbsp;close&nbsp;the&nbsp;queue.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;far&nbsp;everything&nbsp;went&nbsp;really&nbsp;well&nbsp;in&nbsp;1.7.0.&nbsp;what&nbsp;went&nbsp;wrong&nbsp;in&nbsp;2.3.1? &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;Application&nbsp;A&nbsp;does&nbsp;basicPublish()&nbsp;application&nbsp;B&nbsp;immidiately&nbsp;throws&nbsp;CentralExceptionHandler&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;com.rabbitmq.client.ShutdownSignalException:&nbsp;channel&nbsp;error;&nbsp;reason:&nbsp;{#method&amp;lt;channel.close&amp;gt;(reply-code=406,reply-text=PRECONDITION_FAILED&nbsp;-&nbsp;unknown&nbsp;delivery&nbsp;tag&nbsp;1,class-id=60,method-id=80),null,&amp;quot;&amp;quot;}&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.ChannelN.processAsync(ChannelN.java:191)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel.java:159)&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:110)&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;at&nbsp;com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:438)&lt;/div&gt;<br>
&lt;div&gt;Caused&nbsp;by:&nbsp;com.rabbitmq.client.ShutdownSignalException:&nbsp;channel&nbsp;error;&nbsp;reason:&nbsp;{#method&amp;lt;channel.close&amp;gt;(reply-code=406,reply-text=PRECONDITION_FAILED&nbsp;-&nbsp;unknown&nbsp;delivery&nbsp;tag&nbsp;1,class-id=60,method-id=80),null,&amp;quot;&amp;quot;}&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;one&nbsp;got&nbsp;some&nbsp;idea? &lt;/div&gt;&lt;div&gt;Thanks.&lt;/div&gt;&lt;/div&gt;<br>

</tt>
