<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7652.24&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[rabbitmq-discuss]&nbsp;&nbsp;flow&nbsp;control&nbsp;and&nbsp;erlang&nbsp;client(s)&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Matthias,&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&nbsp;actually&nbsp;suspected&nbsp;that&nbsp;was&nbsp;the&nbsp;case.&nbsp;Would&nbsp;it&nbsp;be&nbsp;expensive&nbsp;then&nbsp;to&nbsp;have&nbsp;the&nbsp;publisher&nbsp;of&nbsp;the&nbsp;message&nbsp;check&nbsp;the&nbsp;number&nbsp;of&nbsp;messages&nbsp;in&nbsp;the&nbsp;queue&nbsp;prior&nbsp;to&nbsp;publishing.&nbsp;The&nbsp;publisher&nbsp;actually&nbsp;binds&nbsp;the&nbsp;queue&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;messages&nbsp;are&nbsp;not&nbsp;dropped&nbsp;when&nbsp;no&nbsp;subscriber&nbsp;has&nbsp;bound&nbsp;the&nbsp;queue&nbsp;yet.&nbsp;This&nbsp;would&nbsp;all&nbsp;be&nbsp;from&nbsp;erlang.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thanks&nbsp;again&nbsp;for&nbsp;the&nbsp;help,&lt;BR&gt;<br>
Mark.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
-----Original&nbsp;Message-----&lt;BR&gt;<br>
From:&nbsp;Matthias&nbsp;Radestock&nbsp;[&lt;A&nbsp;HREF=&quot;mailto:matthias@lshift.net&quot;&gt;mailto:matthias@lshift.net&lt;/A&gt;]&lt;BR&gt;<br>
Sent:&nbsp;Tue&nbsp;6/23/2009&nbsp;8:07&nbsp;PM&lt;BR&gt;<br>
To:&nbsp;Geib,&nbsp;Mark&lt;BR&gt;<br>
Cc:&nbsp;rabbitmq-discuss@lists.rabbitmq.com&lt;BR&gt;<br>
Subject:&nbsp;Re:&nbsp;[rabbitmq-discuss]&amp;nbsp;&nbsp;flow&nbsp;control&nbsp;and&nbsp;erlang&nbsp;client(s)&lt;BR&gt;<br>
&lt;BR&gt;<br>
Mark,&lt;BR&gt;<br>
&lt;BR&gt;<br>
Mark&nbsp;Geib&nbsp;wrote:&lt;BR&gt;<br>
&amp;gt;&nbsp;I&nbsp;have&nbsp;seen&nbsp;in&nbsp;the&nbsp;erlang&nbsp;client&nbsp;test&nbsp;code&nbsp;that&nbsp;#'channel.flow'{active&nbsp;=&lt;BR&gt;<br>
&amp;gt;&nbsp;false}&nbsp;is&nbsp;supported&nbsp;for&nbsp;flow&nbsp;control&nbsp;related&nbsp;to&nbsp;memory&nbsp;high/low&nbsp;water&lt;BR&gt;<br>
&amp;gt;&nbsp;marks.&nbsp;However&nbsp;I&nbsp;need&nbsp;to&nbsp;limit&nbsp;the&nbsp;number&nbsp;of&nbsp;message&nbsp;published&nbsp;to&nbsp;a&lt;BR&gt;<br>
&amp;gt;&nbsp;queue&nbsp;on&nbsp;a&nbsp;broker&nbsp;and&nbsp;need&nbsp;to&nbsp;know&nbsp;if&nbsp;in&nbsp;1.6&nbsp;it&nbsp;is&nbsp;supported&nbsp;and&nbsp;if&nbsp;so&lt;BR&gt;<br>
&amp;gt;&nbsp;how&nbsp;to&nbsp;create&nbsp;the&nbsp;queue&nbsp;for&nbsp;support&nbsp;flow&nbsp;control,&nbsp;that&nbsp;is&nbsp;stopping&lt;BR&gt;<br>
&amp;gt;&nbsp;message&nbsp;publishing&nbsp;until&nbsp;message&nbsp;are&nbsp;dequeued...&lt;BR&gt;<br>
&lt;BR&gt;<br>
What&nbsp;you&nbsp;are&nbsp;asking&nbsp;for&nbsp;is&nbsp;actually&nbsp;conceptually&nbsp;impossible.&lt;BR&gt;<br>
&lt;BR&gt;<br>
In&nbsp;AMQP&nbsp;producers&nbsp;publish&nbsp;messages&nbsp;to&nbsp;an&nbsp;*exchange*&nbsp;(note&nbsp;that&nbsp;they&nbsp;are&lt;BR&gt;<br>
not&nbsp;&amp;quot;connected&amp;quot;&nbsp;to&nbsp;that&nbsp;exchange;&nbsp;each&nbsp;publish&nbsp;command&nbsp;can&nbsp;potentially&lt;BR&gt;<br>
go&nbsp;to&nbsp;a&nbsp;different&nbsp;exchange),&nbsp;which&nbsp;then&nbsp;routes&nbsp;them&nbsp;to&nbsp;*zero&nbsp;or&nbsp;more*&lt;BR&gt;<br>
queues,&nbsp;depending&nbsp;on&nbsp;the&nbsp;type&nbsp;of&nbsp;exchange,&nbsp;routing&nbsp;key&nbsp;in&nbsp;the&nbsp;message,&lt;BR&gt;<br>
and&nbsp;existing&nbsp;bindings&nbsp;between&nbsp;queues&nbsp;and&nbsp;the&nbsp;exchange.&lt;BR&gt;<br>
&lt;BR&gt;<br>
So&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;for&nbsp;the&nbsp;broker&nbsp;to&nbsp;know&nbsp;which&nbsp;of&nbsp;its&nbsp;connected&nbsp;clients&lt;BR&gt;<br>
might&nbsp;next&nbsp;send&nbsp;a&nbsp;message&nbsp;that&nbsp;ends&nbsp;up&nbsp;getting&nbsp;routed&nbsp;to&nbsp;a&nbsp;particular&lt;BR&gt;<br>
queue.&nbsp;Hence&nbsp;it&nbsp;cannot&nbsp;throttle&nbsp;clients&nbsp;based&nbsp;on&nbsp;any&nbsp;queue-based&nbsp;limits.&lt;BR&gt;<br>
&lt;BR&gt;<br>
If&nbsp;there&nbsp;were&nbsp;per-queue&nbsp;message&nbsp;count&nbsp;limits&nbsp;(and&nbsp;this&nbsp;is&nbsp;something&lt;BR&gt;<br>
which&nbsp;has&nbsp;been&nbsp;discussed,&nbsp;though&nbsp;it's&nbsp;not&nbsp;part&nbsp;of&nbsp;the&nbsp;AMQP&nbsp;spec&nbsp;and&nbsp;not&lt;BR&gt;<br>
something&nbsp;RabbitMQ&nbsp;currently&nbsp;implements),&nbsp;the&nbsp;best&nbsp;the&nbsp;broker&nbsp;could&nbsp;do&lt;BR&gt;<br>
is&nbsp;reject,&nbsp;return&nbsp;or&nbsp;discard&nbsp;any&nbsp;messages&nbsp;that&nbsp;arrive&nbsp;after&nbsp;the&nbsp;limit&lt;BR&gt;<br>
has&nbsp;been&nbsp;reached.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
Regards,&lt;BR&gt;<br>
&lt;BR&gt;<br>
Matthias&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
