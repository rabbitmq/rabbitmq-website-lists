<tt>
&lt;html&gt;&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=Windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;I&nbsp;would&nbsp;like&nbsp;to&nbsp;use&nbsp;this&nbsp;feature&nbsp;as&nbsp;documented&nbsp;at&amp;nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/blog/2011/03&quot;&gt;http://www.rabbitmq.com/blog/2011/03&lt;/a&gt;/&nbsp;and&amp;nbsp;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/extensions.html&quot;&gt;http://www.rabbitmq.com/extensions.html&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;I&nbsp;tested&nbsp;both&nbsp;manually&nbsp;using&nbsp;the&nbsp;management&nbsp;console&nbsp;and&nbsp;with&nbsp;a&nbsp;coffeescript&nbsp;program&nbsp;but&nbsp;cannot&nbsp;make&nbsp;it&nbsp;work.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;Of&nbsp;course&nbsp;it&nbsp;is&nbsp;possible&nbsp;–&nbsp;even&nbsp;probable&nbsp;–&nbsp;that&nbsp;I&nbsp;have&nbsp;an&nbsp;error&nbsp;in&nbsp;understanding…&nbsp;:)&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;My&nbsp;application&nbsp;is&nbsp;one&nbsp;where&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;publish&nbsp;each&nbsp;message&nbsp;using&nbsp;multiple&nbsp;routing&nbsp;keys.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;In&nbsp;general&nbsp;each&nbsp;subscriber&nbsp;will&nbsp;bind&nbsp;with&nbsp;one&nbsp;key.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;Here&nbsp;is&nbsp;a&nbsp;test&nbsp;that&nbsp;fails&nbsp;both&nbsp;on&nbsp;my&nbsp;mac&nbsp;using&nbsp;RabbitMQ&amp;nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(72,&nbsp;72,&nbsp;72);&nbsp;font-size:&nbsp;12px;&nbsp;line-height:&nbsp;17px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;2px;&nbsp;-webkit-border-vertical-spacing:&nbsp;2px;&nbsp;font-family:&nbsp;Verdana,&nbsp;sans-serif;&nbsp;&quot;&gt;2.7.1&nbsp;/&nbsp;Erlang&nbsp;R15B&nbsp;and&nbsp;a&nbsp;linux&nbsp;box&nbsp;using&amp;nbsp;&lt;/span&gt;RabbitMQ&amp;nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(72,&nbsp;72,&nbsp;72);&nbsp;font-size:&nbsp;12px;&nbsp;line-height:&nbsp;17px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;2px;&nbsp;-webkit-border-vertical-spacing:&nbsp;2px;&nbsp;font-family:&nbsp;Verdana,&nbsp;sans-serif;&nbsp;&quot;&gt;2.7.1&nbsp;/&nbsp;Erlang&nbsp;R14B:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#484848&quot;&nbsp;face=&quot;Verdana,sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&nbsp;font-size:&nbsp;12px;&nbsp;line-height:&nbsp;17px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;2px;&nbsp;-webkit-border-vertical-spacing:&nbsp;2px;&nbsp;font-family:&nbsp;Courier;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#484848&quot;&nbsp;face=&quot;Verdana,sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&nbsp;font-size:&nbsp;12px;&nbsp;line-height:&nbsp;17px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;2px;&nbsp;-webkit-border-vertical-spacing:&nbsp;2px;&nbsp;font-family:&nbsp;Courier;&nbsp;&quot;&gt;#&nbsp;test.coffee&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#484848&quot;&nbsp;face=&quot;Courier&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&nbsp;line-height:&nbsp;17px;&nbsp;-webkit-border-horizontal-spacing:&nbsp;2px;&nbsp;-webkit-border-vertical-spacing:&nbsp;2px;&nbsp;&quot;&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12px;&nbsp;&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;amqp&nbsp;=&nbsp;require&nbsp;'amqp'&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;t1_message&nbsp;=&nbsp;(message,&nbsp;headers,&nbsp;properties)&nbsp;-&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;console.log&nbsp;&amp;quot;&amp;quot;&amp;#43;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;\nSuccess:&nbsp;t1:&nbsp;message:&nbsp;#{JSON.stringify&nbsp;message}&amp;quot;&amp;#43;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;\nheaders:&nbsp;#{JSON.stringify&nbsp;headers}&amp;quot;&amp;#43;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;\nproperties:&nbsp;#{JSON.stringify&nbsp;properties,&nbsp;undefined,&nbsp;4}&amp;quot;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;process.exit&nbsp;0&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;t0_message&nbsp;=&nbsp;(message,&nbsp;headers,&nbsp;properties)&nbsp;-&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;console.log&nbsp;&amp;quot;&amp;quot;&amp;#43;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;\nBroadcast:&nbsp;t0:&nbsp;message:&nbsp;#{JSON.stringify&nbsp;message}&amp;quot;&amp;#43;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;\nheaders:&nbsp;#{JSON.stringify&nbsp;headers}&amp;quot;&amp;#43;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;\nproperties:&nbsp;#{JSON.stringify&nbsp;properties,&nbsp;undefined,&nbsp;4}&amp;quot;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;bailout&nbsp;=&nbsp;-&amp;gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;console.log&nbsp;&amp;quot;\nFailure&amp;quot;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;process.exit&nbsp;1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;amqp_connection&nbsp;=&nbsp;amqp.createConnection()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;amqp_connection.on&nbsp;'ready',&nbsp;()&nbsp;-&amp;gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;properties&nbsp;=&nbsp;type:'topic',&nbsp;durable:&nbsp;true&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;amqp_connection.exchange&nbsp;&amp;quot;test&amp;quot;,&nbsp;properties,&nbsp;(exchange)&nbsp;-&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;properties&nbsp;=&nbsp;durable:true,&nbsp;autoDelete:false&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;amqp_connection.queue&nbsp;&amp;quot;t1&amp;quot;,&nbsp;properties,&nbsp;(queue)&nbsp;-&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;queue.bind&nbsp;exchange,&nbsp;&amp;quot;foo&amp;quot;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;queue.subscribe&nbsp;(message,&nbsp;headers,&nbsp;properties)&nbsp;-&amp;gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;t1_message&nbsp;message,&nbsp;headers,&nbsp;properties&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;amqp_connection.queue&nbsp;&amp;quot;t0&amp;quot;,&nbsp;properties,&nbsp;(queue)&nbsp;-&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;queue.bind&nbsp;exchange,&nbsp;&amp;quot;*&amp;quot;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;queue.subscribe&nbsp;(message,&nbsp;headers,&nbsp;properties)&nbsp;-&amp;gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;t0_message&nbsp;message,&nbsp;headers,&nbsp;properties&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;cc_header&nbsp;=&nbsp;cc:[&amp;quot;foo&amp;quot;,&amp;quot;bar&amp;quot;]&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;properties&nbsp;=&nbsp;contentType:&amp;quot;application/json&amp;quot;,&nbsp;headers:cc_header&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;message&nbsp;=&nbsp;test:&amp;quot;message&nbsp;content&amp;quot;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;exchange.publish&nbsp;&amp;quot;whatever&amp;quot;,&nbsp;message,&nbsp;properties&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;setTimeout&nbsp;bailout,&nbsp;1000&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;Calibri;&nbsp;&quot;&gt;Here's&nbsp;the&nbsp;output&nbsp;–&nbsp;if&nbsp;it&nbsp;had&nbsp;succeeded,&nbsp;both&nbsp;queues&nbsp;would&nbsp;have&nbsp;received&nbsp;the&nbsp;message:&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre;&nbsp;&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre;&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;Broadcast:&nbsp;t0:&nbsp;message:&nbsp;{&amp;quot;test&amp;quot;:&amp;quot;message&nbsp;content&amp;quot;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre;&nbsp;&quot;&gt;headers:&nbsp;{&amp;quot;cc&amp;quot;:{&amp;quot;0&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;1&amp;quot;:&amp;quot;bar&amp;quot;}}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre;&nbsp;&quot;&gt;properties:&nbsp;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;contentType&amp;quot;:&nbsp;&amp;quot;application/json&amp;quot;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;monospace;&nbsp;font-size:&nbsp;12px;&nbsp;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;headers&amp;quot;:&nbsp;{&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;12px;&nbsp;font-family:&nbsp;'Lucida&nbsp;Grande';&nbsp;&quot;&gt;&lt;pre&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;cc&amp;quot;:&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;0&amp;quot;:&nbsp;&amp;quot;foo&amp;quot;,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;1&amp;quot;:&nbsp;&amp;quot;bar&amp;quot;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;},&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;queue&amp;quot;:&nbsp;&amp;quot;t0&amp;quot;,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;deliveryTag&amp;quot;:&nbsp;1,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;redelivered&amp;quot;:&nbsp;false,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;exchange&amp;quot;:&nbsp;&amp;quot;test&amp;quot;,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;routingKey&amp;quot;:&nbsp;&amp;quot;whatever&amp;quot;,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;consumerTag&amp;quot;:&nbsp;&amp;quot;node-amqp-38169-0.10587440640665591&amp;quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Failure&lt;/pre&gt;&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>

</tt>
