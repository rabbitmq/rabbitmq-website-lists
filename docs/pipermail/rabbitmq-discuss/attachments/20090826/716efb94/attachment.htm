<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--&nbsp;DIV&nbsp;{margin:0px;}&nbsp;--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;font-size:12pt&quot;&gt;Based&nbsp;on&nbsp;Ben&nbsp;and&nbsp;Alexis's&nbsp;discussion,&nbsp;I&nbsp;came&nbsp;up&nbsp;with&nbsp;the&nbsp;following&nbsp;logic.&nbsp;Let&nbsp;me&nbsp;know&nbsp;if&nbsp;you&nbsp;guys&nbsp;see&nbsp;any&nbsp;flaw&nbsp;in&nbsp;it.&nbsp;I&nbsp;use&nbsp;two&nbsp;exchanges;&nbsp;one&nbsp;for&nbsp;one-to-one&nbsp;chat&nbsp;and&nbsp;another&nbsp;for&nbsp;multi-user&nbsp;chat.&nbsp;Clients&nbsp;will&nbsp;use&nbsp;Java.&nbsp;I&nbsp;create&nbsp;one&nbsp;queue&nbsp;per&nbsp;user.&nbsp;Effectively,&nbsp;there&nbsp;will&nbsp;be&nbsp;two&nbsp;queues&nbsp;per&nbsp;chat.&nbsp;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;&lt;meta&nbsp;name=&quot;ProgId&quot;&nbsp;content=&quot;Word.Document&quot;&gt;&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;11&quot;&gt;&lt;meta&nbsp;name=&quot;Originator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;11&quot;&gt;&lt;link&nbsp;rel=&quot;File-List&quot;&nbsp;href=&quot;file:///C:%5CDOCUME%7E1%5CMRAMAM%7E1%5CLOCALS%7E1%5CTemp%5Cmsohtml1%5C01%5Cclip_filelist.xml&quot;&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&nbsp;&lt;w:WordDocument&gt;<br>
&nbsp;&nbsp;&lt;w:View&gt;Normal&lt;/w:View&gt;<br>
&nbsp;&nbsp;&lt;w:Zoom&gt;0&lt;/w:Zoom&gt;<br>
&nbsp;&nbsp;&lt;w:PunctuationKerning/&gt;<br>
&nbsp;&nbsp;&lt;w:ValidateAgainstSchemas/&gt;<br>
&nbsp;&nbsp;&lt;w:SaveIfXMLInvalid&gt;false&lt;/w:SaveIfXMLInvalid&gt;<br>
&nbsp;&nbsp;&lt;w:IgnoreMixedContent&gt;false&lt;/w:IgnoreMixedContent&gt;<br>
&nbsp;&nbsp;&lt;w:AlwaysShowPlaceholderText&gt;false&lt;/w:AlwaysShowPlaceholderText&gt;<br>
&nbsp;&nbsp;&lt;w:Compatibility&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;w:BreakWrappedTables/&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;w:SnapToGridInCell/&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;w:WrapTextWithPunct/&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;w:UseAsianBreakRules/&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;w:DontGrowAutofit/&gt;<br>
&nbsp;&nbsp;&lt;/w:Compatibility&gt;<br>
&nbsp;&nbsp;&lt;w:BrowserLevel&gt;MicrosoftInternetExplorer4&lt;/w:BrowserLevel&gt;<br>
&nbsp;&lt;/w:WordDocument&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&nbsp;&lt;w:LatentStyles&nbsp;DefLockedState=&quot;false&quot;&nbsp;LatentStyleCount=&quot;156&quot;&gt;<br>
&nbsp;&lt;/w:LatentStyles&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;style&gt;<br>
&lt;!--<br>
&nbsp;/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
&nbsp;p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-parent:&quot;&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin:0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-bottom:.0001pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-pagination:widow-orphan;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-size:12.0pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Times&nbsp;New&nbsp;Roman&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-fareast-font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;;}<br>
@page&nbsp;Section1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{size:8.5in&nbsp;11.0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin:1.0in&nbsp;1.25in&nbsp;1.0in&nbsp;1.25in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-header-margin:.5in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-footer-margin:.5in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-paper-source:0;}<br>
div.Section1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{page:Section1;}<br>
--&gt;<br>
&lt;/style&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;10]&gt;<br>
&lt;style&gt;<br>
&nbsp;/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
&nbsp;table.MsoNormalTable<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-name:&quot;Table&nbsp;Normal&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-tstyle-rowband-size:0;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-tstyle-colband-size:0;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-style-noshow:yes;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-style-parent:&quot;&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-padding-alt:0in&nbsp;5.4pt&nbsp;0in&nbsp;5.4pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-para-margin:0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-para-margin-bottom:.0001pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-pagination:widow-orphan;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-size:10.0pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Times&nbsp;New&nbsp;Roman&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-ansi-language:#0400;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-fareast-language:#0400;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-bidi-language:#0400;}<br>
&lt;/style&gt;<br>
&lt;![endif]--&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&nbsp;style=&quot;&quot;&gt;&lt;u&gt;One-to-one&nbsp;chat:&lt;o:p&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;When&nbsp;the&nbsp;user&nbsp;wants&nbsp;to&nbsp;send&nbsp;the&nbsp;message&nbsp;use&nbsp;SimpleProducer<br>
class.&nbsp;For&nbsp;every&nbsp;10&nbsp;seconds,&nbsp;run&nbsp;SimpleConsumer&nbsp;class&nbsp;to&nbsp;see&nbsp;if&nbsp;there&nbsp;are&nbsp;any<br>
messages&nbsp;in&nbsp;the&nbsp;queue.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;u&gt;SimpleProducer:&lt;o:p&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Publish&nbsp;the&nbsp;message&nbsp;in&nbsp;the&nbsp;window&nbsp;with&nbsp;the&nbsp;user’s&nbsp;name&nbsp;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Connect&nbsp;to&nbsp;channel&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Declare&nbsp;exchange&nbsp;named&nbsp;“direct”&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Create&nbsp;queuename&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;friend’s&nbsp;user&nbsp;name.&nbsp;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Routing&nbsp;key&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;queuename.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Do&nbsp;channel..basicPublish&nbsp;to&nbsp;publish&nbsp;the&nbsp;message&nbsp;to&nbsp;the<br>
friend.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;If&nbsp;message&nbsp;is&nbsp;not&nbsp;acknowledged,&nbsp;show&nbsp;error&nbsp;as<br>
“&amp;lt;friendname&amp;gt;&nbsp;is&nbsp;offline”.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;u&gt;SimpleConsumer:&lt;o:p&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;u&gt;&lt;o:p&gt;&lt;span&nbsp;style=&quot;text-decoration:&nbsp;none;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Set&nbsp;noAck&nbsp;to&nbsp;false&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Do&nbsp;channel.basicGet&nbsp;for&nbsp;the&nbsp;queuename&nbsp;“&amp;lt;username&amp;gt;”&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;If&nbsp;message&nbsp;is&nbsp;received&nbsp;successfully,&nbsp;do&nbsp;channel.basicAck&nbsp;to<br>
acknowledge&nbsp;the&nbsp;receipt&nbsp;of&nbsp;the&nbsp;message.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Publish&nbsp;the&nbsp;incoming&nbsp;message&nbsp;with&nbsp;the&nbsp;friend’s&nbsp;name&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&nbsp;style=&quot;&quot;&gt;&lt;u&gt;Multi-user&nbsp;chat:&lt;o:p&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;When&nbsp;the&nbsp;user&nbsp;wants&nbsp;to&nbsp;send&nbsp;the&nbsp;message&nbsp;use<br>
SimpleProducerMulti&nbsp;class.&nbsp;For&nbsp;every&nbsp;10&nbsp;seconds,&nbsp;run&nbsp;SimpleConsumerMulti&nbsp;class<br>
to&nbsp;see&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;messages&nbsp;in&nbsp;the&nbsp;queue.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;u&gt;SimpleProducerMulti:&lt;o:p&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Connect&nbsp;to&nbsp;channel&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Declare&nbsp;exchange&nbsp;named&nbsp;“multiuser”&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Create&nbsp;queuename&nbsp;as&nbsp;“multiuserqueue”&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Routing&nbsp;key&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;queuename.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Do&nbsp;channel.basicPublish&nbsp;to&nbsp;publish&nbsp;the&nbsp;message&nbsp;to<br>
multiuserqueue.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;If&nbsp;message&nbsp;is&nbsp;not&nbsp;acknowledged,&nbsp;show&nbsp;error&nbsp;as&nbsp;“server&nbsp;is<br>
offline”.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;u&gt;SimpleConsumerMulti:&lt;o:p&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;u&gt;&lt;o:p&gt;&lt;span&nbsp;style=&quot;text-decoration:&nbsp;none;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/o:p&gt;&lt;/u&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Set&nbsp;noAck&nbsp;to&nbsp;false&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Use&nbsp;QueueingConsumer&nbsp;class&nbsp;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Do&nbsp;channel.basicConsume&nbsp;for&nbsp;the&nbsp;queuename&nbsp;“&amp;lt;username&amp;gt;”&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;If&nbsp;message&nbsp;is&nbsp;received&nbsp;successfully,&nbsp;do&nbsp;channel.basicAck&nbsp;to<br>
acknowledge&nbsp;the&nbsp;receipt&nbsp;of&nbsp;the&nbsp;message.&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Publish&nbsp;the&nbsp;incoming&nbsp;message&nbsp;with&nbsp;the&nbsp;author’s&nbsp;name.&lt;/p&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;--&nbsp;Thanks,&nbsp;Ram&lt;br&gt;&lt;/div&gt;&lt;br&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;&lt;/html&gt;
</tt>
