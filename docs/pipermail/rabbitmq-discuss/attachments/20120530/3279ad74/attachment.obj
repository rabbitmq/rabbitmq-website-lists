<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:rabbit="http://www.springframework.org/schema/rabbit"
	xsi:schemaLocation="http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

		<bean id="configProperties" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
			<property name="location">
			<value>classpath:/resources/config/rabbitConfiguration.properties</value>
			</property>
		</bean>
		<bean id="rabbitConnFactory" 
			class="org.springframework.amqp.rabbit.connection.CachingConnectionFactory">
			<constructor-arg value="${RABBITMQ_HOST}"/>
			<property name="username" value="${RABBITMQ_USERNAME}" />
			<property name="password" value="${RABBITMQ_PASSWORD}" />
			<property name="port" value="${RABBITMQ_PORT}" />
		</bean>
		 
		<!-- Spring AMQP Template -->
		<bean id="rabbitTemplate" 
			class="org.springframework.amqp.rabbit.core.RabbitTemplate">
			<property name="connectionFactory" ref="rabbitConnFactory" />
			<property name="routingKey" value="${BATCH_LOG_QUEUE_NAME}"/>
			<property name="queue" value="${BATCH_LOG_QUEUE_NAME}"/>
			<property name="messageConverter">
        		<bean class="org.springframework.amqp.support.converter.SimpleMessageConverter">
        			<property name="defaultCharset" value="application/x-java-serialized-object"/>
        		</bean>
            </property>
		</bean>
		 
		<!-- Spring AMQP Admin -->
		<bean id="amqpAdmin" class="org.springframework.amqp.rabbit.core.RabbitAdmin">
			<constructor-arg ref="rabbitConnFactory" />
		</bean>
		
		<bean id="batchLogListenerContainer"
			class="org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer"
			>
			<property name="connectionFactory" ref="rabbitConnFactory" />
			<property name="queueNames" value="${BATCH_LOG_QUEUE_NAME}" />
			<property name="messageListener" ref="batchLogListenerAdapter" />
			<property name="autoStartup" value="true" />
		
		</bean>

		
		<bean id="batchLogListenerAdapter"
			class="org.springframework.amqp.rabbit.listener.adapter.MessageListenerAdapter">
			<property name="delegate" ref="batchLogHandler" />
		</bean>
	
		<bean id="batchLogHandler"
			class="com.csc.exceed.messageCenterLogging.BatchLogHandler">
		</bean>
		
		
		<bean id="batchJobDetailListenerContainer"
			class="org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer">
			<property name="connectionFactory" ref="rabbitConnFactory" />
			<property name="queueNames" value="${BATCH_DETAILS_QUEUE_NAME}" />
			<property name="messageListener" ref="batchJobDetailListenerAdapter" />
			<property name="autoStartup" value="true" />
		
		</bean>

		
		<bean id="batchJobDetailListenerAdapter"
			class="org.springframework.amqp.rabbit.listener.adapter.MessageListenerAdapter">
			<property name="delegate" ref="batchJobDetailHandler" />
		</bean>
	
		<bean id="batchJobDetailHandler"
			class="com.csc.exceed.messageCenterLogging.BatchJobDetailHandler">
		</bean>
				
	<bean id="rabbitConfigProperties"
		class="org.springframework.beans.factory.config.PropertiesFactoryBean">
		<property name="location">
			<value>classpath:/resources/config/rabbitConfiguration.properties</value>
		</property>
	</bean>
	
</beans>
