<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;do&nbsp;this&nbsp;sort&nbsp;of&nbsp;thing&nbsp;in&nbsp;pika&nbsp;using&nbsp;an&nbsp;asynchronous&nbsp;connection.&nbsp;I&nbsp;would&nbsp;suggest&nbsp;tornado_connection.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Then&nbsp;use&nbsp;pika&#39;s&nbsp;connection.add_timeout&nbsp;method.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;While&nbsp;doing&nbsp;any&nbsp;operation,&nbsp;like&nbsp;the&nbsp;summarization,&nbsp;you&nbsp;won&#39;t&nbsp;be&nbsp;yielding&nbsp;to&nbsp;pika&#39;s&nbsp;event&nbsp;loop.&nbsp;This&nbsp;can&nbsp;cause&nbsp;heartbeat&nbsp;problems&nbsp;if&nbsp;the&nbsp;time&nbsp;taken&nbsp;goes&nbsp;over&nbsp;the&nbsp;heartbeat&nbsp;interval,&nbsp;so&nbsp;watch&nbsp;for&nbsp;that.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ml&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jan&nbsp;17,&nbsp;2014&nbsp;at&nbsp;8:07&nbsp;PM,&nbsp;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:kgoess@bepress.com&quot;&nbsp;target=&quot;_blank&quot;&gt;kgoess@bepress.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;We&#39;ve&nbsp;been&nbsp;wrestling&nbsp;with&nbsp;this&nbsp;for&nbsp;a&nbsp;couple&nbsp;days&nbsp;and&nbsp;aren&#39;t&nbsp;any&nbsp;nearer&nbsp;a&nbsp;solution,&nbsp;so&nbsp;any&nbsp;suggestions&nbsp;would&nbsp;be&nbsp;helpful.&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;have&nbsp;a&nbsp;queue&nbsp;of&nbsp;unaggregated&nbsp;data,&nbsp;hits&nbsp;per&nbsp;article.&nbsp; We&#39;d&nbsp;like&nbsp;to&nbsp;have&nbsp;a&nbsp;listener&nbsp;on&nbsp;that&nbsp;queue&nbsp;collect&nbsp;messages&nbsp;for,&nbsp;say&nbsp;10,000&nbsp;messages,&nbsp;or&nbsp;ten&nbsp;minutes,&nbsp;whichever&nbsp;comes&nbsp;first,&nbsp;before&nbsp;aggregating/coalescing&nbsp;the&nbsp;data&nbsp;and&nbsp;submitting&nbsp;that&nbsp;to&nbsp;a&nbsp;second&nbsp;queue.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&#39;ve&nbsp;been&nbsp;working&nbsp;with&nbsp;python&nbsp;AMQP&nbsp;(pika)&nbsp;code&nbsp;using&nbsp;the&nbsp;pika.BlockingConnection&nbsp;and&nbsp;basic_consume,&nbsp;using&nbsp;a&nbsp;SIGALRM&nbsp;timer.&nbsp;We&#39;re&nbsp;seeing&nbsp;lots&nbsp;of&nbsp;conflicts&nbsp;between&nbsp;the&nbsp;basic_consume&nbsp;callback,&nbsp;the&nbsp;SIGALRM&nbsp;callback,&nbsp;sending&nbsp;acknowledgments&nbsp;on&nbsp;the&nbsp;incoming&nbsp;data,&nbsp;and&nbsp;sending&nbsp;the&nbsp;outgoing&nbsp;aggregated&nbsp;data&nbsp;to&nbsp;the&nbsp;second&nbsp;queue. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;After&nbsp;a&nbsp;couple&nbsp;days&nbsp;experimenting&nbsp;with&nbsp;different&nbsp;approaches,&nbsp;we&nbsp;thought&nbsp;it&nbsp;might&nbsp;be&nbsp;productive&nbsp;to&nbsp;ask&nbsp;if&nbsp;anybody&nbsp;else&nbsp;has&nbsp;already&nbsp;solved&nbsp;this&nbsp;problem&nbsp;and&nbsp;can&nbsp;suggest&nbsp;a&nbsp;strategy,&nbsp;or&nbsp;if&nbsp;anybody&nbsp;things&nbsp;pika.BlockingConnection&nbsp;is&nbsp;even&nbsp;the&nbsp;right&nbsp;tool&nbsp;for&nbsp;this?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;any&nbsp;suggestions...&lt;/div&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
