<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;Michael,&nbsp;Tim.&nbsp;great&nbsp;answers.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;more&nbsp;channel&nbsp;question:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;shouldn&amp;#39;t&nbsp;share&nbsp;a&nbsp;channel&nbsp;between&nbsp;multiple&nbsp;threads,&nbsp;but&nbsp;given&nbsp;that&nbsp;an&nbsp;ACK&nbsp;should&nbsp;be&nbsp;sent&nbsp;on&nbsp;the&nbsp;same&nbsp;channel&nbsp;that&nbsp;the&nbsp;delivery&nbsp;is&nbsp;received&nbsp;mean&nbsp;that&nbsp;one&nbsp;_must_&nbsp;violate&nbsp;this&nbsp;rule?&nbsp;I&nbsp;call&nbsp;basic.consume&nbsp;on&nbsp;my&nbsp;application&nbsp;thread,&nbsp;but&nbsp;basic.deliver&nbsp;will&nbsp;be&nbsp;called&nbsp;on&nbsp;the&nbsp;client&nbsp;library&amp;#39;s&nbsp;internal&nbsp;message&nbsp;loop&nbsp;thread&nbsp;and&nbsp;then&nbsp;the&nbsp;ACK&nbsp;will&nbsp;no&nbsp;doubt&nbsp;be&nbsp;called&nbsp;on&nbsp;a&nbsp;separate&nbsp;application&nbsp;thread&nbsp;(where&nbsp;I&nbsp;de-queue&nbsp;the&nbsp;message&nbsp;from&nbsp;my&nbsp;queuing&nbsp;consumer).&nbsp;Is&nbsp;this&nbsp;violation&nbsp;of&nbsp;the&nbsp;do-not-use-channels-on-multiple-threads&nbsp;rule&nbsp;OK?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Mike&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Sep&nbsp;23,&nbsp;2013&nbsp;at&nbsp;11:40&nbsp;AM,&nbsp;Tim&nbsp;Watson&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:tim@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;tim@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
On&nbsp;23&nbsp;Sep&nbsp;2013,&nbsp;at&nbsp;11:20,&nbsp;Mike&nbsp;Hadlow&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Hi&nbsp;All,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Are&nbsp;channel&nbsp;best&nbsp;practices&nbsp;for&nbsp;connected&nbsp;RabbitMQ&nbsp;clients&nbsp;published&nbsp;anywhere?&nbsp;I&nbsp;understand&nbsp;the&nbsp;threading&nbsp;limitations,&nbsp;that&nbsp;channels&nbsp;should&nbsp;not&nbsp;be&nbsp;shared&nbsp;between&nbsp;threads.&nbsp;Does&nbsp;the&nbsp;channel&nbsp;concept&nbsp;exist&nbsp;only&nbsp;to&nbsp;support&nbsp;multi-threaded&nbsp;applications,&nbsp;or&nbsp;does&nbsp;it&nbsp;have&nbsp;some&nbsp;other&nbsp;purpose?&lt;br&gt;<br>
<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;The&nbsp;channel&nbsp;concept&nbsp;exists&nbsp;(in&nbsp;AMQP)&nbsp;to&nbsp;provide&nbsp;a&nbsp;lightweight&nbsp;alternative&nbsp;to&nbsp;having&nbsp;one&nbsp;TCP&nbsp;connection&nbsp;per&nbsp;client,&nbsp;since&nbsp;the&nbsp;latter&nbsp;are&nbsp;resource&nbsp;intensive&nbsp;(to&nbsp;both&nbsp;client&nbsp;and&nbsp;server&amp;#39;s&nbsp;detriment).&nbsp;Multiplexing&nbsp;multiple&nbsp;&amp;quot;clients&amp;quot;&nbsp;over&nbsp;a&nbsp;single&nbsp;TCP&nbsp;connection&nbsp;turns&nbsp;out&nbsp;to&nbsp;be&nbsp;a&nbsp;fairly&nbsp;common&nbsp;approach&nbsp;amongst&nbsp;network&nbsp;intensive&nbsp;applications.&nbsp;Channels&nbsp;also&nbsp;provide&nbsp;a&nbsp;unit&nbsp;of&nbsp;atomicity&nbsp;with&nbsp;regards&nbsp;message&nbsp;ordering,&nbsp;i.e.,&nbsp;messages&nbsp;are&nbsp;always&nbsp;fully&nbsp;(FIFO)&nbsp;ordered&nbsp;from&nbsp;client&nbsp;to&nbsp;server&nbsp;over&nbsp;a&nbsp;single&nbsp;channel,&nbsp;whereas&nbsp;there&nbsp;are&nbsp;no&nbsp;ordering&nbsp;guarantees&nbsp;regarding&nbsp;messages&nbsp;concurrently&nbsp;sent&nbsp;(or&nbsp;delivered)&nbsp;over&nbsp;multiple&nbsp;channels.&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;I&nbsp;marshal&nbsp;all&nbsp;calls&nbsp;to&nbsp;a&nbsp;channel&nbsp;onto&nbsp;a&nbsp;single&nbsp;thread&nbsp;in&nbsp;my&nbsp;application&nbsp;code,&nbsp;is&nbsp;there&nbsp;any&nbsp;problem&nbsp;with&nbsp;simply&nbsp;maintaining&nbsp;a&nbsp;single&nbsp;channel&nbsp;for&nbsp;all&nbsp;declares,&nbsp;publishes&nbsp;and&nbsp;consumes?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;One&nbsp;problem&nbsp;you&nbsp;might&nbsp;run&nbsp;into&nbsp;relates&nbsp;to&nbsp;the&nbsp;answer&nbsp;I&amp;#39;ve&nbsp;given&nbsp;below&nbsp;about&nbsp;correlating&nbsp;ACKs&nbsp;with&nbsp;the&nbsp;correct&nbsp;channel.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Additional&nbsp;questions:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;1.&nbsp;Should&nbsp;each&nbsp;basic&nbsp;consume&nbsp;be&nbsp;invoked&nbsp;on&nbsp;a&nbsp;dedicated&nbsp;channel?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;That&amp;#39;s&nbsp;not&nbsp;strictly&nbsp;necessary,&nbsp;though&nbsp;neither&nbsp;is&nbsp;it&nbsp;wrong.&nbsp;Depending&nbsp;on&nbsp;your&nbsp;application&nbsp;logic,&nbsp;you&nbsp;might&nbsp;find&nbsp;that&nbsp;introduces&nbsp;unnecessary&nbsp;overhead&nbsp;(in&nbsp;terms&nbsp;of&nbsp;threads&nbsp;and&nbsp;associated&nbsp;synchronisation&nbsp;primitives&nbsp;used&nbsp;in&nbsp;the&nbsp;client&nbsp;and/or&nbsp;additional&nbsp;resource&nbsp;use&nbsp;on&nbsp;the&nbsp;server),&nbsp;so&nbsp;if&nbsp;I&nbsp;were&nbsp;you&nbsp;I&nbsp;would&nbsp;only&nbsp;do&nbsp;it&nbsp;if&nbsp;it&nbsp;is&nbsp;(a)&nbsp;necessary&nbsp;or&nbsp;(b)&nbsp;significantly&nbsp;simplifies&nbsp;your&nbsp;client&nbsp;code.&nbsp;Remember&nbsp;that&nbsp;a&nbsp;channel&nbsp;provides&nbsp;a&nbsp;FIFO&nbsp;ordering&nbsp;guarantee,&nbsp;so&nbsp;having&nbsp;multiple&nbsp;consumers&nbsp;on&nbsp;a&nbsp;single&nbsp;channel&nbsp;means&nbsp;that&nbsp;you&amp;#39;re&nbsp;potentially&nbsp;dealing&nbsp;with&nbsp;messages&nbsp;from&nbsp;more&nbsp;than&nbsp;one&nbsp;source&nbsp;queue,&nbsp;in&nbsp;which&nbsp;case&nbsp;you&nbsp;might&nbsp;inadvertently&nbsp;introduce&nbsp;a&nbsp;serial&nbsp;bottleneck.&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;2.&nbsp;Do&nbsp;I&nbsp;need&nbsp;to&nbsp;basic.ack&nbsp;on&nbsp;the&nbsp;same&nbsp;channel&nbsp;on&nbsp;which&nbsp;I&nbsp;invoked&nbsp;basic.consume?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Yes,&nbsp;that&nbsp;is&nbsp;absolutely&nbsp;necessary.&nbsp;An&nbsp;ACK&nbsp;sent&nbsp;on&nbsp;another&nbsp;channel&nbsp;to&nbsp;the&nbsp;one&nbsp;on&nbsp;which&nbsp;the&nbsp;delivery&nbsp;was&nbsp;received&nbsp;will&nbsp;be&nbsp;treated&nbsp;as&nbsp;a&nbsp;channel&nbsp;error.&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
Tim&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
