<tt>
Hi&nbsp;Alexis,&nbsp;thanks&nbsp;for&nbsp;getting&nbsp;in&nbsp;touch&nbsp;with&nbsp;Theo. &nbsp;However,&nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;this&nbsp;addresses&nbsp;my&nbsp;issue.&lt;br&gt;&lt;br&gt;I&nbsp;think&nbsp;he&amp;#39;s&nbsp;using&nbsp;&amp;quot;remote&amp;quot;&nbsp;here&nbsp;to&nbsp;refer&nbsp;to&nbsp;the&nbsp;Rabbit&nbsp;process&nbsp;on&nbsp;the&nbsp;other&nbsp;end&nbsp;of&nbsp;the&nbsp;socket&nbsp;from&nbsp;my&nbsp;publisher. &nbsp;If&nbsp;that&nbsp;Rabbit&nbsp;process&nbsp;goes&nbsp;down,&nbsp;the&nbsp;publisher&nbsp;does&nbsp;receive&nbsp;a&nbsp;SIGPIPE. &nbsp;However,&nbsp;that&nbsp;is&nbsp;actually&nbsp;my&nbsp;&amp;quot;local&amp;quot;&nbsp;process. &nbsp;My&nbsp;&amp;quot;remote&amp;quot;&nbsp;process&nbsp;is&nbsp;the&nbsp;Rabbit&nbsp;node&nbsp;on&nbsp;another&nbsp;machine&nbsp;that&nbsp;holds&nbsp;the&nbsp;queue. &nbsp;My&nbsp;publisher&nbsp;connects&nbsp;to&nbsp;the&nbsp;local&nbsp;Rabbit,&nbsp;and&nbsp;the&nbsp;local&nbsp;Rabbit&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;Rabbit. &nbsp;If&nbsp;the&nbsp;remote&nbsp;Rabbit&nbsp;goes&nbsp;down,&nbsp;there&nbsp;is&nbsp;no&nbsp;SIGPIPE&nbsp;in&nbsp;my&nbsp;publisher.&lt;br&gt;<br>
&lt;br&gt;The&nbsp;hang&nbsp;in&nbsp;DESTROY&nbsp;was&nbsp;resolved&nbsp;by&nbsp;upgrading&nbsp;Rabbit&nbsp;itself.&lt;br&gt;&lt;br&gt;I&amp;#39;ll&nbsp;contact&nbsp;him&nbsp;myself&nbsp;and&nbsp;let&nbsp;you&nbsp;know&nbsp;what&nbsp;I&nbsp;find&nbsp;out.&lt;br&gt;&lt;br&gt;Ronald&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;3,&nbsp;2011&nbsp;at&nbsp;11:47&nbsp;AM,&nbsp;Alexis&nbsp;Richardson&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:alexis@rabbitmq.com&quot;&gt;alexis@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Ronald&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;spoke&nbsp;with&nbsp;the&nbsp;author,&nbsp;Theo&nbsp;Schlossnagle,&nbsp;who&nbsp;permitted&nbsp;to&nbsp;post&nbsp;his&lt;br&gt;<br>
reply&nbsp;here:&lt;br&gt;<br>
&lt;br&gt;<br>
-&lt;br&gt;<br>
You&nbsp;must&nbsp;catch&nbsp;SIGPIPE&nbsp;if&nbsp;you&nbsp;plan&nbsp;to&nbsp;handle&nbsp;busted&nbsp;writes&nbsp;on&lt;br&gt;<br>
sockets.&nbsp;This&nbsp;is&nbsp;straight&nbsp;forward&nbsp;from&nbsp;perl.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;publishes&nbsp;don&amp;#39;t&nbsp;erroneously&nbsp;indicated&nbsp;success&nbsp;as&nbsp;the&nbsp;writes()&nbsp;and&lt;br&gt;<br>
synchronous.&nbsp;The&nbsp;remote&nbsp;is&nbsp;down,&nbsp;but&nbsp;the&nbsp;TCP&nbsp;socket&nbsp;hasn&amp;#39;t&nbsp;realized&nbsp;it&lt;br&gt;<br>
yet...&nbsp;So&nbsp;you&nbsp;write(),&nbsp;which&nbsp;is&nbsp;fine&nbsp;(as&nbsp;the&nbsp;socket&nbsp;hasn&amp;#39;t&nbsp;flushed).&lt;br&gt;<br>
So,&nbsp;if&nbsp;it&nbsp;flushes&nbsp;into&nbsp;the&nbsp;kernel&nbsp;and&nbsp;the&nbsp;kernel&nbsp;knows&nbsp;the&nbsp;socket&nbsp;is&lt;br&gt;<br>
busted&nbsp;-&amp;gt;&nbsp;SIGPIPE,&nbsp;if&nbsp;not,&nbsp;then&nbsp;you&amp;#39;ll&nbsp;get&nbsp;a&nbsp;successful&nbsp;publish.&nbsp; That&lt;br&gt;<br>
behaviour&nbsp;is&nbsp;expected,&nbsp;no?&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;hang&nbsp;in&nbsp;DESTROY&nbsp;sounds&nbsp;like&nbsp;a&nbsp;bug&nbsp;--&nbsp;I&nbsp;have&nbsp;not&nbsp;seen&nbsp;that&nbsp;one&nbsp;on&lt;br&gt;<br>
my&nbsp;side.&nbsp; Would&nbsp;like&nbsp;some&nbsp;more&nbsp;information&nbsp;--&nbsp;user-space&nbsp;stack&nbsp;trace&lt;br&gt;<br>
of&nbsp;the&nbsp;hung&nbsp;perl&nbsp;process&nbsp;w/&nbsp;symbols&nbsp;would&nbsp;be&nbsp;awesome.&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;also&nbsp;open&nbsp;a&nbsp;issue&nbsp;on&nbsp;github&nbsp;for&nbsp;the&nbsp;specific&nbsp;problems&lt;br&gt;<br>
remaining&nbsp;unresolved:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://github.com/omniti-labs/Net--RabbitMQ&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/omniti-labs/Net--RabbitMQ&lt;/a&gt;&lt;br&gt;<br>
-&lt;br&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;this&nbsp;helps!&lt;br&gt;<br>
&lt;br&gt;<br>
alexis&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Tue,&nbsp;May&nbsp;31,&nbsp;2011&nbsp;at&nbsp;6:34&nbsp;PM,&nbsp;Ronald&nbsp;J&nbsp;Kimball&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:rkimball@pangeamedia.com&quot;&gt;rkimball@pangeamedia.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hi,&nbsp;thanks&nbsp;for&nbsp;the&nbsp;response. &nbsp;Unfortunately,&nbsp;I&nbsp;haven&amp;#39;t&nbsp;really&nbsp;found&nbsp;an&lt;br&gt;<br>
&amp;gt;&nbsp;answer.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;We&nbsp;upgraded&nbsp;RabbitMQ&nbsp;to&nbsp;2.4.1,&nbsp;after&nbsp;which&nbsp;Net::RabbitMQ&nbsp;no&nbsp;longer&nbsp;hangs&lt;br&gt;<br>
&amp;gt;&nbsp;when&nbsp;the&nbsp;remote&nbsp;server&nbsp;is&nbsp;up&nbsp;but&nbsp;the&nbsp;remote&nbsp;app&nbsp;is&nbsp;down.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;However,&nbsp;Net::RabbitMQ&nbsp;still&nbsp;returns&nbsp;a&nbsp;false&nbsp;success&nbsp;when&nbsp;the&nbsp;remote&nbsp;server&lt;br&gt;<br>
&amp;gt;&nbsp;or&nbsp;app&nbsp;goes&nbsp;down&nbsp;after&nbsp;the&nbsp;publisher&nbsp;connects&nbsp;to&nbsp;the&nbsp;local&nbsp;node. &nbsp;(The&nbsp;queue&lt;br&gt;<br>
&amp;gt;&nbsp;is&nbsp;located&nbsp;on&nbsp;the&nbsp;remote&nbsp;app.)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;For&nbsp;now,&nbsp;we&amp;#39;ve&nbsp;switched&nbsp;to&nbsp;having&nbsp;a&nbsp;single&nbsp;node. &nbsp;This&nbsp;decreases&nbsp;our&lt;br&gt;<br>
&amp;gt;&nbsp;throughput&nbsp;slightly,&nbsp;but&nbsp;at&nbsp;least&nbsp;we&nbsp;don&amp;#39;t&nbsp;risk&nbsp;dropping&nbsp;messages.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;think&nbsp;we&nbsp;must&nbsp;be&nbsp;doing&nbsp;something&nbsp;wrong,&nbsp;but&nbsp;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;what...&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Ronald&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;On&nbsp;Tue,&nbsp;May&nbsp;31,&nbsp;2011&nbsp;at&nbsp;7:41&nbsp;AM,&nbsp;Alexis&nbsp;Richardson&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:alexis@rabbitmq.com&quot;&gt;alexis@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Ronald&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Were&nbsp;you&nbsp;able&nbsp;to&nbsp;find&nbsp;an&nbsp;answer&nbsp;to&nbsp;this?&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;alexis&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;On&nbsp;Thu,&nbsp;May&nbsp;19,&nbsp;2011&nbsp;at&nbsp;9:44&nbsp;PM,&nbsp;Ronald&nbsp;J&nbsp;Kimball&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:rkimball@pangeamedia.com&quot;&gt;rkimball@pangeamedia.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;understand&nbsp;how&nbsp;RabbitMQ&nbsp;behaves&nbsp;under&nbsp;failure&nbsp;conditions,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;specifically&nbsp;when&nbsp;using&nbsp;the&nbsp;Net::RabbitMQ&nbsp;Perl&nbsp;module.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;We&nbsp;have&nbsp;RabbitMQ&nbsp;set&nbsp;up&nbsp;with&nbsp;three&nbsp;nodes,&nbsp;one&nbsp;on&nbsp;the&nbsp;backend,&nbsp;which&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;holds&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;the&nbsp;actual&nbsp;queues,&nbsp;and&nbsp;two&nbsp;on&nbsp;the&nbsp;frontend,&nbsp;which&nbsp;receive&nbsp;publish&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;requests.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;RabbitMQ&nbsp;2.2.0&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Net::RabbitMQ&nbsp;0.1.8&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Below&nbsp;is&nbsp;the&nbsp;chart&nbsp;of&nbsp;behaviors&nbsp;that&nbsp;I&nbsp;have&nbsp;observed.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;quot;+&amp;quot;&nbsp;means&nbsp;the&nbsp;behavior&nbsp;is&nbsp;as&nbsp;I&nbsp;expected:&nbsp;either&nbsp;the&nbsp;message&nbsp;is&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;successfully&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;queued,&nbsp;or&nbsp;an&nbsp;error&nbsp;is&nbsp;thrown.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;quot;-&amp;quot;&nbsp;means&nbsp;the&nbsp;behavior&nbsp;is&nbsp;not&nbsp;as&nbsp;I&nbsp;expected,&nbsp;but&nbsp;can&nbsp;be&nbsp;managed:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;specifically,&nbsp;the&nbsp;process&nbsp;receives&nbsp;a&nbsp;SIGPIPE,&nbsp;which&nbsp;I&nbsp;can&nbsp;trap&nbsp;and&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;recover&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;from.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;quot;!&amp;quot;&nbsp;means&nbsp;the&nbsp;behavior&nbsp;is&nbsp;not&nbsp;as&nbsp;I&nbsp;expected,&nbsp;and&nbsp;cannot&nbsp;be&nbsp;managed:&nbsp;the&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;message&nbsp;is&nbsp;not&nbsp;queued&nbsp;but&nbsp;no&nbsp;error&nbsp;is&nbsp;thrown&nbsp;and/or&nbsp;the&nbsp;process&nbsp;hangs.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;quot;App&nbsp;down&amp;quot;&nbsp;means&nbsp;I&nbsp;ran&nbsp;`rabbitmqctl&nbsp;stop_app`. &nbsp;&amp;quot;Daemon&nbsp;down&amp;quot;&nbsp;means&nbsp;I&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;ran&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;`rabbitmqctl&nbsp;stop`.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp;As&nbsp;publishing&nbsp;process&nbsp;starts&nbsp;up:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;daemon&nbsp;up,&nbsp;app&nbsp;up&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;+&nbsp;Everything&nbsp;okay&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;daemon&nbsp;up,&nbsp;app&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;!&nbsp;Net::RabbitMQ&nbsp;hangs&nbsp;when&nbsp;declaring&nbsp;queue&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;daemon&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;+&nbsp;Net::RabbitMQ&nbsp;throws&nbsp;error&nbsp;when&nbsp;declaring&nbsp;queue&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;       &nbsp;&amp;quot;Declaring&nbsp;queue:&nbsp;server&nbsp;channel&nbsp;error&nbsp;404,&nbsp;message:&nbsp;NOT_FOUND&nbsp;-&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;no&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;queue&nbsp;&amp;#39;test&amp;#39;&nbsp;in&nbsp;vhost&nbsp;&amp;#39;/&amp;#39;&amp;quot;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Local&nbsp;daemon&nbsp;up,&nbsp;app&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;+&nbsp;Net::RabbitMQ&nbsp;throws&nbsp;error&nbsp;when&nbsp;connecting&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;       &nbsp;&amp;quot;Opening&nbsp;socket:&nbsp;Connection&nbsp;refused&amp;quot;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Local&nbsp;daemon&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;+&nbsp;Net::RabbitMQ&nbsp;throws&nbsp;error&nbsp;when&nbsp;connecting&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;       &nbsp;&amp;quot;Opening&nbsp;socket:&nbsp;Connection&nbsp;refused&amp;quot;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp;After&nbsp;publishing&nbsp;process&nbsp;starts&nbsp;up:&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Local&nbsp;app&nbsp;goes&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;-&nbsp;Process&nbsp;receives&nbsp;SIGPIPE&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Local&nbsp;daemon&nbsp;goes&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;-&nbsp;Process&nbsp;receives&nbsp;SIGPIPE&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;app&nbsp;goes&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;!&nbsp;Net::RabbitMQ&nbsp;falsely&nbsp;indicates&nbsp;success&nbsp;when&nbsp;publishing,&nbsp;then&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;hangs&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;(in&nbsp;DESTROY?)&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;daemon&nbsp;goes&nbsp;down&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;!&nbsp;Net::RabbitMQ&nbsp;falsely&nbsp;indicates&nbsp;success&nbsp;when&nbsp;publishing&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Local&nbsp;app&nbsp;goes&nbsp;down,&nbsp;comes&nbsp;back&nbsp;up&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;-&nbsp;Process&nbsp;receives&nbsp;SIGPIPE&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Local&nbsp;daemon&nbsp;goes&nbsp;down,&nbsp;comes&nbsp;back&nbsp;up&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;-&nbsp;Process&nbsp;receives&nbsp;SIGPIPE&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;app&nbsp;goes&nbsp;down,&nbsp;comes&nbsp;back&nbsp;up&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;+&nbsp;Everything&nbsp;okay&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;   &nbsp;Remote&nbsp;daemon&nbsp;goes&nbsp;down,&nbsp;comes&nbsp;back&nbsp;up&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;     &nbsp;+&nbsp;Everything&nbsp;okay&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Have&nbsp;other&nbsp;people&nbsp;had&nbsp;these&nbsp;problems&nbsp;with&nbsp;Net::RabbitMQ? &nbsp;Can&nbsp;we&nbsp;resolve&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;these&nbsp;issues&nbsp;by&nbsp;changing&nbsp;something&nbsp;in&nbsp;our&nbsp;RabbitMQ&nbsp;configuration?&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;thanks,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Ronald&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;P.S.&nbsp;Here&amp;#39;s&nbsp;my&nbsp;script.&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;#!/usr/local/bin/perl&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;use&nbsp;strict;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;use&nbsp;warnings;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;use&nbsp;Net::RabbitMQ;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$|&nbsp;=&nbsp;1;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$SIG{&amp;#39;PIPE&amp;#39;}&nbsp;=&nbsp;sub&nbsp;{&nbsp;die&nbsp;&amp;quot;SIGPIPE\n&amp;quot;&nbsp;};&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;my&nbsp;$mq&nbsp;=&nbsp;Net::RabbitMQ-&amp;gt;new();&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;alarm(10);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Connecting\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$mq-&amp;gt;connect(&amp;#39;localhost&amp;#39;,&nbsp;{&nbsp;user&nbsp;=&amp;gt;&nbsp;&amp;#39;engagement&amp;#39;,&nbsp;password&nbsp;=&amp;gt;&nbsp;&amp;#39;********&amp;#39;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;})&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp;or&nbsp;die&nbsp;&amp;quot;Can&amp;#39;t&nbsp;connect&nbsp;to&nbsp;RabbitMQ\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Opening&nbsp;channel\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$mq-&amp;gt;channel_open(1);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Declaring&nbsp;exchange\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$mq-&amp;gt;exchange_declare(1,&nbsp;&amp;#39;ee_exchange&amp;#39;,&nbsp;{&nbsp;durable&nbsp;=&amp;gt;&nbsp;1&nbsp;});&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Declaring&nbsp;queue\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$mq-&amp;gt;queue_declare(1,&nbsp;&amp;#39;test&amp;#39;,&nbsp;{&nbsp;durable&nbsp;=&amp;gt;&nbsp;1&nbsp;});&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Binding&nbsp;queue\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;$mq-&amp;gt;queue_bind(1,&nbsp;&amp;#39;test&amp;#39;,&nbsp;&amp;#39;ee_exchange&amp;#39;,&nbsp;&amp;#39;ee_test&amp;#39;);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;alarm(0);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;&amp;gt;&nbsp;&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;lt;&amp;gt;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;alarm(10);&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Publishing&nbsp;message\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;my&nbsp;$rc&nbsp;=&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp; &nbsp;$mq-&amp;gt;publish(1,&nbsp;&amp;#39;ee_test&amp;#39;,&nbsp;&amp;#39;hello&nbsp;world!&amp;#39;,&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;              &nbsp;{&nbsp;exchange&nbsp;=&amp;gt;&nbsp;&amp;#39;ee_exchange&amp;#39;,&nbsp;mandatory&nbsp;=&amp;gt;&nbsp;1,&nbsp;immediate&nbsp;=&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;0&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;},&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;              &nbsp;{&nbsp;delivery_mode&nbsp;=&amp;gt;&nbsp;2&nbsp;});&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;print&nbsp;&amp;quot;Result:&nbsp;$rc\n&amp;quot;;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;__END__&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
