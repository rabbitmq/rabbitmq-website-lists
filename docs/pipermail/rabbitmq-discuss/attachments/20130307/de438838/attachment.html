<tt>
Hi,&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;setup&nbsp;a&nbsp;simple&nbsp;application&nbsp;using&nbsp;Java&nbsp;client&nbsp;(v3.0.2),&nbsp;where&nbsp;a&nbsp;single&nbsp;consumer&nbsp;receives&nbsp;messages&nbsp;from&nbsp;a&nbsp;queue&nbsp;and&nbsp;recovers&nbsp;on&nbsp;failure.&nbsp;I&nbsp;added&nbsp;a&nbsp;heartbeat&nbsp;to&nbsp;my&nbsp;connection,&nbsp;as&nbsp;the&nbsp;network&nbsp;between&nbsp;the&nbsp;client&nbsp;and&nbsp;RabbitMQ&nbsp;is&nbsp;not&nbsp;very&nbsp;reliable.&nbsp;I&nbsp;also&nbsp;implemented&nbsp;ShutdownListener&nbsp;and&nbsp;attached&nbsp;the&nbsp;listener&nbsp;to&nbsp;my&nbsp;connection&nbsp;and&nbsp;channel.&nbsp;When&nbsp;I&nbsp;receive&nbsp;a&nbsp;shutdown&nbsp;signal,&nbsp;I&nbsp;close&nbsp;the&nbsp;connection&nbsp;and&nbsp;the&nbsp;channel,&nbsp;and&nbsp;then&nbsp;attempt&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;connection&nbsp;and&nbsp;channel.&nbsp;If&nbsp;I&nbsp;fail,&nbsp;I&nbsp;retry&nbsp;after&nbsp;a&nbsp;few&nbsp;seconds.&nbsp;I&nbsp;tested&nbsp;this&nbsp;logic&nbsp;by&nbsp;starting&nbsp;the&nbsp;client&nbsp;and&nbsp;shutting&nbsp;down&nbsp;RabbitMQ,&nbsp;and&nbsp;this&nbsp;works&nbsp;perfectly.&nbsp;However,&nbsp;if&nbsp;I&nbsp;disconnect&nbsp;from&nbsp;the&nbsp;network,&nbsp;channel.close()&nbsp;blocks.&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;the&nbsp;following&nbsp;two&nbsp;cases:&lt;br&gt;<br>
&lt;ul&gt;&lt;li&gt;Attempt&nbsp;calling&nbsp;channel.close()&nbsp;before&nbsp;the&nbsp;shutdown&nbsp;signal&nbsp;is&nbsp;passed&nbsp;to&nbsp;shutdownCompleted(...).&lt;br&gt;&lt;/li&gt;&lt;li&gt;<br>
Attempt&nbsp;calling&nbsp;channel.close()&nbsp;after&nbsp;the&nbsp;shutdown&nbsp;signal&nbsp;is&nbsp;passed&nbsp;to&nbsp;shutdownCompleted(...).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;In&nbsp;both&nbsp;cases&nbsp;channel.close()&nbsp;blocks.&nbsp;In&nbsp;the&nbsp;second&nbsp;one,&nbsp;I&nbsp;can&nbsp;add&nbsp;a&nbsp;flag&nbsp;and&nbsp;avoid&nbsp;calling&nbsp;channel.close(),&nbsp;but&nbsp;in&nbsp;the&nbsp;first&nbsp;case&nbsp;I&amp;#39;m&nbsp;not&nbsp;able&nbsp;to&nbsp;detect&nbsp;if&nbsp;there&amp;#39;s&nbsp;a&nbsp;network&nbsp;problem&nbsp;or&nbsp;not.&lt;/p&gt;<br>
&lt;p&gt;Should&nbsp;I&nbsp;avoid&nbsp;trying&nbsp;to&nbsp;close&nbsp;channels?&nbsp;Is&nbsp;there&nbsp;a&nbsp;better&nbsp;solution&nbsp;for&nbsp;handling&nbsp;network&nbsp;errors?&lt;/p&gt;&lt;p&gt;Thank&nbsp;you&nbsp;in&nbsp;advance&nbsp;for&nbsp;your&nbsp;time!&lt;/p&gt;&lt;p&gt;Kind&nbsp;regards,&lt;/p&gt;&lt;p&gt;Yiannis&lt;br&gt;&lt;/p&gt;<br>

</tt>
