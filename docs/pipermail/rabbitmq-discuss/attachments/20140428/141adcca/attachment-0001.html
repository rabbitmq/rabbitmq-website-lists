<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;Ok,&nbsp;I&nbsp;updated&nbsp;the&nbsp;coed&nbsp;as&nbsp;below.&nbsp; &lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;<br>
<br>
&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt; &nbsp; ch1.on_ack&nbsp;do&nbsp;|basic_ack|&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt; &nbsp; &nbsp; &nbsp; &nbsp;puts&nbsp;&quot;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#{basic_ack.multiple},&nbsp;delivery_tag&nbsp;=&nbsp;#{basic_ack.delivery_tag}&quot;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;<br>
<br>
<br>
&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt; &nbsp; end&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt; &nbsp; &nbsp; &nbsp;10.times&nbsp;do&lt;br&gt;<br>
<br>
<br>
&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt; &nbsp; &nbsp; &nbsp; &nbsp;@ns_x.publish(message_body,&nbsp; :routing_key&nbsp;=&gt;&nbsp;&quot;ipamAgent.operations&quot;,&nbsp;:headers&nbsp;=&gt;&nbsp;message_headers,&nbsp;:mandatory&nbsp;=&gt;&nbsp;true)&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;color=&quot;#999999&quot;&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&gt; &nbsp; &nbsp; &nbsp;end&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;Can&nbsp;you&nbsp;let&nbsp;me&nbsp;know&nbsp; your&nbsp;comments&nbsp;for&nbsp;the&nbsp;below&nbsp;questions&lt;br&gt;<br>
<br>
<br>
&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px;font-family:arial,sans-serif&quot;&gt;1. &lt;span&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt; How&nbsp;can&nbsp;I&nbsp;identify&nbsp;the&nbsp;message&nbsp;along&nbsp;with&nbsp;the&nbsp;message&nbsp;contents&nbsp;for&nbsp;which&nbsp;didn&#39;t&nbsp;get&nbsp;the&nbsp;acknowledgement &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;?&lt;/span&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px;font-family:arial,sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;2.&nbsp;While&nbsp;publishing&nbsp;the&nbsp;10 messages,&nbsp;I&nbsp;received &lt;font&nbsp;color=&quot;#000000&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;font&gt;acknowledgement&nbsp;for&nbsp;5&nbsp;messages&nbsp;only.&nbsp;I&nbsp;suspect&nbsp;RabbitMq&nbsp;sent &lt;/font&gt;acknowledgement for multiple&nbsp;messages&nbsp;on 5&nbsp;&amp;&nbsp;10,&nbsp;if&nbsp;so&nbsp;then&nbsp;how&nbsp;can&nbsp;we&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;acknowledgement&nbsp;is&nbsp;meant&nbsp;for&nbsp;message&nbsp;1,2,3,4&nbsp;and&nbsp;5&nbsp;in&nbsp;&quot;&lt;/font&gt;&lt;/font&gt;&lt;span&nbsp;style=&quot;font-size:13px;color:rgb(102,102,102);font-family:&#39;courier&nbsp;new&#39;,monospace&quot;&gt;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#&lt;AMQ::Protocol::Basic::Ack:&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:13px;color:rgb(102,102,102);font-family:&#39;courier&nbsp;new&#39;,monospace&quot;&gt;0x96d6560&nbsp;@delivery_tag=5,&nbsp;@multiple=true&gt;,&nbsp;delivery_tag&nbsp;=&nbsp;5&lt;/span&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&quot;&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;b&gt;Acknowledgement&nbsp;O/p&nbsp;for&nbsp;10&nbsp;messages:&lt;/b&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;<br>
<br>
&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#666666&quot;&gt;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#&lt;AMQ::Protocol::Basic::Ack:0x96d6560&nbsp;@delivery_tag=5,&nbsp;@multiple=true&gt;,&nbsp;delivery_tag&nbsp;=&nbsp;5&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#666666&quot;&gt;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#&lt;AMQ::Protocol::Basic::Ack:0x96d5f84&nbsp;@delivery_tag=6,&nbsp;@multiple=false&gt;,&nbsp;delivery_tag&nbsp;=&nbsp;6&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#666666&quot;&gt;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#&lt;AMQ::Protocol::Basic::Ack:0x96d5700&nbsp;@delivery_tag=7,&nbsp;@multiple=false&gt;,&nbsp;delivery_tag&nbsp;=&nbsp;7&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#666666&quot;&gt;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#&lt;AMQ::Protocol::Basic::Ack:0x96d50c0&nbsp;@delivery_tag=8,&nbsp;@multiple=false&gt;,&nbsp;delivery_tag&nbsp;=&nbsp;8&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:arial,sans-serif&quot;&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#666666&quot;&gt;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#&lt;AMQ::Protocol::Basic::Ack:0x972ce10&nbsp;@delivery_tag=10,&nbsp;@multiple=true&gt;,&nbsp;delivery_tag&nbsp;=&nbsp;10&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;font&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&gt;3.&nbsp;How&nbsp;do&nbsp;we&nbsp;ensure&nbsp;that&nbsp;message&nbsp;is&nbsp;successfully&nbsp;published&nbsp;to&nbsp;the&nbsp;exchange.(I&nbsp;want&nbsp;some&nbsp;way&nbsp;to&nbsp;identify&nbsp;the&nbsp;message&nbsp;is&nbsp;sent&nbsp;from&nbsp;ruby&nbsp;client&nbsp;to&nbsp;RabbitMq&nbsp;exchange&nbsp;successfully)&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;font&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&nbsp;face=&quot;tahoma,&nbsp;sans-serif&quot;&gt;regards,&lt;br&gt;Loganathan&lt;br&gt;Mob:&nbsp;&lt;a&nbsp;href=&quot;tel:%2B91%207760780741&quot;&nbsp;value=&quot;+917760780741&quot;&nbsp;target=&quot;_blank&quot;&gt;+91&nbsp;7760780741&lt;/a&gt;&nbsp;|&nbsp;&lt;a&nbsp;href=&quot;tel:%2B91%209944414388&quot;&nbsp;value=&quot;+919944414388&quot;&nbsp;target=&quot;_blank&quot;&gt;+91&nbsp;9944414388&lt;/a&gt;&lt;br&gt;<br>
<br>
Skype:&nbsp;loganathan.sellappa&lt;br&gt;<br>
&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:tahoma,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;http://vizualize.me/loganathan&quot;&nbsp;target=&quot;_blank&quot;&gt;ViewMe&lt;/a&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Apr&nbsp;28,&nbsp;2014&nbsp;at&nbsp;6:22&nbsp;PM,&nbsp;Michael&nbsp;Klishin&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:mklishin@gopivotal.com&quot;&nbsp;target=&quot;_blank&quot;&gt;mklishin@gopivotal.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
<br>
<br>
&lt;div&gt;On&nbsp;28&nbsp;April&nbsp;2014&nbsp;at&nbsp;16:47:24,&nbsp;Loganathan&nbsp;Sellapa&nbsp;(&lt;a&nbsp;href=&quot;mailto:loganathan.ms@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;loganathan.ms@gmail.com&lt;/a&gt;)&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;@ns_x.publish(message_body,&nbsp;:routing_key&nbsp;=&gt;&nbsp;&quot;ipamAgent.operations&quot;,&lt;br&gt;<br>
&gt;&nbsp;:headers&nbsp;=&gt;&nbsp;message_headers,&nbsp;:mandatory&nbsp;=&gt;&nbsp;true)&lt;br&gt;<br>
&gt;&nbsp;end&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;ch1.on_ack&nbsp;do&nbsp;|basic_ack|&lt;br&gt;<br>
&gt;&nbsp;puts&nbsp;&quot;Received&nbsp;basic_ack:&nbsp;multiple&nbsp;=&nbsp;#{basic_ack.multiple},&lt;br&gt;<br>
&gt;&nbsp;delivery_tag&nbsp;=&nbsp;#{basic_ack.delivery_tag}&quot;&lt;br&gt;<br>
&gt;&nbsp;end&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;You&nbsp;need&nbsp;to&nbsp;define&nbsp;the&nbsp;handler&nbsp;before&nbsp;you&nbsp;publish,&nbsp;otherwise&nbsp;you&nbsp;have&lt;br&gt;<br>
a&nbsp;race&nbsp;condition&nbsp; (it&nbsp;makes&nbsp;sense&lt;br&gt;<br>
to&nbsp;do&nbsp;this&nbsp;right&nbsp;after&nbsp;calling&nbsp;confirm_select).&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;--&lt;br&gt;<br>
MK&lt;br&gt;<br>
&lt;br&gt;<br>
Software&nbsp;Engineer,&nbsp;Pivotal/RabbitMQ&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
