<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&amp;#39;ve&nbsp;got&nbsp;the&nbsp;following&nbsp;going&nbsp;on&nbsp;(version&nbsp;2.8.4):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;-&nbsp;My&nbsp;consumers&nbsp;all&nbsp;stop&nbsp;(e.g.&nbsp;imagine&nbsp;a&nbsp;failure&nbsp;scenario&nbsp;/&nbsp;upgrade),&nbsp;but&nbsp;producers&nbsp;keep&nbsp;on&nbsp;producing&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;-&nbsp;Queues&nbsp;start&nbsp;backing&nbsp;up &lt;/div&gt;&lt;div&nbsp;style&gt;-&nbsp;Memory&nbsp;increases&nbsp;with&nbsp;queue&nbsp;size&lt;/div&gt;&lt;div&nbsp;style&gt;-&nbsp;The&nbsp;high&nbsp;water&nbsp;mark&nbsp;gets&nbsp;hit&nbsp;and&nbsp;the&nbsp;node&nbsp;memory&nbsp;alarm&nbsp;goes&nbsp;off&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;There&nbsp;are&nbsp;a&nbsp;couple&nbsp;of&nbsp;things&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;understand&nbsp;that&nbsp;I&nbsp;can&amp;#39;t&nbsp;seem&nbsp;to&nbsp;find&nbsp;in&nbsp;the&nbsp;docs:&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;-&nbsp;with&nbsp;this&nbsp;being&nbsp;a&nbsp;durable&nbsp;queue,&nbsp;I&nbsp;anticipated&nbsp;RMQ&nbsp;would&nbsp;flush&nbsp;to&nbsp;disk&nbsp;and&nbsp;free&nbsp;memory.&nbsp; Could&nbsp;someone&nbsp;please&nbsp;explain&nbsp;the&nbsp;memory&nbsp;overhead&nbsp;for&nbsp;messages&nbsp;sitting&nbsp;on&nbsp;a&nbsp;queue?&nbsp; I&nbsp;guess&nbsp;there&nbsp;is&nbsp;a&nbsp;something&nbsp;in&nbsp;memory&nbsp;for&nbsp;each&nbsp;message&nbsp;on&nbsp;a&nbsp;queue&nbsp;-&nbsp;is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;work&nbsp;around&nbsp;that?&nbsp;(we&nbsp;anticipate&nbsp;deliberately&nbsp;getting&nbsp;into&nbsp;this&nbsp;state&nbsp;from&nbsp;time&nbsp;to&nbsp;time,&nbsp;when&nbsp;we&nbsp;e.g.&nbsp;upgrade&nbsp;HBase)&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;-&nbsp;I&amp;#39;m&nbsp;kind&nbsp;of&nbsp;in&nbsp;a&nbsp;deadlock&nbsp;I&nbsp;think&nbsp;now&nbsp;as&nbsp;when&nbsp;the&nbsp;consumers&nbsp;start,&nbsp;they&nbsp;won&amp;#39;t&nbsp;ack&nbsp;a&nbsp;message&nbsp;until&nbsp;they&nbsp;have&nbsp;successfully&nbsp;sent&nbsp;a&nbsp;message&nbsp;on&nbsp;(it&amp;#39;s&nbsp;a&nbsp;multihop&nbsp;process)&nbsp;but&nbsp;that&nbsp;is&nbsp;blocked.&nbsp; Should&nbsp;the&nbsp;per&nbsp;connection&nbsp;flow&nbsp;control&nbsp;not&nbsp;have&nbsp;kicked&nbsp;in&nbsp;and&nbsp;blocked&nbsp;the&nbsp;producers&nbsp;before&nbsp;the&nbsp;whole&nbsp;lot&nbsp;just&nbsp;blocked?&nbsp; (have&nbsp;I&nbsp;missed&nbsp;some&nbsp;setting&nbsp;to&nbsp;enable&nbsp;that,&nbsp;as&nbsp;the&nbsp;docs&nbsp;say&nbsp;it&nbsp;is&nbsp;on&nbsp;by&nbsp;default).&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Also&nbsp;please&nbsp;know&nbsp;I&nbsp;am&nbsp;a&nbsp;newbie,&nbsp;running&nbsp;on&nbsp;default&nbsp;config,&nbsp;so&nbsp;please&nbsp;don&amp;#39;t&nbsp;be&nbsp;shy&nbsp;at&nbsp;pointing&nbsp;out&nbsp;the&nbsp;obvious&nbsp;to&nbsp;me.&nbsp; Chances&nbsp;are&nbsp;I&nbsp;could&nbsp;have&nbsp;missed&nbsp;something,&nbsp;but&nbsp;I&nbsp;did&nbsp;try&nbsp;and&nbsp;read&nbsp;all&nbsp;the&nbsp;docs&nbsp;before&nbsp;posting.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Thanks&nbsp;for&nbsp;any&nbsp;pointers!&lt;/div&gt;&lt;div&nbsp;style&gt;Tim&lt;/div&gt;&lt;/div&gt;<br>

</tt>
