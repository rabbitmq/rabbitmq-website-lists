<tt>
I&amp;#39;m&nbsp;still&nbsp;seeing&nbsp;this&nbsp;behavior&nbsp;and&nbsp;it&nbsp;seems&nbsp;to&nbsp;get&nbsp;worse. &lt;div&gt;Every&nbsp;hour&nbsp;there&nbsp;is&nbsp;a&nbsp;drop&nbsp;in&nbsp;delivery&nbsp;rate&nbsp;to&nbsp;0&nbsp;and&nbsp;now&nbsp;also&nbsp;the&nbsp;publish&nbsp;rate&nbsp;drops&nbsp;to&nbsp;0.&lt;/div&gt;&lt;div&gt;Sometimes&nbsp;even&nbsp;for&nbsp;a&nbsp;period&nbsp;of&nbsp;5&nbsp;minutes&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;I&amp;#39;m&nbsp;really&nbsp;sure&nbsp;that&nbsp;messaging&nbsp;continues&nbsp;and&nbsp;the&nbsp;statistics&nbsp;are&nbsp;a&nbsp;lie.&lt;/div&gt;&lt;div&gt;We&nbsp;use&nbsp;rabbitmq&nbsp;as&nbsp;our&nbsp;main&nbsp;communication&nbsp;hub&nbsp;and&nbsp;certainly a&nbsp;drop&nbsp;in&nbsp;real-time&nbsp;market&nbsp;data&nbsp;going&nbsp;from&nbsp;~500&nbsp;msg/s&nbsp;to&nbsp;0&nbsp;for&nbsp;about&nbsp;5&nbsp;minutes&nbsp;must&nbsp;be&nbsp;noticed&nbsp;somewhere&nbsp;if&nbsp;this&nbsp;is&nbsp;true.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;wondering&nbsp;if&nbsp;it&nbsp;might&nbsp;be&nbsp;the&nbsp;writing&nbsp;part&nbsp;of&nbsp;the&nbsp;statistics&nbsp;to&nbsp;the&nbsp;database.&nbsp;Could&nbsp;that&nbsp;timeout?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don&amp;#39;t&nbsp;really&nbsp;want&nbsp;to&nbsp;restart&nbsp;to&nbsp;see&nbsp;if&nbsp;that&nbsp;fixes&nbsp;the&nbsp;problem. &lt;/div&gt;<br>
&lt;div&gt;It&amp;#39;s&nbsp;been&nbsp;running&nbsp;for&nbsp;177&nbsp;days&nbsp;now&nbsp;and&nbsp;apart&nbsp;from&nbsp;the&nbsp;weird&nbsp;statistics&nbsp;we&nbsp;don&amp;#39;t&nbsp;have&nbsp;any&nbsp;problems.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;anything&nbsp;I&nbsp;could&nbsp;do&nbsp;as&nbsp;additional&nbsp;checks&nbsp;to&nbsp;figure&nbsp;out&nbsp;where&nbsp;the&nbsp;problem&nbsp;might&nbsp;be?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;Irmo&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Nov&nbsp;6,&nbsp;2012&nbsp;at&nbsp;12:24&nbsp;PM,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;06/11/12&nbsp;08:48,&nbsp;Irmo&nbsp;Manie&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
As&nbsp;you&nbsp;can&nbsp;see,&nbsp;the&nbsp;delivery&nbsp;(no-ack)&nbsp;rate&nbsp;drops&nbsp;to&nbsp;0&nbsp;every&nbsp;hour&nbsp;for&nbsp;a&lt;br&gt;<br>
couple&nbsp;of&nbsp;minutes.&nbsp;Other&nbsp;statistics&nbsp;on&nbsp;message&nbsp;processing&nbsp;indicate&nbsp;that&lt;br&gt;<br>
actual&nbsp;delivery/consuming&nbsp;is&nbsp;continuing,&nbsp;so&nbsp;it&nbsp;looks&nbsp;like&nbsp;it&amp;#39;s&nbsp;really&lt;br&gt;<br>
only&nbsp;the&nbsp;statistics&nbsp;that&nbsp;are&nbsp;wrong.&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;I&nbsp;look&nbsp;at&nbsp;the&nbsp;json&nbsp;output&nbsp;during&nbsp;such&nbsp;a&nbsp;&amp;#39;downtime&amp;#39;&nbsp;I&nbsp;can&nbsp;see&nbsp;that&nbsp;the&lt;br&gt;<br>
publish&nbsp;rate&nbsp;is&nbsp;always&nbsp;available,&nbsp;but&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;rates&lt;br&gt;<br>
(acknowledge,&nbsp;delivery,&nbsp;etc)&nbsp;are&nbsp;mostly&nbsp;0.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Just&nbsp;the&nbsp;rates&nbsp;in&nbsp;/api/overview&nbsp;or&nbsp;the&nbsp;ones&nbsp;in&nbsp;/api/queues&nbsp;as&nbsp;well?&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;understand&nbsp;a&nbsp;bit&nbsp;from&nbsp;the&nbsp;sources&nbsp;that&nbsp;in&nbsp;this&nbsp;/api/overview&nbsp;call&nbsp;from&lt;br&gt;<br>
the&nbsp;management&nbsp;api,&nbsp;these&nbsp;statistics&nbsp;are&nbsp;gathered&nbsp;from&nbsp;different&nbsp;places,&lt;br&gt;<br>
both&nbsp;memory&nbsp;and&nbsp;database&nbsp;(with&nbsp;additional&nbsp;calculations&nbsp;executed&nbsp;on&nbsp;them&lt;br&gt;<br>
while&nbsp;fetching),&nbsp;correct?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Yes.&nbsp;We&nbsp;get&nbsp;basic&nbsp;queue&nbsp;information&nbsp;from&nbsp;the&nbsp;Mnesia&nbsp;database,&nbsp;and&nbsp;then&nbsp;augment&nbsp;it&nbsp;with&nbsp;statistics&nbsp;information&nbsp;(including&nbsp;rates)&nbsp;from&nbsp;the&nbsp;(in-memory)&nbsp;management&nbsp;database.&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Could&nbsp;it&nbsp;be&nbsp;that&nbsp;some&nbsp;of&nbsp;these&nbsp;values&nbsp;are&nbsp;0&nbsp;because&nbsp;of&nbsp;certain&nbsp;time-outs&lt;br&gt;<br>
while&nbsp;getting&nbsp;the&nbsp;data?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
No,&nbsp;the&nbsp;requests&nbsp;for&nbsp;stats&nbsp;don&amp;#39;t&nbsp;time&nbsp;out.&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
In&nbsp;other&nbsp;words:&nbsp;do&nbsp;I&nbsp;have&nbsp;to&nbsp;start&nbsp;searching&nbsp;for&lt;br&gt;<br>
the&nbsp;problem&nbsp;at&nbsp;the&nbsp;database&nbsp;disk/IO&nbsp;level?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
No.&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;couldn&amp;#39;t&nbsp;see&nbsp;any&nbsp;IO&nbsp;waits&nbsp;on&nbsp;the&nbsp;machine&nbsp;indicating&nbsp;something&nbsp;else&nbsp;is&lt;br&gt;<br>
happening&nbsp;at&nbsp;the&nbsp;time.&nbsp;Also&nbsp;CPU&nbsp;load&nbsp;is&nbsp;normal.&lt;br&gt;<br>
Still&nbsp;the&nbsp;weird&nbsp;thing&nbsp;is&nbsp;that&nbsp;this&nbsp;also&nbsp;happens&nbsp;on&nbsp;a&nbsp;test&nbsp;machine&nbsp;at&lt;br&gt;<br>
roughly&nbsp;the&nbsp;same&nbsp;times.&lt;br&gt;<br>
Since&nbsp;both&nbsp;machines&nbsp;are&nbsp;VM&amp;#39;s,&nbsp;this&nbsp;might&nbsp;indicate&nbsp;that&nbsp;it&nbsp;could&nbsp;be&nbsp;an&lt;br&gt;<br>
infrastructural&nbsp;problem,&nbsp;but&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;be&nbsp;sure&nbsp;before&nbsp;accusing&nbsp;&amp;#39;others&amp;#39;.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
If&nbsp;/api/overview&nbsp;and&nbsp;/api/queues&nbsp;contradict&nbsp;each&nbsp;other&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;know&nbsp;about&nbsp;it.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;if&nbsp;the&nbsp;rates&nbsp;drop&nbsp;to&nbsp;0&nbsp;in&nbsp;/api/queues&nbsp;as&nbsp;well,&nbsp;Occam&amp;#39;s&nbsp;Razor&nbsp;suggests&nbsp;that&nbsp;maybe&nbsp;your&nbsp;consumers&nbsp;are&nbsp;pausing&nbsp;for&nbsp;some&nbsp;reason&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;VMware&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
