<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hello,&lt;br&gt;&lt;br&gt;&lt;/div&gt;Today,&nbsp;I&nbsp;found&nbsp;RabbitMQ&nbsp;in&nbsp;a&nbsp;non-responsive&nbsp;state.&nbsp;It&nbsp;shut&nbsp;down&nbsp;due&nbsp;to&nbsp;insufficient&nbsp;number&nbsp;of &nbsp;file&nbsp;descriptors.&nbsp;The&nbsp;reason&nbsp;was&nbsp;that&nbsp;one&nbsp;queue&nbsp;was&nbsp;overloaded&nbsp;with&nbsp;messages&nbsp;and&nbsp;RabbitMQ&nbsp;dumped&nbsp;a&nbsp;lot&nbsp;of&nbsp;messages&nbsp;into&nbsp;temp&nbsp;files,&nbsp;keeping&nbsp;them&nbsp;open.&nbsp;`lsof&#39;&nbsp;showed&nbsp;something&nbsp;like:&lt;br&gt;<br>
&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;77u  &nbsp;REG     &nbsp;251,0       &nbsp;0   &nbsp;1574055&nbsp;/var/lib/rabbitmq/mnesia/rabbit@d&lt;br&gt;bx/queues/B36DQ7YBKCJQXP3FJIJYVP8FR/journal.jif&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;78u  &nbsp;REG     &nbsp;251,0       &nbsp;0   &nbsp;1574067&nbsp;/var/lib/rabbitmq/mnesia/rabbit@d&lt;br&gt;<br>
bx/queues/E2OCOOGFQWGZ7QU7V4PDME9BU/journal.jif&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;79u  &nbsp;REG     &nbsp;251,0       &nbsp;0       &nbsp;361&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/queues/A3RS8QB81UX1HCFPVOUD9SQIF/journal.jif&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;80u  &nbsp;REG     &nbsp;251,0       &nbsp;0   &nbsp;1574069&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/queues/122SUYRH75USFEOUF8UJ1E9YP/journal.jif&lt;br&gt;<br>
beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;81u  &nbsp;REG     &nbsp;251,0       &nbsp;0   &nbsp;3411720&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/queues/90OT1K6VYE7TUBR6GI1CMU8BT/journal.jif&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;82u &nbsp;IPv6&nbsp;1449769938     &nbsp;0t0       &nbsp;TCP&nbsp;*:amqp&nbsp;(LISTEN)&lt;br&gt;<br>
beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;83r  &nbsp;REG     &nbsp;251,0&nbsp;16405205   &nbsp;2097797&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/msg_store_transient/1355.rdq&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;84r  &nbsp;REG     &nbsp;251,0&nbsp;16777279   &nbsp;2100373&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/msg_store_transient/21679.rdq&lt;br&gt;<br>
beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;85r  &nbsp;REG     &nbsp;251,0&nbsp;16777566   &nbsp;2098314&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/msg_store_transient/19328.rdq&lt;br&gt;beam.smp&nbsp;23236&nbsp;rabbitmq  &nbsp;86r  &nbsp;REG     &nbsp;251,0&nbsp;16777490   &nbsp;2097792&nbsp;/var/lib/rabbitmq/mnesia/rabbit@dbx/msg_store_transient/19025.rdq&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;These&nbsp;journal.jif&nbsp;and&nbsp;*rdq&nbsp;files&nbsp;consumed&nbsp;all&nbsp;file&nbsp;handles.&lt;br&gt;&lt;br&gt;But&nbsp;the&nbsp;strange&nbsp;thing&nbsp;was&nbsp;that&nbsp;the&nbsp;queue&nbsp;with&nbsp;50&nbsp;million&nbsp;messages&nbsp;was&nbsp;visible&nbsp;in&nbsp;the&nbsp;management&nbsp;interface,&nbsp;but&nbsp;not&nbsp;in&nbsp;`rabbitmqctl&nbsp;list_queues&#39;&nbsp;output.&nbsp;What&nbsp;might&nbsp;be&nbsp;the&nbsp;cause?&nbsp;&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;And,&nbsp;while&nbsp;we&#39;re&nbsp;at&nbsp;it,&nbsp;shouldn&#39;t&nbsp;RabbtiMQ&nbsp;close&nbsp;the&nbsp;temporary&nbsp;files&nbsp;it&nbsp;creates&nbsp;when&nbsp;there&#39;s&nbsp;not&nbsp;enough&nbsp;memory?&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thank&nbsp;you.&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;With&nbsp;best&nbsp;regards,&lt;br&gt;<br>
Dimitri&nbsp;Minaev<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
