<tt>
&lt;html&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&nbsp;id=&quot;owaParaStyle&quot;&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;fpstyle=&quot;1&quot;&nbsp;ocsi=&quot;0&quot;&gt;<br>
&lt;div&nbsp;style=&quot;direction:&nbsp;ltr;font-family:&nbsp;Tahoma;color:&nbsp;#000000;font-size:&nbsp;10pt;&quot;&gt;Hi&nbsp;Alex:<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;b&gt;the&nbsp;process&nbsp;1&nbsp;follow:&lt;/b&gt;&lt;br&gt;<br>
process_flag(trap_exit,&nbsp;true),<br>
&lt;div&gt;....&lt;/div&gt;<br>
&lt;div&gt;...&lt;/div&gt;<br>
&lt;div&gt;{ok,&nbsp;Tag,&nbsp;Pid}&nbsp;=&nbsp;tcloud_mq_amqp_func:tc_subdesc_queue(ReadChannel,&nbsp;Que,&nbsp;MFA),&nbsp;&amp;nbsp;&nbsp;%%&nbsp;subscribe&nbsp;the&nbsp;queue&nbsp;with&nbsp;process&nbsp;2&nbsp;start&nbsp;with&nbsp;MFA&lt;/div&gt;<br>
&lt;div&gt;%%&nbsp;and&nbsp;after&nbsp;this&nbsp;code,&nbsp;the&nbsp;process&nbsp;1&nbsp;do&nbsp;nothing&nbsp;but&nbsp;wait&nbsp;for&nbsp;call/cast&nbsp;&amp;nbsp;&nbsp;process&nbsp;1&nbsp;is&nbsp;a&nbsp;gen_server.&lt;/div&gt;<br>
&lt;div&gt;%%&nbsp;process&nbsp;1&nbsp;never&nbsp;do&nbsp;unbind/delete&nbsp;opertion&nbsp;to&nbsp;the&nbsp;queue&nbsp;or&nbsp;any&nbsp;other&nbsp;thing&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;b&gt;the&nbsp;process&nbsp;2&nbsp;follow:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&gt;loop()&nbsp;-&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;%%&nbsp;loop/0&nbsp;is&nbsp;the&nbsp;F&nbsp;of&nbsp;MFA&nbsp;that&nbsp;start&nbsp;the&nbsp;process&nbsp;2&lt;/div&gt;<br>
&lt;div&gt;receive&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&lt;/span&gt;Msg&nbsp;-&amp;gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&lt;/span&gt;io:format(&amp;quot;Msg:~p~n&amp;quot;,&nbsp;[Msg]),&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&lt;/span&gt;loop()&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;end&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Regard&lt;/div&gt;<br>
&lt;div&gt;David&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
________________________________________&lt;br&gt;<br>
发件人:&nbsp;Alexandru&nbsp;Scvorţov&nbsp;[scvalex@gmail.com]&nbsp;代表&nbsp;Alexandru&nbsp;Scvorţov&nbsp;[alexandru@rabbitmq.com]&lt;br&gt;<br>
发送时间:&nbsp;2012年2月10日&nbsp;17:38&lt;br&gt;<br>
到:&nbsp;Liuzhuofu&lt;br&gt;<br>
Cc:&nbsp;rabbitmq-discuss@lists.rabbitmq.com&lt;br&gt;<br>
主题:&nbsp;Re:&nbsp;[rabbitmq-discuss]&nbsp;Can't&nbsp;process_flag(trap_exit,&nbsp;true)&nbsp;in&nbsp;process&lt;br&gt;<br>
&lt;br&gt;<br>
Hi&nbsp;David,&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;create&nbsp;a&nbsp;connection&nbsp;and&nbsp;channel&nbsp;in&nbsp;process&nbsp;1,&nbsp;and&nbsp;subscribe&nbsp;a&nbsp;queue&nbsp;with&nbsp;process&nbsp;2,&nbsp;which&nbsp;created&nbsp;by&nbsp;&amp;quot;spawn_link&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;if&nbsp;I&nbsp;run&nbsp;&amp;quot;process_flag(trap_exit,&nbsp;true)&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;the&nbsp;process&nbsp;2&nbsp;will&nbsp;receive&nbsp;a&nbsp;'basic.cancel'&nbsp;message&nbsp;for&nbsp;the&nbsp;subscribe<br>
&nbsp;queue.&nbsp;If&nbsp;I&nbsp;don't&nbsp;run&nbsp;&amp;quot;process_flag(trap_exit,&nbsp;true)&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;the&nbsp;process&nbsp;2&nbsp;will&nbsp;never&nbsp;receive&nbsp;that.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;don't&nbsp;follow.&nbsp;Are&nbsp;you&nbsp;saying&nbsp;that&nbsp;running&nbsp;&amp;quot;process_flag(trap_exit,&lt;br&gt;<br>
true)&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;the&nbsp;queue&nbsp;will&nbsp;get&nbsp;deleted&nbsp;immediately&nbsp;(and&nbsp;hence&lt;br&gt;<br>
process&nbsp;2&nbsp;will&nbsp;receive&nbsp;a&nbsp;basic.cancel)?&lt;br&gt;<br>
&lt;br&gt;<br>
Could&nbsp;you&nbsp;post&nbsp;your&nbsp;code&nbsp;please?&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
Alex&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Fri,&nbsp;Feb&nbsp;10,&nbsp;2012&nbsp;at&nbsp;08:22:10AM&nbsp;&amp;#43;0000,&nbsp;Liuzhuofu&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hi&nbsp;all:&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;found&nbsp;a&nbsp;strange&nbsp;thing:&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;create&nbsp;a&nbsp;connection&nbsp;and&nbsp;channel&nbsp;in&nbsp;process&nbsp;1,&nbsp;and&nbsp;subscribe&nbsp;a&nbsp;queue&nbsp;with&nbsp;process&nbsp;2,&nbsp;which&nbsp;created&nbsp;by&nbsp;&amp;quot;spawn_link&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;if&nbsp;I&nbsp;run&nbsp;&amp;quot;process_flag(trap_exit,&nbsp;true)&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;the&nbsp;process&nbsp;2&nbsp;will&nbsp;receive&nbsp;a&nbsp;'basic.cancel'&nbsp;message&nbsp;for&nbsp;the&nbsp;subscribe<br>
&nbsp;queue.&nbsp;If&nbsp;I&nbsp;don't&nbsp;run&nbsp;&amp;quot;process_flag(trap_exit,&nbsp;true)&amp;quot;&nbsp;in&nbsp;process&nbsp;1,&nbsp;the&nbsp;process&nbsp;2&nbsp;will&nbsp;never&nbsp;receive&nbsp;that.&lt;br&gt;<br>
&amp;gt;&nbsp;Why&nbsp;?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Regards,&lt;br&gt;<br>
&amp;gt;&nbsp;David&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;rabbitmq-discuss@lists.rabbitmq.com&lt;br&gt;<br>
&amp;gt;&nbsp;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
