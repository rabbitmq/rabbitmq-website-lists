<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;We've&nbsp;been&nbsp;wrestling&nbsp;with&nbsp;this&nbsp;for&nbsp;a&nbsp;couple&nbsp;days&nbsp;and&nbsp;aren't&nbsp;any&nbsp;nearer&nbsp;a&nbsp;solution,&nbsp;so&nbsp;any&nbsp;suggestions&nbsp;would&nbsp;be&nbsp;helpful.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;have&nbsp;a&nbsp;queue&nbsp;of&nbsp;unaggregated&nbsp;data,&nbsp;hits&nbsp;per&nbsp;article.&nbsp;&nbsp;We'd&nbsp;like&nbsp;to&nbsp;have&nbsp;a&nbsp;listener&nbsp;on&nbsp;that&nbsp;queue&nbsp;collect&nbsp;messages&nbsp;for,&nbsp;say&nbsp;10,000&nbsp;messages,&nbsp;or&nbsp;ten&nbsp;minutes,&nbsp;whichever&nbsp;comes&nbsp;first,&nbsp;before&nbsp;aggregating/coalescing&nbsp;the&nbsp;data&nbsp;and&nbsp;submitting&nbsp;that&nbsp;to&nbsp;a&nbsp;second&nbsp;queue.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We've&nbsp;been&nbsp;working&nbsp;with&nbsp;python&nbsp;AMQP&nbsp;(pika)&nbsp;code&nbsp;using&nbsp;the&nbsp;pika.BlockingConnection&nbsp;and&nbsp;basic_consume,&nbsp;using&nbsp;a&nbsp;SIGALRM&nbsp;timer.&nbsp;We're&nbsp;seeing&nbsp;lots&nbsp;of&nbsp;conflicts&nbsp;between&nbsp;the&nbsp;basic_consume&nbsp;callback,&nbsp;the&nbsp;SIGALRM&nbsp;callback,&nbsp;sending&nbsp;acknowledgments&nbsp;on&nbsp;the&nbsp;incoming&nbsp;data,&nbsp;and&nbsp;sending&nbsp;the&nbsp;outgoing&nbsp;aggregated&nbsp;data&nbsp;to&nbsp;the&nbsp;second&nbsp;queue.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;After&nbsp;a&nbsp;couple&nbsp;days&nbsp;experimenting&nbsp;with&nbsp;different&nbsp;approaches,&nbsp;we&nbsp;thought&nbsp;it&nbsp;might&nbsp;be&nbsp;productive&nbsp;to&nbsp;ask&nbsp;if&nbsp;anybody&nbsp;else&nbsp;has&nbsp;already&nbsp;solved&nbsp;this&nbsp;problem&nbsp;and&nbsp;can&nbsp;suggest&nbsp;a&nbsp;strategy,&nbsp;or&nbsp;if&nbsp;anybody&nbsp;things&nbsp;pika.BlockingConnection&nbsp;is&nbsp;even&nbsp;the&nbsp;right&nbsp;tool&nbsp;for&nbsp;this?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;any&nbsp;suggestions...&lt;/div&gt;&lt;/div&gt;
</tt>
