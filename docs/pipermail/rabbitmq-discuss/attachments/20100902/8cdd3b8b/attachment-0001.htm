<tt>
Jiri&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;answered&nbsp;my&nbsp;questions.&nbsp; Now,&nbsp;as&nbsp;I&nbsp;understood&nbsp;your&nbsp;example:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;a.&nbsp;you&nbsp;don&amp;#39;t&nbsp;mind&nbsp;messages&nbsp;being&nbsp;lost &lt;/div&gt;&lt;div&gt;*and*&lt;/div&gt;&lt;div&gt;b.&nbsp;you&nbsp;don&amp;#39;t&nbsp;use&nbsp;the&nbsp;secondary&nbsp;until&nbsp;after&nbsp;the&nbsp;primary&nbsp;has&nbsp;failed.&nbsp; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Note&nbsp;that&nbsp;if&nbsp;consumption&nbsp;is&nbsp;completely&nbsp;&amp;#39;fire&nbsp;and&nbsp;forget&amp;#39;&nbsp;then&nbsp;it&nbsp;is&nbsp;possible&nbsp;that&nbsp;a&nbsp;message&nbsp;from&nbsp;the&nbsp;primary&nbsp;may&nbsp;*arrive*&nbsp;after&nbsp;a&nbsp;message&nbsp;from&nbsp;the&nbsp;secondary.&nbsp; But&nbsp;this&nbsp;can&nbsp;happen whether&nbsp;you&nbsp;use&nbsp;sequence&nbsp;numbers&nbsp;or&nbsp;not.&nbsp; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;if&nbsp;the&nbsp;primary&nbsp;broker&nbsp;fails,&nbsp;why&nbsp;not&nbsp;just&nbsp;forget&nbsp;all&nbsp;undelivered&nbsp;messages?&nbsp; Consumers&nbsp;will&nbsp;know&nbsp;that&nbsp;any&nbsp;message&nbsp;consumed&nbsp;from&nbsp;the&nbsp;secondary&nbsp;must&nbsp;be&nbsp;later&nbsp;in&nbsp;*all*&nbsp;orderings&nbsp;than&nbsp;any&nbsp;message&nbsp;consumed&nbsp;from&nbsp;the&nbsp;primary.&nbsp; So,&nbsp;additional&nbsp;sequence&nbsp;numbering&nbsp;is&nbsp;not&nbsp;necessary.&nbsp; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;alexis&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;meta&nbsp;charset=&quot;utf-8&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Sep&nbsp;2,&nbsp;2010&nbsp;at&nbsp;6:12&nbsp;PM,&nbsp;Jiri&nbsp;Krutil&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jiri@krutil.com&quot;&gt;jiri@krutil.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Alex,&lt;br&gt;<br>
&lt;br&gt;<br>
Not&nbsp;sure&nbsp;if&nbsp;I&nbsp;got&nbsp;your&nbsp;questons,&nbsp;but&nbsp;will&nbsp;try&nbsp;to&nbsp;answer...&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;2&nbsp;Sep&nbsp;2010,&nbsp;at&nbsp;18:02,&nbsp;Alexis&nbsp;Richardson&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:alexis@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;alexis@rabbitmq.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
1.&nbsp;How&nbsp;will&nbsp;out-of-order&nbsp;behaviour&nbsp;be&nbsp;observed&nbsp;in&nbsp;your&nbsp;use&nbsp;case?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Our&nbsp;client-server&nbsp;contract&nbsp;promises&nbsp;that&nbsp;requests&nbsp;from&nbsp;a&nbsp;given&nbsp;client&nbsp;will&nbsp;always&nbsp;be&nbsp;processed&nbsp;in&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;they&nbsp;were&nbsp;delivered&nbsp;to&nbsp;the&nbsp;broker.&nbsp;The&nbsp;same&nbsp;applies&nbsp;for&nbsp;the&nbsp;server&nbsp;responses.&nbsp;This&nbsp;is&nbsp;strictly&nbsp;required&nbsp;for&nbsp;our&nbsp;business.&nbsp;It&nbsp;is&nbsp;acceptable&nbsp;though&nbsp;that&nbsp;requests&nbsp;from&nbsp;different&nbsp;clients&nbsp;connected&nbsp;to&nbsp;different&nbsp;brokers&nbsp;are&nbsp;delivered&nbsp;in&nbsp;a&nbsp;different&nbsp;order.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Our&nbsp;server&nbsp;could&nbsp;detect&nbsp;out-of-order&nbsp;requests&nbsp;using&nbsp;a&nbsp;request&nbsp;sequence&nbsp;number&nbsp;and&nbsp;throw&nbsp;them&nbsp;away.&nbsp;This&nbsp;would&nbsp;however&nbsp;require&nbsp;cooperation&nbsp;from&nbsp;the&nbsp;clients&nbsp;(always&nbsp;fill&nbsp;in&nbsp;the&nbsp;seq&nbsp;no).&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
2.&nbsp;Do&nbsp;you&nbsp;plan&nbsp;to&nbsp;use&nbsp;shared&nbsp;queues,&nbsp;or&nbsp;will&nbsp;each&nbsp;queue&nbsp;have&nbsp;just&nbsp;one&nbsp;consumer&nbsp;client&nbsp;so&nbsp;that&nbsp;all&nbsp;pubsub&nbsp;happens&nbsp;using&nbsp;the&nbsp;exchange?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Clients&nbsp;receive&nbsp;broadcasts&nbsp;by&nbsp;declaring&nbsp;an&nbsp;exclusive&nbsp;queue&nbsp;and&nbsp;binding&nbsp;a&nbsp;well-known&nbsp;topic&nbsp;exchange&nbsp;to&nbsp;it.&lt;br&gt;<br>
&lt;br&gt;<br>
Requests&nbsp;are&nbsp;processed&nbsp;by&nbsp;one&nbsp;(singleton)&nbsp;service,&nbsp;possibly&nbsp;consuming&nbsp;from&nbsp;two&nbsp;brokers,&nbsp;one&nbsp;request&nbsp;queue&nbsp;per&nbsp;broker.&lt;br&gt;<br>
&lt;br&gt;<br>
Nothing&nbsp;at&nbsp;all&nbsp;is&nbsp;shared&nbsp;among&nbsp;the&nbsp;brokers.&lt;br&gt;<br>
&lt;br&gt;<br>
Regards&lt;br&gt;<br>
Jiri&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
