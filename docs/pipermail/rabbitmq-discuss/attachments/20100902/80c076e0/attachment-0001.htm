<tt>
Jiri&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;You&nbsp;say&nbsp;that&nbsp;&amp;quot;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;Some&nbsp;clients&nbsp;send&nbsp;requests&nbsp;to&nbsp;one&nbsp;broker,&nbsp;some&nbsp;to&nbsp;the&nbsp;other&amp;quot;.&nbsp; &lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;Does&nbsp;this&nbsp;mean&nbsp;that&nbsp;one&nbsp;client&nbsp;publisher&nbsp;can&nbsp;send&nbsp;messages&nbsp;(requests)&nbsp;to&nbsp;both&nbsp;brokers,&nbsp;in&nbsp;such&nbsp;a&nbsp;way&nbsp;that&nbsp;a&nbsp;pair&nbsp;of&nbsp;messages&nbsp;may&nbsp;arrive&nbsp;out&nbsp;of&nbsp;order&nbsp;if&nbsp;one&nbsp;is&nbsp;sent&nbsp;to&nbsp;each&nbsp;broker? &lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;If&nbsp;the&nbsp;answer&nbsp;is&nbsp;no,&nbsp;then&nbsp;I&nbsp;think&nbsp;my&nbsp;answer&nbsp;stands,&nbsp;because&nbsp;causal&nbsp;order&nbsp;will&nbsp;be&nbsp;preserved&nbsp;even&nbsp;if&nbsp;messages&nbsp;are&nbsp;lost.&nbsp; That&nbsp;is:&nbsp;messages&nbsp;that&nbsp;arrive&nbsp;successfully,&nbsp;will&nbsp;not&nbsp;be&nbsp;out&nbsp;of&nbsp;order&nbsp;with&nbsp;each&nbsp;other.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;If&nbsp;the&nbsp;answer&nbsp;is&nbsp;yes,&nbsp;then&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;how&nbsp;you&nbsp;can&nbsp;recover&nbsp;global&nbsp;ordering&nbsp;without&nbsp;imposing&nbsp;it&nbsp;at&nbsp;the&nbsp;publisher&nbsp;using&nbsp;sequence&nbsp;numbers&nbsp;at&nbsp;the&nbsp;app&nbsp;level.&nbsp; &lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;Does&nbsp;this&nbsp;make&nbsp;sense?&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;color:&nbsp;rgb(34,&nbsp;34,&nbsp;34);&nbsp;&quot;&gt;alexis&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#222222&quot;&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Sep&nbsp;2,&nbsp;2010&nbsp;at&nbsp;9:46&nbsp;PM,&nbsp;Jiri&nbsp;Krutil&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:jiri@krutil.com&quot;&gt;jiri@krutil.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Alexis&lt;br&gt;<br>
&lt;br&gt;<br>
Sorry&nbsp;I&nbsp;probably&nbsp;didn&amp;#39;t&nbsp;express&nbsp;myself&nbsp;well.&lt;br&gt;<br>
&lt;br&gt;<br>
We&nbsp;don&amp;#39;t&nbsp;plan&nbsp;a&nbsp;primary&nbsp;and&nbsp;secondary&nbsp;broker,&nbsp;but&nbsp;a&nbsp;pair&nbsp;of&nbsp;brokers&nbsp;that&nbsp;are&nbsp;both&nbsp;active&nbsp;at&nbsp;the&nbsp;same&nbsp;time.&nbsp;A&nbsp;load&nbsp;balancer&nbsp;divides&nbsp;client&nbsp;connections&nbsp;to&nbsp;these&nbsp;brokers.&nbsp;A&nbsp;request&nbsp;queue&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;exists&nbsp;on&nbsp;both&nbsp;brokers,&nbsp;but&nbsp;with&nbsp;different&nbsp;contents.&nbsp;Some&nbsp;clients&nbsp;send&nbsp;requests&nbsp;to&nbsp;one&nbsp;broker,&nbsp;some&nbsp;to&nbsp;the&nbsp;other.&nbsp;Our&nbsp;back-end&nbsp;server&nbsp;listens&nbsp;to&nbsp;both&nbsp;queues,&nbsp;processes&nbsp;requests&nbsp;and&nbsp;sends&nbsp;each&nbsp;response&nbsp;to&nbsp;an&nbsp;exclusive&nbsp;client&nbsp;queue&nbsp;on&nbsp;the&nbsp;broker&nbsp;from&nbsp;where&nbsp;the&nbsp;request&nbsp;came.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Ideally&nbsp;this&nbsp;would&nbsp;be&nbsp;transparent&nbsp;to&nbsp;the&nbsp;clients,&nbsp;because&nbsp;the&nbsp;brokers&nbsp;would&nbsp;be&nbsp;hidden&nbsp;by&nbsp;a&nbsp;virtual&nbsp;IP&nbsp;address.&nbsp;Of&nbsp;course&nbsp;it&nbsp;can&amp;#39;t&nbsp;be&nbsp;transparent&nbsp;to&nbsp;the&nbsp;back-end&nbsp;server,&nbsp;which&nbsp;needs&nbsp;to&nbsp;talk&nbsp;to&nbsp;both&nbsp;brokers&nbsp;at&nbsp;the&nbsp;same&nbsp;time.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
So&nbsp;(a)&nbsp;is&nbsp;correct,&nbsp;but&nbsp;(b)&nbsp;not.&lt;br&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;that&nbsp;makes&nbsp;it&nbsp;a&nbsp;bit&nbsp;clearer...&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers&lt;br&gt;<br>
Jiri&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Jiri&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;answered&nbsp;my&nbsp;questions.&nbsp; Now,&nbsp;as&nbsp;I&nbsp;understood&nbsp;your&nbsp;example:&lt;br&gt;<br>
&lt;br&gt;<br>
a.&nbsp;you&nbsp;don&amp;#39;t&nbsp;mind&nbsp;messages&nbsp;being&nbsp;lost&lt;br&gt;<br>
*and*&lt;br&gt;<br>
b.&nbsp;you&nbsp;don&amp;#39;t&nbsp;use&nbsp;the&nbsp;secondary&nbsp;until&nbsp;after&nbsp;the&nbsp;primary&nbsp;has&nbsp;failed.&lt;br&gt;<br>
&lt;br&gt;<br>
Note&nbsp;that&nbsp;if&nbsp;consumption&nbsp;is&nbsp;completely&nbsp;&amp;#39;fire&nbsp;and&nbsp;forget&amp;#39;&nbsp;then&nbsp;it&nbsp;is&nbsp;possible&nbsp;that&nbsp;a&nbsp;message&nbsp;from&nbsp;the&nbsp;primary&nbsp;may&nbsp;*arrive*&nbsp;after&nbsp;a&nbsp;message&nbsp;from&nbsp;the&nbsp;secondary.&nbsp; But&nbsp;this&nbsp;can&nbsp;happen&nbsp;whether&nbsp;you&nbsp;use&nbsp;sequence&nbsp;numbers&nbsp;or&nbsp;not.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
So&nbsp;if&nbsp;the&nbsp;primary&nbsp;broker&nbsp;fails,&nbsp;why&nbsp;not&nbsp;just&nbsp;forget&nbsp;all&nbsp;undelivered&nbsp;messages?&nbsp; Consumers&nbsp;will&nbsp;know&nbsp;that&nbsp;any&nbsp;message&nbsp;consumed&nbsp;from&nbsp;the&nbsp;secondary&nbsp;must&nbsp;be&nbsp;later&nbsp;in&nbsp;*all*&nbsp;orderings&nbsp;than&nbsp;any&nbsp;message&nbsp;consumed&nbsp;from&nbsp;the&nbsp;primary.&nbsp; So,&nbsp;additional&nbsp;sequence&nbsp;numbering&nbsp;is&nbsp;not&nbsp;necessary.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
alexis&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
