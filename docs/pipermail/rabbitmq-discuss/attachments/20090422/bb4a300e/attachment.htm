<tt>
Is&nbsp;there&nbsp;a&nbsp;way&nbsp;to&nbsp;make&nbsp;them&nbsp;disk-only?&lt;br&gt;&lt;br&gt;I&nbsp;tried&nbsp;the&nbsp;updated&nbsp;version&nbsp;with&nbsp;the&nbsp;persistent&nbsp;switch&nbsp;and&nbsp;it&nbsp;died&nbsp;after&nbsp;a&nbsp;million&nbsp;messages&nbsp;as&nbsp;well,&nbsp;unfortunately.&lt;br&gt;&lt;i&gt;&lt;br&gt;for(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;LIMIT;&nbsp;i++)&nbsp;{&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;String&nbsp;msg&nbsp;=&nbsp;createMessageText(i);&lt;br&gt;<br>
   &nbsp;   &nbsp;   &nbsp;   &nbsp;byte[]&nbsp;bytes&nbsp;=&nbsp;msg.getBytes();&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;   &nbsp;channel.basicPublish(exchange,&nbsp;key,&nbsp;true,&nbsp;false,&nbsp;&lt;b&gt;MessageProperties.PERSISTENT_TEXT_PLAIN,&lt;/b&gt;&nbsp;bytes);&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;&lt;br&gt;   &nbsp;   &nbsp;   &nbsp;}&lt;/i&gt;&lt;br&gt;<br>
&lt;br&gt;We&nbsp;get&nbsp;this&nbsp;on&nbsp;the&nbsp;Java&nbsp;side:&lt;br&gt;&lt;br&gt;java.net.SocketException:&nbsp;Broken&nbsp;pipe&lt;br&gt;   &nbsp;at&nbsp;java.net.SocketOutputStream.socketWrite0(Native&nbsp;Method)&lt;br&gt;   &nbsp;at&nbsp;java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)&lt;br&gt;<br>
   &nbsp;at&nbsp;java.net.SocketOutputStream.write(SocketOutputStream.java:136)&lt;br&gt;   &nbsp;at&nbsp;java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)&lt;br&gt;   &nbsp;at&nbsp;java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)&lt;br&gt;<br>
   &nbsp;at&nbsp;java.io.DataOutputStream.flush(DataOutputStream.java:106)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.SocketFrameHandler.writeFrame(SocketFrameHandler.java:164)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQConnection.writeFrame(AMQConnection.java:302)&lt;br&gt;<br>
   &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQCommand.transmit(AMQCommand.java:197)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel.quiescingTransmit(AMQChannel.java:309)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel.transmit(AMQChannel.java:285)&lt;br&gt;<br>
   &nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.basicPublish(ChannelN.java:392)&lt;br&gt;   &nbsp;at&nbsp;test.RabbitMQProducer.main(RabbitMQProducer.java:57)&lt;br&gt;Exception&nbsp;in&nbsp;thread&nbsp;&amp;quot;main&amp;quot;&nbsp;com.rabbitmq.client.AlreadyClosedException&nbsp;(clean&nbsp;connection&nbsp;shutdown;&nbsp;reason:&nbsp;Attempt&nbsp;to&nbsp;use&nbsp;closed&nbsp;channel)&lt;br&gt;<br>
   &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel.ensureIsOpen(AMQChannel.java:189)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.AMQChannel.processShutdownSignal(AMQChannel.java:257)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.processShutdownSignal(ChannelN.java:164)&lt;br&gt;<br>
   &nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.close(ChannelN.java:337)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.close(ChannelN.java:291)&lt;br&gt;   &nbsp;at&nbsp;com.rabbitmq.client.impl.ChannelN.close(ChannelN.java:285)&lt;br&gt;   &nbsp;at&nbsp;test.RabbitMQProducer.main(RabbitMQProducer.java:73)&lt;br&gt;<br>
&lt;br&gt;and&nbsp;{badrpc,nodedown}&nbsp;when&nbsp;querying&nbsp;for&nbsp;status.&lt;br&gt;&lt;br&gt;Jacek&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Apr&nbsp;22,&nbsp;2009&nbsp;at&nbsp;9:40&nbsp;AM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@lshift.net&quot;&gt;matthias@lshift.net&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Jacek,&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Jacek&nbsp;Furmankiewicz&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Ah,&nbsp;I&nbsp;missed&nbsp;that.&nbsp;I&nbsp;guess&nbsp;that&nbsp;relates&nbsp;to&nbsp;this&nbsp;part&nbsp;of&nbsp;the&nbsp;docs?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Yes,&nbsp;but&nbsp;if&nbsp;your&nbsp;messages&nbsp;don&amp;#39;t&nbsp;fit&nbsp;into&nbsp;memory&nbsp;when&nbsp;not&nbsp;marked&nbsp;as&nbsp;persistent&nbsp;then&nbsp;they&nbsp;sure&nbsp;won&amp;#39;t&nbsp;fit&nbsp;when&nbsp;they&nbsp;are&nbsp;-&nbsp;as&nbsp;Alexis&nbsp;said,&nbsp;persistent&nbsp;messages&nbsp;are&nbsp;kept&nbsp;in&nbsp;*both*&nbsp;memory&nbsp;and&nbsp;disk.&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Matthias.&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
