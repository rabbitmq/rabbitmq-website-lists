<tt>
I&nbsp;am&nbsp;trying&nbsp;to&nbsp;get&nbsp;pub-sub&nbsp;model&nbsp;to&nbsp;work&nbsp;in&nbsp;rabbitmq.&amp;nbsp;&nbsp;My&nbsp;understanding&nbsp;is&nbsp;that&nbsp;you&nbsp;still&nbsp;have&nbsp;to&nbsp;perform&nbsp;amqp_connection:start,&nbsp;amqp_connection:open_channel,&nbsp;amqp_channel:call(Channel,&nbsp;Access),&nbsp;channel&nbsp;close&nbsp;and&nbsp;connection&nbsp;close&nbsp;on&nbsp;each&nbsp;async&nbsp;call.&nbsp;&lt;br&gt;<br>
I&nbsp;am&nbsp;not&nbsp;sure&nbsp;what&nbsp;payload_fragments_rev&nbsp;=&nbsp;[Payload]&nbsp;is&nbsp;for.&amp;nbsp;&nbsp;I&nbsp;have&nbsp;searched&nbsp;through&nbsp;amqp&nbsp;xml&nbsp;specs&nbsp;and&nbsp;pdf.&amp;nbsp;&nbsp;Maybe&nbsp;I&nbsp;am&nbsp;not&nbsp;hitting&nbsp;the&nbsp;right&nbsp;keywords.&amp;nbsp;&nbsp;For&nbsp;pub-sub&nbsp;model,&nbsp;how&nbsp;do&nbsp;you&nbsp;assign&nbsp;the&nbsp;message,&nbsp;assign&nbsp;it&nbsp;to&nbsp;Payload&nbsp;variable?&lt;br&gt;<br>
&lt;br&gt;I&nbsp;am&nbsp;new&nbsp;to&nbsp;erlang.&amp;nbsp;&nbsp;This&nbsp;shouldn&amp;#39;t&nbsp;be&nbsp;a&nbsp;show&nbsp;stopper.&amp;nbsp;&nbsp;I&nbsp;just&nbsp;need&nbsp;to&nbsp;get&nbsp;this&nbsp;working.&amp;nbsp;&nbsp;I&nbsp;am&nbsp;getting&nbsp;following&nbsp;error:&lt;br&gt;&lt;br&gt;(rabbit@home)1&amp;gt;&nbsp;amqp_async:amqp_lifecycle().&lt;br&gt;<br>
Connection:&nbsp;{&amp;lt;0.217.0&amp;gt;,direct}&lt;br&gt;<br>
&lt;br&gt;<br>
=ERROR&nbsp;REPORT====&nbsp;6-Apr-2008::16:33:51&nbsp;===&lt;br&gt;<br>
Lax&nbsp;ticket&nbsp;check&nbsp;mode:&nbsp;ignoring&nbsp;cross-realm&nbsp;access&nbsp;for&nbsp;ticket&nbsp;101&lt;br&gt;<br>
**&nbsp;exception&nbsp;exit:&nbsp;{{amqp,not_found,&amp;#39;basic.publish&amp;#39;},&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{gen_server,call,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[&amp;lt;0.218.0&amp;gt;,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{call,{&amp;#39;channel.close&amp;#39;,200,&amp;lt;&amp;lt;&amp;quot;Goodbye&amp;quot;&amp;gt;&amp;gt;,0,0}}]}}&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;in&nbsp;function&amp;nbsp;&nbsp;gen_server:call/2&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;in&nbsp;call&nbsp;from&nbsp;amqp_async:amqp_lifecycle/0&lt;br&gt;&lt;br&gt;my&nbsp;pub-sub&nbsp;code:&lt;br&gt;&lt;br&gt;-module(amqp_async).&lt;br&gt;&lt;br&gt;-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;br&gt;-include_lib(&amp;quot;rabbitmq_server/include/rabbit.hrl&amp;quot;).&lt;br&gt;<br>
&lt;br&gt;-export([amqp_lifecycle/0]).&lt;br&gt;&lt;br&gt;amqp_lifecycle()&nbsp;-&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;User&nbsp;=&nbsp;Password&nbsp;=&nbsp;&amp;quot;guest&amp;quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Realm&nbsp;=&nbsp;&amp;lt;&amp;lt;&amp;quot;/data&amp;quot;&amp;gt;&amp;gt;,&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;%%&nbsp;Start&nbsp;a&nbsp;connection&nbsp;to&nbsp;the&nbsp;server&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Connection&nbsp;=&nbsp;amqp_connection:start(User,&nbsp;Password),&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;io:format(&amp;quot;Connection:&nbsp;~p~n&amp;quot;,[Connection]),&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;%%&nbsp;Once&nbsp;you&nbsp;have&nbsp;a&nbsp;connection&nbsp;to&nbsp;the&nbsp;server,&nbsp;you&nbsp;can&nbsp;start&nbsp;an&nbsp;AMQP&nbsp;channel&nbsp;gain&nbsp;access&nbsp;to&nbsp;a&nbsp;realm&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Channel&nbsp;=&nbsp;amqp_connection:open_channel(Connection),&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Access&nbsp;=&nbsp;#&amp;#39;access.request&amp;#39;{realm&nbsp;=&nbsp;Realm,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;exclusive&nbsp;=&nbsp;false,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;passive&nbsp;=&nbsp;true,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;active&nbsp;=&nbsp;true,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;write&nbsp;=&nbsp;true,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;read&nbsp;=&nbsp;true},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&amp;#39;access.request_ok&amp;#39;{ticket&nbsp;=&nbsp;Ticket}&nbsp;=&nbsp;amqp_channel:call(Channel,&nbsp;Access),&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;X&nbsp;=&nbsp;&amp;lt;&amp;lt;&amp;quot;x&amp;quot;&amp;gt;&amp;gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;RoutingKey&nbsp;=&nbsp;&amp;lt;&amp;lt;&amp;quot;a.b.c.*&amp;quot;&amp;gt;&amp;gt;,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Payload&nbsp;=&nbsp;&amp;lt;&amp;lt;&amp;quot;foobar&amp;quot;&amp;gt;&amp;gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;BasicPublish&nbsp;=&nbsp;#&amp;#39;basic.publish&amp;#39;{ticket&nbsp;=&nbsp;Ticket,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;exchange&nbsp;=&nbsp;X,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;routing_key&nbsp;=&nbsp;RoutingKey,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;mandatory&nbsp;=&nbsp;false,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;immediate&nbsp;=&nbsp;false},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Content&nbsp;=&nbsp;#content{class_id&nbsp;=&nbsp;60,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;properties&nbsp;=&nbsp;amqp_util:basic_properties(),&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;properties_bin&nbsp;=&nbsp;none,&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;payload_fragments_rev&nbsp;=&nbsp;[Payload]&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;amqp_channel:cast(Channel,&nbsp;BasicPublish,&nbsp;Content),&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;%%&nbsp;After&nbsp;you&amp;#39;ve&nbsp;finished&nbsp;with&nbsp;the&nbsp;channel&nbsp;and&nbsp;connection&nbsp;you&nbsp;should&nbsp;close&nbsp;them&nbsp;down&lt;br&gt;<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ChannelClose&nbsp;=&nbsp;#&amp;#39;channel.close&amp;#39;{reply_code&nbsp;=&nbsp;200,&nbsp;reply_text&nbsp;=&nbsp;&amp;lt;&amp;lt;&amp;quot;Goodbye&amp;quot;&amp;gt;&amp;gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;class_id&nbsp;=&nbsp;0,&nbsp;method_id&nbsp;=&nbsp;0},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&amp;#39;channel.close_ok&amp;#39;{}&nbsp;=&nbsp;amqp_channel:call(Channel,&nbsp;ChannelClose),&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ConnectionClose&nbsp;=&nbsp;#&amp;#39;connection.close&amp;#39;{reply_code&nbsp;=&nbsp;200,&nbsp;reply_text&nbsp;=&nbsp;&amp;lt;&amp;lt;&amp;quot;Goodbye&amp;quot;&amp;gt;&amp;gt;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;class_id&nbsp;=&nbsp;0,&nbsp;method_id&nbsp;=&nbsp;0},&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&amp;#39;connection.close_ok&amp;#39;{}&nbsp;=&nbsp;amqp_connection:close(Connection,&nbsp;ConnectionClose),&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ok.&lt;br&gt;&lt;br&gt;Thank&nbsp;you,&lt;br&gt;Joe&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
