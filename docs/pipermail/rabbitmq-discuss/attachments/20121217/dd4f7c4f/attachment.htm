<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;So&nbsp;we&amp;#39;re&nbsp;doing&nbsp;some&nbsp;active&nbsp;investigation&nbsp;regarding&nbsp;connection&nbsp;resets&nbsp;in&nbsp;Rabbit&nbsp;connections.&nbsp; It&nbsp;turns&nbsp;out&nbsp;that&nbsp;the&nbsp;F5&nbsp;load&nbsp;balancers&nbsp;we&nbsp;use&nbsp;have&nbsp;been&nbsp;configured&nbsp;with&nbsp;a&nbsp;tcp&nbsp;idle&nbsp;timeout&nbsp;at&nbsp;300&nbsp;seconds,&nbsp;causing&nbsp;connection&nbsp;reset&nbsp;warnings&nbsp;every&nbsp;5&nbsp;minutes&nbsp;for&nbsp;our&nbsp;connections&nbsp;to&nbsp;the&nbsp;rabbit&nbsp;boxes.&nbsp; The&nbsp;F5&nbsp;load&nbsp;balancers&nbsp;act&nbsp;as&nbsp;a&nbsp;proxy,&nbsp;not&nbsp;a&nbsp;router/gateway&nbsp;on&nbsp;TCP/IP&nbsp;connections&nbsp;and&nbsp;so&nbsp;have&nbsp;some&nbsp;pretty&nbsp;specific&nbsp;timeouts&nbsp;and&nbsp;rules.&nbsp; The&nbsp;question&nbsp;comes&nbsp;in&nbsp;has&nbsp;anyone&nbsp;else&nbsp;been&nbsp;using&nbsp;F5&nbsp;boxes&nbsp;to&nbsp;virtualize&nbsp;their&nbsp;connections&nbsp;to&nbsp;a&nbsp;Rabbit&nbsp;cluster,&nbsp;and&nbsp;if&nbsp;so&nbsp;what&nbsp;settings&nbsp;do&nbsp;you&nbsp;use&nbsp;including&nbsp;monitors/resets/etc.?&nbsp; From&nbsp;what&nbsp;I&amp;#39;ve&nbsp;been&nbsp;told,&nbsp;most&nbsp;network&nbsp;devices&nbsp;drop&nbsp;TCP/IP&nbsp;connections&nbsp;after&nbsp;an&nbsp;hour&nbsp;automatically&nbsp;(i.e.&nbsp;switches,&nbsp;routers,&nbsp;etc.)&nbsp;and&nbsp;force&nbsp;a&nbsp;reconnect&nbsp;-&nbsp;not&nbsp;sure&nbsp;if&nbsp;Rabbit&nbsp;handles&nbsp;this?&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;is&nbsp;a&nbsp;work&nbsp;around&nbsp;at&nbsp;the&nbsp;moment&nbsp;we&amp;#39;re&nbsp;looking&nbsp;into.&nbsp; It&nbsp;looks&nbsp;like&nbsp;most&nbsp;(if&nbsp;not&nbsp;all)&nbsp;Rabbit&nbsp;interfaces&nbsp;have&nbsp;a&nbsp;heartbeat&nbsp;setting&nbsp;that&nbsp;would&nbsp;allow&nbsp;connections&nbsp;to&nbsp;be&nbsp;maintained&nbsp;with&nbsp;that&nbsp;reset&nbsp;still&nbsp;on,&nbsp;but&nbsp;that&nbsp;means&nbsp;setting&nbsp;every&nbsp;client&nbsp;and&nbsp;server&nbsp;would&nbsp;need&nbsp;to&nbsp;be&nbsp;configured&nbsp;with&nbsp;a&nbsp;heartbeat&nbsp;to&nbsp;generate&nbsp;at&nbsp;least&nbsp;some&nbsp;traffic.&nbsp; I&amp;#39;d&nbsp;have&nbsp;figured&nbsp;if&nbsp;nothing&nbsp;else&nbsp;there&nbsp;would&nbsp;have&nbsp;been&nbsp;some&nbsp;messages&nbsp;going&nbsp;back&nbsp;and&nbsp;forth&nbsp;between&nbsp;a&nbsp;client&nbsp;and&nbsp;server,&nbsp;if&nbsp;nothing&nbsp;else&nbsp;to&nbsp;say&nbsp;&amp;quot;Still&nbsp;no&nbsp;new&nbsp;messages&nbsp;-&nbsp;no&nbsp;one&nbsp;loves&nbsp;you.&amp;quot;&nbsp; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Other&nbsp;questions&nbsp;related&nbsp;to&nbsp;the&nbsp;above:&nbsp; Is&nbsp;the&nbsp;AMQP&nbsp;protocol&nbsp;designed&nbsp;to&nbsp;have&nbsp;the&nbsp;clients&nbsp;just&nbsp;sit&nbsp;idle,&nbsp;no&nbsp;communication&nbsp;with&nbsp;the&nbsp;servers&nbsp;until&nbsp;a&nbsp;message&nbsp;comes&nbsp;in&nbsp;(which&nbsp;from&nbsp;TCP&nbsp;Dumps&nbsp;appears&nbsp;to&nbsp;be&nbsp;what&amp;#39;s&nbsp;happening&nbsp;though&nbsp;perhaps&nbsp;I&amp;#39;ve&nbsp;not&nbsp;waited&nbsp;long&nbsp;enough)?&nbsp; How&nbsp;long&nbsp;would&nbsp;they&nbsp;sit&nbsp;idle&nbsp;by&nbsp;default&nbsp;before&nbsp;asking&nbsp;&amp;quot;hey,&nbsp;server,&nbsp;you&nbsp;still&nbsp;alive&nbsp;and&nbsp;connected&nbsp;to&nbsp;me?&amp;quot;&nbsp; If&nbsp;there&nbsp;is&nbsp;no&nbsp;check,&nbsp;and&nbsp;the&nbsp;client&nbsp;hasn&amp;#39;t&nbsp;received&nbsp;a&nbsp;message&nbsp;in&nbsp;a&nbsp;day&nbsp;at&nbsp;what&nbsp;point&nbsp;do&nbsp;you&nbsp;retry&nbsp;your&nbsp;connection&nbsp;to&nbsp;verify&nbsp;you&amp;#39;re&nbsp;even&nbsp;still&nbsp;connected?&nbsp; It&nbsp;sounds&nbsp;like&nbsp;in&nbsp;this&nbsp;case&nbsp;you&nbsp;could&nbsp;have&nbsp;a&nbsp;consumer&nbsp;of&nbsp;a&nbsp;queue&nbsp;lose&nbsp;it&amp;#39;s&nbsp;connection&nbsp;and&nbsp;never&nbsp;realize&nbsp;that&nbsp;it&amp;#39;s&nbsp;lost,&nbsp;because&nbsp;it&amp;#39;s&nbsp;just&nbsp;sitting&nbsp;idle&nbsp;waiting&nbsp;for&nbsp;responses.&nbsp; Then&nbsp;you&amp;#39;d&nbsp;have&nbsp;a&nbsp;server&nbsp;just&nbsp;sitting&nbsp;backlogging&nbsp;messages&nbsp;waiting&nbsp;for&nbsp;a&nbsp;client&nbsp;(or&nbsp;worse&nbsp;depending&nbsp;on&nbsp;configuration,&nbsp;just&nbsp;dropping&nbsp;all&nbsp;the&nbsp;messages).&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Just&nbsp;trying&nbsp;to&nbsp;get&nbsp;a&nbsp;low&nbsp;level&nbsp;idea&nbsp;of&nbsp;how&nbsp;the&nbsp;TCP/IP&nbsp;communications&nbsp;work&nbsp;between&nbsp;clients&nbsp;and&nbsp;the&nbsp;rabbit&nbsp;servers&nbsp;and&nbsp;configuration&nbsp;ideas&nbsp;and&nbsp;how&nbsp;to&nbsp;setup&nbsp;load&nbsp;balancers&nbsp;to&nbsp;work&nbsp;with&nbsp;Rabbit.&nbsp; Looked&nbsp;at&nbsp;the&nbsp;AMQP&nbsp;0-9-1&nbsp;specifications&nbsp;and&nbsp;not&nbsp;seeing&nbsp;a&nbsp;whole&nbsp;lot&nbsp;defined&nbsp;on&nbsp;how&nbsp;AMQP implementers are&nbsp;supposed&nbsp;to&nbsp;work&nbsp;with&nbsp;TCP/IP&nbsp;traffic&nbsp;(other&nbsp;than&nbsp;some&nbsp;heartbeat&nbsp;definitions).&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Thanks!&lt;br&gt;Jason&lt;/div&gt;&lt;/div&gt;<br>

</tt>
