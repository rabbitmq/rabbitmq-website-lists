<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&nbsp;Ben,&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;simplified&nbsp;my&nbsp;code&nbsp;significantly&nbsp;by&nbsp;using&nbsp;SubscribeClient&nbsp;class.&amp;nbsp;&nbsp;Thanks&nbsp;for&nbsp;the&nbsp;great&nbsp;help.&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;However,&nbsp;I&nbsp;am&nbsp;still&nbsp;getting&nbsp;&amp;quot;Calling&nbsp;handleForcedShutdown&nbsp;from&nbsp;connection&nbsp;forceClose&nbsp;called&amp;quot;.&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;code&nbsp;I&nbsp;am&nbsp;using.&amp;nbsp;&nbsp;By&nbsp;the&nbsp;way,&nbsp;I&nbsp;am&nbsp;assuming&nbsp;the&nbsp;first&nbsp;argument&nbsp;for&nbsp;.subscribe()&nbsp;refers&nbsp;to&nbsp;the&nbsp;routing&nbsp;key.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;public&nbsp;function&nbsp;init():void&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;trace(&amp;quot;test&nbsp;sub&nbsp;init&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;connection&nbsp;=&nbsp;new&nbsp;Connection(buildConnectionState());&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;subClient&nbsp;=&nbsp;new&nbsp;SubscribeClientImpl(connection);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;subClient.serializer&nbsp;=&nbsp;serializer;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;subClient.exchange&nbsp;=&nbsp;&amp;quot;&amp;quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;subClient.exchangeType&nbsp;=&nbsp;&amp;quot;topic&amp;quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;subClient.subscribe(&amp;quot;SimpleQueue&amp;quot;,&nbsp;onMessageArrive);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;subClient.subscribe(&amp;quot;SimpleQueue&amp;quot;,&nbsp;onMessageArrive);&lt;/div&gt;<br>
<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;public&nbsp;function&nbsp;buildConnectionState():ConnectionState&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;var&nbsp;state:ConnectionState&nbsp;=&nbsp;new&nbsp;ConnectionState();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;state.username&nbsp;=&nbsp;&amp;quot;guest&amp;quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;state.password&nbsp;=&nbsp;&amp;quot;guest&amp;quot;;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;state.vhostpath&nbsp;=&nbsp;&amp;quot;/&amp;quot;;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;state.serverhost&nbsp;=&nbsp;&amp;quot;&lt;a&nbsp;href=&quot;http://192.168.1.104&quot;&gt;192.168.1.104&lt;/a&gt;&amp;quot;;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return&nbsp;state;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;public&nbsp;function&nbsp;onMessageArrive(event:CorrelatedMessageEvent):void&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;trace(&amp;quot;Consumed&nbsp;message&nbsp;from&nbsp;ABC&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;var&nbsp;o:*&nbsp;=&nbsp;event.result;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;trace(&amp;quot;message&nbsp;=&nbsp;&amp;quot;&nbsp;+&nbsp;o.msg);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;Any&nbsp;idea&nbsp;why&nbsp;I&nbsp;can&amp;#39;t&nbsp;connect?&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;alot&nbsp;for&nbsp;your&nbsp;help.&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;Best&nbsp;Regards,&lt;/div&gt;<br>
&lt;div&gt;Anne&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
