<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Nov&nbsp;20,&nbsp;2013&nbsp;at&nbsp;12:04&nbsp;PM,&nbsp;Matthias&nbsp;Radestock&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthias@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;matthias@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Fair&nbsp;enough,&nbsp;though&nbsp;note&nbsp;that&nbsp;your&nbsp;problems&nbsp;were&nbsp;with&nbsp;mirrored&nbsp;queues,&lt;br&gt;<br>
not&nbsp;the&nbsp;persistence&nbsp;mechanisms.&nbsp;Very&nbsp;few&nbsp;bugs&nbsp;have&nbsp;been&nbsp;found&nbsp;in&nbsp;the&lt;br&gt;<br>
persister&nbsp;in&nbsp;the&nbsp;last&nbsp;few&nbsp;years.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gotcha.&nbsp;I&nbsp;can&amp;#39;t&nbsp;really&nbsp;imagine&nbsp;a&nbsp;situation&nbsp;where&nbsp;you&amp;#39;d&nbsp;actually&nbsp;want&nbsp;single&nbsp;machine&nbsp;persistence&nbsp;(ie&nbsp;persistent&nbsp;queues&nbsp;without&nbsp;HA),&nbsp;but&nbsp;I&nbsp;guess&nbsp;I&amp;#39;m&nbsp;fairly&nbsp;risk&nbsp;averse.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;/div&gt;<br>
The&nbsp;main&nbsp;reason&nbsp;for&nbsp;the&nbsp;disclaimer&nbsp;is&nbsp;the&nbsp;difficulty&nbsp;in&nbsp;explaining&nbsp;when&nbsp;one&nbsp;would&nbsp;want&nbsp;to&nbsp;change&nbsp;that&nbsp;value&nbsp;and&nbsp;what&nbsp;impact&nbsp;doing&nbsp;so&nbsp;might&nbsp;have.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;if&nbsp;you&nbsp;believe&nbsp;that&nbsp;the&nbsp;default&nbsp;msg_store&nbsp;file&nbsp;size&nbsp;is&nbsp;hurting&lt;br&gt;<br>
performance&nbsp;significantly,&nbsp;then&nbsp;experimenting&nbsp;with&nbsp;different&nbsp;values&nbsp;is&lt;br&gt;<br>
definitely&nbsp;worthwhile.&nbsp;Let&nbsp;us&nbsp;know&nbsp;what&nbsp;you&nbsp;find.&nbsp;Perhaps&nbsp;then&nbsp;we&nbsp;can&lt;br&gt;<br>
give&nbsp;some&nbsp;better&nbsp;guidance&nbsp;to&nbsp;our&nbsp;users&nbsp;than&nbsp;&amp;quot;don&amp;#39;t&nbsp;touch&nbsp;this&amp;quot;.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sounds&nbsp;good.&nbsp;I&amp;#39;ll&nbsp;try&nbsp;to&nbsp;generate&nbsp;a&nbsp;synthetic&nbsp;workload&nbsp;on&nbsp;disk&nbsp;based&nbsp;systems&nbsp;and&nbsp;graph&nbsp;the&nbsp;change&nbsp;in&nbsp;rabbitmq&nbsp;delivery&nbsp;performance.&nbsp;Certainly&nbsp;we&nbsp;know&nbsp;that&nbsp;apps&nbsp;like&nbsp;Riak,&nbsp;with&nbsp;its&nbsp;universal&nbsp;append-only&nbsp;datastore,&nbsp;see&nbsp;a&nbsp;much&nbsp;smaller&nbsp;margin&nbsp;of&nbsp;advantage&nbsp;with&nbsp;SSDs&nbsp;over&nbsp;spinning&nbsp;disks&nbsp;compared&nbsp;to&nbsp;what&nbsp;we&amp;#39;re&nbsp;seeing&nbsp;with&nbsp;RabbitMQ&nbsp;on&nbsp;our&nbsp;disk&nbsp;vs&nbsp;SSD&nbsp;nodes.&nbsp;However,&nbsp;I&nbsp;understand&nbsp;what&nbsp;its&nbsp;data&nbsp;store&nbsp;is&nbsp;doing&nbsp;a&nbsp;lot&nbsp;better&nbsp;than&nbsp;I&nbsp;understand&nbsp;what&nbsp;RabbitMQ&nbsp;is&nbsp;doing.&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;instance:&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;Does&nbsp;RabbitMQ&nbsp;have&nbsp;a&nbsp;compaction&nbsp;step&nbsp;like&nbsp;bitcask&nbsp;or&nbsp;innodb,&nbsp;where&nbsp;after&nbsp;writing&nbsp;a&nbsp;certain&nbsp;amount&nbsp;of&nbsp;append-only&nbsp;work,&nbsp;it&nbsp;coalesces&nbsp;this&nbsp;to&nbsp;a&nbsp;more&nbsp;efficient&nbsp;on&nbsp;disk&nbsp;format?&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;-&nbsp;How&nbsp;are&nbsp;deletes&nbsp;handled&nbsp;on&nbsp;queues&nbsp;that&nbsp;don&amp;#39;t&nbsp;fully&nbsp;drain?&nbsp;If&nbsp;I&nbsp;increase&nbsp;the&nbsp;message&nbsp;store&nbsp;size&nbsp;to&nbsp;500&nbsp;MiB,&nbsp;but&nbsp;the&nbsp;queues&nbsp;they&nbsp;represent&nbsp;are&nbsp;never&nbsp;fully&nbsp;emptied,&nbsp;will&nbsp;they&nbsp;just&nbsp;grow&nbsp;to&nbsp;max&nbsp;queue&nbsp;size&nbsp;and&nbsp;stay&nbsp;there&nbsp;like&nbsp;InnoDB&nbsp;on&nbsp;disk&nbsp;files?&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Graeme&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
