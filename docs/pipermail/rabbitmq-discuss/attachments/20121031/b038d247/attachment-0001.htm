<tt>
Hey&nbsp;guys&nbsp;-&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;seeing&nbsp;some&nbsp;unexpected&nbsp;behaviors&nbsp;with&nbsp;lost&nbsp;messages&nbsp;and&nbsp;I&nbsp;wanted&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;this&nbsp;is&nbsp;intended&nbsp;by&nbsp;RabbitMQ.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;queue&nbsp;called&nbsp;&amp;quot;messages.log&amp;quot;&nbsp;set&nbsp;up&nbsp;with&nbsp;the&nbsp;following&nbsp;configuration:&lt;/div&gt;<br>
<br>
&lt;div&gt;*&nbsp;x-message-ttl:&nbsp;15000&nbsp;(15s)&lt;/div&gt;&lt;div&gt;* x-dead-letter-exchange:&nbsp;messages.retry&lt;/div&gt;&lt;div&gt;*&nbsp;durable:&nbsp;true&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;expectation&nbsp;is&nbsp;that&nbsp;when&nbsp;I&nbsp;publish&nbsp;a&nbsp;persistent message&nbsp;to&nbsp;&amp;quot;messages.log&amp;quot;&nbsp;it&nbsp;will&nbsp;sit&nbsp;in&nbsp;the&nbsp;queue&nbsp;for&nbsp;15s,&nbsp;after&nbsp;which&nbsp;point&nbsp;it&amp;#39;ll&nbsp;be&nbsp;dead-lettered&nbsp;into&nbsp;the&nbsp;&amp;quot;messages.retry&amp;quot;&nbsp;exchange.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&amp;#39;m&nbsp;seeing&nbsp;the&nbsp;following&nbsp;behaviors:&lt;/div&gt;&lt;div&gt;*&nbsp;When&nbsp;a&nbsp;persistent&nbsp;message&nbsp;is&nbsp;published&nbsp;to&nbsp;&amp;quot;messages.log&amp;quot;,&nbsp;after&nbsp;15s&nbsp;it&nbsp;gets&nbsp;delivered&nbsp;to&nbsp;the&nbsp;&amp;quot;messages.retry&amp;quot;&nbsp;exchange&nbsp;and&nbsp;lands&nbsp;into&nbsp;the&nbsp;queue&nbsp;bound&nbsp;to&nbsp;that&nbsp;exchange.&lt;/div&gt;<br>
<br>
&lt;div&gt;* When a persistent message&nbsp;is&nbsp;published&nbsp;to&nbsp;&amp;quot;messages.log&amp;quot;&nbsp;and&nbsp;the&nbsp;rabbitmq&nbsp;process&nbsp;then&nbsp;gets&nbsp;force-stopped&nbsp;for&nbsp;less&nbsp;than&nbsp;15s&nbsp;(i.e.&nbsp;total&nbsp;time&nbsp;for&nbsp;stopping&nbsp;and&nbsp;starting&nbsp;rabbitmq&nbsp;is&nbsp;less&nbsp;than&nbsp;15s),&nbsp;the&nbsp;message&nbsp;is&nbsp;still&nbsp;in&nbsp;&amp;quot;messages.log&amp;quot;&nbsp;and&nbsp;eventually&nbsp;gets&nbsp;delivered&nbsp;to&nbsp;the&nbsp;&amp;quot;messages.retry&amp;quot;&nbsp;exchange&nbsp;when&nbsp;the&nbsp;TTL&nbsp;is&nbsp;hit&lt;/div&gt;<br>
<br>
&lt;div&gt;*&nbsp;&lt;b&gt;However&lt;/b&gt;,&nbsp;when&nbsp;a persistent message&nbsp;is&nbsp;published&nbsp;to&nbsp;&amp;quot;messages.log&amp;quot;&nbsp;and&nbsp;the&nbsp;rabbitmq&nbsp;process&nbsp;then&nbsp;gets&nbsp;force-stopped&nbsp;for&nbsp;&lt;u&gt;more&nbsp;than&nbsp;15s&lt;/u&gt;,&nbsp;the&nbsp;message&nbsp;disappears.&nbsp; It&amp;#39;s&nbsp;not&nbsp;in&nbsp;&amp;quot;messages.log&amp;quot;&nbsp;and&nbsp;it&amp;#39;s&nbsp;not&nbsp;in&nbsp;the&nbsp;queue&nbsp;bounded&nbsp;to&nbsp;&amp;quot;messages.retry&amp;quot;.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;interpretation&nbsp;is&nbsp;that&nbsp;if&nbsp;the&nbsp;RabbitMQ&nbsp;process&nbsp;is&nbsp;not&nbsp;running&nbsp;when&nbsp;a&nbsp;message&amp;#39;s&nbsp;TTL&nbsp;is&nbsp;reached,&nbsp;then&nbsp;the&nbsp;message&nbsp;does&nbsp;not&nbsp;get&nbsp;properly&nbsp;dead-lettered&nbsp;--&nbsp;it,&nbsp;instead,&nbsp;just&nbsp;gets&nbsp;dropped&nbsp;on&nbsp;the&nbsp;floor.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;my&nbsp;understanding&nbsp;correct?&nbsp;Is&nbsp;that&nbsp;the&nbsp;intended&nbsp;behavior?&nbsp; If&nbsp;so,&nbsp;is&nbsp;there&nbsp;any&nbsp;way&nbsp;to&nbsp;ensure&nbsp;that&nbsp;this&nbsp;message&nbsp;gets&nbsp;properly&nbsp;persisted&nbsp;/&nbsp;recovered?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;any&nbsp;thoughts!&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Aaron&lt;/div&gt;<br>

</tt>
