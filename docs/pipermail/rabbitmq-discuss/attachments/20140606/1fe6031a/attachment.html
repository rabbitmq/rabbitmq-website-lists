<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hi&nbsp;Simon,&lt;br&gt;&lt;br&gt;&lt;/div&gt;the&nbsp;set&nbsp;-e&nbsp;looks&nbsp;like&nbsp;a&nbsp;very&nbsp;good&nbsp;idea,&nbsp;at&nbsp;least&nbsp;the&nbsp;process&nbsp;will&nbsp;return&nbsp;the&nbsp;failure&nbsp;straight&nbsp;away!&lt;br&gt;&lt;br&gt;&lt;/div&gt;These&nbsp;are&nbsp;the&nbsp;ulimits:&lt;br&gt;&lt;br&gt;[root@ms1&nbsp;~]#&nbsp;ulimit&nbsp;-a&lt;br&gt;<br>
core&nbsp;file&nbsp;size         &nbsp;(blocks,&nbsp;-c)&nbsp;unlimited&lt;br&gt;data&nbsp;seg&nbsp;size          &nbsp;(kbytes,&nbsp;-d)&nbsp;unlimited&lt;br&gt;scheduling&nbsp;priority            &nbsp;(-e)&nbsp;0&lt;br&gt;file&nbsp;size              &nbsp;(blocks,&nbsp;-f)&nbsp;unlimited&lt;br&gt;<br>
pending&nbsp;signals                &nbsp;(-i)&nbsp;2066207&lt;br&gt;max&nbsp;locked&nbsp;memory      &nbsp;(kbytes,&nbsp;-l)&nbsp;64&lt;br&gt;max&nbsp;memory&nbsp;size        &nbsp;(kbytes,&nbsp;-m)&nbsp;unlimited&lt;br&gt;open&nbsp;files                     &nbsp;(-n)&nbsp;1024&lt;br&gt;pipe&nbsp;size           &nbsp;(512&nbsp;bytes,&nbsp;-p)&nbsp;8&lt;br&gt;<br>
<br>
POSIX&nbsp;message&nbsp;queues    &nbsp;(bytes,&nbsp;-q)&nbsp;819200&lt;br&gt;real-time&nbsp;priority             &nbsp;(-r)&nbsp;0&lt;br&gt;stack&nbsp;size             &nbsp;(kbytes,&nbsp;-s)&nbsp;10240&lt;br&gt;cpu&nbsp;time              &nbsp;(seconds,&nbsp;-t)&nbsp;unlimited&lt;br&gt;max&nbsp;user&nbsp;processes             &nbsp;(-u)&nbsp;2066207&lt;br&gt;<br>
<br>
virtual&nbsp;memory         &nbsp;(kbytes,&nbsp;-v)&nbsp;unlimited&lt;br&gt;file&nbsp;locks                     &nbsp;(-x)&nbsp;unlimited&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;No&nbsp;error&nbsp;log&nbsp;showed&nbsp;up&nbsp;in&nbsp;/var/log/messages&nbsp;though...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;Thanks!&lt;br&gt;Cesar.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;6&nbsp;June&nbsp;2014&nbsp;10:16,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
On&nbsp;06/06/2014&nbsp;9:48AM,&nbsp;Cesar&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;all,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;seeing&nbsp;this&nbsp;intermittent&nbsp;issue&nbsp;in&nbsp;RabbitMQ&nbsp;during&nbsp;its&nbsp;startup,&lt;br&gt;<br>
right&nbsp;after&nbsp;installation.&nbsp;As&nbsp;you&nbsp;can&nbsp;see&nbsp;in&nbsp;this&nbsp;gist:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://gist.github.com/xcu/9509f1d285dd9556667c&quot;&nbsp;target=&quot;_blank&quot;&gt;https://gist.github.com/xcu/&lt;u&gt;&lt;/u&gt;9509f1d285dd9556667c&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Firstly,&nbsp;thanks&nbsp;for&nbsp;all&nbsp;the&nbsp;detail&nbsp;there.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
The&nbsp;startup&nbsp;was&nbsp;attempted&nbsp;at&nbsp;0:51,&nbsp;and&nbsp;the&nbsp;wait&nbsp;/var/run/rabbitmq/pid&nbsp;is&lt;br&gt;<br>
still&nbsp;hanging&nbsp;9&nbsp;hours&nbsp;later,&nbsp;which&nbsp;is&nbsp;blocking&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&lt;br&gt;<br>
installation.&nbsp;I&nbsp;believe&nbsp;the&nbsp;message&nbsp;in&nbsp;the&nbsp;startup_err&nbsp;is&nbsp;probably&nbsp;the&lt;br&gt;<br>
cause&nbsp;of&nbsp;this,&nbsp;but&nbsp;after&nbsp;googling&nbsp;it&nbsp;I&nbsp;have&nbsp;found&nbsp;nothing&nbsp;useful.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
So&nbsp;it&nbsp;looks&nbsp;like&nbsp;the&nbsp;startup&nbsp;shell&nbsp;script&nbsp;is&nbsp;failing&nbsp;to&nbsp;write&nbsp;its&nbsp;pid&nbsp;(which&nbsp;will&nbsp;become&nbsp;RabbitMQ&#39;s&nbsp;pid)&nbsp;to&nbsp;a&nbsp;file.&nbsp;The&nbsp;process&nbsp;which&nbsp;then&nbsp;waits&nbsp;for&nbsp;startup&nbsp;to&nbsp;complete&nbsp;then&nbsp;hangs&nbsp;forever&nbsp;since&nbsp;the&nbsp;file&nbsp;is&nbsp;missing.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
So&nbsp;there&nbsp;are&nbsp;two&nbsp;issues&nbsp;here.&nbsp;One&nbsp;is&nbsp;that&nbsp;failing&nbsp;to&nbsp;write&nbsp;the&nbsp;pid&nbsp;file&nbsp;should&nbsp;lead&nbsp;to&nbsp;immediate&nbsp;failure&nbsp;-&nbsp;probably&nbsp;the&nbsp;script&nbsp;just&nbsp;needs&nbsp;to&nbsp;set&nbsp;&quot;-e&quot;.&nbsp;I&nbsp;will&nbsp;make&nbsp;sure&nbsp;this&nbsp;gets&nbsp;some&nbsp;attention.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;second,&nbsp;and&nbsp;more&nbsp;baffling,&nbsp;issue&nbsp;is&nbsp;that&nbsp;on&nbsp;your&nbsp;system(s)&nbsp;the&nbsp;shell&nbsp;command:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;echo&nbsp;$$&nbsp;&gt;&nbsp;${RABBITMQ_PID_FILE}&lt;br&gt;<br>
&lt;br&gt;<br>
is&nbsp;actually&nbsp;failing&nbsp;due&nbsp;to&nbsp;&quot;Cannot&nbsp;allocate&nbsp;memory&quot;.&nbsp;Yet&nbsp;in&nbsp;your&nbsp;startup&nbsp;log&nbsp;the&nbsp;machine&nbsp;seems&nbsp;to&nbsp;have&nbsp;256GB,&nbsp;which&nbsp;ought&nbsp;to&nbsp;be&nbsp;enough&nbsp;to&nbsp;run&nbsp;even&nbsp;the&nbsp;most&nbsp;bloated&nbsp;version&nbsp;of&nbsp;echo.&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;is&nbsp;it&nbsp;something&nbsp;about&nbsp;piping&nbsp;to&nbsp;a&nbsp;file?&nbsp;Are&nbsp;you&nbsp;hitting&nbsp;some&nbsp;ulimit&nbsp;or&nbsp;another?&nbsp;Is&nbsp;there&nbsp;anything&nbsp;unusual&nbsp;on&nbsp;this&nbsp;machine&nbsp;in&nbsp;terms&nbsp;of&nbsp;resource&nbsp;limits?&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;br&gt;<br>
&lt;div&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;This&nbsp;email&nbsp;and&nbsp;any&nbsp;files&nbsp;transmitted&nbsp;with&nbsp;it&nbsp;are&nbsp;confidential&nbsp;and&nbsp;intended&nbsp;solely&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;individual&nbsp;or&nbsp;entity&nbsp;to&nbsp;whom&nbsp;they&nbsp;are&nbsp;addressed.&nbsp;If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;email&nbsp;in&nbsp;error&nbsp;please&nbsp;notify&nbsp;the&nbsp;system&nbsp;manager.&nbsp;This&nbsp;message&nbsp;contains&nbsp;confidential&nbsp;information&nbsp;and&nbsp;is&nbsp;intended&nbsp;only&nbsp;for&nbsp;the&nbsp;individual&nbsp;named.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;named&nbsp;addressee&nbsp;you&nbsp;should&nbsp;not&nbsp;disseminate,&nbsp;distribute&nbsp;or&nbsp;copy&nbsp;this&nbsp;e-mail.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;
</tt>
