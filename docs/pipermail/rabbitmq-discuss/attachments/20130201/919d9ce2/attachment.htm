<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;all,&lt;div&gt;I&amp;#39;m&nbsp;currently&nbsp;using&nbsp;RabbitMQ&nbsp;2.8.1&nbsp;as&nbsp;the&nbsp;backbone&nbsp;of&nbsp;my&nbsp;Logstash&nbsp;architecture.&nbsp; Currently&nbsp;I&amp;#39;ve&nbsp;got&nbsp;5&nbsp;RabbitMQ&nbsp;servers&nbsp;running&nbsp;shovels&nbsp;that&nbsp;push&nbsp;messages&nbsp;onto&nbsp;the&nbsp;&amp;quot;mothership&amp;quot;,&nbsp;where&nbsp;data&nbsp;is&nbsp;consumed&nbsp;by&nbsp;a&nbsp;Logstash&nbsp;agent&nbsp;that&nbsp;feeds&nbsp;into&nbsp;various&nbsp;endpoints.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;The&nbsp;issue&nbsp;is&nbsp;that&nbsp;under&nbsp;high&nbsp;load&nbsp;the&nbsp;Logstash&nbsp;consumer&nbsp;on&nbsp;the&nbsp;mothership&nbsp;isn&amp;#39;t&nbsp;fast&nbsp;enough&nbsp;at&nbsp;to&nbsp;keep&nbsp;up&nbsp;with&nbsp;the&nbsp;data&nbsp;coming&nbsp;in&nbsp;(generally&nbsp;above&nbsp;4,000&nbsp;messages/sec).&nbsp; Normally&nbsp;this&nbsp;wouldn&amp;#39;t&nbsp;be&nbsp;a&nbsp;problem&nbsp;since&nbsp;we&amp;#39;ve&nbsp;got&nbsp;capacity&nbsp;to&nbsp;buffer&nbsp;things&nbsp;on&nbsp;the&nbsp;mothership,&nbsp;but&nbsp;RabbitMQ&nbsp;starts&nbsp;rate&nbsp;limiting&nbsp;the&nbsp;shovels&nbsp;that&nbsp;are&nbsp;sending&nbsp;data&nbsp;in,&nbsp;which&nbsp;compounds&nbsp;the&nbsp;issue&nbsp;since&nbsp;the&nbsp;nodes&nbsp;shoveling&nbsp;data&nbsp;don&amp;#39;t&nbsp;have&nbsp;as&nbsp;much&nbsp;IO&nbsp;capacity&nbsp;as&nbsp;the&nbsp;mothership&nbsp;does.&nbsp; If&nbsp;I&nbsp;stop&nbsp;the&nbsp;slow&nbsp;consumer&nbsp;on&nbsp;the&nbsp;mothership,&nbsp;the&nbsp;shovels&nbsp;play&nbsp;data&nbsp;in&nbsp;as&nbsp;fast&nbsp;as&nbsp;they&nbsp;can&nbsp;acknowledge&nbsp;it.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Ideally&nbsp;I&amp;#39;d&nbsp;be&nbsp;able&nbsp;to&nbsp;turn&nbsp;off&nbsp;producer&nbsp;flow&nbsp;control&nbsp;on&nbsp;the&nbsp;mothership&nbsp;side&nbsp;so&nbsp;the&nbsp;shovels&nbsp;wouldn&amp;#39;t&nbsp;be&nbsp;slowed&nbsp;down&nbsp;except&nbsp;in&nbsp;cases&nbsp;where&nbsp;I&amp;#39;m&nbsp;approaching&nbsp;high&nbsp;watermarks&nbsp;or&nbsp;something&nbsp;along&nbsp;those&nbsp;lines.&nbsp; &lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Can&nbsp;anyone&nbsp;offer&nbsp;any&nbsp;suggestions&nbsp;on&nbsp;how&nbsp;I&nbsp;might&nbsp;be&nbsp;able&nbsp;to&nbsp;adjust&nbsp;the&nbsp;behavior?&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Thanks,&lt;/div&gt;&lt;div&nbsp;style&gt;-Aaron&lt;/div&gt;&lt;/div&gt;<br>

</tt>
