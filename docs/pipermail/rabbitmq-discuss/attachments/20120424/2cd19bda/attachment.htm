<tt>
Hi&nbsp;all,&lt;br&gt;I&amp;#39;m&nbsp;investigating&nbsp;a&nbsp;case&nbsp;when&nbsp;in&nbsp;certain&nbsp;conditions&nbsp;.net&nbsp;client&nbsp;can&nbsp;kill&nbsp;server&nbsp;for&nbsp;~15minutes.&lt;br&gt;We&nbsp;have&nbsp;a&nbsp;specific&nbsp;firewall&nbsp;setup&nbsp;and&nbsp;it&nbsp;can&nbsp;return&nbsp;an&nbsp;ascii&nbsp;string&nbsp;&amp;quot;uou&nbsp;do&nbsp;not&nbsp;have&nbsp;access&nbsp;to&nbsp;this&nbsp;service&amp;quot;.&nbsp;Details&nbsp;do&nbsp;not&nbsp;matter,&nbsp;but&nbsp;in&nbsp;such&nbsp;case&nbsp;.net&nbsp;client&nbsp;will&nbsp;just&nbsp;kill&nbsp;the&nbsp;client&nbsp;box&nbsp;instantly.&nbsp;Even&nbsp;mouse&nbsp;wont&nbsp;move.&lt;br&gt;<br>
&lt;br&gt;I&amp;#39;ve&nbsp;investigated&nbsp;it&nbsp;and&nbsp;found&nbsp;that&nbsp;the&nbsp;problem&nbsp;is&nbsp;in&nbsp;RabbitMQ.Client.Impl.Frams.cs:ReadFrom():&lt;br&gt;           &nbsp;int&nbsp;payloadSize&nbsp;=&nbsp;reader.ReadInt32();&nbsp;//&nbsp;FIXME&nbsp;-&nbsp;throw&nbsp;exn&nbsp;on&nbsp;unreasonable&nbsp;value&lt;br&gt;In&nbsp;case&nbsp;if&nbsp;client&nbsp;attempts&nbsp;to&nbsp;connect&nbsp;to&nbsp;a&nbsp;socket&nbsp;which&nbsp;returns&nbsp;non-ampq&nbsp;message,&nbsp;it&nbsp;will&nbsp;attempt&nbsp;to&nbsp;allocate&nbsp;an&nbsp;array,&nbsp;of&nbsp;generally&nbsp;speaking&nbsp;random&nbsp;size.&lt;br&gt;<br>
Ampq-0.9.1&nbsp;spec&nbsp;(paragraph&nbsp;4.2.3 &nbsp;General&nbsp;Frame&nbsp;Format)&nbsp;says:&lt;br&gt;&amp;gt;&nbsp;If&nbsp;a&nbsp;peer&nbsp;receives&nbsp;a&nbsp;frame&nbsp;with&nbsp;a&nbsp;type&nbsp;that&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;these&nbsp;defined&nbsp;types,&nbsp;it&nbsp;MUST&nbsp;treat&nbsp;this&nbsp;as&nbsp;a&lt;br&gt;fatal&nbsp;protocol&nbsp;error&nbsp;and&nbsp;close&nbsp;the&nbsp;connection&nbsp;without&nbsp;sending&nbsp;any&nbsp;further&nbsp;data&nbsp;on&nbsp;it&lt;br&gt;<br>
&lt;br&gt;But&nbsp;I&nbsp;can&nbsp;not&nbsp;understand&nbsp;the&nbsp;logic&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Frame.ReadFrom:&lt;br&gt;&lt;a&nbsp;href=&quot;http://hg.rabbitmq.com/rabbitmq-dotnet-client/file/0d3c7b59412e/projects/client/RabbitMQ.Client/src/client/impl/Frame.cs#l107&quot;&gt;http://hg.rabbitmq.com/rabbitmq-dotnet-client/file/0d3c7b59412e/projects/client/RabbitMQ.Client/src/client/impl/Frame.cs#l107&lt;/a&gt;&lt;br&gt;<br>
&lt;pre&gt;&nbsp;if&nbsp;(type&nbsp;==&nbsp;&amp;#39;A&amp;#39;)&lt;/pre&gt;The&nbsp;local&nbsp;variable&nbsp;name&nbsp;which&nbsp;recieves&nbsp;the&nbsp;value&nbsp;is&nbsp;&amp;quot;type&amp;quot;,&nbsp;but&nbsp;it&nbsp;checks&nbsp;for&nbsp;&amp;quot;AMQP&amp;quot;&nbsp;which&nbsp;should&nbsp;not&nbsp;be&nbsp;expected&nbsp;and&nbsp;it&nbsp;fail&nbsp;to&nbsp;check&nbsp;for&nbsp;type&nbsp;in&nbsp;1-4&nbsp;range&nbsp;which&nbsp;should&nbsp;be&nbsp;expected&nbsp;according&nbsp;to&nbsp;the&nbsp;spec.&nbsp;And&nbsp;it&nbsp;will&nbsp;keep&nbsp;reading&nbsp;&amp;quot;size&amp;quot;&nbsp;and&nbsp;&amp;quot;byte[size]&amp;quot;&nbsp;even&nbsp;though&nbsp;they&nbsp;can&nbsp;be&nbsp;a&nbsp;garbage.&lt;br&gt;<br>
Am&nbsp;I&nbsp;missing&nbsp;something?&lt;br&gt;&lt;br&gt;Vadim.&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;From&nbsp;RFC&nbsp;2631:&nbsp;In&nbsp;ASN.1,&nbsp;EXPLICIT&nbsp;tagging&nbsp;is&nbsp;implicit&nbsp;unless&nbsp;IMPLICIT&nbsp;is&nbsp;explicitly&nbsp;specified&lt;br&gt;<br>

</tt>
