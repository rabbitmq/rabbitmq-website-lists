<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;(15/07/13&nbsp;15:14),&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:sergey@openbridge.com&quot;&gt;sergey@openbridge.com&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:025976ec-568b-475c-aa54-234407194476@googlegroups.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;Hi&nbsp;everybody,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;tried&nbsp;to&nbsp;put&nbsp;a&nbsp;limit&nbsp;on&nbsp;the&nbsp;queue&nbsp;size&nbsp;using&nbsp;'x-max-length',&nbsp;but<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;problem&nbsp;is&nbsp;Messages&nbsp;will&nbsp;be&nbsp;dropped&nbsp;or&nbsp;dead-lettered&nbsp;from&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;front&nbsp;of&nbsp;the&nbsp;queue&nbsp;to&nbsp;make&nbsp;room&nbsp;for&nbsp;new&nbsp;messages&nbsp;once&nbsp;the&nbsp;limit&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reached.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&amp;nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;are&nbsp;the&nbsp;possible&nbsp;ways&nbsp;to&nbsp;not&nbsp;drop&nbsp;the&nbsp;messages?&nbsp;Ideally&nbsp;I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;would&nbsp;like&nbsp;to&nbsp;throw&nbsp;an&nbsp;Exception&nbsp;if&nbsp;queue&nbsp;is&nbsp;full.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;First&nbsp;I&nbsp;was&nbsp;thinking&nbsp;to&nbsp;check&nbsp;the&nbsp;queue&nbsp;size,&nbsp;and&nbsp;if&nbsp;it's&nbsp;full<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;stop.&nbsp;But&nbsp;for&nbsp;example&nbsp;if&nbsp;I&nbsp;have&nbsp;5&nbsp;producers&nbsp;and&nbsp;queue&nbsp;limit<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size&nbsp;is&nbsp;set&nbsp;to&nbsp;10,&nbsp;and&nbsp;I&nbsp;already&nbsp;have&nbsp;9&nbsp;messages&nbsp;in&nbsp;the&nbsp;queue,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;all&nbsp;5&nbsp;producers&nbsp;will&nbsp;check&nbsp;the&nbsp;size,&nbsp;and&nbsp;publish&nbsp;their<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages&nbsp;and&nbsp;4&nbsp;messages&nbsp;will&nbsp;be&nbsp;lost.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That's&nbsp;how&nbsp;I&nbsp;declare&nbsp;x-max-length':&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;channel.queue_declare(queue='Test',&nbsp;arguments={<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'x-max-length'&nbsp;:&nbsp;10})&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;might&nbsp;be&nbsp;worth&nbsp;trying&nbsp;to&nbsp;drop&nbsp;messages&nbsp;with&nbsp;a&nbsp;probability&nbsp;based<br>
&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;how&nbsp;full&nbsp;the&nbsp;queue&nbsp;is,&nbsp;like&nbsp;in&nbsp;the&nbsp;&lt;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href=&quot;http://en.wikipedia.org/wiki/Random_early_detection&quot;&gt;Random<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Early&nbsp;Detection&lt;/a&gt;&nbsp;queue&nbsp;management&nbsp;scheme.&nbsp;So,&nbsp;pulling&nbsp;numbers<br>
&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;of&nbsp;the&nbsp;air,&nbsp;with&nbsp;a&nbsp;max&nbsp;queue&nbsp;length&nbsp;of&nbsp;100,&nbsp;and&nbsp;if&nbsp;you&nbsp;start<br>
&nbsp;&nbsp;&nbsp;&nbsp;dropping&nbsp;messages&nbsp;when&nbsp;the&nbsp;queue&nbsp;is&nbsp;50%&nbsp;full,&nbsp;then&nbsp;you&nbsp;might&nbsp;drop<br>
&nbsp;&nbsp;&nbsp;&nbsp;20%&nbsp;of&nbsp;messages&nbsp;when&nbsp;the&nbsp;queue&nbsp;is&nbsp;60%&nbsp;full,&nbsp;and&nbsp;80%&nbsp;when&nbsp;90%&nbsp;full.<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;probabilistic&nbsp;aspect&nbsp;means&nbsp;that&nbsp;you're&nbsp;less&nbsp;dependent&nbsp;on&nbsp;timing<br>
&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;queue&nbsp;length&nbsp;reads.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;should&nbsp;probably&nbsp;point&nbsp;out&nbsp;that&nbsp;I've&nbsp;not&nbsp;tried&nbsp;this&nbsp;myself,&nbsp;so&nbsp;I'd<br>
&nbsp;&nbsp;&nbsp;&nbsp;advise&nbsp;caution&nbsp;and&nbsp;lots&nbsp;of&nbsp;experimentation.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:025976ec-568b-475c-aa54-234407194476@googlegroups.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;_______________________________________________<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
