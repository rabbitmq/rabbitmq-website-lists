<tt>
&lt;table&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&nbsp;border=&quot;0&quot;&nbsp;&gt;&lt;tr&gt;&lt;td&nbsp;valign=&quot;top&quot;&nbsp;style=&quot;font:&nbsp;inherit;&quot;&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;Hello&nbsp;all.&nbsp;I've&nbsp;been&nbsp;attempting&nbsp;to&nbsp;benchmark&nbsp;RabbitMQ&nbsp;to&nbsp;see&nbsp;what&nbsp;kind&nbsp;of&nbsp;max&nbsp;messages&nbsp;rates&nbsp;I&nbsp;might&nbsp;expect&nbsp;in&nbsp;a&nbsp;production&nbsp;deployment.&lt;/font&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;One&nbsp;thing&nbsp;I've&nbsp;been&nbsp;seeing&nbsp;that&nbsp;has&nbsp;me&nbsp;a&nbsp;little&nbsp;puzzled&nbsp;is&nbsp;that&nbsp;(for&nbsp;my&nbsp;test&nbsp;setup)&nbsp;message&nbsp;rates&nbsp;on&nbsp;the&nbsp;input&nbsp;side&nbsp;are&nbsp;an&nbsp;order&nbsp;of&nbsp;magnitude&nbsp;higher&nbsp;that&nbsp;on&nbsp;the&nbsp;output&nbsp;side.&nbsp;Meaning&nbsp;I&nbsp;can&nbsp;push&nbsp;25K&nbsp;msgs/sec&nbsp;from&nbsp;my&nbsp;producer.&nbsp;However,&nbsp;my&nbsp;consumer,&nbsp;only&nbsp;seems&nbsp;to&nbsp;get&nbsp;about&nbsp;2.5K&nbsp;msgs/sec...although&nbsp;both&nbsp;consumer&nbsp;and&nbsp;producer&nbsp;are&nbsp;setup&nbsp;similarly.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Do&nbsp;I&nbsp;have&nbsp;something&nbsp;misconfigured?&nbsp;Or&nbsp;is&nbsp;this&nbsp;expected?&nbsp;I&nbsp;would&nbsp;expect&nbsp;*some*&nbsp;difference&nbsp;between<br>
&nbsp;producer(s)/consumer(s)...but&nbsp;not&nbsp;an&nbsp;order&nbsp;of&nbsp;magnitude.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Some&nbsp;basics&nbsp;about&nbsp;my&nbsp;test&nbsp;setup:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;HW&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;------&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;(3)&nbsp;EC2&nbsp;m1.xlarge&nbsp;boxes&nbsp;-&nbsp;4&nbsp;cores,&nbsp;15GB&nbsp;mem&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;1&nbsp;producer,&nbsp;1&nbsp;consumer,&nbsp;1&nbsp;broker&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Broker&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;----------&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Basic&nbsp;RabbitMQ&nbsp;broker&nbsp;install.&nbsp;Didnt&nbsp;really&nbsp;play&nbsp;with&nbsp;any&nbsp;options,&nbsp;except&nbsp;installing&nbsp;the&nbsp;Management&nbsp;plugins&nbsp;and&nbsp;using&nbsp;a<br>
&nbsp;different&nbsp;port&nbsp;than&nbsp;default.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Producer&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;-------------&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Java&nbsp;Client.&nbsp;4&nbsp;Producer&nbsp;threads,&nbsp;each&nbsp;with&nbsp;its&nbsp;own&nbsp;connection&nbsp;and&nbsp;channel.&nbsp;Direct&nbsp;exchange,&nbsp;NO&nbsp;persist,&nbsp;NO&nbsp;autodelete.&nbsp;Connect&nbsp;and&nbsp;Send&nbsp;methods&nbsp;look&nbsp;like:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;public&nbsp;void&nbsp;openConnection()&nbsp;throws&nbsp;IOException&nbsp;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;ConnectionFactory&nbsp;cfconn&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;<br>
&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;cfconn.setHost(host);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;cfconn.setPort(port);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;LOGGER.debug(&quot;opening&nbsp;connection&nbsp;to:&nbsp;&quot;&nbsp;+&nbsp;host&nbsp;+&nbsp;&quot;:&quot;&nbsp;+&nbsp;port);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;connection&nbsp;=&nbsp;cfconn.newConnection();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;channel&nbsp;=&nbsp;connection.createChannel();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;LOGGER.debug(&quot;queue<br>
&nbsp;info:&nbsp;routing_key:&nbsp;&quot;&nbsp;+&nbsp;routingKey&nbsp;+&nbsp;&quot;,&nbsp;exchange:&nbsp;&quot;&nbsp;+&nbsp;exchange);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;channel.queueDeclare(ROUTING_KEY,&nbsp;false,&nbsp;false,&nbsp;false,&nbsp;null);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;public&nbsp;void&nbsp;send(byte[]&nbsp;message)&nbsp;throws&nbsp;IOException&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;channel.basicPublish(exchange,&nbsp;routingKey,&nbsp;null,&nbsp;message);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div<br>
&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Consumer&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;---------------&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;Java&nbsp;client,&nbsp;4&nbsp;consumer&nbsp;threads,&nbsp;each&nbsp;with&nbsp;its&nbsp;own&nbsp;connection&nbsp;and&nbsp;channel.&nbsp;AutoAck&nbsp;YES.&nbsp;Connect&nbsp;and&nbsp;Receive&nbsp;methods&nbsp;look&nbsp;like:&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;public&nbsp;void&nbsp;openConnection()&nbsp;throws&nbsp;IOException&nbsp;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;ConnectionFactory&nbsp;cfconn&nbsp;=&nbsp;new&nbsp;ConnectionFactory();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;cfconn.setHost(host);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;cfconn.setPort(port);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;LOGGER.debug(&quot;opening&nbsp;connection&nbsp;to:&nbsp;&quot;&nbsp;+&nbsp;host&nbsp;+&nbsp;&quot;:&quot;&nbsp;+&nbsp;port);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;connection&nbsp;=&nbsp;cfconn.newConnection();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;channel&nbsp;=&nbsp;connection.createChannel();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;LOGGER.debug(&quot;queue&nbsp;info:&nbsp;queue_name:&nbsp;&quot;&nbsp;+<br>
&nbsp;queueName);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;channel.queueDeclare(QUEUE_NAME,&nbsp;false,&nbsp;false,&nbsp;false,&nbsp;null);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;consumer&nbsp;=&nbsp;new&nbsp;QueueingConsumer(channel);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;channel.basicConsume(QUEUE_NAME,&nbsp;true,&nbsp;consumer);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;<br>
&nbsp;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;public&nbsp;String&nbsp;receive()&nbsp;throws&nbsp;IOException,&nbsp;ShutdownSignalException,&nbsp;ConsumerCancelledException,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;InterruptedException&nbsp;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;Delivery&nbsp;delivery&nbsp;=&nbsp;consumer.nextDelivery(10);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;String&nbsp;retval&nbsp;=&nbsp;null;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;if&nbsp;(delivery&nbsp;!=&nbsp;null)&nbsp;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;retval<br>
&nbsp;=&nbsp;new&nbsp;String(delivery.getBody());&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;return&nbsp;retval;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;}&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;Messages&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;-----------------&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;JSON&nbsp;bytes,&nbsp;about&nbsp;150bytes&nbsp;each&nbsp;message.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;<br>
&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;Other&nbsp;Details&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;--------------------&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;The&nbsp;only&nbsp;thing&nbsp;the&nbsp;consumer&nbsp;is&nbsp;doing&nbsp;after&nbsp;a&nbsp;message&nbsp;is&nbsp;received,&nbsp;is&nbsp;converting&nbsp;bytes--&amp;gt;JSONString--&amp;gt;Object...then&nbsp;moving&nbsp;on.&nbsp;My&nbsp;consumer&nbsp;CPU&nbsp;load&nbsp;is&nbsp;almost&nbsp;nothing,&nbsp;SO&nbsp;I&nbsp;dont&nbsp;think&nbsp;its&nbsp;the&nbsp;Consumer&nbsp;holding&nbsp;things&nbsp;up.&nbsp;&amp;nbsp;&lt;b&gt;On&nbsp;the&nbsp;broker&nbsp;side....there&nbsp;is&nbsp;only&nbsp;1&nbsp;CPU&nbsp;out&nbsp;of&nbsp;4&nbsp;that&nbsp;is&nbsp;doing&nbsp;any&nbsp;real&nbsp;work.&nbsp;Is&nbsp;this&nbsp;normal?&lt;/b&gt;&nbsp;With&nbsp;4&nbsp;consumer&nbsp;threads...I&nbsp;would&nbsp;expect&nbsp;more&nbsp;to&nbsp;be&nbsp;happening&nbsp;on&nbsp;the&nbsp;Broker.&nbsp;I&nbsp;know&nbsp;when&nbsp;the&nbsp;Producer&nbsp;is&nbsp;pushing&nbsp;with&nbsp;4&nbsp;threads...the&nbsp;broker&nbsp;is&nbsp;generally&nbsp;very&nbsp;busy.&nbsp;But&nbsp;when&nbsp;I&nbsp;stop&nbsp;the&nbsp;producer,&nbsp;and&nbsp;leave&nbsp;the&nbsp;consumer&nbsp;running&nbsp;(again,&nbsp;with&nbsp;4&nbsp;threads)...again,&nbsp;I&nbsp;see&nbsp;only&nbsp;1&nbsp;CPU&nbsp;on&nbsp;the&nbsp;broker&nbsp;working.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;<br>
&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;Any&nbsp;ideas?&nbsp;Or&nbsp;things&nbsp;I&nbsp;should&nbsp;change?&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;Thanks,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;/Marv&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;10pt;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
</tt>
