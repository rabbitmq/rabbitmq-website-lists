<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;We&nbsp;have&nbsp;a&nbsp;3&nbsp;node&nbsp;rabbitmq&nbsp;cluster&nbsp;consisting&nbsp;of&nbsp;2&nbsp;disk&nbsp;nodes&nbsp;and&nbsp;one&nbsp;memory&nbsp;node.&nbsp;&amp;nbsp;(disk&nbsp;nodes&nbsp;are&nbsp;rabbitmq-00&nbsp;and&nbsp;01,&nbsp;memory&nbsp;node&nbsp;is&nbsp;core-01)&amp;nbsp;&lt;br&gt;&lt;br&gt;&lt;div&gt;queues&nbsp;are&nbsp;durable&nbsp;and&nbsp;mirrored&nbsp;(show&nbsp;+2&nbsp;in&nbsp;control&nbsp;panel,&nbsp;etc.)&nbsp;and&nbsp;show&nbsp;syncronized:&lt;br&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;#&nbsp;rabbitmqctl&nbsp;list_queues&nbsp;name&nbsp;slave_pids&nbsp;synchronised_slave_pids&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;Listing&nbsp;queues&nbsp;...&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;...&lt;br&gt;SVC_mailbox_lookup&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;[&amp;lt;'rabbit@rabbitmq-01'.2.301.0&amp;gt;,&nbsp;&amp;lt;'rabbit@core-01'.1.268.0&amp;gt;]&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;[&amp;lt;'rabbit@core-01'.1.268.0&amp;gt;,&nbsp;&amp;lt;'rabbit@rabbitmq-01'.2.301.0&amp;gt;]&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;#&nbsp;&amp;nbsp;rabbitmqctl&nbsp;list_policies&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;Listing&nbsp;policies&nbsp;...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;/&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;ha-all&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;^SVC_&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;{&quot;ha-mode&quot;:&quot;all&quot;}&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;/span&gt;0&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;...done.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;put&nbsp;in&nbsp;SSD&nbsp;mounted&nbsp;to&nbsp;'/var/lib/rabbitmq'&nbsp;to&nbsp;host&nbsp;the&nbsp;mnesia&nbsp;database&nbsp;on&nbsp;rabbitmq-00/01.&nbsp;&amp;nbsp;we&nbsp;only&nbsp;did&nbsp;a&nbsp;single&nbsp;drive&nbsp;figuring&nbsp;that&nbsp;if&nbsp;the&nbsp;disk&nbsp;failed&nbsp;the&nbsp;node&nbsp;would&nbsp;crash&nbsp;and&nbsp;the&nbsp;others&nbsp;in&nbsp;the&nbsp;HA&nbsp;cluster&nbsp;would&nbsp;take&nbsp;over&nbsp;-&nbsp;all&nbsp;clients&nbsp;have&nbsp;been&nbsp;coded&nbsp;for&nbsp;failover.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;SSD&nbsp;on&nbsp;rabbitmq-00&nbsp;failed.&nbsp;&amp;nbsp;&nbsp;i&nbsp;don't&nbsp;have&nbsp;logs&nbsp;of&nbsp;that&nbsp;event&nbsp;from&nbsp;rabbitmq-00's&nbsp;point&nbsp;of&nbsp;view&nbsp;-&nbsp;for&nbsp;some&nbsp;reason&nbsp;it&nbsp;didn't&nbsp;write&nbsp;out&nbsp;anything.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;do&nbsp;have&nbsp;it&nbsp;from&nbsp;rabbitmq-01's:&lt;br&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;=INFO&nbsp;REPORT====&nbsp;26-Sep-2013::16:07:20&nbsp;===&lt;br&gt;Mirrored-queue&nbsp;(queue&nbsp;'SVC_mailbox_lookup'&nbsp;in&nbsp;vhost&nbsp;'/'):&nbsp;Slave&nbsp;&amp;lt;'&lt;a&nbsp;href=&quot;rabbit@4c-rabbitmq-01'.3.785.0&amp;gt;&quot;&gt;rabbit@rabbitmq-01'.3.785.0&amp;gt;&lt;/a&gt;&nbsp;saw&nbsp;deaths&nbsp;of&nbsp;mirrors&nbsp;&amp;lt;'&lt;a&nbsp;href=&quot;rabbit@4c-rabbitmq-00'.3.1415.0&amp;gt;&quot;&gt;rabbit@rabbitmq-00'.3.1415.0&amp;gt;&lt;/a&gt;&nbsp;&lt;br&gt;&lt;br&gt;=INFO&nbsp;REPORT====&nbsp;26-Sep-2013::16:07:20&nbsp;===&lt;br&gt;Mirrored-queue&nbsp;(queue&nbsp;'SVC_mailbox_lookup'&nbsp;in&nbsp;vhost&nbsp;'/'):&nbsp;Promoting&nbsp;slave&nbsp;&amp;lt;'&lt;a&nbsp;href=&quot;rabbit@4c-rabbitmq-01'.3.785.0&amp;gt;&quot;&gt;rabbit@rabbitmq-01'.3.785.0&amp;gt;&lt;/a&gt;&nbsp;to&nbsp;master&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;but&nbsp;then:&lt;br&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&gt;&lt;br&gt;=ERROR&nbsp;REPORT====&nbsp;26-Sep-2013::16:17:17&nbsp;===&lt;br&gt;connection&nbsp;&amp;lt;0.487.0&amp;gt;,&nbsp;channel&nbsp;1&nbsp;-&nbsp;soft&nbsp;error:&lt;br&gt;{amqp_error,not_found,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;home&nbsp;node&nbsp;'rabbit@core-01'&nbsp;of&nbsp;durable&nbsp;queue&nbsp;'SVC_mailbox_lookup'&nbsp;in&nbsp;vhost&nbsp;'/'&nbsp;is&nbsp;down&nbsp;or&nbsp;inaccessible&quot;,&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'queue.declare'}&lt;/font&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;repeated&nbsp;for&nbsp;each&nbsp;queue.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;looks&nbsp;like&nbsp;rabbitmq-01&nbsp;took&nbsp;over&nbsp;as&nbsp;master,&nbsp;but&nbsp;then&nbsp;the&nbsp;nodes&nbsp;become&nbsp;non-responsive&nbsp;because&nbsp;they&nbsp;can't&nbsp;write&nbsp;to&nbsp;disk&nbsp;on&nbsp;core-01&nbsp;(the&nbsp;memory&nbsp;node.)&lt;br&gt;&lt;br&gt;&lt;div&gt;we&nbsp;shutdown&nbsp;whatever&nbsp;was&nbsp;still&nbsp;running&nbsp;on&nbsp;rabbitmq-00.&nbsp;&amp;nbsp;&nbsp;and&nbsp;everything&nbsp;was&nbsp;still&nbsp;unavailable.&nbsp;&amp;nbsp;we&nbsp;then&nbsp;shutdown&nbsp;core-01&nbsp;and&nbsp;lastly&nbsp;rabbitmq-01,&nbsp;then&nbsp;restarted&nbsp;rabbitmq-01,&nbsp;but&nbsp;it&nbsp;came&nbsp;up&nbsp;with&nbsp;NO&nbsp;queues.&nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;is&nbsp;this&nbsp;an&nbsp;error&nbsp;with&nbsp;the&nbsp;way&nbsp;the&nbsp;HA&nbsp;cluster&nbsp;is&nbsp;handling&nbsp;failover&nbsp;or&nbsp;an&nbsp;error&nbsp;with&nbsp;our&nbsp;configurations&nbsp;-&nbsp;should&nbsp;we&nbsp;not&nbsp;mix&nbsp;memory&nbsp;and&nbsp;disk&nbsp;nodes&nbsp;in&nbsp;an&nbsp;HA&nbsp;cluster?&nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;br&gt;I'm&nbsp;trying&nbsp;to&nbsp;figure&nbsp;this&nbsp;our&nbsp;because&nbsp;we&nbsp;want&nbsp;to&nbsp;be&nbsp;sure&nbsp;that&nbsp;if&nbsp;any&nbsp;node&nbsp;in&nbsp;the&nbsp;cluster&nbsp;fails,&nbsp;the&nbsp;others&nbsp;take&nbsp;over&nbsp;seamlessly.&nbsp;&amp;nbsp;our&nbsp;code&nbsp;does&nbsp;that...&nbsp;we&nbsp;just&nbsp;need&nbsp;the&nbsp;clusters&nbsp;to&nbsp;soldier&nbsp;on&nbsp;and&nbsp;that&nbsp;no&nbsp;records&nbsp;are&nbsp;lost.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks.&nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;
</tt>
