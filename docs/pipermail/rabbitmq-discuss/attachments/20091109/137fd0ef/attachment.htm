<tt>
Hello&nbsp;Mathew..&lt;br&gt;&lt;br&gt;Thanks&nbsp;for&nbsp;ur&nbsp;reply..&nbsp;was&nbsp;out&nbsp;of&nbsp;town&nbsp;so&nbsp;couldn&nbsp;attend&nbsp;to&nbsp;mail&nbsp;earlier..&nbsp;my&nbsp;comments&nbsp;inline...&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Nov&nbsp;6,&nbsp;2009&nbsp;at&nbsp;4:56&nbsp;PM,&nbsp;Matthew&nbsp;Sackman&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:matthew@lshift.net&quot;&gt;matthew@lshift.net&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Hi&nbsp;Arun,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
On&nbsp;Fri,&nbsp;Nov&nbsp;06,&nbsp;2009&nbsp;at&nbsp;07:58:09AM&nbsp;+0530,&nbsp;Arun&nbsp;Suresh&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;My&nbsp;setup&nbsp;is&nbsp;as&nbsp;follows&nbsp;:&lt;br&gt;<br>
&amp;gt;&nbsp;*&nbsp;2&nbsp;RabbitMQ&nbsp;(1.7.0&nbsp;running&nbsp;on&nbsp;R13B02.1)&nbsp;servers&nbsp;in&nbsp;a&nbsp;cluster&nbsp;(say&nbsp;rabbit@m1,&lt;br&gt;<br>
&amp;gt;&nbsp;rabbit@m2)..&nbsp;both&nbsp;disk&nbsp;nodes.&lt;br&gt;<br>
&amp;gt;&nbsp;*&nbsp;2&nbsp;Clients&nbsp;(client@m1&nbsp;connected&nbsp;to&nbsp;rabbit@m1,&nbsp;client@m2&nbsp;connected&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;rabbit@m2).&nbsp;I&nbsp;am&nbsp;using&nbsp;the&nbsp;Erlang&nbsp;client&nbsp;(which&nbsp;currently&nbsp;has&nbsp;an&nbsp;issue&nbsp;when&lt;br&gt;<br>
&amp;gt;&nbsp;connecting&nbsp;to&nbsp;a&nbsp;server&nbsp;which&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;cluster...&nbsp;this&nbsp;I&nbsp;fixed&nbsp;by&nbsp;setting&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;quot;insist&nbsp;=&nbsp;true&amp;quot;&nbsp;in&nbsp;the&nbsp;#&amp;#39;connection.open&amp;#39;&nbsp;record)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Can&nbsp;you&nbsp;elaborate&nbsp;on&nbsp;this&nbsp;issue&nbsp;a&nbsp;bit?&nbsp;Is&nbsp;this&nbsp;redirection&nbsp;coming&nbsp;back&lt;br&gt;<br>
from&nbsp;the&nbsp;server?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;Yes..&nbsp;I&nbsp;guess&nbsp;its&nbsp;a&nbsp;redirection&nbsp;request&nbsp;coming&nbsp;from&nbsp;the&nbsp;server..&lt;br&gt;basicaly..&nbsp;the&nbsp;response&nbsp;to&nbsp;my&nbsp;&amp;#39;connection.open&amp;#39;&nbsp;request&nbsp;is&nbsp;a&nbsp;&amp;#39;conncetion.redirect&amp;#39;&nbsp;which&nbsp;on&nbsp;recipt,&nbsp;the&nbsp;client&nbsp;throws&nbsp;an&nbsp;exception&nbsp;and&nbsp;exits..&nbsp;&lt;br&gt;<br>
ive&nbsp;gotten&nbsp;around&nbsp;this&nbsp;issue&nbsp;by&nbsp;setting&nbsp;&amp;#39;insist&nbsp;=&nbsp;true&amp;#39;&nbsp;in&nbsp;the&nbsp;request&nbsp;record...&nbsp;&lt;br&gt;Maybe&nbsp;ill&nbsp;look&nbsp;at&nbsp;the&nbsp;Java&nbsp;client&nbsp;and&nbsp;see&nbsp;whats&nbsp;done&nbsp;there&nbsp;?&nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;*&nbsp;both&nbsp;clients&nbsp;have&nbsp;processes&nbsp;that&nbsp;have&nbsp;subscribed&nbsp;to&nbsp;the&nbsp;same&nbsp;durable&nbsp;Queue&lt;br&gt;<br>
&amp;gt;&nbsp;(Q)&nbsp;using&nbsp;the&nbsp;same&nbsp;key&nbsp;(K).&nbsp;Q&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;durable&nbsp;topic&nbsp;exchange&nbsp;(X).&nbsp;X&lt;br&gt;<br>
&amp;gt;&nbsp;and&nbsp;Q&nbsp;are&nbsp;created&nbsp;on&nbsp;rabbit@m1.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;don&amp;#39;t&nbsp;understand&nbsp;what&nbsp;you&nbsp;mean&nbsp;by&nbsp;a&nbsp;queue&nbsp;with&nbsp;a&nbsp;key.&nbsp;I&nbsp;take&nbsp;it&nbsp;you&lt;br&gt;<br>
have&nbsp;one&nbsp;topic&nbsp;exchange,&nbsp;one&nbsp;queue&nbsp;bound&nbsp;to&nbsp;the&nbsp;exchange&nbsp;with&nbsp;one&lt;br&gt;<br>
binding&nbsp;key&nbsp;(is&nbsp;this&nbsp;the&nbsp;K&nbsp;you&nbsp;refer&nbsp;to&nbsp;above?),&nbsp;and&nbsp;two&nbsp;consumers&nbsp;on&lt;br&gt;<br>
the&nbsp;queue.&nbsp;(From&nbsp;reading&nbsp;the&nbsp;rest&nbsp;of&nbsp;your&nbsp;email,&nbsp;yes&nbsp;this&nbsp;is&nbsp;clearly&lt;br&gt;<br>
what&nbsp;you&nbsp;mean).&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Now&nbsp;this&nbsp;is&nbsp;what&nbsp;i&nbsp;do..&lt;br&gt;<br>
&amp;gt;&nbsp;*&nbsp;I&nbsp;bring&nbsp;down&nbsp;rabbit@m1,&nbsp;and&nbsp;client@m1&nbsp;(They&nbsp;are&nbsp;co&nbsp;hosted...&nbsp;so&nbsp;both&nbsp;are&lt;br&gt;<br>
&amp;gt;&nbsp;brought&nbsp;down&nbsp;together).&nbsp;I&nbsp;do&nbsp;a&nbsp;&amp;quot;rabbitmqctl&nbsp;list_queues&amp;quot;&nbsp;on&nbsp;rabbit@m2...&nbsp;I&lt;br&gt;<br>
&amp;gt;&nbsp;do&nbsp;not&nbsp;see&nbsp;Q&nbsp;there..&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Ok,&nbsp;so&nbsp;the&nbsp;queue&nbsp;has&nbsp;been&nbsp;created&nbsp;on&nbsp;m1,&nbsp;not&nbsp;m2.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;*&nbsp;I&nbsp;bring&nbsp;rabbit@m1&nbsp;up&nbsp;again...&nbsp;After&nbsp;which&nbsp;I&nbsp;see&nbsp;Q&nbsp;when&nbsp;i&nbsp;do&nbsp;a&nbsp;&amp;quot;rabbitmqctl&lt;br&gt;<br>
&amp;gt;&nbsp;list_queues&amp;quot;.&lt;br&gt;<br>
&amp;gt;&nbsp;*&nbsp;Before&nbsp;I&nbsp;bring&nbsp;up&nbsp;client@m2,&nbsp;I&nbsp;publish&nbsp;a&nbsp;messge&nbsp;to&nbsp;X&nbsp;with&nbsp;a&nbsp;routing&nbsp;key&lt;br&gt;<br>
&amp;gt;&nbsp;K...&lt;br&gt;<br>
&amp;gt;&nbsp;Issue&nbsp; :&nbsp;Since&nbsp;client@m2&nbsp;is&nbsp;up&nbsp;and&nbsp;has&nbsp;a&nbsp;process&nbsp;subscribed&nbsp;to&nbsp;Q,&nbsp;I&nbsp;expect&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;process&nbsp;to&nbsp;receive&nbsp;the&nbsp;message...&nbsp;It&nbsp;doesnt..&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Indeed&nbsp;it&nbsp;won&amp;#39;t.&lt;br&gt;<br>
&lt;br&gt;<br>
Clustering&nbsp;makes&nbsp;all&nbsp;exchanges&nbsp;and&nbsp;queues&nbsp;available&nbsp;on&nbsp;all&nbsp;nodes&nbsp;of&nbsp;the&lt;br&gt;<br>
cluster.&nbsp;*However*,&nbsp;a&nbsp;queue&nbsp;is&nbsp;still&nbsp;located&nbsp;on&nbsp;a&nbsp;single&nbsp;node,&nbsp;even&lt;br&gt;<br>
though&nbsp;it&nbsp;is&nbsp;accessible&nbsp;via&nbsp;all&nbsp;nodes.&nbsp;The&nbsp;queue&nbsp;will&nbsp;be&nbsp;created&nbsp;on&nbsp;the&lt;br&gt;<br>
node&nbsp;the&nbsp;client&nbsp;is&nbsp;connected&nbsp;to&nbsp;when&nbsp;it&nbsp;creates&nbsp;the&nbsp;queue.&nbsp;Thus&nbsp;your&lt;br&gt;<br>
queue&nbsp;has&nbsp;been&nbsp;created&nbsp;on&nbsp;m1,&nbsp;thus&nbsp;it&amp;#39;s&nbsp;accessible&nbsp;from&nbsp;both&nbsp;m1&nbsp;and&nbsp;m2,&lt;br&gt;<br>
but&nbsp;when&nbsp;m1&nbsp;goes&nbsp;down,&nbsp;the&nbsp;queue&nbsp;will&nbsp;go&nbsp;down&nbsp;with&nbsp;it.&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;From&nbsp;that&nbsp;point&nbsp;on,&nbsp;m2&nbsp;has&nbsp;no&nbsp;record&nbsp;of&nbsp;the&nbsp;queue,&nbsp;so&nbsp;msgs&nbsp;sent&nbsp;to&nbsp;X&lt;br&gt;<br>
with&nbsp;K&nbsp;to&nbsp;go&nbsp;to&nbsp;Q&nbsp;will&nbsp;not&nbsp;ever&nbsp;reach&nbsp;Q&nbsp;-&nbsp;as&nbsp;far&nbsp;as&nbsp;m2&nbsp;is&nbsp;concerned,&nbsp;Q&lt;br&gt;<br>
just&nbsp;does&nbsp;not&nbsp;exist.&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;m1&nbsp;comes&nbsp;back&nbsp;up,&nbsp;Q&nbsp;will&nbsp;be&nbsp;recovered.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Further&nbsp;more...&nbsp;I&nbsp;notice&nbsp;that&nbsp;when&nbsp;i&nbsp;bring&nbsp;client@m2&nbsp;back&nbsp;up,&nbsp;It&nbsp;restarts&lt;br&gt;<br>
&amp;gt;&nbsp;its&nbsp;subscribers...&nbsp;now&nbsp;all&nbsp;messages&nbsp;published&nbsp;to&nbsp;X&nbsp;with&nbsp;K&nbsp;are&nbsp;sent&nbsp;ONLY&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;client@m2.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Well&nbsp;client@m1&nbsp;died.&nbsp;This&nbsp;means&nbsp;its&nbsp;subscriptions&nbsp;to&nbsp;Q&nbsp;were&nbsp;lost&nbsp;-&nbsp;there&lt;br&gt;<br>
is&nbsp;no&nbsp;concept&nbsp;of&nbsp;persisting&nbsp;subscriptions,&nbsp;so&nbsp;when&nbsp;rabbit@m1&nbsp;comes&nbsp;back&lt;br&gt;<br>
up,&nbsp;the&nbsp;Q&nbsp;will&nbsp;have&nbsp;no&nbsp;consumers&nbsp;at&nbsp;all.&nbsp;If&nbsp;you&nbsp;restart&nbsp;client@m2&nbsp;then&lt;br&gt;<br>
yes,&nbsp;it&amp;#39;ll&nbsp;recreate&nbsp;its&nbsp;subscription&nbsp;to&nbsp;Q,&nbsp;and&nbsp;thus&nbsp;receive&nbsp;all&nbsp;the&nbsp;msgs&lt;br&gt;<br>
sent&nbsp;to&nbsp;that&nbsp;Q.&nbsp;If&nbsp;you&nbsp;also&nbsp;restart&nbsp;client@m1&nbsp;then&nbsp;that&nbsp;too&nbsp;will&lt;br&gt;<br>
recreate&nbsp;its&nbsp;subscription&nbsp;to&nbsp;Q&nbsp;and&nbsp;share&nbsp;the&nbsp;msgs&nbsp;with&nbsp;client@m2&nbsp;as&lt;br&gt;<br>
before.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Confirms&nbsp;what&nbsp;ive&nbsp;been&nbsp;thinking...&nbsp;But&nbsp;Is&nbsp;there&nbsp;any&nbsp;way&nbsp;for&nbsp;clients&nbsp;to&nbsp;be&nbsp;notified&nbsp;of&nbsp;dead&nbsp;subscriptions&nbsp;?&nbsp;That&nbsp;would&nbsp;be&nbsp;helpful,&nbsp;else&nbsp;i&nbsp;would&nbsp;have&nbsp;to&nbsp;keep&nbsp;polling&nbsp;something&nbsp;to&nbsp;get&nbsp;that&nbsp;information..&nbsp;&lt;br&gt;<br>
&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;this&nbsp;is&nbsp;of&nbsp;help.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Definitely..&nbsp;thanx&nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
Matthew&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
