<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;Hi,&amp;nbsp;&lt;/span&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;We've&nbsp;been&nbsp;using&nbsp;RabbitMQ&nbsp;Since&nbsp;early&nbsp;1.x&nbsp;days&nbsp;and&nbsp;it&nbsp;has&nbsp;been&nbsp;a&nbsp;great&nbsp;and&nbsp;reliable&nbsp;queueing&nbsp;system.&nbsp;In&nbsp;the&nbsp;last&nbsp;few&nbsp;months&nbsp;we've&nbsp;started&nbsp;experiencing&nbsp;severe&nbsp;rabbit&nbsp;crashes,&nbsp;all&nbsp;due&nbsp;to&nbsp;'out&nbsp;of&nbsp;memory'&nbsp;errors,&nbsp;where&nbsp;rabbit&nbsp;is&nbsp;killed&nbsp;by&nbsp;the&nbsp;kernel.&nbsp;We're&nbsp;using&nbsp;rabbit&nbsp;with&nbsp;celery&nbsp;in&nbsp;a&nbsp;python&nbsp;application.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;We&nbsp;did&nbsp;go&nbsp;through&nbsp;some&nbsp;infrastructure&nbsp;changes&nbsp;when&nbsp;those&nbsp;crashes&nbsp;began&nbsp;-&nbsp;we&nbsp;moved&nbsp;to&nbsp;a&nbsp;different&nbsp;data&nbsp;centre&nbsp;and&nbsp;upgraded&nbsp;rabbit&nbsp;from&nbsp;2.x&nbsp;to&nbsp;latest&nbsp;3.x&nbsp;(as&nbsp;well&nbsp;as&nbsp;celery&nbsp;to&nbsp;the&nbsp;latest&nbsp;3.x&nbsp;version).&nbsp;The&nbsp;spec&nbsp;of&nbsp;the&nbsp;machine&nbsp;running&nbsp;rabbit&nbsp;did&nbsp;not&nbsp;change&nbsp;though&nbsp;-&nbsp;the&nbsp;old&nbsp;and&nbsp;new&nbsp;servers&nbsp;had&nbsp;16GB&nbsp;of&nbsp;ram&nbsp;and&nbsp;both&nbsp;had&nbsp;a&nbsp;few&nbsp;other&nbsp;things&nbsp;running&nbsp;on&nbsp;them&nbsp;-&nbsp;a&nbsp;few&nbsp;celery&nbsp;nodes&nbsp;and&nbsp;memcached&nbsp;(limited&nbsp;to&nbsp;2GB).&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;In&nbsp;our&nbsp;old&nbsp;setup,&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;the&nbsp;queues&nbsp;become&nbsp;rabbit&nbsp;stayed&nbsp;alive&nbsp;and&nbsp;well.&nbsp;In&nbsp;the&nbsp;new&nbsp;setup&nbsp;once&nbsp;memory&nbsp;usage&nbsp;spikes&nbsp;too&nbsp;high,&nbsp;rabbit&nbsp;dies.&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;As&nbsp;an&nbsp;intermediate&nbsp;solution&nbsp;we've&nbsp;prepared&nbsp;a&nbsp;32GB&nbsp;ram&nbsp;machine&nbsp;and&nbsp;will&nbsp;use&nbsp;the&nbsp;old&nbsp;16GB&nbsp;one&nbsp;as&nbsp;a&nbsp;secondary&nbsp;(i.e.,&nbsp;run&nbsp;rabbit&nbsp;in&nbsp;a&nbsp;cluster).&nbsp;However&nbsp;it&nbsp;is&nbsp;very&nbsp;important&nbsp;to&nbsp;us&nbsp;to&nbsp;understand&nbsp;why&nbsp;we&nbsp;are&nbsp;experiencing&nbsp;those&nbsp;crashes&nbsp;-&nbsp;adding&nbsp;hardware&nbsp;only&nbsp;solves&nbsp;the&nbsp;symptom&nbsp;but&nbsp;not&nbsp;the&nbsp;problem.&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;Why&nbsp;does&nbsp;rabbit&nbsp;fail&nbsp;when&nbsp;memory&nbsp;is&nbsp;spiking?&nbsp;What&nbsp;causes&nbsp;the&nbsp;kernel&nbsp;to&nbsp;kill&nbsp;it?&nbsp;The&nbsp;error&nbsp;message&nbsp;is&nbsp;always&nbsp;a&nbsp;cryptic&nbsp;Out&nbsp;Of&nbsp;Memory&nbsp;and&nbsp;Killed&nbsp;by&nbsp;Kernel&nbsp;though&nbsp;I'm&nbsp;convinced&nbsp;there&nbsp;is&nbsp;something&nbsp;trivial&nbsp;we&nbsp;are&nbsp;missing&nbsp;in&nbsp;our&nbsp;new&nbsp;setup&nbsp;that&nbsp;causes&nbsp;the&nbsp;kernel&nbsp;to&nbsp;terminate&nbsp;rabbit&nbsp;in&nbsp;those&nbsp;cases.&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;Any&nbsp;help&nbsp;is&nbsp;highly&nbsp;appreciated.&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;br&gt;Harel&lt;/div&gt;&lt;/div&gt;
</tt>
