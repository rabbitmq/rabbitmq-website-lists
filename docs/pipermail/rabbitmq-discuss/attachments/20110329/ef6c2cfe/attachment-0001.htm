<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--&nbsp;DIV&nbsp;{margin:0px;}&nbsp;--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;font-size:10pt&quot;&gt;&lt;div&gt;John,&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;font-size:&nbsp;10pt;&quot;&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&lt;font&nbsp;face=&quot;Tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;/font&gt;&lt;br&gt;&amp;gt;&nbsp;One&nbsp;more&nbsp;question.&nbsp;You&nbsp;say&nbsp;RabbitMQ&nbsp;crashes&nbsp;when&nbsp;you&nbsp;run&nbsp;these&nbsp;tests?&nbsp;And&nbsp;it&nbsp;crashes&nbsp;without&nbsp;writing&nbsp;anything&nbsp;interesting&nbsp;in&nbsp;th&nbsp;logs?&nbsp;Or&nbsp;printing&nbsp;anything&nbsp;to&nbsp;the&nbsp;console?&nbsp;It&nbsp;just&nbsp;exits?&lt;br&gt;&lt;br&gt;It&nbsp;crashed&nbsp;without&nbsp;any&nbsp;errors&nbsp;in&nbsp;the&nbsp;log.&amp;nbsp;&nbsp;&lt;br&gt;&lt;br&gt;I&nbsp;found&nbsp;a&nbsp;problem&nbsp;with&nbsp;my&nbsp;the&nbsp;amqp_consumer.c&nbsp;that&nbsp;I&nbsp;sent&nbsp;last&nbsp;week.&amp;nbsp;&nbsp;it&nbsp;did&nbsp;not&nbsp;send&nbsp;acknowledgement&nbsp;after&nbsp;consuming&nbsp;the&nbsp;messages.&amp;nbsp;&nbsp;Attached&nbsp;please&nbsp;find&nbsp;the&nbsp;updated&nbsp;amqp_consumer&nbsp;with&nbsp;ack&nbsp;enabled.&amp;nbsp;&nbsp;please&nbsp;use&nbsp;this&nbsp;for&nbsp;testing.&lt;br&gt;&lt;br&gt;Currently&nbsp;the&nbsp;tests&nbsp;would&nbsp;send&nbsp;3000&nbsp;messages&nbsp;to&nbsp;each&nbsp;queue&nbsp;(MESSAGE_COUNT=3000&nbsp;in<br>
&nbsp;common.sh).&lt;br&gt;If&nbsp;you&nbsp;find&nbsp;some&nbsp;fast&nbsp;consumers&nbsp;already&nbsp;finish&nbsp;consuming&nbsp;3000&nbsp;messages&nbsp;much&nbsp;earlier&nbsp;than&nbsp;other&nbsp;consumers,&nbsp;please&nbsp;change&nbsp;MESSAGE_COUNT=5000.&amp;nbsp;&nbsp;this&nbsp;would&nbsp;reliably&nbsp;reproduce&nbsp;the&nbsp;broker&nbsp;crash.&amp;nbsp;&nbsp;if&nbsp;you&nbsp;ran&nbsp;&lt;br&gt;&quot;top&nbsp;|&nbsp;grep&nbsp;beam&quot;&nbsp;while&nbsp;all&nbsp;1000&nbsp;consumers&nbsp;are&nbsp;running,&nbsp;you&nbsp;can&nbsp;see&nbsp;its&nbsp;memory&nbsp;usage&nbsp;grows&nbsp;to&nbsp;more&nbsp;than&nbsp;3500&nbsp;MB&nbsp;before&nbsp;it&nbsp;crashes.&lt;br&gt;&lt;br&gt;Thanks.&lt;br&gt;&lt;br&gt;-alex&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
