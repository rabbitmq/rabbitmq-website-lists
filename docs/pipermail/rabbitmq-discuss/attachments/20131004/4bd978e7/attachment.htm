<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;We&nbsp;currently&nbsp;use&nbsp;RabbitMQ&nbsp;as&nbsp;a&nbsp;broker&nbsp;for&nbsp;a&nbsp;subset&nbsp;of&nbsp;our&nbsp;overall&nbsp;logging&nbsp;platform.&nbsp;Recently,&nbsp;we&nbsp;attempted&nbsp;to&nbsp;add&nbsp;an&nbsp;additional&nbsp;category&nbsp;of&nbsp;logging&nbsp;that&nbsp;would&nbsp;result&nbsp;in&nbsp;additional&nbsp;load&nbsp;of&nbsp;approximately&nbsp;2,000&nbsp;msg/sec&nbsp;with&nbsp;an&nbsp;average&nbsp;message&nbsp;size&nbsp;of&nbsp;approximately&nbsp;2KB.&lt;br&gt;<br>
&lt;br&gt;&lt;div&gt;Upon&nbsp;adding&nbsp;this&nbsp;additional&nbsp;category&nbsp;of&nbsp;logging,&nbsp;we&nbsp;noticed&nbsp;a&nbsp;couple&nbsp;things:&lt;br&gt;&lt;br&gt;(1)&nbsp;Our&nbsp;consumers&nbsp;were&nbsp;not&nbsp;able&nbsp;to&nbsp;keep&nbsp;up&nbsp;with&nbsp;the&nbsp;flow&nbsp;of&nbsp;messages,&nbsp;so&nbsp;they&nbsp;began&nbsp;to&nbsp;build&nbsp;up&nbsp;in&nbsp;the&nbsp;queue&nbsp;(our&nbsp;developers&nbsp;are&nbsp;working&nbsp;on&nbsp;fixing&nbsp;this).&lt;br&gt;<br>
&lt;br&gt;(2)&nbsp;We&nbsp;began&nbsp;to&nbsp;see&nbsp;RabbitMQ&nbsp;invoke&nbsp;flow-control&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;TCP&nbsp;back-pressure&nbsp;on&nbsp;our&nbsp;producers.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;My&nbsp;initial&nbsp;thought&nbsp;was&nbsp;that&nbsp;since&nbsp;we&nbsp;were&nbsp;using&nbsp;durable&nbsp;queues&nbsp;with&nbsp;persistent&nbsp;messages&nbsp;that&nbsp;when&nbsp;the&nbsp;consumers&nbsp;weren&amp;#39;t&nbsp;immediately&nbsp;picking&nbsp;up&nbsp;the&nbsp;messages,&nbsp;RabbitMQ&nbsp;was&nbsp;attempting&nbsp;to&nbsp;persist&nbsp;them&nbsp;to&nbsp;disk&nbsp;in&nbsp;order&nbsp;to&nbsp;satisfy&nbsp;the&nbsp;persistence&nbsp;&amp;amp;&nbsp;durability&nbsp;requirements&nbsp;and&nbsp;it&nbsp;couldn&amp;#39;t&nbsp;keep&nbsp;up.&lt;br&gt;<br>
&lt;br&gt;But&nbsp;in&nbsp;following&nbsp;up&nbsp;with&nbsp;my&nbsp;developers&nbsp;this&nbsp;morning&nbsp;it&nbsp;seems&nbsp;that&nbsp;they&nbsp;are&nbsp;in&nbsp;fact&nbsp;no&nbsp;publishing&nbsp;the&nbsp;messages&nbsp;as&nbsp;persistent&nbsp;and&nbsp;being&nbsp;that&nbsp;(based&nbsp;on&nbsp;my&nbsp;understanding)&nbsp;a&nbsp;non-persistent&nbsp;message&nbsp;published&nbsp;to&nbsp;a&nbsp;durable&nbsp;queue&nbsp;is&nbsp;not&nbsp;written&nbsp;to&nbsp;disk,&nbsp;this&nbsp;threw&nbsp;my&nbsp;initial&nbsp;theory&nbsp;out&nbsp;the&nbsp;windows&nbsp;(I&nbsp;still&nbsp;have&nbsp;to&nbsp;verify&nbsp;their&nbsp;claim&nbsp;of&nbsp;non-persistence).&lt;br&gt;<br>
&lt;br&gt;So,&nbsp;my&nbsp;question&nbsp;is&nbsp;-&nbsp;what&nbsp;other&nbsp;things&nbsp;can&nbsp;I&nbsp;look&nbsp;at&nbsp;to&nbsp;determine&nbsp;the&nbsp;cause&nbsp;of&nbsp;the&nbsp;invocation&nbsp;of&nbsp;flow&nbsp;control.&nbsp;Additional&nbsp;relevant&nbsp;information&nbsp;is&nbsp;as&nbsp;follows:&lt;br&gt;&lt;br&gt;(*)&nbsp;2x&nbsp;RabbitMQ&nbsp;Nodes&nbsp;Running&nbsp;3.1.3&nbsp;in&nbsp;a&nbsp;clustered&nbsp;configuration.&lt;br&gt;<br>
(*)&nbsp;Each&nbsp;node&nbsp;has&nbsp;8x&nbsp;2GHzCPU&nbsp;cores&nbsp;and&nbsp;4GB&nbsp;of&nbsp;RAM.&lt;br&gt;(*)&nbsp;At&nbsp;no&nbsp;time&nbsp;during&nbsp;the&nbsp;window&nbsp;in&nbsp;question&nbsp;did&nbsp;CPU&nbsp;utilization&nbsp;reach&nbsp;&amp;gt;15%&lt;br&gt;(*)&nbsp;At&nbsp;no&nbsp;time&nbsp;during&nbsp;the&nbsp;window&nbsp;in&nbsp;question&nbsp;did&nbsp;memory&nbsp;utilization&nbsp;reach&nbsp;&amp;gt;50%&lt;br&gt;<br>
(*)&nbsp;In&nbsp;looking&nbsp;at&nbsp;the&nbsp;logs&nbsp;during&nbsp;the&nbsp;window&nbsp;in&nbsp;question&nbsp;I&nbsp;can&nbsp;see&nbsp;events&nbsp;which&nbsp;I&nbsp;think&nbsp;are&nbsp;associated&nbsp;with&nbsp;the&nbsp;various&nbsp;publishers&nbsp;disconnecting&nbsp;(I&nbsp;am&nbsp;not&nbsp;sure&nbsp;if&nbsp;our&nbsp;producer&nbsp;code&nbsp;is&nbsp;handling&nbsp;flow-control&nbsp;gracefully)&nbsp;but&nbsp;nothing&nbsp;that&nbsp;seems&nbsp;to&nbsp;indicate&nbsp;why&nbsp;this&nbsp;happened.&lt;br&gt;<br>
&lt;br&gt;Any&nbsp;help&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Richard&lt;/div&gt;&lt;/div&gt;<br>

</tt>
