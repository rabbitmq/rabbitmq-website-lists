<tt>
Folks,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;We&nbsp;are&nbsp;running&nbsp;a&nbsp;high&nbsp;scale&nbsp;setup&nbsp;with&nbsp;rabbitmq&nbsp;3.0.1&nbsp;,&nbsp;flow:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;logstash&nbsp;1.1.12&nbsp;producer&nbsp;--&amp;gt;&nbsp;exchange&nbsp;--&amp;gt;&nbsp;&amp;nbsp;&nbsp;fanout&nbsp;queue&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;|&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;|&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;|&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;|&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;consumer&nbsp;Consumer&lt;/div&gt;&lt;div&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;A&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;B&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Consumers&nbsp;as&nbsp;logstash&nbsp;,&nbsp;consuming&nbsp;to&nbsp;graphite&nbsp;as&nbsp;output&nbsp;,&nbsp;our&nbsp;message&nbsp;rate&nbsp;us&nbsp;~&nbsp;12000&nbsp;messages/s&nbsp;,&nbsp;FanOut&nbsp;Exchange&nbsp;,&nbsp;Durable:&nbsp;False&nbsp;,&nbsp;Persistent:&nbsp;False&nbsp;,&nbsp;No&nbsp;Memory&nbsp;problems&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;are&nbsp;facing&nbsp;a&nbsp;problem&nbsp;where&nbsp;at&nbsp;random&nbsp;times&nbsp;rabbitmq&nbsp;starts&nbsp;to&nbsp;block&nbsp;producers&nbsp;due&nbsp;to&nbsp;flow&nbsp;control&nbsp;(rabbitmqctl&nbsp;list_connections)&nbsp;,&nbsp;this&nbsp;is&nbsp;to&nbsp;our&nbsp;understanding&amp;nbsp;&lt;/div&gt;&lt;div&gt;in&nbsp;order&nbsp;to&nbsp;protect&nbsp;the&nbsp;broker&nbsp;and&nbsp;the&nbsp;consumer&nbsp;as&nbsp;the&nbsp;producers&nbsp;are&nbsp;faster&nbsp;then&nbsp;the&nbsp;consumer&nbsp;?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;at&nbsp;some&nbsp;point&nbsp;(when&nbsp;the&nbsp;READY&nbsp;messages&nbsp;count&nbsp;is&nbsp;high&nbsp;~&nbsp;1M)&nbsp;&amp;nbsp;rabbitmq&nbsp;blocks&nbsp;most&nbsp;of&nbsp;our&nbsp;producers&nbsp;and&nbsp;does&nbsp;not&nbsp;seem&nbsp;to&nbsp;release&nbsp;them&nbsp;,&nbsp;until&nbsp;we&nbsp;restart&nbsp;them&nbsp;(logstash&nbsp;daemon)&nbsp;on&nbsp;every&nbsp;one&nbsp;of&nbsp;them&nbsp;,&nbsp;we&nbsp;tried&nbsp;purging&nbsp;the&nbsp;queue&nbsp;/&nbsp;restarting&nbsp;rabbitmq&nbsp;,&nbsp;only&nbsp;restarting&nbsp;the&nbsp;producers&nbsp;seems&nbsp;to&nbsp;bring&nbsp;things&nbsp;to&nbsp;normal&nbsp;state.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;guess&nbsp;my&nbsp;questions&nbsp;are:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;-&nbsp;Is&nbsp;my&nbsp;problem&nbsp;on&nbsp;the&nbsp;consumer&nbsp;side&nbsp;?&nbsp;I&nbsp;am&nbsp;unable&nbsp;to&nbsp;debug&nbsp;the&nbsp;consumer&nbsp;speed&nbsp;or&nbsp;state&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;-&nbsp;Can&nbsp;I&nbsp;force&nbsp;flow&nbsp;control&nbsp;to&nbsp;release&nbsp;blocked&nbsp;producers?&lt;/div&gt;&lt;div&gt;&amp;nbsp;-&nbsp;Can&nbsp;I&nbsp;tune&nbsp;rabbitmq&nbsp;for&nbsp;lots&nbsp;of&nbsp;connections&nbsp;and&nbsp;high&nbsp;message&nbsp;rate?&lt;/div&gt;&lt;div&gt;&amp;nbsp;-&nbsp;We&nbsp;use&nbsp;fanout&nbsp;exchange&nbsp;,&nbsp;when&nbsp;a&nbsp;consumer&nbsp;creates&nbsp;a&nbsp;new&nbsp;queue&nbsp;under&nbsp;this&nbsp;exchange&nbsp;and&nbsp;does&nbsp;not&nbsp;consume&nbsp;fast&nbsp;enough&nbsp;can&nbsp;he&nbsp;effect&nbsp;the&nbsp;producers&nbsp;from&nbsp;the&nbsp;other&nbsp;queue&nbsp;(i.e&nbsp;cause&nbsp;them&nbsp;to&nbsp;be&nbsp;blocked?)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&lt;/div&gt;&lt;div&gt;Kobi&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&gt;The&nbsp;above&nbsp;terms&nbsp;reflect&nbsp;a&nbsp;potential&nbsp;business&nbsp;arrangement,&nbsp;are&nbsp;provided &lt;/font&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&gt;solely&nbsp;as&nbsp;a&nbsp;basis&nbsp;for&nbsp;further&nbsp;discussion,&nbsp;and&nbsp;are&nbsp;not&nbsp;intended&nbsp;to&nbsp;be&nbsp;and&nbsp;do &lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;not&nbsp;constitute&nbsp;a&nbsp;legally&nbsp;binding&nbsp;obligation.&nbsp;No&nbsp;legally&nbsp;binding&nbsp;obligations&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;will&nbsp;be&nbsp;created,&nbsp;implied,&nbsp;or&nbsp;inferred&nbsp;until&nbsp;an&nbsp;agreement&nbsp;in&nbsp;final&nbsp;form&nbsp;is &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;executed&nbsp;in&nbsp;writing&nbsp;by&nbsp;all&nbsp;parties&nbsp;involved.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;font&nbsp;face=&quot;Arial,&nbsp;Helvetica,&nbsp;sans-serif&quot;&gt;This&nbsp;email&nbsp;and&nbsp;any&nbsp;attachments&nbsp;hereto&nbsp;may&nbsp;be&nbsp;confidential&nbsp;or&nbsp;privileged.&nbsp; If&nbsp;you&nbsp;received&nbsp;this&nbsp;&lt;/font&gt;&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;communication&nbsp;by&nbsp;mistake,&nbsp;please&nbsp;don&amp;#39;t&nbsp;forward&nbsp;it&nbsp;to&nbsp;anyone&nbsp;else,&nbsp;please &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;erase&nbsp;all&nbsp;copies&nbsp;and&nbsp;attachments,&nbsp;and&nbsp;please&nbsp;let&nbsp;me&nbsp;know&nbsp;that&nbsp;it&nbsp;has&nbsp;gone &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Arial,Helvetica,sans-serif&quot;&gt;to&nbsp;the&nbsp;wrong&nbsp;person.&nbsp;Thanks.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
</tt>
