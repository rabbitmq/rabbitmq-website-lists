<tt>
&lt;div&gt;We&nbsp;try&nbsp;and&nbsp;design&nbsp;our&nbsp;architecture&nbsp;(for&nbsp;a&nbsp;large&nbsp;web&nbsp;application)&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;we&nbsp;expect&nbsp;any&nbsp;part&nbsp;to&nbsp;fail:&nbsp;&amp;quot;design&nbsp;for&nbsp;failure&amp;quot;.&nbsp; &nbsp;There&amp;#39;s&nbsp;parts&nbsp;of&nbsp;our&nbsp;system&nbsp;that&nbsp;are&nbsp;prime&nbsp;for&nbsp;RabbitMQ&nbsp;but&nbsp;the&nbsp;concern&nbsp;is&nbsp;that&nbsp;a&nbsp;message&nbsp;must&nbsp;never&nbsp;be&nbsp;lost&nbsp;--&nbsp;even&nbsp;when&nbsp;RabbitMQ&nbsp;is&nbsp;setup&nbsp;for&nbsp;HA.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;designing&nbsp;for&nbsp;that&nbsp;rare&nbsp;situation&nbsp;that&nbsp;a&nbsp;message&nbsp;might&nbsp;get&nbsp;lost,&nbsp;my&nbsp;approach&nbsp;has&nbsp;been&nbsp;to&nbsp;maintain&nbsp;state&nbsp;on&nbsp;the&nbsp;application.&nbsp; When&nbsp;I&nbsp;send&nbsp;a&nbsp;message&nbsp;to&nbsp;get&nbsp;some&nbsp;work&nbsp;down&nbsp;I&nbsp;flag&nbsp;it&nbsp;as&nbsp;&amp;quot;in&nbsp;process&amp;quot;&nbsp;or&nbsp;&amp;quot;pending&amp;quot;&nbsp;with&nbsp;a&nbsp;start&nbsp;time&nbsp;and&nbsp;a&nbsp;retry&nbsp;counter.&nbsp; I&nbsp;can&nbsp;then&nbsp;(say&nbsp;with&nbsp;cron)&nbsp;find&nbsp;the&nbsp;uncompleted&nbsp;tasks&nbsp;that&nbsp;have&nbsp;been&nbsp;waiting&nbsp;for&nbsp;some&nbsp;value&nbsp;of&nbsp;too&nbsp;long.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But,&nbsp;then&nbsp;the&nbsp;problem&nbsp;is&nbsp;what&nbsp;to&nbsp;do&nbsp;with&nbsp;that&nbsp;information?&nbsp; How&nbsp;do&nbsp;I&nbsp;know&nbsp;that&nbsp;the&nbsp;message&nbsp;is&nbsp;really&nbsp;lost&nbsp;and&nbsp;not&nbsp;just&nbsp;backed&nbsp;up&nbsp;in&nbsp;the&nbsp;queue?&nbsp; Don&amp;#39;t&nbsp;want&nbsp;to&nbsp;queue&nbsp;it&nbsp;again&nbsp;in&nbsp;this&nbsp;case&nbsp;as&nbsp;it&nbsp;just&nbsp;compounds&nbsp;the&nbsp;problem&nbsp;(and&nbsp;then&nbsp;if&nbsp;the&nbsp;first&nbsp;job&nbsp;finally&nbsp;completes&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;wrong&nbsp;message&nbsp;is&nbsp;updated).&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That,&nbsp;and&nbsp;I&nbsp;frankly&nbsp;think&nbsp;the&nbsp;overhead&nbsp;of&nbsp;my&nbsp;state&nbsp;tracking&nbsp;is&nbsp;possibly&nbsp;more problematic&nbsp;than&nbsp;the&nbsp;potential&nbsp;for&nbsp;a&nbsp;loss&nbsp;of&nbsp;a&nbsp;message. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyway,&nbsp;sorry&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;mundane&nbsp;(if&nbsp;not&nbsp;a&nbsp;bit&nbsp;off-topic)&nbsp;question&nbsp;--&nbsp;and&nbsp;I&nbsp;know&nbsp;it&amp;#39;s&nbsp;application-specific.&nbsp;But,&nbsp;it&amp;#39;s&nbsp;a&nbsp;question&nbsp;that&nbsp;comes&nbsp;up&nbsp;often&nbsp;in&nbsp;our&nbsp;design&nbsp;discussions.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Do&nbsp;you&nbsp;have&nbsp;these&nbsp;concerns&nbsp;and&nbsp;how&nbsp;do&nbsp;you&nbsp;handle&nbsp;the&nbsp;possibility&nbsp;of&nbsp;message&nbsp;or&nbsp;queue&nbsp;loss?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;Bill&nbsp;Moseley&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:moseley@hank.org&quot;&nbsp;target=&quot;_blank&quot;&gt;moseley@hank.org&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>

</tt>
