<tt>
Hi,&nbsp;thanks&nbsp;for&nbsp;your&nbsp;response.&lt;br&gt;&lt;br&gt;The&nbsp;file&nbsp;descriptor&nbsp;with&nbsp;the&nbsp;EAGAIN&nbsp;looks&nbsp;like&nbsp;the&nbsp;read&nbsp;end&nbsp;of&nbsp;a&nbsp;pipe&nbsp;to&nbsp;itself,&nbsp;according&nbsp;to&nbsp;lsof:&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;beam   &nbsp;1754&nbsp;rabbitmq   &nbsp;5r    &nbsp;FIFO   &nbsp;0,8     &nbsp;0t0 &nbsp;10971&nbsp;pipe&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;beam   &nbsp;1754&nbsp;rabbitmq   &nbsp;6w    &nbsp;FIFO   &nbsp;0,8     &nbsp;0t0 &nbsp;10971&nbsp;pipe&lt;/span&gt;&lt;br&gt;&lt;br&gt;Here&nbsp;is&nbsp;etop&nbsp;output.&nbsp;This&nbsp;system&nbsp;also&nbsp;runs&nbsp;couchdb,&nbsp;which&nbsp;may&nbsp;be&nbsp;showing&nbsp;up&nbsp;in&nbsp;the&nbsp;etop&nbsp;report:&lt;br&gt;<br>
&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;========================================================================================&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt; etop@xxxxxxxxx01                                                         &nbsp;12:05:21&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt; Load: &nbsp;cpu        &nbsp;0              &nbsp;Memory: &nbsp;total       &nbsp;6616   &nbsp;binary        &nbsp;20&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;procs     &nbsp;34                       &nbsp;processes   &nbsp;1192   &nbsp;code        &nbsp;3495&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;       &nbsp;runq       &nbsp;0                       &nbsp;atom         &nbsp;448   &nbsp;ets          &nbsp;249&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;Pid           &nbsp;Name&nbsp;or&nbsp;Initial&nbsp;Func   &nbsp;Time   &nbsp;Reds &nbsp;Memory   &nbsp;MsgQ&nbsp;Current&nbsp;Function&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;----------------------------------------------------------------------------------------&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.3.0&amp;gt;       &nbsp;erl_prim_loader         &nbsp;&amp;#39;-&amp;#39;   &nbsp;8012  &nbsp;88288      &nbsp;0&nbsp;erl_prim_loader:loop&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.30.0&amp;gt;      &nbsp;user                    &nbsp;&amp;#39;-&amp;#39;   &nbsp;7339  &nbsp;34312      &nbsp;0&nbsp;group:server_loop/3&nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.40.0&amp;gt;      &nbsp;etop_txt:init/1         &nbsp;&amp;#39;-&amp;#39;   &nbsp;2725  &nbsp;26272      &nbsp;0&nbsp;etop:update/1      &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.25.0&amp;gt;      &nbsp;code_server             &nbsp;&amp;#39;-&amp;#39;   &nbsp;1558 &nbsp;101024      &nbsp;0&nbsp;code_server:loop/1 &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.29.0&amp;gt;      &nbsp;user_drv                &nbsp;&amp;#39;-&amp;#39;     &nbsp;92  &nbsp;13640      &nbsp;0&nbsp;user_drv:server_loop&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.0.0&amp;gt;       &nbsp;init                    &nbsp;&amp;#39;-&amp;#39;      &nbsp;0  &nbsp;18456      &nbsp;0&nbsp;init:boot_loop/2   &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.2.0&amp;gt;       &nbsp;etop_server             &nbsp;&amp;#39;-&amp;#39;      &nbsp;0  &nbsp;88288      &nbsp;0&nbsp;etop:data_handler/2&nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.5.0&amp;gt;       &nbsp;error_logger            &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;5704      &nbsp;0&nbsp;gen_event:fetch_msg/&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.6.0&amp;gt;       &nbsp;application_controll    &nbsp;&amp;#39;-&amp;#39;      &nbsp;0 &nbsp;230080      &nbsp;0&nbsp;gen_server:loop/6  &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.8.0&amp;gt;       &nbsp;proc_lib:init_p/5       &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;6856      &nbsp;0&nbsp;application_master:m&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.9.0&amp;gt;       &nbsp;application_master:s    &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;2584      &nbsp;0&nbsp;application_master:l&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.10.0&amp;gt;      &nbsp;kernel_sup              &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;7256      &nbsp;0&nbsp;gen_server:loop/6  &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.11.0&amp;gt;      &nbsp;rex                     &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;2648      &nbsp;0&nbsp;gen_server:loop/6  &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.12.0&amp;gt;      &nbsp;global_name_server      &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;2728      &nbsp;0&nbsp;gen_server:loop/6  &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&amp;lt;0.13.0&amp;gt;      &nbsp;erlang:apply/2          &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;2544      &nbsp;0&nbsp;global:loop_the_lock&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;========================================================================================&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;This&nbsp;tight&nbsp;loop&nbsp;condition&nbsp;was&nbsp;repeatable&nbsp;100%&nbsp;on&nbsp;the&nbsp;system&nbsp;above.&nbsp;I&nbsp;installed&nbsp;the&nbsp;same&nbsp;rpms&nbsp;onto&nbsp;another&nbsp;rhel6.2&nbsp;system&nbsp;and&nbsp;the&nbsp;problem&nbsp;did&nbsp;not&nbsp;occur.&nbsp;I&nbsp;then&nbsp;deleted&nbsp;the&nbsp;contents&nbsp;of&nbsp;/var/lib/rabbitmq&nbsp;and&nbsp;re-created&nbsp;my&nbsp;single&nbsp;vhost&nbsp;+&nbsp;user.&nbsp;The&nbsp;tight&nbsp;epoll_wait&nbsp;loop&nbsp;is&nbsp;now&nbsp;gone.&nbsp;Before&nbsp;my&nbsp;purge,&nbsp;the&nbsp;rabbitmq&nbsp;process&nbsp;had&nbsp;over&nbsp;500&nbsp;open&nbsp;files&nbsp;similar&nbsp;to&nbsp;the&nbsp;following:&lt;br&gt;<br>
&lt;br&gt;/var/lib/rabbitmq/mnesia/rabbit@&lt;span&nbsp;style=&quot;font-family:courier&nbsp;new,monospace&quot;&gt;xxxxxxxxx01&lt;/span&gt;/queues/5DQOSIVFS7TNVQV0KQGVZYBSL/journal.jif&lt;br&gt;&lt;br&gt;The&nbsp;queues&nbsp;directory&nbsp;has&nbsp;not&nbsp;yet&nbsp;been&nbsp;re-created&nbsp;by&nbsp;rabbitmq.&nbsp;This&nbsp;rabbitmq-server&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;Chef&nbsp;installation.&nbsp;I&nbsp;will&nbsp;post&nbsp;back&nbsp;if&nbsp;the&nbsp;problem&nbsp;reoccurs.&nbsp;After&nbsp;the&nbsp;purge,&nbsp;the&nbsp;ntop&nbsp;output&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;========================================================================================&lt;br&gt; etop@hgspadmna01                                                         &nbsp;17:29:01&lt;br&gt; Load: &nbsp;cpu        &nbsp;0              &nbsp;Memory: &nbsp;total       &nbsp;6564   &nbsp;binary        &nbsp;20&lt;br&gt;<br>
       &nbsp;procs     &nbsp;34                       &nbsp;processes   &nbsp;1141   &nbsp;code        &nbsp;3495&lt;br&gt;       &nbsp;runq       &nbsp;0                       &nbsp;atom         &nbsp;448   &nbsp;ets          &nbsp;249&lt;br&gt;&lt;br&gt;Pid           &nbsp;Name&nbsp;or&nbsp;Initial&nbsp;Func   &nbsp;Time   &nbsp;Reds &nbsp;Memory   &nbsp;MsgQ&nbsp;Current&nbsp;Function&lt;br&gt;<br>
----------------------------------------------------------------------------------------&lt;br&gt;&amp;lt;0.30.0&amp;gt;      &nbsp;user                    &nbsp;&amp;#39;-&amp;#39;   &nbsp;5798  &nbsp;16656      &nbsp;0&nbsp;group:server_loop/3&nbsp;&lt;br&gt;&amp;lt;0.40.0&amp;gt;      &nbsp;etop_txt:init/1         &nbsp;&amp;#39;-&amp;#39;   &nbsp;2255  &nbsp;29288      &nbsp;0&nbsp;etop:update/1      &nbsp;&lt;br&gt;<br>
&amp;lt;0.29.0&amp;gt;      &nbsp;user_drv                &nbsp;&amp;#39;-&amp;#39;     &nbsp;72  &nbsp;13640      &nbsp;0&nbsp;user_drv:server_loop&lt;br&gt;&amp;lt;0.0.0&amp;gt;       &nbsp;init                    &nbsp;&amp;#39;-&amp;#39;      &nbsp;0  &nbsp;26352      &nbsp;0&nbsp;init:boot_loop/2   &nbsp;&lt;br&gt;&amp;lt;0.2.0&amp;gt;       &nbsp;etop_server             &nbsp;&amp;#39;-&amp;#39;      &nbsp;0  &nbsp;88288      &nbsp;0&nbsp;etop:data_handler/2&nbsp;&lt;br&gt;<br>
&amp;lt;0.3.0&amp;gt;       &nbsp;erl_prim_loader         &nbsp;&amp;#39;-&amp;#39;      &nbsp;0  &nbsp;21392      &nbsp;0&nbsp;erl_prim_loader:loop&lt;br&gt;&amp;lt;0.5.0&amp;gt;       &nbsp;error_logger            &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;5704      &nbsp;0&nbsp;gen_event:fetch_msg/&lt;br&gt;&amp;lt;0.6.0&amp;gt;       &nbsp;application_controll    &nbsp;&amp;#39;-&amp;#39;      &nbsp;0 &nbsp;230080      &nbsp;0&nbsp;gen_server:loop/6  &nbsp;&lt;br&gt;<br>
&amp;lt;0.8.0&amp;gt;       &nbsp;proc_lib:init_p/5       &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;6856      &nbsp;0&nbsp;application_master:m&lt;br&gt;&amp;lt;0.9.0&amp;gt;       &nbsp;application_master:s    &nbsp;&amp;#39;-&amp;#39;      &nbsp;0   &nbsp;2584      &nbsp;0&nbsp;application_master:l&lt;br&gt;========================================================================================&lt;br&gt;<br>
&lt;br&gt;Thanks!&lt;br&gt;&lt;br&gt;Con&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Jun&nbsp;18,&nbsp;2012&nbsp;at&nbsp;4:00&nbsp;AM,&nbsp;Emile&nbsp;Joubert&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:emile@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;emile@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hi,&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
On&nbsp;14/06/12&nbsp;22:10,&nbsp;Con&nbsp;Zyor&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Running&nbsp;strace&nbsp;on&nbsp;the&nbsp;process&nbsp;reveals&nbsp;that&nbsp;beam&nbsp;is&nbsp;in&nbsp;a&nbsp;tight&nbsp;loop,&nbsp;with&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;following&nbsp;sequence&nbsp;repeated&nbsp;endlessly:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;read(5,&nbsp;&amp;quot;00&amp;quot;,&nbsp;32)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;2&lt;br&gt;<br>
&amp;gt;&nbsp;read(5,&nbsp;0x7fffc2213e40,&nbsp;32)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;-1&nbsp;EAGAIN&nbsp;(Resource&lt;br&gt;<br>
&amp;gt;&nbsp;temporarily&nbsp;unavailable)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;is&nbsp;definitely&nbsp;not&nbsp;expected&nbsp;behaviour.&nbsp;Can&nbsp;you&nbsp;determine&nbsp;what&nbsp;that&lt;br&gt;<br>
file&nbsp;descriptor&nbsp;corresponds&nbsp;to&nbsp;by&nbsp;looking&nbsp;earlier&nbsp;in&nbsp;the&nbsp;output?&lt;br&gt;<br>
What&nbsp;does&nbsp;&amp;quot;etop&amp;quot;&nbsp;output?&lt;br&gt;<br>
How&nbsp;repeatable&nbsp;is&nbsp;the&nbsp;problem?&lt;br&gt;<br>
Have&nbsp;you&nbsp;observed&nbsp;this&nbsp;on&nbsp;any&nbsp;other&nbsp;servers,&nbsp;or&nbsp;is&nbsp;it&nbsp;only&nbsp;one?&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
-Emile&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
</tt>
