<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;set&nbsp;up&nbsp;a&nbsp;queue&nbsp;via&nbsp;amq.direct&nbsp;exchange&nbsp;with&nbsp;one&nbsp;producer&nbsp;and&nbsp;one&nbsp;consumer.&lt;br&gt;I&nbsp;used&nbsp;the&nbsp;following&nbsp;code&nbsp;to&nbsp;set&nbsp;up&nbsp;TTL&nbsp;for&nbsp;the&nbsp;consumer:&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;amqp_table_t&nbsp;table;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;amqp_table_entry_t&nbsp;entry;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;entry.key&nbsp;=&nbsp;amqp_cstring_bytes(&quot;x-message-ttl&quot;);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;entry.value.kind&nbsp;=&nbsp;AMQP_FIELD_KIND_I16;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;entry.value.value.i16&nbsp;=&nbsp;2000;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;table.num_entries&nbsp;=&nbsp;1;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;table.entries&nbsp;=&nbsp;&amp;entry;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;amqp_queue_declare_ok_t&nbsp;*r&nbsp;=&nbsp;amqp_queue_declare(conn,&nbsp;1,&nbsp;amqp_empty_bytes,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;&nbsp;table);&lt;br&gt;&lt;br&gt;Then&nbsp;every&nbsp;time&nbsp;I&nbsp;consume&nbsp;a&nbsp;message,&nbsp;I&nbsp;sleep&nbsp;for&nbsp;5&nbsp;secs&nbsp;just&nbsp;to&nbsp;delay&nbsp;the&nbsp;consuming&nbsp;rate.&lt;br&gt;I&nbsp;also&nbsp;have&nbsp;the&nbsp;producer&nbsp;send&nbsp;a&nbsp;message&nbsp;every&nbsp;1&nbsp;sec.&lt;br&gt;&lt;br&gt;However,&nbsp;when&nbsp;I&nbsp;run&nbsp;the&nbsp;producer&nbsp;to&nbsp;produce&nbsp;20&nbsp;messages,&nbsp;the&nbsp;consumer&nbsp;will&nbsp;get&nbsp;all&nbsp;20&nbsp;messages&nbsp;with&nbsp;5&nbsp;sec&nbsp;delay&nbsp;in&nbsp;between.&lt;br&gt;Should&nbsp;some&nbsp;messages&nbsp;not&nbsp;delivered&nbsp;because&nbsp;of&nbsp;TTL&nbsp;&nbsp;&lt;&nbsp;5&nbsp;sec&nbsp;delay?&lt;br&gt;&lt;br&gt;Thanks,&lt;br&gt;-Kim&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;
</tt>
