<tt>
&lt;DIV&gt;If&nbsp;the&amp;nbsp;producer&amp;nbsp;sends&nbsp;plenty&nbsp;of&nbsp;messages&nbsp;constantly&nbsp;over&nbsp;the&nbsp;memory&amp;nbsp;throttling,and&nbsp;couldn't&nbsp;stop,&nbsp;where&nbsp;these&nbsp;messages&nbsp;is?&nbsp;stay&nbsp;on&nbsp;the&nbsp;side&nbsp;of&nbsp;producer?&nbsp;in&nbsp;this&nbsp;case,&nbsp;i&nbsp;think&amp;nbsp;the&nbsp;producer&nbsp;would&nbsp;crash&nbsp;out&nbsp;of&nbsp;memory.&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;gt;Hagbard,&lt;BR&gt;&lt;BR&gt;&amp;gt;Since&nbsp;2.x,&nbsp;RabbitMQ&nbsp;will&nbsp;no&nbsp;longer&nbsp;allow&nbsp;the&nbsp;Erlang&nbsp;process&nbsp;to&nbsp;run&nbsp;out&nbsp;&lt;BR&gt;&amp;gt;of&nbsp;memory&nbsp;and&nbsp;stop&nbsp;due&nbsp;to&nbsp;fast&nbsp;producers&nbsp;and&nbsp;slow&nbsp;consumers.&lt;BR&gt;&lt;BR&gt;&amp;gt;If&nbsp;you&nbsp;have&nbsp;a&nbsp;fast&nbsp;producer&nbsp;running&nbsp;constantly,&nbsp;accompanied&nbsp;by&nbsp;a&nbsp;slow&nbsp;&lt;BR&gt;&amp;gt;consumer&nbsp;then&nbsp;the&nbsp;number&nbsp;of&nbsp;queued&nbsp;messages&nbsp;will&nbsp;grow.&nbsp;To&nbsp;prevent&nbsp;this&nbsp;&lt;BR&gt;&amp;gt;from&nbsp;causing&nbsp;out&nbsp;of&nbsp;memory&nbsp;problems,&nbsp;Rabbit&nbsp;will&nbsp;throttle&nbsp;the&nbsp;producer&nbsp;&lt;BR&gt;&amp;gt;once&nbsp;the&nbsp;memory&nbsp;high&nbsp;watermark&nbsp;is&nbsp;hit.&lt;BR&gt;&lt;BR&gt;&amp;gt;The&nbsp;throttling&nbsp;works&nbsp;by&nbsp;simply&nbsp;blocking&nbsp;the&nbsp;producer&nbsp;from&nbsp;sending&nbsp;any&nbsp;&lt;BR&gt;&amp;gt;more&nbsp;data&nbsp;over&nbsp;the&nbsp;TCP&nbsp;socket.&nbsp;Once&nbsp;memory&nbsp;drops&nbsp;below&nbsp;the&nbsp;high&nbsp;&lt;BR&gt;&amp;gt;watermark,&nbsp;due&nbsp;to&nbsp;the&nbsp;consumer&nbsp;catching&nbsp;up&nbsp;or&nbsp;messages&nbsp;being&nbsp;flushed&nbsp;to&nbsp;&lt;BR&gt;&amp;gt;disk,&nbsp;the&nbsp;producer&nbsp;can&nbsp;send&nbsp;data&nbsp;again.&lt;BR&gt;&lt;BR&gt;&amp;gt;Note&nbsp;that&nbsp;your&nbsp;producer&nbsp;might&nbsp;bounce&nbsp;off&nbsp;the&nbsp;watermark&nbsp;frequently&nbsp;if&nbsp;it&nbsp;&lt;BR&gt;&amp;gt;just&nbsp;keeps&nbsp;publishing&nbsp;without&nbsp;let&nbsp;up.&lt;BR&gt;&lt;BR&gt;Rob&lt;BR&gt;&lt;BR&gt;&amp;gt;&amp;gt;&lt;A&nbsp;href=&quot;mailto:Hagbard@gmx.de&quot;&nbsp;target=_blank&gt;&lt;FONT&nbsp;color=#4b4632&gt;Hagbard@gmx.&lt;WBR&gt;de&lt;/FONT&gt;&lt;/A&gt;&nbsp;wrote:&lt;BR&gt;&amp;gt;&amp;gt;&nbsp;Hi,&lt;BR&gt;&amp;gt;&amp;gt;&nbsp;im&nbsp;new&nbsp;to&nbsp;RabbitMQ&nbsp;and&nbsp;i&nbsp;have&nbsp;a&nbsp;question&nbsp;about&nbsp;the&nbsp;memory&nbsp;usage&nbsp;of&nbsp;RabbitMQ.&nbsp;I&nbsp;read&nbsp;that&nbsp;since&nbsp;RabbitMQ&nbsp;2.x&nbsp;i&nbsp;don't&nbsp;need&nbsp;to&nbsp;care&nbsp;about&nbsp;fast&nbsp;producers&nbsp;and&nbsp;slow&nbsp;consumers&nbsp;and&nbsp;so&nbsp;don't&nbsp;need&nbsp;to&nbsp;care&nbsp;about&nbsp;the&nbsp;amount&nbsp;of&nbsp;messages&nbsp;in&nbsp;a&nbsp;queue&nbsp;and&nbsp;memory&nbsp;usage.&nbsp;After&nbsp;a&nbsp;test&nbsp;yesterday&nbsp;with&nbsp;2GB&nbsp;memory&nbsp;and&nbsp;4M&nbsp;messages&nbsp;in&nbsp;a&nbsp;queue&nbsp;(no&nbsp;consumer)&nbsp;RabbitMQ&nbsp;reached&nbsp;high&nbsp;memory&nbsp;watermark&nbsp;and&nbsp;stopped.&nbsp;Can&nbsp;somebody&nbsp;explain&nbsp;that&nbsp;behaviour?&lt;BR&gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&amp;gt;&nbsp;Thanks&nbsp;a&nbsp;lot&lt;BR&gt;&amp;gt;&amp;gt;&nbsp;Hagbard&lt;BR&gt;&lt;/DIV&gt;
</tt>
