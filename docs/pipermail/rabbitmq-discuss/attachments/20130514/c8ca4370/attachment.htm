<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;style&gt;Maybe&nbsp;I&amp;#39;m&nbsp;misunderstanding&nbsp;how&nbsp;this&nbsp;is&nbsp;meant&nbsp;to&nbsp;work&nbsp;- I&nbsp;have&nbsp;3&nbsp;RabbitMQs:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cloud&nbsp;(10.9.0.1)&lt;/div&gt;&lt;div&gt;London&nbsp;(10.9.0.2)&lt;/div&gt;&lt;div&gt;Moscow&nbsp;(10.9.0.3)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;I&nbsp;want&nbsp;to&nbsp;federate&nbsp;messages&nbsp;from&nbsp;London&nbsp;and&nbsp;Moscow&nbsp;to&nbsp;Cloud. I&nbsp;create&nbsp;2&nbsp;username/passwords&nbsp;on&nbsp;the&nbsp;&amp;quot;Cloud&amp;quot;&nbsp;rabbitmq&nbsp;(with&nbsp;appropriate&nbsp;permissions):&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;london:password1&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;moscow:password2&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;style&gt;I&nbsp;then&nbsp;add&nbsp;1&nbsp;upstream&nbsp;for&nbsp;the&nbsp;London&nbsp;and&nbsp;1&nbsp;upstream&nbsp;for&nbsp;the&nbsp;Moscow&nbsp;RabbitMQ:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;London: amqp://&lt;a&nbsp;href=&quot;http://london:password1@10.9.0.1/oracle&quot;&gt;london:password1@10.9.0.1/oracle&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;Moscow: amqp://&lt;a&nbsp;href=&quot;http://moscow:password1@10.9.0.1/oracle&quot;&gt;moscow:password1@10.9.0.1/oracle&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;The&nbsp;upstreams&nbsp;point&nbsp;to&nbsp;the&nbsp;Cloud&nbsp;RabbitMQ&nbsp;IP&nbsp;which&nbsp;has&nbsp;the&nbsp;appropriate&nbsp;usernames/passwords&nbsp;and&nbsp;permissions.&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Now&nbsp;when&nbsp;I&nbsp;crate&nbsp;a&nbsp;federate-me&nbsp;policy,&nbsp;I&nbsp;get&nbsp;an&nbsp;error&nbsp;&amp;quot;{error,user_does_not_exist}&amp;quot;&nbsp;unless&nbsp;I&nbsp;set&nbsp;a&nbsp;local-username&nbsp;on&nbsp;the&nbsp;Cloud&nbsp;RabbitMQ&nbsp;with:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;<br>
<br>
rabbitmqctl&nbsp;-p&nbsp;oracle&nbsp;set_parameter&nbsp;federation&nbsp;local-username&nbsp;&amp;#39;&amp;quot;London&amp;quot;&amp;#39;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Then&nbsp;the&nbsp;London&nbsp;RabbitMQ&nbsp;is&nbsp;able&nbsp;to&nbsp;connect,&nbsp;but&nbsp;Moscow&nbsp;still&nbsp;says&nbsp;user_does_not_exist. My&nbsp;question&nbsp;is&nbsp;why&nbsp;is&nbsp;this&nbsp;and&nbsp;how&nbsp;do&nbsp;I&nbsp;accept&nbsp;both&nbsp;usernames?&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Roman&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;14&nbsp;May&nbsp;2013&nbsp;11:11,&nbsp;Simon&nbsp;MacMullen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:simon@rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;simon@rabbitmq.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;13/05/13&nbsp;18:18,&nbsp;Roman&nbsp;Gaufman&nbsp;wrote:&lt;br&gt;<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;want&nbsp;to&nbsp;have&nbsp;20&nbsp;or&nbsp;so&nbsp;clients&nbsp;reading/writing&nbsp;to&nbsp;a&nbsp;local&nbsp;rabbitmq&lt;br&gt;<br>
which&nbsp;will&nbsp;federate&nbsp;to&nbsp;a&nbsp;central&nbsp;server&nbsp;(in&nbsp;both&nbsp;directions).&nbsp;Each&lt;br&gt;<br>
client&nbsp;has&nbsp;a&nbsp;separate&nbsp;username,&nbsp;password&nbsp;and&nbsp;permissions.&lt;br&gt;<br>
&lt;br&gt;<br>
Reason&nbsp;it&nbsp;is&nbsp;done&nbsp;this&nbsp;way&nbsp;is&nbsp;the&nbsp;servers&nbsp;are&nbsp;on&nbsp;very&nbsp;unstable&lt;br&gt;<br>
connections&nbsp;on&nbsp;the&nbsp;move.&lt;br&gt;<br>
&lt;br&gt;<br>
Right&nbsp;now,&nbsp;when&nbsp;I&nbsp;try&nbsp;to&nbsp;connect&nbsp;more&nbsp;than&nbsp;1&nbsp;federation&nbsp;upstream,&nbsp;I&lt;br&gt;<br>
get:&nbsp; **&nbsp;{error,user_does_not_exist}&lt;br&gt;<br>
&lt;br&gt;<br>
It&nbsp;seems&nbsp;all&nbsp;of&nbsp;these&nbsp;servers&nbsp;need&nbsp;to&nbsp;be&nbsp;forced&nbsp;to&nbsp;use&nbsp;the&nbsp;same&lt;br&gt;<br>
username?&nbsp;-&nbsp;Why&nbsp;is&nbsp;this?&nbsp;-&nbsp;Is&nbsp;there&nbsp;any&nbsp;way&nbsp;not&nbsp;to&nbsp;have&nbsp;a&lt;br&gt;<br>
&amp;quot;local-username&amp;quot;&nbsp;but&nbsp;rather&nbsp;to&nbsp;accept&nbsp;all&nbsp;usernames?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
I&nbsp;am&nbsp;not&nbsp;sure&nbsp;I&nbsp;understand&nbsp;what&nbsp;you&nbsp;are&nbsp;saying.&nbsp;The&nbsp;&amp;quot;local-username&amp;quot;&nbsp;parameter&nbsp;is&nbsp;used&nbsp;by&nbsp;the&nbsp;federation&nbsp;mechanism&nbsp;as&nbsp;the&nbsp;local&nbsp;user&nbsp;as&nbsp;which&nbsp;to&nbsp;publish&nbsp;messages&nbsp;which&nbsp;have&nbsp;been&nbsp;received&nbsp;over&nbsp;federation.&nbsp;It&nbsp;doesn&amp;#39;t&nbsp;have&nbsp;anything&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;remote&nbsp;user&nbsp;(which&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;upstream&nbsp;URL).&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Cheers,&nbsp;Simon&lt;span&nbsp;class=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Simon&nbsp;MacMullen&lt;br&gt;<br>
RabbitMQ,&nbsp;Pivotal&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
