<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.28.1&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Our&nbsp;server&nbsp;has&nbsp;32GB&nbsp;ram.&nbsp;And&nbsp;most&nbsp;of&nbsp;the&nbsp;time&nbsp;25GB&nbsp;is&nbsp;free.&nbsp;Please&nbsp;note&nbsp;that&nbsp;it&nbsp;is&nbsp;occurring&nbsp;on&nbsp;production&nbsp;system.&nbsp;We&nbsp;try&nbsp;to&nbsp;reproduce&nbsp;it&nbsp;on&nbsp;different&nbsp;machines&nbsp;but&nbsp;unable&nbsp;to&nbsp;do&nbsp;so.&nbsp;Ubuntu&nbsp;Server&nbsp;9.04&nbsp;is&nbsp;installed&nbsp;on&nbsp;server.&nbsp;Please&nbsp;note&nbsp;that&nbsp;if&nbsp;we&nbsp;delete&nbsp;mnesia&nbsp;files&nbsp;then&nbsp;we&nbsp;are&nbsp;able&nbsp;to&nbsp;start&nbsp;rabbitmq&nbsp;server.&nbsp;We&nbsp;suspect&nbsp;that&nbsp;mnesia&nbsp;files&nbsp;get&nbsp;corrupted&nbsp;due&nbsp;to&nbsp;which&nbsp;rabbitmq&nbsp;server&nbsp;does&nbsp;not&nbsp;start.&nbsp;Can&nbsp;you&nbsp;please&nbsp;guide&nbsp;us&nbsp;on&nbsp;exactly&nbsp;what&nbsp;log&nbsp;files&nbsp;do&nbsp;you&nbsp;need&nbsp;us&nbsp;to&nbsp;provide&nbsp;you?&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;Thu,&nbsp;2010-06-17&nbsp;at&nbsp;13:27&nbsp;+0100,&nbsp;Matthew&nbsp;Sackman&nbsp;wrote:<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
Hi&nbsp;Waqas,<br>
<br>
Please&nbsp;try&nbsp;and&nbsp;keep&nbsp;the&nbsp;mailing&nbsp;list&nbsp;CC'd.<br>
<br>
On&nbsp;Thu,&nbsp;Jun&nbsp;17,&nbsp;2010&nbsp;at&nbsp;05:13:23PM&nbsp;+0500,&nbsp;Waqas&nbsp;Badar&nbsp;wrote:<br>
&amp;gt;&nbsp;We&nbsp;are&nbsp;using&nbsp;RabbitMQ&nbsp;1.7.1&nbsp;and&nbsp;we&nbsp;are<br>
&amp;gt;&nbsp;using&nbsp;Java&nbsp;client&nbsp;1.7.1&nbsp;and&nbsp;for&nbsp;python&nbsp;pyamqp&nbsp;0.6.1&nbsp;and&nbsp;txamqp&nbsp;0.3.<br>
<br>
Ok.&nbsp;1.7.1&nbsp;was&nbsp;less&nbsp;capable&nbsp;about&nbsp;dealing&nbsp;with&nbsp;situations&nbsp;in&nbsp;which&nbsp;it&nbsp;was<br>
running&nbsp;out&nbsp;of&nbsp;memory.&nbsp;I'd&nbsp;recommend&nbsp;upgrading&nbsp;to&nbsp;1.8.0,&nbsp;though&nbsp;be&nbsp;aware<br>
that&nbsp;none&nbsp;of&nbsp;your&nbsp;queues,&nbsp;exchanges,&nbsp;bindings&nbsp;or&nbsp;messages&nbsp;will&nbsp;be<br>
retained&nbsp;when&nbsp;you&nbsp;upgrade.<br>
<br>
&amp;gt;&nbsp;Please&nbsp;note&nbsp;that&nbsp;most&nbsp;of&nbsp;the&nbsp;time&nbsp;it&nbsp;crashes&nbsp;after&nbsp;200000&nbsp;messages.<br>
&amp;gt;&nbsp;Following&nbsp;crash&nbsp;reports&nbsp;are&nbsp;found&nbsp;in&nbsp;rabbit-sasl.log&nbsp;file.<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;=CRASH&nbsp;REPORT====&nbsp;15-Jun-2010::22:41:10&nbsp;===<br>
&amp;gt;&nbsp;&nbsp;&nbsp;crasher:<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid:&nbsp;&amp;lt;0.155.0&amp;gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registered_name:&nbsp;rabbit_persister<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exception&nbsp;exit:&nbsp;{{badmatch,eof},<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[{rabbit_persister,internal_load_snapshot,2},<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{rabbit_persister,init,1},<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{gen_server,init_it,6},<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{proc_lib,init_p_do_apply,3}]}<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;function&nbsp;&nbsp;gen_server:init_it/6<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;call:&nbsp;rabbit_persister:init/1<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ancestors:&nbsp;[rabbit_sup,&amp;lt;0.109.0&amp;gt;]<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages:&nbsp;[]<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;links:&nbsp;[&amp;lt;0.112.0&amp;gt;,&amp;lt;&lt;A&nbsp;HREF=&quot;mailto:support@rabbitmq.com&quot;&gt;support@rabbitmq.com&lt;/A&gt;&nbsp;0.156.0&amp;gt;]<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dictionary:&nbsp;[]<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trap_exit:&nbsp;true<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status:&nbsp;running<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heap_size:&nbsp;987<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stack_size:&nbsp;23<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reductions:&nbsp;431<br>
&amp;gt;&nbsp;&nbsp;&nbsp;neighbours:<br>
<br>
Err,&nbsp;this&nbsp;looks&nbsp;like&nbsp;it&nbsp;crashing&nbsp;when&nbsp;it's&nbsp;starting&nbsp;up,&nbsp;not&nbsp;it&nbsp;crashing<br>
when&nbsp;it's&nbsp;just&nbsp;run&nbsp;out&nbsp;of&nbsp;memory.&nbsp;The&nbsp;eof&nbsp;is&nbsp;interesting&nbsp;though.&nbsp;This<br>
could&nbsp;just&nbsp;be&nbsp;an&nbsp;old&nbsp;bug&nbsp;where&nbsp;you&nbsp;needed&nbsp;to&nbsp;move&nbsp;the&nbsp;old&nbsp;persister&nbsp;log<br>
out&nbsp;of&nbsp;the&nbsp;way:<br>
<br>
In&nbsp;/var/lib/rabbitmq/mnesia/$NODENAME/&nbsp;you&nbsp;should&nbsp;find&nbsp;a<br>
rabbit_persister.LOG&nbsp;and&nbsp;a&nbsp;rabbit_persister.LOG.previous&nbsp;file.&nbsp;It's<br>
likely&nbsp;the&nbsp;.previous&nbsp;version&nbsp;is&nbsp;much&nbsp;bigger&nbsp;than&nbsp;the&nbsp;non&nbsp;.previous<br>
version.&nbsp;You&nbsp;could&nbsp;try&nbsp;moving&nbsp;the&nbsp;rabbit_persister.LOG&nbsp;out&nbsp;of&nbsp;the&nbsp;way,<br>
and&nbsp;then&nbsp;renaming&nbsp;rabbit_persister.LOG.previous&nbsp;to&nbsp;rabbit_persister.LOG<br>
and&nbsp;see&nbsp;if&nbsp;it&nbsp;starts&nbsp;up.<br>
<br>
Again,&nbsp;I&nbsp;*think*&nbsp;this&nbsp;was&nbsp;a&nbsp;bug&nbsp;that&nbsp;was&nbsp;reported&nbsp;quite&nbsp;often&nbsp;with&nbsp;1.7.1<br>
and&nbsp;older&nbsp;and&nbsp;something&nbsp;that&nbsp;we've&nbsp;subsequently&nbsp;fixed,&nbsp;so&nbsp;again,&nbsp;you<br>
might&nbsp;have&nbsp;better&nbsp;luck&nbsp;after&nbsp;upgrading&nbsp;Rabbit&nbsp;to&nbsp;1.8.0.<br>
<br>
I&nbsp;am&nbsp;still&nbsp;curious&nbsp;to&nbsp;see&nbsp;the&nbsp;logs&nbsp;of&nbsp;rabbit&nbsp;as&nbsp;it&nbsp;crashes&nbsp;on&nbsp;you&nbsp;if&nbsp;you<br>
can&nbsp;find/produce&nbsp;those.&nbsp;What&nbsp;platform&nbsp;are&nbsp;you&nbsp;running&nbsp;on,&nbsp;and&nbsp;how&nbsp;much<br>
RAM&nbsp;is&nbsp;available&nbsp;in&nbsp;the&nbsp;machine?<br>
<br>
Matthew<br>
<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
