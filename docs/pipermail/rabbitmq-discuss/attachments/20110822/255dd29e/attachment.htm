<tt>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;TITLE&gt;Re:&nbsp;[rabbitmq-discuss]&nbsp;Management&nbsp;Plugin&nbsp;stops&nbsp;gathering&nbsp;stats&nbsp;?&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;A&nbsp;follow&nbsp;on&nbsp;is:&lt;BR&gt;<br>
&lt;BR&gt;<br>
Would&nbsp;the&nbsp;mgmt-plugin&nbsp;reporting&nbsp;a&nbsp;false&nbsp;stat&nbsp;of&nbsp;&amp;#8220;~0&nbsp;TPS&amp;#8221;&nbsp;result&nbsp;in&nbsp;rabbit&nbsp;**&lt;B&gt;&lt;U&gt;not&nbsp;throttling&lt;/U&gt;&lt;/B&gt;**&nbsp;when&nbsp;it&nbsp;exceeds&nbsp;the&nbsp;high&nbsp;watermark&nbsp;for&nbsp;memory?&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;http://i.imgur.com/TMk3O.png&quot;&gt;http://i.imgur.com/TMk3O.png&lt;/a&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&amp;#8217;m&nbsp;afraid&nbsp;that&nbsp;if&nbsp;I&nbsp;&amp;#8220;dial&nbsp;up&amp;#8221;&nbsp;my&nbsp;load&nbsp;test&nbsp;any&nbsp;further&nbsp;it&nbsp;could&nbsp;cause&nbsp;rabbit&nbsp;to&nbsp;start&nbsp;swapping&nbsp;when&nbsp;instead&nbsp;it&nbsp;should&nbsp;be&nbsp;garbage&nbsp;collecting&nbsp;to&nbsp;reclaim&nbsp;some&nbsp;memory.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Reminder:&nbsp;The&nbsp;load&nbsp;test&nbsp;is&nbsp;quite&nbsp;&amp;#8220;light&amp;#8221;...&nbsp;10&nbsp;concurrent&nbsp;producers,&nbsp;each&nbsp;at&nbsp;about&nbsp;10&nbsp;TPS&nbsp;a&nbsp;second&nbsp;(100&nbsp;ms&nbsp;sleep&nbsp;time&nbsp;for&nbsp;each&nbsp;task);&nbsp;10&nbsp;queues,&nbsp;each&nbsp;with&nbsp;10&nbsp;consumers&nbsp;on&nbsp;their&nbsp;own&nbsp;threads.&nbsp;&amp;nbsp;=&amp;gt;&nbsp;100&nbsp;TPS&nbsp;sustained&nbsp;load.&nbsp;&amp;nbsp;The&nbsp;payload&nbsp;is&nbsp;a&nbsp;BigDecimal&nbsp;wrapped&nbsp;with&nbsp;a&nbsp;simple&nbsp;&amp;lt;value&amp;gt;&amp;lt;/value&amp;gt;&nbsp;tag&nbsp;for&nbsp;XML.&lt;BR&gt;<br>
&lt;BR&gt;<br>
-rparra&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;8/22/11&nbsp;12:31&nbsp;PM,&nbsp;&amp;quot;Rene&nbsp;Parra&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;rparra@homeaway.com&quot;&gt;rparra@homeaway.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;BLOCKQUOTE&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;Hi&nbsp;everyone...&lt;BR&gt;<br>
&lt;BR&gt;<br>
I&amp;#8217;ve&nbsp;been&nbsp;performing&nbsp;a&nbsp;load/soak&nbsp;test&nbsp;on&nbsp;RabbitMQ&nbsp;before&nbsp;we&nbsp;promote&nbsp;our&nbsp;configuration&nbsp;into&nbsp;production,&nbsp;and&nbsp;have&nbsp;run&nbsp;into&nbsp;a&nbsp;little&nbsp;bit&nbsp;of&nbsp;a&nbsp;snag.&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;Management&nbsp;Plugin&nbsp;seems&nbsp;to&nbsp;gather&nbsp;statistics&nbsp;on&nbsp;the&nbsp;test&nbsp;just&nbsp;fine,&nbsp;but&nbsp;after&nbsp;about&nbsp;~6min&nbsp;to&nbsp;about&nbsp;~12min&nbsp;into&nbsp;the&nbsp;soak&nbsp;test,&nbsp;the&nbsp;management&nbsp;plugin&nbsp;seems&nbsp;to&nbsp;&amp;nbsp;STOP&nbsp;collecting&nbsp;stats&nbsp;on&nbsp;my&nbsp;queues!!&nbsp;&amp;nbsp;Thereafter,&nbsp;the&nbsp;throughput&nbsp;seemingly&nbsp;(but&nbsp;falsely)&nbsp;goes&nbsp;to&nbsp;zero.&nbsp;The&nbsp;test&nbsp;is&nbsp;actually&nbsp;proceeding&nbsp;just&nbsp;fine&nbsp;and&nbsp;queues&nbsp;are&nbsp;happily&nbsp;receiving,&nbsp;delivering,&nbsp;and&nbsp;receiving&nbsp;acks&nbsp;for&nbsp;their&nbsp;messages.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Restarting&nbsp;the&nbsp;disk&nbsp;node&nbsp;seems&nbsp;to&nbsp;clear&nbsp;the&nbsp;management&nbsp;plugin&nbsp;to&nbsp;resume&nbsp;collecting&nbsp;statistics.&lt;BR&gt;<br>
&lt;BR&gt;<br>
My&nbsp;question&nbsp;is:&nbsp;Is&nbsp;there&nbsp;some&nbsp;upper&nbsp;threshold&nbsp;in&nbsp;the&nbsp;management&nbsp;plugin&nbsp;that&nbsp;I&nbsp;need&nbsp;to&nbsp;set&nbsp;to&nbsp;continue&nbsp;gathering&nbsp;statistics&nbsp;throughout&nbsp;my&nbsp;test&nbsp;?&nbsp;&amp;nbsp;This&nbsp;feels&nbsp;like&nbsp;a&nbsp;classic&nbsp;&amp;#8220;invisible&nbsp;threshold&nbsp;being&nbsp;hit&nbsp;somewhere&amp;#8221;&nbsp;problem.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Here&amp;#8217;s&nbsp;a&nbsp;snapshot&nbsp;of&nbsp;the&nbsp;management&nbsp;UI&nbsp;screen&nbsp;working&nbsp;as&nbsp;expected:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;http://i.imgur.com/8eXNM.png&quot;&gt;http://i.imgur.com/8eXNM.png&lt;/a&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
Here&amp;#8217;s&nbsp;a&nbsp;ScreenCast&nbsp;of&nbsp;the&nbsp;management&nbsp;UI&nbsp;working&nbsp;and&nbsp;then&nbsp;&amp;#8220;FAILS&amp;#8221;:&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;http://goo.gl/jrvAP&quot;&gt;http://goo.gl/jrvAP&lt;/a&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;B&gt;(please&nbsp;fast&nbsp;forward&nbsp;to&nbsp;these&nbsp;time&nbsp;points&nbsp;in&nbsp;the&nbsp;screencast)&lt;BR&gt;<br>
&lt;/B&gt;&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;UL&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;@2m&nbsp;16s:&nbsp;&amp;nbsp;The&nbsp;system&nbsp;runs&nbsp;normally&nbsp;and&nbsp;then&nbsp;I&nbsp;demo&nbsp;the&nbsp;queues&nbsp;stats&nbsp;collection&nbsp;working&nbsp;perfectly.&nbsp;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;@2m&nbsp;56s:&nbsp;&amp;nbsp;Connection&nbsp;View&nbsp;shows&nbsp;normal&nbsp;operating&nbsp;behavior.&nbsp;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;@3m&nbsp;34s:&nbsp;&amp;nbsp;The&nbsp;&amp;#8220;weird&nbsp;behavior&amp;#8221;&nbsp;begins...&nbsp;it&nbsp;seems&nbsp;that&nbsp;TPS&nbsp;drops&nbsp;off&nbsp;to&nbsp;30&nbsp;TPS&nbsp;then&nbsp;0&nbsp;TPS!!&nbsp;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;LI&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;@4m&nbsp;22s:&nbsp;&amp;nbsp;Connection&nbsp;View&nbsp;showing&nbsp;throughput&nbsp;has&nbsp;&amp;#8220;stopped&amp;#8221;.&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/UL&gt;&lt;FONT&nbsp;FACE=&quot;Calibri,&nbsp;Verdana,&nbsp;Helvetica,&nbsp;Arial&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:11pt'&gt;&lt;BR&gt;<br>
External&nbsp;metric&nbsp;gathering&nbsp;confirms&nbsp;the&nbsp;test&nbsp;still&nbsp;&amp;#8220;runs&amp;#8221;&nbsp;and&nbsp;messages&nbsp;are&nbsp;being&nbsp;delivered&nbsp;successfully.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Has&nbsp;anyone&nbsp;else&nbsp;experienced&nbsp;this&nbsp;weirdness&nbsp;with&nbsp;the&nbsp;mgmt&nbsp;plugin?&lt;BR&gt;<br>
&lt;BR&gt;<br>
Any&nbsp;help&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated.&lt;BR&gt;<br>
-rparra&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&lt;HR&nbsp;ALIGN=CENTER&nbsp;SIZE=&quot;3&quot;&nbsp;WIDTH=&quot;95%&quot;&gt;&lt;/SPAN&gt;&lt;/FONT&gt;&lt;FONT&nbsp;SIZE=&quot;2&quot;&gt;&lt;FONT&nbsp;FACE=&quot;Consolas,&nbsp;Courier&nbsp;New,&nbsp;Courier&quot;&gt;&lt;SPAN&nbsp;STYLE='font-size:10pt'&gt;_______________________________________________&lt;BR&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;rabbitmq-discuss@lists.rabbitmq.com&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;BR&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;BR&gt;<br>
&lt;/SPAN&gt;&lt;/FONT&gt;&lt;/FONT&gt;&lt;/BLOCKQUOTE&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
