<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Kamal,&lt;br&gt;&lt;br&gt;It&nbsp;looks&nbsp;like&nbsp;you&nbsp;are&nbsp;mistaking&nbsp;Channel.basicConsume&nbsp;for&nbsp;Channel.basicGet.&nbsp;The&nbsp;first&nbsp;(which&nbsp;you&nbsp;are&nbsp;using)&nbsp;is&nbsp;asynchronous&nbsp;and&nbsp;what&nbsp;it&nbsp;does&nbsp;is&nbsp;subscribe&nbsp;a&nbsp;consumer&nbsp;with&nbsp;the&nbsp;messaging&nbsp;server&nbsp;on&nbsp;a&nbsp;given&nbsp;queue.&nbsp;All&nbsp;incoming&nbsp;messages&nbsp;to&nbsp;do&nbsp;that&nbsp;queue&nbsp;will&nbsp;be&nbsp;directly&nbsp;sent&nbsp;by&nbsp;the&nbsp;messaging&nbsp;server&nbsp;to&nbsp;that&nbsp;subscribed&nbsp;consumer.&nbsp;In&nbsp;the&nbsp;QueuingConsumer&nbsp;implementation,&nbsp;those&nbsp;received&nbsp;messages&nbsp;are&nbsp;held&nbsp;in&nbsp;an&nbsp;internal&nbsp;queue&nbsp;and&nbsp;you&nbsp;fetch&nbsp;them&nbsp;using&nbsp;nextDelivery.&lt;br&gt;<br>
<br>
<br>
<br>
&lt;br&gt;This&nbsp;model&nbsp;is&nbsp;called&nbsp;subscription-based,&nbsp;another&nbsp;simpler&nbsp;approach&nbsp;is&nbsp;using&nbsp;Channel.basicGet.&nbsp;I&nbsp;advise&nbsp;you&nbsp;to&nbsp;check&nbsp;this&nbsp;for&nbsp;details:&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.rabbitmq.com/api-guide.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.rabbitmq.com/api-guide.html&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>
<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Apr&nbsp;11,&nbsp;2011&nbsp;at&nbsp;3:19&nbsp;PM,&nbsp;Kamal&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kamal.nandan@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;kamal.nandan@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;facing&nbsp;a&nbsp;strange&nbsp;problem&nbsp;while&nbsp;using&nbsp;RabbitMq.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;a&nbsp;consumer&nbsp;that&nbsp;creates&nbsp;3&nbsp;queues(just&nbsp;for&nbsp;name&nbsp;sake&nbsp;HIGH/MEDIUM/&lt;br&gt;<br>
LOW&nbsp;priority&nbsp;queues)&nbsp;on&nbsp;the&nbsp;RabbitMQ&nbsp;server&nbsp;and&nbsp;consumes&nbsp;data&nbsp;from&nbsp;the&lt;br&gt;<br>
3&nbsp;queues&nbsp;in&nbsp;this&nbsp;order:&lt;br&gt;<br>
5&nbsp;messages&nbsp;from&nbsp;HIGH&lt;br&gt;<br>
3&nbsp;messages&nbsp;from&nbsp;MEDIUM&lt;br&gt;<br>
2&nbsp;messages&nbsp;from&nbsp;LOW.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;keeps&nbsp;on&nbsp;happening&nbsp;in&nbsp;round-robin&nbsp;fashion.&lt;br&gt;<br>
If&nbsp;there&nbsp;is&nbsp;no&nbsp;data&nbsp;available&nbsp;on&nbsp;the&nbsp;respective&nbsp;queue,&nbsp;the&nbsp;data&nbsp;from&lt;br&gt;<br>
the&nbsp;next&nbsp;queue&nbsp;is&nbsp;fetched.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;using&nbsp;&amp;quot;Channel.basicConsume(queueName,&nbsp;ACK,&nbsp;QueueingConsumer)&amp;quot;&lt;br&gt;<br>
and&nbsp;&amp;quot;QueueingConsumer.nextDelivery(timeout)&amp;quot;&nbsp;to&nbsp;fetch&nbsp;the&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
What&nbsp;I&nbsp;see&nbsp;here&nbsp;is:&nbsp;I&nbsp;see&nbsp;that&nbsp;the&nbsp;data&nbsp;is&nbsp;fetched&nbsp;from&nbsp;the&nbsp;other&lt;br&gt;<br>
queues&nbsp;too.&nbsp;i.e.&nbsp;Even&nbsp;though&nbsp;I&nbsp;have&nbsp;passed&nbsp;the&nbsp;queuename&nbsp;as&nbsp;&amp;quot;HIGH&amp;quot;,&lt;br&gt;<br>
then&nbsp;too&nbsp;i&nbsp;see&nbsp;that&nbsp;the&nbsp;data&nbsp;is&nbsp;being&nbsp;fetched&nbsp;from&nbsp;the&nbsp;queue&nbsp;&amp;quot;LOW&amp;quot;&nbsp;or&lt;br&gt;<br>
&amp;quot;MEDIUM&amp;quot;&nbsp;and&nbsp;vice&nbsp;versa.&nbsp;I&nbsp;am&nbsp;finding&nbsp;this&nbsp;behaviour&nbsp;quite&nbsp;strange.&lt;br&gt;<br>
Can&nbsp;someone&nbsp;plz&nbsp;help&nbsp;me&nbsp;out&nbsp;with&nbsp;this.&lt;br&gt;<br>
&lt;br&gt;<br>
Following&nbsp;is&nbsp;a&nbsp;snippet&nbsp;of&nbsp;my&nbsp;code.:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://pastebin.com/s03dP91z&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/s03dP91z&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;in&nbsp;advance..&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;Kamal&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
rabbitmq-discuss&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:rabbitmq-discuss@lists.rabbitmq.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rabbitmq-discuss@lists.rabbitmq.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss&lt;/a&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Amr&nbsp;Mostafa&lt;br&gt;Egypt&nbsp;Development&nbsp;Center&lt;br&gt;Member&nbsp;of&nbsp;NTG&lt;br&gt;Mobile:&nbsp;+(2012)1700502&lt;br&gt;Office:&nbsp;+(202)24052355/6&nbsp;-&nbsp;Ext.:&nbsp;2005&lt;br&gt;<br>
&lt;/div&gt;<br>

</tt>
