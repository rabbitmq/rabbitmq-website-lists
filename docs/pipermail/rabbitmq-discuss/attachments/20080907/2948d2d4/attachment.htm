<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;had&nbsp;a&nbsp;surprise&nbsp;when&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;Erlang&nbsp;client&nbsp;on&nbsp;a&nbsp;node&nbsp;on&nbsp;which&nbsp;RabbitMQ&nbsp;Server&nbsp;was&nbsp;not&nbsp;installed.&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;=CRASH&nbsp;REPORT====&nbsp;7-Sep-2008::02:41:39&nbsp;===&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&nbsp;crasher:&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;pid:&nbsp;&amp;lt;0.165.0&amp;gt;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;registered_name:&nbsp;[]&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;exception&nbsp;exit:&nbsp;{undef,&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;b&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[{rabbit_framing_channel,start_link,&lt;br&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[#Fun&amp;lt;amqp_network_driver.0.106693221&amp;gt;,&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[&amp;lt;0.165.0&amp;gt;]]},&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;{amqp_network_driver,handshake,1},&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;A&nbsp;network&nbsp;client&nbsp;should&nbsp;not&nbsp;require&nbsp;server&nbsp;code&nbsp;to&nbsp;be&nbsp;installed&nbsp;on&nbsp;the&nbsp;same&nbsp;node.&nbsp;This&nbsp;is&nbsp;certainly&nbsp;true&nbsp;of&nbsp;other&nbsp;clients&nbsp;I&nbsp;have&nbsp;used.&nbsp;&lt;br&gt;&lt;br&gt;On&nbsp;further&nbsp;investigation,&nbsp;I&nbsp;found&nbsp;a&nbsp;number&nbsp;of&nbsp;direct&nbsp;calls&nbsp;and&nbsp;references&nbsp;to&nbsp;an&nbsp;installed&nbsp;server:&lt;br&gt;<br>
&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_channel.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_channel.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_amqqueue:notify_sent(Q,&nbsp;ChPid),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_connection.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_consumer.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;FramingPid&nbsp;=&nbsp;rabbit_framing_channel:start_link(fun(X)&nbsp;-&amp;gt;&nbsp;X&nbsp;end,&nbsp;[Parent]),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_writer:shutdown(WriterPid).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_writer:send_command(Writer,&nbsp;Close),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_writer:shutdown(Writer),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:do(Writer,&nbsp;Method)&nbsp;-&amp;gt;&nbsp;rabbit_writer:send_command(Writer,&nbsp;Method).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:do(Writer,&nbsp;Method,&nbsp;Content)&nbsp;-&amp;gt;&nbsp;rabbit_writer:send_command(Writer,&nbsp;Method,&nbsp;Content).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_framing_channel:process(ChPid,&nbsp;Frame).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;response&nbsp;=&nbsp;rabbit_binary_generator:generate_table(LoginTable),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_writer:start(Sock,&nbsp;Channel,&nbsp;?FRAME_MIN_SIZE).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_heartbeat:start_heartbeat(Sock,&nbsp;Heartbeat),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;FramingPid&nbsp;=&nbsp;rabbit_framing_channel:start_link(fun(X)&nbsp;-&amp;gt;&nbsp;link(X),&nbsp;X&nbsp;end,&nbsp;[ChannelPid]),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;case&nbsp;rabbit_reader:analyze_frame(Type,&nbsp;Payload)&nbsp;of&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_misc:die(frame_error);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_network_driver.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;rabbit_misc:die(frame_error);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_rpc_client.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_rpc_client.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;content_type&nbsp;=&nbsp;ContentType}&nbsp;=&nbsp;rabbit_framing:decode_properties(ClassId,&nbsp;PropertiesBin),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_rpc_handler.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_rpc_handler.erl:&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;=&nbsp;rabbit_framing:decode_properties(ClassId,&nbsp;PropertiesBin),&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_rpc_util.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;amqp_util.erl:-include_lib(&amp;quot;rabbitmq_server/include/rabbit_framing.hrl&amp;quot;).&lt;/span&gt;&lt;br&gt;<br>
&lt;br&gt;I&nbsp;left&nbsp;out&nbsp;the&nbsp;direct&nbsp;driver&nbsp;modules&nbsp;because&nbsp;by&nbsp;definition&nbsp;they&nbsp;need&nbsp;to&nbsp;be&nbsp;on&nbsp;the&nbsp;same&nbsp;node.&lt;br&gt;&lt;br&gt;I&nbsp;respectfully&nbsp;suggest&nbsp;that&nbsp;the&nbsp;above&nbsp;RabbitMQ&nbsp;server&nbsp;modules,&nbsp;and&nbsp;their&nbsp;dependencies,&nbsp;be&nbsp;bundled&nbsp;with&nbsp;the&nbsp;Erlang&nbsp;client.&nbsp;Ideally,&nbsp;I&nbsp;would&nbsp;think&nbsp;it&nbsp;would&nbsp;be&nbsp;best&nbsp;perhaps&nbsp;to&nbsp;put&nbsp;them&nbsp;a&nbsp;separate&nbsp;Erlang&nbsp;library&nbsp;application&nbsp;(maybe&nbsp;&amp;quot;rabbitmq_common&amp;quot;)&nbsp;that&nbsp;is&nbsp;used&nbsp;both&nbsp;by&nbsp;the&nbsp;server&nbsp;and&nbsp;the&nbsp;Erlang&nbsp;client.&lt;br&gt;<br>
&lt;br&gt;In&nbsp;addition&nbsp;to&nbsp;that,&nbsp;the&nbsp;include_lib(&amp;quot;rabbitmq_server/include/xxx.hrl&amp;quot;)&nbsp;statements&nbsp;prevent&nbsp;one&nbsp;from&nbsp;even&nbsp;compiling&nbsp;the&nbsp;client&nbsp;unless&nbsp;the&nbsp;server&nbsp;is&nbsp;installed&nbsp;and&nbsp;this&nbsp;should&nbsp;be&nbsp;changed&nbsp;to&nbsp;use&nbsp;the&nbsp;common&nbsp;library&nbsp;app.&nbsp;I&nbsp;was&nbsp;forced&nbsp;to&nbsp;copy&nbsp;the&nbsp;include&nbsp;files&nbsp;and&nbsp;make&nbsp;a&nbsp;dummy&nbsp;rabbitmq_server&nbsp;application&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;compile&nbsp;the&nbsp;client&nbsp;on&nbsp;a&nbsp;different&nbsp;node&nbsp;to&nbsp;the&nbsp;server.&lt;br&gt;<br>
&lt;br&gt;Regards,&lt;br&gt;Edwin&nbsp;Fine&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
