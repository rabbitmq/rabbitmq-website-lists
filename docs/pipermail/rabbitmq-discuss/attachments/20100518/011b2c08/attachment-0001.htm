<tt>
&lt;div&gt;we&nbsp;have&nbsp;scenarios&nbsp;where&nbsp;we&nbsp;pick&nbsp;up&nbsp;a&nbsp;message&nbsp;at&nbsp;a&nbsp;time,&nbsp;perform&nbsp;a&nbsp;bunch&nbsp;of&nbsp;operations,&nbsp;publish&nbsp;a&nbsp;new&nbsp;message&nbsp;and&nbsp;then&nbsp;ack&nbsp;the&nbsp;message&nbsp;we&nbsp;just&nbsp;picked&nbsp;up.&nbsp;Recently&nbsp;we&nbsp;have&nbsp;started&nbsp;to&nbsp;publish&nbsp;the&nbsp;new&nbsp;message&nbsp;inside&nbsp;a&nbsp;transaction&nbsp;since&nbsp;this&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;message&nbsp;is&nbsp;persisted&nbsp;(it&amp;#39;s&nbsp;a&nbsp;persistent&nbsp;message),&nbsp;since&nbsp;we&nbsp;want&nbsp;to&nbsp;minimize&nbsp;the&nbsp;odds&nbsp;of&nbsp;message&nbsp;loss.&nbsp;However,&nbsp;we&nbsp;have&nbsp;started&nbsp;to&nbsp;notice&nbsp;that&nbsp;the&nbsp;original&nbsp;message&nbsp;we&nbsp;pick&nbsp;up&nbsp;is&nbsp;marked&nbsp;as&nbsp;unacknowledged&nbsp;after&nbsp;we&nbsp;complete&nbsp;our&nbsp;process.&nbsp;Is&nbsp;there&nbsp;something&nbsp;fundamentally&nbsp;wrong&nbsp;in&nbsp;what&nbsp;we&amp;#39;re&nbsp;doing,&nbsp;or&nbsp;is&nbsp;our&nbsp;approach&nbsp;correct?&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;thanks&lt;/div&gt;&lt;div&gt;Vishnu&lt;/div&gt;<br>

</tt>
