<tt>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matthias,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style=&quot;color:&nbsp;#A0A0A8;&quot;&gt;On&nbsp;Wednesday,&nbsp;27&nbsp;February&nbsp;2013&nbsp;at&nbsp;18:52,&nbsp;Matthias&nbsp;Radestock&nbsp;wrote:&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;margin-left:0px;padding-left:10px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;&lt;div&gt;Using&nbsp;confirms&nbsp;to&nbsp;exert&nbsp;back&nbsp;pressure&nbsp;on&nbsp;a&nbsp;producing&nbsp;application&nbsp;is&lt;/div&gt;&lt;div&gt;fine.&nbsp;But&nbsp;I&nbsp;wouldn't&nbsp;expect&nbsp;that&nbsp;to&nbsp;result&nbsp;in&nbsp;particularly&nbsp;stable&nbsp;&lt;/div&gt;&lt;div&gt;latencies.&nbsp;For&nbsp;a&nbsp;few&nbsp;reasons:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;one&nbsp;way&nbsp;that&nbsp;the&nbsp;internal&nbsp;confirm&nbsp;logic&nbsp;gets&nbsp;triggered&nbsp;is&nbsp;by&nbsp;&quot;absence&nbsp;&lt;/div&gt;&lt;div&gt;of&nbsp;other&nbsp;stuff&nbsp;happening&quot;,&nbsp;so&nbsp;when&nbsp;throttling&nbsp;producers,&nbsp;confirms&nbsp;may&nbsp;&lt;/div&gt;&lt;div&gt;well&nbsp;happen&nbsp;a&nbsp;lot&nbsp;quicker.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;understand&nbsp;you&nbsp;correctly,&nbsp;then&nbsp;this&nbsp;is&nbsp;precisely&nbsp;the&nbsp;feedback&nbsp;loop&nbsp;that&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;achieve&nbsp;-&nbsp;when&nbsp;the&nbsp;sender&nbsp;is&nbsp;throttled,&nbsp;this&nbsp;gives&nbsp;the&nbsp;internals&nbsp;of&nbsp;Rabbit&nbsp;more&nbsp;head&nbsp;room&nbsp;to&nbsp;do&nbsp;whatever&nbsp;it&nbsp;is&nbsp;a&nbsp;Rabbit&nbsp;does.&nbsp;In&nbsp;Rabbit&nbsp;becoming&nbsp;more&nbsp;free,&nbsp;the&nbsp;rate&nbsp;of&nbsp;confirms&nbsp;increases,&nbsp;and&nbsp;hence&nbsp;the&nbsp;more&nbsp;credit&nbsp;the&nbsp;sender&nbsp;will&nbsp;receive.&nbsp;When&nbsp;the&nbsp;sender&nbsp;ramps&nbsp;up&nbsp;again,&nbsp;the&nbsp;reverse&nbsp;should&nbsp;happen,&nbsp;and&nbsp;so&nbsp;the&nbsp;feedback&nbsp;cycle&nbsp;continues.&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;margin-left:0px;padding-left:10px;&quot;&gt;&lt;span&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;2)&nbsp;more&nbsp;generally,&nbsp;much&nbsp;of&nbsp;the&nbsp;internal&nbsp;confirm&nbsp;logic&nbsp;will&nbsp;try&nbsp;to&nbsp;batch&nbsp;&lt;/div&gt;&lt;div&gt;things&nbsp;if&nbsp;it&nbsp;can,&nbsp;which&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;cost&nbsp;but&nbsp;makes&nbsp;the&nbsp;timing&nbsp;of&nbsp;&lt;/div&gt;&lt;div&gt;confirms&nbsp;more&nbsp;variable.&lt;/div&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That's&nbsp;understandable&nbsp;-&nbsp;fine&nbsp;grained&nbsp;ingress&nbsp;credits&nbsp;would&nbsp;come&nbsp;at&nbsp;a&nbsp;premium&nbsp;in&nbsp;any&nbsp;case.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;my&nbsp;scenario&nbsp;I'm&nbsp;setting&nbsp;a&nbsp;timestamp&nbsp;into&nbsp;the&nbsp;message&nbsp;header&nbsp;and&nbsp;the&nbsp;receiver&nbsp;is&nbsp;decoding&nbsp;this&nbsp;in&nbsp;order&nbsp;to&nbsp;compare&nbsp;it&nbsp;with&nbsp;its&nbsp;current&nbsp;timestamp.&nbsp;With&nbsp;the&nbsp;measurement&nbsp;being&nbsp;end&nbsp;to&nbsp;end,&nbsp;would&nbsp;the&nbsp;asynchronous&nbsp;nature&nbsp;of&nbsp;the&nbsp;confirms&nbsp;not&nbsp;be&nbsp;obviated&nbsp;by&nbsp;the&nbsp;fact&nbsp;that&nbsp;you&nbsp;are&nbsp;measuring&nbsp;the&nbsp;speed&nbsp;of&nbsp;the&nbsp;uplink&nbsp;plus&nbsp;the&nbsp;routing&nbsp;overhead&nbsp;plus&nbsp;the&nbsp;speed&nbsp;of&nbsp;a&nbsp;separate&nbsp;delivery&nbsp;(he&nbsp;says&nbsp;had&nbsp;waving)?&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;margin-left:0px;padding-left:10px;&quot;&gt;&lt;span&gt;&lt;div&gt;3)&nbsp;confirms&nbsp;do&nbsp;come&nbsp;at&nbsp;a&nbsp;noticeable&nbsp;penalty&nbsp;on&nbsp;throughput&nbsp;and&nbsp;latency.&nbsp;&lt;/div&gt;&lt;div&gt;So&nbsp;a&nbsp;benchmark&nbsp;employing&nbsp;confirms&nbsp;would&nbsp;not&nbsp;be&nbsp;a&nbsp;very&nbsp;good&nbsp;proxy&nbsp;for&nbsp;a&nbsp;&lt;/div&gt;&lt;div&gt;real&nbsp;system&nbsp;running&nbsp;w/o&nbsp;confirms.&lt;/div&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;constitutes&nbsp;the&nbsp;performance&nbsp;penalty&nbsp;in&nbsp;this&nbsp;case?&nbsp;Do&nbsp;confirms&nbsp;increase&nbsp;the&nbsp;latency&nbsp;because&nbsp;they&nbsp;add&nbsp;to&nbsp;the&nbsp;measurable&nbsp;round&nbsp;trip&nbsp;as&nbsp;seen&nbsp;by&nbsp;the&nbsp;sender,&nbsp;or&nbsp;does&nbsp;the&nbsp;fact&nbsp;that&nbsp;they&nbsp;are&nbsp;turned&nbsp;on&nbsp;add&nbsp;extra&nbsp;processing&nbsp;effort&nbsp;which&nbsp;is&nbsp;CPU&nbsp;time&nbsp;that&nbsp;has&nbsp;to&nbsp;be&nbsp;spread&nbsp;over&nbsp;each&nbsp;message&nbsp;and&nbsp;hence&nbsp;on&nbsp;average&nbsp;adding&nbsp;latency&nbsp;to&nbsp;each&nbsp;message?&nbsp;If&nbsp;the&nbsp;answer&nbsp;is&nbsp;the&nbsp;latter,&nbsp;does&nbsp;the&nbsp;same&nbsp;apply&nbsp;to&nbsp;throughput&nbsp;-&nbsp;since&nbsp;confirms&nbsp;have&nbsp;a&nbsp;non-zero&nbsp;accounting&nbsp;cost,&nbsp;having&nbsp;them&nbsp;turned&nbsp;on&nbsp;diminishes&nbsp;the&nbsp;ability&nbsp;to&nbsp;process&nbsp;as&nbsp;many&nbsp;items&nbsp;in&nbsp;the&nbsp;same&nbsp;amount&nbsp;of&nbsp;time?&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;style=&quot;border-left-style:solid;border-width:1px;margin-left:0px;padding-left:10px;&quot;&gt;&lt;span&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Having&nbsp;said&nbsp;all&nbsp;that,&nbsp;go&nbsp;and&nbsp;try&nbsp;it&nbsp;:)&lt;/div&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I'm&nbsp;very&nbsp;tempted,&nbsp;but&nbsp;the&nbsp;reason&nbsp;why&nbsp;I'm&nbsp;asking&nbsp;first&nbsp;is&nbsp;to&nbsp;avoid&nbsp;going&nbsp;down&nbsp;any&nbsp;rabbit&nbsp;holes&nbsp;that&nbsp;a&nbsp;more&nbsp;experienced&nbsp;person&nbsp;could&nbsp;potentially&nbsp;advise&nbsp;me&nbsp;to&nbsp;avoid&nbsp;:-)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ben&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt>
