<tt>
Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;I&nbsp;am&nbsp;having&nbsp;difficulty&nbsp;receiving&nbsp;messages&nbsp;inside&nbsp;my&nbsp;application&nbsp;which&nbsp;is&nbsp;an&nbsp;ISAPI&nbsp;dll&nbsp;written&nbsp;in&nbsp;Delphi.&nbsp;&amp;nbsp;I&nbsp;am&nbsp;not&nbsp;trying&nbsp;to&nbsp;use&nbsp;IIS&nbsp;for&nbsp;the&nbsp;RabbitMQ&nbsp;communication,&nbsp;but&nbsp;for&nbsp;other&nbsp;RPC&nbsp;purposes.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;We&nbsp;use&nbsp;RemObjects&nbsp;for&nbsp;our&nbsp;RPC&nbsp;implementation.&amp;nbsp;&nbsp;The&nbsp;server&nbsp;side&nbsp;is&nbsp;compiled&nbsp;as&nbsp;an&nbsp;ISAPI&nbsp;DLL<br>
and&nbsp;runs&nbsp;under&nbsp;IIS&nbsp;(v6&nbsp;and&nbsp;possibly&nbsp;v7).&amp;nbsp;<br>
My&nbsp;test&nbsp;environment&nbsp;is&nbsp;IIS&nbsp;6&nbsp;on&nbsp;Windows&nbsp;2003&nbsp;Server.&amp;nbsp;&nbsp;In<br>
that&nbsp;Delphi&nbsp;ISAPI&nbsp;dll&nbsp;we&nbsp;want&nbsp;to&nbsp;talk&nbsp;to&nbsp;a&nbsp;RabbitMQ&nbsp;broker&nbsp;for&nbsp;server-side&nbsp;work&nbsp;queue&nbsp;processing.&amp;nbsp;&nbsp;Using&nbsp;the&nbsp;Habarisoft&nbsp;Delphi&nbsp;toolkit&nbsp;I&nbsp;can&nbsp;send&nbsp;messages&nbsp;fine,<br>
but&nbsp;I&nbsp;cannot&nbsp;receive&nbsp;them&nbsp;if&nbsp;the&nbsp;code&nbsp;is&nbsp;hosted&nbsp;as&nbsp;ISAPI&nbsp;under&nbsp;IIS.&amp;nbsp;&nbsp;It&nbsp;does&nbsp;not<br>
appear&nbsp;to&nbsp;be&nbsp;a&nbsp;normal&nbsp;firewall&nbsp;issue&nbsp;because&nbsp;I&nbsp;can&nbsp;compile&nbsp;the&nbsp;same&nbsp;code&nbsp;as&nbsp;a<br>
standalone&nbsp;EXE&nbsp;and&nbsp;it&nbsp;runs&nbsp;fine,&nbsp;sending&nbsp;and&nbsp;receiving,&nbsp;on&nbsp;the&nbsp;same&nbsp;Windows&nbsp;2003&nbsp;server.&amp;nbsp;&nbsp;If&nbsp;I&nbsp;put&nbsp;a&nbsp;message&nbsp;in&nbsp;the&nbsp;queue&nbsp;first&nbsp;with&nbsp;the&nbsp;RabbitMQ&nbsp;HTTP&nbsp;Management&nbsp;Tool,&nbsp;then&nbsp;start&nbsp;the&nbsp;ISAPI<br>
server&nbsp;(by&nbsp;sending&nbsp;a&nbsp;command&nbsp;to&nbsp;it&nbsp;through&nbsp;its&nbsp;web-site,&nbsp;forcing&nbsp;the&nbsp;isapi&nbsp;dll<br>
to&nbsp;be&nbsp;loaded),&nbsp;I&nbsp;can&nbsp;see&nbsp;various&nbsp;things&nbsp;in&nbsp;the&nbsp;RabbitMQ&nbsp;console:&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;The&nbsp;connection&nbsp;that&nbsp;appears&nbsp;is&nbsp;STOMP&nbsp;1.0.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;The&nbsp;&quot;name&quot;&nbsp;is&nbsp;192.168.124.129:4298&nbsp;-&amp;gt;<br>
192.168.124.128:61613&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;I&nbsp;can&nbsp;also&nbsp;see&nbsp;that&nbsp;the&nbsp;&quot;ready&quot;&nbsp;count&nbsp;goes&nbsp;from<br>
1&nbsp;to&nbsp;0&nbsp;and&nbsp;the&nbsp;&quot;unacknowledged&quot;&nbsp;count&nbsp;goes&nbsp;from&nbsp;0&nbsp;to&nbsp;1&nbsp;and&nbsp;stays<br>
there.&amp;nbsp;&nbsp;If&nbsp;I&nbsp;stop&nbsp;the&nbsp;app-pool,&nbsp;the<br>
message&nbsp;will&nbsp;revert&nbsp;to&nbsp;ready.&amp;nbsp;&nbsp;Again,&nbsp;I<br>
can&nbsp;run&nbsp;this&nbsp;exact&nbsp;code&nbsp;and&nbsp;get&nbsp;acknowledgements&nbsp;and&nbsp;reply&nbsp;messages&nbsp;if&nbsp;I&nbsp;do&nbsp;not<br>
run&nbsp;it&nbsp;as&nbsp;an&nbsp;ISAPI&nbsp;dll&nbsp;under&nbsp;IIS,&nbsp;but&nbsp;still&nbsp;run&nbsp;it&nbsp;on&nbsp;the&nbsp;same&nbsp;machine.&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
<br>
&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;Thanks&nbsp;for&nbsp;any&nbsp;help.&amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;Adam&nbsp;Hiler&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoPlainText&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;
</tt>
