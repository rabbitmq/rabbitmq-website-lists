<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%203.0.2%20stops%20logging%2C%0A%20but%20otherwise%20looks%20healthy%3F&In-Reply-To=%3CCACLE7izu-a3J0sOg1vM_zX67z7WiWFX6XUpbUi6Cr02wE3T2iQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028616.html">
   <LINK REL="Next"  HREF="028662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?</H1>
    <B>Matt Pietrek</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%203.0.2%20stops%20logging%2C%0A%20but%20otherwise%20looks%20healthy%3F&In-Reply-To=%3CCACLE7izu-a3J0sOg1vM_zX67z7WiWFX6XUpbUi6Cr02wE3T2iQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?">mpietrek at skytap.com
       </A><BR>
    <I>Wed Jul 17 18:55:38 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028616.html">[rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?
</A></li>
        <LI>Next message: <A HREF="028662.html">[rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28636">[ date ]</a>
              <a href="thread.html#28636">[ thread ]</a>
              <a href="subject.html#28636">[ subject ]</a>
              <a href="author.html#28636">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jeff,

The &quot;foobar&quot; in the listing I provided is the result of my search/replace
obfuscation. Don't want internal server names, account names, etc. revealed
unnecessarily.

The logging stopped on only one node of the cluster. The other node
continued to log as expected.

Interestingly, on the broker that still logged, I see this message at the
time of the last log entry of the non-logging machine:

=INFO REPORT==== 2-Jun-2013::11:50:57 ===
rabbit on node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foobar</A> up

(again, where foobar is obfuscated).

Digging around some other logs at the time, I see there was a
mnesia/network split issue just proceeding this. However, the broker now
looks to be happily a part of the cluster, participating in mirrored
queues, and with a reported uptime matching that of the &quot;INFO REPORT&quot; above.


On Tue, Jul 16, 2013 at 10:51 PM, Jeffery, Mark &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">MJeffery at fnb.co.za</A>&gt; wrote:

&gt;<i>  Hello
</I>&gt;<i>
</I>&gt;<i> You mentioned a cluster.
</I>&gt;<i> Is this happening on every box ?
</I>&gt;<i>
</I>&gt;<i> Also, is the rabbit process running as &quot;foobar&quot; ?
</I>&gt;<i>
</I>&gt;<i> Jeff
</I>&gt;<i>
</I>&gt;<i> Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at skytap.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Here you go Mark. The file date/times line up with when I last saw
</I>&gt;<i> logging in the files:
</I>&gt;<i>
</I>&gt;<i> 23:14 PROD <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at foomq1</A>:/proc/16050$ sudo ls -latr fd
</I>&gt;<i> total 0
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 11:50 2 -&gt; /foobar/logs/
</I>&gt;<i> foomq1.foo.bar.com/rabbitmq-server.log
</I>&gt;<i> dr-xr-xr-x 7 foobar foobar  0 2013-06-02 11:50 ..
</I>&gt;<i> dr-x------ 2 foobar foobar  0 2013-06-02 11:50 .
</I>&gt;<i> lr-x------ 1 foobar foobar 64 2013-06-02 11:50 9 -&gt; pipe:[122339989]
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 11:50 8 -&gt; /foobar/logs/
</I>&gt;<i> foomq1.foo.bar.com/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1sasl.log</A>
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 11:50 7 -&gt; /foobar/logs/
</I>&gt;<i> foomq1.foo.bar.com/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1.log</A>
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 6 -&gt; socket:[122339982]
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 5 -&gt; socket:[122339980]
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 11:50 4 -&gt; pipe:[122339970]
</I>&gt;<i> lr-x------ 1 foobar foobar 64 2013-06-02 11:50 3 -&gt; pipe:[122339970]
</I>&gt;<i> lr-x------ 1 foobar foobar 64 2013-06-02 11:50 17 -&gt; socket:[122340310]
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 16 -&gt; socket:[122340285]
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 15 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/msg_store_persistent/397.rdq
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 14 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/msg_store_transient/0.rdq
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 13 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/queues/D1KLLKOJLVJ4YZGYLP2D32A9W/journal.jif
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 11:50 12 -&gt; pipe:[122339990]
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 11 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/LATEST.LOG
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:50 10 -&gt; socket:[122339997]
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 11:50 1 -&gt; /foobar/logs/
</I>&gt;<i> foomq1.foo.bar.com/rabbitmq-server.log
</I>&gt;<i> lr-x------ 1 foobar foobar 64 2013-06-02 11:50 0 -&gt; /dev/null
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 11:51 18 -&gt; socket:[122340314]
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 12:28 21 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/queues/ETWUA9HXDWBIXFTEF0DVH5FBZ/journal.jif
</I>&gt;<i> lr-x------ 1 foobar foobar 64 2013-06-02 12:28 19 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/queues/22TABTKBIJ6DQCA5GC6EZ0B8L/journal.jif
</I>&gt;<i> l-wx------ 1 foobar foobar 64 2013-06-02 13:12 22 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/queues/A9AWP930R556ERL81W9PYEELL/journal.jif
</I>&gt;<i> lrwx------ 1 foobar foobar 64 2013-06-02 13:12 20 -&gt;
</I>&gt;<i> /foobar/var/lib/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at foomq1</A>/queues/A8EPKFQ4VCO5A3APTTWYEQRFT/journal.jif
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Tue, Jul 16, 2013 at 12:19 PM, Jeffery, Mark &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">MJeffery at fnb.co.za</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>  Hello
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Assuming Linux, what does ls -latr show in the fd directory in the rabbitmq process's directory under /proc ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matt Pietrek &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mpietrek at skytap.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     This is admittedly a shot in the dark, and with limited repro
</I>&gt;&gt;<i> details, but asking if somebody else has seen this.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  We run our clustered RabbitMQ 3.0.2 brokers in production without
</I>&gt;&gt;<i> restarts for months at a time. Everything is looking good - No memory
</I>&gt;&gt;<i> leaks, no out-of-disk-space, etc...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  However, in looking at the rabbit@&lt;node&gt;.log and rabbit@&lt;node&gt;-sasl.log
</I>&gt;&gt;<i> files, I noticed that at some point (e.g. a month earlier), no new entries
</I>&gt;&gt;<i> were being added to the log file. Normally there's a steady stream of new
</I>&gt;&gt;<i> connections and connection drops.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I've listed the open file handles from the rabbitmq beam instance and I
</I>&gt;&gt;<i> still see live file handles for the log files.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Anybody have any idea what might be happening? And better still, how we
</I>&gt;&gt;<i> might kick things without restarting the broker?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Thanks,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Matt
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     To read FirstRand Bank's Disclaimer for this email click on the
</I>&gt;&gt;<i> following address or copy into your Internet browser:
</I>&gt;&gt;<i> <A HREF="https://www.fnb.co.za/disclaimer.html">https://www.fnb.co.za/disclaimer.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  ****
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you are unable to access the Disclaimer, send a blank e-mail to
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">firstrandbankdisclaimer at fnb.co.za</A> and we will send you a copy of the
</I>&gt;&gt;<i> Disclaimer.****
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> rabbitmq-discuss mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>   To read FirstRand Bank's Disclaimer for this email click on the
</I>&gt;<i> following address or copy into your Internet browser:
</I>&gt;<i> <A HREF="https://www.fnb.co.za/disclaimer.html">https://www.fnb.co.za/disclaimer.html</A>
</I>&gt;<i>
</I>&gt;<i> ****
</I>&gt;<i>
</I>&gt;<i> If you are unable to access the Disclaimer, send a blank e-mail to
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">firstrandbankdisclaimer at fnb.co.za</A> and we will send you a copy of the
</I>&gt;<i> Disclaimer.****
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> rabbitmq-discuss mailing list
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
</I>&gt;<i> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130717/7fe14220/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130717/7fe14220/attachment.htm</A>&gt;
</PRE>


















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028616.html">[rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?
</A></li>
	<LI>Next message: <A HREF="028662.html">[rabbitmq-discuss] RabbitMQ 3.0.2 stops logging, but otherwise looks healthy?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28636">[ date ]</a>
              <a href="thread.html#28636">[ thread ]</a>
              <a href="subject.html#28636">[ subject ]</a>
              <a href="author.html#28636">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
