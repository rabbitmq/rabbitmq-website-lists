<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ scalability design question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scalability%20design%20question&In-Reply-To=%3CCAE3HoVQJfSxEFOcLFNksmnjVAO%3DPQV6uhi4JpgJAq_q8TqPgow%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028842.html">
   <LINK REL="Next"  HREF="028847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ scalability design question</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scalability%20design%20question&In-Reply-To=%3CCAE3HoVQJfSxEFOcLFNksmnjVAO%3DPQV6uhi4JpgJAq_q8TqPgow%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ scalability design question">michael.s.klishin at gmail.com
       </A><BR>
    <I>Wed Jul 24 13:05:45 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028842.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
        <LI>Next message: <A HREF="028847.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28843">[ date ]</a>
              <a href="thread.html#28843">[ thread ]</a>
              <a href="subject.html#28843">[ subject ]</a>
              <a href="author.html#28843">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2013/7/24 Flavio Pompermaier &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pompermaier at okkam.it</A>&gt;

&gt;<i> 1) One of the N consumers receive the end-message
</I>&gt;<i> 2) This consumer opens a new temporary feedback-queue to receive feedbacks
</I>&gt;<i> from other consumers and post to a fanout control queue a &quot;wait for end of
</I>&gt;<i> processing&quot; to all other consumers (containing also the id of the
</I>&gt;<i> feedback-queue)
</I>&gt;<i> 3) Sender ignores such message, other consumers sends a &quot;I finished my
</I>&gt;<i> stuff&quot; message once finished their work to the feedback-queue (whose id is
</I>&gt;<i> indicated in the &quot;wait for end of processing&quot; message)
</I>&gt;<i> 4) Once that the Consumer who initiated the &quot;stop phase&quot; receive all the
</I>&gt;<i> N-1 feedbacks (or after a certain timeout) it can delete the temporary
</I>&gt;<i> feedback queue and start the map reduce job
</I>&gt;<i>
</I>
This sounds about right.


&gt;<i> What is missing in this scenario is how consumers can be informed of the
</I>&gt;<i> number of active consumers (i.e. N)..any help about this? Do you think this
</I>&gt;<i> steps could be reasonable?
</I>&gt;<i>
</I>
This is a good question. Add to this that consumers can crash or become
unavailable because of
network failures. Coordination over RabbitMQ alone will probably be more
difficult than using
Redis for this purpose (as a &quot;presence service&quot;, more or less), e.g. using
its set data structures.

Any consumer would add itself to a set on start and any consumer can read
the set and see
who is online. I'm not very up-to-date with Redis but ideally you'd use its
features to detect
consumers leaving.
-- 
MK

<A HREF="http://github.com/michaelklishin">http://github.com/michaelklishin</A>
<A HREF="http://twitter.com/michaelklishin">http://twitter.com/michaelklishin</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130724/7a6dd666/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130724/7a6dd666/attachment.htm</A>&gt;
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028842.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
	<LI>Next message: <A HREF="028847.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28843">[ date ]</a>
              <a href="thread.html#28843">[ thread ]</a>
              <a href="subject.html#28843">[ subject ]</a>
              <a href="author.html#28843">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
