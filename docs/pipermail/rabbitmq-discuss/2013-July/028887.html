<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Statistics gathering
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Statistics%20gathering&In-Reply-To=%3CCAELUF_CjudXaEPsqne9MjJEqazs9Wt%3DAhSOLsNWbeYjsW62cXA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028884.html">
   <LINK REL="Next"  HREF="028859.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Statistics gathering</H1>
    <B>Flavio Pompermaier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Statistics%20gathering&In-Reply-To=%3CCAELUF_CjudXaEPsqne9MjJEqazs9Wt%3DAhSOLsNWbeYjsW62cXA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Statistics gathering">pompermaier at okkam.it
       </A><BR>
    <I>Thu Jul 25 13:18:28 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028884.html">[rabbitmq-discuss] Statistics gathering
</A></li>
        <LI>Next message: <A HREF="028859.html">[rabbitmq-discuss] RabbitMQ RPC in Tomcat container
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28887">[ date ]</a>
              <a href="thread.html#28887">[ thread ]</a>
              <a href="subject.html#28887">[ subject ]</a>
              <a href="author.html#28887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So, actually I have just to tune sample_retention_policies to keep and
aggregate statistics as long as I need!
Is there a way to reset those statistics (during development I think I will
make several tests in a day, but I think I'll keep stats for a day so I
need to reset those couters..)?
Moreover, I saw that detailed stats are available only for 10 seconds..do
you think it could be feasible to keep detailed data for an entire day or
does it occupy too much space on disk?
For example, I'd like to do something like:

{rabbitmq_management, [{sample_retention_policies,
                          [{global,   [{60, 5}, {3600, 60}, {86400, 1200}]},
                           {basic,    [{60, 5},{3600, 60}, {86400, 1200}]},
                           {detailed, [{10, 5},{3600, 60}, {86400, 1200}]}
                        ]},

What is not clear to me is which statistics provides each category..for
example, detailed what information does affects?
If i ask for /api/queues, will I receive more or less data if I had also
detailed infos?
Resolution defined in sample_retention_policies have different
granularities in order to perform cumulative stats faster and save disk,
right?
Because I could configure {basic, [{{86400, 5}]} but then I keep all 5-secs
samples for all the day and also compute aggregate stats will require to
pass all the samples..(correct me if I'm wrong).
Will HTTP api returns cumulative stats only? sample_age and sample_incr
parameters are useful only I want all samples, right?

Thanks for the support,
Flavio

On Thu, Jul 25, 2013 at 1:28 PM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt; wrote:

&gt;<i> On 25/07/2013 10:45AM, Flavio Pompermaier wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Yes, probably what I need is to correctly set those two parameters:
</I>&gt;&gt;<i>   - sample_retention_policies
</I>&gt;&gt;<i>   - collect_statistics_interval
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It's not obvious to me that you want to change collect_statistics_interval.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Are they strictly related or they serve different purposes?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well, they both have to do with statistics.
</I>&gt;<i>
</I>&gt;<i> collect_statistics_interval controls how frequently the various components
</I>&gt;<i> in RabbitMQ emit stats events. It therefore controls the maximum possible
</I>&gt;<i> resolution of stats you can get. The expectation is usually that you would
</I>&gt;<i> leave it alone, but if you had a huge number of not-quite-idle queues /
</I>&gt;<i> channels / connections you might want to increase it so that your server
</I>&gt;<i> does not spend all its time emitting stats events.
</I>&gt;<i>
</I>&gt;<i> sample_retention_policies controls how long the management plugin holds
</I>&gt;<i> onto statistics, and with what resolution. You might want to change this if
</I>&gt;<i> you want it to hold statistics for longer.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  How do I ask for global/basic/detailed cumulative stats (like those
</I>&gt;&gt;<i> collected by sample_retention_policies)?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Those names refer to different classes of stats you can get through the
</I>&gt;<i> web UI / HTTP API. See <A HREF="http://www.rabbitmq.com/**management.html#sample-**">http://www.rabbitmq.com/**management.html#sample-**</A>
</I>&gt;<i> retention &lt;<A HREF="http://www.rabbitmq.com/management.html#sample-retention">http://www.rabbitmq.com/management.html#sample-retention</A>&gt; for
</I>&gt;<i> the mapping.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  I think that I need those metrics..
</I>&gt;&gt;<i> With a small collect_statistics_interval (1 s) I have more precise data
</I>&gt;&gt;<i> but more overhead on the broker,
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yes.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  but changing this parameters require also to change
</I>&gt;&gt;<i> sample_retention_policies right?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> No.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Or it just run every 5 s and thus collects 5 samples (for default global
</I>&gt;&gt;<i> conf for example)..?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Not sure what you mean. If collect_statistics_interval is shorter than the
</I>&gt;<i> shortest resolution in sample_retention_policies you'll be doing more work
</I>&gt;<i> for no gain.
</I>&gt;<i>
</I>&gt;<i> Cheers, Simon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Best,
</I>&gt;&gt;<i> Flavio
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Thu, Jul 25, 2013 at 11:28 AM, Simon MacMullen &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">simon at rabbitmq.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     On 24/07/2013 6:17PM, Flavio Pompermaier wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         have you ever tried to set statistics interval to something like
</I>&gt;&gt;<i>         a week?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     I assume you mean sample_retention_policies (i.e. how long we hold
</I>&gt;&gt;<i>     stats for) rather than collect_statistics_interval (i.e. how
</I>&gt;&gt;<i>     frequently the broker should emit stats for the management plugin to
</I>&gt;&gt;<i>     collect).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     No I haven't, although you should be fine as long as you reduce the
</I>&gt;&gt;<i>     resolution for data that's held for longer. Or put up with increased
</I>&gt;&gt;<i>     memory use.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Does it affect performance?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Shouldn't do particularly.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Cheers, Simon
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130725/ca5f2d0c/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130725/ca5f2d0c/attachment.htm</A>&gt;
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028884.html">[rabbitmq-discuss] Statistics gathering
</A></li>
	<LI>Next message: <A HREF="028859.html">[rabbitmq-discuss] RabbitMQ RPC in Tomcat container
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28887">[ date ]</a>
              <a href="thread.html#28887">[ thread ]</a>
              <a href="subject.html#28887">[ subject ]</a>
              <a href="author.html#28887">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
