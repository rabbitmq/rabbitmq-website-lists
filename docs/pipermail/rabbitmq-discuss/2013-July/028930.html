<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Trouble with confirms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Trouble%20with%20confirms&In-Reply-To=%3C51F2B1F9.1020805%40timgroup.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028929.html">
   <LINK REL="Next"  HREF="028933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Trouble with confirms</H1>
    <B>Tom Anderson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Trouble%20with%20confirms&In-Reply-To=%3C51F2B1F9.1020805%40timgroup.com%3E"
       TITLE="[rabbitmq-discuss] Trouble with confirms">tom.anderson at timgroup.com
       </A><BR>
    <I>Fri Jul 26 18:29:29 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028929.html">[rabbitmq-discuss] Starting rabbitmq-server: FAILED
</A></li>
        <LI>Next message: <A HREF="028933.html">[rabbitmq-discuss] Trouble with confirms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28930">[ date ]</a>
              <a href="thread.html#28930">[ thread ]</a>
              <a href="subject.html#28930">[ subject ]</a>
              <a href="author.html#28930">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

If i enable confirms [1], then:

&quot;The broker will confirm messages once:

* it decides a message will not be routed to queues (if the mandatory 
flag is set then the basic.return is sent first) or
* a transient message has reached all its queues (and mirrors) or
* a persistent message has reached all its queues (and mirrors) and been 
persisted to disk (and fsynced) or
* a persistent message has been consumed (and if necessary acknowledged) 
from all its queues&quot;

So, if i send a persistent message (delivery mode = 2) to a non-durable 
exchange which routes to a non-durable queue, then i will only get a 
confirmation once the message has been consumed from that queue, right? 
And if my consumer is not set to auto-acknowledge, then i will only get 
a confirmation once the consumer has acknowledged the message, right?

This does not seem to be happening for me. I get a confirmation 12 
milliseconds after sending the message, but i know the acknowledgement 
isn't being sent for another whole second. I can't tell if the 
confirmation is being sent when the broker receives the message, gives 
it to an exchange, puts it in a queue, or delivers it to a consumer, 
since all those things happen in very rapid succession.

Any ideas as to what i should look into?

I'm using the Java API, if that matters.

Cheers,
tom

[1] <A HREF="http://www.rabbitmq.com/confirms.html">http://www.rabbitmq.com/confirms.html</A>

-- 

Tom Anderson | Developer | +44 20 7826 4312 | timgroup.com 
&lt;<A HREF="http://timgroup.com/">http://timgroup.com/</A>&gt;

STATEMENT OF CONFIDENTIALITY: The information contained in this 
electronic message and any attachments to this message are intended for 
the exclusive use of the addressee(s) and may contain confidential or 
privileged information. If you are not the intended recipient, please 
notify Tom Anderson at TIM Group at <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">tom.anderson at timgroup.com</A> and 
destroy all copies of this message and any attachments.

TIM Group is the trading name for YouDevise Limited. YouDevise Limited 
is registered in England, No. 3331176. Registered office: 3 Copthall 
Avenue, London, EC2R 7BH.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130726/46e4aeda/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130726/46e4aeda/attachment.htm</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028929.html">[rabbitmq-discuss] Starting rabbitmq-server: FAILED
</A></li>
	<LI>Next message: <A HREF="028933.html">[rabbitmq-discuss] Trouble with confirms
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28930">[ date ]</a>
              <a href="thread.html#28930">[ thread ]</a>
              <a href="subject.html#28930">[ subject ]</a>
              <a href="author.html#28930">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
