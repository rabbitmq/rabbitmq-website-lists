<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] forking and getting or consuming messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20forking%20and%20getting%20or%20consuming%20messages&In-Reply-To=%3C341210AA-3388-489A-A307-3A157A3204A0%40gopivotal.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028904.html">
   <LINK REL="Next"  HREF="028963.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] forking and getting or consuming messages</H1>
    <B>Michael Klishin</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20forking%20and%20getting%20or%20consuming%20messages&In-Reply-To=%3C341210AA-3388-489A-A307-3A157A3204A0%40gopivotal.com%3E"
       TITLE="[rabbitmq-discuss] forking and getting or consuming messages">mklishin at gopivotal.com
       </A><BR>
    <I>Fri Jul 26 06:35:58 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028904.html">[rabbitmq-discuss] forking and getting or consuming messages
</A></li>
        <LI>Next message: <A HREF="028963.html">[rabbitmq-discuss] forking and getting or consuming messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28905">[ date ]</a>
              <a href="thread.html#28905">[ thread ]</a>
              <a href="subject.html#28905">[ subject ]</a>
              <a href="author.html#28905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Chris:

&gt;<i> The second problem is that once all the messages are off the stack, the script exits. I'd like it to stay open and wait for more messages to come in. Is that possible using the queue-&gt;get() approach?
</I>
Child processes of fork(2) need to reopen all network connections
(not just to RabbitMQ).

So you need to pre-fork N workers and pass messages to them using
pipes or similar, or have each have a separate consumer. In the case of
pipes, coordinating acknowledgements may be pretty tricky, so using
one consumer per pre-forked worker is a much easier way.
--
MK

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130726/5a2e70ab/attachment.pgp">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130726/5a2e70ab/attachment.pgp</A>&gt;
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028904.html">[rabbitmq-discuss] forking and getting or consuming messages
</A></li>
	<LI>Next message: <A HREF="028963.html">[rabbitmq-discuss] forking and getting or consuming messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28905">[ date ]</a>
              <a href="thread.html#28905">[ thread ]</a>
              <a href="subject.html#28905">[ subject ]</a>
              <a href="author.html#28905">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
