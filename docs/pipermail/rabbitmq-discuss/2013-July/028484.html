<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Possible RabbitMQ 3.0.4 Management Plug-in (Mochiweb) Directory Traversal Vulnerability?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Possible%20RabbitMQ%203.0.4%20Management%20Plug-in%0A%20%28Mochiweb%29%20Directory%20Traversal%20Vulnerability%3F&In-Reply-To=%3C51DE73C0.1010609%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028459.html">
   <LINK REL="Next"  HREF="028434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Possible RabbitMQ 3.0.4 Management Plug-in (Mochiweb) Directory Traversal Vulnerability?</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Possible%20RabbitMQ%203.0.4%20Management%20Plug-in%0A%20%28Mochiweb%29%20Directory%20Traversal%20Vulnerability%3F&In-Reply-To=%3C51DE73C0.1010609%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Possible RabbitMQ 3.0.4 Management Plug-in (Mochiweb) Directory Traversal Vulnerability?">emile at rabbitmq.com
       </A><BR>
    <I>Thu Jul 11 09:58:40 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028459.html">[rabbitmq-discuss] Possible RabbitMQ 3.0.4 Management Plug-in (Mochiweb) Directory Traversal Vulnerability?
</A></li>
        <LI>Next message: <A HREF="028434.html">[rabbitmq-discuss] Work Queues design
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28484">[ date ]</a>
              <a href="thread.html#28484">[ thread ]</a>
              <a href="subject.html#28484">[ subject ]</a>
              <a href="author.html#28484">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Zachary,

On 10/07/13 11:22, Emile Joubert wrote:
&gt;<i> On 10/07/13 01:05, Zach Austin wrote:
</I>&gt;&gt;<i> A commercial off-the-shelf vulnerability scanner is detecting a
</I>&gt;&gt;<i> directory traversal vulnerability in the RabbitMQ management plugin HTTP
</I>&gt;&gt;<i> server (Mochiweb) installed in the default configuration on Windows
</I>&gt;&gt;<i> Server 2003. Exploitation of the vulnerability reportedly does not
</I>&gt;&gt;<i> require authentication. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I can provide details upon request.  Please let me know if this is a
</I>&gt;&gt;<i> known issue 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> If you provide details then we'll be able to determine whether this is a
</I>&gt;<i> known issue. Please reply to me directly if you feel the need to
</I>&gt;<i> practice responsible disclosure.
</I>

Thanks for taking the time to report this issue. This is a known issue
in the sense that it has been reported and fixed in the Mochiweb project:

 <A HREF="https://github.com/mochi/mochiweb/issues/92">https://github.com/mochi/mochiweb/issues/92</A>

Unfortunately the version of Mochiweb included in RabbitMQ does not yet
include the upstream fix, but we do plan to update this and include the
fix. The RabbitMQ release notes will contain a description to that effect.

In the meantime here some possible workarounds:
If you access the management interface via a proxy then you can include
a rule to disallow access to URLs that contain backslashes.
The issue appears to be Windows-specific, so you could enable the
management interface only on non-Windows nodes.



-Emile





-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130711/46a999b6/attachment.pgp">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130711/46a999b6/attachment.pgp</A>&gt;
</PRE>
























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028459.html">[rabbitmq-discuss] Possible RabbitMQ 3.0.4 Management Plug-in (Mochiweb) Directory Traversal Vulnerability?
</A></li>
	<LI>Next message: <A HREF="028434.html">[rabbitmq-discuss] Work Queues design
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28484">[ date ]</a>
              <a href="thread.html#28484">[ thread ]</a>
              <a href="subject.html#28484">[ subject ]</a>
              <a href="author.html#28484">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
