<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] forking and getting or consuming messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20forking%20and%20getting%20or%20consuming%20messages&In-Reply-To=%3C51F20807.1090409%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028912.html">
   <LINK REL="Next"  HREF="028905.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] forking and getting or consuming messages</H1>
    <B>Chris</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20forking%20and%20getting%20or%20consuming%20messages&In-Reply-To=%3C51F20807.1090409%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] forking and getting or consuming messages">dmagick at gmail.com
       </A><BR>
    <I>Fri Jul 26 06:24:23 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028912.html">[rabbitmq-discuss] Queue disappear from nodes in clusters
</A></li>
        <LI>Next message: <A HREF="028905.html">[rabbitmq-discuss] forking and getting or consuming messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28904">[ date ]</a>
              <a href="thread.html#28904">[ thread ]</a>
              <a href="subject.html#28904">[ subject ]</a>
              <a href="author.html#28904">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm setting up a system that will have multiple queues. One script 
listens to a 'master' queue and then forks off other scripts to deal 
with the other queues as required.

This all works fine except for a couple of things.

I'm basically doing a
while (queue-&gt;get()) {
   do stuff;
}

If the queue is already running and another message goes onto the stack, 
I don't see it until the script runs again. I tried closing the channel 
and then opening it again but that didn't help (it caused a problem in 
amqplib). Any suggestions?

The second problem is that once all the messages are off the stack, the 
script exits. I'd like it to stay open and wait for more messages to 
come in. Is that possible using the queue-&gt;get() approach?

I tried changing it to work as a queue consumer (which addressed the 2nd 
problem), but then I only got one message from the queue at a time, I 
had to wait for each message to finish processing before starting the 
next one, so forking off connections didn't work. Should this idea work?

I'm using php-amqplib (<A HREF="https://github.com/tnc/php-amqplib">https://github.com/tnc/php-amqplib</A>) to talk to 
rabbitmq.

Thanks for any suggestions/comments.

Cheers,
-- 
Postgresql &amp; php tutorials
<A HREF="http://www.designmagick.com/">http://www.designmagick.com/</A>

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028912.html">[rabbitmq-discuss] Queue disappear from nodes in clusters
</A></li>
	<LI>Next message: <A HREF="028905.html">[rabbitmq-discuss] forking and getting or consuming messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28904">[ date ]</a>
              <a href="thread.html#28904">[ thread ]</a>
              <a href="subject.html#28904">[ subject ]</a>
              <a href="author.html#28904">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
