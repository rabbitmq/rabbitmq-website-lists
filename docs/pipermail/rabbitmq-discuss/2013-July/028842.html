<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ scalability design question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scalability%20design%20question&In-Reply-To=%3CCAELUF_DmbByS59AsxjXzN55Lwc40Rka1Pt1r%3D2pKtS6sjeV%2Bzg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028836.html">
   <LINK REL="Next"  HREF="028843.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ scalability design question</H1>
    <B>Flavio Pompermaier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20scalability%20design%20question&In-Reply-To=%3CCAELUF_DmbByS59AsxjXzN55Lwc40Rka1Pt1r%3D2pKtS6sjeV%2Bzg%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ scalability design question">pompermaier at okkam.it
       </A><BR>
    <I>Wed Jul 24 12:57:31 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028836.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
        <LI>Next message: <A HREF="028843.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28842">[ date ]</a>
              <a href="thread.html#28842">[ thread ]</a>
              <a href="subject.html#28842">[ subject ]</a>
              <a href="author.html#28842">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Actually the Consumer that receive the first stop message should receive
also N-1 &quot;I finished my stuff&quot; messages from the other N -1 consumers..
But I think it could be quite easily feasible..summarizing, tell me if this
could be a good workflow:

1) One of the N consumers receive the end-message
2) This consumer opens a new temporary feedback-queue to receive feedbacks
from other consumers and post to a fanout control queue a &quot;wait for end of
processing&quot; to all other consumers (containing also the id of the
feedback-queue)
3) Sender ignores such message, other consumers sends a &quot;I finished my
stuff&quot; message once finished their work to the feedback-queue (whose id is
indicated in the &quot;wait for end of processing&quot; message)
4) Once that the Consumer who initiated the &quot;stop phase&quot; receive all the
N-1 feedbacks (or after a certain timeout) it can delete the temporary
feedback queue and start the map reduce job

What is missing in this scenario is how consumers can be informed of the
number of active consumers (i.e. N)..any help about this? Do you think this
steps could be reasonable?

On Wed, Jul 24, 2013 at 1:10 PM, Michael Klishin &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">mklishin at gopivotal.com</A>&gt;wrote:

&gt;<i> Flavio Pompermaier:
</I>&gt;<i>
</I>&gt;<i> &gt; If not, could you please give me some more reference or hint about
</I>&gt;<i> implementing the solution you proposed?
</I>&gt;<i>
</I>&gt;<i> just make the consumer that receives the first &quot;stop&quot; message publish a
</I>&gt;<i> message that all
</I>&gt;<i> consumers will get (via a separate queue).
</I>&gt;<i>
</I>&gt;<i> Note that to avoid an infinite loop of messages, you need to mark such
</I>&gt;<i> control messages
</I>&gt;<i> and make sure other consumers don't publish anything, just stop.
</I>&gt;<i>
</I>&gt;<i> Then the consumer that's got the first &quot;stop&quot; message can start a
</I>&gt;<i> map/reduce job.
</I>&gt;<i> --
</I>&gt;<i> MK
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130724/5cfc682d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130724/5cfc682d/attachment.htm</A>&gt;
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028836.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
	<LI>Next message: <A HREF="028843.html">[rabbitmq-discuss] RabbitMQ scalability design question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28842">[ date ]</a>
              <a href="thread.html#28842">[ thread ]</a>
              <a href="subject.html#28842">[ subject ]</a>
              <a href="author.html#28842">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
