<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Checking queue size in bytes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Checking%20queue%20size%20in%20bytes&In-Reply-To=%3CCA%2B5po3e-vnbrRj2LYz%2Bv8tnmv%2B1QpeAp%3DJxSRCXuVOjSNc7WdA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028452.html">
   <LINK REL="Next"  HREF="028440.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Checking queue size in bytes</H1>
    <B>Joseph Weeks</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Checking%20queue%20size%20in%20bytes&In-Reply-To=%3CCA%2B5po3e-vnbrRj2LYz%2Bv8tnmv%2B1QpeAp%3DJxSRCXuVOjSNc7WdA%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] Checking queue size in bytes">weojoew at gmail.com
       </A><BR>
    <I>Mon Jul  8 15:28:29 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028452.html">[rabbitmq-discuss] URGENT : UNC path issue
</A></li>
        <LI>Next message: <A HREF="028440.html">[rabbitmq-discuss] Checking queue size in bytes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28395">[ date ]</a>
              <a href="thread.html#28395">[ thread ]</a>
              <a href="subject.html#28395">[ subject ]</a>
              <a href="author.html#28395">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Is there a way to determine a queue's size in bytes?  I'm mostly interested
in size on disk, but the sum of memory and disk would be sufficient if that
happens to be more readily available.

My scenario is as follows:
- We're using RabbitMQ 2.8.7 in a 2-node cluster (and in the process of
upgrading to 3.1.x in a couple months)
- We have several groups of publishers publishing messages of varying sizes
(from 10KB up to 3MB)
- Many messages and queues are configured in the worst-case (no message
ttls, persistent messages, durable and mirrored queues, no queue length
limit), and we're not in a position to change that in the short-term
- From time to time, we have absentee consumers that cause our RabbitMQ
disk usage to climb towards the disk threshold

At the point that disk usage starts to climb, we would like to be able to
mitigate the inevitable disk alarm by identifying the queues containing the
most data and unbind or purge them.  If the messages were a uniform size,
we could look at the queue depths and know which queues are consuming the
most disk space, but given the varying message sizes of our scenario, the
queue depth doesn't give us enough information to work with.
 Programmatically responding would be great, but manually manipulating the
queues in the management UI would suffice for our immediate needs.

Any recommendations or ideas would be greatly appreciated.

On a related note, would it be possible for some future version of RabbitMQ
to allow queue policies like &quot;x-max-length&quot; and &quot;x-message-ttl&quot; in addition
to the queue declaration arguments?

Thanks a lot,
Joe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130708/37194c3b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130708/37194c3b/attachment.htm</A>&gt;
</PRE>





































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028452.html">[rabbitmq-discuss] URGENT : UNC path issue
</A></li>
	<LI>Next message: <A HREF="028440.html">[rabbitmq-discuss] Checking queue size in bytes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28395">[ date ]</a>
              <a href="thread.html#28395">[ thread ]</a>
              <a href="subject.html#28395">[ subject ]</a>
              <a href="author.html#28395">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
