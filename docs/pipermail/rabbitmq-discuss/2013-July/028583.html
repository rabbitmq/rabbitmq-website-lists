<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] another performance question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20another%20performance%20question&In-Reply-To=%3Ce195be40-445f-4165-846e-6c84a6133230%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028591.html">
   <LINK REL="Next"  HREF="028618.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] another performance question</H1>
    <B>mark.geib at echostar.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20another%20performance%20question&In-Reply-To=%3Ce195be40-445f-4165-846e-6c84a6133230%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] another performance question">mark.geib at echostar.com
       </A><BR>
    <I>Mon Jul 15 17:45:15 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028591.html">[rabbitmq-discuss] Compiling 1.8.1
</A></li>
        <LI>Next message: <A HREF="028618.html">[rabbitmq-discuss] another performance question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28583">[ date ]</a>
              <a href="thread.html#28583">[ thread ]</a>
              <a href="subject.html#28583">[ subject ]</a>
              <a href="author.html#28583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We have been using rabbitmq for a number or years with great success, 
thanks.

All the following relates to rabbitmq 3.1.1 on debian.

Recently we started a new project using rabbitmq to handle large amounts of 
data, over 40kHz message rate and message sizes of a few kilobytes. The 
project depends on using a topic exchange with routing keys of the form 
AA.BB.CC.DD.EE. Consumers are able to bind a queue with a given wildcard 
pattern in order to receive a subset of the message stream published by one 
publisher. There is always one consumer that binds with the &quot;#&quot; routing key 
to receive all messages.

We have started testing against a broker running on a machine with 8 cores, 
about 2GHz each, with 32GB ram, and over a terabyte of free disk space. I 
am publishing with a single erlang client to a topic exchange. I am only 
able to publish at about 15kHz before I see flow control kick in on the 
management UI for the connection. This is with no queue bound to the 
exchange, so rabbitmq only needs to receive the messages and drop them. So 
at 15kHz I see flow control kicking in, but the machine is not busy, all 8 
cores show 85-95% idle. It looks like the server is basically idle. If I 
then bind a queue with the routing key &quot;#&quot; I see the enqueue rate hover 
around 5-7kHz. If I add a consumer to keep the queue empty I see no 
improvement. And during all this the machine still never gets busy.

My confusion lies in the fact that the flow control kicks in, but the 
machine is not busy. There is no ram or disk shortage and the machine's NIC 
can certainly handle much higher bandwidth loads than the 15kHz message 
rate I see in rabbitmq.

I have read everything I can on performance and expected to see a message 
receiving rate, that is with no queues, of over 100kHz. Once I add queues, 
etc I was expecting 20kHz or better.

I am wondering if 40kHz throughput is un-realistic at this point.

Thanks,
Mark.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130715/6f7d9d0d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130715/6f7d9d0d/attachment.htm</A>&gt;
</PRE>
























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028591.html">[rabbitmq-discuss] Compiling 1.8.1
</A></li>
	<LI>Next message: <A HREF="028618.html">[rabbitmq-discuss] another performance question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28583">[ date ]</a>
              <a href="thread.html#28583">[ thread ]</a>
              <a href="subject.html#28583">[ subject ]</a>
              <a href="author.html#28583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
