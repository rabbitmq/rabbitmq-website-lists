<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq and long	vm.dirty_writeback_centisecs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20and%20long%0A%09vm.dirty_writeback_centisecs&In-Reply-To=%3C51D54B51.2060300%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028311.html">
   <LINK REL="Next"  HREF="028314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq and long	vm.dirty_writeback_centisecs</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20and%20long%0A%09vm.dirty_writeback_centisecs&In-Reply-To=%3C51D54B51.2060300%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq and long	vm.dirty_writeback_centisecs">simon at rabbitmq.com
       </A><BR>
    <I>Thu Jul  4 11:15:45 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028311.html">[rabbitmq-discuss] rabbitmq and long vm.dirty_writeback_centisecs
</A></li>
        <LI>Next message: <A HREF="028314.html">[rabbitmq-discuss] Can't connect to STOMP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28324">[ date ]</a>
              <a href="thread.html#28324">[ thread ]</a>
              <a href="subject.html#28324">[ subject ]</a>
              <a href="author.html#28324">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 04/07/13 00:45, Tao Fan wrote:
&gt;<i> I have ubuntu boxes which, for disk life consideration, I have set the
</I>&gt;<i> vm.dirty_writeback_centisecs from 5sec to 30min. However, when the boxes
</I>&gt;<i> have power outage and restored, rabbitmq refused to start up, giving
</I>&gt;<i> error message in log: mnesia_recover crashed.
</I>
That's an error from Mnesia; part of Erlang. It may be worth upgrading 
Erlang, R13B03 is quite old. See 
<A HREF="https://www.erlang-solutions.com/downloads/download-erlang-otp">https://www.erlang-solutions.com/downloads/download-erlang-otp</A> for newer 
Erlang debs.

That error is also truncated, it's not clear what has really gone wrong.

&gt;<i> I had to delete schema.DAT under mnesia directory before I can start it
</I>&gt;<i> again but then all my stored messages in persistent queues are lost.
</I>&gt;<i>
</I>&gt;<i> If I do disk sync every minute or two, there is no such issue - rabbitmq
</I>&gt;<i> can survive every power cycle. I like to understand how rabbitmq works
</I>&gt;<i> to survive power cycle and if it is possible to tune it to survive with
</I>&gt;<i> longer sync time without losing any stored messages in queue.
</I>
Don't these two requirements contradict each other? If you succeed in 
making sync to disc happen every 30 min (which is probably quite hard, 
RabbitMQ issues fsync() quite frequently), you are going to risk losing 
data on failure.

To be honest I would just leave dirty_writeback_centisecs alone.

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, Pivotal
</PRE>


















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028311.html">[rabbitmq-discuss] rabbitmq and long vm.dirty_writeback_centisecs
</A></li>
	<LI>Next message: <A HREF="028314.html">[rabbitmq-discuss] Can't connect to STOMP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28324">[ date ]</a>
              <a href="thread.html#28324">[ thread ]</a>
              <a href="subject.html#28324">[ subject ]</a>
              <a href="author.html#28324">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
