<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Update: [Bug] Memory leak in 3.1.3 (Ubuntu)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Update%3A%20%5BBug%5D%20Memory%20leak%20in%203.1.3%20%28Ubuntu%29&In-Reply-To=%3C51E7B2BC.2060500%40canonical.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028601.html">
   <LINK REL="Next"  HREF="028346.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Update: [Bug] Memory leak in 3.1.3 (Ubuntu)</H1>
    <B>Louis Bouchard</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Update%3A%20%5BBug%5D%20Memory%20leak%20in%203.1.3%20%28Ubuntu%29&In-Reply-To=%3C51E7B2BC.2060500%40canonical.com%3E"
       TITLE="[rabbitmq-discuss] Update: [Bug] Memory leak in 3.1.3 (Ubuntu)">louis.bouchard at canonical.com
       </A><BR>
    <I>Thu Jul 18 10:17:48 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028601.html">[rabbitmq-discuss] Update: [Bug] Memory leak in 3.1.3 (Ubuntu)
</A></li>
        <LI>Next message: <A HREF="028346.html">[rabbitmq-discuss] [Bug] Memory leak in 3.1.3 (Ubuntu)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28666">[ date ]</a>
              <a href="thread.html#28666">[ thread ]</a>
              <a href="subject.html#28666">[ subject ]</a>
              <a href="author.html#28666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Le 16/07/2013 15:16, Matthias Radestock a &#233;crit :

&gt;<i> If you are planning on running this test for a while, I suggest you take
</I>&gt;<i> a reading of the memory values reported by 'rabbitmqctl status' near the
</I>&gt;<i> beginning and end of the run, since that will help pinpoint where the
</I>&gt;<i> memory is going.
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Matthias.
</I>
My instance has now been running for almost two days. Here is some data :

saucy&gt; sudo rabbitmqctl status
Status of node '<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at server-656f503b-0965-4e01-94d9-58b177bbec3d</A>' ...
[{pid,2150},
 {running_applications,[{rabbit,&quot;RabbitMQ&quot;,&quot;3.1.3&quot;},
                        {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.9&quot;},
                        {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.12&quot;},
                        {xmerl,&quot;XML parser&quot;,&quot;1.3.3&quot;},
                        {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.3.2&quot;},
                        {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.19.2&quot;},
                        {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.16.2&quot;}]},
 {os,{unix,linux}},
 {erlang_version,&quot;Erlang R16B01 (erts-5.10.2) [source] [64-bit]
[async-threads:30] [kernel-poll:true]\n&quot;},
 {memory,[{total,36267272},
          {connection_procs,82704},
          {queue_procs,60600},
          {plugins,0},
          {other_proc,13558976},
          {mnesia,59392},
          {mgmt_db,0},
          {msg_index,39616},
          {other_ets,744408},
          {binary,1335160},
          {code,16368314},
          {atom,594537},
          {other_system,3423565}]},
 {vm_memory_high_watermark,0.4},
 {vm_memory_limit,840009318},
 {disk_free_limit,1000000000},
 {disk_free,8495063040},
 {file_descriptors,[{total_limit,924},
                    {total_used,4},
                    {sockets_limit,829},
                    {sockets_used,2}]},
 {processes,[{limit,1048576},{used,131}]},
 {run_queue,0},
 {uptime,171822}]
...done.

saucy&gt; free
             total       used       free     shared    buffers     cached
Mem:       2050804    1243784     807020          0      82532     979120
-/+ buffers/cache:     182132    1868672
Swap:            0          0          0
saucy&gt; ps auxww | grep beam
rabbitmq  2150  3.3  1.8 336912 38340 ?        Sl   Jul16  96:28
/usr/lib/erlang/erts-5.10.2/bin/beam -W w -K true -A30 -P 1048576 --
-root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- ...

So there is clearly some memory leakage here. It may not come from
rabbitmq (which does not seem to be consuming all that memory) but it is
clearly triggered by it.

During my previous test, restarting rabbitmq did not release the used
memory so it might also be some kind of kernel leak triggered by rabbitmq.

I'll let the instance run for now.

Kind regards,

...Louis

-- 
Louis Bouchard
Backline Support Analyst
Canonical Ltd
Ubuntu support: <A HREF="http://canonical.com/support">http://canonical.com/support</A>
</PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028601.html">[rabbitmq-discuss] Update: [Bug] Memory leak in 3.1.3 (Ubuntu)
</A></li>
	<LI>Next message: <A HREF="028346.html">[rabbitmq-discuss] [Bug] Memory leak in 3.1.3 (Ubuntu)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28666">[ date ]</a>
              <a href="thread.html#28666">[ thread ]</a>
              <a href="subject.html#28666">[ subject ]</a>
              <a href="author.html#28666">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
