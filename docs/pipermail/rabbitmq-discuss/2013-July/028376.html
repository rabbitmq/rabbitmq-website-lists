<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Atomic acking of a specific set of messages
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Atomic%20acking%20of%20a%20specific%20set%20of%20messages&In-Reply-To=%3C50dd1405-31ea-44e9-8e8b-4fc531558784%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028368.html">
   <LINK REL="Next"  HREF="028377.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Atomic acking of a specific set of messages</H1>
    <B>peter at vagaband.co</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Atomic%20acking%20of%20a%20specific%20set%20of%20messages&In-Reply-To=%3C50dd1405-31ea-44e9-8e8b-4fc531558784%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Atomic acking of a specific set of messages">peter at vagaband.co
       </A><BR>
    <I>Sun Jul  7 19:10:27 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028368.html">[rabbitmq-discuss] Binary builds of the UDP and Presence Exchange	plugins
</A></li>
        <LI>Next message: <A HREF="028377.html">[rabbitmq-discuss] Atomic acking of a specific set of messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28376">[ date ]</a>
              <a href="thread.html#28376">[ thread ]</a>
              <a href="subject.html#28376">[ subject ]</a>
              <a href="author.html#28376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to use RabbitMQ with Storm (for processing a stream of messages) 
using Trident (a high level abstraction on top of Storm). In order to gain 
exactly-once processing of messages with Storm, I need to be able to create 
a Storm spout that can retrieve a batch of messages from RabbitMQ and 
ack/fail them as a batch as an atomic unit. While amqp protocol or rabbitmq 
specific extensions to it does not seem to support this in an obvious 
manner, is there some pattern I could implement using what RabbitMQ 
provides to achieve this?

The flag to indicate you're acking multiple messages will not work as that 
limits you to work with just one batch, right? And you cannot pick and 
choose which batch of messages you can or cannot ack with that mode (i.e. 
batch 2 might succeed, batch 3 might fail and batch 4 might succeed. so if 
you ack batch 4, everything will be acked).

Can I use a consistent hashing exchange (or something to the effect by 
writing my own exchange plugin) to a select a batch of messages and route 
them to a specific queue and once all the messages in that queue (i.e. the 
queue is the batch), then the queue is discarded?

The key here is treat a batch of messages as an atomic unit so if a single 
message consumer node dies or all message consumer nodes die or a rabbitmq 
node dies, then the whole batch can be failed to be re-tried later.

Thoughts? 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130707/9d8d390b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130707/9d8d390b/attachment.htm</A>&gt;
</PRE>

























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028368.html">[rabbitmq-discuss] Binary builds of the UDP and Presence Exchange	plugins
</A></li>
	<LI>Next message: <A HREF="028377.html">[rabbitmq-discuss] Atomic acking of a specific set of messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28376">[ date ]</a>
              <a href="thread.html#28376">[ thread ]</a>
              <a href="subject.html#28376">[ subject ]</a>
              <a href="author.html#28376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
