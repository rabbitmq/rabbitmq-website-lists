<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20causing%20heavy%20disk%20i/o%20with%20nothing%0A%20in%20the%20queues&In-Reply-To=%3C51DF1EEA.3040306%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028512.html">
   <LINK REL="Next"  HREF="028534.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20causing%20heavy%20disk%20i/o%20with%20nothing%0A%20in%20the%20queues&In-Reply-To=%3C51DF1EEA.3040306%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues">matthias at rabbitmq.com
       </A><BR>
    <I>Thu Jul 11 22:08:58 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028512.html">[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in	the queues
</A></li>
        <LI>Next message: <A HREF="028534.html">[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28518">[ date ]</a>
              <a href="thread.html#28518">[ thread ]</a>
              <a href="subject.html#28518">[ subject ]</a>
              <a href="author.html#28518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Kevin,

On 11/07/13 17:38, Kevin Goess wrote:
&gt;<i> Circling back after an earlier question about this problem. We've
</I>&gt;<i> upgraded to 3.1.3-1.  We've moved the mnesia files to a dedicated 10k
</I>&gt;<i> sata drive via RABBITMQ_MNESIA_BASE, a new drive that nothing else is
</I>&gt;<i> using, on a xen virtual machine that is only running rabbitmq.  We
</I>&gt;<i> generally deal with about 20 messages per second.
</I>&gt;<i>
</I>&gt;<i> But we're seeing pretty heavy disk activity, with iowait 30-40%, and
</I>&gt;<i> iostat numbers like this:
</I>&gt;<i>
</I>&gt;<i> Device:         rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s
</I>&gt;<i> avgrq-sz avgqu-sz   await  svctm  %util
</I>&gt;<i> xvdbp1            0.00    60.00    0.00  143.40     0.00  1452.80
</I>&gt;<i>   10.13     0.88    6.14   4.22  60.48
</I>&gt;<i>
</I>&gt;<i> Is this expected?  That seems excessive, and I worry that the high
</I>&gt;<i> iowait could cause us problems as we grow, so I was hoping to get some
</I>&gt;<i> pointers to things to look at that to improve that.
</I>
My suspicious is that somehow your usage pattern results in a lot of 
queue/exchange/binding creation/deletion, which, if the entities 
involved are durable, require disk writes and fsyncs.

To test the validity of that theory, please try to find out what files 
are seeing activity, and report back.


Regards,

Matthias.
</PRE>























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028512.html">[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in	the queues
</A></li>
	<LI>Next message: <A HREF="028534.html">[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28518">[ date ]</a>
              <a href="thread.html#28518">[ thread ]</a>
              <a href="subject.html#28518">[ subject ]</a>
              <a href="author.html#28518">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
