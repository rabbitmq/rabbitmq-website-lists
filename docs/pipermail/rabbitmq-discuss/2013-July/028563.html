<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ boot failures with SSL on homebrew Mac	OSX
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20boot%20failures%20with%20SSL%20on%20homebrew%20Mac%0A%09OSX&In-Reply-To=%3CCAAt2poJGbuDxbYyxa4J4rh_%2BM2u-wXD3Nog%2BKWTiT-Wu-YXxcQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028555.html">
   <LINK REL="Next"  HREF="028565.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ boot failures with SSL on homebrew Mac	OSX</H1>
    <B>Alan Antonuk</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20RabbitMQ%20boot%20failures%20with%20SSL%20on%20homebrew%20Mac%0A%09OSX&In-Reply-To=%3CCAAt2poJGbuDxbYyxa4J4rh_%2BM2u-wXD3Nog%2BKWTiT-Wu-YXxcQ%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] RabbitMQ boot failures with SSL on homebrew Mac	OSX">alan.antonuk at gmail.com
       </A><BR>
    <I>Fri Jul 12 21:16:04 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028555.html">[rabbitmq-discuss] Messages being deleted?
</A></li>
        <LI>Next message: <A HREF="028565.html">[rabbitmq-discuss] RabbitMQ boot failures with SSL on homebrew	Mac OSX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28563">[ date ]</a>
              <a href="thread.html#28563">[ thread ]</a>
              <a href="subject.html#28563">[ subject ]</a>
              <a href="author.html#28563">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Forgive me if I'm barking up the wrong tree here, I figure this is a good
place to start tracking down this issue:

I'm trying to run RabbitMQ v3.1.3 on Erlang vR15B03-1 on Mac OSX 10.8.4,
both installed using Homebrew. (Though it appears as though RabbitMQ is
using its own private version of erlang).

It works great until I try and enable SSL, then I get boot failures (the
complete output of rabbitmq-server is below, the output of the last boot of
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq at localhost.log</A> is below that).

My rabbitmq.config looks like:

533 <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aega at aimac</A>:~ $ cat /usr/local/etc/rabbitmq/rabbitmq.config
[
{rabbit, [
        {tcp_listeners, [{5672}]},
        {ssl_listeners, [5671]},
        {ssl_options, [{cacertfile,&quot;/Users/aega/d/amqp/testca/cacert.pem&quot;},
                        {certfile,&quot;/Users/aega/d/amqp/servercert/cert.pem&quot;},
                        {keyfile,&quot;/Users/aega/d/amqp/servercert/key.pem&quot;},
                        {verify,verify_peer},
                        {fail_if_no_peer_cert,false}]}
    ]}
].

531 <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">aega at aimac</A>:~ $ /usr/local/sbin/rabbitmq-server

              RabbitMQ 3.1.3. Copyright (C) 2007-2013 VMware, Inc.
  ##  ##      Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/">http://www.rabbitmq.com/</A>
  ##  ##
  ##########  Logs: /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>
  ######  ##        /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>
  ##########
              Starting broker...

BOOT FAILED
===========

Error description:
   {error,{cannot_start_application,asn1,
                                    {&quot;no such file or
directory&quot;,&quot;asn1.app&quot;}}}

Log files (may contain more information):
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>

Stack trace:
   [{app_utils,'-start_applications/1-fun-0-',2,
               [{file,&quot;src/app_utils.erl&quot;},{line,46}]},
    {lists,foldl,3,[{file,&quot;lists.erl&quot;},{line,1248}]},

{app_utils,manage_applications,6,[{file,&quot;src/app_utils.erl&quot;},{line,128}]},
    {rabbit_networking,ensure_ssl,0,
                       [{file,&quot;src/rabbit_networking.erl&quot;},{line,148}]},
    {rabbit_networking,'-boot_ssl/0-lc$^0/1-0-',1,
                       [{file,&quot;src/rabbit_networking.erl&quot;},{line,137}]},
    {rabbit_networking,boot_ssl,0,
                       [{file,&quot;src/rabbit_networking.erl&quot;},{line,137}]},

{rabbit_networking,boot,0,[{file,&quot;src/rabbit_networking.erl&quot;},{line,125}]},
    {rabbit,'-run_boot_step/1-lc$^1/1-1-',1,
            [{file,&quot;src/rabbit.erl&quot;},{line,488}]}]



BOOT FAILED
===========

Error description:
   {could_not_start,rabbit,
       {bad_return,
           {{rabbit,start,[normal,[]]},
            {'EXIT',
                {rabbit,failure_during_boot,
                    {error,
                        {cannot_start_application,asn1,
                            {&quot;no such file or directory&quot;,&quot;asn1.app&quot;}}}}}}}}

Log files (may contain more information):
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>

{&quot;init terminating in
do_boot&quot;,{rabbit,failure_during_boot,{could_not_start,rabbit,{bad_return,{{rabbit,start,[normal,[]]},{'EXIT',{rabbit,failure_during_boot,{error,{cannot_start_application,asn1,{&quot;no
such file or directory&quot;,&quot;asn1.app&quot;}}}}}}}}}}

Crash dump was written to: erl_crash.dump
init terminating in do_boot ()

---------------------------------------------------------------------------------------

Last few lines of <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq at localhost.log</A>:
=INFO REPORT==== 12-Jul-2013::13:03:01 ===
Starting RabbitMQ 3.1.3 on Erlang R16B
Copyright (C) 2007-2013 VMware, Inc.
Licensed under the MPL.  See <A HREF="http://www.rabbitmq.com/">http://www.rabbitmq.com/</A>

=INFO REPORT==== 12-Jul-2013::13:03:01 ===
node           : <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost</A>
home dir       : /Users/aega
cookie hash    : z2f61w1/EZjsR+NzlXG5Ew==
log            : /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>
sasl log       : /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>
database dir   : /usr/local/var/lib/rabbitmq/mnesia/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost</A>

=INFO REPORT==== 12-Jul-2013::13:03:01 ===
Limiting to approx 156 file handles (138 sockets)

=INFO REPORT==== 12-Jul-2013::13:03:02 ===
Memory limit set to 564MB of 1410MB total.

=INFO REPORT==== 12-Jul-2013::13:03:02 ===
Disk free limit set to 1000MB

=INFO REPORT==== 12-Jul-2013::13:03:02 ===
msg_store_transient: using rabbit_msg_store_ets_index to provide index

=INFO REPORT==== 12-Jul-2013::13:03:02 ===
msg_store_persistent: using rabbit_msg_store_ets_index to provide index

=INFO REPORT==== 12-Jul-2013::13:03:02 ===
started TCP Listener on 127.0.0.1:5672

=INFO REPORT==== 12-Jul-2013::13:03:02 ===
Error description:
   {error,{cannot_start_application,asn1,
                                    {&quot;no such file or
directory&quot;,&quot;asn1.app&quot;}}}

Log files (may contain more information):
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>

Stack trace:
   [{app_utils,'-start_applications/1-fun-0-',2,
               [{file,&quot;src/app_utils.erl&quot;},{line,46}]},
    {lists,foldl,3,[{file,&quot;lists.erl&quot;},{line,1248}]},

{app_utils,manage_applications,6,[{file,&quot;src/app_utils.erl&quot;},{line,128}]},
    {rabbit_networking,ensure_ssl,0,
                       [{file,&quot;src/rabbit_networking.erl&quot;},{line,148}]},
    {rabbit_networking,'-boot_ssl/0-lc$^0/1-0-',1,
                       [{file,&quot;src/rabbit_networking.erl&quot;},{line,137}]},
    {rabbit_networking,boot_ssl,0,
                       [{file,&quot;src/rabbit_networking.erl&quot;},{line,137}]},

{rabbit_networking,boot,0,[{file,&quot;src/rabbit_networking.erl&quot;},{line,125}]},
    {rabbit,'-run_boot_step/1-lc$^1/1-1-',1,
            [{file,&quot;src/rabbit.erl&quot;},{line,488}]}]


=INFO REPORT==== 12-Jul-2013::13:03:03 ===
stopped TCP Listener on 127.0.0.1:5672

=INFO REPORT==== 12-Jul-2013::13:03:03 ===
Error description:
   {could_not_start,rabbit,
       {bad_return,
           {{rabbit,start,[normal,[]]},
            {'EXIT',
                {rabbit,failure_during_boot,
                    {error,
                        {cannot_start_application,asn1,
                            {&quot;no such file or directory&quot;,&quot;asn1.app&quot;}}}}}}}}

Log files (may contain more information):
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>
   /usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>


=ERROR REPORT==== 12-Jul-2013::13:03:03 ===
** gen_event handler rabbit_error_logger crashed.
** Was installed in error_logger
** Last event was: {info_msg,&lt;0.29.0&gt;,
                    {&lt;0.2.0&gt;,
                     &quot;Error description:~n   ~p~n~nLog files (may contain
more information):~n   ~s~n   ~s~n~n&quot;,
                     [{could_not_start,rabbit,
                       {bad_return,
                        {{rabbit,start,[normal,[]]},
                         {'EXIT',
                          {rabbit,failure_during_boot,
                           {error,
                            {cannot_start_application,asn1,
                             {&quot;no such file or
directory&quot;,&quot;asn1.app&quot;}}}}}}}},
                      &quot;/usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost.log</A>&quot;,
                      &quot;/usr/local/var/log/rabbitmq/<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at localhost-sasl.log</A>
&quot;]}}
** When handler state == {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;amq.rabbitmq.log&quot;&gt;&gt;}
** Reason == {badarg,
                 [{ets,lookup,
                      [rabbit_exchange,
                       {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,exchange,&lt;&lt;&quot;amq.rabbitmq.log&quot;&gt;&gt;}],
                      []},
                  {rabbit_misc,dirty_read,1,
                      [{file,&quot;src/rabbit_misc.erl&quot;},{line,345}]},
                  {rabbit_basic,publish,1,
                      [{file,&quot;src/rabbit_basic.erl&quot;},{line,100}]},
                  {rabbit_error_logger,publish1,4,
                      [{file,&quot;src/rabbit_error_logger.erl&quot;},{line,84}]},
                  {rabbit_error_logger,handle_event,2,
                      [{file,&quot;src/rabbit_error_logger.erl&quot;},{line,62}]},
                  {gen_event,server_update,4,
                      [{file,&quot;gen_event.erl&quot;},{line,504}]},
                  {gen_event,server_notify,4,
                      [{file,&quot;gen_event.erl&quot;},{line,486}]},
                  {gen_event,handle_msg,5,
                      [{file,&quot;gen_event.erl&quot;},{line,248}]}]}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130712/510b4dc6/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130712/510b4dc6/attachment.htm</A>&gt;
</PRE>

























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028555.html">[rabbitmq-discuss] Messages being deleted?
</A></li>
	<LI>Next message: <A HREF="028565.html">[rabbitmq-discuss] RabbitMQ boot failures with SSL on homebrew	Mac OSX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28563">[ date ]</a>
              <a href="thread.html#28563">[ thread ]</a>
              <a href="subject.html#28563">[ subject ]</a>
              <a href="author.html#28563">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
