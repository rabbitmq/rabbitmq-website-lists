<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in	the queues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20causing%20heavy%20disk%20i/o%20with%20nothing%20in%0A%09the%20queues&In-Reply-To=%3CCABZkbxiMPGZqx5Db5p2T_g0-wa2R64EDxiD0kqy4-jX-DabB1w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028513.html">
   <LINK REL="Next"  HREF="028518.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in	the queues</H1>
    <B>Kevin Goess</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20rabbitmq%20causing%20heavy%20disk%20i/o%20with%20nothing%20in%0A%09the%20queues&In-Reply-To=%3CCABZkbxiMPGZqx5Db5p2T_g0-wa2R64EDxiD0kqy4-jX-DabB1w%40mail.gmail.com%3E"
       TITLE="[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in	the queues">kgoess at bepress.com
       </A><BR>
    <I>Thu Jul 11 17:38:19 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="028513.html">[rabbitmq-discuss] shovel Plug-in problem ! (How to configure headers items)
</A></li>
        <LI>Next message: <A HREF="028518.html">[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28512">[ date ]</a>
              <a href="thread.html#28512">[ thread ]</a>
              <a href="subject.html#28512">[ subject ]</a>
              <a href="author.html#28512">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Circling back after an earlier question about this problem. We've upgraded
to 3.1.3-1.  We've moved the mnesia files to a dedicated 10k sata drive
via RABBITMQ_MNESIA_BASE, a new drive that nothing else is using, on a xen
virtual machine that is only running rabbitmq.  We generally deal with
about 20 messages per second.

But we're seeing pretty heavy disk activity, with iowait 30-40%, and iostat
numbers like this:

Device:         rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s avgrq-sz
avgqu-sz   await  svctm  %util
xvdbp1            0.00    60.00    0.00  143.40     0.00  1452.80    10.13
    0.88    6.14   4.22  60.48

Is this expected?  That seems excessive, and I worry that the high iowait
could cause us problems as we grow, so I was hoping to get some pointers to
things to look at that to improve that.  Any information, tips, or
suggestions would be much appreciated!

There's nothing in the sasl logs, and the rabbitmq logs are nothing but
these:

INFO REPORT==== 11-Jul-2013::09:25:55 ===
accepting STOMP connection &lt;0.14174.238&gt; (...)

=INFO REPORT==== 11-Jul-2013::09:26:12 ===
closing STOMP connection &lt;0.13749.238&gt; (...)

These are the queues we have in there now:

$ rabbitmqctl list_queues name durable arguments pid messages_ready
Listing queues ...
article.added_to_content_bundle true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.239.0</A>&gt; 0
institution.added_to_content_bundle true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.215.0</A>&gt; 0
production.article_downloads true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.221.0</A>&gt; 0
production.article_downloads.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.265.0</A>&gt; 0
production.article_downloads.unaggregated true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.274.0</A>&gt;
0
production.article_downloads.unaggregated.error true []
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.294.0</A>&gt; 0
production.bulk_email true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.273.0</A>&gt; 0
production.bulk_email.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.287.0</A>&gt; 0
production.certify-existing-expedites true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.307.0</A>&gt; 0
production.certify-existing-expedites.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.253.0</A>
&gt;<i> 0
</I>production.create-sw-site true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.291.0</A>&gt; 0
production.create-sw-site.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.282.0</A>&gt; 0
production.dcnetwork_follow true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.300.0</A>&gt; 0
production.dcnetwork_follow-error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.289.0</A>&gt; 229
production.dcnetwork_follow.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.232.0</A>&gt; 0
production.dcnetwork_update true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.219.0</A>&gt; 0
production.dcnetwork_update.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.301.0</A>&gt; 0
production.email true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.223.0</A>&gt; 0
production.email.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.241.0</A>&gt; 1
production.expresso-archive-pending-articles true []
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.305.0</A>&gt; 0
production.expresso-archive-pending-articles.error true []
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.299.0</A>&gt; 0
production.expresso-copy-article true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.244.0</A>&gt; 0
production.expresso-copy-article.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.242.0</A>&gt; 1
production.general-errors true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.250.0</A>&gt; 150
production.generate-usage-report true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.235.0</A>&gt; 0
production.generate-usage-report.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.222.0</A>&gt; 0
production.guest_access_report true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.238.0</A>&gt; 0
production.guest_access_report.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.281.0</A>&gt; 0
production.logged_request true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.302.0</A>&gt; 0
production.logged_request.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.245.0</A>&gt; 0
production.migrate-article-editor-notes true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.14254.0</A>&gt;
0
production.migrate-article-editor-notes.error true []
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.14255.0</A>&gt; 96
production.mq-solr-update-article true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.256.0</A>&gt; 0
production.mq-solr-update-article.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.275.0</A>&gt;
185
production.mq-solr-update-article.low-priority true []
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.262.0</A>&gt; 0
production.mq-solr-update-article.low-priority.error true []
&lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.259.0</A>&gt; 3
production.publish-context true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.295.0</A>&gt; 0
production.publish-context.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.268.0</A>&gt; 0
production.purge-stamped-files true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.14256.0</A>&gt; 0
production.purge-stamped-files.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.14257.0</A>&gt; 12
production.record_download true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.257.0</A>&gt; 0
production.record_download.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.285.0</A>&gt; 0
production.saved_search_results true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.286.0</A>&gt; 0
production.saved_search_results.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.230.0</A>&gt; 0
production.solr-update-article true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.217.0</A>&gt; 0
production.stamp-pdf true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.225.0</A>&gt; 0
production.stamp-pdf.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.251.0</A>&gt; 398
production.stamp-pdf.low-priority true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.276.0</A>&gt; 0
production.stamp-pdf.low-priority.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.236.0</A>&gt; 0
production.test true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.233.0</A>&gt; 0
production.test.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.254.0</A>&gt; 0
production.withdraw-for-author true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.296.0</A>&gt; 0
production.withdraw-for-author.error true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.308.0</A>&gt; 0
test true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.279.0</A>&gt; 0
user.added_to_content_bundle true [] &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at rabbitmq.1.237.0</A>&gt; 0
...done.


-- 
Kevin M. Goess
Software Engineer
Berkeley Electronic Press
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">kgoess at bepress.com</A>

510-665-1200 x179
www.bepress.com

bepress: sustainable scholarly publishing
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130711/a668519b/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20130711/a668519b/attachment.htm</A>&gt;
</PRE>


























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028513.html">[rabbitmq-discuss] shovel Plug-in problem ! (How to configure headers items)
</A></li>
	<LI>Next message: <A HREF="028518.html">[rabbitmq-discuss] rabbitmq causing heavy disk i/o with nothing in the queues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28512">[ date ]</a>
              <a href="thread.html#28512">[ thread ]</a>
              <a href="subject.html#28512">[ subject ]</a>
              <a href="author.html#28512">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
