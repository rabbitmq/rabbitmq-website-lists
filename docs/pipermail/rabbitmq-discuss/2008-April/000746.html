<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss]  New exchange type
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20New%20exchange%20type&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000744.html">
   <LINK REL="Next"  HREF="000748.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss]  New exchange type</H1>
    <B>Kyle Salasko</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20%20New%20exchange%20type&In-Reply-To="
       TITLE="[rabbitmq-discuss]  New exchange type">ksalasko at gmail.com
       </A><BR>
    <I>Tue Apr 22 04:06:53 BST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000744.html">[rabbitmq-discuss] Possible bug?
</A></li>
        <LI>Next message: <A HREF="000748.html">[rabbitmq-discuss] New exchange type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#746">[ date ]</a>
              <a href="thread.html#746">[ thread ]</a>
              <a href="subject.html#746">[ subject ]</a>
              <a href="author.html#746">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi all,

Recently I put together a new exchange type for RabbitMQ, because none of
the existing ones completely match our requirements. The problem it solves
is this: we want a publish-subscribe model where exactly one subscriber
receives any given message. If we set up a topic exchange and have all
subscribers listen on the same queue, we get this out of the box. But this
requires that all messages go to that one queue, which resides on one
machine, causing a pretty significant bottleneck. A reasonable way around
this was to implement a new exchange type (&quot;anycast&quot;) that picks a random
queue when a message is routed. The diff and new file for
rabbit_exchange.erl are attached.

I'm very new to erlang, so feedback/comments/optimizations are extremely
welcome.

Thanks,
Kyle

<A HREF="http://www.nabble.com/file/p16820505/rabbit_exchange.erl.diff">http://www.nabble.com/file/p16820505/rabbit_exchange.erl.diff</A>
rabbit_exchange.erl.diff 
<A HREF="http://www.nabble.com/file/p16820505/rabbit_exchange.erl">http://www.nabble.com/file/p16820505/rabbit_exchange.erl</A> rabbit_exchange.erl 
-- 
View this message in context: <A HREF="http://www.nabble.com/New-exchange-type-tp16820505p16820505.html">http://www.nabble.com/New-exchange-type-tp16820505p16820505.html</A>
Sent from the RabbitMQ mailing list archive at Nabble.com.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000744.html">[rabbitmq-discuss] Possible bug?
</A></li>
	<LI>Next message: <A HREF="000748.html">[rabbitmq-discuss] New exchange type
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#746">[ date ]</a>
              <a href="thread.html#746">[ thread ]</a>
              <a href="subject.html#746">[ subject ]</a>
              <a href="author.html#746">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
