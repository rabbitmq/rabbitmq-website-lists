<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel stops receiving acks from cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stops%20receiving%20acks%20from%20cluster&In-Reply-To=%3CAD8BDDA3D61AC241BA02DED7063643BA2FE5F7F4%40osl02-exc-001%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022046.html">
   <LINK REL="Next"  HREF="022065.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel stops receiving acks from cluster</H1>
    <B>Jon Bergli Heier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stops%20receiving%20acks%20from%20cluster&In-Reply-To=%3CAD8BDDA3D61AC241BA02DED7063643BA2FE5F7F4%40osl02-exc-001%3E"
       TITLE="[rabbitmq-discuss] Shovel stops receiving acks from cluster">jon.bergli.heier at zisson.no
       </A><BR>
    <I>Wed Aug 22 17:04:37 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022046.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
        <LI>Next message: <A HREF="022065.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22050">[ date ]</a>
              <a href="thread.html#22050">[ thread ]</a>
              <a href="subject.html#22050">[ subject ]</a>
              <a href="author.html#22050">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> So it looks like there is a lot more going on in your system then you
</I>&gt;<i> have hitherto told us about.
</I>
Yes, apologies for that.

&gt;<i> Is there any chance you could trim this setup down to the bare
</I>&gt;<i> essentials to help in tracking down the problem?
</I>
I just set up two new VMs with RabbitMQ and clustered them. I was still
able to reproduce the problem, but compared to one or two tries it took
me 12 tries (of stopping and starting nodes). I also tried disabling the other
shovels on the shovel node (by commenting them out in the config) and removing
all other queues and exchanges, with that it took 15 tries.

I attached the results of the same commands with the new setup, qa-test1 and
qa-test2 are the new nodes I set up. qa-test1 was the trigger in both cases.

&gt;<i> Also, which node did you bounce - rabbit1 or rabbit2?
</I>
rabbit2


Jon
________________________________________
From: Matthias Radestock [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>]
Sent: Wednesday, August 22, 2012 15:52
To: Jon Bergli Heier
Cc: Discussions about RabbitMQ
Subject: Re: [rabbitmq-discuss] Shovel stops receiving acks from cluster

Jon,

On 22/08/12 14:17, Jon Bergli Heier wrote:
&gt;<i> Attached these as log files, rabbit1 is the destination and shovel is the source
</I>&gt;<i> broker where the shovel lives. The direct connection doesn't seem to show up
</I>&gt;<i> from the report command at all, but I can see it in the management interface.
</I>
There are a lot of connections from other rabbits to rabbit1, most of
them from version 2.8.5, some from 2.8.1. There are a few 2.8.6
connections. All but two of the connections have a timeout of 10s
whereas your shovel config indicated that the heartbeat is 5 seconds.

So it looks like there is a lot more going on in your system then you
have hitherto told us about.

I can see that there is one channel on rabbit1 with 1000 pending
confirms, which is certainly odd.

Is there any chance you could trim this setup down to the bare
essentials to help in tracking down the problem?

Also, which node did you bounce - rabbit1 or rabbit2?

Regards,

Matthias.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logs.tar.gz
Type: application/x-gzip
Size: 5273 bytes
Desc: logs.tar.gz
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/9ddf2841/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/9ddf2841/attachment.bin</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022046.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
	<LI>Next message: <A HREF="022065.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22050">[ date ]</a>
              <a href="thread.html#22050">[ thread ]</a>
              <a href="subject.html#22050">[ subject ]</a>
              <a href="author.html#22050">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
