<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20.Net%20RabbitMQ.Client%20Issue%3A%20Deadlock%20on%0A%09ConnectionShutdown&In-Reply-To=%3C50339D74.9080305%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022015.html">
   <LINK REL="Next"  HREF="022019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown</H1>
    <B>Emile Joubert</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20.Net%20RabbitMQ.Client%20Issue%3A%20Deadlock%20on%0A%09ConnectionShutdown&In-Reply-To=%3C50339D74.9080305%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown">emile at rabbitmq.com
       </A><BR>
    <I>Tue Aug 21 15:38:44 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022015.html">[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
</A></li>
        <LI>Next message: <A HREF="022019.html">[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22018">[ date ]</a>
              <a href="thread.html#22018">[ thread ]</a>
              <a href="subject.html#22018">[ subject ]</a>
              <a href="author.html#22018">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Derek,

On 21/08/12 15:10, Derek Greer wrote:
&gt;<i> My apologizes, I should have included the version number.  I see this
</I>&gt;<i> behavior using version 2.8.4 from NuGet.  Perhaps you're testing with a
</I>&gt;<i> different version? 
</I>
I tested with the latest version, but there have been no changes in that
area since 2.8.4.

&gt;<i> That aside, there should never be a case when a client of the
</I>&gt;<i> .Net rabbitmq client should be able to call .Close() and cause the API
</I>&gt;<i> to block indefinitely.
</I>
I'm not able to reproduce the deadlock, as I said, I see an exception
(see attached).

&gt;<i> I appreciate your pointing me to the use of the IModel.ModelShutdown.  I
</I>&gt;<i> would have thought that event would be raised any time the model was
</I>&gt;<i> closed rather than being raised exclusively due to a connection
</I>&gt;<i> shutdown.  I'll use that if I have to, but wouldn't you agree that
</I>&gt;<i> clients of the API should be able to subscribe to the
</I>&gt;<i> IConnection.ConnectionShutdown event to be alerted to connection
</I>&gt;<i> shutdowns?  
</I>
Yes, ModelShutdown is raised when the channel shuts down for any reason,
including due to a network interruption. Clients that need notification
of the network connection shutting down should subscribe to
ConnectionShutdown, as your example illustrates. The library also
includes an example (RabbitMQ.Client.Examples.ExceptionTest) that shows
how to go about this.

What is the problem you are trying to solve that the alleged deadlock is
preventing you from solving? If the problem is to ensure that channels
are closed when connections shut down, then you don't need to do that,
since the library already takes care of it.

-Emile

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Exception.txt
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120821/d3b00c76/attachment.txt">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120821/d3b00c76/attachment.txt</A>&gt;
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022015.html">[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
</A></li>
	<LI>Next message: <A HREF="022019.html">[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22018">[ date ]</a>
              <a href="thread.html#22018">[ thread ]</a>
              <a href="subject.html#22018">[ subject ]</a>
              <a href="author.html#22018">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
