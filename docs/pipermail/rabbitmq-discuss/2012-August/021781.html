<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Two questions: max bindings and handling noconsumer present
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Two%20questions%3A%20max%20bindings%20and%20handling%0A%20noconsumer%20present&In-Reply-To=%3CAF4AD4ADFB23054CB4C75F50FF8C40B73B610E741D%40MAILCCR.us.syncsort.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021624.html">
   <LINK REL="Next"  HREF="021784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Two questions: max bindings and handling noconsumer present</H1>
    <B>Bell, Paul M.</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Two%20questions%3A%20max%20bindings%20and%20handling%0A%20noconsumer%20present&In-Reply-To=%3CAF4AD4ADFB23054CB4C75F50FF8C40B73B610E741D%40MAILCCR.us.syncsort.com%3E"
       TITLE="[rabbitmq-discuss] Two questions: max bindings and handling noconsumer present">pbell at syncsort.com
       </A><BR>
    <I>Wed Aug  8 23:06:48 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021624.html">[rabbitmq-discuss] Two questions: max bindings and handling no consumer present
</A></li>
        <LI>Next message: <A HREF="021784.html">[rabbitmq-discuss] Two questions: max bindings and handling noconsumer present
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21781">[ date ]</a>
              <a href="thread.html#21781">[ thread ]</a>
              <a href="subject.html#21781">[ subject ]</a>
              <a href="author.html#21781">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tim and Matthias,

Thank you for your replies. Sorry I didn't get back to you sooner.

I do understand that the instant I determine (query the infrastructure) that the consumer is up, it might go down.

I am trying to prevent a &quot;job start&quot; message from being published when there is no consumer to receive that message. In the normal course of events, with the consumer up, receipt of such a message would cause the consumer to run the job requested by the message.

It is far more preferable to complain up front that there is no consumer (and that therefore the job won't be run) than it is to have the broker silently discard the message.

I will think about the alternative routing topologies Matthias suggests. But what's wrong with using the mandatory flag - is it not applicable for the case I describe?

Cordially,

Paul

-----Original Message-----
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A>] On Behalf Of Matthias Radestock
Sent: Wednesday, August 01, 2012 4:09 AM
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Two questions: max bindings and handling noconsumer present

On 01/08/12 08:23, Tim Watson wrote:
&gt;<i>
</I>&gt;<i> On 1 Aug 2012, at 04:10, &quot;Bell, Paul M.&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pbell at syncsort.com</A>&gt; .
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I suppose this is where the &quot;mandatory&quot; flag comes in. But I'm
</I>&gt;&gt;<i> wondering if there's a way to query  the broker about its
</I>&gt;&gt;<i> infrastructure, e.g., the existence of a queue/binding that would
</I>&gt;&gt;<i> indicate the presence of the consumer.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> There are ways to query the infrastructure, but these rare generally
</I>&gt;<i> not exposed to client APIs. What client are you using?
</I>
Moreover, performing such a &quot;does a consumer exists?&quot; query before
publishing is racy, since the consumer might well vanish between the
query and the publishing event.

What are you actually trying to accomplish? Is the idea that in the
absence of consumers the producer would hang on to the message and retry
later? In that case you may want to consider alternative routing
topologies. E.g. perhaps the consumer queues could be declared ahead of
time. Or you could use an alternate exchange to route messages to
holding queue where they are then picked up from consumers when they
join. Or you could do something even more sophisticated and configure
said holding queue with a message-ttl and set the original exchange as
the dead-letter exchange of the queue - that way messages will be
retried periodically automatically.

Matthias.
_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>



ATTENTION: -----

The information contained in this message (including any files transmitted with this message) may contain proprietary, trade secret or other  confidential and/or legally privileged information. Any pricing information contained in this message or in any files transmitted with this message is always confidential and cannot be shared with any third parties without prior written approval from Syncsort. This message is intended to be read only by the individual or entity to whom it is addressed or by their designee. If the reader of this message is not the intended recipient, you are on notice that any use, disclosure, copying or distribution of this message, in any form, is strictly prohibited. If you have received this message in error, please immediately notify the sender and/or Syncsort and destroy all copies of this message in your possession, custody or control.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021624.html">[rabbitmq-discuss] Two questions: max bindings and handling no consumer present
</A></li>
	<LI>Next message: <A HREF="021784.html">[rabbitmq-discuss] Two questions: max bindings and handling noconsumer present
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21781">[ date ]</a>
              <a href="thread.html#21781">[ thread ]</a>
              <a href="subject.html#21781">[ subject ]</a>
              <a href="author.html#21781">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
