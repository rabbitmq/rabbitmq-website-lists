<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Java client deadlock closing channel/connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20deadlock%20closing%20channel/connection&In-Reply-To=%3C4c7f92dd-e132-48c6-9674-1dbc90bdec1d%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022064.html">
   <LINK REL="Next"  HREF="022063.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Java client deadlock closing channel/connection</H1>
    <B>dharshanr</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Java%20client%20deadlock%20closing%20channel/connection&In-Reply-To=%3C4c7f92dd-e132-48c6-9674-1dbc90bdec1d%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] Java client deadlock closing channel/connection">dharshanr at scalegrid.net
       </A><BR>
    <I>Wed Aug 22 19:36:07 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022064.html">[rabbitmq-discuss] JSONRPC-Channel Plugin and TCP Backpressure
</A></li>
        <LI>Next message: <A HREF="022063.html">[rabbitmq-discuss] Java client deadlock closing	channel/connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22052">[ date ]</a>
              <a href="thread.html#22052">[ thread ]</a>
              <a href="subject.html#22052">[ subject ]</a>
              <a href="author.html#22052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi folks,

My java client is hitting a deadlock closing a channel or a connection. I 
have also noticed that it hangs when deleting a queue as well. I have 
noticed this error when the server has a large number of connections. When 
I reboot the error goes away for some time and then appears again. In the 
rabbitmq management webpage I see a memory warning

Memory usage is 2.3GB where the high watermark is 1.5 GB.
&quot;The memory alarm for this node has gone off. It will block incoming 
network traffic until the memory usage drops below the watermark. &quot;. 

Why is the memory usage above the watermark? From what I have read RabbitMQ 
moves the messages to disk and scales that way without using more memory.

regards,
Dharshan
www.scalegrid.net
(Services for the private cloud)


Here is the status of my server

Status of node <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at drrabbitmq1</A> ...
[{pid,1169},
 {running_applications,
     [{rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;2.8.4&quot;},
      {xmerl,&quot;XML parser&quot;,&quot;1.2.10&quot;},
      {rabbitmq_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;2.8.4&quot;},
      {amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.8.4&quot;},
      {rabbit,&quot;RabbitMQ&quot;,&quot;2.8.4&quot;},
      {ssl,&quot;Erlang/OTP SSL application&quot;,&quot;4.1.6&quot;},
      {public_key,&quot;Public key infrastructure&quot;,&quot;0.13&quot;},
      {crypto,&quot;CRYPTO version 2&quot;,&quot;2.0.4&quot;},
      {os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.7&quot;},
      {sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.10&quot;},
      {rabbitmq_mochiweb,&quot;RabbitMQ Mochiweb Embedding&quot;,&quot;2.8.4&quot;},
      {webmachine,&quot;webmachine&quot;,&quot;1.7.0-rmq2.8.4-hg&quot;},
      {mochiweb,&quot;MochiMedia Web Server&quot;,&quot;1.3-rmq2.8.4-git&quot;},
      {inets,&quot;INETS  CXC 138 49&quot;,&quot;5.7.1&quot;},
      {mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.5&quot;},
      {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.5&quot;},
      {kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.5&quot;}]},
 {os,{unix,linux}},
 {erlang_version,
     &quot;Erlang R14B04 (erts-5.8.5) [source] [64-bit] [smp:2:2] [rq:2] 
[async-threads:30] [kernel-poll:true]\n&quot;},
 {memory,
     [{total,2379504536},
      {processes,1926964632},
      {processes_used,1924985912},
      {system,452539904},
      {atom,1722081},
      {atom_used,1690549},
      {binary,194345200},
      {code,18717132},
      {ets,176530144}]},
 {vm_memory_high_watermark,0.3999999998070925},
 {vm_memory_limit,1658825932},
 {disk_free_limit,1000000000},
 {disk_free,2966052864},
 {file_descriptors,
     [{total_limit,65436},
      {total_used,18006},
      {sockets_limit,58890},
      {sockets_used,8000}]},
 {processes,[{limit,1048576},{used,98174}]},
 {run_queue,0},
 {uptime,61715}]
...done.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/1dcab318/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/1dcab318/attachment.htm</A>&gt;
</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022064.html">[rabbitmq-discuss] JSONRPC-Channel Plugin and TCP Backpressure
</A></li>
	<LI>Next message: <A HREF="022063.html">[rabbitmq-discuss] Java client deadlock closing	channel/connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22052">[ date ]</a>
              <a href="thread.html#22052">[ thread ]</a>
              <a href="subject.html#22052">[ subject ]</a>
              <a href="author.html#22052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
