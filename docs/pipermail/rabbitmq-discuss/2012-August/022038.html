<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem transferring large message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20transferring%20large%20message&In-Reply-To=%3C0A2E916B-06B0-42E4-A52A-0346EF300159%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022036.html">
   <LINK REL="Next"  HREF="022008.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem transferring large message</H1>
    <B>Zabrane Mickael</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20transferring%20large%20message&In-Reply-To=%3C0A2E916B-06B0-42E4-A52A-0346EF300159%40gmail.com%3E"
       TITLE="[rabbitmq-discuss] Problem transferring large message">zabrane3 at gmail.com
       </A><BR>
    <I>Wed Aug 22 12:58:22 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022036.html">[rabbitmq-discuss] Problem transferring large message
</A></li>
        <LI>Next message: <A HREF="022008.html">[rabbitmq-discuss] Per-Connection Flow Control -- The Verdict
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22038">[ date ]</a>
              <a href="thread.html#22038">[ thread ]</a>
              <a href="subject.html#22038">[ subject ]</a>
              <a href="author.html#22038">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Matthias,

&gt;<i> I have just tested twenty producers sending 50Mb messages to Rabbit as
</I>&gt;<i> fast as they can. The combined rate was ~30Hz. And that's on a fairly modest machine. There were some long pauses when messages were getting paged to disk, and memory peaked at about 80% (so twice the configured threshold), but that's expected. No crashes.
</I>&gt;<i> 
</I>&gt;<i> With smaller messages the performance profile will be smoother, i.e. the pauses will be shorter and memory peaks will be lower. But there are downsides to fragmenting messages aside from the extra code involved...
</I>
Interesting.

&gt;&gt;<i> That's what we can't afford to have. RAM is limited and we had to
</I>&gt;&gt;<i> deal with millions of very big messages.
</I>&gt;<i> 
</I>&gt;<i> When you say 'deal with millions', what do you mean? That your rabbit needs to hold (in its queues) millions of 50Mb messages? If you fragment messages at 100k that would translate to 500 million messages. You'd need a fair amount of RAM for that since each message has some fixed memory footprint (in the small hundreds of bytes, iirc) even when paged to disk.
</I>

Yep. Our system (large cluster) produce huge amount files on disk (0 to 5 millions per day) and we needed to analyse them at as fast as possible.
These messages stay a very short time on Rabbit queues. Splitting them helped us a lot.

Regards,
Zabrane

</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022036.html">[rabbitmq-discuss] Problem transferring large message
</A></li>
	<LI>Next message: <A HREF="022008.html">[rabbitmq-discuss] Per-Connection Flow Control -- The Verdict
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22038">[ date ]</a>
              <a href="thread.html#22038">[ thread ]</a>
              <a href="subject.html#22038">[ subject ]</a>
              <a href="author.html#22038">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
