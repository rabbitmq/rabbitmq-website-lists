<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] How to achieve HA consumers?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20achieve%20HA%20consumers%3F&In-Reply-To=%3C201208250937187791132%40edocom.cn%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022110.html">
   <LINK REL="Next"  HREF="022205.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] How to achieve HA consumers?</H1>
    <B>johnson</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20How%20to%20achieve%20HA%20consumers%3F&In-Reply-To=%3C201208250937187791132%40edocom.cn%3E"
       TITLE="[rabbitmq-discuss] How to achieve HA consumers?">johnson at edocom.cn
       </A><BR>
    <I>Sat Aug 25 02:37:19 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022110.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
        <LI>Next message: <A HREF="022205.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22120">[ date ]</a>
              <a href="thread.html#22120">[ thread ]</a>
              <a href="subject.html#22120">[ subject ]</a>
              <a href="author.html#22120">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks, Michael. Actually round-robins dispatching doesn't fit my situation well. If two consumers exist, they will get the message almost in the same time. In this way, the order of the messages cannot be assured. I wonder if there is some way that the server will send the message the second consumer only after it receives the ACK from the first consumer.




johnson

From: Laing, Michael P.
Date: 2012-08-25 03:12
To: rabbitmq; johnson
Subject: Re: [rabbitmq-discuss] How to achieve HA consumers?
Actually, rereading, perhaps my solution is different from yours&#8230;


From: Michael Laing &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Michael.Laing at nytimes.com</A>&gt;
Reply-To: rabbitmq &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Date: Fri, 24 Aug 2012 13:54:15 -0400
To: johnson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johnson at edocom.cn</A>&gt;, rabbitmq &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] How to achieve HA consumers?



I use your option 1: below, which works well.


All critical services drive from HA queues and have at least one worker (consumer) connected to each node in the cluster. RabbitMQ round-robins messages to the workers. If a worker or node fails, its message is routed to another worker.


Michael
From: johnson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johnson at edocom.cn</A>&gt;
Reply-To: johnson &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">johnson at edocom.cn</A>&gt;, rabbitmq &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Date: Fri, 24 Aug 2012 12:30:01 -0400
To: rabbitmq &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Subject: [rabbitmq-discuss] How to achieve HA consumers?



Hi,

One problem I encountered is how to achieve HA consumers. My situation is the following.

I installed 1 consumer in a server to consume the messages. But in the production environment, to avoid the unexceptional crash of the consumer, I need to install another consumer in another server. However, because the order of the messages are very important, if two consumers receive the messages simultaneously, the order cannot be reserved.

Maybe the following 2 way can work.
1: At the same time, the server only sends the message to 1 consumer. After that consumer return a ACK, the server send the message to another consumer. This means that although two consumers exist, they receive the messages in turn not concurrently. Once 1 consumer crashes, the remaining consumer can still work.

2: 2 consumers work like master-slave. Only 1 consumer works and the other one doesn't consume any message. Once 1 consumer crashes, the remaining consumer will be activated.

I have searched a lot of RabbitMQ docs and couldn't find useful info. Could anyone can give me some clue? Thanks a lot.




johnson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120825/d8623ea0/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120825/d8623ea0/attachment.htm</A>&gt;
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022110.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
	<LI>Next message: <A HREF="022205.html">[rabbitmq-discuss] How to achieve HA consumers?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22120">[ date ]</a>
              <a href="thread.html#22120">[ thread ]</a>
              <a href="subject.html#22120">[ subject ]</a>
              <a href="author.html#22120">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
