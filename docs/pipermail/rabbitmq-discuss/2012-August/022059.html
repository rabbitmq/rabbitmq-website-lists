<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Difference betweeen rabbitmqctl and management plugin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Difference%20betweeen%20rabbitmqctl%20and%0A%20management%20plugin&In-Reply-To=%3C5035A40D.2080502%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022056.html">
   <LINK REL="Next"  HREF="022060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Difference betweeen rabbitmqctl and management plugin</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Difference%20betweeen%20rabbitmqctl%20and%0A%20management%20plugin&In-Reply-To=%3C5035A40D.2080502%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Difference betweeen rabbitmqctl and management plugin">matthias at rabbitmq.com
       </A><BR>
    <I>Thu Aug 23 04:31:25 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022056.html">[rabbitmq-discuss] Difference betweeen rabbitmqctl and management	plugin
</A></li>
        <LI>Next message: <A HREF="022060.html">[rabbitmq-discuss] RabbitMQ sources release
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22059">[ date ]</a>
              <a href="thread.html#22059">[ thread ]</a>
              <a href="subject.html#22059">[ subject ]</a>
              <a href="author.html#22059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Seth,

On 23/08/12 02:12, Seth Mason wrote:
&gt;<i> Hello, I'm getting different results from the management API than I am
</I>&gt;<i> from rabbitmqctl when looking at memory.
</I>&gt;<i>
</I>&gt;<i> GET /api/queues/test?columns=name,memory
</I>&gt;<i> [
</I>&gt;<i>      {
</I>&gt;<i>          &quot;memory&quot;: 17280,
</I>&gt;<i>          &quot;name&quot;: &quot;queueone&quot;
</I>&gt;<i>      },
</I>&gt;<i>      {
</I>&gt;<i>          &quot;memory&quot;: 7656,
</I>&gt;<i>          &quot;name&quot;: &quot;queuetwo&quot;
</I>&gt;<i>      }
</I>&gt;<i> ]
</I>&gt;<i>
</I>&gt;&gt;<i> rabbitmqctl list_queues -p test -q name memory
</I>&gt;<i> queuetwo	21952
</I>&gt;<i> queueone	58560
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Is the API returning a different stat than rabbitmqctl or did I miss
</I>&gt;<i> some documentation somewhere?
</I>
The stats for the management API are gathered through passive sampling - 
queues etc send stats to a collector at regular intervals when active 
and the query retrieves the stats from the collector.

The stats for rabbitmqctl are gathered by a direct query of the 
resources involved.

What you are observing above is most likely due to difference in 
hibernation behaviour induced by the different strategies.

Just before a queue goes into hibernation (due to being idle) it 
compacts some of its state, and then sends a final stats report to the 
collector. Those stats will then be returned by the management API for 
the entire duration the queue is hibernating.

By contrast, rabbitmqctl will wake up hibernating queues, which a) is 
expensive and b)  increases their memory footprint (until they hibernate 
again).

Matthias.
</PRE>



























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022056.html">[rabbitmq-discuss] Difference betweeen rabbitmqctl and management	plugin
</A></li>
	<LI>Next message: <A HREF="022060.html">[rabbitmq-discuss] RabbitMQ sources release
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22059">[ date ]</a>
              <a href="thread.html#22059">[ thread ]</a>
              <a href="subject.html#22059">[ subject ]</a>
              <a href="author.html#22059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
