<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Exchange/queue setup question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange/queue%20setup%20question&In-Reply-To=%3C87wr0slctp.wl%25francesco%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021995.html">
   <LINK REL="Next"  HREF="022000.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Exchange/queue setup question</H1>
    <B>Francesco Mazzoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange/queue%20setup%20question&In-Reply-To=%3C87wr0slctp.wl%25francesco%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Exchange/queue setup question">francesco at rabbitmq.com
       </A><BR>
    <I>Tue Aug 21 12:11:14 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021995.html">[rabbitmq-discuss] Exchange/queue setup question
</A></li>
        <LI>Next message: <A HREF="022000.html">[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22013">[ date ]</a>
              <a href="thread.html#22013">[ thread ]</a>
              <a href="subject.html#22013">[ subject ]</a>
              <a href="author.html#22013">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chris,

At Mon, 20 Aug 2012 12:10:58 -0400,
Chris Johnson wrote:
&gt;<i> I need a second pair of eyes on a small RMQ app I'm working on.
</I>&gt;<i> I suspect the issue I'm seeing is related to how I am defining my exchanges
</I>&gt;<i> and queues.
</I>&gt;<i> 
</I>&gt;<i> If I connect with two clients, I'll see every other message appear on my
</I>&gt;<i> client. If I connect with three clients, I see every third message, and so on.
</I>&gt;<i> In other words, it appears to 1) be deleting every message that gets produced
</I>&gt;<i> on consumption, and 2) round robins which consumer gets each message.
</I>&gt;<i> 
</I>&gt;<i> What I want to see is all clients get the same message each time one is
</I>&gt;<i> posted.
</I>&gt;<i> 
</I>&gt;<i> Is a topic approach the best approach for this, or is fanout the better way to
</I>&gt;<i> handle this?
</I>
Rabbit will deliver each message to one consumer only.  So the solution to this
problem is to use multiple queues, possibly with a fanout exchange.

&gt;<i> Here's the specifics of how my producer and consumer is set up:
</I>&gt;<i> 
</I>&gt;<i> PRODUCER (client=bunny)
</I>&gt;<i> =====================
</I>&gt;<i> 
</I>&gt;<i> @topic_exchange ||= client.exchange(&quot;internal.platformalert&quot;, :type =&gt; :topic,
</I>&gt;<i>                                     :durable =&gt; true, :autodelete =&gt; false)
</I>&gt;<i> @queue ||= client.queue(&quot;internal.platformalert.#&quot;, :durable =&gt; true,
</I>&gt;<i>                         :autodelete =&gt; false, :arguments =&gt; {'x-ha-policy' =&gt; 'all'})
</I>&gt;<i> queue.bind(e, :key =&gt; &quot;alert&quot;)
</I>&gt;<i> exchange.publish(message, :key =&gt; &quot;alert&quot;, :persistent =&gt; true)                        
</I>
I think you're confused about how exchanges work.  You seem to be using the
queue name to match topics, while that's not how exchanges work (the binding
defines that). See the tutorial:
&lt;<A HREF="http://www.rabbitmq.com/tutorials/tutorial-five-python.html">http://www.rabbitmq.com/tutorials/tutorial-five-python.html</A>&gt;.

--
Francesco * Often in error, never in doubt
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021995.html">[rabbitmq-discuss] Exchange/queue setup question
</A></li>
	<LI>Next message: <A HREF="022000.html">[rabbitmq-discuss] .Net RabbitMQ.Client Issue: Deadlock on	ConnectionShutdown
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22013">[ date ]</a>
              <a href="thread.html#22013">[ thread ]</a>
              <a href="subject.html#22013">[ subject ]</a>
              <a href="author.html#22013">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
