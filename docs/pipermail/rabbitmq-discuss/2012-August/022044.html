<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel stops receiving acks from cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stops%20receiving%20acks%20from%20cluster&In-Reply-To=%3CAD8BDDA3D61AC241BA02DED7063643BA2FE5F7BD%40osl02-exc-001%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022039.html">
   <LINK REL="Next"  HREF="022046.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel stops receiving acks from cluster</H1>
    <B>Jon Bergli Heier</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stops%20receiving%20acks%20from%20cluster&In-Reply-To=%3CAD8BDDA3D61AC241BA02DED7063643BA2FE5F7BD%40osl02-exc-001%3E"
       TITLE="[rabbitmq-discuss] Shovel stops receiving acks from cluster">jon.bergli.heier at zisson.no
       </A><BR>
    <I>Wed Aug 22 14:17:52 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022039.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
        <LI>Next message: <A HREF="022046.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22044">[ date ]</a>
              <a href="thread.html#22044">[ thread ]</a>
              <a href="subject.html#22044">[ subject ]</a>
              <a href="author.html#22044">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> I suggest you give the brand new 2.8.6 release a try.
</I>
I still see this behavior in 2.8.6.

&gt;<i> Also, I notice in your rabbit config you have a uri
</I>&gt;<i> &quot;<A HREF="amqp://localhost?heartbeat=5&quot;">amqp://localhost?heartbeat=5&quot;</A> - that will establish a network
</I>&gt;<i> connection, whereas a direct connection (&quot;<A HREF="amqp://&quot;">amqp://&quot;</A>) would do and be more
</I>&gt;<i> efficient.
</I>
I had actually forgotten about that. We have seen the same problem that was
mentioned in another post to the list yesterday, where the shovel would spawn
a new connection each time it tried to reconnect (while stuck in a failed state),
and used this as a workaround. I've tested both with and without a direct
connection now, and I see the problem appear on both configurations.

&gt;<i> If you still see problems, please send us the output of 'rabbitmctl
</I>&gt;<i> report' on both the source and destination brokers, as well as the
</I>&gt;<i> output of &quot;rabbitmqctl eval 'rabbit_shovel_status:status().'&quot; on the
</I>&gt;<i> shoveling node.
</I>
Attached these as log files, rabbit1 is the destination and shovel is the source
broker where the shovel lives. The direct connection doesn't seem to show up
from the report command at all, but I can see it in the management interface.


Jon

________________________________________
From: Matthias Radestock [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at rabbitmq.com</A>]
Sent: Wednesday, August 22, 2012 14:06
To: Discussions about RabbitMQ
Cc: Jon Bergli Heier
Subject: Re: [rabbitmq-discuss] Shovel stops receiving acks from cluster

Jon,

On 20/08/12 11:35, Jon Bergli Heier wrote:
&gt;<i> Looking at the end of the log, at approx. 10:51:55 one of the nodes are shut
</I>&gt;<i> down, and in the management interface I see that the shovel reconnects to the
</I>&gt;<i> other node. About 30 seconds later I start it up again, nothing seems to be
</I>&gt;<i> logged at this time. (The last entry in the log is my producer client manually
</I>&gt;<i> disconnecting)
</I>
I suggest you give the brand new 2.8.6 release a try.

Also, I notice in your rabbit config you have a uri
&quot;<A HREF="amqp://localhost?heartbeat=5&quot;">amqp://localhost?heartbeat=5&quot;</A> - that will establish a network
connection, whereas a direct connection (&quot;<A HREF="amqp://&quot;">amqp://&quot;</A>) would do and be more
efficient.

If you still see problems, please send us the output of 'rabbitmctl
report' on both the source and destination brokers, as well as the
output of &quot;rabbitmqctl eval 'rabbit_shovel_status:status().'&quot; on the
shoveling node.

Regards,

Matthias.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rabbit1-report.log
Type: text/x-log
Size: 39043 bytes
Desc: rabbit1-report.log
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/f4466d47/attachment.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/f4466d47/attachment.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: shovel_report.log
Type: text/x-log
Size: 7733 bytes
Desc: shovel_report.log
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/f4466d47/attachment-0001.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/f4466d47/attachment-0001.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: shovel_status.log
Type: text/x-log
Size: 1777 bytes
Desc: shovel_status.log
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/f4466d47/attachment-0002.bin">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120822/f4466d47/attachment-0002.bin</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022039.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
	<LI>Next message: <A HREF="022046.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22044">[ date ]</a>
              <a href="thread.html#22044">[ thread ]</a>
              <a href="subject.html#22044">[ subject ]</a>
              <a href="author.html#22044">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
