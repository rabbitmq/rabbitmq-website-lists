<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] .NET ssl_upgrade_failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20.NET%20ssl_upgrade_failure&In-Reply-To=%3C10c7d66e-dd95-4f1e-9911-2e78210c030b%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021676.html">
   <LINK REL="Next"  HREF="021678.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] .NET ssl_upgrade_failure</H1>
    <B>Mark Ward</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20.NET%20ssl_upgrade_failure&In-Reply-To=%3C10c7d66e-dd95-4f1e-9911-2e78210c030b%40googlegroups.com%3E"
       TITLE="[rabbitmq-discuss] .NET ssl_upgrade_failure">ward.mark at gmail.com
       </A><BR>
    <I>Thu Aug  2 17:58:21 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021676.html">[rabbitmq-discuss] .NET ssl_upgrade_failure
</A></li>
        <LI>Next message: <A HREF="021678.html">[rabbitmq-discuss] .NET ssl_upgrade_failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21677">[ date ]</a>
              <a href="thread.html#21677">[ thread ]</a>
              <a href="subject.html#21677">[ subject ]</a>
              <a href="author.html#21677">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I here is the output of the exceptions I get from .NET and Mono.  The Mono 
exception appears to provide more information.  I followed the ssl 
instructions for setting up the rabbitmq certificate.  I will double check 
its settings. Although openssl and java do not appear to have problems 
connecting.  I know there are notes about some of the issues with mono and 
I will visit them again.

When I test with openssl i execute it like the following $ openssl s_client 
-connect localhost:5671 -CAfile /home/mark/rabbitmqCert/testca/cacert.pem 
and the verify result is 0 (ok)

.NET exception: note, this did not provide an inner exception.

RabbitMQ.Client.Exceptions.BrokerUnreachableException was unhandled
  Message=None of the specified endpoints were reachable
  Source=RabbitMQ.Client
  StackTrace:
       at RabbitMQ.Client.ConnectionFactory.CreateConnection(Int32 
maxRedirects)
       at RabbitMQ.Client.ConnectionFactory.CreateConnection()
       at ProducerOne.Program.Main(String[] args) in 
C:\FirstRabbitMQ\ProducerOne\Program.cs:line 40
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, 
String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence 
assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext 
executionContext, ContextCallback callback, Object state, Boolean 
ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext 
executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 

Mono

Unhandled Exception: None of the specified endpoints were reachable
Endpoints attempted:
------------------------------------------------
endpoint=amqp-0-<A HREF="9://192.168.10.166:5671,">9://192.168.10.166:5671,</A> attempts=1
System.IO.IOException: The authentication or decryption has failed. ---&gt; 
Mono.Se
curity.Protocol.Tls.TlsException: Invalid certificate received from server.
  at 
Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.validateCe
rtificates (Mono.Security.X509.X509CertificateCollection certificates) 
[0x00000]
 in &lt;filename unknown&gt;:0
  at 
Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.ProcessAsT
ls1 () [0x00000] in &lt;filename unknown&gt;:0
  at 
Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.ProcessAsS
sl3 () [0x00000] in &lt;filename unknown&gt;:0
  at Mono.Security.Protocol.Tls.Handshake.HandshakeMessage.Process () 
[0x00000]
in &lt;filename unknown&gt;:0
  at (wrapper remoting-invoke-with-check) 
Mono.Security.Protocol.Tls.Handshake.H
andshakeMessage:Process ()
  at 
Mono.Security.Protocol.Tls.ClientRecordProtocol.ProcessHandshakeMessage (Mo
no.Security.Protocol.Tls.TlsStream handMsg) [0x00000] in &lt;filename 
unknown&gt;:0
  at 
Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback (IA
syncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
  --- End of inner exception stack trace ---
  at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback 
(IAsyncResu
lt asyncResult) [0x00000] in &lt;filename unknown&gt;:0
================================================
Stack trace:
  at RabbitMQ.Client.ConnectionFactory.CreateConnection (Int32 
maxRedirects) [0x
00000] in &lt;filename unknown&gt;:0
  at RabbitMQ.Client.ConnectionFactory.CreateConnection () [0x00000] in 
&lt;filenam
e unknown&gt;:0
  at ProducerOne.Program.Main (System.String[] args) [0x00000] in &lt;filename 
unkn
own&gt;:0
[ERROR] FATAL UNHANDLED EXCEPTION: None of the specified endpoints were 
reachabl
e
Endpoints attempted:
------------------------------------------------
endpoint=amqp-0-<A HREF="9://192.168.10.166:5671,">9://192.168.10.166:5671,</A> attempts=1
System.IO.IOException: The authentication or decryption has failed. ---&gt; 
Mono.Se
curity.Protocol.Tls.TlsException: Invalid certificate received from server.
  at 
Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.validateCe
rtificates (Mono.Security.X509.X509CertificateCollection certificates) 
[0x00000]
 in &lt;filename unknown&gt;:0
  at 
Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.ProcessAsT
ls1 () [0x00000] in &lt;filename unknown&gt;:0
  at 
Mono.Security.Protocol.Tls.Handshake.Client.TlsServerCertificate.ProcessAsS
sl3 () [0x00000] in &lt;filename unknown&gt;:0
  at Mono.Security.Protocol.Tls.Handshake.HandshakeMessage.Process () 
[0x00000]
in &lt;filename unknown&gt;:0
  at (wrapper remoting-invoke-with-check) 
Mono.Security.Protocol.Tls.Handshake.H
andshakeMessage:Process ()
  at 
Mono.Security.Protocol.Tls.ClientRecordProtocol.ProcessHandshakeMessage (Mo
no.Security.Protocol.Tls.TlsStream handMsg) [0x00000] in &lt;filename 
unknown&gt;:0
  at 
Mono.Security.Protocol.Tls.RecordProtocol.InternalReceiveRecordCallback (IA
syncResult asyncResult) [0x00000] in &lt;filename unknown&gt;:0
  --- End of inner exception stack trace ---
  at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback 
(IAsyncResu
lt asyncResult) [0x00000] in &lt;filename unknown&gt;:0
================================================
Stack trace:
  at RabbitMQ.Client.ConnectionFactory.CreateConnection (Int32 
maxRedirects) [0x
00000] in &lt;filename unknown&gt;:0
  at RabbitMQ.Client.ConnectionFactory.CreateConnection () [0x00000] in 
&lt;filenam
e unknown&gt;:0
  at ProducerOne.Program.Main (System.String[] args) [0x00000] in &lt;filename 
unkn
own&gt;:0


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120802/111a41ba/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120802/111a41ba/attachment.htm</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021676.html">[rabbitmq-discuss] .NET ssl_upgrade_failure
</A></li>
	<LI>Next message: <A HREF="021678.html">[rabbitmq-discuss] .NET ssl_upgrade_failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21677">[ date ]</a>
              <a href="thread.html#21677">[ thread ]</a>
              <a href="subject.html#21677">[ subject ]</a>
              <a href="author.html#21677">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
