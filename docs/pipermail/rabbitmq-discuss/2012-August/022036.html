<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem transferring large message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20transferring%20large%20message&In-Reply-To=%3C5034C696.3050805%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022035.html">
   <LINK REL="Next"  HREF="022038.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem transferring large message</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Problem%20transferring%20large%20message&In-Reply-To=%3C5034C696.3050805%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Problem transferring large message">matthias at rabbitmq.com
       </A><BR>
    <I>Wed Aug 22 12:46:30 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022035.html">[rabbitmq-discuss] Problem transferring large message
</A></li>
        <LI>Next message: <A HREF="022038.html">[rabbitmq-discuss] Problem transferring large message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22036">[ date ]</a>
              <a href="thread.html#22036">[ thread ]</a>
              <a href="subject.html#22036">[ subject ]</a>
              <a href="author.html#22036">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Zabrane,

On 22/08/12 12:22, Zabrane Mickael wrote:
&gt;&gt;<i> On 22/08/12 10:34, Zabrane Mickael wrote:
</I>&gt;&gt;&gt;<i> I asked this question long time ago and the idea was to break our
</I>&gt;&gt;&gt;<i> big messages (~50Mb) in smaller ones (100Kb). Everything was fine
</I>&gt;&gt;&gt;<i> after that with the default settings !!!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Fragmenting the message is fine, but the broker does not force you
</I>&gt;&gt;<i> to do this.
</I>&gt;<i>
</I>&gt;<i> You sure about stability? Sending 50Mb at high rate makes RabbitMQ
</I>&gt;<i> very unhappy (lot of crashes and messages lost).
</I>
I have just tested twenty producers sending 50Mb messages to Rabbit as
fast as they can. The combined rate was ~30Hz. And that's on a fairly 
modest machine. There were some long pauses when messages were getting 
paged to disk, and memory peaked at about 80% (so twice the configured 
threshold), but that's expected. No crashes.

With smaller messages the performance profile will be smoother, i.e. the 
pauses will be shorter and memory peaks will be lower. But there are 
downsides to fragmenting messages aside from the extra code involved...

&gt;<i> That's what we can't afford to have. RAM is limited and we had to
</I>&gt;<i> deal with millions of very big messages.
</I>
When you say 'deal with millions', what do you mean? That your rabbit 
needs to hold (in its queues) millions of 50Mb messages? If you fragment 
messages at 100k that would translate to 500 million messages. You'd 
need a fair amount of RAM for that since each message has some fixed 
memory footprint (in the small hundreds of bytes, iirc) even when paged 
to disk.

Regards,

Matthias.
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022035.html">[rabbitmq-discuss] Problem transferring large message
</A></li>
	<LI>Next message: <A HREF="022038.html">[rabbitmq-discuss] Problem transferring large message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22036">[ date ]</a>
              <a href="thread.html#22036">[ thread ]</a>
              <a href="subject.html#22036">[ subject ]</a>
              <a href="author.html#22036">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
