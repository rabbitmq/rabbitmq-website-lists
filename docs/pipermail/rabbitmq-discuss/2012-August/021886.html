<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel stops receiving acks from cluster
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stops%20receiving%20acks%20from%20cluster&In-Reply-To=%3C87zk5wnvgy.wl%25francesco%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021857.html">
   <LINK REL="Next"  HREF="021887.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel stops receiving acks from cluster</H1>
    <B>Francesco Mazzoli</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stops%20receiving%20acks%20from%20cluster&In-Reply-To=%3C87zk5wnvgy.wl%25francesco%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Shovel stops receiving acks from cluster">francesco at rabbitmq.com
       </A><BR>
    <I>Wed Aug 15 14:19:41 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021857.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
        <LI>Next message: <A HREF="021887.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21886">[ date ]</a>
              <a href="thread.html#21886">[ thread ]</a>
              <a href="subject.html#21886">[ subject ]</a>
              <a href="author.html#21886">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jon,

At Tue, 14 Aug 2012 12:27:26 +0000,
Jon Bergli Heier wrote:
&gt;<i> I have a cluster consisting of two nodes, and brokers shoveling messages to
</I>&gt;<i> the cluster using the shovel plugin. When testing failover with the shovel
</I>&gt;<i> plugins (by stopping the RabbitMQ nodes) I often see that when starting a node
</I>&gt;<i> after stopping it causes the shovel plugin to stop receiving acks for
</I>&gt;<i> messages. I have prefetch_count set to 1000 in the shovel config, and I see
</I>&gt;<i> that &quot;unacked&quot; in the management interface for the queue rises to 1000 and
</I>&gt;<i> sits there, with &quot;ready&quot; steadily increasing.  The connection seems to be
</I>&gt;<i> alive as I can see (via tcpdump) that there are heartbeats being sent.  All
</I>&gt;<i> RabbitMQ servers are 2.8.5 on Erlang R14A. This only seems to happen with
</I>&gt;<i> setting ack_mode set to on_confirm. The queues on the cluster are mirrored
</I>&gt;<i> using x-ha-policy: all.
</I>
Could you post more details about your shovel config and your HA cluster?  In
particular, how do you handle failover?  Do you have the cluster nodes all as
sources in the shovel config?

--
Francesco * Often in error, never in doubt
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021857.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
	<LI>Next message: <A HREF="021887.html">[rabbitmq-discuss] Shovel stops receiving acks from cluster
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21886">[ date ]</a>
              <a href="thread.html#21886">[ thread ]</a>
              <a href="subject.html#21886">[ subject ]</a>
              <a href="author.html#21886">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
