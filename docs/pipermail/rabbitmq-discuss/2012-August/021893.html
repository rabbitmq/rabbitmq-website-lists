<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Shovel stuck?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stuck%3F&In-Reply-To=%3C20CB3CC89D650B419E5909B1CAAE57275A250138%40vmexchange02.seegrid.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021878.html">
   <LINK REL="Next"  HREF="021896.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Shovel stuck?</H1>
    <B>Benjamin Ballard</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Shovel%20stuck%3F&In-Reply-To=%3C20CB3CC89D650B419E5909B1CAAE57275A250138%40vmexchange02.seegrid.local%3E"
       TITLE="[rabbitmq-discuss] Shovel stuck?">bballard at seegrid.com
       </A><BR>
    <I>Wed Aug 15 15:06:56 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="021878.html">[rabbitmq-discuss] Shovel stuck?
</A></li>
        <LI>Next message: <A HREF="021896.html">[rabbitmq-discuss] Shovel stuck?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21893">[ date ]</a>
              <a href="thread.html#21893">[ thread ]</a>
              <a href="subject.html#21893">[ subject ]</a>
              <a href="author.html#21893">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I have been seeing similar issues to Alex. I also have a non reliable network that is used to shovel data between two rabbit nodes.  I also see my shovels go down in a terminated state and then never come up again.  My config shovel file has declarations in it to create the exchanges on the remote node.  However sometimes I get the error shown by Alex, and sometimes the rabbit shovel terminates when declaring the exchange (even though it was just connected to that exchange and the connection was working).  It also seems to happen much more frequently when the heartbeat time is set smaller, in the environment that the nodes are working in a 1 second heart beat causes a problem in under 30 min, but moving the heart beat to 5 seconds causes the issue to happen about once a day (Probably environment (non reliable network) specific).  Based on this it would seem to me that that there might be network problems during the starting phase of the shovel (after a disconnect due to heart beat), which cause declarations to fail and the shovel to terminate since having a shovel continuously reconnect with a failing declarations would just cause an infinite loop.  The data (config, shovel status and sasl logs) for these is in <A HREF="https://gist.github.com/3360344">https://gist.github.com/3360344</A> . Since i can detect this failure is there anyway to restart the shovel without restarting rabbit?  Or is there a config option that i am missing to have rabbit shovels to attempt to reconnect even if there is a failure during the starting phase of a rabbit shovel. Could i just detect the shovel failure and then create a new shovel when the first crashes out without restarting all of rabbit?

Thank you,

Ben Ballard
________________________________________
From: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss-bounces at lists.rabbitmq.com</A> [rabbitmq-discu 

<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">ss-bounces at lists.rabbitmq.com</A>] on behalf of Emile Joubert [<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">emile at rabbitmq.com</A>]
Sent: Wednesday, August 15, 2012 6:26 AM
To: Discussions about RabbitMQ
Subject: Re: [rabbitmq-discuss] Shovel stuck?

Hi,

On 14/08/12 21:29, Alex Zepeda wrote:
&gt;<i> 1.) The logging is exceedingly verbose.  I've set
</I>&gt;<i> {log_levels, [{connection, none}]}, but shovel still dumps a bunch of info in
</I>&gt;<i> the SASL log.  Are there any tunables to turn this down, or would that require
</I>&gt;<i> recompiling shovel?
</I>
There are no other tunables, but it should be possible to rotate and
archive old logs regularly. The only other option is to turn logging off
completely in Erlang, something we don't recommend.

&gt;<i> 2.) Occasionally the shovel gets wedged.  Initially it was from running into
</I>&gt;<i> the free disk space limit, but occasionally I'll run into a situation where
</I>&gt;<i> the shovel just terminates for no good reason (stop_app; start_app seems to
</I>&gt;<i> resolve the issue).  Here's the error I'm seeing:
</I>
Are there any log entries in the regular or the sasl log that might help
to explain this? How long after starting a shovel does this happen? Can
you reliably reproduce the problem?


-Emile

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021878.html">[rabbitmq-discuss] Shovel stuck?
</A></li>
	<LI>Next message: <A HREF="021896.html">[rabbitmq-discuss] Shovel stuck?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21893">[ date ]</a>
              <a href="thread.html#21893">[ thread ]</a>
              <a href="subject.html#21893">[ subject ]</a>
              <a href="author.html#21893">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
