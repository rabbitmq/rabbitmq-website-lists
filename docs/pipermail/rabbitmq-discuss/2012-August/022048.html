<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Exchange/Federation problems (unknown exchange type 'x-federation-upstream') and inability to connect to a broker after moving from R13B03 to R15B01
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange/Federation%20problems%20%28unknown%0A%20exchange%20type%20%27x-federation-upstream%27%29%20and%20inability%20to%20connect%20to%20a%20broker%0A%20after%20moving%20from%20R13B03%20to%20R15B01&In-Reply-To=%3C5034E7D5.4050606%40rabbitmq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022027.html">
   <LINK REL="Next"  HREF="022033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Exchange/Federation problems (unknown exchange type 'x-federation-upstream') and inability to connect to a broker after moving from R13B03 to R15B01</H1>
    <B>Simon MacMullen</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Exchange/Federation%20problems%20%28unknown%0A%20exchange%20type%20%27x-federation-upstream%27%29%20and%20inability%20to%20connect%20to%20a%20broker%0A%20after%20moving%20from%20R13B03%20to%20R15B01&In-Reply-To=%3C5034E7D5.4050606%40rabbitmq.com%3E"
       TITLE="[rabbitmq-discuss] Exchange/Federation problems (unknown exchange type 'x-federation-upstream') and inability to connect to a broker after moving from R13B03 to R15B01">simon at rabbitmq.com
       </A><BR>
    <I>Wed Aug 22 15:08:21 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022027.html">[rabbitmq-discuss] Exchange/Federation problems (unknown exchange type 'x-federation-upstream') and inability to connect to a broker after moving from R13B03 to R15B01
</A></li>
        <LI>Next message: <A HREF="022033.html">[rabbitmq-discuss] RabbitMQ Aliveness Test vs Monitoring RabbitMQ Process
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22048">[ date ]</a>
              <a href="thread.html#22048">[ thread ]</a>
              <a href="subject.html#22048">[ subject ]</a>
              <a href="author.html#22048">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/08/12 01:33, Matt Pietrek wrote:
&gt;<i> I've ran into something odd. Previously, using RabbitMQ 2.8.5 and R13B03
</I>&gt;<i> (the default Erlang for Ubunto 10.04) I had three brokers (mq1, mq2,
</I>&gt;<i> mq3) in a symmetric exchange configuration (e.g, mq1 was the upstream
</I>&gt;<i> for mq2/mq3, and vice-versa.)
</I>
So specifically you have mq2 &lt;---&gt; mq1 &lt;---&gt; mq3; i.e. mq2 and mq3 are 
not connected by federation?

&gt;<i> Everything worked groovy and I could connect to all the brokers, I could
</I>&gt;<i> pump messages through my defined  topic exchange ('skytap') between
</I>&gt;<i> federated brokers, and so forth.
</I>&gt;<i>
</I>&gt;<i> After upgrading my Erlang version to R15B01, brokers mq2 and mq3 start
</I>&gt;<i> fine, work as expected and I see my 'skytap' exchange on them. However,
</I>&gt;<i> mq1 mostly starts up (I see lots of mnesia spew), but it never accepts
</I>&gt;<i> connections, I can't log into the management console. The beam.smp
</I>&gt;<i> process is running on mq3, however.
</I>
Do you mean mq1?

&gt;<i> My config file for mq1 looks like this:
</I>
&lt;snip&gt;

&gt;<i> The <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbit at mq1.log</A> file has this:
</I>
&gt;<i> =WARNING REPORT==== 21-Aug-2012::17:09:23 ===
</I>&gt;<i> Could not find exchange type x-federation.
</I>
This is very suspicious - are you absolutely sure the federation plugin 
is enabled?

Actually, you also say you can't log into the management console - have 
you ended up disabling (somehow) all plugins on that broker? The logs 
show no since of management even attempting to start.

(You say &quot;inability to connect to a broker&quot; - I assume you mean to the 
management console since the log shows AMQP connections being accepted.)

What does /var/log/rabbitmq/startup_log show under &quot;Activating RabbitMQ 
plugins&quot;? What does &quot;rabbitmq-plugins list&quot; show?

Cheers, Simon

-- 
Simon MacMullen
RabbitMQ, VMware
</PRE>
















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022027.html">[rabbitmq-discuss] Exchange/Federation problems (unknown exchange type 'x-federation-upstream') and inability to connect to a broker after moving from R13B03 to R15B01
</A></li>
	<LI>Next message: <A HREF="022033.html">[rabbitmq-discuss] RabbitMQ Aliveness Test vs Monitoring RabbitMQ Process
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22048">[ date ]</a>
              <a href="thread.html#22048">[ thread ]</a>
              <a href="subject.html#22048">[ subject ]</a>
              <a href="author.html#22048">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
