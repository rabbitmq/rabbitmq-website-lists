<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Intermittent Problem - 2.8.5 java client	hangs on declare exchange
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Intermittent%20Problem%20-%202.8.5%20java%20client%0A%09hangs%20on%20declare%20exchange&In-Reply-To=%3C1345819447.6797775%40apps.rackspace.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022089.html">
   <LINK REL="Next"  HREF="022093.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Intermittent Problem - 2.8.5 java client	hangs on declare exchange</H1>
    <B>m.luchak at smartasking.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=Re%3A%20%5Brabbitmq-discuss%5D%20Intermittent%20Problem%20-%202.8.5%20java%20client%0A%09hangs%20on%20declare%20exchange&In-Reply-To=%3C1345819447.6797775%40apps.rackspace.com%3E"
       TITLE="[rabbitmq-discuss] Intermittent Problem - 2.8.5 java client	hangs on declare exchange">m.luchak at smartasking.com
       </A><BR>
    <I>Fri Aug 24 15:44:07 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="022089.html">[rabbitmq-discuss] Intermittent Problem - 2.8.5 java client	hangs on declare exchange
</A></li>
        <LI>Next message: <A HREF="022093.html">[rabbitmq-discuss] Intermittent Problem - 2.8.5 java client hangs on declare exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22092">[ date ]</a>
              <a href="thread.html#22092">[ thread ]</a>
              <a href="subject.html#22092">[ subject ]</a>
              <a href="author.html#22092">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Thanks Steve,
 
Unfortunately this is an intermittent bug AND it is (we think) occuring only over a 3G connection on Android.  We have ACRA running for logs but the app doesn't crash - just hangs - so ACRA doesn't kick in.
 
We also have a background consumer thread running on the device which  still receives messages when the foreground thread hangs.
 
But, is there really no timeout in the java client that will at least fail rather than hang? There is, I believe, a timeout on the server so... what in theory would happen if the server closed the AMQP connection {inet_error,etimedout} and the client was connecting?  In theory would this cause the client to hang?
 
 
thanks,
Matthew
 
 
 
-----Original Message-----
From: &quot;Steve Powell&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">steve at rabbitmq.com</A>&gt;
Sent: Friday, August 24, 2012 10:10am
To: <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">m.luchak at smartasking.com</A>
Cc: &quot;Discussions about RabbitMQ&quot; &lt;<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
Subject: Re: [rabbitmq-discuss] Intermittent Problem - 2.8.5 java client hangs on declare exchange


Hi Matthew,

It is hard to debug this without some Java information. Can you take a
jstack dump of the JVM BEFORE you kill it and AFTER it hangs? This will
give us some idea of what threads are waiting for what.
It is hard to see how this could happen if the connection has been
closed by the server, though it is not clear if the ERROR REPORT you
give is dated/timed after the Java Client has hung for a bit, or happens
before and CAUSES the hang. Can you determine which from the time of the
log entry?
We will endeavour to help.









All (aka Steve Powell---a happy bunny)

----------yet more definitions from the SPD----------corrugate (n.) T.V. soap scandal.
 olympic (n.) A camp road-digger.
jamboree (n.) A conserve made from French cheese.


On 24 Aug 2012, at 14:20, [mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">m.luchak at smartasking.com</A>] <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">m.luchak at smartasking.com</A> wrote:

Hi All,
 
We have a very annoying intermittent bug where our java client hangs when declaring an exchange.  We couldn't find a timeout or wait in the channel class... Is there a way to set/get a session timeout?
 
 
 - No firewalls or load balancers
 - Very low CPU and memory usage
 
 
=ERROR REPORT==== 24-Aug-2012::12:40:17 ===
closing AMQP connection &lt;0.22988.7&gt; (XXXXXXXX:28335 -&gt; XXXXXX:5672):
{inet_error,etimedout}
 
 
RabbitMQ Status:
 
 
[{pid,9764},
{running_applications,
[{rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;2.8.5&quot;},
{rabbitmq_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;2.8.5&quot;},
{rabbitmq_stomp,&quot;Embedded Rabbit Stomp Adapter&quot;,&quot;2.8.5&quot;},
{rabbit,&quot;RabbitMQ&quot;,&quot;2.8.5&quot;},
{mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.4.17&quot;},
{os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.2.5&quot;},
{rabbitmq_mochiweb,&quot;RabbitMQ Mochiweb Embedding&quot;,&quot;2.8.5&quot;},
{webmachine,&quot;webmachine&quot;,&quot;1.9.1-rmq2.8.5-git52e62bc&quot;},
{mochiweb,&quot;MochiMedia Web Server&quot;,&quot;2.3.1-rmq2.8.5-gitd541e9a&quot;},
{inets,&quot;INETS  CXC 138 49&quot;,&quot;5.5.2&quot;},
{xmerl,&quot;XML parser&quot;,&quot;1.2.8&quot;},
{sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.1.9.3&quot;},
{amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;2.8.5&quot;},
{stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.17.3&quot;},
{kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.14.3&quot;}]},
{os,{unix,linux}},
{erlang_version,
&quot;Erlang R14B02 (erts-5.8.3) [source] [64-bit] [rq:1] [async-threads:30] [kernel-poll:true]\n&quot;},
{memory,
[{total,41330968},
{processes,17077520},
{processes_used,16335960},
{system,24253448},
{atom,1537521},
{atom_used,1523741},
{binary,120088},
{code,17080343},
{ets,4172512}]},
{vm_memory_high_watermark,0.39999999935564245},
{vm_memory_limit,248309350},
{disk_free_limit,1000000000},
{disk_free,5325369344},
{file_descriptors,
[{total_limit,924},
{total_used,35},
{sockets_limit,829},
{sockets_used,15}]},
{processes,[{limit,1048576},{used,335}]},
{run_queue,0},
{uptime,1815593}]
 
 
thanks,
 
Matthew
 
 


 

_______________________________________________
rabbitmq-discuss mailing list
[mailto:<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>] <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
[<A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss]">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss]</A> <A HREF="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120824/d084856d/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20120824/d084856d/attachment.htm</A>&gt;
</PRE>






















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022089.html">[rabbitmq-discuss] Intermittent Problem - 2.8.5 java client	hangs on declare exchange
</A></li>
	<LI>Next message: <A HREF="022093.html">[rabbitmq-discuss] Intermittent Problem - 2.8.5 java client hangs on declare exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22092">[ date ]</a>
              <a href="thread.html#22092">[ thread ]</a>
              <a href="subject.html#22092">[ subject ]</a>
              <a href="author.html#22092">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
