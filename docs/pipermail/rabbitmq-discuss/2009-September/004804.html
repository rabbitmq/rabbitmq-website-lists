<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Performance degrades with increasing	queue	depth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Performance%20degrades%20with%20increasing%0A%09queue%09depth&In-Reply-To=CECAA69D-6449-4336-9B03-C172D769F975%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004803.html">
   <LINK REL="Next"  HREF="004821.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Performance degrades with increasing	queue	depth</H1>
    <B>Aisha Fenton</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Performance%20degrades%20with%20increasing%0A%09queue%09depth&In-Reply-To=CECAA69D-6449-4336-9B03-C172D769F975%40gmail.com"
       TITLE="[rabbitmq-discuss] Performance degrades with increasing	queue	depth">aisha.fenton at gmail.com
       </A><BR>
    <I>Mon Sep  7 22:44:11 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004803.html">[rabbitmq-discuss] Performance degrades with increasing	queue	depth
</A></li>
        <LI>Next message: <A HREF="004821.html">[rabbitmq-discuss] Performance degrades with increasing queue	depth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4804">[ date ]</a>
              <a href="thread.html#4804">[ thread ]</a>
              <a href="subject.html#4804">[ subject ]</a>
              <a href="author.html#4804">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry didn't answer your other questions.

&gt;<i> Is your test machine paging or swapping?
</I>
I don't believe so. I see the issue when even though I have Gigs of  
free memory. Unless there is some configuration change that I need to  
make to RabbitMQ for it to take advantage of that memory?

&gt;<i> What is the 'top' output for your process and for rabbit at various  
</I>&gt;<i> points of the run cycle? Is it lower or higher when you are getting  
</I>&gt;<i> 300 msg/s than when you are getting 80 msg/s?
</I>
The CPU increases from 10% to 40%. So it does get busier as mps drop  
off. But the machine is still nowhere near CPU bound.

&gt;<i> What is your subscriber doing with the data it receives? If you make  
</I>&gt;<i> that process a &quot;no op&quot; how many messages per second can you handle?
</I>
In my test app, just counting how many mps. I assume a &quot;no op&quot; means  
doing nothing but counting the mps, like my test script?

&gt;<i> Does it ever drop off related to queue size?
</I>

The mps reduces as the queue depth increases.

&gt;<i>  Why are you &quot;popping&quot; messages from the queue isn't of having them  
</I>&gt;<i> pushed automatically?
</I>
The library I'm using (<A HREF="http://github.com/celldee/bunny/tree/master">http://github.com/celldee/bunny/tree/master</A>) is  
synchronous only. I'm considering switching to (<A HREF="http://github.com/tmm1/amqp/tree/master">http://github.com/tmm1/amqp/tree/master</A> 
) which is async and uses libevent. However, I've read that there are  
problems with msg acknowledges in apps that use libevent, because the  
OS can buffer the ack responses. And although I'm not using ack yet, I  
want to in my production system.

  
     


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004803.html">[rabbitmq-discuss] Performance degrades with increasing	queue	depth
</A></li>
	<LI>Next message: <A HREF="004821.html">[rabbitmq-discuss] Performance degrades with increasing queue	depth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4804">[ date ]</a>
              <a href="thread.html#4804">[ thread ]</a>
              <a href="subject.html#4804">[ subject ]</a>
              <a href="author.html#4804">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
