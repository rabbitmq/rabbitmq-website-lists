<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] File changes from 1.6.0 to 1.7.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20File%20changes%20from%201.6.0%20to%201.7.0&In-Reply-To=84fb38e30909290747g522cc683sae37b5061c04dd56%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004976.html">
   <LINK REL="Next"  HREF="004980.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] File changes from 1.6.0 to 1.7.0</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20File%20changes%20from%201.6.0%20to%201.7.0&In-Reply-To=84fb38e30909290747g522cc683sae37b5061c04dd56%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] File changes from 1.6.0 to 1.7.0">matthew at lshift.net
       </A><BR>
    <I>Tue Sep 29 16:38:23 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004976.html">[rabbitmq-discuss] File changes from 1.6.0 to 1.7.0
</A></li>
        <LI>Next message: <A HREF="004980.html">[rabbitmq-discuss] File changes from 1.6.0 to 1.7.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4978">[ date ]</a>
              <a href="thread.html#4978">[ thread ]</a>
              <a href="subject.html#4978">[ subject ]</a>
              <a href="author.html#4978">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Sep 29, 2009 at 09:47:55AM -0500, tsuraan wrote:
&gt;<i> I guess that still answers my question well enough; I was assuming the
</I>&gt;<i> new persister was part of 1.7, so whenever the new persister comes
</I>&gt;<i> out, I'll have to do that.  Why was it pushed back?  I thought it had
</I>&gt;<i> passed QA a few months ago.
</I>
During the process of going through QA, we realised that mnesia is too
flawed for us to use it as part of the persister. We were never going
to store messages directly in mnesia, merely accountancy information.
However, when operating in &quot;disc_copies&quot;, mnesia keeps the entire table
in RAM, and periodically writes the table out to disk. Unfortunately,
it just writes the entire table out to disk, which means that for a
large table with 99% static entries, but 1% rapidly changing entries,
it will rewrite vast amounts of data unnecessarily, whenever it decides
to write out the table. The other problem is that when running in
&quot;disc_only_copies&quot;, the entire table is disk only, using dets. Dets has
an upper limit of 2GB of data, and performs very very badly - I've
never seen it push a disk past about 10MB/s. These problems together
have meant that in order to achieve the goals of zero per message RAM
cost, and a sensible bound on the number of times data is rewritten, we
have decided to move away from using mnesia for the persister.

Unfortunately, these issues were only realised fairly late in the day,
hence the delay whilst we do some redesigning and recoding.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004976.html">[rabbitmq-discuss] File changes from 1.6.0 to 1.7.0
</A></li>
	<LI>Next message: <A HREF="004980.html">[rabbitmq-discuss] File changes from 1.6.0 to 1.7.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4978">[ date ]</a>
              <a href="thread.html#4978">[ thread ]</a>
              <a href="subject.html#4978">[ subject ]</a>
              <a href="author.html#4978">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
