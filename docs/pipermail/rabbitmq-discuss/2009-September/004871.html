<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] RabbitMQ with Socket Server
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20with%20Socket%20Server&In-Reply-To=fb0723210909151719k60e16a76g32ea8b6dadd1da3c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004870.html">
   <LINK REL="Next"  HREF="004898.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] RabbitMQ with Socket Server</H1>
    <B>Chuck Remes</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20RabbitMQ%20with%20Socket%20Server&In-Reply-To=fb0723210909151719k60e16a76g32ea8b6dadd1da3c%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] RabbitMQ with Socket Server">cremes.devlist at mac.com
       </A><BR>
    <I>Wed Sep 16 03:27:49 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004870.html">[rabbitmq-discuss] RabbitMQ with Socket Server
</A></li>
        <LI>Next message: <A HREF="004898.html">[rabbitmq-discuss] RabbitMQ with Socket Server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4871">[ date ]</a>
              <a href="thread.html#4871">[ thread ]</a>
              <a href="subject.html#4871">[ subject ]</a>
              <a href="author.html#4871">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Sep 15, 2009, at 7:19 PM, Alex Gentle wrote:

&gt;<i> iPhone app -&gt; socket server -&gt; RabbitMQ server
</I>
Great, this is very helpful.

&gt;<i> iPhone app has some social networking features in addition to the  
</I>&gt;<i> chat component. Think of it like mini-facebook inside iPhone. When a  
</I>&gt;<i> user types a message inside chat window of iPhone app, the message  
</I>&gt;<i> travels to Socket server which directs the message depending on what  
</I>&gt;<i> is on the message header. If the message header says &quot;this message  
</I>&gt;<i> is for RabbitMQ&quot;, socket server will route to RabbitMQ. When a  
</I>&gt;<i> message comes from RabbitMQ to socket server, it should have message  
</I>&gt;<i> header that says &quot;Route this to xxxxxx user&quot;. Then, socket server  
</I>&gt;<i> will route the message to appropriate user(s).
</I>&gt;<i>
</I>&gt;<i> It all looks good, but it doesn't work. Because I don't know how to  
</I>&gt;<i> make a call to RabbitMQ using the message from socket server and how  
</I>&gt;<i> to pass the message from RabbitMQ to socket server in binary format.
</I>
Ah, this is good.

You need to declare an exchange (of type direct, fanout or topic)  
which acts as the mailbox for sending the message. Once you have  
parsed the message from socket server and determined it should go to  
rabbit, you publish the message to it. Here's some ruby code  
(commented).

def publish_message_to_rabbit(message)
   # declare the exchange
   exchange = MQ.direct 'mailbox'

   # send the message
   exchange.publish(message, :key =&gt; 'some.routing.key')
end

Next, you need to have a client somewhere that is listening for  
messages. You need to allocate a queue to receive the message and  
subscribe to the routing key. Again, some ruby code.

def listen_for_rabbit_messages
   # redeclare the exchange; idempotent operation
   exchange = MQ.direct 'mailbox'

   # declare a queue to receive the messages
   queue = MQ.queue 'mailslot'

   # bind the queue to the exchange and match incoming messages against
   # the specified routing key
   queue.bind(exchange, :key =&gt; 'some.routing.key').subscribe do | 
message|
     # this block is called each time a message is received
     # do your message processing here
   end
end

Does this help? I highly recommend you take a look through the sample  
code and come back with specific questions.

cr



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004870.html">[rabbitmq-discuss] RabbitMQ with Socket Server
</A></li>
	<LI>Next message: <A HREF="004898.html">[rabbitmq-discuss] RabbitMQ with Socket Server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4871">[ date ]</a>
              <a href="thread.html#4871">[ thread ]</a>
              <a href="subject.html#4871">[ subject ]</a>
              <a href="author.html#4871">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
