<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Performance degrades with increasing queue depth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Performance%20degrades%20with%20increasing%20queue%20depth&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004785.html">
   <LINK REL="Next"  HREF="004787.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Performance degrades with increasing queue depth</H1>
    <B>aisha fenton</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Performance%20degrades%20with%20increasing%20queue%20depth&In-Reply-To="
       TITLE="[rabbitmq-discuss] Performance degrades with increasing queue depth">aisha.fenton at gmail.com
       </A><BR>
    <I>Mon Sep  7 07:07:09 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004785.html">[rabbitmq-discuss] java client library
</A></li>
        <LI>Next message: <A HREF="004787.html">[rabbitmq-discuss] Performance degrades with increasing queue depth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4786">[ date ]</a>
              <a href="thread.html#4786">[ thread ]</a>
              <a href="subject.html#4786">[ subject ]</a>
              <a href="author.html#4786">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I'm sure I'm doing something wrong since I can't find reference to
this anywhere else. What I'm seeing is that the performance of
draining a queue gets slower as the queue size increases.

I'm aware of the issue in RabbitMQ 1.6 that means that when it runs
out of physical memory that it's performance degrades because it
starts swapping out. But I'm not anywhere close to running out of
memory yet, and the degradation starts almost immediately and
increases linearly as the queue depth grows.

I am publishing 500mps to an exchange. Each message is about 1KB. I
have a single fanout queue bound to the exchange. A single consumer is
popping messages off the queue.

When the queue is less than 20,000 messages I can pop 300mps off the
queue. When the queue is 200,000 messages the performance drop to
40-80mps.

I'm running RabbitMQ 1.6.0. And nether rabbitmq, the consumer, or the
publisher are using more than 40% CPU.

I assume I shouldn't be seeing this? Any help much appreciated.

Aisha


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004785.html">[rabbitmq-discuss] java client library
</A></li>
	<LI>Next message: <A HREF="004787.html">[rabbitmq-discuss] Performance degrades with increasing queue depth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4786">[ date ]</a>
              <a href="thread.html#4786">[ thread ]</a>
              <a href="subject.html#4786">[ subject ]</a>
              <a href="author.html#4786">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
