<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Problem opening an SSL connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Problem%20opening%20an%20SSL%20connection&In-Reply-To=92BFC65A-67A1-47F2-97E0-BE072BFABF3E%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004944.html">
   <LINK REL="Next"  HREF="004952.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Problem opening an SSL connection</H1>
    <B>Matthew Sackman</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Problem%20opening%20an%20SSL%20connection&In-Reply-To=92BFC65A-67A1-47F2-97E0-BE072BFABF3E%40gmail.com"
       TITLE="[rabbitmq-discuss] Problem opening an SSL connection">matthew at lshift.net
       </A><BR>
    <I>Wed Sep 23 16:50:12 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004944.html">[rabbitmq-discuss] Problem opening an SSL connection
</A></li>
        <LI>Next message: <A HREF="004952.html">[rabbitmq-discuss] Problem opening an SSL connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4945">[ date ]</a>
              <a href="thread.html#4945">[ thread ]</a>
              <a href="subject.html#4945">[ subject ]</a>
              <a href="author.html#4945">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Chris,

On Wed, Sep 23, 2009 at 04:32:13PM +0100, Chris Duncan wrote:
&gt;<i> I wanted to get the simplest case running which is to connect without  
</I>&gt;<i> using any certificates. I decided to try to follow the instructions  
</I>&gt;<i> in the wiki - <A HREF="https://dev.rabbitmq.com/wiki/SslSupport">https://dev.rabbitmq.com/wiki/SslSupport</A> - and so  
</I>&gt;<i> created a rabbit.conf file with similar contents to the example (only  
</I>&gt;<i> the paths differ).
</I>
Please note that the instructions on that wiki page are not entirely
correct and indeed we are going to remove it. The SSL instructions have
been rewritten and will appear on the main website (not on dev.rabbitmq)
when v1.7 gets released.

&gt;<i> It contains -
</I>&gt;<i> 
</I>&gt;<i> RABBITMQ_SERVER_START_ARGS=&quot;-rabbit ssl_listeners [{\&quot;0.0.0.0\&quot;, 
</I>&gt;<i> 5671}] -rabbit ssl_options
</I>&gt;<i> [{cacertfile,\&quot;/path/to/testca/cacert.pem\&quot;},{certfile,\&quot;/path/to/ 
</I>&gt;<i> server/cert.pem\&quot;},
</I>&gt;<i>   {keyfile,\&quot;/path/to/server/key.pem\&quot;},{verify,verify_peer}, 
</I>&gt;<i> {fail_if_no_peer_cert,false}]&quot;
</I>&gt;<i> 
</I>&gt;<i> When I try to connect I get a 'Connection reset by peer' error and  
</I>&gt;<i> these entries in rabbit.log -
</I>&gt;<i> 
</I>&gt;<i> =INFO REPORT==== 23-Sep-2009::09:22:24 ===
</I>&gt;<i> accepted TCP connection on 0.0.0.0:5671 from 127.0.0.1:51689
</I>&gt;<i> 
</I>&gt;<i> =ERROR REPORT==== 23-Sep-2009::09:22:24 ===
</I>&gt;<i> failed to upgrade TCP connection from 127.0.0.1:51689 to SSL:
</I>&gt;<i> {eoptions,{cacertfile,[]}}
</I>
I think that it's not happy with your cacert file. That line in your
rabbit.conf file must be one single line. Also make sure there are no
spaces anywhere between the square brackets.

If you can't make any progress, can you send in your cacert.pem,
cert.pem and key.pem files (obviously, fakes, not the real thing!), and
we'll see if we can make it work.

Matthew


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004944.html">[rabbitmq-discuss] Problem opening an SSL connection
</A></li>
	<LI>Next message: <A HREF="004952.html">[rabbitmq-discuss] Problem opening an SSL connection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4945">[ date ]</a>
              <a href="thread.html#4945">[ thread ]</a>
              <a href="subject.html#4945">[ subject ]</a>
              <a href="author.html#4945">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
