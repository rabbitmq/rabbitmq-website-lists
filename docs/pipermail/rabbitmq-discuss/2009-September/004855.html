<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Performance degrades with increasing queue	depth
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Performance%20degrades%20with%20increasing%20queue%0A%09depth&In-Reply-To=4AA5E501.9000603%40lshift.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004814.html">
   <LINK REL="Next"  HREF="004802.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Performance degrades with increasing queue	depth</H1>
    <B>majek04</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Performance%20degrades%20with%20increasing%20queue%0A%09depth&In-Reply-To=4AA5E501.9000603%40lshift.net"
       TITLE="[rabbitmq-discuss] Performance degrades with increasing queue	depth">majek04 at gmail.com
       </A><BR>
    <I>Mon Sep 14 11:57:54 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004814.html">[rabbitmq-discuss] Performance degrades with increasing queue	depth
</A></li>
        <LI>Next message: <A HREF="004802.html">[rabbitmq-discuss] Performance degrades with increasing queue	depth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4855">[ date ]</a>
              <a href="thread.html#4855">[ thread ]</a>
              <a href="subject.html#4855">[ subject ]</a>
              <a href="author.html#4855">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Sep 8, 2009 at 06:00, Matthias Radestock &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">matthias at lshift.net</A>&gt; wrote:
&gt;<i> I ran the tests and got the following results:
</I>&gt;<i>
</I>&gt;<i> - 20k messages: 500Hz, with beam.smp using 30% of the CPU
</I>&gt;<i>
</I>&gt;<i> - 200k messages: 300Hz, with beam.smp using 45% of the CPU - that kind
</I>&gt;<i> of slowdown is not totally unexpected and probably due to the increased
</I>&gt;<i> cost of gc and the nature of the queue data structure we are using,
</I>&gt;<i>
</I>&gt;<i> - 200k messages: 35Hz, with beam.smp using 95% of the CPU - yes, that's
</I>&gt;<i> right, the same test as the previous one but only 1/9th of the throughput!
</I>
I was able to reproduce this results. The slowdown was identified
in basic.get. The real cause is a bit mysterious, it looks like the issue
has something to do with Erlang garbage collection mechanism.

Hopefully, the problematic code was refactored during the work
on new persistor, so RabbitMQ 1.7 will not be affected.

Cheers.
  Marek Majkowski


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004814.html">[rabbitmq-discuss] Performance degrades with increasing queue	depth
</A></li>
	<LI>Next message: <A HREF="004802.html">[rabbitmq-discuss] Performance degrades with increasing queue	depth
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4855">[ date ]</a>
              <a href="thread.html#4855">[ thread ]</a>
              <a href="subject.html#4855">[ subject ]</a>
              <a href="author.html#4855">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
