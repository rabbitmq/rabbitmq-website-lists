<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Erlang has closed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Erlang%20has%20closed&In-Reply-To=84fb38e30909180751x5efb1376h2730c1c44bf10caa%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004906.html">
   <LINK REL="Next"  HREF="004909.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Erlang has closed</H1>
    <B>Matthias Radestock</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Erlang%20has%20closed&In-Reply-To=84fb38e30909180751x5efb1376h2730c1c44bf10caa%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Erlang has closed">matthias at lshift.net
       </A><BR>
    <I>Fri Sep 18 16:35:15 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004906.html">[rabbitmq-discuss] Erlang has closed
</A></li>
        <LI>Next message: <A HREF="004909.html">[rabbitmq-discuss] Erlang has closed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4908">[ date ]</a>
              <a href="thread.html#4908">[ thread ]</a>
              <a href="subject.html#4908">[ subject ]</a>
              <a href="author.html#4908">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tsuraan,

tsuraan wrote:
&gt;&gt;<i> I am not aware of any problem in that area that got fixed in those
</I>&gt;&gt;<i> releases. Have you got a reference?
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2009-July/004033.html">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2009-July/004033.html</A>
</I>&gt;<i> was my queue_disappeared issue.
</I>
We did fix some timeout related problems, as indicated in the above
thread. Queues weren't actually disappearing.

&gt;<i> It's a single machine, and all the queues are persistent.
</I>
Do you mean 'durable'?

&gt;<i> There is a place where queue_delete is called, but the queue is
</I>&gt;<i> re-created immediately afterwards (I saw something about queue.purge
</I>&gt;<i> the other day, but I haven't looked into it yet). If I do
</I>&gt;<i> queue_delete and then a queue_declare in a transaction, will that
</I>&gt;<i> guarantee that the queue doesn't disappear?
</I>
Transactions only span publishes and acks.

&gt;<i> It looks like right now, if a rabbit_amqqueue_process is terminated,
</I>&gt;<i> it removes that queue from mnesia (terminate function of
</I>&gt;<i> rabbit_amqqueue_process calls rabbit_amqqueue:internal_delete).
</I>&gt;<i> Looking at gen_server2, terminate seems to get called in basically any
</I>&gt;<i> case of a process getting an error while handling a call, a supervisor
</I>&gt;<i> dying, the process itself dying, I'm not sure what else.  Should all
</I>&gt;<i> those things cause the queue record to be removed from mnesia?
</I>
Any abnormal termination of a queue process should result in a sasl log
entry. Since you are not seeing such log entries it is unlikely that
abnormal queue termination is a problem.

As to whether we should remove the queue record when the queue process
terminates abnormally ... we couldn't just leave the record in place
since then there would be no way to ever create a queue with the same
name or get rid of the record. We could restart the queue process, but
that presents some interesting race conditions as well as masking a
potentially serious error from clients (even more than is usually the
case). It's on our todo list to look into this area though.


Regards,

Matthias.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004906.html">[rabbitmq-discuss] Erlang has closed
</A></li>
	<LI>Next message: <A HREF="004909.html">[rabbitmq-discuss] Erlang has closed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4908">[ date ]</a>
              <a href="thread.html#4908">[ thread ]</a>
              <a href="subject.html#4908">[ subject ]</a>
              <a href="author.html#4908">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
