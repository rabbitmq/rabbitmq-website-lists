<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [rabbitmq-discuss] Issue with .Net client Subscription
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Issue%20with%20.Net%20client%20Subscription&In-Reply-To=29598b610909171241w6a94acb1ycfc5ff3f4a7691aa%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004893.html">
   <LINK REL="Next"  HREF="004899.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[rabbitmq-discuss] Issue with .Net client Subscription</H1>
    <B>Deepak.Kumar1 at rbs.com</B> 
    <A HREF="mailto:rabbitmq-discuss%40lists.rabbitmq.com?Subject=%5Brabbitmq-discuss%5D%20Issue%20with%20.Net%20client%20Subscription&In-Reply-To=29598b610909171241w6a94acb1ycfc5ff3f4a7691aa%40mail.gmail.com"
       TITLE="[rabbitmq-discuss] Issue with .Net client Subscription">Deepak.Kumar1 at rbs.com
       </A><BR>
    <I>Fri Sep 18 01:30:46 BST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004893.html">[rabbitmq-discuss] Issue with .Net client Subscription
</A></li>
        <LI>Next message: <A HREF="004899.html">[rabbitmq-discuss] Issue with .Net client Subscription
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4897">[ date ]</a>
              <a href="thread.html#4897">[ thread ]</a>
              <a href="subject.html#4897">[ subject ]</a>
              <a href="author.html#4897">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Paul

Tried a few possible ways to create exchange and Bind2Q but didn't work so far, it seems to need some precise sequence which escapes me
here's the publishing code

string serverAndPort = &quot;localhost:5672&quot;;

IConnection conn1 = new ConnectionFactory().CreateConnection( serverAndPort  );
IModel ch = conn1.CreateModel();
string routingKey = &quot;STOCK.PRICES&quot;; //&quot;STOCK.PRICES.#&quot;;
string qn = &quot;myq&quot;, exch = &quot;nasdaq&quot;;
ch.ExchangeDeclare(exch, ExchangeType.Direct);
string finalName = chSendUpdate.QueueDeclare(qn, false,
                                   false, false, false,
                                   false, null);


ch.QueueBind(finalName, exch, routingKey, false, null);
ch.BasicPublish(string.Empty, &quot;STOCK.PRICES.&quot; + CUSIP, null, Encoding.UTF8.GetBytes(bodyText));

recv'ng code is

string routingKey = &quot;STOCK.PRICES.#&quot;;
using (IConnection conn = new ConnectionFactory().CreateConnection(&quot;localhost:5672&quot;)){
 using (IModel ch = conn.CreateModel()) {
  Subscription sub = new Subscription(ch, &quot;nasdaq&quot;, ExchangeType.Direct, routingKey);
  foreach (BasicDeliverEventArgs e in sub){
   Console.WriteLine(&quot;#2&gt; Exch({0}) Topic({1}):{2}&quot;, e.Exchange, e.RoutingKey, ASCIIEncoding.ASCII.GetString(e.Body));
   sub.Ack(e);
  }
                Console.WriteLine(&quot;Out of sub loop...&lt;ENTER&gt;&quot;);
  Console.ReadLine();
 }
}


Assuming it's my code and not something in the library, id' think that a magic combination/method call sequence is required in ch.QueueBind() to make it all work !

Thanks for your help
Deepak




________________________________
From: Paul Jones [mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">pauljones23 at gmail.com</A>]
Sent: Thursday, September 17, 2009 3:42 PM
To: Kumar, Deepak, GBM
Cc: <A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>
Subject: Re: [rabbitmq-discuss] Issue with .Net client Subscription

Hi Deepak,

Did you create a topic exchange? Wildcard routing keys in the form you're using require a topic exchange.

Paul.

On Thu, Sep 17, 2009 at 8:36 PM, &lt;<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Deepak.Kumar1 at rbs.com</A>&lt;mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">Deepak.Kumar1 at rbs.com</A>&gt;&gt; wrote:
Hello

Has anyone faced issues not getting messages when using catch-all subscription using the .Net Client library ?

The publishing code is below -

IConnection conn1 = new ConnectionFactory().CreateConnection( &quot;localhost:5672&quot;);
chSendUpdate = conn1.CreateModel();

...

chSendUpdate.BasicPublish(string.Empty, &quot;STOCK.PRICES.&quot; + CUSIP, null, Encoding.UTF8.GetBytes(bodyText));


The subscription code is
using (IConnection conn = new ConnectionFactory().CreateConnection(&quot;localhost:5672&quot;)){
   using (IModel ch = conn.CreateModel())    {
        Subscription sub = new Subscription(ch, &quot;STOCK.PRICES.#&quot;);
        foreach (BasicDeliverEventArgs e in sub)         {
            Console.WriteLine(&quot;Topic({0}):{1}&quot;, e.RoutingKey, ASCIIEncoding.ASCII.GetString(e.Body));
            sub.Ack(e);
        }
    }
  }
}


If the subscription RoutingKey is changed to specific like &quot;STOCK.PRICES.MSFT&quot; etc. then the messages are received fine so i'm guessing there's some flag/option that needs to bet setup or enabled

I've also tried the sample code in the .net user guide using QueueingBasicConsumer
but no success there either


Any ideas on what could be wrong ?
*****Please note that my email address may have changed. For all
future correspondence, please use this address*****


********************************************************************This
message (including any attachments) is confidential and/or
privileged. It is to be used by the intended recipients only. If
you have received it by mistake please notify the sender by return
e-mail and delete this message from your system. Any unauthorized
use or dissemination of this message in whole or in part is
strictly prohibited. Please note that e-mails are inherently
insecure and susceptible to change. The Royal Bank of Scotland
Group, plc (&quot;RBS&quot;) and its US subsidiaries, and affiliates and
subsidiary undertakings, including but not limited to, RBS plc New
York and Connecticut Branches, RBS Securities Inc., ABN AMRO Bank
N.V. New York and Chicago Branches and, ABN AMRO Incorporated,
Citizens Financial Group, Inc. and RBS Citizens, N.A., shall not be
liable for the improper or incomplete transmission of the
information contained in this communication or Attachment nor for
any delay in its receipt or damage to your system. RBS does not
guarantee that the integrity of this communication has been
maintained nor that this communication is free of viruses,
interceptions or interference. RBS and its subsidiaries and
affiliates do not guarantee the accuracy of any email or
attachment, that an email will be received or that RBS or its
affiliates and subsidiaries will respond to an email.

RBS makes no representations that any information contained in this
message (including any attachments) are appropriate for use in all
locations or that transactions, securities, products, instruments
or services discussed herein are available or appropriate for sale
or use in all jurisdictions, or by all investors or counterparties.
Those who utilize this information do so on their own initiative
and are responsible for compliance with applicable local laws or
regulations.********************************************************************

_______________________________________________
rabbitmq-discuss mailing list
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&lt;mailto:<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">rabbitmq-discuss at lists.rabbitmq.com</A>&gt;
<A HREF="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss</A>



*****Please note that my email address may have changed. For all
future correspondence, please use this address*****


********************************************************************This
message (including any attachments) is confidential and/or
privileged. It is to be used by the intended recipients only. If
you have received it by mistake please notify the sender by return
e-mail and delete this message from your system. Any unauthorized
use or dissemination of this message in whole or in part is
strictly prohibited. Please note that e-mails are inherently
insecure and susceptible to change. The Royal Bank of Scotland
Group, plc (&quot;RBS&quot;) and its US subsidiaries, and affiliates and
subsidiary undertakings, including but not limited to, RBS plc New
York and Connecticut Branches, RBS Securities Inc., ABN AMRO Bank
N.V. New York and Chicago Branches and, ABN AMRO Incorporated,
Citizens Financial Group, Inc. and RBS Citizens, N.A., shall not be
liable for the improper or incomplete transmission of the
information contained in this communication or Attachment nor for
any delay in its receipt or damage to your system. RBS does not
guarantee that the integrity of this communication has been
maintained nor that this communication is free of viruses,
interceptions or interference. RBS and its subsidiaries and
affiliates do not guarantee the accuracy of any email or
attachment, that an email will be received or that RBS or its
affiliates and subsidiaries will respond to an email.

RBS makes no representations that any information contained in this
message (including any attachments) are appropriate for use in all
locations or that transactions, securities, products, instruments
or services discussed herein are available or appropriate for sale
or use in all jurisdictions, or by all investors or counterparties.
Those who utilize this information do so on their own initiative
and are responsible for compliance with applicable local laws or
regulations.********************************************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090917/ceb56405/attachment.htm">http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/attachments/20090917/ceb56405/attachment.htm</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004893.html">[rabbitmq-discuss] Issue with .Net client Subscription
</A></li>
	<LI>Next message: <A HREF="004899.html">[rabbitmq-discuss] Issue with .Net client Subscription
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4897">[ date ]</a>
              <a href="thread.html#4897">[ thread ]</a>
              <a href="subject.html#4897">[ subject ]</a>
              <a href="author.html#4897">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.rabbitmq.com/cgi-bin/mailman/listinfo/rabbitmq-discuss">More information about the rabbitmq-discuss
mailing list</a><br>
</body></html>
